<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RegAlloc.Linear.Base</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/RegAlloc-Linear-Base.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ghc-8.6.5: The GHC API</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">RegAlloc.Linear.Base</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Put common type definitions here to break recursive module dependencies.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:BlockAssignment">BlockAssignment</a> freeRegs = <a href="RegAlloc-Liveness.html#t:BlockMap" title="RegAlloc.Liveness">BlockMap</a> (freeRegs, <a href="RegAlloc-Liveness.html#t:RegMap" title="RegAlloc.Liveness">RegMap</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Loc">Loc</a><ul class="subs"><li>= <a href="#v:InReg">InReg</a> !<a href="Reg.html#t:RealReg" title="Reg">RealReg</a></li><li>| <a href="#v:InMem">InMem</a> !<a href="RegAlloc-Linear-StackMap.html#t:StackSlot" title="RegAlloc.Linear.StackMap">StackSlot</a></li><li>| <a href="#v:InBoth">InBoth</a> !<a href="Reg.html#t:RealReg" title="Reg">RealReg</a> !<a href="RegAlloc-Linear-StackMap.html#t:StackSlot" title="RegAlloc.Linear.StackMap">StackSlot</a></li></ul></li><li class="src short"><a href="#v:regsOfLoc">regsOfLoc</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; [<a href="Reg.html#t:RealReg" title="Reg">RealReg</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:SpillReason">SpillReason</a><ul class="subs"><li>= <a href="#v:SpillAlloc">SpillAlloc</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></li><li>| <a href="#v:SpillClobber">SpillClobber</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></li><li>| <a href="#v:SpillLoad">SpillLoad</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></li><li>| <a href="#v:SpillJoinRR">SpillJoinRR</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></li><li>| <a href="#v:SpillJoinRM">SpillJoinRM</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:RegAllocStats">RegAllocStats</a> = <a href="#v:RegAllocStats">RegAllocStats</a> {<ul class="subs"><li><a href="#v:ra_spillInstrs">ra_spillInstrs</a> :: <a href="UniqFM.html#t:UniqFM" title="UniqFM">UniqFM</a> [<a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:RA_State">RA_State</a> freeRegs = <a href="#v:RA_State">RA_State</a> {<ul class="subs"><li><a href="#v:ra_blockassig">ra_blockassig</a> :: <a href="RegAlloc-Linear-Base.html#t:BlockAssignment" title="RegAlloc.Linear.Base">BlockAssignment</a> freeRegs</li><li><a href="#v:ra_freeregs">ra_freeregs</a> :: !freeRegs</li><li><a href="#v:ra_assig">ra_assig</a> :: <a href="RegAlloc-Liveness.html#t:RegMap" title="RegAlloc.Liveness">RegMap</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></li><li><a href="#v:ra_delta">ra_delta</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:ra_stack">ra_stack</a> :: <a href="RegAlloc-Linear-StackMap.html#t:StackMap" title="RegAlloc.Linear.StackMap">StackMap</a></li><li><a href="#v:ra_us">ra_us</a> :: <a href="UniqSupply.html#t:UniqSupply" title="UniqSupply">UniqSupply</a></li><li><a href="#v:ra_spills">ra_spills</a> :: [<a href="RegAlloc-Linear-Base.html#t:SpillReason" title="RegAlloc.Linear.Base">SpillReason</a>]</li><li><a href="#v:ra_DynFlags">ra_DynFlags</a> :: <a href="DynFlags.html#t:DynFlags" title="DynFlags">DynFlags</a></li></ul>}</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:BlockAssignment" class="def">BlockAssignment</a> freeRegs = <a href="RegAlloc-Liveness.html#t:BlockMap" title="RegAlloc.Liveness">BlockMap</a> (freeRegs, <a href="RegAlloc-Liveness.html#t:RegMap" title="RegAlloc.Liveness">RegMap</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a>) <a href="src/RegAlloc-Linear-Base.html#BlockAssignment" class="link">Source</a> <a href="#t:BlockAssignment" class="selflink">#</a></p><div class="doc"><p>Used to store the register assignment on entry to a basic block.
      We use this to handle join points, where multiple branch instructions
      target a particular label. We have to insert fixup code to make
      the register assignments from the different sources match up.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Loc" class="def">Loc</a> <a href="src/RegAlloc-Linear-Base.html#Loc" class="link">Source</a> <a href="#t:Loc" class="selflink">#</a></p><div class="doc"><p>Where a vreg is currently stored
      A temporary can be marked as living in both a register and memory
      (InBoth), for example if it was recently loaded from a spill location.
      This makes it cheap to spill (no save instruction required), but we
      have to be careful to turn this into InReg if the value in the
      register is changed.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InReg" class="def">InReg</a> !<a href="Reg.html#t:RealReg" title="Reg">RealReg</a></td><td class="doc"><p>vreg is in a register</p></td></tr><tr><td class="src"><a id="v:InMem" class="def">InMem</a> !<a href="RegAlloc-Linear-StackMap.html#t:StackSlot" title="RegAlloc.Linear.StackMap">StackSlot</a></td><td class="doc"><p>vreg is held in a stack slot</p></td></tr><tr><td class="src"><a id="v:InBoth" class="def">InBoth</a> !<a href="Reg.html#t:RealReg" title="Reg">RealReg</a> !<a href="RegAlloc-Linear-StackMap.html#t:StackSlot" title="RegAlloc.Linear.StackMap">StackSlot</a></td><td class="doc"><p>vreg is held in both a register and a stack slot</p></td></tr></table></div><div class="subs instances"><details id="i:Loc" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Loc:Eq:1"></span> <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></span> <a href="#t:Loc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Loc:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="RegAlloc-Linear-Base.html">RegAlloc.Linear.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Loc:Ord:2"></span> <a href="../base-4.12.0.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></span> <a href="#t:Loc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Loc:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="RegAlloc-Linear-Base.html">RegAlloc.Linear.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Loc:Show:3"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></span> <a href="#t:Loc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Loc:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="RegAlloc-Linear-Base.html">RegAlloc.Linear.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="../base-4.12.0.0/src/GHC-Show.html#showsPrec" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="../base-4.12.0.0/src/GHC-Show.html#show" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="../base-4.12.0.0/src/GHC-Show.html#showList" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Loc:Outputable:4"></span> <a href="Outputable.html#t:Outputable" title="Outputable">Outputable</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></span> <a href="#t:Loc" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Loc:Outputable:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="RegAlloc-Linear-Base.html">RegAlloc.Linear.Base</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:ppr">ppr</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="Outputable.html#t:SDoc" title="Outputable">SDoc</a> <a href="src/Outputable.html#ppr" class="link">Source</a> <a href="#v:ppr" class="selflink">#</a></p><p class="src"><a href="#v:pprPrec">pprPrec</a> :: <a href="../base-4.12.0.0/Prelude.html#t:Rational" title="Prelude">Rational</a> -&gt; <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; <a href="Outputable.html#t:SDoc" title="Outputable">SDoc</a> <a href="src/Outputable.html#pprPrec" class="link">Source</a> <a href="#v:pprPrec" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:regsOfLoc" class="def">regsOfLoc</a> :: <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a> -&gt; [<a href="Reg.html#t:RealReg" title="Reg">RealReg</a>] <a href="src/RegAlloc-Linear-Base.html#regsOfLoc" class="link">Source</a> <a href="#v:regsOfLoc" class="selflink">#</a></p><div class="doc"><p>Get the reg numbers stored in this Loc.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SpillReason" class="def">SpillReason</a> <a href="src/RegAlloc-Linear-Base.html#SpillReason" class="link">Source</a> <a href="#t:SpillReason" class="selflink">#</a></p><div class="doc"><p>Reasons why instructions might be inserted by the spiller.
      Used when generating stats for -ddrop-asm-stats.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SpillAlloc" class="def">SpillAlloc</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></td><td class="doc"><p>vreg was spilled to a slot so we could use its
      current hreg for another vreg</p></td></tr><tr><td class="src"><a id="v:SpillClobber" class="def">SpillClobber</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></td><td class="doc"><p>vreg was moved because its hreg was clobbered</p></td></tr><tr><td class="src"><a id="v:SpillLoad" class="def">SpillLoad</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></td><td class="doc"><p>vreg was loaded from a spill slot</p></td></tr><tr><td class="src"><a id="v:SpillJoinRR" class="def">SpillJoinRR</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></td><td class="doc"><p>reg-reg move inserted during join to targets</p></td></tr><tr><td class="src"><a id="v:SpillJoinRM" class="def">SpillJoinRM</a> !<a href="Unique.html#t:Unique" title="Unique">Unique</a></td><td class="doc"><p>reg-mem move inserted during join to targets</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RegAllocStats" class="def">RegAllocStats</a> <a href="src/RegAlloc-Linear-Base.html#RegAllocStats" class="link">Source</a> <a href="#t:RegAllocStats" class="selflink">#</a></p><div class="doc"><p>Used to carry interesting stats out of the register allocator.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RegAllocStats" class="def">RegAllocStats</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:ra_spillInstrs" class="def">ra_spillInstrs</a> :: <a href="UniqFM.html#t:UniqFM" title="UniqFM">UniqFM</a> [<a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RA_State" class="def">RA_State</a> freeRegs <a href="src/RegAlloc-Linear-Base.html#RA_State" class="link">Source</a> <a href="#t:RA_State" class="selflink">#</a></p><div class="doc"><p>The register allocator state</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RA_State" class="def">RA_State</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:ra_blockassig" class="def">ra_blockassig</a> :: <a href="RegAlloc-Linear-Base.html#t:BlockAssignment" title="RegAlloc.Linear.Base">BlockAssignment</a> freeRegs</dfn><div class="doc"><p>the current mapping from basic blocks to
      the register assignments at the beginning of that block.</p></div></li><li><dfn class="src"><a id="v:ra_freeregs" class="def">ra_freeregs</a> :: !freeRegs</dfn><div class="doc"><p>free machine registers</p></div></li><li><dfn class="src"><a id="v:ra_assig" class="def">ra_assig</a> :: <a href="RegAlloc-Liveness.html#t:RegMap" title="RegAlloc.Liveness">RegMap</a> <a href="RegAlloc-Linear-Base.html#t:Loc" title="RegAlloc.Linear.Base">Loc</a></dfn><div class="doc"><p>assignment of temps to locations</p></div></li><li><dfn class="src"><a id="v:ra_delta" class="def">ra_delta</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>current stack delta</p></div></li><li><dfn class="src"><a id="v:ra_stack" class="def">ra_stack</a> :: <a href="RegAlloc-Linear-StackMap.html#t:StackMap" title="RegAlloc.Linear.StackMap">StackMap</a></dfn><div class="doc"><p>free stack slots for spilling</p></div></li><li><dfn class="src"><a id="v:ra_us" class="def">ra_us</a> :: <a href="UniqSupply.html#t:UniqSupply" title="UniqSupply">UniqSupply</a></dfn><div class="doc"><p>unique supply for generating names for join point fixup blocks.</p></div></li><li><dfn class="src"><a id="v:ra_spills" class="def">ra_spills</a> :: [<a href="RegAlloc-Linear-Base.html#t:SpillReason" title="RegAlloc.Linear.Base">SpillReason</a>]</dfn><div class="doc"><p>Record why things were spilled, for -ddrop-asm-stats.
      Just keep a list here instead of a map of regs -&gt; reasons.
      We don't want to slow down the allocator if we're not going to emit the stats.</p></div></li><li><dfn class="src"><a id="v:ra_DynFlags" class="def">ra_DynFlags</a> :: <a href="DynFlags.html#t:DynFlags" title="DynFlags">DynFlags</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>