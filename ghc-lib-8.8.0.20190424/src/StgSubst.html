<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">StgSubst</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Id</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">VarEnv</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.State.Strict</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-- | A renaming substitution from 'Id's to 'Id's. Like 'RnEnv2', but not</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- maintaining pairs of substitutions. Like @&quot;CoreSubst&quot;.'CoreSubst.Subst'@, but</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- with the domain being 'Id's instead of entire 'CoreExpr'.</span><span>
</span><a name="line-18"></a><span class="hs-keyword">data</span><span> </span><a name="Subst"><a href="StgSubst.html#Subst"><span class="hs-identifier">Subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Subst"><a href="StgSubst.html#Subst"><span class="hs-identifier">Subst</span></a></a><span> </span><span class="hs-identifier hs-type">InScopeSet</span><span> </span><a href="StgSubst.html#IdSubstEnv"><span class="hs-identifier hs-type">IdSubstEnv</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">type</span><span> </span><a name="IdSubstEnv"><a href="StgSubst.html#IdSubstEnv"><span class="hs-identifier">IdSubstEnv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IdEnv</span><span> </span><span class="hs-identifier hs-type">Id</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- | @emptySubst = 'mkEmptySubst' 'emptyInScopeSet'@</span><span>
</span><a name="line-23"></a><span class="hs-identifier">emptySubst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span>
</span><a name="line-24"></a><a name="emptySubst"><a href="StgSubst.html#emptySubst"><span class="hs-identifier">emptySubst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgSubst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a><span> </span><span class="hs-identifier hs-var">emptyInScopeSet</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Constructs a new 'Subst' assuming the variables in the given 'InScopeSet'</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- are in scope.</span><span>
</span><a name="line-28"></a><span class="hs-identifier">mkEmptySubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">InScopeSet</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span>
</span><a name="line-29"></a><a name="mkEmptySubst"><a href="StgSubst.html#mkEmptySubst"><span class="hs-identifier">mkEmptySubst</span></a></a><span> </span><a name="local-6989586621680627934"><a href="#local-6989586621680627934"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a href="#local-6989586621680627934"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-identifier hs-var">emptyVarEnv</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Substitutes an 'Id' for another one according to the 'Subst' given in a way</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- that avoids shadowing the 'InScopeSet', returning the result and an updated</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- 'Subst' that should be used by subsequent substitutions.</span><span>
</span><a name="line-34"></a><span class="hs-identifier">substBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Id</span><span class="hs-special">,</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="substBndr"><a href="StgSubst.html#substBndr"><span class="hs-identifier">substBndr</span></a></a><span> </span><a name="local-6989586621680627935"><a href="#local-6989586621680627935"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a name="local-6989586621680627936"><a href="#local-6989586621680627936"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-6989586621680627937"><a href="#local-6989586621680627937"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680627938"><span class="hs-identifier hs-var">new_id</span></a><span class="hs-special">,</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a href="#local-6989586621680627940"><span class="hs-identifier hs-var">new_in_scope</span></a><span> </span><a href="#local-6989586621680627941"><span class="hs-identifier hs-var">new_env</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>    </span><a name="local-6989586621680627938"><a href="#local-6989586621680627938"><span class="hs-identifier">new_id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uniqAway</span><span> </span><a href="#local-6989586621680627936"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621680627935"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-39"></a><span>    </span><a name="local-6989586621680627939"><a href="#local-6989586621680627939"><span class="hs-identifier">no_change</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627938"><span class="hs-identifier hs-var">new_id</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680627935"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-comment">-- in case nothing shadowed</span><span>
</span><a name="line-40"></a><span>    </span><a name="local-6989586621680627940"><a href="#local-6989586621680627940"><span class="hs-identifier">new_in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627936"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">extendInScopeSet</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680627938"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-41"></a><span>    </span><a name="local-6989586621680627941"><a href="#local-6989586621680627941"><span class="hs-identifier">new_env</span></a></a><span>
</span><a name="line-42"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680627939"><span class="hs-identifier hs-var">no_change</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delVarEnv</span><span> </span><a href="#local-6989586621680627937"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680627935"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-43"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">extendVarEnv</span><span> </span><a href="#local-6989586621680627937"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680627935"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621680627938"><span class="hs-identifier hs-var">new_id</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-comment">-- | @substBndrs = runState . traverse (state . substBndr)@</span><span>
</span><a name="line-46"></a><span class="hs-identifier">substBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-6989586621680627933"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621680627933"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680627933"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier hs-type">Id</span><span class="hs-special">,</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><a name="substBndrs"><a href="StgSubst.html#substBndrs"><span class="hs-identifier">substBndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runState</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">state</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="StgSubst.html#substBndr"><span class="hs-identifier hs-var">substBndr</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | Substitutes an occurrence of an identifier for its counterpart recorded</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- in the 'Subst'.</span><span>
</span><a name="line-51"></a><span class="hs-identifier">lookupIdSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span>
</span><a name="line-52"></a><a name="lookupIdSubst"><a href="StgSubst.html#lookupIdSubst"><span class="hs-identifier">lookupIdSubst</span></a></a><span> </span><a name="local-6989586621680627942"><a href="#local-6989586621680627942"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a name="local-6989586621680627943"><a href="#local-6989586621680627943"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-6989586621680627944"><a href="#local-6989586621680627944"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isLocalId</span><span> </span><a href="#local-6989586621680627942"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627942"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680627945"><a href="#local-6989586621680627945"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lookupVarEnv</span><span> </span><a href="#local-6989586621680627944"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680627942"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627945"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680627946"><a href="#local-6989586621680627946"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lookupInScope</span><span> </span><a href="#local-6989586621680627943"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621680627942"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627946"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;StgSubst.lookupIdSubst&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">id</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">in_scope</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>                </span><a href="#local-6989586621680627942"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">-- | Substitutes an occurrence of an identifier for its counterpart recorded</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- in the 'Subst'. Does not generate a debug warning if the identifier to</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- to substitute wasn't in scope.</span><span>
</span><a name="line-62"></a><span class="hs-identifier">noWarnLookupIdSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span>
</span><a name="line-63"></a><a name="noWarnLookupIdSubst"><a href="StgSubst.html#noWarnLookupIdSubst"><span class="hs-identifier">noWarnLookupIdSubst</span></a></a><span> </span><a name="local-6989586621680627947"><a href="#local-6989586621680627947"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a name="local-6989586621680627948"><a href="#local-6989586621680627948"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-6989586621680627949"><a href="#local-6989586621680627949"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isLocalId</span><span> </span><a href="#local-6989586621680627947"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627947"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680627950"><a href="#local-6989586621680627950"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lookupVarEnv</span><span> </span><a href="#local-6989586621680627949"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680627947"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627950"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680627951"><a href="#local-6989586621680627951"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lookupInScope</span><span> </span><a href="#local-6989586621680627948"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621680627947"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627951"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-67"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680627947"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Add the 'Id' to the in-scope set and remove any existing substitutions for</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- it.</span><span>
</span><a name="line-71"></a><span class="hs-identifier">extendInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span>
</span><a name="line-72"></a><a name="extendInScope"><a href="StgSubst.html#extendInScope"><span class="hs-identifier">extendInScope</span></a></a><span> </span><a name="local-6989586621680627952"><a href="#local-6989586621680627952"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a name="local-6989586621680627953"><a href="#local-6989586621680627953"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-6989586621680627954"><a href="#local-6989586621680627954"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680627953"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">extendInScopeSet</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680627952"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680627954"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Add a substitution for an 'Id' to the 'Subst': you must ensure that the</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- in-scope set is such that TyCORep Note [The substitution invariant]</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- holds after extending the substitution like this.</span><span>
</span><a name="line-77"></a><span class="hs-identifier">extendSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a><span>
</span><a name="line-78"></a><a name="extendSubst"><a href="StgSubst.html#extendSubst"><span class="hs-identifier">extendSubst</span></a></a><span> </span><a name="local-6989586621680627955"><a href="#local-6989586621680627955"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621680627956"><a href="#local-6989586621680627956"><span class="hs-identifier">new_id</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a name="local-6989586621680627957"><a href="#local-6989586621680627957"><span class="hs-identifier">in_scope</span></a></a><span> </span><a name="local-6989586621680627958"><a href="#local-6989586621680627958"><span class="hs-identifier">env</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">new_id</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elemInScopeSet</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">in_scope</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><a href="#local-6989586621680627957"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621680627957"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">new_id</span><span> </span><span class="hs-operator hs-var">$$</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><span class="hs-identifier">in_scope</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>    </span><a href="StgSubst.html#Subst"><span class="hs-identifier hs-var">Subst</span></a><span> </span><a href="#local-6989586621680627957"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">extendVarEnv</span><span> </span><a href="#local-6989586621680627958"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680627955"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621680627956"><span class="hs-identifier hs-var">new_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a></pre></body></html>