<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


This module converts Template Haskell syntax into HsSyn
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Convert</span><span class="hs-special">(</span><span> </span><a href="Convert.html#convertToHsExpr"><span class="hs-identifier hs-var">convertToHsExpr</span></a><span class="hs-special">,</span><span> </span><a href="Convert.html#convertToPat"><span class="hs-identifier hs-var">convertToPat</span></a><span class="hs-special">,</span><span> </span><a href="Convert.html#convertToHsDecls"><span class="hs-identifier hs-var">convertToHsDecls</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>                </span><a href="Convert.html#convertToHsType"><span class="hs-identifier hs-var">convertToHsType</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>                </span><a href="Convert.html#thRdrNameGuesses"><span class="hs-identifier hs-var">thRdrNameGuesses</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsSyn</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Hs</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">PrelNames</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">RdrName</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Name</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Module</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">RdrHsSyn</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">OccName</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Coercion</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Role</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BasicTypes</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Hs</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ForeignCall</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ErrUtils</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Bag</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Lexeme</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FastString</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MonadUtils</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">foldrM</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ap</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TH</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sigP</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Syntax</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TH</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-50"></a><span class="hs-comment">--              The external interface</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-identifier">convertToHsDecls</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span>
</span><a name="line-53"></a><a name="convertToHsDecls"><a href="Convert.html#convertToHsDecls"><span class="hs-identifier">convertToHsDecls</span></a></a><span> </span><a name="local-6989586621679218095"><a href="#local-6989586621679218095"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218096"><a href="#local-6989586621679218096"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#initCvt"><span class="hs-identifier hs-var">initCvt</span></a><span> </span><a href="#local-6989586621679218095"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679218097"><span class="hs-identifier hs-var">cvt_dec</span></a><span> </span><a href="#local-6989586621679218096"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>    </span><a name="local-6989586621679218097"><a href="#local-6989586621679218097"><span class="hs-identifier">cvt_dec</span></a></a><span> </span><a name="local-6989586621679218098"><a href="#local-6989586621679218098"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapMsg"><span class="hs-identifier hs-var">wrapMsg</span></a><span> </span><span class="hs-string">&quot;declaration&quot;</span><span> </span><a href="#local-6989586621679218098"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtDec"><span class="hs-identifier hs-var">cvtDec</span></a><span> </span><a href="#local-6989586621679218098"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">convertToHsExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><a name="convertToHsExpr"><a href="Convert.html#convertToHsExpr"><span class="hs-identifier">convertToHsExpr</span></a></a><span> </span><a name="local-6989586621679218099"><a href="#local-6989586621679218099"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218100"><a href="#local-6989586621679218100"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#initCvt"><span class="hs-identifier hs-var">initCvt</span></a><span> </span><a href="#local-6989586621679218099"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#wrapMsg"><span class="hs-identifier hs-var">wrapMsg</span></a><span> </span><span class="hs-string">&quot;expression&quot;</span><span> </span><a href="#local-6989586621679218100"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679218100"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-identifier">convertToPat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><a name="convertToPat"><a href="Convert.html#convertToPat"><span class="hs-identifier">convertToPat</span></a></a><span> </span><a name="local-6989586621679218101"><a href="#local-6989586621679218101"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218102"><a href="#local-6989586621679218102"><span class="hs-identifier">p</span></a></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#initCvt"><span class="hs-identifier hs-var">initCvt</span></a><span> </span><a href="#local-6989586621679218101"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#wrapMsg"><span class="hs-identifier hs-var">wrapMsg</span></a><span> </span><span class="hs-string">&quot;pattern&quot;</span><span> </span><a href="#local-6989586621679218102"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679218102"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-identifier">convertToHsType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><a name="convertToHsType"><a href="Convert.html#convertToHsType"><span class="hs-identifier">convertToHsType</span></a></a><span> </span><a name="local-6989586621679218103"><a href="#local-6989586621679218103"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218104"><a href="#local-6989586621679218104"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-67"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#initCvt"><span class="hs-identifier hs-var">initCvt</span></a><span> </span><a href="#local-6989586621679218103"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#wrapMsg"><span class="hs-identifier hs-var">wrapMsg</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span> </span><a href="#local-6989586621679218104"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218104"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-70"></a><span class="hs-keyword">newtype</span><span> </span><a name="CvtM"><a href="Convert.html#CvtM"><span class="hs-identifier">CvtM</span></a></a><span> </span><a name="local-6989586621679215939"><a href="#local-6989586621679215939"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CvtM"><a href="Convert.html#CvtM"><span class="hs-identifier">CvtM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unCvtM"><a href="Convert.html#unCvtM"><span class="hs-identifier">unCvtM</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679215939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-71"></a><span>        </span><span class="hs-comment">-- Push down the source location;</span><span>
</span><a name="line-72"></a><span>        </span><span class="hs-comment">-- Can fail, with a single error message</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- NB: If the conversion succeeds with (Right x), there should</span><span>
</span><a name="line-75"></a><span class="hs-comment">--     be no exception values hiding in x</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- Reason: so a (head []) in TH code doesn't subsequently</span><span>
</span><a name="line-77"></a><span class="hs-comment">--         make GHC crash when it tries to walk the generated tree</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- Use the loc everywhere, for lack of anything better</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- In particular, we want it on binding locations, so that variables bound in</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- the spliced-in declarations get a location that at least relates to the splice point</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-84"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><a name="local-6989586621679215946"><a href="#local-6989586621679215946"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679215947"><a href="#local-6989586621679215947"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679215947"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><a href="#local-6989586621679215946"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-special">(</span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><a name="local-6989586621679215940"><a href="#local-6989586621679215940"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679215941"><a href="#local-6989586621679215941"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679215942"><a href="#local-6989586621679215942"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679215940"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679215942"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-92"></a><span>                                  </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679215943"><a href="#local-6989586621679215943"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679215943"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-93"></a><span>                                  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679215944"><a href="#local-6989586621679215944"><span class="hs-identifier">loc'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679215945"><a href="#local-6989586621679215945"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">unCvtM</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679215941"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679215945"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679215944"><span class="hs-identifier hs-var">loc'</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">initCvt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679218094"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><a href="#local-6989586621679218094"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-96"></a><a name="initCvt"><a href="Convert.html#initCvt"><span class="hs-identifier">initCvt</span></a></a><span> </span><a name="local-6989586621679218105"><a href="#local-6989586621679218105"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><a name="local-6989586621679218106"><a href="#local-6989586621679218106"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218106"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679218105"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-identifier">force</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679218093"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><a name="force"><a href="Convert.html#force"><span class="hs-identifier">force</span></a></a><span> </span><a name="local-6989586621679218107"><a href="#local-6989586621679218107"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218107"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">failWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679218092"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-102"></a><a name="failWith"><a href="Convert.html#failWith"><span class="hs-identifier">failWith</span></a></a><span> </span><a name="local-6989586621679218108"><a href="#local-6989586621679218108"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679218108"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-identifier">getL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-105"></a><a name="getL"><a href="Convert.html#getL"><span class="hs-identifier">getL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679218109"><a href="#local-6989586621679218109"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218109"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><a href="#local-6989586621679218109"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-identifier">setL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><a name="setL"><a href="Convert.html#setL"><span class="hs-identifier">setL</span></a></a><span> </span><a name="local-6989586621679218110"><a href="#local-6989586621679218110"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218110"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-identifier">returnL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasSrcSpan</span><span> </span><a href="#local-6989586621679218091"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><a href="#local-6989586621679218091"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679218091"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-111"></a><a name="returnL"><a href="Convert.html#returnL"><span class="hs-identifier">returnL</span></a></a><span> </span><a name="local-6989586621679218111"><a href="#local-6989586621679218111"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679218112"><a href="#local-6989586621679218112"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218112"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218112"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218111"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">returnJustL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasSrcSpan</span><span> </span><a href="#local-6989586621679218090"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><a href="#local-6989586621679218090"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679218090"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><a name="returnJustL"><a href="Convert.html#returnJustL"><span class="hs-identifier">returnJustL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-identifier">wrapParL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasSrcSpan</span><span> </span><a href="#local-6989586621679218089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-117"></a><span>            </span><span class="hs-special">(</span><a href="#local-6989586621679218089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><a href="#local-6989586621679218089"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><a href="#local-6989586621679218089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanLess</span><span>  </span><a href="#local-6989586621679218089"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="wrapParL"><a href="Convert.html#wrapParL"><span class="hs-identifier">wrapParL</span></a></a><span> </span><a name="local-6989586621679218113"><a href="#local-6989586621679218113"><span class="hs-identifier">add_par</span></a></a><span> </span><a name="local-6989586621679218114"><a href="#local-6989586621679218114"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679218115"><a href="#local-6989586621679218115"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218115"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218113"><span class="hs-identifier hs-var">add_par</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218115"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218114"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-identifier">wrapMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679217066"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Ppr</span><span> </span><a href="#local-6989586621679217066"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679217066"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679217067"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679217067"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- E.g  wrapMsg &quot;declaration&quot; dec thing</span><span>
</span><a name="line-122"></a><a name="wrapMsg"><a href="Convert.html#wrapMsg"><span class="hs-identifier">wrapMsg</span></a></a><span> </span><a name="local-6989586621679218116"><a href="#local-6989586621679218116"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-6989586621679218117"><a href="#local-6989586621679218117"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-special">(</span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><a name="local-6989586621679218118"><a href="#local-6989586621679218118"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679218121"><a href="#local-6989586621679218121"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679218118"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679218121"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-124"></a><span>                     </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679218122"><a href="#local-6989586621679218122"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218122"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">$$</span><span> </span><span class="hs-identifier hs-var">getPprStyle</span><span> </span><a href="#local-6989586621679218119"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>                     </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679218123"><a href="#local-6989586621679218123"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218123"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-comment">-- Show the item in pretty syntax normally,</span><span>
</span><a name="line-128"></a><span>        </span><span class="hs-comment">-- but with all its constructors if you say -dppr-debug</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-6989586621679218119"><a href="#local-6989586621679218119"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679218120"><a href="#local-6989586621679218120"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hang</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;When splicing a TH&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><a href="#local-6989586621679218116"><span class="hs-identifier hs-var">what</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">colon</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>                 </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">debugStyle</span><span> </span><a href="#local-6989586621679218120"><span class="hs-identifier hs-var">sty</span></a><span>
</span><a name="line-131"></a><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679218117"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pprint</span><span> </span><a href="#local-6989586621679218117"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-identifier">wrapL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasSrcSpan</span><span> </span><a href="#local-6989586621679217065"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><a href="#local-6989586621679217065"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><a href="#local-6989586621679217065"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-135"></a><a name="wrapL"><a href="Convert.html#wrapL"><span class="hs-identifier">wrapL</span></a></a><span> </span><span class="hs-special">(</span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><a name="local-6989586621679218124"><a href="#local-6989586621679218124"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-var">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679218125"><a href="#local-6989586621679218125"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679218124"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679218125"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-136"></a><span>                               </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679218126"><a href="#local-6989586621679218126"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679218126"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-137"></a><span>                               </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218127"><a href="#local-6989586621679218127"><span class="hs-identifier">loc'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679218128"><a href="#local-6989586621679218128"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218127"><span class="hs-identifier hs-var">loc'</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218125"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218128"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-140"></a><span class="hs-identifier">cvtDecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><a name="cvtDecs"><a href="Convert.html#cvtDecs"><span class="hs-identifier">cvtDecs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtDec"><span class="hs-identifier hs-var">cvtDec</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><a name="cvtDec"><a href="Convert.html#cvtDec"><span class="hs-identifier">cvtDec</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ValD</span><span> </span><a name="local-6989586621679218129"><a href="#local-6989586621679218129"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679218130"><a href="#local-6989586621679218130"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679218131"><a href="#local-6989586621679218131"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TH.VarP</span><span> </span><a name="local-6989586621679218132"><a href="#local-6989586621679218132"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679218129"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218133"><a href="#local-6989586621679218133"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218132"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-147"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218566"><a href="#local-6989586621679218566"><span class="hs-identifier">cl'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtClause"><span class="hs-identifier hs-var">cvtClause</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkPrefixFunRhs</span><span> </span><a href="#local-6989586621679218133"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Clause</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679218130"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-6989586621679218131"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.ValD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkFunBind</span><span> </span><a href="#local-6989586621679218133"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218566"><span class="hs-identifier hs-var">cl'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218567"><a href="#local-6989586621679218567"><span class="hs-identifier">pat'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679218129"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-152"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218568"><a href="#local-6989586621679218568"><span class="hs-identifier">body'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtGuard"><span class="hs-identifier hs-var">cvtGuard</span></a><span> </span><a href="#local-6989586621679218130"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-153"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218569"><a href="#local-6989586621679218569"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier hs-var">cvtLocalDecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a where clause&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218131"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-154"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.ValD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-155"></a><span>          </span><span class="hs-identifier hs-var">PatBind</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218567"><span class="hs-identifier hs-var">pat'</span></a><span>
</span><a name="line-156"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679218568"><span class="hs-identifier hs-var">body'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679218569"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-158"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_ticks</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.FunD</span><span> </span><a name="local-6989586621679218570"><a href="#local-6989586621679218570"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218571"><a href="#local-6989586621679218571"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218571"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Function binding for&quot;</span><span>
</span><a name="line-163"></a><span>                 </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">quotes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.pprint</span><span> </span><a href="#local-6989586621679218570"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>                 </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;has no equations&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218572"><a href="#local-6989586621679218572"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218570"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-167"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218573"><a href="#local-6989586621679218573"><span class="hs-identifier">cls'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtClause"><span class="hs-identifier hs-var">cvtClause</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkPrefixFunRhs</span><span> </span><a href="#local-6989586621679218572"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218571"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-168"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.ValD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkFunBind</span><span> </span><a href="#local-6989586621679218572"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621679218573"><span class="hs-identifier hs-var">cls'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.SigD</span><span> </span><a name="local-6989586621679218574"><a href="#local-6989586621679218574"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218575"><a href="#local-6989586621679218575"><span class="hs-identifier">typ</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218576"><a href="#local-6989586621679218576"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218574"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-172"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218577"><a href="#local-6989586621679218577"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218575"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-173"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-174"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218576"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigWcType</span><span> </span><a href="#local-6989586621679218577"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.InfixD</span><span> </span><a name="local-6989586621679218578"><a href="#local-6989586621679218578"><span class="hs-identifier">fx</span></a></a><span> </span><a name="local-6989586621679218579"><a href="#local-6989586621679218579"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-comment">-- Fixity signatures are allowed for variables, constructors, and types</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-comment">-- the renamer automatically looks for types during renaming, even when</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-comment">-- the RdrName says it's a variable or a constructor. So, just assume</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-comment">-- it's a variable or constructor and proceed.</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218580"><a href="#local-6989586621679218580"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vcNameL"><span class="hs-identifier hs-var">vcNameL</span></a><span> </span><a href="#local-6989586621679218579"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-182"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FixSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-183"></a><span>                                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FixitySig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218580"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtFixity"><span class="hs-identifier hs-var">cvtFixity</span></a><span> </span><a href="#local-6989586621679218578"><span class="hs-identifier hs-var">fx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PragmaD</span><span> </span><a name="local-6989586621679218581"><a href="#local-6989586621679218581"><span class="hs-identifier">prag</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtPragmaD"><span class="hs-identifier hs-var">cvtPragmaD</span></a><span> </span><a href="#local-6989586621679218581"><span class="hs-identifier hs-var">prag</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynD</span><span> </span><a name="local-6989586621679218582"><a href="#local-6989586621679218582"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218583"><a href="#local-6989586621679218583"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218584"><a href="#local-6989586621679218584"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679218585"><a href="#local-6989586621679218585"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218586"><a href="#local-6989586621679218586"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679218582"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679218583"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-190"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218587"><a href="#local-6989586621679218587"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218584"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-191"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-192"></a><span>          </span><span class="hs-identifier hs-var">SynDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdSExt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218585"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218586"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-193"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-194"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218587"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataD</span><span> </span><a name="local-6989586621679218588"><a href="#local-6989586621679218588"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218589"><a href="#local-6989586621679218589"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218590"><a href="#local-6989586621679218590"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218591"><a href="#local-6989586621679218591"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621679218592"><a href="#local-6989586621679218592"><span class="hs-identifier">constrs</span></a></a><span> </span><a name="local-6989586621679218593"><a href="#local-6989586621679218593"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218594"><a href="#local-6989586621679218594"><span class="hs-identifier">isGadtCon</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GadtC</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-198"></a><span>              </span><span class="hs-identifier">isGadtCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-199"></a><span>              </span><span class="hs-identifier">isGadtCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallC</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679218597"><a href="#local-6989586621679218597"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218594"><span class="hs-identifier hs-var">isGadtCon</span></a><span> </span><a href="#local-6989586621679218597"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-200"></a><span>              </span><span class="hs-identifier">isGadtCon</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-201"></a><span>              </span><a name="local-6989586621679218595"><a href="#local-6989586621679218595"><span class="hs-identifier">isGadtDecl</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="#local-6989586621679218594"><span class="hs-identifier hs-var">isGadtCon</span></a><span> </span><a href="#local-6989586621679218592"><span class="hs-identifier hs-var">constrs</span></a><span>
</span><a name="line-202"></a><span>              </span><a name="local-6989586621679218596"><a href="#local-6989586621679218596"><span class="hs-identifier">isH98Decl</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679218594"><span class="hs-identifier hs-var">isGadtCon</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218592"><span class="hs-identifier hs-var">constrs</span></a><span>
</span><a name="line-203"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218595"><span class="hs-identifier hs-var">isGadtDecl</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679218596"><span class="hs-identifier hs-var">isH98Decl</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>                 </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Cannot mix GADT constructors with Haskell 98&quot;</span><span>
</span><a name="line-205"></a><span>                        </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;constructors&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isNothing</span><span> </span><a href="#local-6989586621679218591"><span class="hs-identifier hs-var">ksig</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679218595"><span class="hs-identifier hs-var">isGadtDecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>                 </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Kind signatures are only allowed on GADTs&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218598"><a href="#local-6989586621679218598"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218599"><a href="#local-6989586621679218599"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218600"><a href="#local-6989586621679218600"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><a href="#local-6989586621679218588"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218589"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679218590"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-209"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218601"><a href="#local-6989586621679218601"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">traverse</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679218591"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-210"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218602"><a href="#local-6989586621679218602"><span class="hs-identifier">cons'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtConstr"><span class="hs-identifier hs-var">cvtConstr</span></a><span> </span><a href="#local-6989586621679218592"><span class="hs-identifier hs-var">constrs</span></a><span>
</span><a name="line-211"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218603"><a href="#local-6989586621679218603"><span class="hs-identifier">derivs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDerivs"><span class="hs-identifier hs-var">cvtDerivs</span></a><span> </span><a href="#local-6989586621679218593"><span class="hs-identifier hs-var">derivs</span></a><span>
</span><a name="line-212"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218604"><a href="#local-6989586621679218604"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-213"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DataType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-214"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218598"><span class="hs-identifier hs-var">ctxt'</span></a><span>
</span><a name="line-215"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218601"><span class="hs-identifier hs-var">ksig'</span></a><span>
</span><a name="line-216"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218602"><span class="hs-identifier hs-var">cons'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218603"><span class="hs-identifier hs-var">derivs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-217"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataDecl</span><span>
</span><a name="line-218"></a><span>                                        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdDExt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-219"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218599"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218600"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-220"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-221"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218604"><span class="hs-identifier hs-var">defn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeD</span><span> </span><a name="local-6989586621679218605"><a href="#local-6989586621679218605"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218606"><a href="#local-6989586621679218606"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218607"><a href="#local-6989586621679218607"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218608"><a href="#local-6989586621679218608"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621679218609"><a href="#local-6989586621679218609"><span class="hs-identifier">constr</span></a></a><span> </span><a name="local-6989586621679218610"><a href="#local-6989586621679218610"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218611"><a href="#local-6989586621679218611"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218612"><a href="#local-6989586621679218612"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218613"><a href="#local-6989586621679218613"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><a href="#local-6989586621679218605"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218606"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679218607"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-225"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218614"><a href="#local-6989586621679218614"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">traverse</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679218608"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-226"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218615"><a href="#local-6989586621679218615"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtConstr"><span class="hs-identifier hs-var">cvtConstr</span></a><span> </span><a href="#local-6989586621679218609"><span class="hs-identifier hs-var">constr</span></a><span>
</span><a name="line-227"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218616"><a href="#local-6989586621679218616"><span class="hs-identifier">derivs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDerivs"><span class="hs-identifier hs-var">cvtDerivs</span></a><span> </span><a href="#local-6989586621679218610"><span class="hs-identifier hs-var">derivs</span></a><span>
</span><a name="line-228"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218617"><a href="#local-6989586621679218617"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-229"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NewType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-230"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218611"><span class="hs-identifier hs-var">ctxt'</span></a><span>
</span><a name="line-231"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218614"><span class="hs-identifier hs-var">ksig'</span></a><span>
</span><a name="line-232"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218615"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-233"></a><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218616"><span class="hs-identifier hs-var">derivs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-234"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataDecl</span><span>
</span><a name="line-235"></a><span>                                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdDExt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-236"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218612"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218613"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-237"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-238"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218617"><span class="hs-identifier hs-var">defn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassD</span><span> </span><a name="local-6989586621679218618"><a href="#local-6989586621679218618"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218619"><a href="#local-6989586621679218619"><span class="hs-identifier">cl</span></a></a><span> </span><a name="local-6989586621679218620"><a href="#local-6989586621679218620"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218621"><a href="#local-6989586621679218621"><span class="hs-identifier">fds</span></a></a><span> </span><a name="local-6989586621679218622"><a href="#local-6989586621679218622"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218627"><a href="#local-6989586621679218627"><span class="hs-identifier">cxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218628"><a href="#local-6989586621679218628"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218629"><a href="#local-6989586621679218629"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><a href="#local-6989586621679218618"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218619"><span class="hs-identifier hs-var">cl</span></a><span> </span><a href="#local-6989586621679218620"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-242"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218630"><a href="#local-6989586621679218630"><span class="hs-identifier">fds'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_fundep"><span class="hs-identifier hs-var">cvt_fundep</span></a><span> </span><a href="#local-6989586621679218621"><span class="hs-identifier hs-var">fds</span></a><span>
</span><a name="line-243"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218631"><a href="#local-6989586621679218631"><span class="hs-identifier">binds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218632"><a href="#local-6989586621679218632"><span class="hs-identifier">sigs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218633"><a href="#local-6989586621679218633"><span class="hs-identifier">fams'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218634"><a href="#local-6989586621679218634"><span class="hs-identifier">ats'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218635"><a href="#local-6989586621679218635"><span class="hs-identifier">adts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_ci_decs"><span class="hs-identifier hs-var">cvt_ci_decs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a class declaration&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218622"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-244"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218635"><span class="hs-identifier hs-var">adts'</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>            </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Default data instance declarations&quot;</span><span>
</span><a name="line-246"></a><span>                     </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;are not allowed:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>                   </span><span class="hs-operator hs-var">$$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Outputable.ppr</span><span> </span><a href="#local-6989586621679218635"><span class="hs-identifier hs-var">adts'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218636"><a href="#local-6989586621679218636"><span class="hs-identifier">at_defs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679218623"><span class="hs-identifier hs-var">cvt_at_def</span></a><span> </span><a href="#local-6989586621679218634"><span class="hs-identifier hs-var">ats'</span></a><span>
</span><a name="line-249"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-250"></a><span>          </span><span class="hs-identifier hs-var">ClassDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdCExt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-251"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdCtxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218627"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218628"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218629"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-252"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-253"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFDs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218630"><span class="hs-identifier hs-var">fds'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdSigs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.mkClassOpSigs</span><span> </span><a href="#local-6989586621679218632"><span class="hs-identifier hs-var">sigs'</span></a><span>
</span><a name="line-254"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdMeths</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218631"><span class="hs-identifier hs-var">binds'</span></a><span>
</span><a name="line-255"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218633"><span class="hs-identifier hs-var">fams'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATDefs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218636"><span class="hs-identifier hs-var">at_defs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDocs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-256"></a><span>                              </span><span class="hs-comment">-- no docs in TH ^^</span><span>
</span><a name="line-257"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-259"></a><span>    </span><span class="hs-identifier">cvt_at_def</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LTyFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LTyFamDefltEqn</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-comment">-- Very similar to what happens in RdrHsSyn.mkClassDecl</span><span>
</span><a name="line-261"></a><span>    </span><a name="local-6989586621679218623"><a href="#local-6989586621679218623"><span class="hs-identifier">cvt_at_def</span></a></a><span> </span><a name="local-6989586621679218624"><a href="#local-6989586621679218624"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">RdrHsSyn.mkATDefault</span><span> </span><a href="#local-6989586621679218624"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-262"></a><span>                        </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218625"><a href="#local-6989586621679218625"><span class="hs-identifier">def</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679218625"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-263"></a><span>                        </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679218626"><a href="#local-6989586621679218626"><span class="hs-identifier">msg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><a href="#local-6989586621679218626"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InstanceD</span><span> </span><a name="local-6989586621679218637"><a href="#local-6989586621679218637"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679218638"><a href="#local-6989586621679218638"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218639"><a href="#local-6989586621679218639"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679218640"><a href="#local-6989586621679218640"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218643"><a href="#local-6989586621679218643"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;an instance declaration&quot;</span><span>
</span><a name="line-267"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218644"><a href="#local-6989586621679218644"><span class="hs-identifier">binds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218645"><a href="#local-6989586621679218645"><span class="hs-identifier">sigs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218646"><a href="#local-6989586621679218646"><span class="hs-identifier">fams'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218647"><a href="#local-6989586621679218647"><span class="hs-identifier">ats'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218648"><a href="#local-6989586621679218648"><span class="hs-identifier">adts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_ci_decs"><span class="hs-identifier hs-var">cvt_ci_decs</span></a><span> </span><a href="#local-6989586621679218643"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679218640"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-268"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218646"><span class="hs-identifier hs-var">fams'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#mkBadDecMsg"><span class="hs-identifier hs-var">mkBadDecMsg</span></a><span> </span><a href="#local-6989586621679218643"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679218646"><span class="hs-identifier hs-var">fams'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218649"><a href="#local-6989586621679218649"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679218638"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-270"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218650"><a href="#local-6989586621679218650"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218651"><a href="#local-6989586621679218651"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218639"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-271"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218652"><a href="#local-6989586621679218652"><span class="hs-identifier">inst_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mkHsQualTy"><span class="hs-identifier hs-var">mkHsQualTy</span></a><span> </span><a href="#local-6989586621679218638"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218650"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218649"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218650"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218651"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-272"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">InstD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ClsInstD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-273"></a><span>          </span><span class="hs-identifier hs-var">ClsInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_poly_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679218652"><span class="hs-identifier hs-var">inst_ty'</span></a><span>
</span><a name="line-274"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218644"><span class="hs-identifier hs-var">binds'</span></a><span>
</span><a name="line-275"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_sigs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.mkClassOpSigs</span><span> </span><a href="#local-6989586621679218645"><span class="hs-identifier hs-var">sigs'</span></a><span>
</span><a name="line-276"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_tyfam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218647"><span class="hs-identifier hs-var">ats'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218648"><span class="hs-identifier hs-var">adts'</span></a><span>
</span><a name="line-277"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_overlap_mode</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218650"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679218641"><span class="hs-identifier hs-var">overlap</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218637"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-279"></a><span>  </span><a name="local-6989586621679218641"><a href="#local-6989586621679218641"><span class="hs-identifier">overlap</span></a></a><span> </span><a name="local-6989586621679218642"><a href="#local-6989586621679218642"><span class="hs-identifier">pragma</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679218642"><span class="hs-identifier hs-var">pragma</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-281"></a><span>      </span><span class="hs-identifier hs-var">TH.Overlaps</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Hs.Overlaps</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;OVERLAPS&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>      </span><span class="hs-identifier hs-var">TH.Overlappable</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Hs.Overlappable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;OVERLAPPABLE&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>      </span><span class="hs-identifier hs-var">TH.Overlapping</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Hs.Overlapping</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;OVERLAPPING&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>      </span><span class="hs-identifier hs-var">TH.Incoherent</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Hs.Incoherent</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;INCOHERENT&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForeignD</span><span> </span><a name="local-6989586621679218653"><a href="#local-6989586621679218653"><span class="hs-identifier">ford</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218654"><a href="#local-6989586621679218654"><span class="hs-identifier">ford'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtForD"><span class="hs-identifier hs-var">cvtForD</span></a><span> </span><a href="#local-6989586621679218653"><span class="hs-identifier hs-var">ford</span></a><span>
</span><a name="line-291"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ForD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679218654"><span class="hs-identifier hs-var">ford'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamilyD</span><span> </span><a name="local-6989586621679218655"><a href="#local-6989586621679218655"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218656"><a href="#local-6989586621679218656"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218657"><a href="#local-6989586621679218657"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679218658"><a href="#local-6989586621679218658"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218659"><a href="#local-6989586621679218659"><span class="hs-identifier">tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679218655"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679218656"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-295"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218660"><a href="#local-6989586621679218660"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtMaybeKindToFamilyResultSig"><span class="hs-identifier hs-var">cvtMaybeKindToFamilyResultSig</span></a><span> </span><a href="#local-6989586621679218657"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-296"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-297"></a><span>         </span><span class="hs-identifier hs-var">FamilyDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">DataFamily</span><span> </span><a href="#local-6989586621679218658"><span class="hs-identifier hs-var">tc'</span></a><span> </span><a href="#local-6989586621679218659"><span class="hs-identifier hs-var">tvs'</span></a><span> </span><span class="hs-identifier hs-var">Prefix</span><span> </span><a href="#local-6989586621679218660"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataInstD</span><span> </span><a name="local-6989586621679218661"><a href="#local-6989586621679218661"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218662"><a href="#local-6989586621679218662"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621679218663"><a href="#local-6989586621679218663"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679218664"><a href="#local-6989586621679218664"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621679218665"><a href="#local-6989586621679218665"><span class="hs-identifier">constrs</span></a></a><span> </span><a name="local-6989586621679218666"><a href="#local-6989586621679218666"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218667"><a href="#local-6989586621679218667"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218668"><a href="#local-6989586621679218668"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218669"><a href="#local-6989586621679218669"><span class="hs-identifier">bndrs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218670"><a href="#local-6989586621679218670"><span class="hs-identifier">typats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_datainst_hdr"><span class="hs-identifier hs-var">cvt_datainst_hdr</span></a><span> </span><a href="#local-6989586621679218661"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218662"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679218663"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-301"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218671"><a href="#local-6989586621679218671"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">traverse</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679218664"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-302"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218672"><a href="#local-6989586621679218672"><span class="hs-identifier">cons'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtConstr"><span class="hs-identifier hs-var">cvtConstr</span></a><span> </span><a href="#local-6989586621679218665"><span class="hs-identifier hs-var">constrs</span></a><span>
</span><a name="line-303"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218673"><a href="#local-6989586621679218673"><span class="hs-identifier">derivs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDerivs"><span class="hs-identifier hs-var">cvtDerivs</span></a><span> </span><a href="#local-6989586621679218666"><span class="hs-identifier hs-var">derivs</span></a><span>
</span><a name="line-304"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218674"><a href="#local-6989586621679218674"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-305"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DataType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-306"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218667"><span class="hs-identifier hs-var">ctxt'</span></a><span>
</span><a name="line-307"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218671"><span class="hs-identifier hs-var">ksig'</span></a><span>
</span><a name="line-308"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218672"><span class="hs-identifier hs-var">cons'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218673"><span class="hs-identifier hs-var">derivs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">InstD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DataFamInstD</span><span>
</span><a name="line-311"></a><span>           </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-312"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkHsImplicitBndrs</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-313"></a><span>                           </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-314"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218668"><span class="hs-identifier hs-var">tc'</span></a><span>
</span><a name="line-315"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218669"><span class="hs-identifier hs-var">bndrs'</span></a><span>
</span><a name="line-316"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218670"><span class="hs-identifier hs-var">typats'</span></a><span>
</span><a name="line-317"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218674"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-318"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewtypeInstD</span><span> </span><a name="local-6989586621679218675"><a href="#local-6989586621679218675"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218676"><a href="#local-6989586621679218676"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621679218677"><a href="#local-6989586621679218677"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679218678"><a href="#local-6989586621679218678"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621679218679"><a href="#local-6989586621679218679"><span class="hs-identifier">constr</span></a></a><span> </span><a name="local-6989586621679218680"><a href="#local-6989586621679218680"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218681"><a href="#local-6989586621679218681"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218682"><a href="#local-6989586621679218682"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218683"><a href="#local-6989586621679218683"><span class="hs-identifier">bndrs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218684"><a href="#local-6989586621679218684"><span class="hs-identifier">typats'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_datainst_hdr"><span class="hs-identifier hs-var">cvt_datainst_hdr</span></a><span> </span><a href="#local-6989586621679218675"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679218676"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621679218677"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-322"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218685"><a href="#local-6989586621679218685"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">traverse</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679218678"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-323"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218686"><a href="#local-6989586621679218686"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtConstr"><span class="hs-identifier hs-var">cvtConstr</span></a><span> </span><a href="#local-6989586621679218679"><span class="hs-identifier hs-var">constr</span></a><span>
</span><a name="line-324"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218687"><a href="#local-6989586621679218687"><span class="hs-identifier">derivs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDerivs"><span class="hs-identifier hs-var">cvtDerivs</span></a><span> </span><a href="#local-6989586621679218680"><span class="hs-identifier hs-var">derivs</span></a><span>
</span><a name="line-325"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218688"><a href="#local-6989586621679218688"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-326"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NewType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-327"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218681"><span class="hs-identifier hs-var">ctxt'</span></a><span>
</span><a name="line-328"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218685"><span class="hs-identifier hs-var">ksig'</span></a><span>
</span><a name="line-329"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218686"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218687"><span class="hs-identifier hs-var">derivs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-330"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">InstD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DataFamInstD</span><span>
</span><a name="line-331"></a><span>           </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-332"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkHsImplicitBndrs</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-333"></a><span>                           </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-334"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218682"><span class="hs-identifier hs-var">tc'</span></a><span>
</span><a name="line-335"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218683"><span class="hs-identifier hs-var">bndrs'</span></a><span>
</span><a name="line-336"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218684"><span class="hs-identifier hs-var">typats'</span></a><span>
</span><a name="line-337"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218688"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-338"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynInstD</span><span> </span><a name="local-6989586621679218689"><a href="#local-6989586621679218689"><span class="hs-identifier">eqn</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679218690"><a href="#local-6989586621679218690"><span class="hs-identifier">eqn'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtTySynEqn"><span class="hs-identifier hs-var">cvtTySynEqn</span></a><span> </span><a href="#local-6989586621679218689"><span class="hs-identifier hs-var">eqn</span></a><span>
</span><a name="line-342"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">InstD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyFamInstD</span><span>
</span><a name="line-343"></a><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-344"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TyFamInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218690"><span class="hs-identifier hs-var">eqn'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">OpenTypeFamilyD</span><span> </span><a name="local-6989586621679218691"><a href="#local-6989586621679218691"><span class="hs-identifier">head</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218692"><a href="#local-6989586621679218692"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218693"><a href="#local-6989586621679218693"><span class="hs-identifier">tyvars'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218694"><a href="#local-6989586621679218694"><span class="hs-identifier">result'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218695"><a href="#local-6989586621679218695"><span class="hs-identifier">injectivity'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tyfam_head"><span class="hs-identifier hs-var">cvt_tyfam_head</span></a><span> </span><a href="#local-6989586621679218691"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-348"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-349"></a><span>         </span><span class="hs-identifier hs-var">FamilyDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">OpenTypeFamily</span><span> </span><a href="#local-6989586621679218692"><span class="hs-identifier hs-var">tc'</span></a><span> </span><a href="#local-6989586621679218693"><span class="hs-identifier hs-var">tyvars'</span></a><span> </span><span class="hs-identifier hs-var">Prefix</span><span> </span><a href="#local-6989586621679218694"><span class="hs-identifier hs-var">result'</span></a><span> </span><a href="#local-6989586621679218695"><span class="hs-identifier hs-var">injectivity'</span></a><span>
</span><a name="line-350"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClosedTypeFamilyD</span><span> </span><a name="local-6989586621679218696"><a href="#local-6989586621679218696"><span class="hs-identifier">head</span></a></a><span> </span><a name="local-6989586621679218697"><a href="#local-6989586621679218697"><span class="hs-identifier">eqns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218698"><a href="#local-6989586621679218698"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218699"><a href="#local-6989586621679218699"><span class="hs-identifier">tyvars'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218700"><a href="#local-6989586621679218700"><span class="hs-identifier">result'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218701"><a href="#local-6989586621679218701"><span class="hs-identifier">injectivity'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tyfam_head"><span class="hs-identifier hs-var">cvt_tyfam_head</span></a><span> </span><a href="#local-6989586621679218696"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-354"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218702"><a href="#local-6989586621679218702"><span class="hs-identifier">eqns'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtTySynEqn"><span class="hs-identifier hs-var">cvtTySynEqn</span></a><span> </span><a href="#local-6989586621679218697"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-355"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-356"></a><span>         </span><span class="hs-identifier hs-var">FamilyDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClosedTypeFamily</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679218702"><span class="hs-identifier hs-var">eqns'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218698"><span class="hs-identifier hs-var">tc'</span></a><span> </span><a href="#local-6989586621679218699"><span class="hs-identifier hs-var">tyvars'</span></a><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-357"></a><span>                           </span><a href="#local-6989586621679218700"><span class="hs-identifier hs-var">result'</span></a><span> </span><a href="#local-6989586621679218701"><span class="hs-identifier hs-var">injectivity'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.RoleAnnotD</span><span> </span><a name="local-6989586621679218703"><a href="#local-6989586621679218703"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218704"><a href="#local-6989586621679218704"><span class="hs-identifier">roles</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218705"><a href="#local-6989586621679218705"><span class="hs-identifier">tc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218703"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-361"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218706"><a href="#local-6989586621679218706"><span class="hs-identifier">roles'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Convert.html#cvtRole"><span class="hs-identifier hs-var">cvtRole</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218704"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-362"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RoleAnnotD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RoleAnnotDecl</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679218705"><span class="hs-identifier hs-var">tc'</span></a><span> </span><a href="#local-6989586621679218706"><span class="hs-identifier hs-var">roles'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.StandaloneDerivD</span><span> </span><a name="local-6989586621679218707"><a href="#local-6989586621679218707"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679218708"><a href="#local-6989586621679218708"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679218709"><a href="#local-6989586621679218709"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218710"><a href="#local-6989586621679218710"><span class="hs-identifier">cxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679218708"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-366"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218711"><a href="#local-6989586621679218711"><span class="hs-identifier">ds'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="Convert.html#cvtDerivStrategy"><span class="hs-identifier hs-var">cvtDerivStrategy</span></a><span> </span><a href="#local-6989586621679218707"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-367"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218712"><a href="#local-6989586621679218712"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218713"><a href="#local-6989586621679218713"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218709"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-368"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218714"><a href="#local-6989586621679218714"><span class="hs-identifier">inst_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mkHsQualTy"><span class="hs-identifier hs-var">mkHsQualTy</span></a><span> </span><a href="#local-6989586621679218708"><span class="hs-identifier hs-var">cxt</span></a><span> </span><a href="#local-6989586621679218712"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218710"><span class="hs-identifier hs-var">cxt'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218712"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218713"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-369"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DerivD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-370"></a><span>         </span><span class="hs-identifier hs-var">DerivDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">deriv_ext</span><span> </span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-371"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">deriv_strategy</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218711"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-372"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">deriv_type</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkLHsSigWcType</span><span> </span><a href="#local-6989586621679218714"><span class="hs-identifier hs-var">inst_ty'</span></a><span>
</span><a name="line-373"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">deriv_overlap_mode</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.DefaultSigD</span><span> </span><a name="local-6989586621679218715"><a href="#local-6989586621679218715"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218716"><a href="#local-6989586621679218716"><span class="hs-identifier">typ</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218717"><a href="#local-6989586621679218717"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218715"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-377"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218718"><a href="#local-6989586621679218718"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218716"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-378"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-379"></a><span>                     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ClassOpSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218717"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679218718"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.PatSynD</span><span> </span><a name="local-6989586621679218719"><a href="#local-6989586621679218719"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218720"><a href="#local-6989586621679218720"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679218721"><a href="#local-6989586621679218721"><span class="hs-identifier">dir</span></a></a><span> </span><a name="local-6989586621679218722"><a href="#local-6989586621679218722"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218734"><a href="#local-6989586621679218734"><span class="hs-identifier">nm'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679218719"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-383"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218735"><a href="#local-6989586621679218735"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679218723"><span class="hs-identifier hs-var">cvtArgs</span></a><span> </span><a href="#local-6989586621679218720"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-384"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218736"><a href="#local-6989586621679218736"><span class="hs-identifier">dir'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679218724"><span class="hs-identifier hs-var">cvtDir</span></a><span> </span><a href="#local-6989586621679218734"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621679218721"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-385"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218737"><a href="#local-6989586621679218737"><span class="hs-identifier">pat'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679218722"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-386"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.ValD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">PatSynBind</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-387"></a><span>           </span><span class="hs-identifier hs-var">PSB</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679218734"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621679218735"><span class="hs-identifier hs-var">args'</span></a><span> </span><a href="#local-6989586621679218737"><span class="hs-identifier hs-var">pat'</span></a><span> </span><a href="#local-6989586621679218736"><span class="hs-identifier hs-var">dir'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-388"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-389"></a><span>    </span><a name="local-6989586621679218723"><a href="#local-6989586621679218723"><span class="hs-identifier">cvtArgs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.PrefixPatSyn</span><span> </span><a name="local-6989586621679218725"><a href="#local-6989586621679218725"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.PrefixCon</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218725"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-390"></a><span>    </span><span class="hs-identifier">cvtArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.InfixPatSyn</span><span> </span><a name="local-6989586621679218726"><a href="#local-6989586621679218726"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679218727"><a href="#local-6989586621679218727"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.InfixCon</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218726"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218727"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-391"></a><span>    </span><span class="hs-identifier">cvtArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.RecordPatSyn</span><span> </span><a name="local-6989586621679218728"><a href="#local-6989586621679218728"><span class="hs-identifier">sels</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218729"><a href="#local-6989586621679218729"><span class="hs-identifier">sels'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679218728"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-393"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218730"><a href="#local-6989586621679218730"><span class="hs-identifier">vars'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">mkNameS</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218728"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-394"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RecCon</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-identifier hs-var">RecordPatSynField</span><span> </span><a href="#local-6989586621679218729"><span class="hs-identifier hs-var">sels'</span></a><span> </span><a href="#local-6989586621679218730"><span class="hs-identifier hs-var">vars'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span>    </span><a name="local-6989586621679218724"><a href="#local-6989586621679218724"><span class="hs-identifier">cvtDir</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Unidir</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Unidirectional</span><span>
</span><a name="line-397"></a><span>    </span><span class="hs-identifier">cvtDir</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">ImplBidir</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">ImplicitBidirectional</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-identifier">cvtDir</span><span> </span><a name="local-6989586621679218731"><a href="#local-6989586621679218731"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplBidir</span><span> </span><a name="local-6989586621679218732"><a href="#local-6989586621679218732"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-399"></a><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218733"><a href="#local-6989586621679218733"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtClause"><span class="hs-identifier hs-var">cvtClause</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkPrefixFunRhs</span><span> </span><a href="#local-6989586621679218731"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218732"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-400"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExplicitBidirectional</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkMatchGroup</span><span> </span><span class="hs-identifier hs-var">FromSource</span><span> </span><a href="#local-6989586621679218733"><span class="hs-identifier hs-var">ms</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.PatSynSigD</span><span> </span><a name="local-6989586621679218738"><a href="#local-6989586621679218738"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218739"><a href="#local-6989586621679218739"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218740"><a href="#local-6989586621679218740"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679218738"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-404"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218741"><a href="#local-6989586621679218741"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPatSynSigTy"><span class="hs-identifier hs-var">cvtPatSynSigTy</span></a><span> </span><a href="#local-6989586621679218739"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-405"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">PatSynSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218740"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679218741"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-comment">-- Implicit parameter bindings are handled in cvtLocalDecs and</span><span>
</span><a name="line-408"></a><span class="hs-comment">-- cvtImplicitParamBind. They are not allowed in any other scope, so</span><span>
</span><a name="line-409"></a><span class="hs-comment">-- reaching this case indicates an error.</span><span>
</span><a name="line-410"></a><span class="hs-identifier">cvtDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ImplicitParamBindD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Implicit parameter binding only allowed in let or where&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-414"></a><span class="hs-identifier">cvtTySynEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LTyFamInstEqn</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><a name="cvtTySynEqn"><a href="Convert.html#cvtTySynEqn"><span class="hs-identifier">cvtTySynEqn</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynEqn</span><span> </span><a name="local-6989586621679218742"><a href="#local-6989586621679218742"><span class="hs-identifier">mb_bndrs</span></a></a><span> </span><a name="local-6989586621679218743"><a href="#local-6989586621679218743"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679218744"><a href="#local-6989586621679218744"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218745"><a href="#local-6989586621679218745"><span class="hs-identifier">mb_bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_tv"><span class="hs-identifier hs-var">cvt_tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218742"><span class="hs-identifier hs-var">mb_bndrs</span></a><span>
</span><a name="line-417"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218746"><a href="#local-6989586621679218746"><span class="hs-identifier">head_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218747"><a href="#local-6989586621679218747"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#split_ty_app"><span class="hs-identifier hs-var">split_ty_app</span></a><span> </span><a href="#local-6989586621679218743"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-418"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679218746"><span class="hs-identifier hs-var">head_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-419"></a><span>           </span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679218748"><a href="#local-6989586621679218748"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218749"><a href="#local-6989586621679218749"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218748"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-420"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218750"><a href="#local-6989586621679218750"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218744"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-421"></a><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218751"><a href="#local-6989586621679218751"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Convert.html#wrap_tyarg"><span class="hs-identifier hs-var">wrap_tyarg</span></a><span> </span><a href="#local-6989586621679218747"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-422"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsImplicitBndrs</span><span>
</span><a name="line-423"></a><span>                            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-424"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218749"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-425"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218745"><span class="hs-identifier hs-var">mb_bndrs'</span></a><span>
</span><a name="line-426"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218751"><span class="hs-identifier hs-var">args'</span></a><span>
</span><a name="line-427"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-428"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218750"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-429"></a><span>           </span><span class="hs-identifier hs-var">InfixT</span><span> </span><a name="local-6989586621679218752"><a href="#local-6989586621679218752"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679218753"><a href="#local-6989586621679218753"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218754"><a href="#local-6989586621679218754"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218755"><a href="#local-6989586621679218755"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218753"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-430"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218756"><a href="#local-6989586621679218756"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218752"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-6989586621679218754"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-431"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218757"><a href="#local-6989586621679218757"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679218744"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-432"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsImplicitBndrs</span><span>
</span><a name="line-433"></a><span>                                      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-434"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218755"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-435"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218745"><span class="hs-identifier hs-var">mb_bndrs'</span></a><span>
</span><a name="line-436"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>   </span><span class="hs-glyph">=</span><span>
</span><a name="line-437"></a><span>                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a href="#local-6989586621679218756"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679218747"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-438"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.Infix</span><span>
</span><a name="line-439"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218757"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-440"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Invalid type family instance LHS:&quot;</span><span>
</span><a name="line-441"></a><span>                          </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679218743"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-445"></a><span class="hs-identifier">cvt_ci_decs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span>
</span><a name="line-446"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBinds</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">,</span><span>
</span><a name="line-447"></a><span>                     </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-448"></a><span>                     </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LFamilyDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-449"></a><span>                     </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LTyFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-450"></a><span>                     </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LDataFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- Convert the declarations inside a class or instance decl</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- ie signatures, bindings, and associated types</span><span>
</span><a name="line-453"></a><a name="cvt_ci_decs"><a href="Convert.html#cvt_ci_decs"><span class="hs-identifier">cvt_ci_decs</span></a></a><span> </span><a name="local-6989586621679218758"><a href="#local-6989586621679218758"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679218759"><a href="#local-6989586621679218759"><span class="hs-identifier">decs</span></a></a><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218760"><a href="#local-6989586621679218760"><span class="hs-identifier">decs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDecs"><span class="hs-identifier hs-var">cvtDecs</span></a><span> </span><a href="#local-6989586621679218759"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-455"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218761"><a href="#local-6989586621679218761"><span class="hs-identifier">ats'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218762"><a href="#local-6989586621679218762"><span class="hs-identifier">bind_sig_decs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_tyfam_inst"><span class="hs-identifier hs-var">is_tyfam_inst</span></a><span> </span><a href="#local-6989586621679218760"><span class="hs-identifier hs-var">decs'</span></a><span>
</span><a name="line-456"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218763"><a href="#local-6989586621679218763"><span class="hs-identifier">adts'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218764"><a href="#local-6989586621679218764"><span class="hs-identifier">no_ats'</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_datafam_inst"><span class="hs-identifier hs-var">is_datafam_inst</span></a><span> </span><a href="#local-6989586621679218762"><span class="hs-identifier hs-var">bind_sig_decs'</span></a><span>
</span><a name="line-457"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218765"><a href="#local-6989586621679218765"><span class="hs-identifier">sigs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218766"><a href="#local-6989586621679218766"><span class="hs-identifier">prob_binds'</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_sig"><span class="hs-identifier hs-var">is_sig</span></a><span> </span><a href="#local-6989586621679218764"><span class="hs-identifier hs-var">no_ats'</span></a><span>
</span><a name="line-458"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218767"><a href="#local-6989586621679218767"><span class="hs-identifier">binds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218768"><a href="#local-6989586621679218768"><span class="hs-identifier">prob_fams'</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_bind"><span class="hs-identifier hs-var">is_bind</span></a><span> </span><a href="#local-6989586621679218766"><span class="hs-identifier hs-var">prob_binds'</span></a><span>
</span><a name="line-459"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218769"><a href="#local-6989586621679218769"><span class="hs-identifier">fams'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218770"><a href="#local-6989586621679218770"><span class="hs-identifier">bads</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_fam_decl"><span class="hs-identifier hs-var">is_fam_decl</span></a><span> </span><a href="#local-6989586621679218768"><span class="hs-identifier hs-var">prob_fams'</span></a><span>
</span><a name="line-460"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218770"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#mkBadDecMsg"><span class="hs-identifier hs-var">mkBadDecMsg</span></a><span> </span><a href="#local-6989586621679218758"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679218770"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>          </span><span class="hs-comment">--We use FromSource as the origin of the bind</span><span>
</span><a name="line-462"></a><span>          </span><span class="hs-comment">-- because the TH declaration is user-written</span><span>
</span><a name="line-463"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToBag</span><span> </span><a href="#local-6989586621679218767"><span class="hs-identifier hs-var">binds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218765"><span class="hs-identifier hs-var">sigs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218769"><span class="hs-identifier hs-var">fams'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218761"><span class="hs-identifier hs-var">ats'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218763"><span class="hs-identifier hs-var">adts'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-466"></a><span class="hs-identifier">cvt_tycl_hdr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Cxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndr</span><span class="hs-special">]</span><span>
</span><a name="line-467"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-468"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-469"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-470"></a><a name="cvt_tycl_hdr"><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier">cvt_tycl_hdr</span></a></a><span> </span><a name="local-6989586621679218771"><a href="#local-6989586621679218771"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679218772"><a href="#local-6989586621679218772"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218773"><a href="#local-6989586621679218773"><span class="hs-identifier">tvs</span></a></a><span>
</span><a name="line-471"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218774"><a href="#local-6989586621679218774"><span class="hs-identifier">cxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679218771"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-472"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218775"><a href="#local-6989586621679218775"><span class="hs-identifier">tc'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218772"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-473"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218776"><a href="#local-6989586621679218776"><span class="hs-identifier">tvs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtTvs"><span class="hs-identifier hs-var">cvtTvs</span></a><span> </span><a href="#local-6989586621679218773"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-474"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218774"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218775"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218776"><span class="hs-identifier hs-var">tvs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-identifier">cvt_datainst_hdr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Cxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span>
</span><a name="line-478"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-479"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-480"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span>
</span><a name="line-481"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HsTyPats</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><a name="cvt_datainst_hdr"><a href="Convert.html#cvt_datainst_hdr"><span class="hs-identifier">cvt_datainst_hdr</span></a></a><span> </span><a name="local-6989586621679218777"><a href="#local-6989586621679218777"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679218778"><a href="#local-6989586621679218778"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621679218779"><a href="#local-6989586621679218779"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-483"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218780"><a href="#local-6989586621679218780"><span class="hs-identifier">cxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679218777"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-484"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218781"><a href="#local-6989586621679218781"><span class="hs-identifier">bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_tv"><span class="hs-identifier hs-var">cvt_tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679218778"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-485"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679218782"><a href="#local-6989586621679218782"><span class="hs-identifier">head_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218783"><a href="#local-6989586621679218783"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#split_ty_app"><span class="hs-identifier hs-var">split_ty_app</span></a><span> </span><a href="#local-6989586621679218779"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-486"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679218782"><span class="hs-identifier hs-var">head_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-487"></a><span>          </span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679218784"><a href="#local-6989586621679218784"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218785"><a href="#local-6989586621679218785"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218784"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-488"></a><span>                        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679218786"><a href="#local-6989586621679218786"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Convert.html#wrap_tyarg"><span class="hs-identifier hs-var">wrap_tyarg</span></a><span> </span><a href="#local-6989586621679218783"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-489"></a><span>                        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218780"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218785"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218781"><span class="hs-identifier hs-var">bndrs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218786"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-490"></a><span>          </span><span class="hs-identifier hs-var">InfixT</span><span> </span><a name="local-6989586621679218787"><a href="#local-6989586621679218787"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679218788"><a href="#local-6989586621679218788"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679218789"><a href="#local-6989586621679218789"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218790"><a href="#local-6989586621679218790"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679218788"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-491"></a><span>                                </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218791"><a href="#local-6989586621679218791"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679218787"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-6989586621679218789"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-492"></a><span>                                </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218780"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218790"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218781"><span class="hs-identifier hs-var">bndrs'</span></a><span class="hs-special">,</span><span>
</span><a name="line-493"></a><span>                                         </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a href="#local-6989586621679218791"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679218783"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-494"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Invalid type instance header:&quot;</span><span>
</span><a name="line-495"></a><span>                          </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679218779"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-498"></a><span class="hs-identifier">cvt_tyfam_head</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TypeFamilyHead</span><span>
</span><a name="line-499"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-500"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-501"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Hs.LFamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-502"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LInjectivityAnn</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><a name="cvt_tyfam_head"><a href="Convert.html#cvt_tyfam_head"><span class="hs-identifier">cvt_tyfam_head</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeFamilyHead</span><span> </span><a name="local-6989586621679218792"><a href="#local-6989586621679218792"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679218793"><a href="#local-6989586621679218793"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-6989586621679218794"><a href="#local-6989586621679218794"><span class="hs-identifier">result</span></a></a><span> </span><a name="local-6989586621679218795"><a href="#local-6989586621679218795"><span class="hs-identifier">injectivity</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-505"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679218796"><a href="#local-6989586621679218796"><span class="hs-identifier">tc'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679218797"><a href="#local-6989586621679218797"><span class="hs-identifier">tyvars'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tycl_hdr"><span class="hs-identifier hs-var">cvt_tycl_hdr</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679218792"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679218793"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-506"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218798"><a href="#local-6989586621679218798"><span class="hs-identifier">result'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtFamilyResultSig"><span class="hs-identifier hs-var">cvtFamilyResultSig</span></a><span> </span><a href="#local-6989586621679218794"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-507"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218799"><a href="#local-6989586621679218799"><span class="hs-identifier">injectivity'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="Convert.html#cvtInjectivityAnnotation"><span class="hs-identifier hs-var">cvtInjectivityAnnotation</span></a><span> </span><a href="#local-6989586621679218795"><span class="hs-identifier hs-var">injectivity</span></a><span>
</span><a name="line-508"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218796"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218797"><span class="hs-identifier hs-var">tyvars'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218798"><span class="hs-identifier hs-var">result'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218799"><span class="hs-identifier hs-var">injectivity'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-511"></a><span class="hs-comment">--              Partitioning declarations</span><span>
</span><a name="line-512"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-identifier">is_fam_decl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFamilyDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-515"></a><a name="is_fam_decl"><a href="Convert.html#is_fam_decl"><span class="hs-identifier">is_fam_decl</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218800"><a href="#local-6989586621679218800"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyClD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218801"><a href="#local-6989586621679218801"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218800"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218801"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span class="hs-identifier">is_fam_decl</span><span> </span><a name="local-6989586621679218802"><a href="#local-6989586621679218802"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218802"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-identifier">is_tyfam_inst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LTyFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><a name="is_tyfam_inst"><a href="Convert.html#is_tyfam_inst"><span class="hs-identifier">is_tyfam_inst</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218803"><a href="#local-6989586621679218803"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.InstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyFamInstD</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218804"><a href="#local-6989586621679218804"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218803"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218804"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-521"></a><span class="hs-identifier">is_tyfam_inst</span><span> </span><a name="local-6989586621679218805"><a href="#local-6989586621679218805"><span class="hs-identifier">decl</span></a></a><span>
</span><a name="line-522"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218805"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-identifier">is_datafam_inst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-525"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LDataFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-526"></a><a name="is_datafam_inst"><a href="Convert.html#is_datafam_inst"><span class="hs-identifier">is_datafam_inst</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218806"><a href="#local-6989586621679218806"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.InstD</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstD</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218807"><a href="#local-6989586621679218807"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218806"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218807"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span class="hs-identifier">is_datafam_inst</span><span> </span><a name="local-6989586621679218808"><a href="#local-6989586621679218808"><span class="hs-identifier">decl</span></a></a><span>
</span><a name="line-529"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218808"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-identifier">is_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-532"></a><a name="is_sig"><a href="Convert.html#is_sig"><span class="hs-identifier">is_sig</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218809"><a href="#local-6989586621679218809"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679218810"><a href="#local-6989586621679218810"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218809"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218810"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span class="hs-identifier">is_sig</span><span> </span><a name="local-6989586621679218811"><a href="#local-6989586621679218811"><span class="hs-identifier">decl</span></a></a><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218811"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-identifier">is_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-536"></a><a name="is_bind"><a href="Convert.html#is_bind"><span class="hs-identifier">is_bind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218812"><a href="#local-6989586621679218812"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.ValD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679218813"><a href="#local-6989586621679218813"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218812"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679218813"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><span class="hs-identifier">is_bind</span><span> </span><a name="local-6989586621679218814"><a href="#local-6989586621679218814"><span class="hs-identifier">decl</span></a></a><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218814"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-identifier">is_ip_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Dec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">TH.Dec</span><span>
</span><a name="line-540"></a><a name="is_ip_bind"><a href="Convert.html#is_ip_bind"><span class="hs-identifier">is_ip_bind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ImplicitParamBindD</span><span> </span><a name="local-6989586621679218815"><a href="#local-6989586621679218815"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679218816"><a href="#local-6989586621679218816"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218815"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679218816"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-541"></a><span class="hs-identifier">is_ip_bind</span><span> </span><a name="local-6989586621679218817"><a href="#local-6989586621679218817"><span class="hs-identifier">decl</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679218817"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-identifier">mkBadDecMsg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="#local-6989586621679217064"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679217064"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span>
</span><a name="line-544"></a><a name="mkBadDecMsg"><a href="Convert.html#mkBadDecMsg"><span class="hs-identifier">mkBadDecMsg</span></a></a><span> </span><a name="local-6989586621679218818"><a href="#local-6989586621679218818"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679218819"><a href="#local-6989586621679218819"><span class="hs-identifier">bads</span></a></a><span>
</span><a name="line-545"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sep</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal declaration(s) in&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><a href="#local-6989586621679218818"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">colon</span><span>
</span><a name="line-546"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nest</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vcat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Outputable.ppr</span><span> </span><a href="#local-6989586621679218819"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">---------------------------------------------------</span><span>
</span><a name="line-549"></a><span class="hs-comment">--      Data types</span><span>
</span><a name="line-550"></a><span class="hs-comment">---------------------------------------------------</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Con</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LConDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><a name="cvtConstr"><a href="Convert.html#cvtConstr"><span class="hs-identifier">cvtConstr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679218820"><a href="#local-6989586621679218820"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679218821"><a href="#local-6989586621679218821"><span class="hs-identifier">strtys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-555"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218822"><a href="#local-6989586621679218822"><span class="hs-identifier">c'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679218820"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-556"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218823"><a href="#local-6989586621679218823"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_arg"><span class="hs-identifier hs-var">cvt_arg</span></a><span> </span><a href="#local-6989586621679218821"><span class="hs-identifier hs-var">strtys</span></a><span>
</span><a name="line-557"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkConDeclH98</span><span> </span><a href="#local-6989586621679218822"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a href="#local-6989586621679218823"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679218824"><a href="#local-6989586621679218824"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679218825"><a href="#local-6989586621679218825"><span class="hs-identifier">varstrtys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218826"><a href="#local-6989586621679218826"><span class="hs-identifier">c'</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679218824"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-561"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218827"><a href="#local-6989586621679218827"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_id_arg"><span class="hs-identifier hs-var">cvt_id_arg</span></a><span> </span><a href="#local-6989586621679218825"><span class="hs-identifier hs-var">varstrtys</span></a><span>
</span><a name="line-562"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkConDeclH98</span><span> </span><a href="#local-6989586621679218826"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-563"></a><span>                                   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679218827"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><a name="local-6989586621679218828"><a href="#local-6989586621679218828"><span class="hs-identifier">st1</span></a></a><span> </span><a name="local-6989586621679218829"><a href="#local-6989586621679218829"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679218830"><a href="#local-6989586621679218830"><span class="hs-identifier">st2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679218831"><a href="#local-6989586621679218831"><span class="hs-identifier">c'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679218829"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-567"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218832"><a href="#local-6989586621679218832"><span class="hs-identifier">st1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_arg"><span class="hs-identifier hs-var">cvt_arg</span></a><span> </span><a href="#local-6989586621679218828"><span class="hs-identifier hs-var">st1</span></a><span>
</span><a name="line-568"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679218833"><a href="#local-6989586621679218833"><span class="hs-identifier">st2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_arg"><span class="hs-identifier hs-var">cvt_arg</span></a><span> </span><a href="#local-6989586621679218830"><span class="hs-identifier hs-var">st2</span></a><span>
</span><a name="line-569"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkConDeclH98</span><span> </span><a href="#local-6989586621679218831"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a href="#local-6989586621679218832"><span class="hs-identifier hs-var">st1'</span></a><span> </span><a href="#local-6989586621679218833"><span class="hs-identifier hs-var">st2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallC</span><span> </span><a name="local-6989586621679218834"><a href="#local-6989586621679218834"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679218835"><a href="#local-6989586621679218835"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679218836"><a href="#local-6989586621679218836"><span class="hs-identifier">con</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219009"><a href="#local-6989586621679219009"><span class="hs-identifier">tvs'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtTvs"><span class="hs-identifier hs-var">cvtTvs</span></a><span> </span><a href="#local-6989586621679218834"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-573"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219010"><a href="#local-6989586621679219010"><span class="hs-identifier">ctxt'</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679218835"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-574"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679219011"><a href="#local-6989586621679219011"><span class="hs-identifier">con'</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtConstr"><span class="hs-identifier hs-var">cvtConstr</span></a><span> </span><a href="#local-6989586621679218836"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-575"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679218838"><span class="hs-identifier hs-var">add_forall</span></a><span> </span><a href="#local-6989586621679219009"><span class="hs-identifier hs-var">tvs'</span></a><span> </span><a href="#local-6989586621679219010"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><a href="#local-6989586621679219011"><span class="hs-identifier hs-var">con'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-576"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-577"></a><span>    </span><a name="local-6989586621679218837"><a href="#local-6989586621679218837"><span class="hs-identifier">add_cxt</span></a></a><span> </span><a name="local-6989586621679218839"><a href="#local-6989586621679218839"><span class="hs-identifier">lcxt</span></a></a><span>         </span><span class="hs-identifier hs-var">Nothing</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679218839"><span class="hs-identifier hs-var">lcxt</span></a><span>
</span><a name="line-578"></a><span>    </span><span class="hs-identifier">add_cxt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679218840"><a href="#local-6989586621679218840"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679218841"><a href="#local-6989586621679218841"><span class="hs-identifier">cxt1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679218842"><a href="#local-6989586621679218842"><span class="hs-identifier">cxt2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679218840"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679218841"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679218842"><span class="hs-identifier hs-var">cxt2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span>    </span><a name="local-6989586621679218838"><a href="#local-6989586621679218838"><span class="hs-identifier">add_forall</span></a></a><span> </span><a name="local-6989586621679218843"><a href="#local-6989586621679218843"><span class="hs-identifier">tvs'</span></a></a><span> </span><a name="local-6989586621679218844"><a href="#local-6989586621679218844"><span class="hs-identifier">cxt'</span></a></a><span> </span><a name="local-6989586621679218845"><a href="#local-6989586621679218845"><span class="hs-identifier">con</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclGADT</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_qvars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218846"><a href="#local-6989586621679218846"><span class="hs-identifier">qvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218847"><a href="#local-6989586621679218847"><span class="hs-identifier">cxt</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-582"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218845"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218848"><span class="hs-identifier hs-var">all_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-583"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_qvars</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkHsQTvs</span><span> </span><a href="#local-6989586621679218848"><span class="hs-identifier hs-var">all_tvs</span></a><span>
</span><a name="line-584"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218837"><span class="hs-identifier hs-var">add_cxt</span></a><span> </span><a href="#local-6989586621679218844"><span class="hs-identifier hs-var">cxt'</span></a><span> </span><a href="#local-6989586621679218847"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-585"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-586"></a><span>        </span><a name="local-6989586621679218848"><a href="#local-6989586621679218848"><span class="hs-identifier">all_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621679218843"><span class="hs-identifier hs-var">tvs'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621679218846"><span class="hs-identifier hs-var">qvars</span></a><span>
</span><a name="line-587"></a><span>
</span><a name="line-588"></a><span>    </span><span class="hs-identifier">add_forall</span><span> </span><a name="local-6989586621679218849"><a href="#local-6989586621679218849"><span class="hs-identifier">tvs'</span></a></a><span> </span><a name="local-6989586621679218850"><a href="#local-6989586621679218850"><span class="hs-identifier">cxt'</span></a></a><span> </span><a name="local-6989586621679218851"><a href="#local-6989586621679218851"><span class="hs-identifier">con</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclH98</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218852"><a href="#local-6989586621679218852"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679218853"><a href="#local-6989586621679218853"><span class="hs-identifier">cxt</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218851"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679218854"><span class="hs-identifier hs-var">all_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218854"><span class="hs-identifier hs-var">all_tvs</span></a><span>
</span><a name="line-591"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679218837"><span class="hs-identifier hs-var">add_cxt</span></a><span> </span><a href="#local-6989586621679218850"><span class="hs-identifier hs-var">cxt'</span></a><span> </span><a href="#local-6989586621679218853"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-592"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-593"></a><span>        </span><a name="local-6989586621679218854"><a href="#local-6989586621679218854"><span class="hs-identifier">all_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621679218849"><span class="hs-identifier hs-var">tvs'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679218852"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-594"></a><span>
</span><a name="line-595"></a><span>    </span><span class="hs-identifier">add_forall</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XConDecl</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;cvtConstr&quot;</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GadtC</span><span> </span><a name="local-6989586621679219012"><a href="#local-6989586621679219012"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679219013"><a href="#local-6989586621679219013"><span class="hs-identifier">strtys</span></a></a><span> </span><a name="local-6989586621679219014"><a href="#local-6989586621679219014"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219015"><a href="#local-6989586621679219015"><span class="hs-identifier">c'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219012"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-599"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219016"><a href="#local-6989586621679219016"><span class="hs-identifier">args</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_arg"><span class="hs-identifier hs-var">cvt_arg</span></a><span> </span><a href="#local-6989586621679219013"><span class="hs-identifier hs-var">strtys</span></a><span>
</span><a name="line-600"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679219017"><a href="#local-6989586621679219017"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219014"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-601"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219018"><a href="#local-6989586621679219018"><span class="hs-identifier">c_ty</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#mk_arr_apps"><span class="hs-identifier hs-var">mk_arr_apps</span></a><span> </span><a href="#local-6989586621679219016"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679219017"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-602"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkGadtDecl</span><span> </span><a href="#local-6989586621679219015"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679219018"><span class="hs-identifier hs-var">c_ty</span></a><span class="hs-special">}</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-identifier">cvtConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecGadtC</span><span> </span><a name="local-6989586621679219019"><a href="#local-6989586621679219019"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679219020"><a href="#local-6989586621679219020"><span class="hs-identifier">varstrtys</span></a></a><span> </span><a name="local-6989586621679219021"><a href="#local-6989586621679219021"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219022"><a href="#local-6989586621679219022"><span class="hs-identifier">c'</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219019"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-606"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219023"><a href="#local-6989586621679219023"><span class="hs-identifier">ty'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219021"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-607"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219024"><a href="#local-6989586621679219024"><span class="hs-identifier">rec_flds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_id_arg"><span class="hs-identifier hs-var">cvt_id_arg</span></a><span> </span><a href="#local-6989586621679219020"><span class="hs-identifier hs-var">varstrtys</span></a><span>
</span><a name="line-608"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219025"><a href="#local-6989586621679219025"><span class="hs-identifier">rec_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsFunTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-609"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRecTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219024"><span class="hs-identifier hs-var">rec_flds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219023"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkGadtDecl</span><span> </span><a href="#local-6989586621679219022"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679219025"><span class="hs-identifier hs-var">rec_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">cvtSrcUnpackedness</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.SourceUnpackedness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcUnpackedness</span><span>
</span><a name="line-613"></a><a name="cvtSrcUnpackedness"><a href="Convert.html#cvtSrcUnpackedness"><span class="hs-identifier">cvtSrcUnpackedness</span></a></a><span> </span><span class="hs-identifier hs-var">NoSourceUnpackedness</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NoSrcUnpack</span><span>
</span><a name="line-614"></a><span class="hs-identifier">cvtSrcUnpackedness</span><span> </span><span class="hs-identifier hs-var">SourceNoUnpack</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SrcNoUnpack</span><span>
</span><a name="line-615"></a><span class="hs-identifier">cvtSrcUnpackedness</span><span> </span><span class="hs-identifier hs-var">SourceUnpack</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SrcUnpack</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-identifier">cvtSrcStrictness</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.SourceStrictness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcStrictness</span><span>
</span><a name="line-618"></a><a name="cvtSrcStrictness"><a href="Convert.html#cvtSrcStrictness"><span class="hs-identifier">cvtSrcStrictness</span></a></a><span> </span><span class="hs-identifier hs-var">NoSourceStrictness</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NoSrcStrict</span><span>
</span><a name="line-619"></a><span class="hs-identifier">cvtSrcStrictness</span><span> </span><span class="hs-identifier hs-var">SourceLazy</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SrcLazy</span><span>
</span><a name="line-620"></a><span class="hs-identifier">cvtSrcStrictness</span><span> </span><span class="hs-identifier hs-var">SourceStrict</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SrcStrict</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-identifier">cvt_arg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Bang</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-623"></a><a name="cvt_arg"><a href="Convert.html#cvt_arg"><span class="hs-identifier">cvt_arg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Bang</span><span> </span><a name="local-6989586621679219026"><a href="#local-6989586621679219026"><span class="hs-identifier">su</span></a></a><span> </span><a name="local-6989586621679219027"><a href="#local-6989586621679219027"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219028"><a href="#local-6989586621679219028"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219029"><a href="#local-6989586621679219029"><span class="hs-identifier">ty''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219028"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-625"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219030"><a href="#local-6989586621679219030"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span> </span><a href="#local-6989586621679219029"><span class="hs-identifier hs-var">ty''</span></a><span>
</span><a name="line-626"></a><span>             </span><a name="local-6989586621679219031"><a href="#local-6989586621679219031"><span class="hs-identifier">su'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtSrcUnpackedness"><span class="hs-identifier hs-var">cvtSrcUnpackedness</span></a><span> </span><a href="#local-6989586621679219026"><span class="hs-identifier hs-var">su</span></a><span>
</span><a name="line-627"></a><span>             </span><a name="local-6989586621679219032"><a href="#local-6989586621679219032"><span class="hs-identifier">ss'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtSrcStrictness"><span class="hs-identifier hs-var">cvtSrcStrictness</span></a><span> </span><a href="#local-6989586621679219027"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-628"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsBangTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSrcBang</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219031"><span class="hs-identifier hs-var">su'</span></a><span> </span><a href="#local-6989586621679219032"><span class="hs-identifier hs-var">ss'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219030"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-identifier">cvt_id_arg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Bang</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LConDeclField</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-631"></a><a name="cvt_id_arg"><a href="Convert.html#cvt_id_arg"><span class="hs-identifier">cvt_id_arg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679219033"><a href="#local-6989586621679219033"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219034"><a href="#local-6989586621679219034"><span class="hs-identifier">str</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219035"><a href="#local-6989586621679219035"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679219036"><a href="#local-6989586621679219036"><span class="hs-identifier">li</span></a></a><span> </span><a name="local-6989586621679219037"><a href="#local-6989586621679219037"><span class="hs-identifier">i'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219033"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-633"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219038"><a href="#local-6989586621679219038"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_arg"><span class="hs-identifier hs-var">cvt_arg</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219034"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">,</span><a href="#local-6989586621679219035"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclField</span><span>
</span><a name="line-635"></a><span>                          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cd_fld_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-636"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cd_fld_names</span><span>
</span><a name="line-637"></a><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219036"><span class="hs-identifier hs-var">li</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FieldOcc</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219036"><span class="hs-identifier hs-var">li</span></a><span> </span><a href="#local-6989586621679219037"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-638"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cd_fld_type</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679219038"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-639"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cd_fld_doc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-identifier">cvtDerivs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DerivClause</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsDeriving</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-642"></a><a name="cvtDerivs"><a href="Convert.html#cvtDerivs"><span class="hs-identifier">cvtDerivs</span></a></a><span> </span><a name="local-6989586621679219039"><a href="#local-6989586621679219039"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219040"><a href="#local-6989586621679219040"><span class="hs-identifier">cs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtDerivClause"><span class="hs-identifier hs-var">cvtDerivClause</span></a><span> </span><a href="#local-6989586621679219039"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-643"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><a href="#local-6989586621679219040"><span class="hs-identifier hs-var">cs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span class="hs-identifier">cvt_fundep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FunDep</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsFunDep</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-646"></a><a name="cvt_fundep"><a href="Convert.html#cvt_fundep"><span class="hs-identifier">cvt_fundep</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunDep</span><span> </span><a name="local-6989586621679219041"><a href="#local-6989586621679219041"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679219042"><a href="#local-6989586621679219042"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219043"><a href="#local-6989586621679219043"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679219041"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-647"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219044"><a href="#local-6989586621679219044"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679219042"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-648"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219043"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679219044"><span class="hs-identifier hs-var">ys'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">------------------------------------------</span><span>
</span><a name="line-652"></a><span class="hs-comment">--      Foreign declarations</span><span>
</span><a name="line-653"></a><span class="hs-comment">------------------------------------------</span><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span class="hs-identifier">cvtForD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foreign</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ForeignDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-656"></a><a name="cvtForD"><a href="Convert.html#cvtForD"><span class="hs-identifier">cvtForD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ImportF</span><span> </span><a name="local-6989586621679219045"><a href="#local-6989586621679219045"><span class="hs-identifier">callconv</span></a></a><span> </span><a name="local-6989586621679219046"><a href="#local-6989586621679219046"><span class="hs-identifier">safety</span></a></a><span> </span><a name="local-6989586621679219047"><a href="#local-6989586621679219047"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621679219048"><a href="#local-6989586621679219048"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219049"><a href="#local-6989586621679219049"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>  </span><span class="hs-comment">-- the prim and javascript calling conventions do not support headers</span><span>
</span><a name="line-658"></a><span>  </span><span class="hs-comment">-- and are inserted verbatim, analogous to mkImport in RdrHsSyn</span><span>
</span><a name="line-659"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679219045"><span class="hs-identifier hs-var">callconv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TH.Prim</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679219045"><span class="hs-identifier hs-var">callconv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TH.JavaScript</span><span>
</span><a name="line-660"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219050"><span class="hs-identifier hs-var">mk_imp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CImport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvt_conv"><span class="hs-identifier hs-var">cvt_conv</span></a><span> </span><a href="#local-6989586621679219045"><span class="hs-identifier hs-var">callconv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219051"><span class="hs-identifier hs-var">safety'</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-661"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StaticTarget</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>                                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-663"></a><span>                                             </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#quotedSourceText"><span class="hs-identifier hs-var">quotedSourceText</span></a><span> </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-665"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219055"><a href="#local-6989586621679219055"><span class="hs-identifier">impspec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">parseCImport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvt_conv"><span class="hs-identifier hs-var">cvt_conv</span></a><span> </span><a href="#local-6989586621679219045"><span class="hs-identifier hs-var">callconv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219051"><span class="hs-identifier hs-var">safety'</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.nameBase</span><span> </span><a href="#local-6989586621679219048"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>                                 </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#quotedSourceText"><span class="hs-identifier hs-var">quotedSourceText</span></a><span> </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219050"><span class="hs-identifier hs-var">mk_imp</span></a><span> </span><a href="#local-6989586621679219055"><span class="hs-identifier hs-var">impspec</span></a><span>
</span><a name="line-669"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679219047"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;is not a valid ccall impent&quot;</span><span>
</span><a name="line-671"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-672"></a><span>    </span><a name="local-6989586621679219050"><a href="#local-6989586621679219050"><span class="hs-identifier">mk_imp</span></a></a><span> </span><a name="local-6989586621679219052"><a href="#local-6989586621679219052"><span class="hs-identifier">impspec</span></a></a><span>
</span><a name="line-673"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219053"><a href="#local-6989586621679219053"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219048"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-674"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219054"><a href="#local-6989586621679219054"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219049"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-675"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForeignImport</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_i_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-676"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219053"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-677"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679219054"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-678"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fi</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219052"><span class="hs-identifier hs-var">impspec</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span>           </span><span class="hs-special">}</span><span>
</span><a name="line-680"></a><span>    </span><a name="local-6989586621679219051"><a href="#local-6989586621679219051"><span class="hs-identifier">safety'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219046"><span class="hs-identifier hs-var">safety</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-681"></a><span>                     </span><span class="hs-identifier hs-var">Unsafe</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">PlayRisky</span><span>
</span><a name="line-682"></a><span>                     </span><span class="hs-identifier hs-var">Safe</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">PlaySafe</span><span>
</span><a name="line-683"></a><span>                     </span><span class="hs-identifier hs-var">Interruptible</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">PlayInterruptible</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-identifier">cvtForD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExportF</span><span> </span><a name="local-6989586621679219056"><a href="#local-6989586621679219056"><span class="hs-identifier">callconv</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679219058"><a href="#local-6989586621679219058"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219059"><a href="#local-6989586621679219059"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219060"><a href="#local-6989586621679219060"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219058"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-687"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219061"><a href="#local-6989586621679219061"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219059"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-688"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219062"><a href="#local-6989586621679219062"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CExport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CExportStatic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>                                                </span><span class="hs-special">(</span><a href="Convert.html#cvt_conv"><span class="hs-identifier hs-var">cvt_conv</span></a><span> </span><a href="#local-6989586621679219056"><span class="hs-identifier hs-var">callconv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ForeignExport</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_e_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-693"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219060"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-694"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679219061"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-695"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219062"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-identifier">cvt_conv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Callconv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CCallConv</span><span>
</span><a name="line-698"></a><a name="cvt_conv"><a href="Convert.html#cvt_conv"><span class="hs-identifier">cvt_conv</span></a></a><span> </span><span class="hs-identifier hs-var">TH.CCall</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CCallConv</span><span>
</span><a name="line-699"></a><span class="hs-identifier">cvt_conv</span><span> </span><span class="hs-identifier hs-var">TH.StdCall</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">StdCallConv</span><span>
</span><a name="line-700"></a><span class="hs-identifier">cvt_conv</span><span> </span><span class="hs-identifier hs-var">TH.CApi</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CApiConv</span><span>
</span><a name="line-701"></a><span class="hs-identifier">cvt_conv</span><span> </span><span class="hs-identifier hs-var">TH.Prim</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PrimCallConv</span><span>
</span><a name="line-702"></a><span class="hs-identifier">cvt_conv</span><span> </span><span class="hs-identifier hs-var">TH.JavaScript</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JavaScriptCallConv</span><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span class="hs-comment">------------------------------------------</span><span>
</span><a name="line-705"></a><span class="hs-comment">--              Pragmas</span><span>
</span><a name="line-706"></a><span class="hs-comment">------------------------------------------</span><span>
</span><a name="line-707"></a><span>
</span><a name="line-708"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Pragma</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDecl</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-709"></a><a name="cvtPragmaD"><a href="Convert.html#cvtPragmaD"><span class="hs-identifier">cvtPragmaD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InlineP</span><span> </span><a name="local-6989586621679219063"><a href="#local-6989586621679219063"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219064"><a href="#local-6989586621679219064"><span class="hs-identifier">inline</span></a></a><span> </span><a name="local-6989586621679219065"><a href="#local-6989586621679219065"><span class="hs-identifier">rm</span></a></a><span> </span><a name="local-6989586621679219066"><a href="#local-6989586621679219066"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219067"><a href="#local-6989586621679219067"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219063"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-711"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219068"><a href="#local-6989586621679219068"><span class="hs-identifier">dflt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#dfltActivation"><span class="hs-identifier hs-var">dfltActivation</span></a><span> </span><a href="#local-6989586621679219064"><span class="hs-identifier hs-var">inline</span></a><span>
</span><a name="line-712"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219069"><a href="#local-6989586621679219069"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NoInline</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# NOINLINE&quot;</span><span>
</span><a name="line-713"></a><span>             </span><span class="hs-identifier">src</span><span> </span><span class="hs-identifier hs-var">TH.Inline</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# INLINE&quot;</span><span>
</span><a name="line-714"></a><span>             </span><span class="hs-identifier">src</span><span> </span><span class="hs-identifier hs-var">TH.Inlinable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# INLINABLE&quot;</span><span>
</span><a name="line-715"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219070"><a href="#local-6989586621679219070"><span class="hs-identifier">ip</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InlinePragma</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">inl_src</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679219069"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679219064"><span class="hs-identifier hs-var">inline</span></a><span>
</span><a name="line-716"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtInline"><span class="hs-identifier hs-var">cvtInline</span></a><span> </span><a href="#local-6989586621679219064"><span class="hs-identifier hs-var">inline</span></a><span>
</span><a name="line-717"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_rule</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtRuleMatch"><span class="hs-identifier hs-var">cvtRuleMatch</span></a><span> </span><a href="#local-6989586621679219065"><span class="hs-identifier hs-var">rm</span></a><span>
</span><a name="line-718"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_act</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtPhases"><span class="hs-identifier hs-var">cvtPhases</span></a><span> </span><a href="#local-6989586621679219066"><span class="hs-identifier hs-var">phases</span></a><span> </span><a href="#local-6989586621679219068"><span class="hs-identifier hs-var">dflt</span></a><span>
</span><a name="line-719"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_sat</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-720"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">InlineSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219067"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621679219070"><span class="hs-identifier hs-var">ip</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-721"></a><span>
</span><a name="line-722"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecialiseP</span><span> </span><a name="local-6989586621679219071"><a href="#local-6989586621679219071"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219072"><a href="#local-6989586621679219072"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679219073"><a href="#local-6989586621679219073"><span class="hs-identifier">inline</span></a></a><span> </span><a name="local-6989586621679219074"><a href="#local-6989586621679219074"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-723"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219075"><a href="#local-6989586621679219075"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219071"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-724"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219076"><a href="#local-6989586621679219076"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219072"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-725"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219077"><a href="#local-6989586621679219077"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NoInline</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# SPECIALISE NOINLINE&quot;</span><span>
</span><a name="line-726"></a><span>             </span><span class="hs-identifier">src</span><span> </span><span class="hs-identifier hs-var">TH.Inline</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# SPECIALISE INLINE&quot;</span><span>
</span><a name="line-727"></a><span>             </span><span class="hs-identifier">src</span><span> </span><span class="hs-identifier hs-var">TH.Inlinable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{-# SPECIALISE INLINE&quot;</span><span>
</span><a name="line-728"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679219078"><a href="#local-6989586621679219078"><span class="hs-identifier">inline'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219079"><a href="#local-6989586621679219079"><span class="hs-identifier">dflt</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219080"><a href="#local-6989586621679219080"><span class="hs-identifier">srcText</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219073"><span class="hs-identifier hs-var">inline</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-729"></a><span>               </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219081"><a href="#local-6989586621679219081"><span class="hs-identifier">inline1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtInline"><span class="hs-identifier hs-var">cvtInline</span></a><span> </span><a href="#local-6989586621679219081"><span class="hs-identifier hs-var">inline1</span></a><span class="hs-special">,</span><span> </span><a href="Convert.html#dfltActivation"><span class="hs-identifier hs-var">dfltActivation</span></a><span> </span><a href="#local-6989586621679219081"><span class="hs-identifier hs-var">inline1</span></a><span class="hs-special">,</span><span>
</span><a name="line-730"></a><span>                                </span><a href="#local-6989586621679219077"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679219081"><span class="hs-identifier hs-var">inline1</span></a><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>               </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoUserInline</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">AlwaysActive</span><span class="hs-special">,</span><span>
</span><a name="line-732"></a><span>                                </span><span class="hs-string">&quot;{-# SPECIALISE&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-733"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219082"><a href="#local-6989586621679219082"><span class="hs-identifier">ip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InlinePragma</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">inl_src</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SourceText</span><span> </span><a href="#local-6989586621679219080"><span class="hs-identifier hs-var">srcText</span></a><span>
</span><a name="line-734"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219078"><span class="hs-identifier hs-var">inline'</span></a><span>
</span><a name="line-735"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_rule</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.FunLike</span><span>
</span><a name="line-736"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_act</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtPhases"><span class="hs-identifier hs-var">cvtPhases</span></a><span> </span><a href="#local-6989586621679219074"><span class="hs-identifier hs-var">phases</span></a><span> </span><a href="#local-6989586621679219079"><span class="hs-identifier hs-var">dflt</span></a><span>
</span><a name="line-737"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_sat</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-738"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SpecSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219075"><span class="hs-identifier hs-var">nm'</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679219076"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679219082"><span class="hs-identifier hs-var">ip</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecialiseInstP</span><span> </span><a name="local-6989586621679219083"><a href="#local-6989586621679219083"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-741"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219084"><a href="#local-6989586621679219084"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219083"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-742"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-743"></a><span>         </span><span class="hs-identifier hs-var">SpecInstSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;{-# SPECIALISE&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679219084"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-744"></a><span>
</span><a name="line-745"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleP</span><span> </span><a name="local-6989586621679219085"><a href="#local-6989586621679219085"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219086"><a href="#local-6989586621679219086"><span class="hs-identifier">ty_bndrs</span></a></a><span> </span><a name="local-6989586621679219087"><a href="#local-6989586621679219087"><span class="hs-identifier">tm_bndrs</span></a></a><span> </span><a name="local-6989586621679219088"><a href="#local-6989586621679219088"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679219089"><a href="#local-6989586621679219089"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679219090"><a href="#local-6989586621679219090"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219091"><a href="#local-6989586621679219091"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkFastString</span><span> </span><a href="#local-6989586621679219085"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-747"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219092"><a href="#local-6989586621679219092"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtPhases"><span class="hs-identifier hs-var">cvtPhases</span></a><span> </span><a href="#local-6989586621679219090"><span class="hs-identifier hs-var">phases</span></a><span> </span><span class="hs-identifier hs-var">AlwaysActive</span><span>
</span><a name="line-748"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219093"><a href="#local-6989586621679219093"><span class="hs-identifier">ty_bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_tv"><span class="hs-identifier hs-var">cvt_tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219086"><span class="hs-identifier hs-var">ty_bndrs</span></a><span>
</span><a name="line-749"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219094"><a href="#local-6989586621679219094"><span class="hs-identifier">tm_bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtRuleBndr"><span class="hs-identifier hs-var">cvtRuleBndr</span></a><span> </span><a href="#local-6989586621679219087"><span class="hs-identifier hs-var">tm_bndrs</span></a><span>
</span><a name="line-750"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219095"><a href="#local-6989586621679219095"><span class="hs-identifier">lhs'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219088"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-751"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219096"><a href="#local-6989586621679219096"><span class="hs-identifier">rhs'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219089"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-752"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RuleD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-753"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRules</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rds_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-754"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rds_src</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;{-# RULES&quot;</span><span>
</span><a name="line-755"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rds_rules</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-756"></a><span>                          </span><span class="hs-identifier hs-var">HsRule</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rd_ext</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-757"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><a href="Convert.html#quotedSourceText"><span class="hs-identifier hs-var">quotedSourceText</span></a><span> </span><a href="#local-6989586621679219085"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><a href="#local-6989586621679219091"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_act</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219092"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-759"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_tyvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219093"><span class="hs-identifier hs-var">ty_bndrs'</span></a><span>
</span><a name="line-760"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_tmvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219094"><span class="hs-identifier hs-var">tm_bndrs'</span></a><span>
</span><a name="line-761"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_lhs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219095"><span class="hs-identifier hs-var">lhs'</span></a><span>
</span><a name="line-762"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_rhs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219096"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span>          </span><span class="hs-special">}</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AnnP</span><span> </span><a name="local-6989586621679219097"><a href="#local-6989586621679219097"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679219098"><a href="#local-6989586621679219098"><span class="hs-identifier">exp</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-767"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219099"><a href="#local-6989586621679219099"><span class="hs-identifier">exp'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219098"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-768"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219104"><a href="#local-6989586621679219104"><span class="hs-identifier">target'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219097"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-769"></a><span>         </span><span class="hs-identifier hs-var">ModuleAnnotation</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">ModuleAnnProvenance</span><span>
</span><a name="line-770"></a><span>         </span><span class="hs-identifier hs-var">TypeAnnotation</span><span> </span><a name="local-6989586621679219100"><a href="#local-6989586621679219100"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-771"></a><span>           </span><a name="local-6989586621679219101"><a href="#local-6989586621679219101"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconName"><span class="hs-identifier hs-var">tconName</span></a><span> </span><a href="#local-6989586621679219100"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-772"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeAnnProvenance</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219101"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span>         </span><span class="hs-identifier hs-var">ValueAnnotation</span><span> </span><a name="local-6989586621679219102"><a href="#local-6989586621679219102"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-774"></a><span>           </span><a name="local-6989586621679219103"><a href="#local-6989586621679219103"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vcName"><span class="hs-identifier hs-var">vcName</span></a><span> </span><a href="#local-6989586621679219102"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-775"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValueAnnProvenance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219103"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-776"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.AnnD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-777"></a><span>                     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsAnnotation</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-string">&quot;{-# ANN&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219104"><span class="hs-identifier hs-var">target'</span></a><span> </span><a href="#local-6989586621679219099"><span class="hs-identifier hs-var">exp'</span></a><span>
</span><a name="line-778"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-779"></a><span>
</span><a name="line-780"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LineP</span><span> </span><a name="local-6989586621679219105"><a href="#local-6989586621679219105"><span class="hs-identifier">line</span></a></a><span> </span><a name="local-6989586621679219106"><a href="#local-6989586621679219106"><span class="hs-identifier">file</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-781"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#setL"><span class="hs-identifier hs-var">setL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">srcLocSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkSrcLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621679219106"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219105"><span class="hs-identifier hs-var">line</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-782"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-783"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-784"></a><span class="hs-identifier">cvtPragmaD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CompleteP</span><span> </span><a name="local-6989586621679219107"><a href="#local-6989586621679219107"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-6989586621679219108"><a href="#local-6989586621679219108"><span class="hs-identifier">mty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-785"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219109"><a href="#local-6989586621679219109"><span class="hs-identifier">cls'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219107"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-786"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219110"><a href="#local-6989586621679219110"><span class="hs-identifier">mty'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679219108"><span class="hs-identifier hs-var">mty</span></a><span>
</span><a name="line-787"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnJustL"><span class="hs-identifier hs-var">returnJustL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.SigD</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-788"></a><span>                   </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">CompleteMatchSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219109"><span class="hs-identifier hs-var">cls'</span></a><span> </span><a href="#local-6989586621679219110"><span class="hs-identifier hs-var">mty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-789"></a><span>
</span><a name="line-790"></a><span class="hs-identifier">dfltActivation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Inline</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Activation</span><span>
</span><a name="line-791"></a><a name="dfltActivation"><a href="Convert.html#dfltActivation"><span class="hs-identifier">dfltActivation</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NoInline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NeverActive</span><span>
</span><a name="line-792"></a><span class="hs-identifier">dfltActivation</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">AlwaysActive</span><span>
</span><a name="line-793"></a><span>
</span><a name="line-794"></a><span class="hs-identifier">cvtInline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Inline</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Hs.InlineSpec</span><span>
</span><a name="line-795"></a><a name="cvtInline"><a href="Convert.html#cvtInline"><span class="hs-identifier">cvtInline</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NoInline</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.NoInline</span><span>
</span><a name="line-796"></a><span class="hs-identifier">cvtInline</span><span> </span><span class="hs-identifier hs-var">TH.Inline</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.Inline</span><span>
</span><a name="line-797"></a><span class="hs-identifier">cvtInline</span><span> </span><span class="hs-identifier hs-var">TH.Inlinable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.Inlinable</span><span>
</span><a name="line-798"></a><span>
</span><a name="line-799"></a><span class="hs-identifier">cvtRuleMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.RuleMatch</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">RuleMatchInfo</span><span>
</span><a name="line-800"></a><a name="cvtRuleMatch"><a href="Convert.html#cvtRuleMatch"><span class="hs-identifier">cvtRuleMatch</span></a></a><span> </span><span class="hs-identifier hs-var">TH.ConLike</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.ConLike</span><span>
</span><a name="line-801"></a><span class="hs-identifier">cvtRuleMatch</span><span> </span><span class="hs-identifier hs-var">TH.FunLike</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.FunLike</span><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">cvtPhases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Activation</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Activation</span><span>
</span><a name="line-804"></a><a name="cvtPhases"><a href="Convert.html#cvtPhases"><span class="hs-identifier">cvtPhases</span></a></a><span> </span><span class="hs-identifier hs-var">AllPhases</span><span>       </span><a name="local-6989586621679219111"><a href="#local-6989586621679219111"><span class="hs-identifier">dflt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219111"><span class="hs-identifier hs-var">dflt</span></a><span>
</span><a name="line-805"></a><span class="hs-identifier">cvtPhases</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromPhase</span><span> </span><a name="local-6989586621679219112"><a href="#local-6989586621679219112"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ActiveAfter</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219112"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-806"></a><span class="hs-identifier">cvtPhases</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BeforePhase</span><span> </span><a name="local-6989586621679219113"><a href="#local-6989586621679219113"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ActiveBefore</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219113"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-identifier">cvtRuleBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.RuleBndr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LRuleBndr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-809"></a><a name="cvtRuleBndr"><a href="Convert.html#cvtRuleBndr"><span class="hs-identifier">cvtRuleBndr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleVar</span><span> </span><a name="local-6989586621679219114"><a href="#local-6989586621679219114"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-810"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219115"><a href="#local-6989586621679219115"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219114"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-811"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RuleBndr</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219115"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-812"></a><span class="hs-identifier">cvtRuleBndr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypedRuleVar</span><span> </span><a name="local-6989586621679219116"><a href="#local-6989586621679219116"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679219117"><a href="#local-6989586621679219117"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-813"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219118"><a href="#local-6989586621679219118"><span class="hs-identifier">n'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219116"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-814"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219119"><a href="#local-6989586621679219119"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219117"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-815"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RuleBndrSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219118"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkLHsSigWcType</span><span> </span><a href="#local-6989586621679219119"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-comment">---------------------------------------------------</span><span>
</span><a name="line-818"></a><span class="hs-comment">--              Declarations</span><span>
</span><a name="line-819"></a><span class="hs-comment">---------------------------------------------------</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span class="hs-identifier">cvtLocalDecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MsgDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLocalBinds</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-822"></a><a name="cvtLocalDecs"><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier">cvtLocalDecs</span></a></a><span> </span><a name="local-6989586621679219120"><a href="#local-6989586621679219120"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621679219121"><a href="#local-6989586621679219121"><span class="hs-identifier">ds</span></a></a><span>
</span><a name="line-823"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_ip_bind"><span class="hs-identifier hs-var">is_ip_bind</span></a><span> </span><a href="#local-6989586621679219121"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-824"></a><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EmptyLocalBinds</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-826"></a><span>        </span><a name="local-6989586621679219122"><a href="#local-6989586621679219122"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDecs"><span class="hs-identifier hs-var">cvtDecs</span></a><span> </span><a href="#local-6989586621679219121"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-827"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679219123"><a href="#local-6989586621679219123"><span class="hs-identifier">binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219124"><a href="#local-6989586621679219124"><span class="hs-identifier">prob_sigs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_bind"><span class="hs-identifier hs-var">is_bind</span></a><span> </span><a href="#local-6989586621679219122"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-828"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679219125"><a href="#local-6989586621679219125"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219126"><a href="#local-6989586621679219126"><span class="hs-identifier">bads</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionWith</span><span> </span><a href="Convert.html#is_sig"><span class="hs-identifier hs-var">is_sig</span></a><span> </span><a href="#local-6989586621679219124"><span class="hs-identifier hs-var">prob_sigs</span></a><span>
</span><a name="line-829"></a><span>        </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679219126"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#mkBadDecMsg"><span class="hs-identifier hs-var">mkBadDecMsg</span></a><span> </span><a href="#local-6989586621679219120"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621679219126"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-830"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValBinds</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValBinds</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToBag</span><span> </span><a href="#local-6989586621679219123"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219125"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679219127"><a href="#local-6989586621679219127"><span class="hs-identifier">ip_binds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-832"></a><span>        </span><a name="local-6989586621679219128"><a href="#local-6989586621679219128"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Convert.html#cvtImplicitParamBind"><span class="hs-identifier hs-var">cvtImplicitParamBind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219127"><span class="hs-identifier hs-var">ip_binds</span></a><span>
</span><a name="line-833"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPBinds</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IPBinds</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219128"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-834"></a><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-835"></a><span>        </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Implicit parameters mixed with other bindings&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span>
</span><a name="line-837"></a><span class="hs-identifier">cvtClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsMatchContext</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-838"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Clause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LMatch</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-839"></a><a name="cvtClause"><a href="Convert.html#cvtClause"><span class="hs-identifier">cvtClause</span></a></a><span> </span><a name="local-6989586621679219129"><a href="#local-6989586621679219129"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Clause</span><span> </span><a name="local-6989586621679219130"><a href="#local-6989586621679219130"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679219131"><a href="#local-6989586621679219131"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679219132"><a href="#local-6989586621679219132"><span class="hs-identifier">wheres</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219133"><a href="#local-6989586621679219133"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219130"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-841"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219134"><a href="#local-6989586621679219134"><span class="hs-identifier">pps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parenthesizePat</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219133"><span class="hs-identifier hs-var">ps'</span></a><span>
</span><a name="line-842"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219135"><a href="#local-6989586621679219135"><span class="hs-identifier">g'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtGuard"><span class="hs-identifier hs-var">cvtGuard</span></a><span> </span><a href="#local-6989586621679219131"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-843"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219136"><a href="#local-6989586621679219136"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier hs-var">cvtLocalDecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a where clause&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219132"><span class="hs-identifier hs-var">wheres</span></a><span>
</span><a name="line-844"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.Match</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219129"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679219134"><span class="hs-identifier hs-var">pps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219135"><span class="hs-identifier hs-var">g'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219136"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-845"></a><span>
</span><a name="line-846"></a><span class="hs-identifier">cvtImplicitParamBind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LIPBind</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-847"></a><a name="cvtImplicitParamBind"><a href="Convert.html#cvtImplicitParamBind"><span class="hs-identifier">cvtImplicitParamBind</span></a></a><span> </span><a name="local-6989586621679219137"><a href="#local-6989586621679219137"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679219138"><a href="#local-6989586621679219138"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-848"></a><span>    </span><a name="local-6989586621679219139"><a href="#local-6989586621679219139"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#ipName"><span class="hs-identifier hs-var">ipName</span></a><span> </span><a href="#local-6989586621679219137"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-849"></a><span>    </span><a name="local-6989586621679219140"><a href="#local-6989586621679219140"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219138"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-850"></a><span>    </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IPBind</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679219139"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219140"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-851"></a><span>
</span><a name="line-852"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-853"></a><span class="hs-comment">--              Expressions</span><span>
</span><a name="line-854"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-identifier">cvtl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-857"></a><a name="cvtl"><a href="Convert.html#cvtl"><span class="hs-identifier">cvtl</span></a></a><span> </span><a name="local-6989586621679219141"><a href="#local-6989586621679219141"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219142"><span class="hs-identifier hs-var">cvt</span></a><span> </span><a href="#local-6989586621679219141"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-858"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-859"></a><span>    </span><a name="local-6989586621679219142"><a href="#local-6989586621679219142"><span class="hs-identifier">cvt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarE</span><span> </span><a name="local-6989586621679219143"><a href="#local-6989586621679219143"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219144"><a href="#local-6989586621679219144"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vName"><span class="hs-identifier hs-var">vName</span></a><span> </span><a href="#local-6989586621679219143"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219144"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-860"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConE</span><span> </span><a name="local-6989586621679219145"><a href="#local-6989586621679219145"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219146"><a href="#local-6989586621679219146"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cName"><span class="hs-identifier hs-var">cName</span></a><span> </span><a href="#local-6989586621679219145"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219146"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-861"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LitE</span><span> </span><a name="local-6989586621679219147"><a href="#local-6989586621679219147"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Convert.html#overloadedLit"><span class="hs-identifier hs-var">overloadedLit</span></a><span> </span><a href="#local-6989586621679219147"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219148"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Convert.html#cvtOverLit"><span class="hs-identifier hs-var">cvtOverLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsOverLit</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-863"></a><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsOverLitNeedsParens</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span class="hs-special">)</span><span>
</span><a name="line-864"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219148"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Convert.html#cvtLit"><span class="hs-identifier hs-var">cvtLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLit</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsLitNeedsParens</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-867"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219149"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219149"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-869"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219149"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-870"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-871"></a><span>        </span><a name="local-6989586621679219148"><a href="#local-6989586621679219148"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679219150"><a href="#local-6989586621679219150"><span class="hs-identifier">cvt_lit</span></a></a><span> </span><a name="local-6989586621679219151"><a href="#local-6989586621679219151"><span class="hs-identifier">mk_expr</span></a></a><span> </span><a name="local-6989586621679219152"><a href="#local-6989586621679219152"><span class="hs-identifier">is_compound_lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-872"></a><span>          </span><a name="local-6989586621679219153"><a href="#local-6989586621679219153"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219150"><span class="hs-identifier hs-var">cvt_lit</span></a><span> </span><a href="#local-6989586621679219147"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-873"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219154"><a href="#local-6989586621679219154"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219151"><span class="hs-identifier hs-var">mk_expr</span></a><span> </span><a href="#local-6989586621679219153"><span class="hs-identifier hs-var">l'</span></a><span>
</span><a name="line-874"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679219152"><span class="hs-identifier hs-var">is_compound_lit</span></a><span> </span><a href="#local-6989586621679219153"><span class="hs-identifier hs-var">l'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219154"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679219154"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-875"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppE</span><span> </span><a name="local-6989586621679219155"><a href="#local-6989586621679219155"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">LamE</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679219156"><a href="#local-6989586621679219156"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219157"><a href="#local-6989586621679219157"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219155"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219158"><a href="#local-6989586621679219158"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219156"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-876"></a><span>                                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsApp</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsPar</span><span> </span><a href="#local-6989586621679219157"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span>
</span><a name="line-877"></a><span>                                                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsPar</span><span> </span><a href="#local-6989586621679219158"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-878"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppE</span><span> </span><a name="local-6989586621679219159"><a href="#local-6989586621679219159"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219160"><a href="#local-6989586621679219160"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219161"><a href="#local-6989586621679219161"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219159"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219162"><a href="#local-6989586621679219162"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219160"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-879"></a><span>                                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsApp</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsPar</span><span> </span><a href="#local-6989586621679219161"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>                                                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsPar</span><span> </span><a href="#local-6989586621679219162"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-881"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppTypeE</span><span> </span><a name="local-6989586621679219163"><a href="#local-6989586621679219163"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219164"><a href="#local-6989586621679219164"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219165"><a href="#local-6989586621679219165"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219163"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-882"></a><span>                            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219166"><a href="#local-6989586621679219166"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219164"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-883"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219167"><a href="#local-6989586621679219167"><span class="hs-identifier">tp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span> </span><a href="#local-6989586621679219166"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-884"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsAppType</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219165"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-885"></a><span>                                     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsWildCardBndrs</span><span> </span><a href="#local-6989586621679219167"><span class="hs-identifier hs-var">tp</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-886"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LamE</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679219168"><a href="#local-6989586621679219168"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219142"><span class="hs-identifier hs-var">cvt</span></a><span> </span><a href="#local-6989586621679219168"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-comment">-- Degenerate case. We convert the body as its</span><span>
</span><a name="line-887"></a><span>                               </span><span class="hs-comment">-- own expression to avoid pretty-printing</span><span>
</span><a name="line-888"></a><span>                               </span><span class="hs-comment">-- oddities that can result from zero-argument</span><span>
</span><a name="line-889"></a><span>                               </span><span class="hs-comment">-- lambda expressions. See #13856.</span><span>
</span><a name="line-890"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LamE</span><span> </span><a name="local-6989586621679219169"><a href="#local-6989586621679219169"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679219170"><a href="#local-6989586621679219170"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219171"><a href="#local-6989586621679219171"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219169"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219172"><a href="#local-6989586621679219172"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219170"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-891"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219173"><a href="#local-6989586621679219173"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parenthesizePat</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219171"><span class="hs-identifier hs-var">ps'</span></a><span>
</span><a name="line-892"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsLam</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkMatchGroup</span><span> </span><span class="hs-identifier hs-var">FromSource</span><span>
</span><a name="line-893"></a><span>                                             </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkSimpleMatch</span><span> </span><span class="hs-identifier hs-var">LambdaExpr</span><span>
</span><a name="line-894"></a><span>                                             </span><a href="#local-6989586621679219173"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679219172"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-895"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LamCaseE</span><span> </span><a name="local-6989586621679219174"><a href="#local-6989586621679219174"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219175"><a href="#local-6989586621679219175"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtMatch"><span class="hs-identifier hs-var">cvtMatch</span></a><span> </span><span class="hs-identifier hs-var">CaseAlt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219174"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-896"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsLamCase</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-897"></a><span>                                                   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkMatchGroup</span><span> </span><span class="hs-identifier hs-var">FromSource</span><span> </span><a href="#local-6989586621679219175"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>                            </span><span class="hs-special">}</span><span>
</span><a name="line-899"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TupE</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679219176"><a href="#local-6989586621679219176"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219177"><a href="#local-6989586621679219177"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219176"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219177"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-900"></a><span>                                 </span><span class="hs-comment">-- Note [Dropping constructors]</span><span>
</span><a name="line-901"></a><span>                                 </span><span class="hs-comment">-- Singleton tuples treated like nothing (just parens)</span><span>
</span><a name="line-902"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TupE</span><span> </span><a name="local-6989586621679219178"><a href="#local-6989586621679219178"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219179"><a href="#local-6989586621679219179"><span class="hs-identifier">es'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219178"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-903"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExplicitTuple</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-904"></a><span>                                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Present</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219179"><span class="hs-identifier hs-var">es'</span></a><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>                                                                         </span><span class="hs-identifier hs-var">Boxed</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-906"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnboxedTupE</span><span> </span><a name="local-6989586621679219180"><a href="#local-6989586621679219180"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219181"><a href="#local-6989586621679219181"><span class="hs-identifier">es'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219180"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-907"></a><span>                                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExplicitTuple</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-908"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Present</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219181"><span class="hs-identifier hs-var">es'</span></a><span class="hs-special">)</span><span>
</span><a name="line-909"></a><span>                                                                       </span><span class="hs-identifier hs-var">Unboxed</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-910"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnboxedSumE</span><span> </span><a name="local-6989586621679219182"><a href="#local-6989586621679219182"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219183"><a href="#local-6989586621679219183"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679219184"><a href="#local-6989586621679219184"><span class="hs-identifier">arity</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219185"><a href="#local-6989586621679219185"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219182"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-911"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#unboxedSumChecks"><span class="hs-identifier hs-var">unboxedSumChecks</span></a><span> </span><a href="#local-6989586621679219183"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679219184"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-912"></a><span>                                       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExplicitSum</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-913"></a><span>                                                                   </span><a href="#local-6989586621679219183"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679219184"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621679219185"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">}</span><span>
</span><a name="line-914"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CondE</span><span> </span><a name="local-6989586621679219186"><a href="#local-6989586621679219186"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219187"><a href="#local-6989586621679219187"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679219188"><a href="#local-6989586621679219188"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219189"><a href="#local-6989586621679219189"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219186"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219190"><a href="#local-6989586621679219190"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219187"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219191"><a href="#local-6989586621679219191"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219188"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">;</span><span>
</span><a name="line-915"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsIf</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">noSyntaxExpr</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219189"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679219190"><span class="hs-identifier hs-var">y'</span></a><span> </span><a href="#local-6989586621679219191"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-916"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MultiIfE</span><span> </span><a name="local-6989586621679219192"><a href="#local-6989586621679219192"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679219192"><span class="hs-identifier hs-var">alts</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Multi-way if-expression with no alternatives&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219193"><a href="#local-6989586621679219193"><span class="hs-identifier">alts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtpair"><span class="hs-identifier hs-var">cvtpair</span></a><span> </span><a href="#local-6989586621679219192"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-919"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsMultiIf</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219193"><span class="hs-identifier hs-var">alts'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-920"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LetE</span><span> </span><a name="local-6989586621679219194"><a href="#local-6989586621679219194"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679219195"><a href="#local-6989586621679219195"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219196"><a href="#local-6989586621679219196"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier hs-var">cvtLocalDecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a let expression&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219194"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-921"></a><span>                            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219197"><a href="#local-6989586621679219197"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219195"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsLet</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219196"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219197"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">}</span><span>
</span><a name="line-922"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CaseE</span><span> </span><a name="local-6989586621679219198"><a href="#local-6989586621679219198"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219199"><a href="#local-6989586621679219199"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219200"><a href="#local-6989586621679219200"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219198"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219201"><a href="#local-6989586621679219201"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtMatch"><span class="hs-identifier hs-var">cvtMatch</span></a><span> </span><span class="hs-identifier hs-var">CaseAlt</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219199"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-923"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsCase</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219200"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-924"></a><span>                                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkMatchGroup</span><span> </span><span class="hs-identifier hs-var">FromSource</span><span> </span><a href="#local-6989586621679219201"><span class="hs-identifier hs-var">ms'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-925"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DoE</span><span> </span><a name="local-6989586621679219202"><a href="#local-6989586621679219202"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtHsDo"><span class="hs-identifier hs-var">cvtHsDo</span></a><span> </span><span class="hs-identifier hs-var">DoExpr</span><span> </span><a href="#local-6989586621679219202"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-926"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MDoE</span><span> </span><a name="local-6989586621679219203"><a href="#local-6989586621679219203"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtHsDo"><span class="hs-identifier hs-var">cvtHsDo</span></a><span> </span><span class="hs-identifier hs-var">MDoExpr</span><span> </span><a href="#local-6989586621679219203"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-927"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CompE</span><span> </span><a name="local-6989586621679219204"><a href="#local-6989586621679219204"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtHsDo"><span class="hs-identifier hs-var">cvtHsDo</span></a><span> </span><span class="hs-identifier hs-var">ListComp</span><span> </span><a href="#local-6989586621679219204"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-928"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ArithSeqE</span><span> </span><a name="local-6989586621679219205"><a href="#local-6989586621679219205"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219206"><a href="#local-6989586621679219206"><span class="hs-identifier">dd'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtDD"><span class="hs-identifier hs-var">cvtDD</span></a><span> </span><a href="#local-6989586621679219205"><span class="hs-identifier hs-var">dd</span></a><span>
</span><a name="line-929"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ArithSeq</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679219206"><span class="hs-identifier hs-var">dd'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-930"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListE</span><span> </span><a name="local-6989586621679219207"><a href="#local-6989586621679219207"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219208"><a href="#local-6989586621679219208"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#allCharLs"><span class="hs-identifier hs-var">allCharLs</span></a><span> </span><a href="#local-6989586621679219207"><span class="hs-identifier hs-var">xs</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219209"><a href="#local-6989586621679219209"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLit"><span class="hs-identifier hs-var">cvtLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StringL</span><span> </span><a href="#local-6989586621679219208"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-932"></a><span>                                          </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLit</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219209"><span class="hs-identifier hs-var">l'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-933"></a><span>             </span><span class="hs-comment">-- Note [Converting strings]</span><span>
</span><a name="line-934"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219210"><a href="#local-6989586621679219210"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219207"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-935"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExplicitList</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679219210"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-936"></a><span>                             </span><span class="hs-special">}</span><span>
</span><a name="line-937"></a><span>
</span><a name="line-938"></a><span>    </span><span class="hs-comment">-- Infix expressions</span><span>
</span><a name="line-939"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219211"><a href="#local-6989586621679219211"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679219212"><a href="#local-6989586621679219212"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219213"><a href="#local-6989586621679219213"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-940"></a><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219214"><a href="#local-6989586621679219214"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219211"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-941"></a><span>         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219215"><a href="#local-6989586621679219215"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219212"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-942"></a><span>         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219216"><a href="#local-6989586621679219216"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219213"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-943"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219217"><a href="#local-6989586621679219217"><span class="hs-identifier">px</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsExpr</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679219214"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-944"></a><span>               </span><a name="local-6989586621679219218"><a href="#local-6989586621679219218"><span class="hs-identifier">py</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsExpr</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679219216"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-945"></a><span>         </span><span class="hs-special">;</span><span> </span><a href="Convert.html#wrapParL"><span class="hs-identifier hs-var">wrapParL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-946"></a><span>           </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">OpApp</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219217"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679219215"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679219218"><span class="hs-identifier hs-var">py</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-947"></a><span>           </span><span class="hs-comment">-- Parenthesise both arguments and result,</span><span>
</span><a name="line-948"></a><span>           </span><span class="hs-comment">-- to ensure this operator application does</span><span>
</span><a name="line-949"></a><span>           </span><span class="hs-comment">-- does not get re-associated</span><span>
</span><a name="line-950"></a><span>           </span><span class="hs-comment">-- See Note [Operator association]</span><span>
</span><a name="line-951"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixE</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><a name="local-6989586621679219219"><a href="#local-6989586621679219219"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219220"><a href="#local-6989586621679219220"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219221"><a href="#local-6989586621679219221"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219219"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219222"><a href="#local-6989586621679219222"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219220"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-952"></a><span>                                          </span><span class="hs-special">;</span><span> </span><a href="Convert.html#wrapParL"><span class="hs-identifier hs-var">wrapParL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-953"></a><span>                                                          </span><span class="hs-identifier hs-var">SectionR</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219221"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679219222"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-954"></a><span>                                            </span><span class="hs-comment">-- See Note [Sections in HsSyn] in HsExpr</span><span>
</span><a name="line-955"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219223"><a href="#local-6989586621679219223"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679219224"><a href="#local-6989586621679219224"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219225"><a href="#local-6989586621679219225"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219223"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219226"><a href="#local-6989586621679219226"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219224"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-956"></a><span>                                          </span><span class="hs-special">;</span><span> </span><a href="Convert.html#wrapParL"><span class="hs-identifier hs-var">wrapParL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-957"></a><span>                                                          </span><span class="hs-identifier hs-var">SectionL</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219225"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679219226"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-958"></a><span>
</span><a name="line-959"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixE</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><a name="local-6989586621679219227"><a href="#local-6989586621679219227"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219228"><a href="#local-6989586621679219228"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219227"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-960"></a><span>                                          </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219228"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-961"></a><span>                                       </span><span class="hs-comment">-- Can I indicate this is an infix thing?</span><span>
</span><a name="line-962"></a><span>                                       </span><span class="hs-comment">-- Note [Dropping constructors]</span><span>
</span><a name="line-963"></a><span>
</span><a name="line-964"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UInfixE</span><span> </span><a name="local-6989586621679219229"><a href="#local-6989586621679219229"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219230"><a href="#local-6989586621679219230"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679219231"><a href="#local-6989586621679219231"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219232"><a href="#local-6989586621679219232"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219229"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-965"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219233"><a href="#local-6989586621679219233"><span class="hs-identifier">x''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621679219232"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-966"></a><span>                                            </span><span class="hs-identifier hs-var">OpApp</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679219232"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-967"></a><span>                                            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkLHsPar</span><span> </span><a href="#local-6989586621679219232"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-968"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="Convert.html#cvtOpApp"><span class="hs-identifier hs-var">cvtOpApp</span></a><span> </span><a href="#local-6989586621679219233"><span class="hs-identifier hs-var">x''</span></a><span> </span><a href="#local-6989586621679219230"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679219231"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">--  Note [Converting UInfix]</span><span>
</span><a name="line-969"></a><span>
</span><a name="line-970"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParensE</span><span> </span><a name="local-6989586621679219234"><a href="#local-6989586621679219234"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219235"><a href="#local-6989586621679219235"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219234"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219235"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-971"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigE</span><span> </span><a name="local-6989586621679219236"><a href="#local-6989586621679219236"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219237"><a href="#local-6989586621679219237"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219238"><a href="#local-6989586621679219238"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219236"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219239"><a href="#local-6989586621679219239"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219237"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-972"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219240"><a href="#local-6989586621679219240"><span class="hs-identifier">pe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsExpr</span><span> </span><span class="hs-identifier hs-var">sigPrec</span><span> </span><a href="#local-6989586621679219238"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-973"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExprWithTySig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219240"><span class="hs-identifier hs-var">pe</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigWcType</span><span> </span><a href="#local-6989586621679219239"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-974"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecConE</span><span> </span><a name="local-6989586621679219241"><a href="#local-6989586621679219241"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679219242"><a href="#local-6989586621679219242"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219243"><a href="#local-6989586621679219243"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219241"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-975"></a><span>                              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219244"><a href="#local-6989586621679219244"><span class="hs-identifier">flds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtFld"><span class="hs-identifier hs-var">cvtFld</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFieldOcc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219242"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-976"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkRdrRecordCon</span><span> </span><a href="#local-6989586621679219243"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><a href="#local-6989586621679219244"><span class="hs-identifier hs-var">flds'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-977"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecUpdE</span><span> </span><a name="local-6989586621679219245"><a href="#local-6989586621679219245"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219246"><a href="#local-6989586621679219246"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219247"><a href="#local-6989586621679219247"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219245"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-978"></a><span>                              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219248"><a href="#local-6989586621679219248"><span class="hs-identifier">flds'</span></a></a><span>
</span><a name="line-979"></a><span>                                  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtFld"><span class="hs-identifier hs-var">cvtFld</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkAmbiguousFieldOcc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">noLoc</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>                                           </span><a href="#local-6989586621679219246"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-981"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkRdrRecordUpd</span><span> </span><a href="#local-6989586621679219247"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679219248"><span class="hs-identifier hs-var">flds'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-982"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StaticE</span><span> </span><a name="local-6989586621679219249"><a href="#local-6989586621679219249"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsStatic</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219249"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-983"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnboundVarE</span><span> </span><a name="local-6989586621679219250"><a href="#local-6989586621679219250"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Use of 'vcName' here instead of 'vName' is</span><span>
</span><a name="line-984"></a><span>                              </span><span class="hs-comment">-- important, because UnboundVarE may contain</span><span>
</span><a name="line-985"></a><span>                              </span><span class="hs-comment">-- constructor names - see #14627.</span><span>
</span><a name="line-986"></a><span>                              </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219251"><a href="#local-6989586621679219251"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vcName"><span class="hs-identifier hs-var">vcName</span></a><span> </span><a href="#local-6989586621679219250"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-987"></a><span>                              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219251"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-988"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LabelE</span><span> </span><a name="local-6989586621679219252"><a href="#local-6989586621679219252"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsOverLabel</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621679219252"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-989"></a><span>    </span><span class="hs-identifier">cvt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ImplicitParamVarE</span><span> </span><a name="local-6989586621679219253"><a href="#local-6989586621679219253"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219254"><a href="#local-6989586621679219254"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#ipName"><span class="hs-identifier hs-var">ipName</span></a><span> </span><a href="#local-6989586621679219253"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsIPVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219254"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-990"></a><span>
</span><a name="line-991"></a><span class="hs-comment">{- Note [Dropping constructors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When we drop constructors from the input (for instance, when we encounter @TupE [e]@)
we must insert parentheses around the argument. Otherwise, @UInfix@ constructors in @e@
could meet @UInfix@ constructors containing the @TupE [e]@. For example:

  UInfixE x * (TupE [UInfixE y + z])

If we drop the singleton tuple but don't insert parentheses, the @UInfixE@s would meet
and the above expression would be reassociated to

  OpApp (OpApp x * y) + z

which we don't want.
-}</span><span>
</span><a name="line-1006"></a><span>
</span><a name="line-1007"></a><span class="hs-identifier">cvtFld</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RdrName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679217063"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span>
</span><a name="line-1008"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsRecField'</span><span> </span><a href="#local-6989586621679217063"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1009"></a><a name="cvtFld"><a href="Convert.html#cvtFld"><span class="hs-identifier">cvtFld</span></a></a><span> </span><a name="local-6989586621679219255"><a href="#local-6989586621679219255"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679219256"><a href="#local-6989586621679219256"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219257"><a href="#local-6989586621679219257"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1010"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219258"><a href="#local-6989586621679219258"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219256"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219259"><a href="#local-6989586621679219259"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219257"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1011"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRecField</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679219255"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679219258"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1012"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219259"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-1013"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecPun</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1014"></a><span>
</span><a name="line-1015"></a><span class="hs-identifier">cvtDD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Range</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ArithSeqInfo</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1016"></a><a name="cvtDD"><a href="Convert.html#cvtDD"><span class="hs-identifier">cvtDD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromR</span><span> </span><a name="local-6989586621679219260"><a href="#local-6989586621679219260"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219261"><a href="#local-6989586621679219261"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219260"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">From</span><span> </span><a href="#local-6989586621679219261"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1017"></a><span class="hs-identifier">cvtDD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromThenR</span><span> </span><a name="local-6989586621679219262"><a href="#local-6989586621679219262"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219263"><a href="#local-6989586621679219263"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219264"><a href="#local-6989586621679219264"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219262"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219265"><a href="#local-6989586621679219265"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219263"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FromThen</span><span> </span><a href="#local-6989586621679219264"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679219265"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1018"></a><span class="hs-identifier">cvtDD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromToR</span><span> </span><a name="local-6989586621679219266"><a href="#local-6989586621679219266"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219267"><a href="#local-6989586621679219267"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219268"><a href="#local-6989586621679219268"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219266"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219269"><a href="#local-6989586621679219269"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219267"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FromTo</span><span> </span><a href="#local-6989586621679219268"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679219269"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1019"></a><span class="hs-identifier">cvtDD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromThenToR</span><span> </span><a name="local-6989586621679219270"><a href="#local-6989586621679219270"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219271"><a href="#local-6989586621679219271"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679219272"><a href="#local-6989586621679219272"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219273"><a href="#local-6989586621679219273"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219270"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219274"><a href="#local-6989586621679219274"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219271"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219275"><a href="#local-6989586621679219275"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219272"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">FromThenTo</span><span> </span><a href="#local-6989586621679219273"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679219274"><span class="hs-identifier hs-var">y'</span></a><span> </span><a href="#local-6989586621679219275"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1020"></a><span>
</span><a name="line-1021"></a><span class="hs-comment">{- Note [Operator assocation]
We must be quite careful about adding parens:
  * Infix (UInfix ...) op arg      Needs parens round the first arg
  * Infix (Infix ...) op arg       Needs parens round the first arg
  * UInfix (UInfix ...) op arg     No parens for first arg
  * UInfix (Infix ...) op arg      Needs parens round first arg


Note [Converting UInfix]
~~~~~~~~~~~~~~~~~~~~~~~~
When converting @UInfixE@, @UInfixP@, and @UInfixT@ values, we want to readjust
the trees to reflect the fixities of the underlying operators:

  UInfixE x * (UInfixE y + z) ---&gt; (x * y) + z

This is done by the renamer (see @mkOppAppRn@, @mkConOppPatRn@, and
@mkHsOpTyRn@ in RnTypes), which expects that the input will be completely
right-biased for types and left-biased for everything else. So we left-bias the
trees of @UInfixP@ and @UInfixE@ and right-bias the trees of @UInfixT@.

Sample input:

  UInfixE
   (UInfixE x op1 y)
   op2
   (UInfixE z op3 w)

Sample output:

  OpApp
    (OpApp
      (OpApp x op1 y)
      op2
      z)
    op3
    w

The functions @cvtOpApp@, @cvtOpAppP@, and @cvtOpAppT@ are responsible for this
biasing.
-}</span><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span class="hs-comment">{- | @cvtOpApp x op y@ converts @op@ and @y@ and produces the operator application @x `op` y@.
The produced tree of infix expressions will be left-biased, provided @x@ is.

We can see that @cvtOpApp@ is correct as follows. The inductive hypothesis
is that @cvtOpApp x op y@ is left-biased, provided @x@ is. It is clear that
this holds for both branches (of @cvtOpApp@), provided we assume it holds for
the recursive calls to @cvtOpApp@.

When we call @cvtOpApp@ from @cvtl@, the first argument will always be left-biased
since we have already run @cvtl@ on it.
-}</span><span>
</span><a name="line-1073"></a><span class="hs-identifier">cvtOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1074"></a><a name="cvtOpApp"><a href="Convert.html#cvtOpApp"><span class="hs-identifier">cvtOpApp</span></a></a><span> </span><a name="local-6989586621679219276"><a href="#local-6989586621679219276"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219277"><a href="#local-6989586621679219277"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UInfixE</span><span> </span><a name="local-6989586621679219278"><a href="#local-6989586621679219278"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679219279"><a href="#local-6989586621679219279"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679219280"><a href="#local-6989586621679219280"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1075"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219281"><a href="#local-6989586621679219281"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtOpApp"><span class="hs-identifier hs-var">cvtOpApp</span></a><span> </span><a href="#local-6989586621679219276"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679219277"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679219278"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1076"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#cvtOpApp"><span class="hs-identifier hs-var">cvtOpApp</span></a><span> </span><a href="#local-6989586621679219281"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679219279"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679219280"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1077"></a><span class="hs-identifier">cvtOpApp</span><span> </span><a name="local-6989586621679219282"><a href="#local-6989586621679219282"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219283"><a href="#local-6989586621679219283"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679219284"><a href="#local-6989586621679219284"><span class="hs-identifier">y</span></a></a><span>
</span><a name="line-1078"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219285"><a href="#local-6989586621679219285"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219283"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1079"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219286"><a href="#local-6989586621679219286"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219284"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1080"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">OpApp</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219282"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679219285"><span class="hs-identifier hs-var">op'</span></a><span> </span><a href="#local-6989586621679219286"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1083"></a><span class="hs-comment">--      Do notation and statements</span><span>
</span><a name="line-1084"></a><span class="hs-comment">-------------------------------------</span><span>
</span><a name="line-1085"></a><span>
</span><a name="line-1086"></a><span class="hs-identifier">cvtHsDo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsStmtContext</span><span> </span><span class="hs-identifier hs-type">Name.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Stmt</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><a name="cvtHsDo"><a href="Convert.html#cvtHsDo"><span class="hs-identifier">cvtHsDo</span></a></a><span> </span><a name="local-6989586621679219287"><a href="#local-6989586621679219287"><span class="hs-identifier">do_or_lc</span></a></a><span> </span><a name="local-6989586621679219288"><a href="#local-6989586621679219288"><span class="hs-identifier">stmts</span></a></a><span>
</span><a name="line-1088"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679219288"><span class="hs-identifier hs-var">stmts</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Empty stmt list in do-block&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1089"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1090"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219291"><a href="#local-6989586621679219291"><span class="hs-identifier">stmts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtStmts"><span class="hs-identifier hs-var">cvtStmts</span></a><span> </span><a href="#local-6989586621679219288"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1091"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679219292"><a href="#local-6989586621679219292"><span class="hs-identifier">stmts''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219293"><a href="#local-6989586621679219293"><span class="hs-identifier">last'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snocView</span><span> </span><a href="#local-6989586621679219291"><span class="hs-identifier hs-var">stmts'</span></a><span>
</span><a name="line-1092"></a><span>
</span><a name="line-1093"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219296"><a href="#local-6989586621679219296"><span class="hs-identifier">last''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219293"><span class="hs-identifier hs-var">last'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1094"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679219294"><a href="#local-6989586621679219294"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BodyStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679219295"><a href="#local-6989586621679219295"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1095"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219294"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLastStmt</span><span> </span><a href="#local-6989586621679219295"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1096"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219289"><span class="hs-identifier hs-var">bad_last</span></a><span> </span><a href="#local-6989586621679219293"><span class="hs-identifier hs-var">last'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1097"></a><span>
</span><a name="line-1098"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsDo</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219287"><span class="hs-identifier hs-var">do_or_lc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219292"><span class="hs-identifier hs-var">stmts''</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679219296"><span class="hs-identifier hs-var">last''</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1099"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1100"></a><span>    </span><a name="local-6989586621679219289"><a href="#local-6989586621679219289"><span class="hs-identifier">bad_last</span></a></a><span> </span><a name="local-6989586621679219290"><a href="#local-6989586621679219290"><span class="hs-identifier">stmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">vcat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal last statement of&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">pprAStmtContext</span><span> </span><a href="#local-6989586621679219287"><span class="hs-identifier hs-var">do_or_lc</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">colon</span><span>
</span><a name="line-1101"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nest</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Outputable.ppr</span><span> </span><a href="#local-6989586621679219290"><span class="hs-identifier hs-var">stmt</span></a><span>
</span><a name="line-1102"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;(It should be an expression.)&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1103"></a><span>
</span><a name="line-1104"></a><span class="hs-identifier">cvtStmts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Stmt</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Hs.LStmt</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1105"></a><a name="cvtStmts"><a href="Convert.html#cvtStmts"><span class="hs-identifier">cvtStmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtStmt"><span class="hs-identifier hs-var">cvtStmt</span></a><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span class="hs-identifier">cvtStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Stmt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LStmt</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><a name="cvtStmt"><a href="Convert.html#cvtStmt"><span class="hs-identifier">cvtStmt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoBindS</span><span> </span><a name="local-6989586621679219297"><a href="#local-6989586621679219297"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219298"><a href="#local-6989586621679219298"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219297"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkBodyStmt</span><span> </span><a href="#local-6989586621679219298"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1109"></a><span class="hs-identifier">cvtStmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.BindS</span><span> </span><a name="local-6989586621679219299"><a href="#local-6989586621679219299"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679219300"><a href="#local-6989586621679219300"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219301"><a href="#local-6989586621679219301"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219299"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219302"><a href="#local-6989586621679219302"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219300"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkBindStmt</span><span> </span><a href="#local-6989586621679219301"><span class="hs-identifier hs-var">p'</span></a><span> </span><a href="#local-6989586621679219302"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1110"></a><span class="hs-identifier">cvtStmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.LetS</span><span> </span><a name="local-6989586621679219303"><a href="#local-6989586621679219303"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219304"><a href="#local-6989586621679219304"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier hs-var">cvtLocalDecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a let binding&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219303"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1111"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LetStmt</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219304"><span class="hs-identifier hs-var">ds'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1112"></a><span class="hs-identifier">cvtStmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ParS</span><span> </span><a name="local-6989586621679219305"><a href="#local-6989586621679219305"><span class="hs-identifier">dss</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219309"><a href="#local-6989586621679219309"><span class="hs-identifier">dss'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679219306"><span class="hs-identifier hs-var">cvt_one</span></a><span> </span><a href="#local-6989586621679219305"><span class="hs-identifier hs-var">dss</span></a><span>
</span><a name="line-1113"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ParStmt</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219309"><span class="hs-identifier hs-var">dss'</span></a><span> </span><span class="hs-identifier hs-var">noExpr</span><span> </span><span class="hs-identifier hs-var">noSyntaxExpr</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1114"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1115"></a><span>    </span><a name="local-6989586621679219306"><a href="#local-6989586621679219306"><span class="hs-identifier">cvt_one</span></a></a><span> </span><a name="local-6989586621679219307"><a href="#local-6989586621679219307"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219308"><a href="#local-6989586621679219308"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtStmts"><span class="hs-identifier hs-var">cvtStmts</span></a><span> </span><a href="#local-6989586621679219307"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1116"></a><span>                    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParStmtBlock</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219308"><span class="hs-identifier hs-var">ds'</span></a><span> </span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-identifier hs-var">noSyntaxExpr</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1117"></a><span class="hs-identifier">cvtStmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.RecS</span><span> </span><a name="local-6989586621679219310"><a href="#local-6989586621679219310"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219311"><a href="#local-6989586621679219311"><span class="hs-identifier">ss'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtStmt"><span class="hs-identifier hs-var">cvtStmt</span></a><span> </span><a href="#local-6989586621679219310"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRecStmt</span><span> </span><a href="#local-6989586621679219311"><span class="hs-identifier hs-var">ss'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1118"></a><span>
</span><a name="line-1119"></a><span class="hs-identifier">cvtMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsMatchContext</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-1120"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Match</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LMatch</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><a name="cvtMatch"><a href="Convert.html#cvtMatch"><span class="hs-identifier">cvtMatch</span></a></a><span> </span><a name="local-6989586621679219312"><a href="#local-6989586621679219312"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.Match</span><span> </span><a name="local-6989586621679219313"><a href="#local-6989586621679219313"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679219314"><a href="#local-6989586621679219314"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621679219315"><a href="#local-6989586621679219315"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1122"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219316"><a href="#local-6989586621679219316"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219313"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1123"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219317"><a href="#local-6989586621679219317"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219316"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1124"></a><span>                     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679219318"><a href="#local-6989586621679219318"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier hs-var">SigPat</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219318"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier hs-var">NoExt</span><span> </span><a href="#local-6989586621679219316"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- #14875</span><span>
</span><a name="line-1125"></a><span>                     </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679219316"><span class="hs-identifier hs-var">p'</span></a><span>
</span><a name="line-1126"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219319"><a href="#local-6989586621679219319"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtGuard"><span class="hs-identifier hs-var">cvtGuard</span></a><span> </span><a href="#local-6989586621679219314"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1127"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219320"><a href="#local-6989586621679219320"><span class="hs-identifier">decs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLocalDecs"><span class="hs-identifier hs-var">cvtLocalDecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;a where clause&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219315"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-1128"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.Match</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219312"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679219317"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219319"><span class="hs-identifier hs-var">g'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219320"><span class="hs-identifier hs-var">decs'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1129"></a><span>
</span><a name="line-1130"></a><span class="hs-identifier">cvtGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Body</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1131"></a><a name="cvtGuard"><a href="Convert.html#cvtGuard"><span class="hs-identifier">cvtGuard</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedB</span><span> </span><a name="local-6989586621679219321"><a href="#local-6989586621679219321"><span class="hs-identifier">pairs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtpair"><span class="hs-identifier hs-var">cvtpair</span></a><span> </span><a href="#local-6989586621679219321"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-1132"></a><span class="hs-identifier">cvtGuard</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalB</span><span> </span><a name="local-6989586621679219322"><a href="#local-6989586621679219322"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219323"><a href="#local-6989586621679219323"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219322"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1133"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219324"><a href="#local-6989586621679219324"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679219323"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679219324"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1134"></a><span>
</span><a name="line-1135"></a><span class="hs-identifier">cvtpair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1136"></a><a name="cvtpair"><a href="Convert.html#cvtpair"><span class="hs-identifier">cvtpair</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalG</span><span> </span><a name="local-6989586621679219325"><a href="#local-6989586621679219325"><span class="hs-identifier">ge</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219326"><a href="#local-6989586621679219326"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219327"><a href="#local-6989586621679219327"><span class="hs-identifier">ge'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219325"><span class="hs-identifier hs-var">ge</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219328"><a href="#local-6989586621679219328"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219326"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1137"></a><span>                              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219329"><a href="#local-6989586621679219329"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkBodyStmt</span><span> </span><a href="#local-6989586621679219327"><span class="hs-identifier hs-var">ge'</span></a><span>
</span><a name="line-1138"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679219329"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679219328"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1139"></a><span class="hs-identifier">cvtpair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatG</span><span> </span><a name="local-6989586621679219330"><a href="#local-6989586621679219330"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219331"><a href="#local-6989586621679219331"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219332"><a href="#local-6989586621679219332"><span class="hs-identifier">gs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtStmts"><span class="hs-identifier hs-var">cvtStmts</span></a><span> </span><a href="#local-6989586621679219330"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219333"><a href="#local-6989586621679219333"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219331"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1140"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219332"><span class="hs-identifier hs-var">gs'</span></a><span> </span><a href="#local-6989586621679219333"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1141"></a><span>
</span><a name="line-1142"></a><span class="hs-identifier">cvtOverLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsOverLit</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1143"></a><a name="cvtOverLit"><a href="Convert.html#cvtOverLit"><span class="hs-identifier">cvtOverLit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IntegerL</span><span> </span><a name="local-6989586621679219334"><a href="#local-6989586621679219334"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1144"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219334"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsIntegral</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkIntegralLit</span><span> </span><a href="#local-6989586621679219334"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1145"></a><span class="hs-identifier">cvtOverLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RationalL</span><span> </span><a name="local-6989586621679219335"><a href="#local-6989586621679219335"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1146"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219335"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsFractional</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFractionalLit</span><span> </span><a href="#local-6989586621679219335"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1147"></a><span class="hs-identifier">cvtOverLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StringL</span><span> </span><a name="local-6989586621679219336"><a href="#local-6989586621679219336"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219337"><a href="#local-6989586621679219337"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkFastString</span><span> </span><a href="#local-6989586621679219336"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1149"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219337"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1150"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkHsIsString</span><span> </span><span class="hs-special">(</span><a href="Convert.html#quotedSourceText"><span class="hs-identifier hs-var">quotedSourceText</span></a><span> </span><a href="#local-6989586621679219336"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219337"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1151"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-1152"></a><span class="hs-identifier">cvtOverLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;Convert.cvtOverLit: Unexpected overloaded literal&quot;</span><span>
</span><a name="line-1153"></a><span class="hs-comment">-- An Integer is like an (overloaded) '3' in a Haskell source program</span><span>
</span><a name="line-1154"></a><span class="hs-comment">-- Similarly 3.5 for fractionals</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-comment">{- Note [Converting strings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we get (ListE [CharL 'x', CharL 'y']) we'd like to convert to
a string literal for &quot;xy&quot;.  Of course, we might hope to get
(LitE (StringL &quot;xy&quot;)), but not always, and allCharLs fails quickly
if it isn't a literal string
-}</span><span>
</span><a name="line-1163"></a><span>
</span><a name="line-1164"></a><span class="hs-identifier">allCharLs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1165"></a><span class="hs-comment">-- Note [Converting strings]</span><span>
</span><a name="line-1166"></a><span class="hs-comment">-- NB: only fire up this setup for a non-empty list, else</span><span>
</span><a name="line-1167"></a><span class="hs-comment">--     there's a danger of returning &quot;&quot; for [] :: [Int]!</span><span>
</span><a name="line-1168"></a><a name="allCharLs"><a href="Convert.html#allCharLs"><span class="hs-identifier">allCharLs</span></a></a><span> </span><a name="local-6989586621679219338"><a href="#local-6989586621679219338"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-1169"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219338"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1170"></a><span>      </span><span class="hs-identifier hs-var">LitE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CharL</span><span> </span><a name="local-6989586621679219344"><a href="#local-6989586621679219344"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679219345"><a href="#local-6989586621679219345"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679219339"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679219344"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679219345"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-1171"></a><span>      </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1172"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1173"></a><span>    </span><a name="local-6989586621679219339"><a href="#local-6989586621679219339"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679219340"><a href="#local-6989586621679219340"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679219340"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679219341"><a href="#local-6989586621679219341"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LitE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CharL</span><span> </span><a name="local-6989586621679219342"><a href="#local-6989586621679219342"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679219343"><a href="#local-6989586621679219343"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219339"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679219342"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679219341"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219343"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-1175"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1176"></a><span>
</span><a name="line-1177"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><a name="cvtLit"><a href="Convert.html#cvtLit"><span class="hs-identifier">cvtLit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IntPrimL</span><span> </span><a name="local-6989586621679219346"><a href="#local-6989586621679219346"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219346"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsIntPrim</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219346"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1179"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WordPrimL</span><span> </span><a name="local-6989586621679219347"><a href="#local-6989586621679219347"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219347"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsWordPrim</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219347"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1180"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FloatPrimL</span><span> </span><a name="local-6989586621679219348"><a href="#local-6989586621679219348"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219348"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsFloatPrim</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFractionalLit</span><span> </span><a href="#local-6989586621679219348"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1182"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DoublePrimL</span><span> </span><a name="local-6989586621679219349"><a href="#local-6989586621679219349"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1183"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219349"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsDoublePrim</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFractionalLit</span><span> </span><a href="#local-6989586621679219349"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1184"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CharL</span><span> </span><a name="local-6989586621679219350"><a href="#local-6989586621679219350"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219350"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsChar</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219350"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1185"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CharPrimL</span><span> </span><a name="local-6989586621679219351"><a href="#local-6989586621679219351"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219351"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsCharPrim</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219351"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1186"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StringL</span><span> </span><a name="local-6989586621679219352"><a href="#local-6989586621679219352"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219353"><a href="#local-6989586621679219353"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkFastString</span><span> </span><a href="#local-6989586621679219352"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1187"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219353"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1188"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsString</span><span> </span><span class="hs-special">(</span><a href="Convert.html#quotedSourceText"><span class="hs-identifier hs-var">quotedSourceText</span></a><span> </span><a href="#local-6989586621679219352"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219353"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1189"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StringPrimL</span><span> </span><a name="local-6989586621679219354"><a href="#local-6989586621679219354"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219355"><a href="#local-6989586621679219355"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS.pack</span><span> </span><a href="#local-6989586621679219354"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1190"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679219355"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1191"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsStringPrim</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679219355"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1192"></a><span class="hs-identifier">cvtLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;Convert.cvtLit: Unexpected literal&quot;</span><span>
</span><a name="line-1193"></a><span>        </span><span class="hs-comment">-- cvtLit should not be called on IntegerL, RationalL</span><span>
</span><a name="line-1194"></a><span>        </span><span class="hs-comment">-- That precondition is established right here in</span><span>
</span><a name="line-1195"></a><span>        </span><span class="hs-comment">-- Convert.hs, hence panic</span><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-identifier">quotedSourceText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SourceText</span><span>
</span><a name="line-1198"></a><a name="quotedSourceText"><a href="Convert.html#quotedSourceText"><span class="hs-identifier">quotedSourceText</span></a></a><span> </span><a name="local-6989586621679219356"><a href="#local-6989586621679219356"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SourceText</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679219356"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span>
</span><a name="line-1199"></a><span>
</span><a name="line-1200"></a><span class="hs-identifier">cvtPats</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Pat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Hs.LPat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span>
</span><a name="line-1201"></a><a name="cvtPats"><a href="Convert.html#cvtPats"><span class="hs-identifier">cvtPats</span></a></a><span> </span><a name="local-6989586621679219357"><a href="#local-6989586621679219357"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219357"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1202"></a><span>
</span><a name="line-1203"></a><span class="hs-identifier">cvtPat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LPat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1204"></a><a name="cvtPat"><a href="Convert.html#cvtPat"><span class="hs-identifier">cvtPat</span></a></a><span> </span><a name="local-6989586621679219358"><a href="#local-6989586621679219358"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtp"><span class="hs-identifier hs-var">cvtp</span></a><span> </span><a href="#local-6989586621679219358"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1205"></a><span>
</span><a name="line-1206"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.Pat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><a name="cvtp"><a href="Convert.html#cvtp"><span class="hs-identifier">cvtp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.LitP</span><span> </span><a name="local-6989586621679219359"><a href="#local-6989586621679219359"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Convert.html#overloadedLit"><span class="hs-identifier hs-var">overloadedLit</span></a><span> </span><a href="#local-6989586621679219359"><span class="hs-identifier hs-var">l</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219360"><a href="#local-6989586621679219360"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtOverLit"><span class="hs-identifier hs-var">cvtOverLit</span></a><span> </span><a href="#local-6989586621679219359"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1209"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkNPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219360"><span class="hs-identifier hs-var">l'</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1210"></a><span>                                  </span><span class="hs-comment">-- Not right for negative patterns;</span><span>
</span><a name="line-1211"></a><span>                                  </span><span class="hs-comment">-- need to think about that!</span><span>
</span><a name="line-1212"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219361"><a href="#local-6989586621679219361"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtLit"><span class="hs-identifier hs-var">cvtLit</span></a><span> </span><a href="#local-6989586621679219359"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.LitPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219361"><span class="hs-identifier hs-var">l'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1213"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.VarP</span><span> </span><a name="local-6989586621679219362"><a href="#local-6989586621679219362"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219363"><a href="#local-6989586621679219363"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vName"><span class="hs-identifier hs-var">vName</span></a><span> </span><a href="#local-6989586621679219362"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1214"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.VarPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679219363"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1215"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TupP</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679219364"><a href="#local-6989586621679219364"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219365"><a href="#local-6989586621679219365"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219364"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219365"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1216"></a><span>                                         </span><span class="hs-comment">-- Note [Dropping constructors]</span><span>
</span><a name="line-1217"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TupP</span><span> </span><a name="local-6989586621679219366"><a href="#local-6989586621679219366"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219367"><a href="#local-6989586621679219367"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219366"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1218"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TuplePat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219367"><span class="hs-identifier hs-var">ps'</span></a><span> </span><span class="hs-identifier hs-var">Boxed</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1219"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnboxedTupP</span><span> </span><a name="local-6989586621679219368"><a href="#local-6989586621679219368"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219369"><a href="#local-6989586621679219369"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219368"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1220"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TuplePat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219369"><span class="hs-identifier hs-var">ps'</span></a><span> </span><span class="hs-identifier hs-var">Unboxed</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1221"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnboxedSumP</span><span> </span><a name="local-6989586621679219370"><a href="#local-6989586621679219370"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679219371"><a href="#local-6989586621679219371"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679219372"><a href="#local-6989586621679219372"><span class="hs-identifier">arity</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1222"></a><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219373"><a href="#local-6989586621679219373"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219370"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1223"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#unboxedSumChecks"><span class="hs-identifier hs-var">unboxedSumChecks</span></a><span> </span><a href="#local-6989586621679219371"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679219372"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-1224"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SumPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219373"><span class="hs-identifier hs-var">p'</span></a><span> </span><a href="#local-6989586621679219371"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621679219372"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConP</span><span> </span><a name="local-6989586621679219374"><a href="#local-6989586621679219374"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679219375"><a href="#local-6989586621679219375"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219376"><a href="#local-6989586621679219376"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219374"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219377"><a href="#local-6989586621679219377"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219375"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1226"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219378"><a href="#local-6989586621679219378"><span class="hs-identifier">pps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parenthesizePat</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219377"><span class="hs-identifier hs-var">ps'</span></a><span>
</span><a name="line-1227"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a href="#local-6989586621679219376"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a href="#local-6989586621679219378"><span class="hs-identifier hs-var">pps</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1228"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixP</span><span> </span><a name="local-6989586621679219379"><a href="#local-6989586621679219379"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679219380"><a href="#local-6989586621679219380"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679219381"><a href="#local-6989586621679219381"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219382"><a href="#local-6989586621679219382"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219380"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219383"><a href="#local-6989586621679219383"><span class="hs-identifier">p1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219379"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219384"><a href="#local-6989586621679219384"><span class="hs-identifier">p2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219381"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1229"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="Convert.html#wrapParL"><span class="hs-identifier hs-var">wrapParL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1230"></a><span>                              </span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a href="#local-6989586621679219382"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1231"></a><span>                              </span><span class="hs-identifier hs-var">InfixCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parenthesizePat</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679219383"><span class="hs-identifier hs-var">p1'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1232"></a><span>                                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parenthesizePat</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679219384"><span class="hs-identifier hs-var">p2'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1233"></a><span>                            </span><span class="hs-comment">-- See Note [Operator association]</span><span>
</span><a name="line-1234"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UInfixP</span><span> </span><a name="local-6989586621679219385"><a href="#local-6989586621679219385"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679219386"><a href="#local-6989586621679219386"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679219387"><a href="#local-6989586621679219387"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219388"><a href="#local-6989586621679219388"><span class="hs-identifier">p1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219385"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">;</span><span> </span><a href="Convert.html#cvtOpAppP"><span class="hs-identifier hs-var">cvtOpAppP</span></a><span> </span><a href="#local-6989586621679219388"><span class="hs-identifier hs-var">p1'</span></a><span> </span><a href="#local-6989586621679219386"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679219387"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- Note [Converting UInfix]</span><span>
</span><a name="line-1235"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParensP</span><span> </span><a name="local-6989586621679219389"><a href="#local-6989586621679219389"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219390"><a href="#local-6989586621679219390"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219389"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span>
</span><a name="line-1236"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621679219390"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-keyword">of</span><span>  </span><span class="hs-comment">-- may be wrapped ConPatIn</span><span>
</span><a name="line-1237"></a><span>                                </span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621679219390"><span class="hs-identifier hs-var">p'</span></a><span>
</span><a name="line-1238"></a><span>                                </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219390"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1239"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TildeP</span><span> </span><a name="local-6989586621679219391"><a href="#local-6989586621679219391"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219392"><a href="#local-6989586621679219392"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219391"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LazyPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219392"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1240"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BangP</span><span> </span><a name="local-6989586621679219393"><a href="#local-6989586621679219393"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219394"><a href="#local-6989586621679219394"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219393"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">BangPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219394"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1241"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.AsP</span><span> </span><a name="local-6989586621679219395"><a href="#local-6989586621679219395"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679219396"><a href="#local-6989586621679219396"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219397"><a href="#local-6989586621679219397"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219395"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219398"><a href="#local-6989586621679219398"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219396"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1242"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">AsPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219397"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679219398"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-identifier hs-var">TH.WildP</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">WildPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1244"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecP</span><span> </span><a name="local-6989586621679219399"><a href="#local-6989586621679219399"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679219400"><a href="#local-6989586621679219400"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219401"><a href="#local-6989586621679219401"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219399"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219402"><a href="#local-6989586621679219402"><span class="hs-identifier">fs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtPatFld"><span class="hs-identifier hs-var">cvtPatFld</span></a><span> </span><a href="#local-6989586621679219400"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1245"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a href="#local-6989586621679219401"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-1246"></a><span>                                     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.RecCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><a href="#local-6989586621679219402"><span class="hs-identifier hs-var">fs'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1247"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListP</span><span> </span><a name="local-6989586621679219403"><a href="#local-6989586621679219403"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219404"><a href="#local-6989586621679219404"><span class="hs-identifier">ps'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPats"><span class="hs-identifier hs-var">cvtPats</span></a><span> </span><a href="#local-6989586621679219403"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1248"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-1249"></a><span>                                   </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ListPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219404"><span class="hs-identifier hs-var">ps'</span></a><span class="hs-special">}</span><span>
</span><a name="line-1250"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigP</span><span> </span><a name="local-6989586621679219405"><a href="#local-6989586621679219405"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679219406"><a href="#local-6989586621679219406"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219407"><a href="#local-6989586621679219407"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219405"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219408"><a href="#local-6989586621679219408"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219406"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1251"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SigPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219407"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigWcType</span><span> </span><a href="#local-6989586621679219408"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1252"></a><span class="hs-identifier">cvtp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ViewP</span><span> </span><a name="local-6989586621679219409"><a href="#local-6989586621679219409"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679219410"><a href="#local-6989586621679219410"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219411"><a href="#local-6989586621679219411"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtl"><span class="hs-identifier hs-var">cvtl</span></a><span> </span><a href="#local-6989586621679219409"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679219412"><a href="#local-6989586621679219412"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219410"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1253"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ViewPat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219411"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679219412"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">}</span><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span class="hs-identifier">cvtPatFld</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Pat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsRecField</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><a name="cvtPatFld"><a href="Convert.html#cvtPatFld"><span class="hs-identifier">cvtPatFld</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679219413"><a href="#local-6989586621679219413"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219414"><a href="#local-6989586621679219414"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1257"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621679219415"><a href="#local-6989586621679219415"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679219416"><a href="#local-6989586621679219416"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#vNameL"><span class="hs-identifier hs-var">vNameL</span></a><span> </span><a href="#local-6989586621679219413"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1258"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219417"><a href="#local-6989586621679219417"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219414"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1259"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRecField</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldLbl</span><span>
</span><a name="line-1260"></a><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219415"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkFieldOcc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679219415"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679219416"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1261"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679219417"><span class="hs-identifier hs-var">p'</span></a><span>
</span><a name="line-1262"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsRecPun</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1263"></a><span>
</span><a name="line-1264"></a><span class="hs-comment">{- | @cvtOpAppP x op y@ converts @op@ and @y@ and produces the operator application @x `op` y@.
The produced tree of infix patterns will be left-biased, provided @x@ is.

See the @cvtOpApp@ documentation for how this function works.
-}</span><span>
</span><a name="line-1269"></a><span class="hs-identifier">cvtOpAppP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Hs.LPat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.Pat</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><a name="cvtOpAppP"><a href="Convert.html#cvtOpAppP"><span class="hs-identifier">cvtOpAppP</span></a></a><span> </span><a name="local-6989586621679219418"><a href="#local-6989586621679219418"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219419"><a href="#local-6989586621679219419"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UInfixP</span><span> </span><a name="local-6989586621679219420"><a href="#local-6989586621679219420"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679219421"><a href="#local-6989586621679219421"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679219422"><a href="#local-6989586621679219422"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219423"><a href="#local-6989586621679219423"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#cvtOpAppP"><span class="hs-identifier hs-var">cvtOpAppP</span></a><span> </span><a href="#local-6989586621679219418"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679219419"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679219420"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1272"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#cvtOpAppP"><span class="hs-identifier hs-var">cvtOpAppP</span></a><span> </span><a href="#local-6989586621679219423"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679219421"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679219422"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1273"></a><span class="hs-identifier">cvtOpAppP</span><span> </span><a name="local-6989586621679219424"><a href="#local-6989586621679219424"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679219425"><a href="#local-6989586621679219425"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679219426"><a href="#local-6989586621679219426"><span class="hs-identifier">y</span></a></a><span>
</span><a name="line-1274"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219427"><a href="#local-6989586621679219427"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cNameL"><span class="hs-identifier hs-var">cNameL</span></a><span> </span><a href="#local-6989586621679219425"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1275"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219428"><a href="#local-6989586621679219428"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtPat"><span class="hs-identifier hs-var">cvtPat</span></a><span> </span><a href="#local-6989586621679219426"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1276"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a href="#local-6989586621679219427"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a href="#local-6989586621679219424"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679219428"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1277"></a><span>
</span><a name="line-1278"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1279"></a><span class="hs-comment">--      Types and type variables</span><span>
</span><a name="line-1280"></a><span>
</span><a name="line-1281"></a><span class="hs-identifier">cvtTvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><a name="cvtTvs"><a href="Convert.html#cvtTvs"><span class="hs-identifier">cvtTvs</span></a></a><span> </span><a name="local-6989586621679219429"><a href="#local-6989586621679219429"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219430"><a href="#local-6989586621679219430"><span class="hs-identifier">tvs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvt_tv"><span class="hs-identifier hs-var">cvt_tv</span></a><span> </span><a href="#local-6989586621679219429"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkHsQTvs</span><span> </span><a href="#local-6989586621679219430"><span class="hs-identifier hs-var">tvs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1283"></a><span>
</span><a name="line-1284"></a><span class="hs-identifier">cvt_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.TyVarBndr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1285"></a><a name="cvt_tv"><a href="Convert.html#cvt_tv"><span class="hs-identifier">cvt_tv</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.PlainTV</span><span> </span><a name="local-6989586621679219431"><a href="#local-6989586621679219431"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1286"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219432"><a href="#local-6989586621679219432"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679219431"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1287"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UserTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219432"><span class="hs-identifier hs-var">nm'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1288"></a><span class="hs-identifier">cvt_tv</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.KindedTV</span><span> </span><a name="local-6989586621679219433"><a href="#local-6989586621679219433"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621679219434"><a href="#local-6989586621679219434"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1289"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219435"><a href="#local-6989586621679219435"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679219433"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1290"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219436"><a href="#local-6989586621679219436"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><a href="#local-6989586621679219434"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1291"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">KindedTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219435"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621679219436"><span class="hs-identifier hs-var">ki'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">cvtRole</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Role</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Coercion.Role</span><span>
</span><a name="line-1294"></a><a name="cvtRole"><a href="Convert.html#cvtRole"><span class="hs-identifier">cvtRole</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NominalR</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Coercion.Nominal</span><span>
</span><a name="line-1295"></a><span class="hs-identifier">cvtRole</span><span> </span><span class="hs-identifier hs-var">TH.RepresentationalR</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Coercion.Representational</span><span>
</span><a name="line-1296"></a><span class="hs-identifier">cvtRole</span><span> </span><span class="hs-identifier hs-var">TH.PhantomR</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Coercion.Phantom</span><span>
</span><a name="line-1297"></a><span class="hs-identifier">cvtRole</span><span> </span><span class="hs-identifier hs-var">TH.InferR</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1298"></a><span>
</span><a name="line-1299"></a><span class="hs-identifier">cvtContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Cxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1300"></a><a name="cvtContext"><a href="Convert.html#cvtContext"><span class="hs-identifier">cvtContext</span></a></a><span> </span><a name="local-6989586621679219437"><a href="#local-6989586621679219437"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219438"><a href="#local-6989586621679219438"><span class="hs-identifier">preds'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#cvtPred"><span class="hs-identifier hs-var">cvtPred</span></a><span> </span><a href="#local-6989586621679219437"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><a href="#local-6989586621679219438"><span class="hs-identifier hs-var">preds'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1301"></a><span>
</span><a name="line-1302"></a><span class="hs-identifier">cvtPred</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Pred</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1303"></a><a name="cvtPred"><a href="Convert.html#cvtPred"><span class="hs-identifier">cvtPred</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span>
</span><a name="line-1304"></a><span>
</span><a name="line-1305"></a><span class="hs-identifier">cvtDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.DerivClause</span><span>
</span><a name="line-1306"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDerivingClause</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1307"></a><a name="cvtDerivClause"><a href="Convert.html#cvtDerivClause"><span class="hs-identifier">cvtDerivClause</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.DerivClause</span><span> </span><a name="local-6989586621679219439"><a href="#local-6989586621679219439"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679219440"><a href="#local-6989586621679219440"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1308"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679219441"><a href="#local-6989586621679219441"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">mkLHsSigType</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679219440"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1309"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679219442"><a href="#local-6989586621679219442"><span class="hs-identifier">ds'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="Convert.html#cvtDerivStrategy"><span class="hs-identifier hs-var">cvtDerivStrategy</span></a><span> </span><a href="#local-6989586621679219439"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1310"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsDerivingClause</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219442"><span class="hs-identifier hs-var">ds'</span></a><span> </span><a href="#local-6989586621679219441"><span class="hs-identifier hs-var">ctxt'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1311"></a><span>
</span><a name="line-1312"></a><span class="hs-identifier">cvtDerivStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.DerivStrategy</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LDerivStrategy</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><a name="cvtDerivStrategy"><a href="Convert.html#cvtDerivStrategy"><span class="hs-identifier">cvtDerivStrategy</span></a></a><span> </span><span class="hs-identifier hs-var">TH.StockStrategy</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-identifier hs-var">Hs.StockStrategy</span><span>
</span><a name="line-1314"></a><span class="hs-identifier">cvtDerivStrategy</span><span> </span><span class="hs-identifier hs-var">TH.AnyclassStrategy</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-identifier hs-var">Hs.AnyclassStrategy</span><span>
</span><a name="line-1315"></a><span class="hs-identifier">cvtDerivStrategy</span><span> </span><span class="hs-identifier hs-var">TH.NewtypeStrategy</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-identifier hs-var">Hs.NewtypeStrategy</span><span>
</span><a name="line-1316"></a><span class="hs-identifier">cvtDerivStrategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.ViaStrategy</span><span> </span><a name="local-6989586621679219443"><a href="#local-6989586621679219443"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1317"></a><span>  </span><a name="local-6989586621679219444"><a href="#local-6989586621679219444"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679219443"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1318"></a><span>  </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Hs.ViaStrategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkLHsSigType</span><span> </span><a href="#local-6989586621679219444"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>
</span><a name="line-1320"></a><span class="hs-identifier">cvtType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1321"></a><a name="cvtType"><a href="Convert.html#cvtType"><span class="hs-identifier">cvtType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtTypeKind"><span class="hs-identifier hs-var">cvtTypeKind</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span class="hs-identifier">cvtTypeKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1324"></a><a name="cvtTypeKind"><a href="Convert.html#cvtTypeKind"><span class="hs-identifier">cvtTypeKind</span></a></a><span> </span><a name="local-6989586621679219445"><a href="#local-6989586621679219445"><span class="hs-identifier">ty_str</span></a></a><span> </span><a name="local-6989586621679219446"><a href="#local-6989586621679219446"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1325"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679219447"><a href="#local-6989586621679219447"><span class="hs-identifier">head_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679219448"><a href="#local-6989586621679219448"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#split_ty_app"><span class="hs-identifier hs-var">split_ty_app</span></a><span> </span><a href="#local-6989586621679219446"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1326"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219449"><a href="#local-6989586621679219449"><span class="hs-identifier">m_normals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679219450"><span class="hs-identifier hs-var">extract_normal</span></a><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1327"></a><span>                                </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679219450"><a href="#local-6989586621679219450"><span class="hs-identifier">extract_normal</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621679219451"><a href="#local-6989586621679219451"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679219451"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1328"></a><span>                                      </span><span class="hs-identifier">extract_normal</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1329"></a><span>
</span><a name="line-1330"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679219447"><span class="hs-identifier hs-var">head_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1331"></a><span>           </span><span class="hs-identifier hs-var">TupleT</span><span> </span><a name="local-6989586621679219452"><a href="#local-6989586621679219452"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1332"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219453"><a href="#local-6989586621679219453"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1333"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679219453"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIs</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679219452"><span class="hs-identifier hs-var">n</span></a><span>         </span><span class="hs-comment">-- Saturated</span><span>
</span><a name="line-1334"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679219452"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679219453"><span class="hs-identifier hs-var">normals</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Singleton tuples treated</span><span>
</span><a name="line-1335"></a><span>                                                     </span><span class="hs-comment">-- like nothing (ie just parens)</span><span>
</span><a name="line-1336"></a><span>                          </span><span class="hs-keyword">else</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTupleTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1337"></a><span>                                        </span><span class="hs-identifier hs-var">HsBoxedOrConstraintTuple</span><span> </span><a href="#local-6989586621679219453"><span class="hs-identifier hs-var">normals</span></a><span class="hs-special">)</span><span>
</span><a name="line-1338"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679219452"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1339"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ptext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sLit</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Illegal 1-tuple &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679219445"><span class="hs-identifier hs-var">ty_str</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; constructor&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1340"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1341"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1342"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tupleTyCon</span><span> </span><span class="hs-identifier hs-var">Boxed</span><span> </span><a href="#local-6989586621679219452"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1343"></a><span>               </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1344"></a><span>           </span><span class="hs-identifier hs-var">UnboxedTupleT</span><span> </span><a name="local-6989586621679219454"><a href="#local-6989586621679219454"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1345"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219455"><a href="#local-6989586621679219455"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1346"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679219455"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIs</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679219454"><span class="hs-identifier hs-var">n</span></a><span>               </span><span class="hs-comment">-- Saturated</span><span>
</span><a name="line-1347"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTupleTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">HsUnboxedTuple</span><span> </span><a href="#local-6989586621679219455"><span class="hs-identifier hs-var">normals</span></a><span class="hs-special">)</span><span>
</span><a name="line-1348"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1349"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1350"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tupleTyCon</span><span> </span><span class="hs-identifier hs-var">Unboxed</span><span> </span><a href="#local-6989586621679219454"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1352"></a><span>           </span><span class="hs-identifier hs-var">UnboxedSumT</span><span> </span><a name="local-6989586621679219456"><a href="#local-6989586621679219456"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1353"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679219456"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1354"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1355"></a><span>                   </span><span class="hs-identifier hs-var">vcat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal sum arity:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679219456"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1356"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nest</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1357"></a><span>                            </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Sums must have an arity of at least 2&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1358"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219457"><a href="#local-6989586621679219457"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1359"></a><span>             </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679219457"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIs</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679219456"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-comment">-- Saturated</span><span>
</span><a name="line-1360"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSumTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219457"><span class="hs-identifier hs-var">normals</span></a><span class="hs-special">)</span><span>
</span><a name="line-1361"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1362"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1363"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sumTyCon</span><span> </span><a href="#local-6989586621679219456"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1364"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1365"></a><span>           </span><span class="hs-identifier hs-var">ArrowT</span><span>
</span><a name="line-1366"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679219458"><a href="#local-6989586621679219458"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1367"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679219459"><a href="#local-6989586621679219459"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679219460"><a href="#local-6989586621679219460"><span class="hs-identifier">y'</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219458"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1368"></a><span>                 </span><a name="local-6989586621679219461"><a href="#local-6989586621679219461"><span class="hs-identifier">x''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621679219459"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1369"></a><span>                          </span><span class="hs-identifier hs-var">HsFunTy</span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219459"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1370"></a><span>                          </span><span class="hs-identifier hs-var">HsForAllTy</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219459"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- #14646</span><span>
</span><a name="line-1371"></a><span>                          </span><span class="hs-identifier hs-var">HsQualTy</span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219459"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- #15324</span><span>
</span><a name="line-1372"></a><span>                          </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1373"></a><span>                                          </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">sigPrec</span><span> </span><a href="#local-6989586621679219459"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-1374"></a><span>                 </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679219462"><a href="#local-6989586621679219462"><span class="hs-identifier">y''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">sigPrec</span><span> </span><a href="#local-6989586621679219460"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-1375"></a><span>                 </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsFunTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679219461"><span class="hs-identifier hs-var">x''</span></a><span> </span><a href="#local-6989586621679219462"><span class="hs-identifier hs-var">y''</span></a><span class="hs-special">)</span><span>
</span><a name="line-1376"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1377"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1378"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-identifier hs-var">funTyCon</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1379"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1380"></a><span>           </span><span class="hs-identifier hs-var">ListT</span><span>
</span><a name="line-1381"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220001"><a href="#local-6989586621679220001"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1382"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679220002"><a href="#local-6989586621679220002"><span class="hs-identifier">x'</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220001"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1383"></a><span>                </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsListTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220002"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1384"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1385"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1386"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-identifier hs-var">listTyCon</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1387"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1388"></a><span>
</span><a name="line-1389"></a><span>           </span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679220003"><a href="#local-6989586621679220003"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220004"><a href="#local-6989586621679220004"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679220003"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1390"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><a href="#local-6989586621679220004"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1391"></a><span>           </span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679220005"><a href="#local-6989586621679220005"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220006"><a href="#local-6989586621679220006"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconName"><span class="hs-identifier hs-var">tconName</span></a><span> </span><a href="#local-6989586621679220005"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1392"></a><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-comment">-- ConT can contain both data constructor (i.e.,</span><span>
</span><a name="line-1393"></a><span>                           </span><span class="hs-comment">-- promoted) names and other (i.e, unpromoted)</span><span>
</span><a name="line-1394"></a><span>                           </span><span class="hs-comment">-- names, as opposed to PromotedT, which can only</span><span>
</span><a name="line-1395"></a><span>                           </span><span class="hs-comment">-- contain data constructor names. See #15572.</span><span>
</span><a name="line-1396"></a><span>                           </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220007"><a href="#local-6989586621679220007"><span class="hs-identifier">prom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isRdrDataCon</span><span> </span><a href="#local-6989586621679220006"><span class="hs-identifier hs-var">nm'</span></a><span>
</span><a name="line-1397"></a><span>                                      </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">IsPromoted</span><span>
</span><a name="line-1398"></a><span>                                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span>
</span><a name="line-1399"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220007"><span class="hs-identifier hs-var">prom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679220006"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">}</span><span>
</span><a name="line-1400"></a><span>
</span><a name="line-1401"></a><span>           </span><span class="hs-identifier hs-var">ForallT</span><span> </span><a name="local-6989586621679220008"><a href="#local-6989586621679220008"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679220009"><a href="#local-6989586621679220009"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621679220010"><a href="#local-6989586621679220010"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1402"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1403"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220011"><a href="#local-6989586621679220011"><span class="hs-identifier">tvs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtTvs"><span class="hs-identifier hs-var">cvtTvs</span></a><span> </span><a href="#local-6989586621679220008"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1404"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220012"><a href="#local-6989586621679220012"><span class="hs-identifier">cxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtContext"><span class="hs-identifier hs-var">cvtContext</span></a><span> </span><a href="#local-6989586621679220009"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-1405"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220013"><a href="#local-6989586621679220013"><span class="hs-identifier">pcxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsContext</span><span> </span><span class="hs-identifier hs-var">funPrec</span><span> </span><a href="#local-6989586621679220012"><span class="hs-identifier hs-var">cxt'</span></a><span>
</span><a name="line-1406"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220014"><a href="#local-6989586621679220014"><span class="hs-identifier">ty'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220010"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1407"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220015"><a href="#local-6989586621679220015"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#getL"><span class="hs-identifier hs-var">getL</span></a><span>
</span><a name="line-1408"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220016"><a href="#local-6989586621679220016"><span class="hs-identifier">hs_ty</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mkHsForAllTy"><span class="hs-identifier hs-var">mkHsForAllTy</span></a><span> </span><a href="#local-6989586621679220008"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679220015"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679220011"><span class="hs-identifier hs-var">tvs'</span></a><span> </span><a href="#local-6989586621679220017"><span class="hs-identifier hs-var">rho_ty</span></a><span>
</span><a name="line-1409"></a><span>                         </span><a name="local-6989586621679220017"><a href="#local-6989586621679220017"><span class="hs-identifier">rho_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mkHsQualTy"><span class="hs-identifier hs-var">mkHsQualTy</span></a><span> </span><a href="#local-6989586621679220009"><span class="hs-identifier hs-var">cxt</span></a><span> </span><a href="#local-6989586621679220015"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679220013"><span class="hs-identifier hs-var">pcxt</span></a><span> </span><a href="#local-6989586621679220014"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1410"></a><span>
</span><a name="line-1411"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679220016"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1412"></a><span>
</span><a name="line-1413"></a><span>           </span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679220018"><a href="#local-6989586621679220018"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679220019"><a href="#local-6989586621679220019"><span class="hs-identifier">ki</span></a></a><span>
</span><a name="line-1414"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220020"><a href="#local-6989586621679220020"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220018"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1415"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220021"><a href="#local-6989586621679220021"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><a href="#local-6989586621679220019"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1416"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsKindSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220020"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679220021"><span class="hs-identifier hs-var">ki'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1417"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-1418"></a><span>
</span><a name="line-1419"></a><span>           </span><span class="hs-identifier hs-var">LitT</span><span> </span><a name="local-6989586621679220022"><a href="#local-6989586621679220022"><span class="hs-identifier">lit</span></a></a><span>
</span><a name="line-1420"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyLit</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><a href="Convert.html#cvtTyLit"><span class="hs-identifier hs-var">cvtTyLit</span></a><span> </span><a href="#local-6989586621679220022"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1421"></a><span>
</span><a name="line-1422"></a><span>           </span><span class="hs-identifier hs-var">WildCardT</span><span>
</span><a name="line-1423"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-identifier hs-var">mkAnonWildCardTy</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1424"></a><span>
</span><a name="line-1425"></a><span>           </span><span class="hs-identifier hs-var">InfixT</span><span> </span><a name="local-6989586621679220023"><a href="#local-6989586621679220023"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679220024"><a href="#local-6989586621679220024"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679220025"><a href="#local-6989586621679220025"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1426"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220026"><a href="#local-6989586621679220026"><span class="hs-identifier">s'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconName"><span class="hs-identifier hs-var">tconName</span></a><span> </span><a href="#local-6989586621679220024"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1427"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220027"><a href="#local-6989586621679220027"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220023"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1428"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220028"><a href="#local-6989586621679220028"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220025"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1429"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1430"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679220026"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1431"></a><span>                      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a href="#local-6989586621679220027"><span class="hs-identifier hs-var">t1'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a href="#local-6989586621679220028"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1432"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-1433"></a><span>
</span><a name="line-1434"></a><span>           </span><span class="hs-identifier hs-var">UInfixT</span><span> </span><a name="local-6989586621679220029"><a href="#local-6989586621679220029"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679220030"><a href="#local-6989586621679220030"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679220031"><a href="#local-6989586621679220031"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1435"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220032"><a href="#local-6989586621679220032"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220031"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1436"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220033"><a href="#local-6989586621679220033"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtOpAppT"><span class="hs-identifier hs-var">cvtOpAppT</span></a><span> </span><a href="#local-6989586621679220029"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679220030"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679220032"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-1437"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621679220033"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1438"></a><span>                   </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- Note [Converting UInfix]</span><span>
</span><a name="line-1439"></a><span>
</span><a name="line-1440"></a><span>           </span><span class="hs-identifier hs-var">ParensT</span><span> </span><a name="local-6989586621679220034"><a href="#local-6989586621679220034"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1441"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220035"><a href="#local-6989586621679220035"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220034"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1442"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220035"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1443"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-1444"></a><span>
</span><a name="line-1445"></a><span>           </span><span class="hs-identifier hs-var">PromotedT</span><span> </span><a name="local-6989586621679220036"><a href="#local-6989586621679220036"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220037"><a href="#local-6989586621679220037"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cName"><span class="hs-identifier hs-var">cName</span></a><span> </span><a href="#local-6989586621679220036"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1446"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">IsPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621679220037"><span class="hs-identifier hs-var">nm'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>                                        </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1448"></a><span>                 </span><span class="hs-comment">-- Promoted data constructor; hence cName</span><span>
</span><a name="line-1449"></a><span>
</span><a name="line-1450"></a><span>           </span><span class="hs-identifier hs-var">PromotedTupleT</span><span> </span><a name="local-6989586621679220038"><a href="#local-6989586621679220038"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1451"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679220038"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1452"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ptext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sLit</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Illegal promoted 1-tuple &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679219445"><span class="hs-identifier hs-var">ty_str</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220039"><a href="#local-6989586621679220039"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1454"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679220039"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIs</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679220038"><span class="hs-identifier hs-var">n</span></a><span>   </span><span class="hs-comment">-- Saturated</span><span>
</span><a name="line-1455"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitTupleTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220039"><span class="hs-identifier hs-var">normals</span></a><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1457"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1458"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">IsPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tupleDataCon</span><span> </span><span class="hs-identifier hs-var">Boxed</span><span> </span><a href="#local-6989586621679220038"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>                 </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1460"></a><span>
</span><a name="line-1461"></a><span>           </span><span class="hs-identifier hs-var">PromotedNilT</span><span>
</span><a name="line-1462"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitListTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">IsPromoted</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1463"></a><span>
</span><a name="line-1464"></a><span>           </span><span class="hs-identifier hs-var">PromotedConsT</span><span>  </span><span class="hs-comment">-- See Note [Representing concrete syntax in types]</span><span>
</span><a name="line-1465"></a><span>                          </span><span class="hs-comment">-- in Language.Haskell.TH.Syntax</span><span>
</span><a name="line-1466"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220040"><a href="#local-6989586621679220040"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1467"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679220041"><a href="#local-6989586621679220041"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitListTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679220042"><a href="#local-6989586621679220042"><span class="hs-identifier">ip</span></a></a><span> </span><a name="local-6989586621679220043"><a href="#local-6989586621679220043"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220040"><span class="hs-identifier hs-var">normals</span></a><span>
</span><a name="line-1468"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1469"></a><span>                  </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitListTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220042"><span class="hs-identifier hs-var">ip</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220041"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679220043"><span class="hs-identifier hs-var">tys2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1471"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1472"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">IsPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-identifier hs-var">consDataCon</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span>                 </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1474"></a><span>
</span><a name="line-1475"></a><span>           </span><span class="hs-identifier hs-var">StarT</span><span>
</span><a name="line-1476"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1477"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-identifier hs-var">liftedTypeKindTyCon</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1479"></a><span>
</span><a name="line-1480"></a><span>           </span><span class="hs-identifier hs-var">ConstraintT</span><span>
</span><a name="line-1481"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span>
</span><a name="line-1482"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getRdrName</span><span> </span><span class="hs-identifier hs-var">constraintKindTyCon</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1483"></a><span>                </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1484"></a><span>
</span><a name="line-1485"></a><span>           </span><span class="hs-identifier hs-var">EqualityT</span><span>
</span><a name="line-1486"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220044"><a href="#local-6989586621679220044"><span class="hs-identifier">normals</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679219449"><span class="hs-identifier hs-var">m_normals</span></a><span>
</span><a name="line-1487"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679220045"><a href="#local-6989586621679220045"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679220046"><a href="#local-6989586621679220046"><span class="hs-identifier">y'</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220044"><span class="hs-identifier hs-var">normals</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1488"></a><span>                   </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220047"><a href="#local-6989586621679220047"><span class="hs-identifier">px</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679220045"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-1489"></a><span>                       </span><a name="local-6989586621679220048"><a href="#local-6989586621679220048"><span class="hs-identifier">py</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">opPrec</span><span> </span><a href="#local-6989586621679220046"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-1490"></a><span>                   </span><span class="hs-keyword">in</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsOpTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220047"><span class="hs-identifier hs-var">px</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-identifier hs-var">eqTyCon_RDR</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220048"><span class="hs-identifier hs-var">py</span></a><span class="hs-special">)</span><span>
</span><a name="line-1491"></a><span>               </span><span class="hs-comment">-- The long-term goal is to remove the above case entirely and</span><span>
</span><a name="line-1492"></a><span>               </span><span class="hs-comment">-- subsume it under the case for InfixT. See #15815, comment:6,</span><span>
</span><a name="line-1493"></a><span>               </span><span class="hs-comment">-- for more details.</span><span>
</span><a name="line-1494"></a><span>
</span><a name="line-1495"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1496"></a><span>                   </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-identifier hs-var">NotPromoted</span><span>
</span><a name="line-1497"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><span class="hs-identifier hs-var">eqTyCon_RDR</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679219448"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1498"></a><span>           </span><span class="hs-identifier hs-var">ImplicitParamT</span><span> </span><a name="local-6989586621679220049"><a href="#local-6989586621679220049"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679220050"><a href="#local-6989586621679220050"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1499"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220051"><a href="#local-6989586621679220051"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Convert.html#ipName"><span class="hs-identifier hs-var">ipName</span></a><span> </span><a href="#local-6989586621679220049"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1500"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220052"><a href="#local-6989586621679220052"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220050"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1501"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIParamTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220051"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-6989586621679220052"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-1503"></a><span>
</span><a name="line-1504"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ptext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sLit</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Malformed &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679219445"><span class="hs-identifier hs-var">ty_str</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679219446"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1505"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1506"></a><span>
</span><a name="line-1507"></a><span class="hs-comment">-- | Constructs an application of a type to arguments passed in a list.</span><span>
</span><a name="line-1508"></a><span class="hs-identifier">mk_apps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1509"></a><a name="mk_apps"><a href="Convert.html#mk_apps"><span class="hs-identifier">mk_apps</span></a></a><span> </span><a name="local-6989586621679220053"><a href="#local-6989586621679220053"><span class="hs-identifier">head_ty</span></a></a><span> </span><a name="local-6989586621679220054"><a href="#local-6989586621679220054"><span class="hs-identifier">type_args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1510"></a><span>  </span><a name="local-6989586621679220058"><a href="#local-6989586621679220058"><span class="hs-identifier">head_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><a href="#local-6989586621679220053"><span class="hs-identifier hs-var">head_ty</span></a><span>
</span><a name="line-1511"></a><span>  </span><span class="hs-comment">-- We must parenthesize the function type in case of an explicit</span><span>
</span><a name="line-1512"></a><span>  </span><span class="hs-comment">-- signature. For instance, in `(Maybe :: Type -&gt; Type) Int`, there</span><span>
</span><a name="line-1513"></a><span>  </span><span class="hs-comment">-- _must_ be parentheses around `Maybe :: Type -&gt; Type`.</span><span>
</span><a name="line-1514"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">phead_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1515"></a><span>      </span><a name="local-6989586621679220059"><a href="#local-6989586621679220059"><span class="hs-identifier">phead_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">sigPrec</span><span> </span><a href="#local-6989586621679220058"><span class="hs-identifier hs-var">head_ty'</span></a><span>
</span><a name="line-1516"></a><span>
</span><a name="line-1517"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1518"></a><span>      </span><a name="local-6989586621679220060"><a href="#local-6989586621679220060"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679220058"><span class="hs-identifier hs-var">head_ty'</span></a><span>
</span><a name="line-1519"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679220061"><a href="#local-6989586621679220061"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679220062"><a href="#local-6989586621679220062"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1520"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679220061"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1521"></a><span>          </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621679220063"><a href="#local-6989586621679220063"><span class="hs-identifier">ty</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679220064"><a href="#local-6989586621679220064"><span class="hs-identifier">p_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220055"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><a href="#local-6989586621679220063"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1522"></a><span>                             </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAppTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220059"><span class="hs-identifier hs-var">phead_ty</span></a><span> </span><a href="#local-6989586621679220064"><span class="hs-identifier hs-var">p_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220062"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1523"></a><span>          </span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><a name="local-6989586621679220065"><a href="#local-6989586621679220065"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679220066"><a href="#local-6989586621679220066"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679220067"><a href="#local-6989586621679220067"><span class="hs-identifier">p_ki</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220055"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><a href="#local-6989586621679220066"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1524"></a><span>                               </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAppKindTy</span><span> </span><a href="#local-6989586621679220065"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679220059"><span class="hs-identifier hs-var">phead_ty</span></a><span> </span><a href="#local-6989586621679220067"><span class="hs-identifier hs-var">p_ki</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220062"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1525"></a><span>          </span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#mk_apps"><span class="hs-identifier hs-var">mk_apps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220059"><span class="hs-identifier hs-var">phead_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220062"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1526"></a><span>
</span><a name="line-1527"></a><span>  </span><a href="#local-6989586621679220060"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220054"><span class="hs-identifier hs-var">type_args</span></a><span>
</span><a name="line-1528"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1529"></a><span>    </span><span class="hs-comment">-- See Note [Adding parens for splices]</span><span>
</span><a name="line-1530"></a><span>    </span><a name="local-6989586621679220055"><a href="#local-6989586621679220055"><span class="hs-identifier">add_parens</span></a></a><span> </span><a name="local-6989586621679220056"><a href="#local-6989586621679220056"><span class="hs-identifier">lt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679220057"><a href="#local-6989586621679220057"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1531"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">hsTypeNeedsParens</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span> </span><a href="#local-6989586621679220057"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220056"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1532"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679220056"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-1533"></a><span>
</span><a name="line-1534"></a><span class="hs-identifier">wrap_tyarg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1535"></a><a name="wrap_tyarg"><a href="Convert.html#wrap_tyarg"><span class="hs-identifier">wrap_tyarg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621679220068"><a href="#local-6989586621679220068"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span> </span><a href="#local-6989586621679220068"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1536"></a><span class="hs-identifier">wrap_tyarg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><a name="local-6989586621679220069"><a href="#local-6989586621679220069"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679220070"><a href="#local-6989586621679220070"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><a href="#local-6989586621679220069"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">parenthesizeHsType</span><span> </span><span class="hs-identifier hs-var">appPrec</span><span> </span><a href="#local-6989586621679220070"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1537"></a><span class="hs-identifier">wrap_tyarg</span><span> </span><a name="local-6989586621679220071"><a href="#local-6989586621679220071"><span class="hs-identifier">ta</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220071"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-comment">-- Already parenthesized</span><span>
</span><a name="line-1538"></a><span>
</span><a name="line-1539"></a><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><a name="line-1540"></a><span class="hs-comment">-- Note [Adding parens for splices]</span><span>
</span><a name="line-1541"></a><span class="hs-comment">{-
The hsSyn representation of parsed source explicitly contains all the original
parens, as written in the source.

When a Template Haskell (TH) splice is evaluated, the original splice is first
renamed and type checked and then finally converted to core in DsMeta. This core
is then run in the TH engine, and the result comes back as a TH AST.

In the process, all parens are stripped out, as they are not needed.

This Convert module then converts the TH AST back to hsSyn AST.

In order to pretty-print this hsSyn AST, parens need to be adde back at certain
points so that the code is readable with its original meaning.

So scattered through Convert.hs are various points where parens are added.

See (among other closed issued) https://ghc.haskell.org/trac/ghc/ticket/14289
-}</span><span>
</span><a name="line-1560"></a><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><a name="line-1561"></a><span>
</span><a name="line-1562"></a><span class="hs-comment">-- | Constructs an arrow type with a specified return type</span><span>
</span><a name="line-1563"></a><span class="hs-identifier">mk_arr_apps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><a name="mk_arr_apps"><a href="Convert.html#mk_arr_apps"><span class="hs-identifier">mk_arr_apps</span></a></a><span> </span><a name="local-6989586621679220072"><a href="#local-6989586621679220072"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621679220073"><a href="#local-6989586621679220073"><span class="hs-identifier">return_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldrM</span><span> </span><a href="#local-6989586621679220074"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220073"><span class="hs-identifier hs-var">return_ty</span></a><span> </span><a href="#local-6989586621679220072"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span>
</span><a name="line-1565"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1566"></a><span>          </span><a name="local-6989586621679220074"><a href="#local-6989586621679220074"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679220075"><a href="#local-6989586621679220075"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679220076"><a href="#local-6989586621679220076"><span class="hs-identifier">ret_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220077"><a href="#local-6989586621679220077"><span class="hs-identifier">ret_ty_l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><a href="#local-6989586621679220076"><span class="hs-identifier hs-var">ret_ty</span></a><span>
</span><a name="line-1567"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsFunTy</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220075"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-6989586621679220077"><span class="hs-identifier hs-var">ret_ty_l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1568"></a><span>
</span><a name="line-1569"></a><span class="hs-identifier">split_ty_app</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Type</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1570"></a><a name="split_ty_app"><a href="Convert.html#split_ty_app"><span class="hs-identifier">split_ty_app</span></a></a><span> </span><a name="local-6989586621679220078"><a href="#local-6989586621679220078"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220079"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220078"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1571"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1572"></a><span>    </span><a name="local-6989586621679220079"><a href="#local-6989586621679220079"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><a name="local-6989586621679220080"><a href="#local-6989586621679220080"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679220081"><a href="#local-6989586621679220081"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679220082"><a href="#local-6989586621679220082"><span class="hs-identifier">as'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220083"><a href="#local-6989586621679220083"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220081"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679220079"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220080"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a href="#local-6989586621679220083"><span class="hs-identifier hs-var">a'</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679220082"><span class="hs-identifier hs-var">as'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1573"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppKindT</span><span> </span><a name="local-6989586621679220084"><a href="#local-6989586621679220084"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679220085"><a href="#local-6989586621679220085"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679220086"><a href="#local-6989586621679220086"><span class="hs-identifier">as'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220087"><a href="#local-6989586621679220087"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><a href="#local-6989586621679220085"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1574"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621679220079"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220084"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span> </span><a href="#local-6989586621679220087"><span class="hs-identifier hs-var">ki'</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679220086"><span class="hs-identifier hs-var">as'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1575"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParensT</span><span> </span><a name="local-6989586621679220088"><a href="#local-6989586621679220088"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679220089"><a href="#local-6989586621679220089"><span class="hs-identifier">as'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220090"><a href="#local-6989586621679220090"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#getL"><span class="hs-identifier hs-var">getL</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679220079"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679220088"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><a href="#local-6989586621679220090"><span class="hs-identifier hs-var">loc</span></a><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679220089"><span class="hs-identifier hs-var">as'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1576"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679220091"><a href="#local-6989586621679220091"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220091"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-1577"></a><span>
</span><a name="line-1578"></a><span class="hs-identifier">cvtTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.TyLit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsTyLit</span><span>
</span><a name="line-1579"></a><a name="cvtTyLit"><a href="Convert.html#cvtTyLit"><span class="hs-identifier">cvtTyLit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.NumTyLit</span><span> </span><a name="local-6989586621679220093"><a href="#local-6989586621679220093"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsNumTy</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679220093"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1580"></a><span class="hs-identifier">cvtTyLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.StrTyLit</span><span> </span><a name="local-6989586621679220094"><a href="#local-6989586621679220094"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsStrTy</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621679220094"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span class="hs-comment">{- | @cvtOpAppT x op y@ converts @op@ and @y@ and produces the operator
application @x `op` y@. The produced tree of infix types will be right-biased,
provided @y@ is.

See the @cvtOpApp@ documentation for how this function works.
-}</span><span>
</span><a name="line-1588"></a><span class="hs-identifier">cvtOpAppT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1589"></a><a name="cvtOpAppT"><a href="Convert.html#cvtOpAppT"><span class="hs-identifier">cvtOpAppT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UInfixT</span><span> </span><a name="local-6989586621679220095"><a href="#local-6989586621679220095"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679220096"><a href="#local-6989586621679220096"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679220097"><a href="#local-6989586621679220097"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679220098"><a href="#local-6989586621679220098"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679220099"><a href="#local-6989586621679220099"><span class="hs-identifier">z</span></a></a><span>
</span><a name="line-1590"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220100"><a href="#local-6989586621679220100"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtOpAppT"><span class="hs-identifier hs-var">cvtOpAppT</span></a><span> </span><a href="#local-6989586621679220097"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679220098"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621679220099"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1591"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#cvtOpAppT"><span class="hs-identifier hs-var">cvtOpAppT</span></a><span> </span><a href="#local-6989586621679220095"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679220096"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621679220100"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1592"></a><span class="hs-identifier">cvtOpAppT</span><span> </span><a name="local-6989586621679220101"><a href="#local-6989586621679220101"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679220102"><a href="#local-6989586621679220102"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679220103"><a href="#local-6989586621679220103"><span class="hs-identifier">y</span></a></a><span>
</span><a name="line-1593"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220104"><a href="#local-6989586621679220104"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tconNameL"><span class="hs-identifier hs-var">tconNameL</span></a><span> </span><a href="#local-6989586621679220102"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1594"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220105"><a href="#local-6989586621679220105"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220101"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1595"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkHsOpTy</span><span> </span><a href="#local-6989586621679220105"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679220104"><span class="hs-identifier hs-var">op'</span></a><span> </span><a href="#local-6989586621679220103"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1596"></a><span>
</span><a name="line-1597"></a><span class="hs-identifier">cvtKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsKind</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1598"></a><a name="cvtKind"><a href="Convert.html#cvtKind"><span class="hs-identifier">cvtKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtTypeKind"><span class="hs-identifier hs-var">cvtTypeKind</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1599"></a><span>
</span><a name="line-1600"></a><span class="hs-comment">-- | Convert Maybe Kind to a type family result signature. Used with data</span><span>
</span><a name="line-1601"></a><span class="hs-comment">-- families where naming of the result is not possible (thus only kind or no</span><span>
</span><a name="line-1602"></a><span class="hs-comment">-- signature is possible).</span><span>
</span><a name="line-1603"></a><span class="hs-identifier">cvtMaybeKindToFamilyResultSig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.Kind</span><span>
</span><a name="line-1604"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1605"></a><a name="cvtMaybeKindToFamilyResultSig"><a href="Convert.html#cvtMaybeKindToFamilyResultSig"><span class="hs-identifier">cvtMaybeKindToFamilyResultSig</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.NoSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-1606"></a><span class="hs-identifier">cvtMaybeKindToFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220106"><a href="#local-6989586621679220106"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220107"><a href="#local-6989586621679220107"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><a href="#local-6989586621679220106"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1607"></a><span>                                             </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.KindSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220107"><span class="hs-identifier hs-var">ki'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1608"></a><span>
</span><a name="line-1609"></a><span class="hs-comment">-- | Convert type family result signature. Used with both open and closed type</span><span>
</span><a name="line-1610"></a><span class="hs-comment">-- families.</span><span>
</span><a name="line-1611"></a><span class="hs-identifier">cvtFamilyResultSig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSig</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LFamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1612"></a><a name="cvtFamilyResultSig"><a href="Convert.html#cvtFamilyResultSig"><span class="hs-identifier">cvtFamilyResultSig</span></a></a><span> </span><span class="hs-identifier hs-var">TH.NoSig</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.NoSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span class="hs-special">)</span><span>
</span><a name="line-1613"></a><span class="hs-identifier">cvtFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.KindSig</span><span> </span><a name="local-6989586621679220108"><a href="#local-6989586621679220108"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220109"><a href="#local-6989586621679220109"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtKind"><span class="hs-identifier hs-var">cvtKind</span></a><span> </span><a href="#local-6989586621679220108"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1614"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.KindSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>  </span><a href="#local-6989586621679220109"><span class="hs-identifier hs-var">ki'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1615"></a><span class="hs-identifier">cvtFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.TyVarSig</span><span> </span><a name="local-6989586621679220110"><a href="#local-6989586621679220110"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220111"><a href="#local-6989586621679220111"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvt_tv"><span class="hs-identifier hs-var">cvt_tv</span></a><span> </span><a href="#local-6989586621679220110"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-1616"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.TyVarSig</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621679220111"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1617"></a><span>
</span><a name="line-1618"></a><span class="hs-comment">-- | Convert injectivity annotation of a type family.</span><span>
</span><a name="line-1619"></a><span class="hs-identifier">cvtInjectivityAnnotation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.InjectivityAnn</span><span>
</span><a name="line-1620"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hs.LInjectivityAnn</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1621"></a><a name="cvtInjectivityAnnotation"><a href="Convert.html#cvtInjectivityAnnotation"><span class="hs-identifier">cvtInjectivityAnnotation</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.InjectivityAnn</span><span> </span><a name="local-6989586621679220112"><a href="#local-6989586621679220112"><span class="hs-identifier">annLHS</span></a></a><span> </span><a name="local-6989586621679220113"><a href="#local-6989586621679220113"><span class="hs-identifier">annRHS</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1622"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220114"><a href="#local-6989586621679220114"><span class="hs-identifier">annLHS'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679220112"><span class="hs-identifier hs-var">annLHS</span></a><span>
</span><a name="line-1623"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220115"><a href="#local-6989586621679220115"><span class="hs-identifier">annRHS'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Convert.html#tNameL"><span class="hs-identifier hs-var">tNameL</span></a><span> </span><a href="#local-6989586621679220113"><span class="hs-identifier hs-var">annRHS</span></a><span>
</span><a name="line-1624"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#returnL"><span class="hs-identifier hs-var">returnL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Hs.InjectivityAnn</span><span> </span><a href="#local-6989586621679220114"><span class="hs-identifier hs-var">annLHS'</span></a><span> </span><a href="#local-6989586621679220115"><span class="hs-identifier hs-var">annRHS'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1625"></a><span>
</span><a name="line-1626"></a><span class="hs-identifier">cvtPatSynSigTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span class="hs-comment">-- pattern synonym types are of peculiar shapes, which is why we treat</span><span>
</span><a name="line-1628"></a><span class="hs-comment">-- them separately from regular types;</span><span>
</span><a name="line-1629"></a><span class="hs-comment">-- see Note [Pattern synonym type signatures and Template Haskell]</span><span>
</span><a name="line-1630"></a><a name="cvtPatSynSigTy"><a href="Convert.html#cvtPatSynSigTy"><span class="hs-identifier">cvtPatSynSigTy</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a name="local-6989586621679220116"><a href="#local-6989586621679220116"><span class="hs-identifier">univs</span></a></a><span> </span><a name="local-6989586621679220117"><a href="#local-6989586621679220117"><span class="hs-identifier">reqs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a name="local-6989586621679220118"><a href="#local-6989586621679220118"><span class="hs-identifier">exis</span></a></a><span> </span><a name="local-6989586621679220119"><a href="#local-6989586621679220119"><span class="hs-identifier">provs</span></a></a><span> </span><a name="local-6989586621679220120"><a href="#local-6989586621679220120"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220118"><span class="hs-identifier hs-var">exis</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220119"><span class="hs-identifier hs-var">provs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679220116"><span class="hs-identifier hs-var">univs</span></a><span> </span><a href="#local-6989586621679220117"><span class="hs-identifier hs-var">reqs</span></a><span> </span><a href="#local-6989586621679220120"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1632"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220116"><span class="hs-identifier hs-var">univs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220117"><span class="hs-identifier hs-var">reqs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220121"><a href="#local-6989586621679220121"><span class="hs-identifier">l</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#getL"><span class="hs-identifier hs-var">getL</span></a><span>
</span><a name="line-1633"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220122"><a href="#local-6989586621679220122"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679220118"><span class="hs-identifier hs-var">exis</span></a><span> </span><a href="#local-6989586621679220119"><span class="hs-identifier hs-var">provs</span></a><span> </span><a href="#local-6989586621679220120"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1634"></a><span>                               </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220121"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQualTy</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220121"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1635"></a><span>                                                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xqual</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1636"></a><span>                                                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220122"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1637"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220117"><span class="hs-identifier hs-var">reqs</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220123"><a href="#local-6989586621679220123"><span class="hs-identifier">l</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#getL"><span class="hs-identifier hs-var">getL</span></a><span>
</span><a name="line-1638"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220124"><a href="#local-6989586621679220124"><span class="hs-identifier">univs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Convert.html#cvtTvs"><span class="hs-identifier hs-var">cvtTvs</span></a><span> </span><a href="#local-6989586621679220116"><span class="hs-identifier hs-var">univs</span></a><span>
</span><a name="line-1639"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679220125"><a href="#local-6989586621679220125"><span class="hs-identifier">ty'</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679220118"><span class="hs-identifier hs-var">exis</span></a><span> </span><a href="#local-6989586621679220119"><span class="hs-identifier hs-var">provs</span></a><span> </span><a href="#local-6989586621679220120"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><span>                               </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220126"><a href="#local-6989586621679220126"><span class="hs-identifier">forTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsForAllTy</span><span>
</span><a name="line-1641"></a><span>                                              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220124"><span class="hs-identifier hs-var">univs'</span></a><span>
</span><a name="line-1642"></a><span>                                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xforall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1643"></a><span>                                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220123"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679220127"><span class="hs-identifier hs-var">cxtTy</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1644"></a><span>                                     </span><a name="local-6989586621679220127"><a href="#local-6989586621679220127"><span class="hs-identifier">cxtTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQualTy</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220123"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1645"></a><span>                                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xqual</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1646"></a><span>                                                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220125"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1647"></a><span>                               </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220123"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679220126"><span class="hs-identifier hs-var">forTy</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1648"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679220116"><span class="hs-identifier hs-var">univs</span></a><span> </span><a href="#local-6989586621679220117"><span class="hs-identifier hs-var">reqs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><a href="#local-6989586621679220118"><span class="hs-identifier hs-var">exis</span></a><span> </span><a href="#local-6989586621679220119"><span class="hs-identifier hs-var">provs</span></a><span> </span><a href="#local-6989586621679220120"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span class="hs-identifier">cvtPatSynSigTy</span><span> </span><a name="local-6989586621679220128"><a href="#local-6989586621679220128"><span class="hs-identifier">ty</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtType"><span class="hs-identifier hs-var">cvtType</span></a><span> </span><a href="#local-6989586621679220128"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1650"></a><span>
</span><a name="line-1651"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1652"></a><span class="hs-identifier">cvtFixity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Hs.Fixity</span><span>
</span><a name="line-1653"></a><a name="cvtFixity"><a href="Convert.html#cvtFixity"><span class="hs-identifier">cvtFixity</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.Fixity</span><span> </span><a name="local-6989586621679220129"><a href="#local-6989586621679220129"><span class="hs-identifier">prec</span></a></a><span> </span><a name="local-6989586621679220130"><a href="#local-6989586621679220130"><span class="hs-identifier">dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.Fixity</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621679220129"><span class="hs-identifier hs-var">prec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679220131"><span class="hs-identifier hs-var">cvt_dir</span></a><span> </span><a href="#local-6989586621679220130"><span class="hs-identifier hs-var">dir</span></a><span class="hs-special">)</span><span>
</span><a name="line-1654"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1655"></a><span>     </span><a name="local-6989586621679220131"><a href="#local-6989586621679220131"><span class="hs-identifier">cvt_dir</span></a></a><span> </span><span class="hs-identifier hs-var">TH.InfixL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.InfixL</span><span>
</span><a name="line-1656"></a><span>     </span><span class="hs-identifier">cvt_dir</span><span> </span><span class="hs-identifier hs-var">TH.InfixR</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.InfixR</span><span>
</span><a name="line-1657"></a><span>     </span><span class="hs-identifier">cvt_dir</span><span> </span><span class="hs-identifier hs-var">TH.InfixN</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Hs.InfixN</span><span>
</span><a name="line-1658"></a><span>
</span><a name="line-1659"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1660"></a><span>
</span><a name="line-1661"></a><span>
</span><a name="line-1662"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1663"></a><span class="hs-comment">-- some useful things</span><span>
</span><a name="line-1664"></a><span>
</span><a name="line-1665"></a><span class="hs-identifier">overloadedLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1666"></a><span class="hs-comment">-- True for literals that Haskell treats as overloaded</span><span>
</span><a name="line-1667"></a><a name="overloadedLit"><a href="Convert.html#overloadedLit"><span class="hs-identifier">overloadedLit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IntegerL</span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1668"></a><span class="hs-identifier">overloadedLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RationalL</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1669"></a><span class="hs-identifier">overloadedLit</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1670"></a><span>
</span><a name="line-1671"></a><span class="hs-comment">-- Checks that are performed when converting unboxed sum expressions and</span><span>
</span><a name="line-1672"></a><span class="hs-comment">-- patterns alike.</span><span>
</span><a name="line-1673"></a><span class="hs-identifier">unboxedSumChecks</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.SumAlt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.SumArity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1674"></a><a name="unboxedSumChecks"><a href="Convert.html#unboxedSumChecks"><span class="hs-identifier">unboxedSumChecks</span></a></a><span> </span><a name="local-6989586621679220132"><a href="#local-6989586621679220132"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679220133"><a href="#local-6989586621679220133"><span class="hs-identifier">arity</span></a></a><span>
</span><a name="line-1675"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679220132"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679220133"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-1676"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Sum alternative&quot;</span><span>    </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679220132"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1677"></a><span>             </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;exceeds its arity,&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679220133"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1678"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679220132"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1679"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">vcat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal sum alternative:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679220132"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1680"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nest</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Sum alternatives must start from 1&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1681"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679220133"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1682"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">vcat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal sum arity:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679220133"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1683"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nest</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Sums must have an arity of at least 2&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1684"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1685"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1686"></a><span>
</span><a name="line-1687"></a><span class="hs-comment">-- | If passed an empty list of 'TH.TyVarBndr's, this simply returns the</span><span>
</span><a name="line-1688"></a><span class="hs-comment">-- third argument (an 'LHsType'). Otherwise, return an 'HsForAllTy'</span><span>
</span><a name="line-1689"></a><span class="hs-comment">-- using the provided 'LHsQTyVars' and 'LHsType'.</span><span>
</span><a name="line-1690"></a><span class="hs-identifier">mkHsForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndr</span><span class="hs-special">]</span><span>
</span><a name="line-1691"></a><span>             </span><span class="hs-comment">-- ^ The original Template Haskell type variable binders</span><span>
</span><a name="line-1692"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-1693"></a><span>             </span><span class="hs-comment">-- ^ The location of the returned 'LHsType' if it needs an</span><span>
</span><a name="line-1694"></a><span>             </span><span class="hs-comment">--   explicit forall</span><span>
</span><a name="line-1695"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1696"></a><span>             </span><span class="hs-comment">-- ^ The converted type variable binders</span><span>
</span><a name="line-1697"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1698"></a><span>             </span><span class="hs-comment">-- ^ The converted rho type</span><span>
</span><a name="line-1699"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1700"></a><span>             </span><span class="hs-comment">-- ^ The complete type, quantified with a forall if necessary</span><span>
</span><a name="line-1701"></a><a name="mkHsForAllTy"><a href="Convert.html#mkHsForAllTy"><span class="hs-identifier">mkHsForAllTy</span></a></a><span> </span><a name="local-6989586621679220134"><a href="#local-6989586621679220134"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679220135"><a href="#local-6989586621679220135"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679220136"><a href="#local-6989586621679220136"><span class="hs-identifier">tvs'</span></a></a><span> </span><a name="local-6989586621679220137"><a href="#local-6989586621679220137"><span class="hs-identifier">rho_ty</span></a></a><span>
</span><a name="line-1702"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220134"><span class="hs-identifier hs-var">tvs</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220137"><span class="hs-identifier hs-var">rho_ty</span></a><span>
</span><a name="line-1703"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220135"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsForAllTy</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621679220136"><span class="hs-identifier hs-var">tvs'</span></a><span>
</span><a name="line-1704"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xforall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1705"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220137"><span class="hs-identifier hs-var">rho_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1706"></a><span>
</span><a name="line-1707"></a><span class="hs-comment">-- | If passed an empty 'TH.Cxt', this simply returns the third argument</span><span>
</span><a name="line-1708"></a><span class="hs-comment">-- (an 'LHsType'). Otherwise, return an 'HsQualTy' using the provided</span><span>
</span><a name="line-1709"></a><span class="hs-comment">-- 'LHsContext' and 'LHsType'.</span><span>
</span><a name="line-1710"></a><span>
</span><a name="line-1711"></a><span class="hs-comment">-- It's important that we don't build an HsQualTy if the context is empty,</span><span>
</span><a name="line-1712"></a><span class="hs-comment">-- as the pretty-printer for HsType _always_ prints contexts, even if</span><span>
</span><a name="line-1713"></a><span class="hs-comment">-- they're empty. See Trac #13183.</span><span>
</span><a name="line-1714"></a><span class="hs-identifier">mkHsQualTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Cxt</span><span>
</span><a name="line-1715"></a><span>           </span><span class="hs-comment">-- ^ The original Template Haskell context</span><span>
</span><a name="line-1716"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-1717"></a><span>           </span><span class="hs-comment">-- ^ The location of the returned 'LHsType' if it needs an</span><span>
</span><a name="line-1718"></a><span>           </span><span class="hs-comment">--   explicit context</span><span>
</span><a name="line-1719"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1720"></a><span>           </span><span class="hs-comment">-- ^ The converted context</span><span>
</span><a name="line-1721"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1722"></a><span>           </span><span class="hs-comment">-- ^ The converted tau type</span><span>
</span><a name="line-1723"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcPs</span><span>
</span><a name="line-1724"></a><span>           </span><span class="hs-comment">-- ^ The complete type, qualified with a context if necessary</span><span>
</span><a name="line-1725"></a><a name="mkHsQualTy"><a href="Convert.html#mkHsQualTy"><span class="hs-identifier">mkHsQualTy</span></a></a><span> </span><a name="local-6989586621679220138"><a href="#local-6989586621679220138"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679220139"><a href="#local-6989586621679220139"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679220140"><a href="#local-6989586621679220140"><span class="hs-identifier">ctxt'</span></a></a><span> </span><a name="local-6989586621679220141"><a href="#local-6989586621679220141"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1726"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679220138"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220141"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1727"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621679220139"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsQualTy</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_xqual</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noExt</span><span>
</span><a name="line-1728"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_ctxt</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220140"><span class="hs-identifier hs-var">ctxt'</span></a><span>
</span><a name="line-1729"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679220141"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1730"></a><span>
</span><a name="line-1731"></a><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><a name="line-1732"></a><span class="hs-comment">--      Turning Name back into RdrName</span><span>
</span><a name="line-1733"></a><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><a name="line-1734"></a><span>
</span><a name="line-1735"></a><span class="hs-comment">-- variable names</span><span>
</span><a name="line-1736"></a><span class="hs-identifier">vNameL</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cNameL</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">vcNameL</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tNameL</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tconNameL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span class="hs-special">)</span><span>
</span><a name="line-1737"></a><span class="hs-identifier">vName</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">cName</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">vcName</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">tName</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">tconName</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-1738"></a><span>
</span><a name="line-1739"></a><span class="hs-comment">-- Variable names</span><span>
</span><a name="line-1740"></a><a name="vNameL"><a href="Convert.html#vNameL"><span class="hs-identifier">vNameL</span></a></a><span> </span><a name="local-6989586621679220142"><a href="#local-6989586621679220142"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#vName"><span class="hs-identifier hs-var">vName</span></a><span> </span><a href="#local-6989586621679220142"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1741"></a><a name="vName"><a href="Convert.html#vName"><span class="hs-identifier">vName</span></a></a><span> </span><a name="local-6989586621679220143"><a href="#local-6989586621679220143"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtName"><span class="hs-identifier hs-var">cvtName</span></a><span> </span><span class="hs-identifier hs-var">OccName.varName</span><span> </span><a href="#local-6989586621679220143"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1742"></a><span>
</span><a name="line-1743"></a><span class="hs-comment">-- Constructor function names; this is Haskell source, hence srcDataName</span><span>
</span><a name="line-1744"></a><a name="cNameL"><a href="Convert.html#cNameL"><span class="hs-identifier">cNameL</span></a></a><span> </span><a name="local-6989586621679220144"><a href="#local-6989586621679220144"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#cName"><span class="hs-identifier hs-var">cName</span></a><span> </span><a href="#local-6989586621679220144"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1745"></a><a name="cName"><a href="Convert.html#cName"><span class="hs-identifier">cName</span></a></a><span> </span><a name="local-6989586621679220145"><a href="#local-6989586621679220145"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtName"><span class="hs-identifier hs-var">cvtName</span></a><span> </span><span class="hs-identifier hs-var">OccName.dataName</span><span> </span><a href="#local-6989586621679220145"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1746"></a><span>
</span><a name="line-1747"></a><span class="hs-comment">-- Variable *or* constructor names; check by looking at the first char</span><span>
</span><a name="line-1748"></a><a name="vcNameL"><a href="Convert.html#vcNameL"><span class="hs-identifier">vcNameL</span></a></a><span> </span><a name="local-6989586621679220146"><a href="#local-6989586621679220146"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#vcName"><span class="hs-identifier hs-var">vcName</span></a><span> </span><a href="#local-6989586621679220146"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1749"></a><a name="vcName"><a href="Convert.html#vcName"><span class="hs-identifier">vcName</span></a></a><span> </span><a name="local-6989586621679220147"><a href="#local-6989586621679220147"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Convert.html#isVarName"><span class="hs-identifier hs-var">isVarName</span></a><span> </span><a href="#local-6989586621679220147"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Convert.html#vName"><span class="hs-identifier hs-var">vName</span></a><span> </span><a href="#local-6989586621679220147"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Convert.html#cName"><span class="hs-identifier hs-var">cName</span></a><span> </span><a href="#local-6989586621679220147"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span class="hs-comment">-- Type variable names</span><span>
</span><a name="line-1752"></a><a name="tNameL"><a href="Convert.html#tNameL"><span class="hs-identifier">tNameL</span></a></a><span> </span><a name="local-6989586621679220148"><a href="#local-6989586621679220148"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#tName"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679220148"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1753"></a><a name="tName"><a href="Convert.html#tName"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679220149"><a href="#local-6989586621679220149"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtName"><span class="hs-identifier hs-var">cvtName</span></a><span> </span><span class="hs-identifier hs-var">OccName.tvName</span><span> </span><a href="#local-6989586621679220149"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1754"></a><span>
</span><a name="line-1755"></a><span class="hs-comment">-- Type Constructor names</span><span>
</span><a name="line-1756"></a><a name="tconNameL"><a href="Convert.html#tconNameL"><span class="hs-identifier">tconNameL</span></a></a><span> </span><a name="local-6989586621679220150"><a href="#local-6989586621679220150"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#wrapL"><span class="hs-identifier hs-var">wrapL</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#tconName"><span class="hs-identifier hs-var">tconName</span></a><span> </span><a href="#local-6989586621679220150"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1757"></a><a name="tconName"><a href="Convert.html#tconName"><span class="hs-identifier">tconName</span></a></a><span> </span><a name="local-6989586621679220151"><a href="#local-6989586621679220151"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#cvtName"><span class="hs-identifier hs-var">cvtName</span></a><span> </span><span class="hs-identifier hs-var">OccName.tcClsName</span><span> </span><a href="#local-6989586621679220151"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1758"></a><span>
</span><a name="line-1759"></a><span class="hs-identifier">ipName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-identifier hs-type">HsIPName</span><span>
</span><a name="line-1760"></a><a name="ipName"><a href="Convert.html#ipName"><span class="hs-identifier">ipName</span></a></a><span> </span><a name="local-6989586621679220152"><a href="#local-6989586621679220152"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1761"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">okVarOcc</span><span> </span><a href="#local-6989586621679220152"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#badOcc"><span class="hs-identifier hs-var">badOcc</span></a><span> </span><span class="hs-identifier hs-var">OccName.varName</span><span> </span><a href="#local-6989586621679220152"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1762"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621679220152"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1763"></a><span>
</span><a name="line-1764"></a><span class="hs-identifier">cvtName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#CvtM"><span class="hs-identifier hs-type">CvtM</span></a><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-1765"></a><a name="cvtName"><a href="Convert.html#cvtName"><span class="hs-identifier">cvtName</span></a></a><span> </span><a name="local-6989586621679220153"><a href="#local-6989586621679220153"><span class="hs-identifier">ctxt_ns</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.Name</span><span> </span><a name="local-6989586621679220154"><a href="#local-6989586621679220154"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621679220155"><a href="#local-6989586621679220155"><span class="hs-identifier">flavour</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1766"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Convert.html#okOcc"><span class="hs-identifier hs-var">okOcc</span></a><span> </span><a href="#local-6989586621679220153"><span class="hs-identifier hs-var">ctxt_ns</span></a><span> </span><a href="#local-6989586621679220156"><span class="hs-identifier hs-var">occ_str</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#badOcc"><span class="hs-identifier hs-var">badOcc</span></a><span> </span><a href="#local-6989586621679220153"><span class="hs-identifier hs-var">ctxt_ns</span></a><span> </span><a href="#local-6989586621679220156"><span class="hs-identifier hs-var">occ_str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1767"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1768"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679220157"><a href="#local-6989586621679220157"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Convert.html#getL"><span class="hs-identifier hs-var">getL</span></a><span>
</span><a name="line-1769"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220158"><a href="#local-6989586621679220158"><span class="hs-identifier">rdr_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#thRdrName"><span class="hs-identifier hs-var">thRdrName</span></a><span> </span><a href="#local-6989586621679220157"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621679220153"><span class="hs-identifier hs-var">ctxt_ns</span></a><span> </span><a href="#local-6989586621679220156"><span class="hs-identifier hs-var">occ_str</span></a><span> </span><a href="#local-6989586621679220155"><span class="hs-identifier hs-var">flavour</span></a><span>
</span><a name="line-1770"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Convert.html#force"><span class="hs-identifier hs-var">force</span></a><span> </span><a href="#local-6989586621679220158"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-1771"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679220158"><span class="hs-identifier hs-var">rdr_name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1772"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1773"></a><span>    </span><a name="local-6989586621679220156"><a href="#local-6989586621679220156"><span class="hs-identifier">occ_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TH.occString</span><span> </span><a href="#local-6989586621679220154"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1774"></a><span>
</span><a name="line-1775"></a><span class="hs-identifier">okOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1776"></a><a name="okOcc"><a href="Convert.html#okOcc"><span class="hs-identifier">okOcc</span></a></a><span> </span><a name="local-6989586621679220159"><a href="#local-6989586621679220159"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679220160"><a href="#local-6989586621679220160"><span class="hs-identifier">str</span></a></a><span>
</span><a name="line-1777"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">OccName.isVarNameSpace</span><span> </span><a href="#local-6989586621679220159"><span class="hs-identifier hs-var">ns</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">okVarOcc</span><span> </span><a href="#local-6989586621679220160"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-1778"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">OccName.isDataConNameSpace</span><span> </span><a href="#local-6989586621679220159"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">okConOcc</span><span> </span><a href="#local-6989586621679220160"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-1779"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">okTcOcc</span><span>  </span><a href="#local-6989586621679220160"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-1780"></a><span>
</span><a name="line-1781"></a><span class="hs-comment">-- Determine the name space of a name in a type</span><span>
</span><a name="line-1782"></a><span class="hs-comment">--</span><span>
</span><a name="line-1783"></a><span class="hs-identifier">isVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1784"></a><a name="isVarName"><a href="Convert.html#isVarName"><span class="hs-identifier">isVarName</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.Name</span><span> </span><a name="local-6989586621679220161"><a href="#local-6989586621679220161"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1785"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">TH.occString</span><span> </span><a href="#local-6989586621679220161"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1786"></a><span>      </span><span class="hs-string">&quot;&quot;</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1787"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679220162"><a href="#local-6989586621679220162"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">startsVarId</span><span> </span><a href="#local-6989586621679220162"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">startsVarSym</span><span> </span><a href="#local-6989586621679220162"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1788"></a><span>
</span><a name="line-1789"></a><span class="hs-identifier">badOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SDoc</span><span>
</span><a name="line-1790"></a><a name="badOcc"><a href="Convert.html#badOcc"><span class="hs-identifier">badOcc</span></a></a><span> </span><a name="local-6989586621679220187"><a href="#local-6989586621679220187"><span class="hs-identifier">ctxt_ns</span></a></a><span> </span><a name="local-6989586621679220188"><a href="#local-6989586621679220188"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-1791"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Illegal&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">pprNameSpace</span><span> </span><a href="#local-6989586621679220187"><span class="hs-identifier hs-var">ctxt_ns</span></a><span>
</span><a name="line-1792"></a><span>        </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;name:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">quotes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><a href="#local-6989586621679220188"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1793"></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">thRdrName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.NameFlavour</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-1795"></a><span class="hs-comment">-- This turns a TH Name into a RdrName; used for both binders and occurrences</span><span>
</span><a name="line-1796"></a><span class="hs-comment">-- See Note [Binders in Template Haskell]</span><span>
</span><a name="line-1797"></a><span class="hs-comment">-- The passed-in name space tells what the context is expecting;</span><span>
</span><a name="line-1798"></a><span class="hs-comment">--      use it unless the TH name knows what name-space it comes</span><span>
</span><a name="line-1799"></a><span class="hs-comment">--      from, in which case use the latter</span><span>
</span><a name="line-1800"></a><span class="hs-comment">--</span><span>
</span><a name="line-1801"></a><span class="hs-comment">-- We pass in a SrcSpan (gotten from the monad) because this function</span><span>
</span><a name="line-1802"></a><span class="hs-comment">-- is used for *binders* and if we make an Exact Name we want it</span><span>
</span><a name="line-1803"></a><span class="hs-comment">-- to have a binding site inside it.  (cf Trac #5434)</span><span>
</span><a name="line-1804"></a><span class="hs-comment">--</span><span>
</span><a name="line-1805"></a><span class="hs-comment">-- ToDo: we may generate silly RdrNames, by passing a name space</span><span>
</span><a name="line-1806"></a><span class="hs-comment">--       that doesn't match the string, like VarName &quot;:+&quot;,</span><span>
</span><a name="line-1807"></a><span class="hs-comment">--       which will give confusing error messages later</span><span>
</span><a name="line-1808"></a><span class="hs-comment">--</span><span>
</span><a name="line-1809"></a><span class="hs-comment">-- The strict applications ensure that any buried exceptions get forced</span><span>
</span><a name="line-1810"></a><a name="thRdrName"><a href="Convert.html#thRdrName"><span class="hs-identifier">thRdrName</span></a></a><span> </span><a name="local-6989586621679220189"><a href="#local-6989586621679220189"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679220190"><a href="#local-6989586621679220190"><span class="hs-identifier">ctxt_ns</span></a></a><span> </span><a name="local-6989586621679220191"><a href="#local-6989586621679220191"><span class="hs-identifier">th_occ</span></a></a><span> </span><a name="local-6989586621679220192"><a href="#local-6989586621679220192"><span class="hs-identifier">th_name</span></a></a><span>
</span><a name="line-1811"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679220192"><span class="hs-identifier hs-var">th_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1812"></a><span>     </span><span class="hs-identifier hs-var">TH.NameG</span><span> </span><a name="local-6989586621679220194"><a href="#local-6989586621679220194"><span class="hs-identifier">th_ns</span></a></a><span> </span><a name="local-6989586621679220195"><a href="#local-6989586621679220195"><span class="hs-identifier">pkg</span></a></a><span> </span><a name="local-6989586621679220196"><a href="#local-6989586621679220196"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Convert.html#thOrigRdrName"><span class="hs-identifier hs-var">thOrigRdrName</span></a><span> </span><a href="#local-6989586621679220191"><span class="hs-identifier hs-var">th_occ</span></a><span> </span><a href="#local-6989586621679220194"><span class="hs-identifier hs-var">th_ns</span></a><span> </span><a href="#local-6989586621679220195"><span class="hs-identifier hs-var">pkg</span></a><span> </span><a href="#local-6989586621679220196"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-1813"></a><span>     </span><span class="hs-identifier hs-var">TH.NameQ</span><span> </span><a name="local-6989586621679220197"><a href="#local-6989586621679220197"><span class="hs-identifier">mod</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRdrQual</span><span>  </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Convert.html#mk_mod"><span class="hs-identifier hs-var">mk_mod</span></a><span> </span><a href="#local-6989586621679220197"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1814"></a><span>     </span><span class="hs-identifier hs-var">TH.NameL</span><span> </span><a name="local-6989586621679220198"><a href="#local-6989586621679220198"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">nameRdrName</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Name.mkInternalName</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Convert.html#mk_uniq"><span class="hs-identifier hs-var">mk_uniq</span></a><span> </span><a href="#local-6989586621679220198"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220189"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1815"></a><span>     </span><span class="hs-identifier hs-var">TH.NameU</span><span> </span><a name="local-6989586621679220199"><a href="#local-6989586621679220199"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">nameRdrName</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Name.mkSystemNameAt</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Convert.html#mk_uniq"><span class="hs-identifier hs-var">mk_uniq</span></a><span> </span><a href="#local-6989586621679220199"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220189"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1816"></a><span>     </span><span class="hs-identifier hs-var">TH.NameS</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220200"><a href="#local-6989586621679220200"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isBuiltInOcc_maybe</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">nameRdrName</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220200"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1817"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkRdrUnqual</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220193"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1818"></a><span>              </span><span class="hs-comment">-- We check for built-in syntax here, because the TH</span><span>
</span><a name="line-1819"></a><span>              </span><span class="hs-comment">-- user might have written a (NameS &quot;(,,)&quot;), for example</span><span>
</span><a name="line-1820"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1821"></a><span>    </span><span class="hs-identifier">occ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName.OccName</span><span>
</span><a name="line-1822"></a><span>    </span><a name="local-6989586621679220193"><a href="#local-6989586621679220193"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mk_occ"><span class="hs-identifier hs-var">mk_occ</span></a><span> </span><a href="#local-6989586621679220190"><span class="hs-identifier hs-var">ctxt_ns</span></a><span> </span><a href="#local-6989586621679220191"><span class="hs-identifier hs-var">th_occ</span></a><span>
</span><a name="line-1823"></a><span>
</span><a name="line-1824"></a><span class="hs-comment">-- Return an unqualified exact RdrName if we're dealing with built-in syntax.</span><span>
</span><a name="line-1825"></a><span class="hs-comment">-- See Trac #13776.</span><span>
</span><a name="line-1826"></a><span class="hs-identifier">thOrigRdrName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PkgName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ModName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">RdrName</span><span>
</span><a name="line-1827"></a><a name="thOrigRdrName"><a href="Convert.html#thOrigRdrName"><span class="hs-identifier">thOrigRdrName</span></a></a><span> </span><a name="local-6989586621679220201"><a href="#local-6989586621679220201"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621679220202"><a href="#local-6989586621679220202"><span class="hs-identifier">th_ns</span></a></a><span> </span><a name="local-6989586621679220203"><a href="#local-6989586621679220203"><span class="hs-identifier">pkg</span></a></a><span> </span><a name="local-6989586621679220204"><a href="#local-6989586621679220204"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1828"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679220205"><a href="#local-6989586621679220205"><span class="hs-identifier">occ'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Convert.html#mk_occ"><span class="hs-identifier hs-var">mk_occ</span></a><span> </span><span class="hs-special">(</span><a href="Convert.html#mk_ghc_ns"><span class="hs-identifier hs-var">mk_ghc_ns</span></a><span> </span><a href="#local-6989586621679220202"><span class="hs-identifier hs-var">th_ns</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679220201"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1829"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">isBuiltInOcc_maybe</span><span> </span><a href="#local-6989586621679220205"><span class="hs-identifier hs-var">occ'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1830"></a><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679220206"><a href="#local-6989586621679220206"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">nameRdrName</span><span> </span><a href="#local-6989586621679220206"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1831"></a><span>       </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkOrig</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkModule</span><span> </span><span class="hs-special">(</span><a href="Convert.html#mk_pkg"><span class="hs-identifier hs-var">mk_pkg</span></a><span> </span><a href="#local-6989586621679220203"><span class="hs-identifier hs-var">pkg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Convert.html#mk_mod"><span class="hs-identifier hs-var">mk_mod</span></a><span> </span><a href="#local-6989586621679220204"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679220205"><span class="hs-identifier hs-var">occ'</span></a><span>
</span><a name="line-1832"></a><span>
</span><a name="line-1833"></a><span class="hs-identifier">thRdrNameGuesses</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">RdrName</span><span class="hs-special">]</span><span>
</span><a name="line-1834"></a><a name="thRdrNameGuesses"><a href="Convert.html#thRdrNameGuesses"><span class="hs-identifier">thRdrNameGuesses</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.Name</span><span> </span><a name="local-6989586621679220207"><a href="#local-6989586621679220207"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621679220208"><a href="#local-6989586621679220208"><span class="hs-identifier">flavour</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1835"></a><span>  </span><span class="hs-comment">-- This special case for NameG ensures that we don't generate duplicates in the output list</span><span>
</span><a name="line-1836"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TH.NameG</span><span> </span><a name="local-6989586621679220211"><a href="#local-6989586621679220211"><span class="hs-identifier">th_ns</span></a></a><span> </span><a name="local-6989586621679220212"><a href="#local-6989586621679220212"><span class="hs-identifier">pkg</span></a></a><span> </span><a name="local-6989586621679220213"><a href="#local-6989586621679220213"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220208"><span class="hs-identifier hs-var">flavour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Convert.html#thOrigRdrName"><span class="hs-identifier hs-var">thOrigRdrName</span></a><span> </span><a href="#local-6989586621679220210"><span class="hs-identifier hs-var">occ_str</span></a><span> </span><a href="#local-6989586621679220211"><span class="hs-identifier hs-var">th_ns</span></a><span> </span><a href="#local-6989586621679220212"><span class="hs-identifier hs-var">pkg</span></a><span> </span><a href="#local-6989586621679220213"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">]</span><span>
</span><a name="line-1837"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Convert.html#thRdrName"><span class="hs-identifier hs-var">thRdrName</span></a><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span> </span><a href="#local-6989586621679220214"><span class="hs-identifier hs-var">gns</span></a><span> </span><a href="#local-6989586621679220210"><span class="hs-identifier hs-var">occ_str</span></a><span> </span><a href="#local-6989586621679220208"><span class="hs-identifier hs-var">flavour</span></a><span>
</span><a name="line-1838"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679220214"><a href="#local-6989586621679220214"><span class="hs-identifier">gns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679220209"><span class="hs-identifier hs-var">guessed_nss</span></a><span class="hs-special">]</span><span>
</span><a name="line-1839"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1840"></a><span>    </span><span class="hs-comment">-- guessed_ns are the name spaces guessed from looking at the TH name</span><span>
</span><a name="line-1841"></a><span>    </span><a name="local-6989586621679220209"><a href="#local-6989586621679220209"><span class="hs-identifier">guessed_nss</span></a></a><span>
</span><a name="line-1842"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isLexCon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><a href="#local-6989586621679220210"><span class="hs-identifier hs-var">occ_str</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">OccName.tcName</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">OccName.dataName</span><span class="hs-special">]</span><span>
</span><a name="line-1843"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">OccName.varName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">OccName.tvName</span><span class="hs-special">]</span><span>
</span><a name="line-1844"></a><span>    </span><a name="local-6989586621679220210"><a href="#local-6989586621679220210"><span class="hs-identifier">occ_str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TH.occString</span><span> </span><a href="#local-6989586621679220207"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1845"></a><span>
</span><a name="line-1846"></a><span class="hs-comment">-- The packing and unpacking is rather turgid :-(</span><span>
</span><a name="line-1847"></a><span class="hs-identifier">mk_occ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">OccName.OccName</span><span>
</span><a name="line-1848"></a><a name="mk_occ"><a href="Convert.html#mk_occ"><span class="hs-identifier">mk_occ</span></a></a><span> </span><a name="local-6989586621679220215"><a href="#local-6989586621679220215"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679220216"><a href="#local-6989586621679220216"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">OccName.mkOccName</span><span> </span><a href="#local-6989586621679220215"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679220216"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1849"></a><span>
</span><a name="line-1850"></a><span class="hs-identifier">mk_ghc_ns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.NameSpace</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">OccName.NameSpace</span><span>
</span><a name="line-1851"></a><a name="mk_ghc_ns"><a href="Convert.html#mk_ghc_ns"><span class="hs-identifier">mk_ghc_ns</span></a></a><span> </span><span class="hs-identifier hs-var">TH.DataName</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">OccName.dataName</span><span>
</span><a name="line-1852"></a><span class="hs-identifier">mk_ghc_ns</span><span> </span><span class="hs-identifier hs-var">TH.TcClsName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">OccName.tcClsName</span><span>
</span><a name="line-1853"></a><span class="hs-identifier">mk_ghc_ns</span><span> </span><span class="hs-identifier hs-var">TH.VarName</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">OccName.varName</span><span>
</span><a name="line-1854"></a><span>
</span><a name="line-1855"></a><span class="hs-identifier">mk_mod</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.ModName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ModuleName</span><span>
</span><a name="line-1856"></a><a name="mk_mod"><a href="Convert.html#mk_mod"><span class="hs-identifier">mk_mod</span></a></a><span> </span><a name="local-6989586621679220217"><a href="#local-6989586621679220217"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkModuleName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.modString</span><span> </span><a href="#local-6989586621679220217"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span class="hs-identifier">mk_pkg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.PkgName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">UnitId</span><span>
</span><a name="line-1859"></a><a name="mk_pkg"><a href="Convert.html#mk_pkg"><span class="hs-identifier">mk_pkg</span></a></a><span> </span><a name="local-6989586621679220218"><a href="#local-6989586621679220218"><span class="hs-identifier">pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">stringToUnitId</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TH.pkgString</span><span> </span><a href="#local-6989586621679220218"><span class="hs-identifier hs-var">pkg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1860"></a><span>
</span><a name="line-1861"></a><span class="hs-identifier">mk_uniq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Unique</span><span>
</span><a name="line-1862"></a><a name="mk_uniq"><a href="Convert.html#mk_uniq"><span class="hs-identifier">mk_uniq</span></a></a><span> </span><a name="local-6989586621679220219"><a href="#local-6989586621679220219"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkUniqueGrimily</span><span> </span><a href="#local-6989586621679220219"><span class="hs-identifier hs-var">u</span></a><span>
</span><a name="line-1863"></a><span>
</span><a name="line-1864"></a><span class="hs-comment">{-
Note [Binders in Template Haskell]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider this TH term construction:
  do { x1 &lt;- TH.newName &quot;x&quot;   -- newName :: String -&gt; Q TH.Name
     ; x2 &lt;- TH.newName &quot;x&quot;   -- Builds a NameU
     ; x3 &lt;- TH.newName &quot;x&quot;

     ; let x = mkName &quot;x&quot;     -- mkName :: String -&gt; TH.Name
                              -- Builds a NameS

     ; return (LamE (..pattern [x1,x2]..) $
               LamE (VarPat x3) $
               ..tuple (x1,x2,x3,x)) }

It represents the term   \[x1,x2]. \x3. (x1,x2,x3,x)

a) We don't want to complain about &quot;x&quot; being bound twice in
   the pattern [x1,x2]
b) We don't want x3 to shadow the x1,x2
c) We *do* want 'x' (dynamically bound with mkName) to bind
   to the innermost binding of &quot;x&quot;, namely x3.
d) When pretty printing, we want to print a unique with x1,x2
   etc, else they'll all print as &quot;x&quot; which isn't very helpful

When we convert all this to HsSyn, the TH.Names are converted with
thRdrName.  To achieve (b) we want the binders to be Exact RdrNames.
Achieving (a) is a bit awkward, because
   - We must check for duplicate and shadowed names on Names,
     not RdrNames, *after* renaming.
     See Note [Collect binders only after renaming] in HsUtils

   - But to achieve (a) we must distinguish between the Exact
     RdrNames arising from TH and the Unqual RdrNames that would
     come from a user writing \[x,x] -&gt; blah

So in Convert.thRdrName we translate
   TH Name                          RdrName
   --------------------------------------------------------
   NameU (arising from newName) --&gt; Exact (Name{ System })
   NameS (arising from mkName)  --&gt; Unqual

Notice that the NameUs generate *System* Names.  Then, when
figuring out shadowing and duplicates, we can filter out
System Names.

This use of System Names fits with other uses of System Names, eg for
temporary variables &quot;a&quot;. Since there are lots of things called &quot;a&quot; we
usually want to print the name with the unique, and that is indeed
the way System Names are printed.

There's a small complication of course; see Note [Looking up Exact
RdrNames] in RnEnv.
-}</span><span>
</span><a name="line-1918"></a><span>
</span><a name="line-1919"></a><span class="hs-comment">{-
Note [Pattern synonym type signatures and Template Haskell]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In general, the type signature of a pattern synonym

  pattern P x1 x2 .. xn = &lt;some-pattern&gt;

is of the form

   forall univs. reqs =&gt; forall exis. provs =&gt; t1 -&gt; t2 -&gt; ... -&gt; tn -&gt; t

with the following parts:

   1) the (possibly empty lists of) universally quantified type
      variables `univs` and required constraints `reqs` on them.
   2) the (possibly empty lists of) existentially quantified type
      variables `exis` and the provided constraints `provs` on them.
   3) the types `t1`, `t2`, .., `tn` of the pattern synonym's arguments x1,
      x2, .., xn, respectively
   4) the type `t` of &lt;some-pattern&gt;, mentioning only universals from `univs`.

Due to the two forall quantifiers and constraint contexts (either of
which might be empty), pattern synonym type signatures are treated
specially in `deSugar/DsMeta.hs`, `hsSyn/Convert.hs`, and
`typecheck/TcSplice.hs`:

   (a) When desugaring a pattern synonym from HsSyn to TH.Dec in
       `deSugar/DsMeta.hs`, we represent its *full* type signature in TH, i.e.:

           ForallT univs reqs (ForallT exis provs ty)
              (where ty is the AST representation of t1 -&gt; t2 -&gt; ... -&gt; tn -&gt; t)

   (b) When converting pattern synonyms from TH.Dec to HsSyn in
       `hsSyn/Convert.hs`, we convert their TH type signatures back to an
       appropriate Haskell pattern synonym type of the form

         forall univs. reqs =&gt; forall exis. provs =&gt; t1 -&gt; t2 -&gt; ... -&gt; tn -&gt; t

       where initial empty `univs` type variables or an empty `reqs`
       constraint context are represented *explicitly* as `() =&gt;`.

   (c) When reifying a pattern synonym in `typecheck/TcSplice.hs`, we always
       return its *full* type, i.e.:

           ForallT univs reqs (ForallT exis provs ty)
              (where ty is the AST representation of t1 -&gt; t2 -&gt; ... -&gt; tn -&gt; t)

The key point is to always represent a pattern synonym's *full* type
in cases (a) and (c) to make it clear which of the two forall
quantifiers and/or constraint contexts are specified, and which are
not. See GHC's user's guide on pattern synonyms for more information
about pattern synonym type signatures.

-}</span><span>
</span><a name="line-1974"></a></pre></body></html>