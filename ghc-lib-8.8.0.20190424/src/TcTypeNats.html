<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcTypeNats</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="TcTypeNats.html#typeNatTyCons"><span class="hs-identifier hs-var">typeNatTyCons</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatCoAxiomRules"><span class="hs-identifier hs-var">typeNatCoAxiomRules</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">BuiltInSynFamily</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span>    </span><span class="hs-comment">-- If you define a new built-in type family, make sure to export its TyCon</span><span>
</span><a name="line-9"></a><span>    </span><span class="hs-comment">-- from here as well.</span><span>
</span><a name="line-10"></a><span>    </span><span class="hs-comment">-- See Note [Adding built-in type families]</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier hs-var">typeNatAddTyCon</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier hs-var">typeNatMulTyCon</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier hs-var">typeNatExpTyCon</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier hs-var">typeNatLeqTyCon</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier hs-var">typeNatSubTyCon</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier hs-var">typeNatDivTyCon</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier hs-var">typeNatModTyCon</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatLogTyCon"><span class="hs-identifier hs-var">typeNatLogTyCon</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier hs-var">typeNatCmpTyCon</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier hs-var">typeSymbolCmpTyCon</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier hs-var">typeSymbolAppendTyCon</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Pair</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcType</span><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">TcType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCon</span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FamTyConFlav</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span>
</span><a name="line-30"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Injectivity</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Coercion</span><span>   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Role</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoAxiom</span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">BuiltInSynFamily</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TypeEqn</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Name</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">BuiltInSyntax</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysPrim</span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">PrelNames</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">gHC_TYPELITS</span><span>
</span><a name="line-38"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span>
</span><a name="line-39"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatAddTyFamNameKey</span><span>
</span><a name="line-40"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatMulTyFamNameKey</span><span>
</span><a name="line-41"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatExpTyFamNameKey</span><span>
</span><a name="line-42"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatLeqTyFamNameKey</span><span>
</span><a name="line-43"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatSubTyFamNameKey</span><span>
</span><a name="line-44"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatDivTyFamNameKey</span><span>
</span><a name="line-45"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatModTyFamNameKey</span><span>
</span><a name="line-46"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatLogTyFamNameKey</span><span>
</span><a name="line-47"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatCmpTyFamNameKey</span><span>
</span><a name="line-48"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeSymbolCmpTyFamNameKey</span><span>
</span><a name="line-49"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeSymbolAppendFamNameKey</span><span>
</span><a name="line-50"></a><span>                  </span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FastString</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">FastString</span><span>
</span><a name="line-52"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nilFS</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nullFS</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkFastString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">appendFS</span><span>
</span><a name="line-53"></a><span>                  </span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isSuffixOf</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">{-
Note [Type-level literals]
~~~~~~~~~~~~~~~~~~~~~~~~~~
There are currently two forms of type-level literals: natural numbers, and
symbols (even though this module is named TcTypeNats, it covers both).

Type-level literals are supported by CoAxiomRules (conditional axioms), which
power the built-in type families (see Note [Adding built-in type families]).
Currently, all built-in type families are for the express purpose of supporting
type-level literals.

See also the Wiki page:

    https://ghc.haskell.org/trac/ghc/wiki/TypeNats

Note [Adding built-in type families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There are a few steps to adding a built-in type family:

* Adding a unique for the type family TyCon

  These go in PrelNames. It will likely be of the form
  @myTyFamNameKey = mkPreludeTyConUnique xyz@, where @xyz@ is a number that
  has not been chosen before in PrelNames. There are several examples already
  in PrelNames&#8212;see, for instance, typeNatAddTyFamNameKey.

* Adding the type family TyCon itself

  This goes in TcTypeNats. There are plenty of examples of how to define
  these&#8212;see, for instance, typeNatAddTyCon.

  Once your TyCon has been defined, be sure to:

  - Export it from TcTypeNats. (Not doing so caused #14632.)
  - Include it in the typeNatTyCons list, defined in TcTypeNats.

* Exposing associated type family axioms

  When defining the type family TyCon, you will need to define an axiom for
  the type family in general (see, for instance, axAddDef), and perhaps other
  auxiliary axioms for special cases of the type family (see, for instance,
  axAdd0L and axAdd0R).

  After you have defined all of these axioms, be sure to include them in the
  typeNatCoAxiomRules list, defined in TcTypeNats.
  (Not doing so caused #14934.)

* Define the type family somewhere

  Finally, you will need to define the type family somewhere, likely in @base@.
  Currently, all of the built-in type families are defined in GHC.TypeLits or
  GHC.TypeNats, so those are likely candidates.

  Since the behavior of your built-in type family is specified in TcTypeNats,
  you should give an open type family definition with no instances, like so:

    type family MyTypeFam (m :: Nat) (n :: Nat) :: Nat

  Changing the argument and result kinds as appropriate.

* Update the relevant test cases

  The GHC test suite will likely need to be updated after you add your built-in
  type family. For instance:

  - The T9181 test prints the :browse contents of GHC.TypeLits, so if you added
    a test there, the expected output of T9181 will need to change.
  - The TcTypeNatSimple and TcTypeSymbolSimple tests have compile-time unit
    tests, as well as TcTypeNatSimpleRun and TcTypeSymbolSimpleRun, which have
    runtime unit tests. Consider adding further unit tests to those if your
    built-in type family deals with Nats or Symbols, respectively.
-}</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Built-in type constructors for functions on type-level nats
-}</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- The list of built-in type family TyCons that GHC uses.</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- If you define a built-in type family, make sure to add it to this list.</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- See Note [Adding built-in type families]</span><span>
</span><a name="line-139"></a><span class="hs-identifier">typeNatTyCons</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyCon</span><span class="hs-special">]</span><span>
</span><a name="line-140"></a><a name="typeNatTyCons"><a href="TcTypeNats.html#typeNatTyCons"><span class="hs-identifier">typeNatTyCons</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier hs-var">typeNatAddTyCon</span></a><span>
</span><a name="line-142"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier hs-var">typeNatMulTyCon</span></a><span>
</span><a name="line-143"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier hs-var">typeNatExpTyCon</span></a><span>
</span><a name="line-144"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier hs-var">typeNatLeqTyCon</span></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier hs-var">typeNatSubTyCon</span></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier hs-var">typeNatDivTyCon</span></a><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier hs-var">typeNatModTyCon</span></a><span>
</span><a name="line-148"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatLogTyCon"><span class="hs-identifier hs-var">typeNatLogTyCon</span></a><span>
</span><a name="line-149"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier hs-var">typeNatCmpTyCon</span></a><span>
</span><a name="line-150"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier hs-var">typeSymbolCmpTyCon</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier hs-var">typeSymbolAppendTyCon</span></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-identifier">typeNatAddTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-155"></a><a name="typeNatAddTyCon"><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier">typeNatAddTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484105"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-156"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamAdd"><span class="hs-identifier hs-var">matchFamAdd</span></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopAdd"><span class="hs-identifier hs-var">interactTopAdd</span></a><span>
</span><a name="line-159"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertAdd"><span class="hs-identifier hs-var">interactInertAdd</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-162"></a><span>  </span><a name="local-6989586621681484105"><a href="#local-6989586621681484105"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>            </span><span class="hs-identifier hs-var">typeNatAddTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier hs-var">typeNatAddTyCon</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-identifier">typeNatSubTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-166"></a><a name="typeNatSubTyCon"><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier">typeNatSubTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484106"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamSub"><span class="hs-identifier hs-var">matchFamSub</span></a><span>
</span><a name="line-169"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopSub"><span class="hs-identifier hs-var">interactTopSub</span></a><span>
</span><a name="line-170"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertSub"><span class="hs-identifier hs-var">interactInertSub</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>  </span><a name="local-6989586621681484106"><a href="#local-6989586621681484106"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;-&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>            </span><span class="hs-identifier hs-var">typeNatSubTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier hs-var">typeNatSubTyCon</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-identifier">typeNatMulTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-177"></a><a name="typeNatMulTyCon"><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier">typeNatMulTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484107"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-178"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamMul"><span class="hs-identifier hs-var">matchFamMul</span></a><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopMul"><span class="hs-identifier hs-var">interactTopMul</span></a><span>
</span><a name="line-181"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertMul"><span class="hs-identifier hs-var">interactInertMul</span></a><span>
</span><a name="line-182"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-184"></a><span>  </span><a name="local-6989586621681484107"><a href="#local-6989586621681484107"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>            </span><span class="hs-identifier hs-var">typeNatMulTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier hs-var">typeNatMulTyCon</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-identifier">typeNatDivTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-188"></a><a name="typeNatDivTyCon"><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier">typeNatDivTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484108"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-189"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamDiv"><span class="hs-identifier hs-var">matchFamDiv</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopDiv"><span class="hs-identifier hs-var">interactTopDiv</span></a><span>
</span><a name="line-192"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertDiv"><span class="hs-identifier hs-var">interactInertDiv</span></a><span>
</span><a name="line-193"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-195"></a><span>  </span><a name="local-6989586621681484108"><a href="#local-6989586621681484108"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;Div&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>            </span><span class="hs-identifier hs-var">typeNatDivTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier hs-var">typeNatDivTyCon</span></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-identifier">typeNatModTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-199"></a><a name="typeNatModTyCon"><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier">typeNatModTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484109"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-200"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamMod"><span class="hs-identifier hs-var">matchFamMod</span></a><span>
</span><a name="line-202"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopMod"><span class="hs-identifier hs-var">interactTopMod</span></a><span>
</span><a name="line-203"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertMod"><span class="hs-identifier hs-var">interactInertMod</span></a><span>
</span><a name="line-204"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-206"></a><span>  </span><a name="local-6989586621681484109"><a href="#local-6989586621681484109"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;Mod&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>            </span><span class="hs-identifier hs-var">typeNatModTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier hs-var">typeNatModTyCon</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-identifier">typeNatExpTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-214"></a><a name="typeNatExpTyCon"><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier">typeNatExpTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier hs-var">mkTypeNatFunTyCon2</span></a><span> </span><a href="#local-6989586621681484110"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-215"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamExp"><span class="hs-identifier hs-var">matchFamExp</span></a><span>
</span><a name="line-217"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopExp"><span class="hs-identifier hs-var">interactTopExp</span></a><span>
</span><a name="line-218"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertExp"><span class="hs-identifier hs-var">interactInertExp</span></a><span>
</span><a name="line-219"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-221"></a><span>  </span><a name="local-6989586621681484110"><a href="#local-6989586621681484110"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;^&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>                </span><span class="hs-identifier hs-var">typeNatExpTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier hs-var">typeNatExpTyCon</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-identifier">typeNatLogTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-225"></a><a name="typeNatLogTyCon"><a href="TcTypeNats.html#typeNatLogTyCon"><span class="hs-identifier">typeNatLogTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeNatFunTyCon1"><span class="hs-identifier hs-var">mkTypeNatFunTyCon1</span></a><span> </span><a href="#local-6989586621681484111"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-226"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamLog"><span class="hs-identifier hs-var">matchFamLog</span></a><span>
</span><a name="line-228"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopLog"><span class="hs-identifier hs-var">interactTopLog</span></a><span>
</span><a name="line-229"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertLog"><span class="hs-identifier hs-var">interactInertLog</span></a><span>
</span><a name="line-230"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-232"></a><span>  </span><a name="local-6989586621681484111"><a href="#local-6989586621681484111"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;Log2&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>            </span><span class="hs-identifier hs-var">typeNatLogTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatLogTyCon"><span class="hs-identifier hs-var">typeNatLogTyCon</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-identifier">typeNatLeqTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-238"></a><a name="typeNatLeqTyCon"><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier">typeNatLeqTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484112"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-240"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-identifier hs-var">boolTy</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484113"><span class="hs-identifier hs-var">ops</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-248"></a><span>  </span><a name="local-6989586621681484112"><a href="#local-6989586621681484112"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;&lt;=?&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>                </span><span class="hs-identifier hs-var">typeNatLeqTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier hs-var">typeNatLeqTyCon</span></a><span>
</span><a name="line-250"></a><span>  </span><a name="local-6989586621681484113"><a href="#local-6989586621681484113"><span class="hs-identifier">ops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamLeq"><span class="hs-identifier hs-var">matchFamLeq</span></a><span>
</span><a name="line-252"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopLeq"><span class="hs-identifier hs-var">interactTopLeq</span></a><span>
</span><a name="line-253"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertLeq"><span class="hs-identifier hs-var">interactInertLeq</span></a><span>
</span><a name="line-254"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-identifier">typeNatCmpTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-257"></a><a name="typeNatCmpTyCon"><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier">typeNatCmpTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484114"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-259"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>    </span><a href="TcTypeNats.html#orderingKind"><span class="hs-identifier hs-var">orderingKind</span></a><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484115"><span class="hs-identifier hs-var">ops</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-264"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-267"></a><span>  </span><a name="local-6989586621681484114"><a href="#local-6989586621681484114"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPENATS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;CmpNat&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>                </span><span class="hs-identifier hs-var">typeNatCmpTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier hs-var">typeNatCmpTyCon</span></a><span>
</span><a name="line-269"></a><span>  </span><a name="local-6989586621681484115"><a href="#local-6989586621681484115"><span class="hs-identifier">ops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamCmpNat"><span class="hs-identifier hs-var">matchFamCmpNat</span></a><span>
</span><a name="line-271"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopCmpNat"><span class="hs-identifier hs-var">interactTopCmpNat</span></a><span>
</span><a name="line-272"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-273"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">typeSymbolCmpTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-276"></a><a name="typeSymbolCmpTyCon"><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier">typeSymbolCmpTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484116"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-278"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeSymbolKind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeSymbolKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>    </span><a href="TcTypeNats.html#orderingKind"><span class="hs-identifier hs-var">orderingKind</span></a><span>
</span><a name="line-280"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-281"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484117"><span class="hs-identifier hs-var">ops</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-286"></a><span>  </span><a name="local-6989586621681484116"><a href="#local-6989586621681484116"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPELITS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;CmpSymbol&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>                </span><span class="hs-identifier hs-var">typeSymbolCmpTyFamNameKey</span><span> </span><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier hs-var">typeSymbolCmpTyCon</span></a><span>
</span><a name="line-288"></a><span>  </span><a name="local-6989586621681484117"><a href="#local-6989586621681484117"><span class="hs-identifier">ops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-289"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamCmpSymbol"><span class="hs-identifier hs-var">matchFamCmpSymbol</span></a><span>
</span><a name="line-290"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopCmpSymbol"><span class="hs-identifier hs-var">interactTopCmpSymbol</span></a><span>
</span><a name="line-291"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-292"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-identifier">typeSymbolAppendTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-295"></a><a name="typeSymbolAppendTyCon"><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier">typeSymbolAppendTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkTypeSymbolFunTyCon2"><span class="hs-identifier hs-var">mkTypeSymbolFunTyCon2</span></a><span> </span><a href="#local-6989586621681484118"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-296"></a><span>  </span><span class="hs-identifier hs-var">BuiltInSynFamily</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sfMatchFam</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#matchFamAppendSymbol"><span class="hs-identifier hs-var">matchFamAppendSymbol</span></a><span>
</span><a name="line-298"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractTop</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactTopAppendSymbol"><span class="hs-identifier hs-var">interactTopAppendSymbol</span></a><span>
</span><a name="line-299"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfInteractInert</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#interactInertAppendSymbol"><span class="hs-identifier hs-var">interactInertAppendSymbol</span></a><span>
</span><a name="line-300"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-302"></a><span>  </span><a name="local-6989586621681484118"><a href="#local-6989586621681484118"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkWiredInTyConName</span><span> </span><span class="hs-identifier hs-var">UserSyntax</span><span> </span><span class="hs-identifier hs-var">gHC_TYPELITS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;AppendSymbol&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>                </span><span class="hs-identifier hs-var">typeSymbolAppendFamNameKey</span><span> </span><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier hs-var">typeSymbolAppendTyCon</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-comment">-- Make a unary built-in constructor of kind: Nat -&gt; Nat</span><span>
</span><a name="line-308"></a><span class="hs-identifier">mkTypeNatFunTyCon1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BuiltInSynFamily</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-309"></a><a name="mkTypeNatFunTyCon1"><a href="TcTypeNats.html#mkTypeNatFunTyCon1"><span class="hs-identifier">mkTypeNatFunTyCon1</span></a></a><span> </span><a name="local-6989586621681484119"><a href="#local-6989586621681484119"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621681484120"><a href="#local-6989586621681484120"><span class="hs-identifier">tcb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484119"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-311"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>    </span><span class="hs-identifier hs-var">typeNatKind</span><span>
</span><a name="line-313"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-314"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484120"><span class="hs-identifier hs-var">tcb</span></a><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-316"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- Make a binary built-in constructor of kind: Nat -&gt; Nat -&gt; Nat</span><span>
</span><a name="line-320"></a><span class="hs-identifier">mkTypeNatFunTyCon2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BuiltInSynFamily</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-321"></a><a name="mkTypeNatFunTyCon2"><a href="TcTypeNats.html#mkTypeNatFunTyCon2"><span class="hs-identifier">mkTypeNatFunTyCon2</span></a></a><span> </span><a name="local-6989586621681484121"><a href="#local-6989586621681484121"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621681484122"><a href="#local-6989586621681484122"><span class="hs-identifier">tcb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-322"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484121"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-323"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>    </span><span class="hs-identifier hs-var">typeNatKind</span><span>
</span><a name="line-325"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-326"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484122"><span class="hs-identifier hs-var">tcb</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-328"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">-- Make a binary built-in constructor of kind: Symbol -&gt; Symbol -&gt; Symbol</span><span>
</span><a name="line-331"></a><span class="hs-identifier">mkTypeSymbolFunTyCon2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BuiltInSynFamily</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span>
</span><a name="line-332"></a><a name="mkTypeSymbolFunTyCon2"><a href="TcTypeNats.html#mkTypeSymbolFunTyCon2"><span class="hs-identifier">mkTypeSymbolFunTyCon2</span></a></a><span> </span><a name="local-6989586621681484123"><a href="#local-6989586621681484123"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621681484124"><a href="#local-6989586621681484124"><span class="hs-identifier">tcb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-identifier hs-var">mkFamilyTyCon</span><span> </span><a href="#local-6989586621681484123"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-334"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTemplateAnonTyConBinders</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">typeSymbolKind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeSymbolKind</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>    </span><span class="hs-identifier hs-var">typeSymbolKind</span><span>
</span><a name="line-336"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-337"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span><span> </span><a href="#local-6989586621681484124"><span class="hs-identifier hs-var">tcb</span></a><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-339"></a><span>    </span><span class="hs-identifier hs-var">NotInjective</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Built-in rules axioms
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- If you add additional rules, please remember to add them to</span><span>
</span><a name="line-347"></a><span class="hs-comment">-- `typeNatCoAxiomRules` also.</span><span>
</span><a name="line-348"></a><span class="hs-comment">-- See Note [Adding built-in type families]</span><span>
</span><a name="line-349"></a><span class="hs-identifier">axAddDef</span><span>
</span><a name="line-350"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMulDef</span><span>
</span><a name="line-351"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axExpDef</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axLeqDef</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axCmpNatDef</span><span>
</span><a name="line-354"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axCmpSymbolDef</span><span>
</span><a name="line-355"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axAppendSymbolDef</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axAdd0L</span><span>
</span><a name="line-357"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axAdd0R</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMul0L</span><span>
</span><a name="line-359"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMul0R</span><span>
</span><a name="line-360"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMul1L</span><span>
</span><a name="line-361"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMul1R</span><span>
</span><a name="line-362"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axExp1L</span><span>
</span><a name="line-363"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axExp0R</span><span>
</span><a name="line-364"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axExp1R</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axLeqRefl</span><span>
</span><a name="line-366"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axCmpNatRefl</span><span>
</span><a name="line-367"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axCmpSymbolRefl</span><span>
</span><a name="line-368"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axLeq0L</span><span>
</span><a name="line-369"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axSubDef</span><span>
</span><a name="line-370"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axSub0R</span><span>
</span><a name="line-371"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axAppendSymbol0R</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axAppendSymbol0L</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axDivDef</span><span>
</span><a name="line-374"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axDiv1</span><span>
</span><a name="line-375"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axModDef</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axMod1</span><span>
</span><a name="line-377"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">axLogDef</span><span>
</span><a name="line-378"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><a name="axAddDef"><a href="TcTypeNats.html#axAddDef"><span class="hs-identifier">axAddDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;AddDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier hs-var">typeNatAddTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-381"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484125"><a href="#local-6989586621681484125"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484126"><a href="#local-6989586621681484126"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484125"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621681484126"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><a name="axMulDef"><a href="TcTypeNats.html#axMulDef"><span class="hs-identifier">axMulDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;MulDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier hs-var">typeNatMulTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-384"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484127"><a href="#local-6989586621681484127"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484128"><a href="#local-6989586621681484128"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484127"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621681484128"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><a name="axExpDef"><a href="TcTypeNats.html#axExpDef"><span class="hs-identifier">axExpDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;ExpDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier hs-var">typeNatExpTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-387"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484129"><a href="#local-6989586621681484129"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484130"><a href="#local-6989586621681484130"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484129"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621681484130"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><a name="axLeqDef"><a href="TcTypeNats.html#axLeqDef"><span class="hs-identifier">axLeqDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;LeqDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier hs-var">typeNatLeqTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-390"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484131"><a href="#local-6989586621681484131"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484132"><a href="#local-6989586621681484132"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484131"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621681484132"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><a name="axCmpNatDef"><a href="TcTypeNats.html#axCmpNatDef"><span class="hs-identifier">axCmpNatDef</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;CmpNatDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier hs-var">typeNatCmpTyCon</span></a><span>
</span><a name="line-393"></a><span>              </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681484133"><a href="#local-6989586621681484133"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484134"><a href="#local-6989586621681484134"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621681484133"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484134"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><a name="axCmpSymbolDef"><a href="TcTypeNats.html#axCmpSymbolDef"><span class="hs-identifier">axCmpSymbolDef</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-396"></a><span>  </span><span class="hs-identifier hs-var">CoAxiomRule</span><span>
</span><a name="line-397"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">coaxrName</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;CmpSymbolDef&quot;</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">]</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrProves</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681484135"><a href="#local-6989586621681484135"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-401"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484136"><a href="#local-6989586621681484136"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621681484137"><a href="#local-6989586621681484137"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484138"><a href="#local-6989586621681484138"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621681484139"><a href="#local-6989586621681484139"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484135"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-402"></a><span>           </span><a name="local-6989586621681484140"><a href="#local-6989586621681484140"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484137"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-403"></a><span>           </span><a name="local-6989586621681484141"><a href="#local-6989586621681484141"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484139"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-404"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier hs-var">typeSymbolCmpTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484136"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621681484138"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span>
</span><a name="line-405"></a><span>                   </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621681484140"><span class="hs-identifier hs-var">s2'</span></a><span> </span><a href="#local-6989586621681484141"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><a name="axAppendSymbolDef"><a href="TcTypeNats.html#axAppendSymbolDef"><span class="hs-identifier">axAppendSymbolDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CoAxiomRule</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">coaxrName</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;AppendSymbolDef&quot;</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">]</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrProves</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681484142"><a href="#local-6989586621681484142"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-412"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484143"><a href="#local-6989586621681484143"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621681484144"><a href="#local-6989586621681484144"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484145"><a href="#local-6989586621681484145"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621681484146"><a href="#local-6989586621681484146"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484142"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-413"></a><span>           </span><a name="local-6989586621681484147"><a href="#local-6989586621681484147"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484144"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-414"></a><span>           </span><a name="local-6989586621681484148"><a href="#local-6989586621681484148"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484146"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-415"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681484149"><a href="#local-6989586621681484149"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">appendFS</span><span> </span><a href="#local-6989586621681484147"><span class="hs-identifier hs-var">s2'</span></a><span> </span><a href="#local-6989586621681484148"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier hs-var">typeSymbolAppendTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484143"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484145"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484149"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><a name="axSubDef"><a href="TcTypeNats.html#axSubDef"><span class="hs-identifier">axSubDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;SubDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier hs-var">typeNatSubTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-420"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484150"><a href="#local-6989586621681484150"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484151"><a href="#local-6989586621681484151"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#minus"><span class="hs-identifier hs-var">minus</span></a><span> </span><a href="#local-6989586621681484150"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484151"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><a name="axDivDef"><a href="TcTypeNats.html#axDivDef"><span class="hs-identifier">axDivDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;DivDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier hs-var">typeNatDivTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-423"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484152"><a href="#local-6989586621681484152"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484153"><a href="#local-6989586621681484153"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484153"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">div</span><span> </span><a href="#local-6989586621681484152"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484153"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><a name="axModDef"><a href="TcTypeNats.html#axModDef"><span class="hs-identifier">axModDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier hs-var">mkBinAxiom</span></a><span> </span><span class="hs-string">&quot;ModDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier hs-var">typeNatModTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-427"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484154"><a href="#local-6989586621681484154"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484155"><a href="#local-6989586621681484155"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484155"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621681484154"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484155"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><a name="axLogDef"><a href="TcTypeNats.html#axLogDef"><span class="hs-identifier">axLogDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkUnAxiom"><span class="hs-identifier hs-var">mkUnAxiom</span></a><span> </span><span class="hs-string">&quot;LogDef&quot;</span><span> </span><a href="TcTypeNats.html#typeNatLogTyCon"><span class="hs-identifier hs-var">typeNatLogTyCon</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-431"></a><span>              </span><span class="hs-glyph">\</span><a name="local-6989586621681484156"><a href="#local-6989586621681484156"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484157"><a href="#local-6989586621681484157"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#genLog"><span class="hs-identifier hs-var">genLog</span></a><span> </span><a href="#local-6989586621681484156"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-432"></a><span>                       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484157"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><a name="axAdd0L"><a href="TcTypeNats.html#axAdd0L"><span class="hs-identifier">axAdd0L</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Add0L&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484158"><a href="#local-6989586621681484158"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484159"><a href="#local-6989586621681484159"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="TcTypeNats.html#.%2B."><span class="hs-operator hs-var">.+.</span></a><span> </span><a href="#local-6989586621681484158"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484159"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-435"></a><a name="axAdd0R"><a href="TcTypeNats.html#axAdd0R"><span class="hs-identifier">axAdd0R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Add0R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484160"><a href="#local-6989586621681484160"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484161"><a href="#local-6989586621681484161"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484160"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.%2B."><span class="hs-operator hs-var">.+.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484161"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-436"></a><a name="axSub0R"><a href="TcTypeNats.html#axSub0R"><span class="hs-identifier">axSub0R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Sub0R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484162"><a href="#local-6989586621681484162"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484163"><a href="#local-6989586621681484163"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484162"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.-."><span class="hs-operator hs-var">.-.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484163"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-437"></a><a name="axMul0L"><a href="TcTypeNats.html#axMul0L"><span class="hs-identifier">axMul0L</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Mul0L&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484164"><a href="#local-6989586621681484164"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="TcTypeNats.html#.%2A."><span class="hs-operator hs-var">.*.</span></a><span> </span><a href="#local-6989586621681484164"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-438"></a><a name="axMul0R"><a href="TcTypeNats.html#axMul0R"><span class="hs-identifier">axMul0R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Mul0R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484165"><a href="#local-6989586621681484165"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484165"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.%2A."><span class="hs-operator hs-var">.*.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-439"></a><a name="axMul1L"><a href="TcTypeNats.html#axMul1L"><span class="hs-identifier">axMul1L</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Mul1L&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484166"><a href="#local-6989586621681484166"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484167"><a href="#local-6989586621681484167"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="TcTypeNats.html#.%2A."><span class="hs-operator hs-var">.*.</span></a><span> </span><a href="#local-6989586621681484166"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484167"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-440"></a><a name="axMul1R"><a href="TcTypeNats.html#axMul1R"><span class="hs-identifier">axMul1R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Mul1R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484168"><a href="#local-6989586621681484168"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484169"><a href="#local-6989586621681484169"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484168"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.%2A."><span class="hs-operator hs-var">.*.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484169"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-441"></a><a name="axDiv1"><a href="TcTypeNats.html#axDiv1"><span class="hs-identifier">axDiv1</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Div1&quot;</span><span>     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484170"><a href="#local-6989586621681484170"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484171"><a href="#local-6989586621681484171"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#tDiv"><span class="hs-identifier hs-var">tDiv</span></a><span> </span><a href="#local-6989586621681484170"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484171"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><a name="axMod1"><a href="TcTypeNats.html#axMod1"><span class="hs-identifier">axMod1</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Mod1&quot;</span><span>     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484172"><a href="#local-6989586621681484172"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#tMod"><span class="hs-identifier hs-var">tMod</span></a><span> </span><a href="#local-6989586621681484172"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>                                    </span><span class="hs-comment">-- XXX: Shouldn't we check that _ is 0?</span><span>
</span><a name="line-444"></a><a name="axExp1L"><a href="TcTypeNats.html#axExp1L"><span class="hs-identifier">axExp1L</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Exp1L&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484173"><a href="#local-6989586621681484173"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="TcTypeNats.html#.%5E."><span class="hs-operator hs-var">.^.</span></a><span> </span><a href="#local-6989586621681484173"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-445"></a><a name="axExp0R"><a href="TcTypeNats.html#axExp0R"><span class="hs-identifier">axExp0R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Exp0R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484174"><a href="#local-6989586621681484174"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484174"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.%5E."><span class="hs-operator hs-var">.^.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-446"></a><a name="axExp1R"><a href="TcTypeNats.html#axExp1R"><span class="hs-identifier">axExp1R</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Exp1R&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484175"><a href="#local-6989586621681484175"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484176"><a href="#local-6989586621681484176"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484175"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#.%5E."><span class="hs-operator hs-var">.^.</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484176"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-447"></a><a name="axLeqRefl"><a href="TcTypeNats.html#axLeqRefl"><span class="hs-identifier">axLeqRefl</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;LeqRefl&quot;</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484177"><a href="#local-6989586621681484177"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484177"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3C%3D%3D"><span class="hs-operator hs-var">&lt;==</span></a><span> </span><a href="#local-6989586621681484177"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-448"></a><a name="axCmpNatRefl"><a href="TcTypeNats.html#axCmpNatRefl"><span class="hs-identifier">axCmpNatRefl</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;CmpNatRefl&quot;</span><span>
</span><a name="line-449"></a><span>                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484178"><a href="#local-6989586621681484178"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#cmpNat"><span class="hs-identifier hs-var">cmpNat</span></a><span> </span><a href="#local-6989586621681484178"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621681484178"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-450"></a><a name="axCmpSymbolRefl"><a href="TcTypeNats.html#axCmpSymbolRefl"><span class="hs-identifier">axCmpSymbolRefl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;CmpSymbolRefl&quot;</span><span>
</span><a name="line-451"></a><span>                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484179"><a href="#local-6989586621681484179"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#cmpSymbol"><span class="hs-identifier hs-var">cmpSymbol</span></a><span> </span><a href="#local-6989586621681484179"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621681484179"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-452"></a><a name="axLeq0L"><a href="TcTypeNats.html#axLeq0L"><span class="hs-identifier">axLeq0L</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Leq0L&quot;</span><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484180"><a href="#local-6989586621681484180"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="TcTypeNats.html#%3C%3D%3D"><span class="hs-operator hs-var">&lt;==</span></a><span> </span><a href="#local-6989586621681484180"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-453"></a><a name="axAppendSymbol0R"><a href="TcTypeNats.html#axAppendSymbol0R"><span class="hs-identifier">axAppendSymbol0R</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Concat0R&quot;</span><span>
</span><a name="line-454"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484181"><a href="#local-6989586621681484181"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484182"><a href="#local-6989586621681484182"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-identifier hs-var">nilFS</span><span> </span><span class="hs-special">`</span><a href="TcTypeNats.html#appendSymbol"><span class="hs-identifier hs-var">appendSymbol</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681484181"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484182"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-455"></a><a name="axAppendSymbol0L"><a href="TcTypeNats.html#axAppendSymbol0L"><span class="hs-identifier">axAppendSymbol0L</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier hs-var">mkAxiom1</span></a><span> </span><span class="hs-string">&quot;Concat0L&quot;</span><span>
</span><a name="line-456"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484183"><a href="#local-6989586621681484183"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484184"><a href="#local-6989586621681484184"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484183"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="TcTypeNats.html#appendSymbol"><span class="hs-identifier hs-var">appendSymbol</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-identifier hs-var">nilFS</span><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484184"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-comment">-- The list of built-in type family axioms that GHC uses.</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- If you define new axioms, make sure to include them in this list.</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- See Note [Adding built-in type families]</span><span>
</span><a name="line-461"></a><span class="hs-identifier">typeNatCoAxiomRules</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map.Map</span><span> </span><span class="hs-identifier hs-type">FastString</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span>
</span><a name="line-462"></a><a name="typeNatCoAxiomRules"><a href="TcTypeNats.html#typeNatCoAxiomRules"><span class="hs-identifier">typeNatCoAxiomRules</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621681484185"><a href="#local-6989586621681484185"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">coaxrName</span><span> </span><a href="#local-6989586621681484185"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484185"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="TcTypeNats.html#axAddDef"><span class="hs-identifier hs-var">axAddDef</span></a><span>
</span><a name="line-464"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMulDef"><span class="hs-identifier hs-var">axMulDef</span></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axExpDef"><span class="hs-identifier hs-var">axExpDef</span></a><span>
</span><a name="line-466"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axLeqDef"><span class="hs-identifier hs-var">axLeqDef</span></a><span>
</span><a name="line-467"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axCmpNatDef"><span class="hs-identifier hs-var">axCmpNatDef</span></a><span>
</span><a name="line-468"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axCmpSymbolDef"><span class="hs-identifier hs-var">axCmpSymbolDef</span></a><span>
</span><a name="line-469"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axAppendSymbolDef"><span class="hs-identifier hs-var">axAppendSymbolDef</span></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axAdd0L"><span class="hs-identifier hs-var">axAdd0L</span></a><span>
</span><a name="line-471"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axAdd0R"><span class="hs-identifier hs-var">axAdd0R</span></a><span>
</span><a name="line-472"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMul0L"><span class="hs-identifier hs-var">axMul0L</span></a><span>
</span><a name="line-473"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMul0R"><span class="hs-identifier hs-var">axMul0R</span></a><span>
</span><a name="line-474"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMul1L"><span class="hs-identifier hs-var">axMul1L</span></a><span>
</span><a name="line-475"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMul1R"><span class="hs-identifier hs-var">axMul1R</span></a><span>
</span><a name="line-476"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axExp1L"><span class="hs-identifier hs-var">axExp1L</span></a><span>
</span><a name="line-477"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axExp0R"><span class="hs-identifier hs-var">axExp0R</span></a><span>
</span><a name="line-478"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axExp1R"><span class="hs-identifier hs-var">axExp1R</span></a><span>
</span><a name="line-479"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axLeqRefl"><span class="hs-identifier hs-var">axLeqRefl</span></a><span>
</span><a name="line-480"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axCmpNatRefl"><span class="hs-identifier hs-var">axCmpNatRefl</span></a><span>
</span><a name="line-481"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axCmpSymbolRefl"><span class="hs-identifier hs-var">axCmpSymbolRefl</span></a><span>
</span><a name="line-482"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axLeq0L"><span class="hs-identifier hs-var">axLeq0L</span></a><span>
</span><a name="line-483"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axSubDef"><span class="hs-identifier hs-var">axSubDef</span></a><span>
</span><a name="line-484"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axSub0R"><span class="hs-identifier hs-var">axSub0R</span></a><span>
</span><a name="line-485"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axAppendSymbol0R"><span class="hs-identifier hs-var">axAppendSymbol0R</span></a><span>
</span><a name="line-486"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axAppendSymbol0L"><span class="hs-identifier hs-var">axAppendSymbol0L</span></a><span>
</span><a name="line-487"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axDivDef"><span class="hs-identifier hs-var">axDivDef</span></a><span>
</span><a name="line-488"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axDiv1"><span class="hs-identifier hs-var">axDiv1</span></a><span>
</span><a name="line-489"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axModDef"><span class="hs-identifier hs-var">axModDef</span></a><span>
</span><a name="line-490"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axMod1"><span class="hs-identifier hs-var">axMod1</span></a><span>
</span><a name="line-491"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#axLogDef"><span class="hs-identifier hs-var">axLogDef</span></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Various utilities for making axioms and types
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span class="hs-special">(</span><span class="hs-operator">.+.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-501"></a><a name="local-6989586621681484186"><a href="#local-6989586621681484186"><span class="hs-identifier">s</span></a></a><span> </span><a name=".%2B."><a href="TcTypeNats.html#.%2B."><span class="hs-operator">.+.</span></a></a><span> </span><a name="local-6989586621681484187"><a href="#local-6989586621681484187"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatAddTyCon"><span class="hs-identifier hs-var">typeNatAddTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484186"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484187"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-special">(</span><span class="hs-operator">.-.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-504"></a><a name="local-6989586621681484188"><a href="#local-6989586621681484188"><span class="hs-identifier">s</span></a></a><span> </span><a name=".-."><a href="TcTypeNats.html#.-."><span class="hs-operator">.-.</span></a></a><span> </span><a name="local-6989586621681484189"><a href="#local-6989586621681484189"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatSubTyCon"><span class="hs-identifier hs-var">typeNatSubTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484188"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484189"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-special">(</span><span class="hs-operator">.*.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-507"></a><a name="local-6989586621681484190"><a href="#local-6989586621681484190"><span class="hs-identifier">s</span></a></a><span> </span><a name=".%2A."><a href="TcTypeNats.html#.%2A."><span class="hs-operator">.*.</span></a></a><span> </span><a name="local-6989586621681484191"><a href="#local-6989586621681484191"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatMulTyCon"><span class="hs-identifier hs-var">typeNatMulTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484190"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484191"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-identifier">tDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-510"></a><a name="tDiv"><a href="TcTypeNats.html#tDiv"><span class="hs-identifier">tDiv</span></a></a><span> </span><a name="local-6989586621681484192"><a href="#local-6989586621681484192"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484193"><a href="#local-6989586621681484193"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatDivTyCon"><span class="hs-identifier hs-var">typeNatDivTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484192"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484193"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-identifier">tMod</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-513"></a><a name="tMod"><a href="TcTypeNats.html#tMod"><span class="hs-identifier">tMod</span></a></a><span> </span><a name="local-6989586621681484194"><a href="#local-6989586621681484194"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484195"><a href="#local-6989586621681484195"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatModTyCon"><span class="hs-identifier hs-var">typeNatModTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484194"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484195"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-514"></a><span>
</span><a name="line-515"></a><span class="hs-special">(</span><span class="hs-operator">.^.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-516"></a><a name="local-6989586621681484196"><a href="#local-6989586621681484196"><span class="hs-identifier">s</span></a></a><span> </span><a name=".%5E."><a href="TcTypeNats.html#.%5E."><span class="hs-operator">.^.</span></a></a><span> </span><a name="local-6989586621681484197"><a href="#local-6989586621681484197"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatExpTyCon"><span class="hs-identifier hs-var">typeNatExpTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484196"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484197"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-special">(</span><span class="hs-operator">&lt;==</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-519"></a><a name="local-6989586621681484198"><a href="#local-6989586621681484198"><span class="hs-identifier">s</span></a></a><span> </span><a name="%3C%3D%3D"><a href="TcTypeNats.html#%3C%3D%3D"><span class="hs-operator">&lt;==</span></a></a><span> </span><a name="local-6989586621681484199"><a href="#local-6989586621681484199"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatLeqTyCon"><span class="hs-identifier hs-var">typeNatLeqTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484198"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484199"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-identifier">cmpNat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-522"></a><a name="cmpNat"><a href="TcTypeNats.html#cmpNat"><span class="hs-identifier">cmpNat</span></a></a><span> </span><a name="local-6989586621681484200"><a href="#local-6989586621681484200"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484201"><a href="#local-6989586621681484201"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeNatCmpTyCon"><span class="hs-identifier hs-var">typeNatCmpTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484200"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484201"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-identifier">cmpSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-525"></a><a name="cmpSymbol"><a href="TcTypeNats.html#cmpSymbol"><span class="hs-identifier">cmpSymbol</span></a></a><span> </span><a name="local-6989586621681484202"><a href="#local-6989586621681484202"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484203"><a href="#local-6989586621681484203"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeSymbolCmpTyCon"><span class="hs-identifier hs-var">typeSymbolCmpTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484202"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484203"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-identifier">appendSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-528"></a><a name="appendSymbol"><a href="TcTypeNats.html#appendSymbol"><span class="hs-identifier">appendSymbol</span></a></a><span> </span><a name="local-6989586621681484204"><a href="#local-6989586621681484204"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484205"><a href="#local-6989586621681484205"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="TcTypeNats.html#typeSymbolAppendTyCon"><span class="hs-identifier hs-var">typeSymbolAppendTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484204"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484205"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-special">(</span><span class="hs-operator">===</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-531"></a><a name="local-6989586621681484206"><a href="#local-6989586621681484206"><span class="hs-identifier">x</span></a></a><span> </span><a name="%3D%3D%3D"><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator">===</span></a></a><span> </span><a name="local-6989586621681484207"><a href="#local-6989586621681484207"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Pair</span><span> </span><a href="#local-6989586621681484206"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484207"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">num</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-534"></a><a name="num"><a href="TcTypeNats.html#num"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNumLitTy</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-identifier">bool</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-537"></a><a name="bool"><a href="TcTypeNats.html#bool"><span class="hs-identifier">bool</span></a></a><span> </span><a name="local-6989586621681484208"><a href="#local-6989586621681484208"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621681484208"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">promotedTrueDataCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-538"></a><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">promotedFalseDataCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span class="hs-identifier">isBoolLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-541"></a><a name="isBoolLitTy"><a href="TcTypeNats.html#isBoolLitTy"><span class="hs-identifier">isBoolLitTy</span></a></a><span> </span><a name="local-6989586621681484209"><a href="#local-6989586621681484209"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-542"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484210"><a href="#local-6989586621681484210"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitTyConApp_maybe</span><span> </span><a href="#local-6989586621681484209"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-543"></a><span>     </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-544"></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484210"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedFalseDataCon</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-545"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484210"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedTrueDataCon</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-546"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-identifier">orderingKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-549"></a><a name="orderingKind"><a href="TcTypeNats.html#orderingKind"><span class="hs-identifier">orderingKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">orderingTyCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-identifier">ordering</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-552"></a><a name="ordering"><a href="TcTypeNats.html#ordering"><span class="hs-identifier">ordering</span></a></a><span> </span><a name="local-6989586621681484211"><a href="#local-6989586621681484211"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-553"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681484211"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-554"></a><span>    </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">promotedLTDataCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-555"></a><span>    </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">promotedEQDataCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-556"></a><span>    </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><span class="hs-identifier hs-var">promotedGTDataCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-identifier">isOrderingLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-559"></a><a name="isOrderingLitTy"><a href="TcTypeNats.html#isOrderingLitTy"><span class="hs-identifier">isOrderingLitTy</span></a></a><span> </span><a name="local-6989586621681484212"><a href="#local-6989586621681484212"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-560"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484213"><a href="#local-6989586621681484213"><span class="hs-identifier">tc1</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitTyConApp_maybe</span><span> </span><a href="#local-6989586621681484212"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-561"></a><span>     </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-562"></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484213"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedLTDataCon</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-563"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484213"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedEQDataCon</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-564"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484213"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedGTDataCon</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-565"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-identifier">known</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-568"></a><a name="known"><a href="TcTypeNats.html#known"><span class="hs-identifier">known</span></a></a><span> </span><a name="local-6989586621681484214"><a href="#local-6989586621681484214"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621681484215"><a href="#local-6989586621681484215"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484215"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-569"></a><span>              </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484216"><a href="#local-6989586621681484216"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681484214"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621681484216"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-570"></a><span>              </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span class="hs-identifier">mkUnAxiom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span>
</span><a name="line-574"></a><a name="mkUnAxiom"><a href="TcTypeNats.html#mkUnAxiom"><span class="hs-identifier">mkUnAxiom</span></a></a><span> </span><a name="local-6989586621681484217"><a href="#local-6989586621681484217"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621681484218"><a href="#local-6989586621681484218"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681484219"><a href="#local-6989586621681484219"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-575"></a><span>  </span><span class="hs-identifier hs-var">CoAxiomRule</span><span>
</span><a name="line-576"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">coaxrName</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621681484217"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-577"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">]</span><span>
</span><a name="line-578"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrProves</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681484220"><a href="#local-6989586621681484220"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-580"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484221"><a href="#local-6989586621681484221"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621681484222"><a href="#local-6989586621681484222"><span class="hs-identifier">s2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484220"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-581"></a><span>           </span><a name="local-6989586621681484223"><a href="#local-6989586621681484223"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484222"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-582"></a><span>           </span><a name="local-6989586621681484224"><a href="#local-6989586621681484224"><span class="hs-identifier">z</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484219"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681484223"><span class="hs-identifier hs-var">s2'</span></a><span>
</span><a name="line-583"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="#local-6989586621681484218"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484221"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">]</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484224"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-584"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span>
</span><a name="line-588"></a><span class="hs-comment">-- For the definitional axioms</span><span>
</span><a name="line-589"></a><span class="hs-identifier">mkBinAxiom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TyCon</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-590"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span>
</span><a name="line-591"></a><a name="mkBinAxiom"><a href="TcTypeNats.html#mkBinAxiom"><span class="hs-identifier">mkBinAxiom</span></a></a><span> </span><a name="local-6989586621681484225"><a href="#local-6989586621681484225"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621681484226"><a href="#local-6989586621681484226"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681484227"><a href="#local-6989586621681484227"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-592"></a><span>  </span><span class="hs-identifier hs-var">CoAxiomRule</span><span>
</span><a name="line-593"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">coaxrName</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621681484225"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-594"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">]</span><span>
</span><a name="line-595"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span>
</span><a name="line-596"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrProves</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681484228"><a href="#local-6989586621681484228"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-597"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484229"><a href="#local-6989586621681484229"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621681484230"><a href="#local-6989586621681484230"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Pair</span><span> </span><a name="local-6989586621681484231"><a href="#local-6989586621681484231"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621681484232"><a href="#local-6989586621681484232"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484228"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-598"></a><span>           </span><a name="local-6989586621681484233"><a href="#local-6989586621681484233"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484230"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-599"></a><span>           </span><a name="local-6989586621681484234"><a href="#local-6989586621681484234"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484232"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-600"></a><span>           </span><a name="local-6989586621681484235"><a href="#local-6989586621681484235"><span class="hs-identifier">z</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484227"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681484233"><span class="hs-identifier hs-var">s2'</span></a><span> </span><a href="#local-6989586621681484234"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-601"></a><span>           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="#local-6989586621681484226"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484229"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621681484231"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484235"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-identifier">mkAxiom1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TypeEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TypeEqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoAxiomRule</span><span>
</span><a name="line-607"></a><a name="mkAxiom1"><a href="TcTypeNats.html#mkAxiom1"><span class="hs-identifier">mkAxiom1</span></a></a><span> </span><a name="local-6989586621681484236"><a href="#local-6989586621681484236"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621681484237"><a href="#local-6989586621681484237"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-608"></a><span>  </span><span class="hs-identifier hs-var">CoAxiomRule</span><span>
</span><a name="line-609"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">coaxrName</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fsLit</span><span> </span><a href="#local-6989586621681484236"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-610"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrAsmpRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">]</span><span>
</span><a name="line-611"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrRole</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span>
</span><a name="line-612"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">coaxrProves</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681484238"><a href="#local-6989586621681484238"><span class="hs-identifier">eqn</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484237"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681484238"><span class="hs-identifier hs-var">eqn</span></a><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span>                             </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-614"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Evaluation
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span class="hs-identifier">matchFamAdd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-622"></a><a name="matchFamAdd"><a href="TcTypeNats.html#matchFamAdd"><span class="hs-identifier">matchFamAdd</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484239"><a href="#local-6989586621681484239"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484240"><a href="#local-6989586621681484240"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-623"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484241"><span class="hs-identifier hs-var">mbX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAdd0L"><span class="hs-identifier hs-var">axAdd0L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484240"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484240"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484242"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAdd0R"><span class="hs-identifier hs-var">axAdd0R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484239"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484239"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484243"><a href="#local-6989586621681484243"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484241"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484244"><a href="#local-6989586621681484244"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484242"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-626"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAddDef"><span class="hs-identifier hs-var">axAddDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484239"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484240"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484243"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621681484244"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484241"><a href="#local-6989586621681484241"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484239"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-628"></a><span>        </span><a name="local-6989586621681484242"><a href="#local-6989586621681484242"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484240"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-629"></a><span class="hs-identifier">matchFamAdd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-identifier">matchFamSub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-632"></a><a name="matchFamSub"><a href="TcTypeNats.html#matchFamSub"><span class="hs-identifier">matchFamSub</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484245"><a href="#local-6989586621681484245"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484246"><a href="#local-6989586621681484246"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-633"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484248"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axSub0R"><span class="hs-identifier hs-var">axSub0R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484245"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484245"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484249"><a href="#local-6989586621681484249"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484247"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484250"><a href="#local-6989586621681484250"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484248"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484251"><a href="#local-6989586621681484251"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#minus"><span class="hs-identifier hs-var">minus</span></a><span> </span><a href="#local-6989586621681484249"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484250"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-635"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axSubDef"><span class="hs-identifier hs-var">axSubDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484245"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484246"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484251"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484247"><a href="#local-6989586621681484247"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484245"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-637"></a><span>        </span><a name="local-6989586621681484248"><a href="#local-6989586621681484248"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484246"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-638"></a><span class="hs-identifier">matchFamSub</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span class="hs-identifier">matchFamMul</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-641"></a><a name="matchFamMul"><a href="TcTypeNats.html#matchFamMul"><span class="hs-identifier">matchFamMul</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484252"><a href="#local-6989586621681484252"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484253"><a href="#local-6989586621681484253"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-642"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484254"><span class="hs-identifier hs-var">mbX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMul0L"><span class="hs-identifier hs-var">axMul0L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484253"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484255"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMul0R"><span class="hs-identifier hs-var">axMul0R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484252"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484254"><span class="hs-identifier hs-var">mbX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMul1L"><span class="hs-identifier hs-var">axMul1L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484253"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484253"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484255"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMul1R"><span class="hs-identifier hs-var">axMul1R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484252"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484252"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484256"><a href="#local-6989586621681484256"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484254"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484257"><a href="#local-6989586621681484257"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484255"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-647"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMulDef"><span class="hs-identifier hs-var">axMulDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484252"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484253"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484256"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621681484257"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484254"><a href="#local-6989586621681484254"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484252"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-649"></a><span>        </span><a name="local-6989586621681484255"><a href="#local-6989586621681484255"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484253"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-650"></a><span class="hs-identifier">matchFamMul</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-identifier">matchFamDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-653"></a><a name="matchFamDiv"><a href="TcTypeNats.html#matchFamDiv"><span class="hs-identifier">matchFamDiv</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484258"><a href="#local-6989586621681484258"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484259"><a href="#local-6989586621681484259"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-654"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484261"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axDiv1"><span class="hs-identifier hs-var">axDiv1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484258"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484258"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484262"><a href="#local-6989586621681484262"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484260"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484263"><a href="#local-6989586621681484263"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484261"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484263"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axDivDef"><span class="hs-identifier hs-var">axDivDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484258"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484259"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">div</span><span> </span><a href="#local-6989586621681484262"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484263"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484260"><a href="#local-6989586621681484260"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484258"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-657"></a><span>        </span><a name="local-6989586621681484261"><a href="#local-6989586621681484261"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484259"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-658"></a><span class="hs-identifier">matchFamDiv</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-identifier">matchFamMod</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-661"></a><a name="matchFamMod"><a href="TcTypeNats.html#matchFamMod"><span class="hs-identifier">matchFamMod</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484264"><a href="#local-6989586621681484264"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484265"><a href="#local-6989586621681484265"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-662"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484267"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axMod1"><span class="hs-identifier hs-var">axMod1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484264"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484268"><a href="#local-6989586621681484268"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484266"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484269"><a href="#local-6989586621681484269"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484267"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484269"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axModDef"><span class="hs-identifier hs-var">axModDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484264"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484265"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621681484268"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484269"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484266"><a href="#local-6989586621681484266"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484264"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-665"></a><span>        </span><a name="local-6989586621681484267"><a href="#local-6989586621681484267"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484265"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-666"></a><span class="hs-identifier">matchFamMod</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-667"></a><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span>
</span><a name="line-670"></a><span class="hs-identifier">matchFamExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-671"></a><a name="matchFamExp"><a href="TcTypeNats.html#matchFamExp"><span class="hs-identifier">matchFamExp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484270"><a href="#local-6989586621681484270"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484271"><a href="#local-6989586621681484271"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484273"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axExp0R"><span class="hs-identifier hs-var">axExp0R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484270"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-673"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484272"><span class="hs-identifier hs-var">mbX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axExp1L"><span class="hs-identifier hs-var">axExp1L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484271"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484273"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axExp1R"><span class="hs-identifier hs-var">axExp1R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484270"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484270"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484274"><a href="#local-6989586621681484274"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484272"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484275"><a href="#local-6989586621681484275"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484273"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-676"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axExpDef"><span class="hs-identifier hs-var">axExpDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484270"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484271"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484274"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621681484275"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484272"><a href="#local-6989586621681484272"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484270"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-678"></a><span>        </span><a name="local-6989586621681484273"><a href="#local-6989586621681484273"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484271"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-679"></a><span class="hs-identifier">matchFamExp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-680"></a><span>
</span><a name="line-681"></a><span class="hs-identifier">matchFamLog</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-682"></a><a name="matchFamLog"><a href="TcTypeNats.html#matchFamLog"><span class="hs-identifier">matchFamLog</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484276"><a href="#local-6989586621681484276"><span class="hs-identifier">s</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-683"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484278"><a href="#local-6989586621681484278"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484277"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484279"><a href="#local-6989586621681484279"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#genLog"><span class="hs-identifier hs-var">genLog</span></a><span> </span><a href="#local-6989586621681484278"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axLogDef"><span class="hs-identifier hs-var">axLogDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484276"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484279"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484277"><a href="#local-6989586621681484277"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484276"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-685"></a><span class="hs-identifier">matchFamLog</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span class="hs-identifier">matchFamLeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><a name="matchFamLeq"><a href="TcTypeNats.html#matchFamLeq"><span class="hs-identifier">matchFamLeq</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484280"><a href="#local-6989586621681484280"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484281"><a href="#local-6989586621681484281"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-690"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484282"><span class="hs-identifier hs-var">mbX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axLeq0L"><span class="hs-identifier hs-var">axLeq0L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484281"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484284"><a href="#local-6989586621681484284"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484282"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484285"><a href="#local-6989586621681484285"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484283"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-692"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axLeqDef"><span class="hs-identifier hs-var">axLeqDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484280"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484281"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484284"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621681484285"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-693"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484280"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621681484281"><span class="hs-identifier hs-var">t</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axLeqRefl"><span class="hs-identifier hs-var">axLeqRefl</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484280"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-694"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484282"><a href="#local-6989586621681484282"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484280"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-695"></a><span>        </span><a name="local-6989586621681484283"><a href="#local-6989586621681484283"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484281"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-696"></a><span class="hs-identifier">matchFamLeq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-identifier">matchFamCmpNat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><a name="matchFamCmpNat"><a href="TcTypeNats.html#matchFamCmpNat"><span class="hs-identifier">matchFamCmpNat</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484286"><a href="#local-6989586621681484286"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484287"><a href="#local-6989586621681484287"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-700"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484290"><a href="#local-6989586621681484290"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484288"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484291"><a href="#local-6989586621681484291"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484289"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-701"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axCmpNatDef"><span class="hs-identifier hs-var">axCmpNatDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484286"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484287"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621681484290"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484291"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484286"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621681484287"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axCmpNatRefl"><span class="hs-identifier hs-var">axCmpNatRefl</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484286"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-identifier hs-var">EQ</span><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484288"><a href="#local-6989586621681484288"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484286"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-704"></a><span>        </span><a name="local-6989586621681484289"><a href="#local-6989586621681484289"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484287"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-705"></a><span class="hs-identifier">matchFamCmpNat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-706"></a><span>
</span><a name="line-707"></a><span class="hs-identifier">matchFamCmpSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-708"></a><a name="matchFamCmpSymbol"><a href="TcTypeNats.html#matchFamCmpSymbol"><span class="hs-identifier">matchFamCmpSymbol</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484292"><a href="#local-6989586621681484292"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484293"><a href="#local-6989586621681484293"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-709"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484296"><a href="#local-6989586621681484296"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484294"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484297"><a href="#local-6989586621681484297"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484295"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-710"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axCmpSymbolDef"><span class="hs-identifier hs-var">axCmpSymbolDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484292"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484293"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621681484296"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484297"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484292"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621681484293"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axCmpSymbolRefl"><span class="hs-identifier hs-var">axCmpSymbolRefl</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484292"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcTypeNats.html#ordering"><span class="hs-identifier hs-var">ordering</span></a><span> </span><span class="hs-identifier hs-var">EQ</span><span class="hs-special">)</span><span>
</span><a name="line-712"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484294"><a href="#local-6989586621681484294"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484292"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-713"></a><span>        </span><a name="local-6989586621681484295"><a href="#local-6989586621681484295"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484293"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-714"></a><span class="hs-identifier">matchFamCmpSymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-identifier">matchFamAppendSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoAxiomRule</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-717"></a><a name="matchFamAppendSymbol"><a href="TcTypeNats.html#matchFamAppendSymbol"><span class="hs-identifier">matchFamAppendSymbol</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484298"><a href="#local-6989586621681484298"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484299"><a href="#local-6989586621681484299"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-718"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484302"><a href="#local-6989586621681484302"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484300"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nullFS</span><span> </span><a href="#local-6989586621681484302"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAppendSymbol0R"><span class="hs-identifier hs-var">axAppendSymbol0R</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484299"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484299"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484303"><a href="#local-6989586621681484303"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484301"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nullFS</span><span> </span><a href="#local-6989586621681484303"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAppendSymbol0L"><span class="hs-identifier hs-var">axAppendSymbol0L</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484298"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484298"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-720"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484304"><a href="#local-6989586621681484304"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484300"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484305"><a href="#local-6989586621681484305"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484301"><span class="hs-identifier hs-var">mbY</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-721"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#axAppendSymbolDef"><span class="hs-identifier hs-var">axAppendSymbolDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484298"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621681484299"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">appendFS</span><span> </span><a href="#local-6989586621681484304"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484305"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-723"></a><span>  </span><a name="local-6989586621681484300"><a href="#local-6989586621681484300"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484298"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-724"></a><span>  </span><a name="local-6989586621681484301"><a href="#local-6989586621681484301"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484299"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-725"></a><span class="hs-identifier">matchFamAppendSymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Interact with axioms
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span class="hs-identifier">interactTopAdd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-732"></a><a name="interactTopAdd"><a href="TcTypeNats.html#interactTopAdd"><span class="hs-identifier">interactTopAdd</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484306"><a href="#local-6989586621681484306"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484307"><a href="#local-6989586621681484307"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484308"><a href="#local-6989586621681484308"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-733"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484311"><span class="hs-identifier hs-var">mbZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484306"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484307"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">]</span><span>                          </span><span class="hs-comment">-- (s + t ~ 0) =&gt; (s ~ 0, t ~ 0)</span><span>
</span><a name="line-734"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484312"><a href="#local-6989586621681484312"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484309"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484313"><a href="#local-6989586621681484313"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484311"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484314"><a href="#local-6989586621681484314"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#minus"><span class="hs-identifier hs-var">minus</span></a><span> </span><a href="#local-6989586621681484313"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484312"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484307"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484314"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- (5 + t ~ 8) =&gt; (t ~ 3)</span><span>
</span><a name="line-735"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484315"><a href="#local-6989586621681484315"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484310"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484316"><a href="#local-6989586621681484316"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484311"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484317"><a href="#local-6989586621681484317"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#minus"><span class="hs-identifier hs-var">minus</span></a><span> </span><a href="#local-6989586621681484316"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484315"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484306"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484317"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- (s + 5 ~ 8) =&gt; (s ~ 3)</span><span>
</span><a name="line-736"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-737"></a><span>  </span><a name="local-6989586621681484309"><a href="#local-6989586621681484309"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484306"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-738"></a><span>  </span><a name="local-6989586621681484310"><a href="#local-6989586621681484310"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484307"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-739"></a><span>  </span><a name="local-6989586621681484311"><a href="#local-6989586621681484311"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484308"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-740"></a><span class="hs-identifier">interactTopAdd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-741"></a><span>
</span><a name="line-742"></a><span class="hs-comment">{-
Note [Weakened interaction rule for subtraction]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A simpler interaction here might be:

  `s - t ~ r` --&gt; `t + r ~ s`

This would enable us to reuse all the code for addition.
Unfortunately, this works a little too well at the moment.
Consider the following example:

    0 - 5 ~ r --&gt; 5 + r ~ 0 --&gt; (5 = 0, r = 0)

This (correctly) spots that the constraint cannot be solved.

However, this may be a problem if the constraint did not
need to be solved in the first place!  Consider the following example:

f :: Proxy (If (5 &lt;=? 0) (0 - 5) (5 - 0)) -&gt; Proxy 5
f = id

Currently, GHC is strict while evaluating functions, so this does not
work, because even though the `If` should evaluate to `5 - 0`, we
also evaluate the &quot;then&quot; branch which generates the constraint `0 - 5 ~ r`,
which fails.

So, for the time being, we only add an improvement when the RHS is a constant,
which happens to work OK for the moment, although clearly we need to do
something more general.
-}</span><span>
</span><a name="line-773"></a><span class="hs-identifier">interactTopSub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-774"></a><a name="interactTopSub"><a href="TcTypeNats.html#interactTopSub"><span class="hs-identifier">interactTopSub</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484318"><a href="#local-6989586621681484318"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484319"><a href="#local-6989586621681484319"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484320"><a href="#local-6989586621681484320"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-775"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484322"><a href="#local-6989586621681484322"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484321"><span class="hs-identifier hs-var">mbZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484318"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><span class="hs-special">(</span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484322"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcTypeNats.html#.%2B."><span class="hs-operator hs-var">.+.</span></a><span> </span><a href="#local-6989586621681484319"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- (s - t ~ 5) =&gt; (5 + t ~ s)</span><span>
</span><a name="line-776"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-777"></a><span>  </span><a name="local-6989586621681484321"><a href="#local-6989586621681484321"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484320"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-778"></a><span class="hs-identifier">interactTopSub</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-779"></a><span>
</span><a name="line-780"></a><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-identifier">interactTopMul</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-785"></a><a name="interactTopMul"><a href="TcTypeNats.html#interactTopMul"><span class="hs-identifier">interactTopMul</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484323"><a href="#local-6989586621681484323"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484324"><a href="#local-6989586621681484324"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484325"><a href="#local-6989586621681484325"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-786"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484328"><span class="hs-identifier hs-var">mbZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484323"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484324"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">]</span><span>                        </span><span class="hs-comment">-- (s * t ~ 1)  =&gt; (s ~ 1, t ~ 1)</span><span>
</span><a name="line-787"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484329"><a href="#local-6989586621681484329"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484326"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484330"><a href="#local-6989586621681484330"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484328"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484331"><a href="#local-6989586621681484331"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#divide"><span class="hs-identifier hs-var">divide</span></a><span> </span><a href="#local-6989586621681484330"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484329"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484324"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484331"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- (3 * t ~ 15) =&gt; (t ~ 5)</span><span>
</span><a name="line-788"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484332"><a href="#local-6989586621681484332"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484327"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484333"><a href="#local-6989586621681484333"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484328"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484334"><a href="#local-6989586621681484334"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#divide"><span class="hs-identifier hs-var">divide</span></a><span> </span><a href="#local-6989586621681484333"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484332"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484323"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484334"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- (s * 3 ~ 15) =&gt; (s ~ 5)</span><span>
</span><a name="line-789"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-790"></a><span>  </span><a name="local-6989586621681484326"><a href="#local-6989586621681484326"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484323"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-791"></a><span>  </span><a name="local-6989586621681484327"><a href="#local-6989586621681484327"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484324"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-792"></a><span>  </span><a name="local-6989586621681484328"><a href="#local-6989586621681484328"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484325"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-793"></a><span class="hs-identifier">interactTopMul</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span class="hs-identifier">interactTopDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-796"></a><a name="interactTopDiv"><a href="TcTypeNats.html#interactTopDiv"><span class="hs-identifier">interactTopDiv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- I can't think of anything...</span><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span class="hs-identifier">interactTopMod</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-799"></a><a name="interactTopMod"><a href="TcTypeNats.html#interactTopMod"><span class="hs-identifier">interactTopMod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- I can't think of anything...</span><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span class="hs-identifier">interactTopExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-802"></a><a name="interactTopExp"><a href="TcTypeNats.html#interactTopExp"><span class="hs-identifier">interactTopExp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484335"><a href="#local-6989586621681484335"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484336"><a href="#local-6989586621681484336"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484337"><a href="#local-6989586621681484337"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-803"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484340"><span class="hs-identifier hs-var">mbZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484335"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">]</span><span>                                       </span><span class="hs-comment">-- (s ^ t ~ 0) =&gt; (s ~ 0)</span><span>
</span><a name="line-804"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484341"><a href="#local-6989586621681484341"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484338"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484342"><a href="#local-6989586621681484342"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484340"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484343"><a href="#local-6989586621681484343"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#logExact"><span class="hs-identifier hs-var">logExact</span></a><span>  </span><a href="#local-6989586621681484342"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484341"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484336"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484343"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (2 ^ t ~ 8) =&gt; (t ~ 3)</span><span>
</span><a name="line-805"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484344"><a href="#local-6989586621681484344"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484339"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484345"><a href="#local-6989586621681484345"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484340"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484346"><a href="#local-6989586621681484346"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#rootExact"><span class="hs-identifier hs-var">rootExact</span></a><span> </span><a href="#local-6989586621681484345"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621681484344"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681484335"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621681484346"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (s ^ 2 ~ 9) =&gt; (s ~ 3)</span><span>
</span><a name="line-806"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-807"></a><span>  </span><a name="local-6989586621681484338"><a href="#local-6989586621681484338"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484335"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-808"></a><span>  </span><a name="local-6989586621681484339"><a href="#local-6989586621681484339"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484336"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-809"></a><span>  </span><a name="local-6989586621681484340"><a href="#local-6989586621681484340"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484337"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-810"></a><span class="hs-identifier">interactTopExp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><span class="hs-identifier">interactTopLog</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-813"></a><a name="interactTopLog"><a href="TcTypeNats.html#interactTopLog"><span class="hs-identifier">interactTopLog</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- I can't think of anything...</span><span>
</span><a name="line-814"></a><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-identifier">interactTopLeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-818"></a><a name="interactTopLeq"><a href="TcTypeNats.html#interactTopLeq"><span class="hs-identifier">interactTopLeq</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484347"><a href="#local-6989586621681484347"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484348"><a href="#local-6989586621681484348"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484349"><a href="#local-6989586621681484349"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-819"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484350"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484351"><span class="hs-identifier hs-var">mbZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484347"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#num"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">]</span><span>                     </span><span class="hs-comment">-- (s &lt;= 0) =&gt; (s ~ 0)</span><span>
</span><a name="line-820"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-821"></a><span>  </span><a name="local-6989586621681484350"><a href="#local-6989586621681484350"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNumLitTy</span><span> </span><a href="#local-6989586621681484348"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-822"></a><span>  </span><a name="local-6989586621681484351"><a href="#local-6989586621681484351"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcTypeNats.html#isBoolLitTy"><span class="hs-identifier hs-var">isBoolLitTy</span></a><span> </span><a href="#local-6989586621681484349"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-823"></a><span class="hs-identifier">interactTopLeq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-824"></a><span>
</span><a name="line-825"></a><span class="hs-identifier">interactTopCmpNat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-826"></a><a name="interactTopCmpNat"><a href="TcTypeNats.html#interactTopCmpNat"><span class="hs-identifier">interactTopCmpNat</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484352"><a href="#local-6989586621681484352"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484353"><a href="#local-6989586621681484353"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484354"><a href="#local-6989586621681484354"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-827"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#isOrderingLitTy"><span class="hs-identifier hs-var">isOrderingLitTy</span></a><span> </span><a href="#local-6989586621681484354"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484352"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484353"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-828"></a><span class="hs-identifier">interactTopCmpNat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span class="hs-identifier">interactTopCmpSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-831"></a><a name="interactTopCmpSymbol"><a href="TcTypeNats.html#interactTopCmpSymbol"><span class="hs-identifier">interactTopCmpSymbol</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484355"><a href="#local-6989586621681484355"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484356"><a href="#local-6989586621681484356"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484357"><a href="#local-6989586621681484357"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#isOrderingLitTy"><span class="hs-identifier hs-var">isOrderingLitTy</span></a><span> </span><a href="#local-6989586621681484357"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484355"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484356"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-833"></a><span class="hs-identifier">interactTopCmpSymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><span class="hs-identifier">interactTopAppendSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-836"></a><a name="interactTopAppendSymbol"><a href="TcTypeNats.html#interactTopAppendSymbol"><span class="hs-identifier">interactTopAppendSymbol</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484358"><a href="#local-6989586621681484358"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484359"><a href="#local-6989586621681484359"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484360"><a href="#local-6989586621681484360"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-837"></a><span>  </span><span class="hs-comment">-- (AppendSymbol a b ~ &quot;&quot;) =&gt; (a ~ &quot;&quot;, b ~ &quot;&quot;)</span><span>
</span><a name="line-838"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484364"><a href="#local-6989586621681484364"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681484363"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nullFS</span><span> </span><a href="#local-6989586621681484364"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-839"></a><span>    </span><span class="hs-special">[</span><a href="#local-6989586621681484358"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-identifier hs-var">nilFS</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484359"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-identifier hs-var">nilFS</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-840"></a><span>
</span><a name="line-841"></a><span>  </span><span class="hs-comment">-- (AppendSymbol &quot;foo&quot; b ~ &quot;foobar&quot;) =&gt; (b ~ &quot;bar&quot;)</span><span>
</span><a name="line-842"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484365"><a href="#local-6989586621681484365"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681484361"><span class="hs-identifier hs-var">mbX</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484366"><a href="#local-6989586621681484366"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681484363"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484365"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681484366"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-843"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484359"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681484365"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484366"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span>  </span><span class="hs-comment">-- (AppendSymbol f &quot;bar&quot; ~ &quot;foobar&quot;) =&gt; (f ~ &quot;foo&quot;)</span><span>
</span><a name="line-846"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484367"><a href="#local-6989586621681484367"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681484362"><span class="hs-identifier hs-var">mbY</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681484368"><a href="#local-6989586621681484368"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681484363"><span class="hs-identifier hs-var">mbZ</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681484367"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isSuffixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681484368"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-847"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484359"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><span class="hs-identifier hs-var">mkStrLitTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkFastString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681484368"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681484367"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484368"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-848"></a><span>
</span><a name="line-849"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-850"></a><span>  </span><a name="local-6989586621681484361"><a href="#local-6989586621681484361"><span class="hs-identifier">mbX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484358"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-851"></a><span>  </span><a name="local-6989586621681484362"><a href="#local-6989586621681484362"><span class="hs-identifier">mbY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484359"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-852"></a><span>  </span><a name="local-6989586621681484363"><a href="#local-6989586621681484363"><span class="hs-identifier">mbZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isStrLitTy</span><span> </span><a href="#local-6989586621681484360"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-853"></a><span>
</span><a name="line-854"></a><span class="hs-identifier">interactTopAppendSymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-comment">{-------------------------------------------------------------------------------
Interaction with inerts
-------------------------------------------------------------------------------}</span><span>
</span><a name="line-859"></a><span>
</span><a name="line-860"></a><span class="hs-identifier">interactInertAdd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-861"></a><a name="interactInertAdd"><a href="TcTypeNats.html#interactInertAdd"><span class="hs-identifier">interactInertAdd</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484369"><a href="#local-6989586621681484369"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484370"><a href="#local-6989586621681484370"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484371"><a href="#local-6989586621681484371"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484372"><a href="#local-6989586621681484372"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484373"><a href="#local-6989586621681484373"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484374"><a href="#local-6989586621681484374"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-862"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484375"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484369"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484372"><span class="hs-identifier hs-var">x2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484370"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484373"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-863"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484375"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484370"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484373"><span class="hs-identifier hs-var">y2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484369"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484372"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-864"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484375"><a href="#local-6989586621681484375"><span class="hs-identifier">sameZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484371"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621681484374"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-865"></a><span class="hs-identifier">interactInertAdd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-identifier">interactInertSub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-868"></a><a name="interactInertSub"><a href="TcTypeNats.html#interactInertSub"><span class="hs-identifier">interactInertSub</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484376"><a href="#local-6989586621681484376"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484377"><a href="#local-6989586621681484377"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484378"><a href="#local-6989586621681484378"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484379"><a href="#local-6989586621681484379"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484380"><a href="#local-6989586621681484380"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484381"><a href="#local-6989586621681484381"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-869"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484382"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484376"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484379"><span class="hs-identifier hs-var">x2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484377"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484380"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-870"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484382"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484377"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484380"><span class="hs-identifier hs-var">y2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484376"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484379"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-871"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484382"><a href="#local-6989586621681484382"><span class="hs-identifier">sameZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484378"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621681484381"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-872"></a><span class="hs-identifier">interactInertSub</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-873"></a><span>
</span><a name="line-874"></a><span class="hs-identifier">interactInertMul</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-875"></a><a name="interactInertMul"><a href="TcTypeNats.html#interactInertMul"><span class="hs-identifier">interactInertMul</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484383"><a href="#local-6989586621681484383"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484384"><a href="#local-6989586621681484384"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484385"><a href="#local-6989586621681484385"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484386"><a href="#local-6989586621681484386"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484387"><a href="#local-6989586621681484387"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484388"><a href="#local-6989586621681484388"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-876"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484389"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcTypeNats.html#known"><span class="hs-identifier hs-var">known</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484383"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484383"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484386"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484384"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484387"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-877"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484389"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcTypeNats.html#known"><span class="hs-identifier hs-var">known</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484384"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484384"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484387"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484383"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484386"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-878"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484389"><a href="#local-6989586621681484389"><span class="hs-identifier">sameZ</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484385"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621681484388"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-879"></a><span>
</span><a name="line-880"></a><span class="hs-identifier">interactInertMul</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-881"></a><span>
</span><a name="line-882"></a><span class="hs-identifier">interactInertDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-883"></a><a name="interactInertDiv"><a href="TcTypeNats.html#interactInertDiv"><span class="hs-identifier">interactInertDiv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-884"></a><span>
</span><a name="line-885"></a><span class="hs-identifier">interactInertMod</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-886"></a><a name="interactInertMod"><a href="TcTypeNats.html#interactInertMod"><span class="hs-identifier">interactInertMod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-887"></a><span>
</span><a name="line-888"></a><span class="hs-identifier">interactInertExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-889"></a><a name="interactInertExp"><a href="TcTypeNats.html#interactInertExp"><span class="hs-identifier">interactInertExp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484390"><a href="#local-6989586621681484390"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484391"><a href="#local-6989586621681484391"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484392"><a href="#local-6989586621681484392"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484393"><a href="#local-6989586621681484393"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484394"><a href="#local-6989586621681484394"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484395"><a href="#local-6989586621681484395"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-890"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484396"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcTypeNats.html#known"><span class="hs-identifier hs-var">known</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484390"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484390"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484393"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484391"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484394"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-891"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484396"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TcTypeNats.html#known"><span class="hs-identifier hs-var">known</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681484391"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484391"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484394"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484390"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484393"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-892"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484396"><a href="#local-6989586621681484396"><span class="hs-identifier">sameZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484392"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621681484395"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span class="hs-identifier">interactInertExp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-895"></a><span>
</span><a name="line-896"></a><span class="hs-identifier">interactInertLog</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-897"></a><a name="interactInertLog"><a href="TcTypeNats.html#interactInertLog"><span class="hs-identifier">interactInertLog</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-898"></a><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span class="hs-identifier">interactInertLeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-901"></a><a name="interactInertLeq"><a href="TcTypeNats.html#interactInertLeq"><span class="hs-identifier">interactInertLeq</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484397"><a href="#local-6989586621681484397"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484398"><a href="#local-6989586621681484398"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484399"><a href="#local-6989586621681484399"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484400"><a href="#local-6989586621681484400"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484401"><a href="#local-6989586621681484401"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484402"><a href="#local-6989586621681484402"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-902"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484403"><span class="hs-identifier hs-var">bothTrue</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484397"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484401"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484398"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484400"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484397"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484398"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-903"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484403"><span class="hs-identifier hs-var">bothTrue</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484398"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484400"><span class="hs-identifier hs-var">x2</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484397"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3C%3D%3D"><span class="hs-operator hs-var">&lt;==</span></a><span> </span><a href="#local-6989586621681484401"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-904"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484403"><span class="hs-identifier hs-var">bothTrue</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484401"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621681484397"><span class="hs-identifier hs-var">x1</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484400"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="TcTypeNats.html#%3C%3D%3D"><span class="hs-operator hs-var">&lt;==</span></a><span> </span><a href="#local-6989586621681484398"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="TcTypeNats.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-905"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484403"><a href="#local-6989586621681484403"><span class="hs-identifier">bothTrue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#isBoolLitTy"><span class="hs-identifier hs-var">isBoolLitTy</span></a><span> </span><a href="#local-6989586621681484399"><span class="hs-identifier hs-var">z1</span></a><span>
</span><a name="line-906"></a><span>                               </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#isBoolLitTy"><span class="hs-identifier hs-var">isBoolLitTy</span></a><span> </span><a href="#local-6989586621681484402"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-907"></a><span>                               </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span class="hs-identifier">interactInertLeq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-910"></a><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span class="hs-identifier">interactInertAppendSymbol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Xi</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Xi</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Pair</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-913"></a><a name="interactInertAppendSymbol"><a href="TcTypeNats.html#interactInertAppendSymbol"><span class="hs-identifier">interactInertAppendSymbol</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484404"><a href="#local-6989586621681484404"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484405"><a href="#local-6989586621681484405"><span class="hs-identifier">y1</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484406"><a href="#local-6989586621681484406"><span class="hs-identifier">z1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621681484407"><a href="#local-6989586621681484407"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484408"><a href="#local-6989586621681484408"><span class="hs-identifier">y2</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621681484409"><a href="#local-6989586621681484409"><span class="hs-identifier">z2</span></a></a><span>
</span><a name="line-914"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484410"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484404"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621681484407"><span class="hs-identifier hs-var">x2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484405"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484408"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484410"><span class="hs-identifier hs-var">sameZ</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484405"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621681484408"><span class="hs-identifier hs-var">y2</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681484404"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="TcTypeNats.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span> </span><a href="#local-6989586621681484407"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-916"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681484410"><a href="#local-6989586621681484410"><span class="hs-identifier">sameZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcEqType</span><span> </span><a href="#local-6989586621681484406"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621681484409"><span class="hs-identifier hs-var">z2</span></a><span>
</span><a name="line-917"></a><span class="hs-identifier">interactInertAppendSymbol</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span class="hs-comment">{- -----------------------------------------------------------------------------
These inverse functions are used for simplifying propositions using
concrete natural numbers.
----------------------------------------------------------------------------- -}</span><span>
</span><a name="line-925"></a><span>
</span><a name="line-926"></a><span class="hs-comment">-- | Subtract two natural numbers.</span><span>
</span><a name="line-927"></a><span class="hs-identifier">minus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-928"></a><a name="minus"><a href="TcTypeNats.html#minus"><span class="hs-identifier">minus</span></a></a><span> </span><a name="local-6989586621681484411"><a href="#local-6989586621681484411"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484412"><a href="#local-6989586621681484412"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621681484411"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621681484412"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484411"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621681484412"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-929"></a><span>
</span><a name="line-930"></a><span class="hs-comment">-- | Compute the exact logarithm of a natural number.</span><span>
</span><a name="line-931"></a><span class="hs-comment">-- The logarithm base is the second argument.</span><span>
</span><a name="line-932"></a><span class="hs-identifier">logExact</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-933"></a><a name="logExact"><a href="TcTypeNats.html#logExact"><span class="hs-identifier">logExact</span></a></a><span> </span><a name="local-6989586621681484413"><a href="#local-6989586621681484413"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484414"><a href="#local-6989586621681484414"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484415"><a href="#local-6989586621681484415"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#genLog"><span class="hs-identifier hs-var">genLog</span></a><span> </span><a href="#local-6989586621681484413"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484414"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-934"></a><span>                  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484415"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-935"></a><span>
</span><a name="line-936"></a><span>
</span><a name="line-937"></a><span class="hs-comment">-- | Divide two natural numbers.</span><span>
</span><a name="line-938"></a><span class="hs-identifier">divide</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-939"></a><a name="divide"><a href="TcTypeNats.html#divide"><span class="hs-identifier">divide</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-940"></a><span class="hs-identifier">divide</span><span> </span><a name="local-6989586621681484416"><a href="#local-6989586621681484416"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484417"><a href="#local-6989586621681484417"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">divMod</span><span> </span><a href="#local-6989586621681484416"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484417"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-941"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621681484418"><a href="#local-6989586621681484418"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681484418"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-942"></a><span>                </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-943"></a><span>
</span><a name="line-944"></a><span class="hs-comment">-- | Compute the exact root of a natural number.</span><span>
</span><a name="line-945"></a><span class="hs-comment">-- The second argument specifies which root we are computing.</span><span>
</span><a name="line-946"></a><span class="hs-identifier">rootExact</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-947"></a><a name="rootExact"><a href="TcTypeNats.html#rootExact"><span class="hs-identifier">rootExact</span></a></a><span> </span><a name="local-6989586621681484419"><a href="#local-6989586621681484419"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484420"><a href="#local-6989586621681484420"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681484421"><a href="#local-6989586621681484421"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcTypeNats.html#genRoot"><span class="hs-identifier hs-var">genRoot</span></a><span> </span><a href="#local-6989586621681484419"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484420"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-948"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681484421"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-949"></a><span>
</span><a name="line-950"></a><span>
</span><a name="line-951"></a><span>
</span><a name="line-952"></a><span class="hs-comment">{- | Compute the n-th root of a natural number, rounded down to
the closest natural number.  The boolean indicates if the result
is exact (i.e., True means no rounding was done, False means rounded down).
The second argument specifies which root we are computing. -}</span><span>
</span><a name="line-956"></a><span class="hs-identifier">genRoot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-957"></a><a name="genRoot"><a href="TcTypeNats.html#genRoot"><span class="hs-identifier">genRoot</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-958"></a><span class="hs-identifier">genRoot</span><span> </span><a name="local-6989586621681484422"><a href="#local-6989586621681484422"><span class="hs-identifier">x0</span></a></a><span> </span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484422"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span class="hs-identifier">genRoot</span><span> </span><a name="local-6989586621681484423"><a href="#local-6989586621681484423"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621681484424"><a href="#local-6989586621681484424"><span class="hs-identifier">root</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484425"><span class="hs-identifier hs-var">search</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484423"><span class="hs-identifier hs-var">x0</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-960"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-961"></a><span>  </span><a name="local-6989586621681484425"><a href="#local-6989586621681484425"><span class="hs-identifier">search</span></a></a><span> </span><a name="local-6989586621681484426"><a href="#local-6989586621681484426"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621681484427"><a href="#local-6989586621681484427"><span class="hs-identifier">to</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681484428"><a href="#local-6989586621681484428"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">div</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484427"><span class="hs-identifier hs-var">to</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-962"></a><span>                       </span><a name="local-6989586621681484429"><a href="#local-6989586621681484429"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621681484424"><span class="hs-identifier hs-var">root</span></a><span>
</span><a name="line-963"></a><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621681484429"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681484423"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-964"></a><span>                        </span><span class="hs-identifier hs-var">EQ</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-965"></a><span>                        </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681484425"><span class="hs-identifier hs-var">search</span></a><span> </span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681484427"><span class="hs-identifier hs-var">to</span></a><span>
</span><a name="line-966"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>                        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621681484427"><span class="hs-identifier hs-var">to</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681484425"><span class="hs-identifier hs-var">search</span></a><span> </span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span> </span><a href="#local-6989586621681484428"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-968"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484426"><span class="hs-identifier hs-var">from</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-969"></a><span>
</span><a name="line-970"></a><span class="hs-comment">{- | Compute the logarithm of a number in the given base, rounded down to the
closest integer.  The boolean indicates if we the result is exact
(i.e., True means no rounding happened, False means we rounded down).
The logarithm base is the second argument. -}</span><span>
</span><a name="line-974"></a><span class="hs-identifier">genLog</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-975"></a><a name="genLog"><a href="TcTypeNats.html#genLog"><span class="hs-identifier">genLog</span></a></a><span> </span><a name="local-6989586621681484430"><a href="#local-6989586621681484430"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621681484430"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-976"></a><span class="hs-identifier">genLog</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-977"></a><span class="hs-identifier">genLog</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-978"></a><span class="hs-identifier">genLog</span><span> </span><a name="local-6989586621681484431"><a href="#local-6989586621681484431"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681484432"><a href="#local-6989586621681484432"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484433"><span class="hs-identifier hs-var">exactLoop</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621681484431"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-979"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-980"></a><span>  </span><a name="local-6989586621681484433"><a href="#local-6989586621681484433"><span class="hs-identifier">exactLoop</span></a></a><span> </span><a name="local-6989586621681484435"><a href="#local-6989586621681484435"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484436"><a href="#local-6989586621681484436"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-981"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484436"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484435"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-982"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484436"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621681484432"><span class="hs-identifier hs-var">base</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484435"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-983"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-984"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681484437"><a href="#local-6989586621681484437"><span class="hs-identifier">s1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681484435"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-985"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621681484437"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">divMod</span><span> </span><a href="#local-6989586621681484436"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621681484432"><span class="hs-identifier hs-var">base</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-986"></a><span>                      </span><span class="hs-special">(</span><a name="local-6989586621681484438"><a href="#local-6989586621681484438"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><a name="local-6989586621681484439"><a href="#local-6989586621681484439"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-987"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484439"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681484433"><span class="hs-identifier hs-var">exactLoop</span></a><span> </span><a href="#local-6989586621681484437"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621681484438"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-988"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681484434"><span class="hs-identifier hs-var">underLoop</span></a><span> </span><a href="#local-6989586621681484437"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621681484438"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span>  </span><a name="local-6989586621681484434"><a href="#local-6989586621681484434"><span class="hs-identifier">underLoop</span></a></a><span> </span><a name="local-6989586621681484440"><a href="#local-6989586621681484440"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621681484441"><a href="#local-6989586621681484441"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-991"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681484441"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621681484432"><span class="hs-identifier hs-var">base</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681484440"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-992"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681484442"><a href="#local-6989586621681484442"><span class="hs-identifier">s1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681484440"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621681484442"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681484434"><span class="hs-identifier hs-var">underLoop</span></a><span> </span><a href="#local-6989586621681484442"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">div</span><span> </span><a href="#local-6989586621681484441"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621681484432"><span class="hs-identifier hs-var">base</span></a><span class="hs-special">)</span><span>
</span><a name="line-993"></a></pre></body></html>