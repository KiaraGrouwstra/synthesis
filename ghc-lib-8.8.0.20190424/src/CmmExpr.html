<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CmmExpr</span><span>
</span><a name="line-8"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#maybeInvertCmmExpr"><span class="hs-identifier hs-var">maybeInvertCmmExpr</span></a><span>
</span><a name="line-9"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cmmRegWidth"><span class="hs-identifier hs-var">cmmRegWidth</span></a><span>
</span><a name="line-10"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a><span>
</span><a name="line-11"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#isArgReg"><span class="hs-identifier hs-var">isArgReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#globalRegType"><span class="hs-identifier hs-var">globalRegType</span></a><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#spReg"><span class="hs-identifier hs-var">spReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#hpReg"><span class="hs-identifier hs-var">hpReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#spLimReg"><span class="hs-identifier hs-var">spLimReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#hpLimReg"><span class="hs-identifier hs-var">hpLimReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#nodeReg"><span class="hs-identifier hs-var">nodeReg</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#currentTSOReg"><span class="hs-identifier hs-var">currentTSOReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#currentNurseryReg"><span class="hs-identifier hs-var">currentNurseryReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#hpAllocReg"><span class="hs-identifier hs-var">hpAllocReg</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#cccsReg"><span class="hs-identifier hs-var">cccsReg</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#node"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#baseReg"><span class="hs-identifier hs-var">baseReg</span></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier hs-type">VGcPtr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier hs-var">foldRegsDefd</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#foldLocalRegsDefd"><span class="hs-identifier hs-var">foldLocalRegsDefd</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#foldLocalRegsUsed"><span class="hs-identifier hs-var">foldLocalRegsUsed</span></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#LocalRegSet"><span class="hs-identifier hs-type">LocalRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#GlobalRegSet"><span class="hs-identifier hs-type">GlobalRegSet</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#emptyRegSet"><span class="hs-identifier hs-var">emptyRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#elemRegSet"><span class="hs-identifier hs-var">elemRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#extendRegSet"><span class="hs-identifier hs-var">extendRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#deleteFromRegSet"><span class="hs-identifier hs-var">deleteFromRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#mkRegSet"><span class="hs-identifier hs-var">mkRegSet</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#plusRegSet"><span class="hs-identifier hs-var">plusRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#minusRegSet"><span class="hs-identifier hs-var">minusRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#timesRegSet"><span class="hs-identifier hs-var">timesRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#sizeRegSet"><span class="hs-identifier hs-var">sizeRegSet</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#nullRegSet"><span class="hs-identifier hs-var">nullRegSet</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#regSetToList"><span class="hs-identifier hs-var">regSetToList</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#Area"><span class="hs-identifier hs-type">Area</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="CmmMachOp.html"><span class="hs-identifier">CmmMachOp</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CmmType</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="BlockId.html"><span class="hs-identifier">BlockId</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="CLabel.html"><span class="hs-identifier">CLabel</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="CmmMachOp.html"><span class="hs-identifier">CmmMachOp</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CmmType</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">panic</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-47"></a><span class="hs-comment">--              CmmExpr</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- An expression.  Expressions have no side effects.</span><span>
</span><a name="line-49"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">data</span><span> </span><a name="CmmExpr"><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier">CmmExpr</span></a></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CmmLit"><a href="CmmExpr.html#CmmLit"><span class="hs-identifier">CmmLit</span></a></a><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span>               </span><span class="hs-comment">-- Literal</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmLoad"><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier">CmmLoad</span></a></a><span> </span><span class="hs-glyph">!</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">CmmType</span><span>   </span><span class="hs-comment">-- Read memory location</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmReg"><a href="CmmExpr.html#CmmReg"><span class="hs-identifier">CmmReg</span></a></a><span> </span><span class="hs-glyph">!</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span>              </span><span class="hs-comment">-- Contents of register</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmMachOp"><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier">CmmMachOp</span></a></a><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Machine operation (+, -, *, etc.)</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmStackSlot"><a href="CmmExpr.html#CmmStackSlot"><span class="hs-identifier">CmmStackSlot</span></a></a><span> </span><a href="CmmExpr.html#Area"><span class="hs-identifier hs-type">Area</span></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-57"></a><span>                                </span><span class="hs-comment">-- addressing expression of a stack slot</span><span>
</span><a name="line-58"></a><span>                                </span><span class="hs-comment">-- See Note [CmmStackSlot aliasing]</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmRegOff"><a href="CmmExpr.html#CmmRegOff"><span class="hs-identifier">CmmRegOff</span></a></a><span> </span><span class="hs-glyph">!</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-60"></a><span>        </span><span class="hs-comment">-- CmmRegOff reg i</span><span>
</span><a name="line-61"></a><span>        </span><span class="hs-comment">--        ** is shorthand only, meaning **</span><span>
</span><a name="line-62"></a><span>        </span><span class="hs-comment">-- CmmMachOp (MO_Add rep) [x, CmmLit (CmmInt (fromIntegral i) rep)]</span><span>
</span><a name="line-63"></a><span>        </span><span class="hs-comment">--      where rep = typeWidth (cmmRegType reg)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-keyword">where</span><span>       </span><span class="hs-comment">-- Equality ignores the types</span><span>
</span><a name="line-66"></a><span>  </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><a name="local-6989586621679873747"><a href="#local-6989586621679873747"><span class="hs-identifier">l1</span></a></a><span>          </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><a name="local-6989586621679873748"><a href="#local-6989586621679873748"><span class="hs-identifier">l2</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873747"><span class="hs-identifier hs-var">l1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873748"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-67"></a><span>  </span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><a name="local-6989586621679873749"><a href="#local-6989586621679873749"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><a name="local-6989586621679873750"><a href="#local-6989586621679873750"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873749"><span class="hs-identifier hs-var">e1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873750"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-68"></a><span>  </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a name="local-6989586621679873751"><a href="#local-6989586621679873751"><span class="hs-identifier">r1</span></a></a><span>          </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a name="local-6989586621679873752"><a href="#local-6989586621679873752"><span class="hs-identifier">r2</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873751"><span class="hs-identifier hs-var">r1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873752"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-69"></a><span>  </span><a href="CmmExpr.html#CmmRegOff"><span class="hs-identifier hs-var">CmmRegOff</span></a><span> </span><a name="local-6989586621679873753"><a href="#local-6989586621679873753"><span class="hs-identifier">r1</span></a></a><span> </span><a name="local-6989586621679873754"><a href="#local-6989586621679873754"><span class="hs-identifier">i1</span></a></a><span>    </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CmmRegOff"><span class="hs-identifier hs-var">CmmRegOff</span></a><span> </span><a name="local-6989586621679873755"><a href="#local-6989586621679873755"><span class="hs-identifier">r2</span></a></a><span> </span><a name="local-6989586621679873756"><a href="#local-6989586621679873756"><span class="hs-identifier">i2</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873753"><span class="hs-identifier hs-var">r1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873755"><span class="hs-identifier hs-var">r2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679873754"><span class="hs-identifier hs-var">i1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873756"><span class="hs-identifier hs-var">i2</span></a><span>
</span><a name="line-70"></a><span>  </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a name="local-6989586621679873757"><a href="#local-6989586621679873757"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621679873758"><a href="#local-6989586621679873758"><span class="hs-identifier">es1</span></a></a><span>  </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a name="local-6989586621679873759"><a href="#local-6989586621679873759"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621679873760"><a href="#local-6989586621679873760"><span class="hs-identifier">es2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873757"><span class="hs-identifier hs-var">op1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873759"><span class="hs-identifier hs-var">op2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679873758"><span class="hs-identifier hs-var">es1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873760"><span class="hs-identifier hs-var">es2</span></a><span>
</span><a name="line-71"></a><span>  </span><a href="CmmExpr.html#CmmStackSlot"><span class="hs-identifier hs-var">CmmStackSlot</span></a><span> </span><a name="local-6989586621679873761"><a href="#local-6989586621679873761"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679873762"><a href="#local-6989586621679873762"><span class="hs-identifier">i1</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CmmStackSlot"><span class="hs-identifier hs-var">CmmStackSlot</span></a><span> </span><a name="local-6989586621679873763"><a href="#local-6989586621679873763"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679873764"><a href="#local-6989586621679873764"><span class="hs-identifier">i2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873761"><span class="hs-identifier hs-var">a1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873763"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679873762"><span class="hs-identifier hs-var">i1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873764"><span class="hs-identifier hs-var">i2</span></a><span>
</span><a name="line-72"></a><span>  </span><a name="local-6989586621679873765"><a href="#local-6989586621679873765"><span class="hs-identifier">_e1</span></a></a><span>                </span><span class="hs-operator">==</span><span> </span><a name="local-6989586621679873766"><a href="#local-6989586621679873766"><span class="hs-identifier">_e2</span></a></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">data</span><span> </span><a name="CmmReg"><a href="CmmExpr.html#CmmReg"><span class="hs-identifier">CmmReg</span></a></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CmmLocal"><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier">CmmLocal</span></a></a><span>  </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmGlobal"><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier">CmmGlobal</span></a></a><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span>
</span><a name="line-77"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | A stack area is either the stack slot where a variable is spilled</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- or the stack space where function arguments and results are passed.</span><span>
</span><a name="line-81"></a><span class="hs-keyword">data</span><span> </span><a name="Area"><a href="CmmExpr.html#Area"><span class="hs-identifier">Area</span></a></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Old"><a href="CmmExpr.html#Old"><span class="hs-identifier">Old</span></a></a><span>            </span><span class="hs-comment">-- See Note [Old Area]</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Young"><a href="CmmExpr.html#Young"><span class="hs-identifier">Young</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>  </span><span class="hs-comment">-- Invariant: must be a continuation BlockId</span><span>
</span><a name="line-84"></a><span>                   </span><span class="hs-comment">-- See Note [Continuation BlockId] in CmmNode.</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">{- Note [Old Area]
~~~~~~~~~~~~~~~~~~
There is a single call area 'Old', allocated at the extreme old
end of the stack frame (ie just younger than the return address)
which holds:
  * incoming (overflow) parameters,
  * outgoing (overflow) parameter to tail calls,
  * outgoing (overflow) result values
  * the update frame (if any)

Its size is the max of all these requirements.  On entry, the stack
pointer will point to the youngest incoming parameter, which is not
necessarily at the young end of the Old area.

End of note -}</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">{- Note [CmmStackSlot aliasing]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When do two CmmStackSlots alias?

 - T[old+N] aliases with U[young(L)+M] for all T, U, L, N and M
 - T[old+N] aliases with U[old+M] only if the areas actually overlap

Or more informally, different Areas may overlap with each other.

An alternative semantics, that we previously had, was that different
Areas do not overlap.  The problem that lead to redefining the
semantics of stack areas is described below.

e.g. if we had

    x = Sp[old + 8]
    y = Sp[old + 16]

    Sp[young(L) + 8]  = L
    Sp[young(L) + 16] = y
    Sp[young(L) + 24] = x
    call f() returns to L

if areas semantically do not overlap, then we might optimise this to

    Sp[young(L) + 8]  = L
    Sp[young(L) + 16] = Sp[old + 8]
    Sp[young(L) + 24] = Sp[old + 16]
    call f() returns to L

and now young(L) cannot be allocated at the same place as old, and we
are doomed to use more stack.

  - old+8  conflicts with young(L)+8
  - old+16 conflicts with young(L)+16 and young(L)+8

so young(L)+8 == old+24 and we get

    Sp[-8]  = L
    Sp[-16] = Sp[8]
    Sp[-24] = Sp[0]
    Sp -= 24
    call f() returns to L

However, if areas are defined to be &quot;possibly overlapping&quot; in the
semantics, then we cannot commute any loads/stores of old with
young(L), and we will be able to re-use both old+8 and old+16 for
young(L).

    x = Sp[8]
    y = Sp[0]

    Sp[8] = L
    Sp[0] = y
    Sp[-8] = x
    Sp = Sp - 8
    call f() returns to L

Now, the assignments of y go away,

    x = Sp[8]
    Sp[8] = L
    Sp[-8] = x
    Sp = Sp - 8
    call f() returns to L
-}</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-keyword">data</span><span> </span><a name="CmmLit"><a href="CmmExpr.html#CmmLit"><span class="hs-identifier">CmmLit</span></a></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="CmmInt"><a href="CmmExpr.html#CmmInt"><span class="hs-identifier">CmmInt</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Integer</span><span>  </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-173"></a><span>        </span><span class="hs-comment">-- Interpretation: the 2's complement representation of the value</span><span>
</span><a name="line-174"></a><span>        </span><span class="hs-comment">-- is truncated to the specified size.  This is easier than trying</span><span>
</span><a name="line-175"></a><span>        </span><span class="hs-comment">-- to keep the value within range, because we don't know whether</span><span>
</span><a name="line-176"></a><span>        </span><span class="hs-comment">-- it will be used as a signed or unsigned value (the CmmType doesn't</span><span>
</span><a name="line-177"></a><span>        </span><span class="hs-comment">-- distinguish between signed &amp; unsigned).</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmFloat"><a href="CmmExpr.html#CmmFloat"><span class="hs-identifier">CmmFloat</span></a></a><span>  </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmVec"><a href="CmmExpr.html#CmmVec"><span class="hs-identifier">CmmVec</span></a></a><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span class="hs-special">]</span><span>                     </span><span class="hs-comment">-- Vector literal</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmLabel"><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier">CmmLabel</span></a></a><span>    </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span>                  </span><span class="hs-comment">-- Address of label</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmLabelOff"><a href="CmmExpr.html#CmmLabelOff"><span class="hs-identifier">CmmLabelOff</span></a></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>              </span><span class="hs-comment">-- Address of label + byte offset</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>        </span><span class="hs-comment">-- Due to limitations in the C backend, the following</span><span>
</span><a name="line-184"></a><span>        </span><span class="hs-comment">-- MUST ONLY be used inside the info table indicated by label2</span><span>
</span><a name="line-185"></a><span>        </span><span class="hs-comment">-- (label2 must be the info label), and label1 must be an</span><span>
</span><a name="line-186"></a><span>        </span><span class="hs-comment">-- SRT, a slow entrypoint or a large bitmap (see the Mangler)</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- Don't use it at all unless tablesNextToCode.</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-comment">-- It is also used inside the NCG during when generating</span><span>
</span><a name="line-189"></a><span>        </span><span class="hs-comment">-- position-independent code.</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmLabelDiffOff"><a href="CmmExpr.html#CmmLabelDiffOff"><span class="hs-identifier">CmmLabelDiffOff</span></a></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-comment">-- label1 - label2 + offset</span><span>
</span><a name="line-191"></a><span>        </span><span class="hs-comment">-- In an expression, the width just has the effect of MO_SS_Conv</span><span>
</span><a name="line-192"></a><span>        </span><span class="hs-comment">-- from wordWidth to the desired width.</span><span>
</span><a name="line-193"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-comment">-- In a static literal, the supported Widths depend on the</span><span>
</span><a name="line-195"></a><span>        </span><span class="hs-comment">-- architecture: wordWidth is supported on all</span><span>
</span><a name="line-196"></a><span>        </span><span class="hs-comment">-- architectures. Additionally W32 is supported on x86_64 when</span><span>
</span><a name="line-197"></a><span>        </span><span class="hs-comment">-- using the small memory model.</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmBlock"><a href="CmmExpr.html#CmmBlock"><span class="hs-identifier">CmmBlock</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>     </span><span class="hs-comment">-- Code label</span><span>
</span><a name="line-200"></a><span>        </span><span class="hs-comment">-- Invariant: must be a continuation BlockId</span><span>
</span><a name="line-201"></a><span>        </span><span class="hs-comment">-- See Note [Continuation BlockId] in CmmNode.</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CmmHighStackMark"><a href="CmmExpr.html#CmmHighStackMark"><span class="hs-identifier">CmmHighStackMark</span></a></a><span> </span><span class="hs-comment">-- A late-bound constant that stands for the max</span><span>
</span><a name="line-204"></a><span>                     </span><span class="hs-comment">-- #bytes of stack space used during a procedure.</span><span>
</span><a name="line-205"></a><span>                     </span><span class="hs-comment">-- During the stack-layout pass, CmmHighStackMark</span><span>
</span><a name="line-206"></a><span>                     </span><span class="hs-comment">-- is replaced by a CmmInt for the actual number</span><span>
</span><a name="line-207"></a><span>                     </span><span class="hs-comment">-- of bytes used</span><span>
</span><a name="line-208"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-identifier">cmmExprType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-211"></a><a name="cmmExprType"><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier">cmmExprType</span></a></a><span> </span><a name="local-6989586621679873780"><a href="#local-6989586621679873780"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><a name="local-6989586621679873781"><a href="#local-6989586621679873781"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a><span> </span><a href="#local-6989586621679873780"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873781"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-212"></a><span class="hs-identifier">cmmExprType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873782"><a href="#local-6989586621679873782"><span class="hs-identifier">rep</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873782"><span class="hs-identifier hs-var">rep</span></a><span>
</span><a name="line-213"></a><span class="hs-identifier">cmmExprType</span><span> </span><a name="local-6989586621679873783"><a href="#local-6989586621679873783"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a name="local-6989586621679873784"><a href="#local-6989586621679873784"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a><span> </span><a href="#local-6989586621679873783"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873784"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-214"></a><span class="hs-identifier">cmmExprType</span><span> </span><a name="local-6989586621679873785"><a href="#local-6989586621679873785"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a name="local-6989586621679873786"><a href="#local-6989586621679873786"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679873787"><a href="#local-6989586621679873787"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmMachOp.html#machOpResultType"><span class="hs-identifier hs-var">machOpResultType</span></a><span> </span><a href="#local-6989586621679873785"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873786"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621679873785"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679873787"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span class="hs-identifier">cmmExprType</span><span> </span><a name="local-6989586621679873788"><a href="#local-6989586621679873788"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmRegOff"><span class="hs-identifier hs-var">CmmRegOff</span></a><span> </span><a name="local-6989586621679873789"><a href="#local-6989586621679873789"><span class="hs-identifier">reg</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a><span> </span><a href="#local-6989586621679873788"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873789"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-216"></a><span class="hs-identifier">cmmExprType</span><span> </span><a name="local-6989586621679873790"><a href="#local-6989586621679873790"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmStackSlot"><span class="hs-identifier hs-var">CmmStackSlot</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873790"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-comment">-- an address</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- Careful though: what is stored at the stack slot may be bigger than</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- an address</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-identifier">cmmLitType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-221"></a><a name="cmmLitType"><a href="CmmExpr.html#cmmLitType"><span class="hs-identifier">cmmLitType</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873791"><a href="#local-6989586621679873791"><span class="hs-identifier">width</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmBits</span><span>  </span><a href="#local-6989586621679873791"><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-222"></a><span class="hs-identifier">cmmLitType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmFloat"><span class="hs-identifier hs-var">CmmFloat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873792"><a href="#local-6989586621679873792"><span class="hs-identifier">width</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmFloat</span><span> </span><a href="#local-6989586621679873792"><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-223"></a><span class="hs-identifier">cmmLitType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;cmmLitType: CmmVec []&quot;</span><span>
</span><a name="line-224"></a><span class="hs-identifier">cmmLitType</span><span> </span><a name="local-6989586621679873793"><a href="#local-6989586621679873793"><span class="hs-identifier">cflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679873794"><a href="#local-6989586621679873794"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679873795"><a href="#local-6989586621679873795"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679873796"><a href="#local-6989586621679873796"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a><span> </span><a href="#local-6989586621679873793"><span class="hs-identifier hs-var">cflags</span></a><span> </span><a href="#local-6989586621679873794"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-225"></a><span>                                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">cmmEqType</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679873796"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a><span> </span><a href="#local-6989586621679873793"><span class="hs-identifier hs-var">cflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679873795"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>                                            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">cmmVec</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">+</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679873795"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679873796"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-227"></a><span>                                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;cmmLitType: CmmVec&quot;</span><span>
</span><a name="line-228"></a><span class="hs-identifier">cmmLitType</span><span> </span><a name="local-6989586621679873797"><a href="#local-6989586621679873797"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a name="local-6989586621679873798"><a href="#local-6989586621679873798"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmLabelType"><span class="hs-identifier hs-var">cmmLabelType</span></a><span> </span><a href="#local-6989586621679873797"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873798"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-229"></a><span class="hs-identifier">cmmLitType</span><span> </span><a name="local-6989586621679873799"><a href="#local-6989586621679873799"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabelOff"><span class="hs-identifier hs-var">CmmLabelOff</span></a><span> </span><a name="local-6989586621679873800"><a href="#local-6989586621679873800"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmLabelType"><span class="hs-identifier hs-var">cmmLabelType</span></a><span> </span><a href="#local-6989586621679873799"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873800"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-230"></a><span class="hs-identifier">cmmLitType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873801"><a href="#local-6989586621679873801"><span class="hs-identifier">width</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmBits</span><span> </span><a href="#local-6989586621679873801"><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-231"></a><span class="hs-identifier">cmmLitType</span><span> </span><a name="local-6989586621679873802"><a href="#local-6989586621679873802"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmBlock"><span class="hs-identifier hs-var">CmmBlock</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873802"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-232"></a><span class="hs-identifier">cmmLitType</span><span> </span><a name="local-6989586621679873803"><a href="#local-6989586621679873803"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmHighStackMark"><span class="hs-identifier hs-var">CmmHighStackMark</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873803"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">cmmLabelType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-235"></a><a name="cmmLabelType"><a href="CmmExpr.html#cmmLabelType"><span class="hs-identifier">cmmLabelType</span></a></a><span> </span><a name="local-6989586621679873804"><a href="#local-6989586621679873804"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679873805"><a href="#local-6989586621679873805"><span class="hs-identifier">lbl</span></a></a><span>
</span><a name="line-236"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="CLabel.html#isGcPtrLabel"><span class="hs-identifier hs-var">isGcPtrLabel</span></a><span> </span><a href="#local-6989586621679873805"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621679873804"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-237"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873804"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">cmmExprWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-240"></a><a name="cmmExprWidth"><a href="CmmExpr.html#cmmExprWidth"><span class="hs-identifier">cmmExprWidth</span></a></a><span> </span><a name="local-6989586621679873806"><a href="#local-6989586621679873806"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679873807"><a href="#local-6989586621679873807"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621679873806"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873807"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">--------</span><span>
</span><a name="line-243"></a><span class="hs-comment">--- Negation for conditional branches</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-identifier">maybeInvertCmmExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-246"></a><a name="maybeInvertCmmExpr"><a href="CmmExpr.html#maybeInvertCmmExpr"><span class="hs-identifier">maybeInvertCmmExpr</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a name="local-6989586621679873808"><a href="#local-6989586621679873808"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679873809"><a href="#local-6989586621679873809"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679873810"><a href="#local-6989586621679873810"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CmmMachOp.html#maybeInvertComparison"><span class="hs-identifier hs-var">maybeInvertComparison</span></a><span> </span><a href="#local-6989586621679873808"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-247"></a><span>                                            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621679873810"><span class="hs-identifier hs-var">op'</span></a><span> </span><a href="#local-6989586621679873809"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span class="hs-identifier">maybeInvertCmmExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-251"></a><span class="hs-comment">--              Local registers</span><span>
</span><a name="line-252"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-keyword">data</span><span> </span><a name="LocalReg"><a href="CmmExpr.html#LocalReg"><span class="hs-identifier">LocalReg</span></a></a><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LocalReg"><a href="CmmExpr.html#LocalReg"><span class="hs-identifier">LocalReg</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Unique</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-comment">-- ^ Parameters:</span><span>
</span><a name="line-257"></a><span>    </span><span class="hs-comment">--   1. Identifier</span><span>
</span><a name="line-258"></a><span>    </span><span class="hs-comment">--   2. Type</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-261"></a><span>  </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><a name="local-6989586621679873745"><a href="#local-6989586621679873745"><span class="hs-identifier">u1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><a name="local-6989586621679873746"><a href="#local-6989586621679873746"><span class="hs-identifier">u2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873745"><span class="hs-identifier hs-var">u1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679873746"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- This is non-deterministic but we do not currently support deterministic</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- code-generation. See Note [Unique Determinism and code generation]</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- See Note [No Ord for Unique]</span><span>
</span><a name="line-266"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-267"></a><span>  </span><a name="local-8214565720323790496"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><a name="local-6989586621679873743"><a href="#local-6989586621679873743"><span class="hs-identifier">u1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><a name="local-6989586621679873744"><a href="#local-6989586621679873744"><span class="hs-identifier">u2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nonDetCmpUnique</span><span> </span><a href="#local-6989586621679873743"><span class="hs-identifier hs-var">u1</span></a><span> </span><a href="#local-6989586621679873744"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Uniquable</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-270"></a><span>  </span><a name="local-8214565720323805448"><span class="hs-identifier">getUnique</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><a name="local-6989586621679873742"><a href="#local-6989586621679873742"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873742"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-identifier">cmmRegType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-273"></a><a name="cmmRegType"><a href="CmmExpr.html#cmmRegType"><span class="hs-identifier">cmmRegType</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span>  </span><a name="local-6989586621679873811"><a href="#local-6989586621679873811"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a><span> </span><a href="#local-6989586621679873811"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-274"></a><span class="hs-identifier">cmmRegType</span><span> </span><a name="local-6989586621679873812"><a href="#local-6989586621679873812"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a name="local-6989586621679873813"><a href="#local-6989586621679873813"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#globalRegType"><span class="hs-identifier hs-var">globalRegType</span></a><span> </span><a href="#local-6989586621679873812"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873813"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-identifier">cmmRegWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-277"></a><a name="cmmRegWidth"><a href="CmmExpr.html#cmmRegWidth"><span class="hs-identifier">cmmRegWidth</span></a></a><span> </span><a name="local-6989586621679873814"><a href="#local-6989586621679873814"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CmmExpr.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a><span> </span><a href="#local-6989586621679873814"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-identifier">localRegType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-280"></a><a name="localRegType"><a href="CmmExpr.html#localRegType"><span class="hs-identifier">localRegType</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-var">LocalReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873815"><a href="#local-6989586621679873815"><span class="hs-identifier">rep</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873815"><span class="hs-identifier hs-var">rep</span></a><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-283"></a><span class="hs-comment">--    Register-use information for expressions and other types</span><span>
</span><a name="line-284"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">-- | Sets of registers</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- These are used for dataflow facts, and a common operation is taking</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- the union of two RegSets and then asking whether the union is the</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- same as one of the inputs.  UniqSet isn't good here, because</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- sizeUniqSet is O(n) whereas Set.size is O(1), so we use ordinary</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- Sets.</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-keyword">type</span><span> </span><a name="RegSet"><a href="CmmExpr.html#RegSet"><span class="hs-identifier">RegSet</span></a></a><span> </span><a name="local-6989586621679873659"><a href="#local-6989586621679873659"><span class="hs-identifier">r</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679873659"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-295"></a><span class="hs-keyword">type</span><span> </span><a name="LocalRegSet"><a href="CmmExpr.html#LocalRegSet"><span class="hs-identifier">LocalRegSet</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>
</span><a name="line-296"></a><span class="hs-keyword">type</span><span> </span><a name="GlobalRegSet"><a href="CmmExpr.html#GlobalRegSet"><span class="hs-identifier">GlobalRegSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-identifier">emptyRegSet</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873779"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-299"></a><span class="hs-identifier">nullRegSet</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873778"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-300"></a><span class="hs-identifier">elemRegSet</span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873777"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679873777"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873777"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-301"></a><span class="hs-identifier">extendRegSet</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873776"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873776"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873776"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873776"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-302"></a><span class="hs-identifier">deleteFromRegSet</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873775"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873775"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873775"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873775"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-303"></a><span class="hs-identifier">mkRegSet</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873774"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679873774"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873774"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-304"></a><span class="hs-identifier">minusRegSet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">plusRegSet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">timesRegSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873773"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873773"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873773"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873773"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-305"></a><span class="hs-identifier">sizeRegSet</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873772"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-306"></a><span class="hs-identifier">regSetToList</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#RegSet"><span class="hs-identifier hs-type">RegSet</span></a><span> </span><a href="#local-6989586621679873771"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679873771"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><a name="emptyRegSet"><a href="CmmExpr.html#emptyRegSet"><span class="hs-identifier">emptyRegSet</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span>
</span><a name="line-309"></a><a name="nullRegSet"><a href="CmmExpr.html#nullRegSet"><span class="hs-identifier">nullRegSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.null</span><span>
</span><a name="line-310"></a><a name="elemRegSet"><a href="CmmExpr.html#elemRegSet"><span class="hs-identifier">elemRegSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.member</span><span>
</span><a name="line-311"></a><a name="extendRegSet"><a href="CmmExpr.html#extendRegSet"><span class="hs-identifier">extendRegSet</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">Set.insert</span><span>
</span><a name="line-312"></a><a name="deleteFromRegSet"><a href="CmmExpr.html#deleteFromRegSet"><span class="hs-identifier">deleteFromRegSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">Set.delete</span><span>
</span><a name="line-313"></a><a name="mkRegSet"><a href="CmmExpr.html#mkRegSet"><span class="hs-identifier">mkRegSet</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span>
</span><a name="line-314"></a><a name="minusRegSet"><a href="CmmExpr.html#minusRegSet"><span class="hs-identifier">minusRegSet</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.difference</span><span>
</span><a name="line-315"></a><a name="plusRegSet"><a href="CmmExpr.html#plusRegSet"><span class="hs-identifier">plusRegSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.union</span><span>
</span><a name="line-316"></a><a name="timesRegSet"><a href="CmmExpr.html#timesRegSet"><span class="hs-identifier">timesRegSet</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.intersection</span><span>
</span><a name="line-317"></a><a name="sizeRegSet"><a href="CmmExpr.html#sizeRegSet"><span class="hs-identifier">sizeRegSet</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.size</span><span>
</span><a name="line-318"></a><a name="regSetToList"><a href="CmmExpr.html#regSetToList"><span class="hs-identifier">regSetToList</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.toList</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873656"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="UserOfRegs"><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier">UserOfRegs</span></a></a><span> </span><a name="local-6989586621679873656"><a href="#local-6989586621679873656"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679873657"><a href="#local-6989586621679873657"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-321"></a><span>  </span><a name="foldRegsUsed"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679873658"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873656"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873658"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873658"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873657"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873658"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-identifier">foldLocalRegsUsed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><a href="#local-6989586621679873769"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-324"></a><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679873770"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873770"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873770"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873769"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873770"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-325"></a><a name="foldLocalRegsUsed"><a href="CmmExpr.html#foldLocalRegsUsed"><span class="hs-identifier">foldLocalRegsUsed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873653"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="DefinerOfRegs"><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier">DefinerOfRegs</span></a></a><span> </span><a name="local-6989586621679873653"><a href="#local-6989586621679873653"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679873654"><a href="#local-6989586621679873654"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-328"></a><span>  </span><a name="foldRegsDefd"><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier">foldRegsDefd</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679873655"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873653"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873655"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873655"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873655"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-identifier">foldLocalRegsDefd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><a href="#local-6989586621679873767"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-331"></a><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679873768"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873768"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873768"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679873768"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-332"></a><a name="foldLocalRegsDefd"><a href="CmmExpr.html#foldLocalRegsDefd"><span class="hs-identifier">foldLocalRegsDefd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier hs-var">foldRegsDefd</span></a><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-335"></a><span>    </span><a name="local-8214565720324648502"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873738"><a href="#local-6989586621679873738"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873739"><a href="#local-6989586621679873739"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a name="local-6989586621679873740"><a href="#local-6989586621679873740"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873738"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873739"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873740"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-336"></a><span>    </span><span class="hs-identifier">foldRegsUsed</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873741"><a href="#local-6989586621679873741"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873741"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-339"></a><span>    </span><a name="local-8214565720324648500"><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier">foldRegsDefd</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873734"><a href="#local-6989586621679873734"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873735"><a href="#local-6989586621679873735"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a name="local-6989586621679873736"><a href="#local-6989586621679873736"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873734"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873735"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873736"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-340"></a><span>    </span><span class="hs-identifier">foldRegsDefd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873737"><a href="#local-6989586621679873737"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873737"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-343"></a><span>    </span><a name="local-8214565720324648502"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873730"><a href="#local-6989586621679873730"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873730"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-344"></a><span>    </span><span class="hs-identifier">foldRegsUsed</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873731"><a href="#local-6989586621679873731"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873732"><a href="#local-6989586621679873732"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a name="local-6989586621679873733"><a href="#local-6989586621679873733"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873731"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873732"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873733"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-347"></a><span>    </span><a name="local-8214565720324648500"><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier">foldRegsDefd</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873726"><a href="#local-6989586621679873726"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873726"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-identifier">foldRegsDefd</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873727"><a href="#local-6989586621679873727"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873728"><a href="#local-6989586621679873728"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a name="local-6989586621679873729"><a href="#local-6989586621679873729"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873727"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873728"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873729"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873722"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="#local-6989586621679873722"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679873722"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-351"></a><span>    </span><a name="local-8214565720324648502"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873723"><a href="#local-6989586621679873723"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873724"><a href="#local-6989586621679873724"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679873725"><a href="#local-6989586621679873725"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873723"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873724"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873725"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873718"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="#local-6989586621679873718"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679873718"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-354"></a><span>    </span><a name="local-8214565720324648500"><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier">foldRegsDefd</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873719"><a href="#local-6989586621679873719"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873720"><a href="#local-6989586621679873720"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679873721"><a href="#local-6989586621679873721"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873719"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873720"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873721"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679873702"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="#local-6989586621679873702"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="#local-6989586621679873702"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-357"></a><span>  </span><span class="hs-comment">-- The (Ord r) in the context is necessary here</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-comment">-- See Note [Recursive superclasses] in TcInstDcls</span><span>
</span><a name="line-359"></a><span>  </span><a name="local-8214565720324648502"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><a name="local-6989586621679873703"><a href="#local-6989586621679873703"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679873704"><a href="#local-6989586621679873704"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679873705"><a href="#local-6989586621679873705"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679873706"><a href="#local-6989586621679873706"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873707"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679873705"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873706"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-360"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679873707"><a href="#local-6989586621679873707"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679873708"><a href="#local-6989586621679873708"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873708"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-361"></a><span>          </span><span class="hs-identifier">expr</span><span> </span><a name="local-6989586621679873709"><a href="#local-6989586621679873709"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><a name="local-6989586621679873710"><a href="#local-6989586621679873710"><span class="hs-identifier">addr</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span> </span><a href="#local-6989586621679873703"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873704"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873709"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873710"><span class="hs-identifier hs-var">addr</span></a><span>
</span><a name="line-362"></a><span>          </span><span class="hs-identifier">expr</span><span> </span><a name="local-6989586621679873711"><a href="#local-6989586621679873711"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a name="local-6989586621679873712"><a href="#local-6989586621679873712"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span> </span><a href="#local-6989586621679873703"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873704"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873711"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873712"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-363"></a><span>          </span><span class="hs-identifier">expr</span><span> </span><a name="local-6989586621679873713"><a href="#local-6989586621679873713"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679873714"><a href="#local-6989586621679873714"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span> </span><a href="#local-6989586621679873703"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873704"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873713"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873714"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-364"></a><span>          </span><span class="hs-identifier">expr</span><span> </span><a name="local-6989586621679873715"><a href="#local-6989586621679873715"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmRegOff"><span class="hs-identifier hs-var">CmmRegOff</span></a><span> </span><a name="local-6989586621679873716"><a href="#local-6989586621679873716"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span> </span><a href="#local-6989586621679873703"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873704"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679873715"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679873716"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-365"></a><span>          </span><span class="hs-identifier">expr</span><span> </span><a name="local-6989586621679873717"><a href="#local-6989586621679873717"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmStackSlot"><span class="hs-identifier hs-var">CmmStackSlot</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873717"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="#local-6989586621679873696"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679873697"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#UserOfRegs"><span class="hs-identifier hs-type">UserOfRegs</span></a><span> </span><a href="#local-6989586621679873696"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679873697"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-368"></a><span>  </span><a name="local-8214565720324648502"><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier">foldRegsUsed</span></a></a><span> </span><a name="local-6989586621679873698"><a href="#local-6989586621679873698"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679873699"><a href="#local-6989586621679873699"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873700"><a href="#local-6989586621679873700"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#foldRegsUsed"><span class="hs-identifier hs-var">foldRegsUsed</span></a><span> </span><a href="#local-6989586621679873698"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873699"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679873700"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-369"></a><span>  </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldRegsUsed</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-keyword">instance</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="#local-6989586621679873690"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679873691"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="CmmExpr.html#DefinerOfRegs"><span class="hs-identifier hs-type">DefinerOfRegs</span></a><span> </span><a href="#local-6989586621679873690"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679873691"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-372"></a><span>  </span><a name="local-8214565720324648500"><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier">foldRegsDefd</span></a></a><span> </span><a name="local-6989586621679873692"><a href="#local-6989586621679873692"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621679873693"><a href="#local-6989586621679873693"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679873694"><a href="#local-6989586621679873694"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#foldRegsDefd"><span class="hs-identifier hs-var">foldRegsDefd</span></a><span> </span><a href="#local-6989586621679873692"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621679873693"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679873694"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldRegsDefd</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-376"></a><span class="hs-comment">--              Global STG registers</span><span>
</span><a name="line-377"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-keyword">data</span><span> </span><a name="VGcPtr"><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier">VGcPtr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VGcPtr"><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier">VGcPtr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VNonGcPtr"><a href="CmmExpr.html#VNonGcPtr"><span class="hs-identifier">VNonGcPtr</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-382"></a><span class="hs-comment">--              Global STG registers</span><span>
</span><a name="line-383"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-384"></a><span class="hs-comment">{-
Note [Overlapping global registers]

The backend might not faithfully implement the abstraction of the STG
machine with independent registers for different values of type
GlobalReg. Specifically, certain pairs of registers (r1, r2) may
overlap in the sense that a store to r1 invalidates the value in r2,
and vice versa.

Currently this occurs only on the x86_64 architecture where FloatReg n
and DoubleReg n are assigned the same microarchitectural register, in
order to allow functions to receive more Float# or Double# arguments
in registers (as opposed to on the stack).

There are no specific rules about which registers might overlap with
which other registers, but presumably it's safe to assume that nothing
will overlap with special registers like Sp or BaseReg.

Use CmmUtils.regsOverlap to determine whether two GlobalRegs overlap
on a particular platform. The instance Eq GlobalReg is syntactic
equality of STG registers and does not take overlap into
account. However it is still used in UserOfRegs/DefinerOfRegs and
there are likely still bugs there, beware!
-}</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-keyword">data</span><span> </span><a name="GlobalReg"><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier">GlobalReg</span></a></a><span>
</span><a name="line-410"></a><span>  </span><span class="hs-comment">-- Argument and return registers</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="VanillaReg"><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier">VanillaReg</span></a></a><span>                  </span><span class="hs-comment">-- pointers, unboxed ints and chars</span><span>
</span><a name="line-412"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-413"></a><span>        </span><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier hs-type">VGcPtr</span></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FloatReg"><a href="CmmExpr.html#FloatReg"><span class="hs-identifier">FloatReg</span></a></a><span>            </span><span class="hs-comment">-- single-precision floating-point registers</span><span>
</span><a name="line-416"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DoubleReg"><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier">DoubleReg</span></a></a><span>           </span><span class="hs-comment">-- double-precision floating-point registers</span><span>
</span><a name="line-419"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LongReg"><a href="CmmExpr.html#LongReg"><span class="hs-identifier">LongReg</span></a></a><span>             </span><span class="hs-comment">-- long int registers (64-bit, really)</span><span>
</span><a name="line-422"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="XmmReg"><a href="CmmExpr.html#XmmReg"><span class="hs-identifier">XmmReg</span></a></a><span>                      </span><span class="hs-comment">-- 128-bit SIMD vector register</span><span>
</span><a name="line-425"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="YmmReg"><a href="CmmExpr.html#YmmReg"><span class="hs-identifier">YmmReg</span></a></a><span>                      </span><span class="hs-comment">-- 256-bit SIMD vector register</span><span>
</span><a name="line-428"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ZmmReg"><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier">ZmmReg</span></a></a><span>                      </span><span class="hs-comment">-- 512-bit SIMD vector register</span><span>
</span><a name="line-431"></a><span>        </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>     </span><span class="hs-comment">-- its number</span><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span>  </span><span class="hs-comment">-- STG registers</span><span>
</span><a name="line-434"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sp"><a href="CmmExpr.html#Sp"><span class="hs-identifier">Sp</span></a></a><span>                  </span><span class="hs-comment">-- Stack ptr; points to last occupied stack location.</span><span>
</span><a name="line-435"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SpLim"><a href="CmmExpr.html#SpLim"><span class="hs-identifier">SpLim</span></a></a><span>               </span><span class="hs-comment">-- Stack limit</span><span>
</span><a name="line-436"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Hp"><a href="CmmExpr.html#Hp"><span class="hs-identifier">Hp</span></a></a><span>                  </span><span class="hs-comment">-- Heap ptr; points to last occupied heap location.</span><span>
</span><a name="line-437"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HpLim"><a href="CmmExpr.html#HpLim"><span class="hs-identifier">HpLim</span></a></a><span>               </span><span class="hs-comment">-- Heap limit register</span><span>
</span><a name="line-438"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CCCS"><a href="CmmExpr.html#CCCS"><span class="hs-identifier">CCCS</span></a></a><span>                </span><span class="hs-comment">-- Current cost-centre stack</span><span>
</span><a name="line-439"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CurrentTSO"><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier">CurrentTSO</span></a></a><span>          </span><span class="hs-comment">-- pointer to current thread's TSO</span><span>
</span><a name="line-440"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CurrentNursery"><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier">CurrentNursery</span></a></a><span>      </span><span class="hs-comment">-- pointer to allocation area</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HpAlloc"><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier">HpAlloc</span></a></a><span>             </span><span class="hs-comment">-- allocation count for heap check failure</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span>                </span><span class="hs-comment">-- We keep the address of some commonly-called</span><span>
</span><a name="line-444"></a><span>                </span><span class="hs-comment">-- functions in the register table, to keep code</span><span>
</span><a name="line-445"></a><span>                </span><span class="hs-comment">-- size down:</span><span>
</span><a name="line-446"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EagerBlackholeInfo"><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier">EagerBlackholeInfo</span></a></a><span>  </span><span class="hs-comment">-- stg_EAGER_BLACKHOLE_info</span><span>
</span><a name="line-447"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GCEnter1"><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier">GCEnter1</span></a></a><span>            </span><span class="hs-comment">-- stg_gc_enter_1</span><span>
</span><a name="line-448"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GCFun"><a href="CmmExpr.html#GCFun"><span class="hs-identifier">GCFun</span></a></a><span>               </span><span class="hs-comment">-- stg_gc_fun</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span>  </span><span class="hs-comment">-- Base offset for the register table, used for accessing registers</span><span>
</span><a name="line-451"></a><span>  </span><span class="hs-comment">-- which do not have real registers assigned to them.  This register</span><span>
</span><a name="line-452"></a><span>  </span><span class="hs-comment">-- will only appear after we have expanded GlobalReg into memory accesses</span><span>
</span><a name="line-453"></a><span>  </span><span class="hs-comment">-- (where necessary) in the native code generator.</span><span>
</span><a name="line-454"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BaseReg"><a href="CmmExpr.html#BaseReg"><span class="hs-identifier">BaseReg</span></a></a><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span>  </span><span class="hs-comment">-- The register used by the platform for the C stack pointer. This is</span><span>
</span><a name="line-457"></a><span>  </span><span class="hs-comment">-- a break in the STG abstraction used exclusively to setup stack unwinding</span><span>
</span><a name="line-458"></a><span>  </span><span class="hs-comment">-- information.</span><span>
</span><a name="line-459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MachSp"><a href="CmmExpr.html#MachSp"><span class="hs-identifier">MachSp</span></a></a><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span>  </span><span class="hs-comment">-- The is a dummy register used to indicate to the stack unwinder where</span><span>
</span><a name="line-462"></a><span>  </span><span class="hs-comment">-- a routine would return to.</span><span>
</span><a name="line-463"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnwindReturnReg"><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier">UnwindReturnReg</span></a></a><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-comment">-- Base Register for PIC (position-independent code) calculations</span><span>
</span><a name="line-466"></a><span>  </span><span class="hs-comment">-- Only used inside the native code generator. It's exact meaning differs</span><span>
</span><a name="line-467"></a><span>  </span><span class="hs-comment">-- from platform to platform (see module PositionIndependentCode).</span><span>
</span><a name="line-468"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PicBaseReg"><a href="CmmExpr.html#PicBaseReg"><span class="hs-identifier">PicBaseReg</span></a></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-473"></a><span>   </span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><a name="local-6989586621679873674"><a href="#local-6989586621679873674"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><a name="local-6989586621679873675"><a href="#local-6989586621679873675"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873674"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873675"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-comment">-- Ignore type when seeking clashes</span><span>
</span><a name="line-474"></a><span>   </span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><a name="local-6989586621679873676"><a href="#local-6989586621679873676"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><a name="local-6989586621679873677"><a href="#local-6989586621679873677"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873676"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873677"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-475"></a><span>   </span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><a name="local-6989586621679873678"><a href="#local-6989586621679873678"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><a name="local-6989586621679873679"><a href="#local-6989586621679873679"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873678"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873679"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-476"></a><span>   </span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><a name="local-6989586621679873680"><a href="#local-6989586621679873680"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><a name="local-6989586621679873681"><a href="#local-6989586621679873681"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873680"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873681"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-477"></a><span>   </span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><a name="local-6989586621679873682"><a href="#local-6989586621679873682"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><a name="local-6989586621679873683"><a href="#local-6989586621679873683"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873682"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873683"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-478"></a><span>   </span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><a name="local-6989586621679873684"><a href="#local-6989586621679873684"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><a name="local-6989586621679873685"><a href="#local-6989586621679873685"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873684"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873685"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-479"></a><span>   </span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><a name="local-6989586621679873686"><a href="#local-6989586621679873686"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><a name="local-6989586621679873687"><a href="#local-6989586621679873687"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679873686"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679873687"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-480"></a><span>   </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-481"></a><span>   </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-482"></a><span>   </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-483"></a><span>   </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-484"></a><span>   </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-485"></a><span>   </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-486"></a><span>   </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-487"></a><span>   </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-488"></a><span>   </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-489"></a><span>   </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-490"></a><span>   </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-491"></a><span>   </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-492"></a><span>   </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-493"></a><span>   </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-494"></a><span>   </span><a href="CmmExpr.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="CmmExpr.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-495"></a><span>   </span><a name="local-6989586621679873688"><a href="#local-6989586621679873688"><span class="hs-identifier">_r1</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a name="local-6989586621679873689"><a href="#local-6989586621679873689"><span class="hs-identifier">_r2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-498"></a><span>   </span><a name="local-8214565720323790496"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><a name="local-6989586621679873660"><a href="#local-6989586621679873660"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><a name="local-6989586621679873661"><a href="#local-6989586621679873661"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873660"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873661"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-499"></a><span>     </span><span class="hs-comment">-- Ignore type when seeking clashes</span><span>
</span><a name="line-500"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><a name="local-6989586621679873662"><a href="#local-6989586621679873662"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span>  </span><a name="local-6989586621679873663"><a href="#local-6989586621679873663"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873662"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873663"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-501"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><a name="local-6989586621679873664"><a href="#local-6989586621679873664"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><a name="local-6989586621679873665"><a href="#local-6989586621679873665"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873664"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873665"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-502"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><a name="local-6989586621679873666"><a href="#local-6989586621679873666"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span>   </span><a name="local-6989586621679873667"><a href="#local-6989586621679873667"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873666"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873667"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-503"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><a name="local-6989586621679873668"><a href="#local-6989586621679873668"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span>    </span><a name="local-6989586621679873669"><a href="#local-6989586621679873669"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873668"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873669"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-504"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><a name="local-6989586621679873670"><a href="#local-6989586621679873670"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span>    </span><a name="local-6989586621679873671"><a href="#local-6989586621679873671"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873670"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873671"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-505"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><a name="local-6989586621679873672"><a href="#local-6989586621679873672"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span>    </span><a name="local-6989586621679873673"><a href="#local-6989586621679873673"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679873672"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679873673"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-506"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-507"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-508"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-509"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-510"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-511"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-512"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-513"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-514"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-515"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-516"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-517"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-518"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-519"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-520"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a><span> </span><a href="CmmExpr.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-521"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-522"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-523"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-524"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-525"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-526"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-527"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-528"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-529"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-530"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-531"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-532"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-533"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-534"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-535"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-536"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-537"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-538"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-539"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-540"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-541"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-542"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-543"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-544"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-545"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-546"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-547"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-548"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-549"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-550"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-551"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-552"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#GCEnter1"><span class="hs-identifier hs-var">GCEnter1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-553"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-554"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#GCFun"><span class="hs-identifier hs-var">GCFun</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-555"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-556"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-557"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-558"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#MachSp"><span class="hs-identifier hs-var">MachSp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-559"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-560"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#UnwindReturnReg"><span class="hs-identifier hs-var">UnwindReturnReg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-561"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-562"></a><span>   </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#EagerBlackholeInfo"><span class="hs-identifier hs-var">EagerBlackholeInfo</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-comment">-- convenient aliases</span><span>
</span><a name="line-565"></a><span class="hs-identifier">baseReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">spReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hpReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">spLimReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hpLimReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nodeReg</span><span class="hs-special">,</span><span>
</span><a name="line-566"></a><span>  </span><span class="hs-identifier">currentTSOReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">currentNurseryReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hpAllocReg</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cccsReg</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a><span>
</span><a name="line-567"></a><a name="baseReg"><a href="CmmExpr.html#baseReg"><span class="hs-identifier">baseReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#BaseReg"><span class="hs-identifier hs-var">BaseReg</span></a><span>
</span><a name="line-568"></a><a name="spReg"><a href="CmmExpr.html#spReg"><span class="hs-identifier">spReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#Sp"><span class="hs-identifier hs-var">Sp</span></a><span>
</span><a name="line-569"></a><a name="hpReg"><a href="CmmExpr.html#hpReg"><span class="hs-identifier">hpReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span>
</span><a name="line-570"></a><a name="hpLimReg"><a href="CmmExpr.html#hpLimReg"><span class="hs-identifier">hpLimReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#HpLim"><span class="hs-identifier hs-var">HpLim</span></a><span>
</span><a name="line-571"></a><a name="spLimReg"><a href="CmmExpr.html#spLimReg"><span class="hs-identifier">spLimReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#SpLim"><span class="hs-identifier hs-var">SpLim</span></a><span>
</span><a name="line-572"></a><a name="nodeReg"><a href="CmmExpr.html#nodeReg"><span class="hs-identifier">nodeReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#node"><span class="hs-identifier hs-var">node</span></a><span>
</span><a name="line-573"></a><a name="currentTSOReg"><a href="CmmExpr.html#currentTSOReg"><span class="hs-identifier">currentTSOReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#CurrentTSO"><span class="hs-identifier hs-var">CurrentTSO</span></a><span>
</span><a name="line-574"></a><a name="currentNurseryReg"><a href="CmmExpr.html#currentNurseryReg"><span class="hs-identifier">currentNurseryReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#CurrentNursery"><span class="hs-identifier hs-var">CurrentNursery</span></a><span>
</span><a name="line-575"></a><a name="hpAllocReg"><a href="CmmExpr.html#hpAllocReg"><span class="hs-identifier">hpAllocReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#HpAlloc"><span class="hs-identifier hs-var">HpAlloc</span></a><span>
</span><a name="line-576"></a><a name="cccsReg"><a href="CmmExpr.html#cccsReg"><span class="hs-identifier">cccsReg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a><span> </span><a href="CmmExpr.html#CCCS"><span class="hs-identifier hs-var">CCCS</span></a><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><span class="hs-identifier">node</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span>
</span><a name="line-579"></a><a name="node"><a href="CmmExpr.html#node"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier hs-var">VGcPtr</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-582"></a><a name="globalRegType"><a href="CmmExpr.html#globalRegType"><span class="hs-identifier">globalRegType</span></a></a><span> </span><a name="local-6989586621679873816"><a href="#local-6989586621679873816"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#VGcPtr"><span class="hs-identifier hs-var">VGcPtr</span></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621679873816"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-583"></a><span class="hs-identifier">globalRegType</span><span> </span><a name="local-6989586621679873817"><a href="#local-6989586621679873817"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="CmmExpr.html#VNonGcPtr"><span class="hs-identifier hs-var">VNonGcPtr</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873817"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-584"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmFloat</span><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-585"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmFloat</span><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-586"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmBits</span><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-587"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmVec</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cmmBits</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmVec</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cmmBits</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span class="hs-identifier">globalRegType</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmVec</span><span> </span><span class="hs-number">16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cmmBits</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">globalRegType</span><span> </span><a name="local-6989586621679873818"><a href="#local-6989586621679873818"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="CmmExpr.html#Hp"><span class="hs-identifier hs-var">Hp</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621679873818"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-592"></a><span>                                            </span><span class="hs-comment">-- The initialiser for all</span><span>
</span><a name="line-593"></a><span>                                            </span><span class="hs-comment">-- dynamically allocated closures</span><span>
</span><a name="line-594"></a><span class="hs-identifier">globalRegType</span><span> </span><a name="local-6989586621679873819"><a href="#local-6989586621679873819"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621679873819"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-597"></a><a name="isArgReg"><a href="CmmExpr.html#isArgReg"><span class="hs-identifier">isArgReg</span></a></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#VanillaReg"><span class="hs-identifier hs-var">VanillaReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-598"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#FloatReg"><span class="hs-identifier hs-var">FloatReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-599"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#DoubleReg"><span class="hs-identifier hs-var">DoubleReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-600"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#LongReg"><span class="hs-identifier hs-var">LongReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-601"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#XmmReg"><span class="hs-identifier hs-var">XmmReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-602"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#YmmReg"><span class="hs-identifier hs-var">YmmReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-603"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#ZmmReg"><span class="hs-identifier hs-var">ZmmReg</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-604"></a><span class="hs-identifier">isArgReg</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-605"></a></pre></body></html>