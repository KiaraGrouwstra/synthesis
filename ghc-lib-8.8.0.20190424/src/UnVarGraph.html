<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-

Copyright (c) 2014 Joachim Breitner

A data structure for undirected graphs of variables
(or in plain terms: Sets of unordered pairs of numbers)


This is very specifically tailored for the use in CallArity. In particular it
stores the graph as a union of complete and complete bipartite graph, which
would be very expensive to store as sets of edges or as adjanceny lists.

It does not normalize the graphs. This means that g `unionUnVarGraph` g is
equal to g, but twice as expensive and large.

-}</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UnVarGraph</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#emptyUnVarSet"><span class="hs-identifier hs-var">emptyUnVarSet</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#mkUnVarSet"><span class="hs-identifier hs-var">mkUnVarSet</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#varEnvDom"><span class="hs-identifier hs-var">varEnvDom</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#unionUnVarSet"><span class="hs-identifier hs-var">unionUnVarSet</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#unionUnVarSets"><span class="hs-identifier hs-var">unionUnVarSets</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#delUnVarSet"><span class="hs-identifier hs-var">delUnVarSet</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#isEmptyUnVarSet"><span class="hs-identifier hs-var">isEmptyUnVarSet</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#emptyUnVarGraph"><span class="hs-identifier hs-var">emptyUnVarGraph</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#unionUnVarGraph"><span class="hs-identifier hs-var">unionUnVarGraph</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#unionUnVarGraphs"><span class="hs-identifier hs-var">unionUnVarGraphs</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#completeGraph"><span class="hs-identifier hs-var">completeGraph</span></a><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#completeBipartiteGraph"><span class="hs-identifier hs-var">completeBipartiteGraph</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#neighbors"><span class="hs-identifier hs-var">neighbors</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#hasLoopAt"><span class="hs-identifier hs-var">hasLoopAt</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="UnVarGraph.html#delNode"><span class="hs-identifier hs-var">delNode</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Id</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">VarEnv</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UniqFM</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Bag</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.IntSet</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- We need a type for sets of variables (UnVarSet).</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- We do not use VarSet, because for that we need to have the actual variable</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- at hand, and we do not have that when we turn the domain of a VarEnv into a UnVarSet.</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- Therefore, use a IntSet directly (which is likely also a bit more efficient).</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- Set of uniques, i.e. for adjancet nodes</span><span>
</span><a name="line-48"></a><span class="hs-keyword">newtype</span><span> </span><a name="UnVarSet"><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier">UnVarSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UnVarSet"><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier">UnVarSet</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S.IntSet</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-52"></a><a name="k"><a href="UnVarGraph.html#k"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621684259265"><a href="#local-6989586621684259265"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">getKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getUnique</span><span> </span><a href="#local-6989586621684259265"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">emptyUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-55"></a><a name="emptyUnVarSet"><a href="UnVarGraph.html#emptyUnVarSet"><span class="hs-identifier">emptyUnVarSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><span class="hs-identifier hs-var">S.empty</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">elemUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-58"></a><a name="elemUnVarSet"><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier">elemUnVarSet</span></a></a><span> </span><a name="local-6989586621684259266"><a href="#local-6989586621684259266"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259267"><a href="#local-6989586621684259267"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#k"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621684259266"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259267"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-identifier">isEmptyUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-62"></a><a name="isEmptyUnVarSet"><a href="UnVarGraph.html#isEmptyUnVarSet"><span class="hs-identifier">isEmptyUnVarSet</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259268"><a href="#local-6989586621684259268"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.null</span><span> </span><a href="#local-6989586621684259268"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">delUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-65"></a><a name="delUnVarSet"><a href="UnVarGraph.html#delUnVarSet"><span class="hs-identifier">delUnVarSet</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259269"><a href="#local-6989586621684259269"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684259270"><a href="#local-6989586621684259270"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#k"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621684259270"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.delete</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259269"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-identifier">mkUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Var</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-68"></a><a name="mkUnVarSet"><a href="UnVarGraph.html#mkUnVarSet"><span class="hs-identifier">mkUnVarSet</span></a></a><span> </span><a name="local-6989586621684259271"><a href="#local-6989586621684259271"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">S.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="UnVarGraph.html#k"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621684259271"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-identifier">varEnvDom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">VarEnv</span><span> </span><a href="#local-6989586621684259264"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-71"></a><a name="varEnvDom"><a href="UnVarGraph.html#varEnvDom"><span class="hs-identifier">varEnvDom</span></a></a><span> </span><a name="local-6989586621684259272"><a href="#local-6989586621684259272"><span class="hs-identifier">ae</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ufmToSet_Directly</span><span> </span><a href="#local-6989586621684259272"><span class="hs-identifier hs-var">ae</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-identifier">unionUnVarSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-74"></a><a name="unionUnVarSet"><a href="UnVarGraph.html#unionUnVarSet"><span class="hs-identifier">unionUnVarSet</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259273"><a href="#local-6989586621684259273"><span class="hs-identifier">set1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259274"><a href="#local-6989586621684259274"><span class="hs-identifier">set2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684259273"><span class="hs-identifier hs-var">set1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">S.union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259274"><span class="hs-identifier hs-var">set2</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-identifier">unionUnVarSets</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-77"></a><a name="unionUnVarSets"><a href="UnVarGraph.html#unionUnVarSets"><span class="hs-identifier">unionUnVarSets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="UnVarGraph.html#unionUnVarSet"><span class="hs-identifier hs-var">unionUnVarSet</span></a><span> </span><a href="UnVarGraph.html#emptyUnVarSet"><span class="hs-identifier hs-var">emptyUnVarSet</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>    </span><a name="local-8214565720323806217"><span class="hs-identifier">ppr</span></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-var">UnVarSet</span></a><span> </span><a name="local-6989586621684259262"><a href="#local-6989586621684259262"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">braces</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-81"></a><span>        </span><span class="hs-identifier hs-var">hcat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">punctuate</span><span> </span><span class="hs-identifier hs-var">comma</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getUnique</span><span> </span><a href="#local-6989586621684259263"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621684259263"><a href="#local-6989586621684259263"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">S.toList</span><span> </span><a href="#local-6989586621684259262"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- The graph type. A list of complete bipartite graphs</span><span>
</span><a name="line-85"></a><span class="hs-keyword">data</span><span> </span><a name="Gen"><a href="UnVarGraph.html#Gen"><span class="hs-identifier">Gen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CBPG"><a href="UnVarGraph.html#CBPG"><span class="hs-identifier">CBPG</span></a></a><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-comment">-- complete bipartite</span><span>
</span><a name="line-86"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="CG"><a href="UnVarGraph.html#CG"><span class="hs-identifier">CG</span></a></a><span>   </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>          </span><span class="hs-comment">-- complete</span><span>
</span><a name="line-87"></a><span class="hs-keyword">newtype</span><span> </span><a name="UnVarGraph"><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier">UnVarGraph</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UnVarGraph"><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier">UnVarGraph</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bag</span><span> </span><a href="UnVarGraph.html#Gen"><span class="hs-identifier hs-type">Gen</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-identifier">emptyUnVarGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-90"></a><a name="emptyUnVarGraph"><a href="UnVarGraph.html#emptyUnVarGraph"><span class="hs-identifier">emptyUnVarGraph</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-identifier hs-var">emptyBag</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-identifier">unionUnVarGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-93"></a><span class="hs-comment">{-
Premature optimisation, it seems.
unionUnVarGraph (UnVarGraph [CBPG s1 s2]) (UnVarGraph [CG s3, CG s4])
    | s1 == s3 &amp;&amp; s2 == s4
    = pprTrace &quot;unionUnVarGraph fired&quot; empty $
      completeGraph (s1 `unionUnVarSet` s2)
unionUnVarGraph (UnVarGraph [CBPG s1 s2]) (UnVarGraph [CG s3, CG s4])
    | s2 == s3 &amp;&amp; s1 == s4
    = pprTrace &quot;unionUnVarGraph fired2&quot; empty $
      completeGraph (s1 `unionUnVarSet` s2)
-}</span><span>
</span><a name="line-104"></a><a name="unionUnVarGraph"><a href="UnVarGraph.html#unionUnVarGraph"><span class="hs-identifier">unionUnVarGraph</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259275"><a href="#local-6989586621684259275"><span class="hs-identifier">g1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259276"><a href="#local-6989586621684259276"><span class="hs-identifier">g2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- pprTrace &quot;unionUnVarGraph&quot; (ppr (length g1, length g2)) $</span><span>
</span><a name="line-106"></a><span>      </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684259275"><span class="hs-identifier hs-var">g1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">unionBags</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259276"><span class="hs-identifier hs-var">g2</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-identifier">unionUnVarGraphs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-109"></a><a name="unionUnVarGraphs"><a href="UnVarGraph.html#unionUnVarGraphs"><span class="hs-identifier">unionUnVarGraphs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="UnVarGraph.html#unionUnVarGraph"><span class="hs-identifier hs-var">unionUnVarGraph</span></a><span> </span><a href="UnVarGraph.html#emptyUnVarGraph"><span class="hs-identifier hs-var">emptyUnVarGraph</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- completeBipartiteGraph A B = { {a,b} | a &#8712; A, b &#8712; B }</span><span>
</span><a name="line-112"></a><span class="hs-identifier">completeBipartiteGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-113"></a><a name="completeBipartiteGraph"><a href="UnVarGraph.html#completeBipartiteGraph"><span class="hs-identifier">completeBipartiteGraph</span></a></a><span> </span><a name="local-6989586621684259277"><a href="#local-6989586621684259277"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259278"><a href="#local-6989586621684259278"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#prune"><span class="hs-identifier hs-var">prune</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unitBag</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a href="#local-6989586621684259277"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621684259278"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-identifier">completeGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-116"></a><a name="completeGraph"><a href="UnVarGraph.html#completeGraph"><span class="hs-identifier">completeGraph</span></a></a><span> </span><a name="local-6989586621684259279"><a href="#local-6989586621684259279"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#prune"><span class="hs-identifier hs-var">prune</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unitBag</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a href="#local-6989586621684259279"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">neighbors</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarSet"><span class="hs-identifier hs-type">UnVarSet</span></a><span>
</span><a name="line-119"></a><a name="neighbors"><a href="UnVarGraph.html#neighbors"><span class="hs-identifier">neighbors</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259280"><a href="#local-6989586621684259280"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684259281"><a href="#local-6989586621684259281"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#unionUnVarSets"><span class="hs-identifier hs-var">unionUnVarSets</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621684259282"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span> </span><a href="#local-6989586621684259280"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684259282"><a href="#local-6989586621684259282"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a name="local-6989586621684259283"><a href="#local-6989586621684259283"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621684259281"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259283"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684259283"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a name="local-6989586621684259284"><a href="#local-6989586621684259284"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259285"><a href="#local-6989586621684259285"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621684259281"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259284"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684259285"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-122"></a><span>                          </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621684259281"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259285"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684259284"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- hasLoopAt G v &lt;=&gt; v--v &#8712; G</span><span>
</span><a name="line-125"></a><span class="hs-identifier">hasLoopAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-126"></a><a name="hasLoopAt"><a href="UnVarGraph.html#hasLoopAt"><span class="hs-identifier">hasLoopAt</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259286"><a href="#local-6989586621684259286"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684259287"><a href="#local-6989586621684259287"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="#local-6989586621684259288"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span> </span><a href="#local-6989586621684259286"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684259288"><a href="#local-6989586621684259288"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a name="local-6989586621684259289"><a href="#local-6989586621684259289"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684259287"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259289"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-128"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a name="local-6989586621684259290"><a href="#local-6989586621684259290"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259291"><a href="#local-6989586621684259291"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684259287"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259290"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621684259287"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#elemUnVarSet"><span class="hs-identifier hs-var">elemUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259291"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">delNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-132"></a><a name="delNode"><a href="UnVarGraph.html#delNode"><span class="hs-identifier">delNode</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259292"><a href="#local-6989586621684259292"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684259293"><a href="#local-6989586621684259293"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#prune"><span class="hs-identifier hs-var">prune</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapBag</span><span> </span><a href="#local-6989586621684259294"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621684259292"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684259294"><a href="#local-6989586621684259294"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a name="local-6989586621684259295"><a href="#local-6989586621684259295"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684259295"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#delUnVarSet"><span class="hs-identifier hs-var">delUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259293"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a name="local-6989586621684259296"><a href="#local-6989586621684259296"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259297"><a href="#local-6989586621684259297"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684259296"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#delUnVarSet"><span class="hs-identifier hs-var">delUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259293"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684259297"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="UnVarGraph.html#delUnVarSet"><span class="hs-identifier hs-var">delUnVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684259293"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-identifier">prune</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span>
</span><a name="line-137"></a><a name="prune"><a href="UnVarGraph.html#prune"><span class="hs-identifier">prune</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259298"><a href="#local-6989586621684259298"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filterBag</span><span> </span><a href="#local-6989586621684259299"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621684259298"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684259299"><a href="#local-6989586621684259299"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a name="local-6989586621684259300"><a href="#local-6989586621684259300"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#isEmptyUnVarSet"><span class="hs-identifier hs-var">isEmptyUnVarSet</span></a><span> </span><a href="#local-6989586621684259300"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a name="local-6989586621684259301"><a href="#local-6989586621684259301"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259302"><a href="#local-6989586621684259302"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#isEmptyUnVarSet"><span class="hs-identifier hs-var">isEmptyUnVarSet</span></a><span> </span><a href="#local-6989586621684259301"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#isEmptyUnVarSet"><span class="hs-identifier hs-var">isEmptyUnVarSet</span></a><span> </span><a href="#local-6989586621684259302"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="UnVarGraph.html#Gen"><span class="hs-identifier hs-type">Gen</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-8214565720323806217"><span class="hs-identifier">ppr</span></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CG"><span class="hs-identifier hs-var">CG</span></a><span> </span><a name="local-6989586621684259259"><a href="#local-6989586621684259259"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621684259259"><span class="hs-identifier hs-var">s</span></a><span>  </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'&#178;'</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#CBPG"><span class="hs-identifier hs-var">CBPG</span></a><span> </span><a name="local-6989586621684259260"><a href="#local-6989586621684259260"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684259261"><a href="#local-6989586621684259261"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621684259260"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'x'</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621684259261"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-type">UnVarGraph</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-8214565720323806217"><span class="hs-identifier">ppr</span></a><span> </span><span class="hs-special">(</span><a href="UnVarGraph.html#UnVarGraph"><span class="hs-identifier hs-var">UnVarGraph</span></a><span> </span><a name="local-6989586621684259258"><a href="#local-6989586621684259258"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621684259258"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-146"></a></pre></body></html>