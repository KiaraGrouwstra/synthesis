<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- emitPrimOp is quite large</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# OPTIONS_GHC -fmax-pmcheck-iterations=4000000 #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Stg to C--: primitive operations</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- (c) The University of Glasgow 2004-2006</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">StgCmmPrim</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>   </span><a href="StgCmmPrim.html#cgOpApp"><span class="hs-identifier hs-var">cgOpApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>   </span><a href="StgCmmPrim.html#cgPrimOp"><span class="hs-identifier hs-var">cgPrimOp</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- internal(ish), used by cgCase to get code for a</span><span>
</span><a name="line-16"></a><span>             </span><span class="hs-comment">-- comparison without also turning it into a Bool.</span><span>
</span><a name="line-17"></a><span>   </span><a href="StgCmmPrim.html#shouldInlinePrimOp"><span class="hs-identifier hs-var">shouldInlinePrimOp</span></a><span>
</span><a name="line-18"></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmLayout.html"><span class="hs-identifier">StgCmmLayout</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmForeign.html"><span class="hs-identifier">StgCmmForeign</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmEnv.html"><span class="hs-identifier">StgCmmEnv</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmMonad.html"><span class="hs-identifier">StgCmmMonad</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmUtils.html"><span class="hs-identifier">StgCmmUtils</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmTicky.html"><span class="hs-identifier">StgCmmTicky</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmHeap.html"><span class="hs-identifier">StgCmmHeap</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="StgCmmProf.html"><span class="hs-identifier">StgCmmProf</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="StgCmmProf.html#costCentreFrom"><span class="hs-identifier hs-var">costCentreFrom</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Platform</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BasicTypes</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="BlockId.html"><span class="hs-identifier">BlockId</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="MkGraph.html"><span class="hs-identifier">MkGraph</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="StgSyn.html"><span class="hs-identifier">StgSyn</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="Cmm.html"><span class="hs-identifier">Cmm</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tyConAppTyCon</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCon</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="CLabel.html"><span class="hs-identifier">CLabel</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="CmmUtils.html"><span class="hs-identifier">CmmUtils</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">PrimOp</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="SMRep.html"><span class="hs-identifier">SMRep</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FastString</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">.&amp;.</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">bit</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-54"></a><span class="hs-comment">--      Primitive operations and foreign calls</span><span>
</span><a name="line-55"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">{- Note [Foreign call results]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~
A foreign call always returns an unboxed tuple of results, one
of which is the state token.  This seems to happen even for pure
calls.

Even if we returned a single result for pure calls, it'd still be
right to wrap it in a singleton unboxed tuple, because the result
might be a Haskell closure pointer, we don't want to evaluate it. -}</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">----------------------------------</span><span>
</span><a name="line-68"></a><span class="hs-identifier">cgOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgSyn.html#StgOp"><span class="hs-identifier hs-type">StgOp</span></a><span>        </span><span class="hs-comment">-- The op</span><span>
</span><a name="line-69"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="StgSyn.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- Arguments</span><span>
</span><a name="line-70"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>         </span><span class="hs-comment">-- Result type (always an unboxed tuple)</span><span>
</span><a name="line-71"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><a href="StgCmmMonad.html#ReturnKind"><span class="hs-identifier hs-type">ReturnKind</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- Foreign calls</span><span>
</span><a name="line-74"></a><a name="cgOpApp"><a href="StgCmmPrim.html#cgOpApp"><span class="hs-identifier">cgOpApp</span></a></a><span> </span><span class="hs-special">(</span><a href="StgSyn.html#StgFCallOp"><span class="hs-identifier hs-var">StgFCallOp</span></a><span> </span><a name="local-6989586621680976504"><a href="#local-6989586621680976504"><span class="hs-identifier">fcall</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680976505"><a href="#local-6989586621680976505"><span class="hs-identifier">stg_args</span></a></a><span> </span><a name="local-6989586621680976506"><a href="#local-6989586621680976506"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmForeign.html#cgForeignCall"><span class="hs-identifier hs-var">cgForeignCall</span></a><span> </span><a href="#local-6989586621680976504"><span class="hs-identifier hs-var">fcall</span></a><span> </span><a href="#local-6989586621680976505"><span class="hs-identifier hs-var">stg_args</span></a><span> </span><a href="#local-6989586621680976506"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-76"></a><span>      </span><span class="hs-comment">-- Note [Foreign call results]</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- tagToEnum# is special: we need to pull the constructor</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- out of the table, and perform an appropriate return.</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">cgOpApp</span><span> </span><span class="hs-special">(</span><a href="StgSyn.html#StgPrimOp"><span class="hs-identifier hs-var">StgPrimOp</span></a><span> </span><span class="hs-identifier hs-var">TagToEnumOp</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976507"><a href="#local-6989586621680976507"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621680976508"><a href="#local-6989586621680976508"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">isEnumerationTyCon</span><span> </span><span class="hs-identifier hs-var">tycon</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680976510"><a href="#local-6989586621680976510"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-84"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680976511"><a href="#local-6989586621680976511"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmEnv.html#getNonVoidArgAmodes"><span class="hs-identifier hs-var">getNonVoidArgAmodes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976507"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680976512"><a href="#local-6989586621680976512"><span class="hs-identifier">amode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680976511"><span class="hs-identifier hs-var">args'</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976513"><a href="#local-6989586621680976513"><span class="hs-identifier">amode</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680976513"><span class="hs-identifier hs-var">amode</span></a><span>
</span><a name="line-86"></a><span>                                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;TagToEnumOp had void arg&quot;</span><span>
</span><a name="line-87"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="StgCmmLayout.html#emitReturn"><span class="hs-identifier hs-var">emitReturn</span></a><span> </span><span class="hs-special">[</span><a href="StgCmmUtils.html#tagToClosure"><span class="hs-identifier hs-var">tagToClosure</span></a><span> </span><a href="#local-6989586621680976510"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976509"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-6989586621680976512"><span class="hs-identifier hs-var">amode</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-88"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>          </span><span class="hs-comment">-- If you're reading this code in the attempt to figure</span><span>
</span><a name="line-90"></a><span>          </span><span class="hs-comment">-- out why the compiler panic'ed here, it is probably because</span><span>
</span><a name="line-91"></a><span>          </span><span class="hs-comment">-- you used tagToEnum# in a non-monomorphic setting, e.g.,</span><span>
</span><a name="line-92"></a><span>          </span><span class="hs-comment">--         intToTg :: Enum a =&gt; Int -&gt; a ; intToTg (I# x#) = tagToEnum# x#</span><span>
</span><a name="line-93"></a><span>          </span><span class="hs-comment">-- That won't work.</span><span>
</span><a name="line-94"></a><span>        </span><a name="local-6989586621680976509"><a href="#local-6989586621680976509"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tyConAppTyCon</span><span> </span><a href="#local-6989586621680976508"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-identifier">cgOpApp</span><span> </span><span class="hs-special">(</span><a href="StgSyn.html#StgPrimOp"><span class="hs-identifier hs-var">StgPrimOp</span></a><span> </span><a name="local-6989586621680976514"><a href="#local-6989586621680976514"><span class="hs-identifier">primop</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680976515"><a href="#local-6989586621680976515"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621680976516"><a href="#local-6989586621680976516"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-97"></a><span>    </span><a name="local-6989586621680976517"><a href="#local-6989586621680976517"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-98"></a><span>    </span><a name="local-6989586621680976518"><a href="#local-6989586621680976518"><span class="hs-identifier">cmm_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmEnv.html#getNonVoidArgAmodes"><span class="hs-identifier hs-var">getNonVoidArgAmodes</span></a><span> </span><a href="#local-6989586621680976515"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="StgCmmPrim.html#shouldInlinePrimOp"><span class="hs-identifier hs-var">shouldInlinePrimOp</span></a><span> </span><a href="#local-6989586621680976517"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976514"><span class="hs-identifier hs-var">primop</span></a><span> </span><a href="#local-6989586621680976518"><span class="hs-identifier hs-var">cmm_args</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-100"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- out-of-line</span><span>
</span><a name="line-101"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680976519"><a href="#local-6989586621680976519"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><span class="hs-special">(</span><a href="CLabel.html#mkRtsPrimOpLabel"><span class="hs-identifier hs-var">mkRtsPrimOpLabel</span></a><span> </span><a href="#local-6989586621680976514"><span class="hs-identifier hs-var">primop</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>          </span><a href="StgCmmLayout.html#emitCall"><span class="hs-identifier hs-var">emitCall</span></a><span> </span><span class="hs-special">(</span><a href="CmmNode.html#NativeNodeCall"><span class="hs-identifier hs-var">NativeNodeCall</span></a><span class="hs-special">,</span><span> </span><a href="CmmNode.html#NativeReturn"><span class="hs-identifier hs-var">NativeReturn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976519"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621680976518"><span class="hs-identifier hs-var">cmm_args</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680976520"><a href="#local-6989586621680976520"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-comment">-- inline</span><span>
</span><a name="line-105"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ReturnsPrim</span><span> </span><span class="hs-identifier hs-var">VoidRep</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680976521"><span class="hs-identifier hs-var">result_info</span></a><span>
</span><a name="line-106"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="#local-6989586621680976520"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span>                </span><a href="StgCmmLayout.html#emitReturn"><span class="hs-identifier hs-var">emitReturn</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ReturnsPrim</span><span> </span><a name="local-6989586621680976522"><a href="#local-6989586621680976522"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680976521"><span class="hs-identifier hs-var">result_info</span></a><span>
</span><a name="line-110"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680976523"><a href="#local-6989586621680976523"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-111"></a><span>                </span><a name="local-6989586621680976524"><a href="#local-6989586621680976524"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#primRepCmmType"><span class="hs-identifier hs-var">primRepCmmType</span></a><span> </span><a href="#local-6989586621680976523"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976522"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>                </span><a href="#local-6989586621680976520"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976524"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>                </span><a href="StgCmmLayout.html#emitReturn"><span class="hs-identifier hs-var">emitReturn</span></a><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976524"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ReturnsAlg</span><span> </span><a name="local-6989586621680976525"><a href="#local-6989586621680976525"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680976521"><span class="hs-identifier hs-var">result_info</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span><span> </span><a href="#local-6989586621680976525"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-116"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680976526"><a href="#local-6989586621680976526"><span class="hs-identifier">regs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976527"><a href="#local-6989586621680976527"><span class="hs-identifier">_hints</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newUnboxedTupleRegs"><span class="hs-identifier hs-var">newUnboxedTupleRegs</span></a><span> </span><a href="#local-6989586621680976516"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-117"></a><span>                </span><a href="#local-6989586621680976520"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680976526"><span class="hs-identifier hs-var">regs</span></a><span>
</span><a name="line-118"></a><span>                </span><a href="StgCmmLayout.html#emitReturn"><span class="hs-identifier hs-var">emitReturn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976526"><span class="hs-identifier hs-var">regs</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;cgPrimop&quot;</span><span>
</span><a name="line-121"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>             </span><a name="local-6989586621680976521"><a href="#local-6989586621680976521"><span class="hs-identifier">result_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">getPrimOpResultInfo</span><span> </span><a href="#local-6989586621680976514"><span class="hs-identifier hs-var">primop</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">cgOpApp</span><span> </span><span class="hs-special">(</span><a href="StgSyn.html#StgPrimCallOp"><span class="hs-identifier hs-var">StgPrimCallOp</span></a><span> </span><a name="local-6989586621680976528"><a href="#local-6989586621680976528"><span class="hs-identifier">primcall</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680976529"><a href="#local-6989586621680976529"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621680976530"><a href="#local-6989586621680976530"><span class="hs-identifier">_res_ty</span></a></a><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680976531"><a href="#local-6989586621680976531"><span class="hs-identifier">cmm_args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmEnv.html#getNonVoidArgAmodes"><span class="hs-identifier hs-var">getNonVoidArgAmodes</span></a><span> </span><a href="#local-6989586621680976529"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-126"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680976532"><a href="#local-6989586621680976532"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><span class="hs-special">(</span><a href="CLabel.html#mkPrimCallLabel"><span class="hs-identifier hs-var">mkPrimCallLabel</span></a><span> </span><a href="#local-6989586621680976528"><span class="hs-identifier hs-var">primcall</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="StgCmmLayout.html#emitCall"><span class="hs-identifier hs-var">emitCall</span></a><span> </span><span class="hs-special">(</span><a href="CmmNode.html#NativeNodeCall"><span class="hs-identifier hs-var">NativeNodeCall</span></a><span class="hs-special">,</span><span> </span><a href="CmmNode.html#NativeReturn"><span class="hs-identifier hs-var">NativeReturn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976532"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621680976531"><span class="hs-identifier hs-var">cmm_args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- | Interpret the argument as an unsigned value, assuming the value</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- is given in two-complement form in the given width.</span><span>
</span><a name="line-131"></a><span class="hs-comment">--</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- Example: @asUnsigned W64 (-1)@ is 18446744073709551615.</span><span>
</span><a name="line-133"></a><span class="hs-comment">--</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- This function is used to work around the fact that many array</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- primops take Int# arguments, but we interpret them as unsigned</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- quantities in the code gen. This means that we have to be careful</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- every time we work on e.g. a CmmInt literal that corresponds to the</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- array size, as it might contain a negative Integer value if the</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- user passed a value larger than 2^(wORD_SIZE_IN_BITS-1) as the Int#</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- literal.</span><span>
</span><a name="line-141"></a><span class="hs-identifier">asUnsigned</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-142"></a><a name="asUnsigned"><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier">asUnsigned</span></a></a><span> </span><a name="local-6989586621680976533"><a href="#local-6989586621680976533"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621680976534"><a href="#local-6989586621680976534"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680976534"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">widthInBits</span><span> </span><a href="#local-6989586621680976533"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- TODO: Several primop implementations (e.g. 'doNewByteArrayOp') use</span><span>
</span><a name="line-145"></a><span class="hs-comment">--     ByteOff (or some other fixed width signed type) to represent</span><span>
</span><a name="line-146"></a><span class="hs-comment">--     array sizes or indices. This means that these will overflow for</span><span>
</span><a name="line-147"></a><span class="hs-comment">--     large enough sizes.</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Decide whether an out-of-line primop should be replaced by an</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- inline implementation. This might happen e.g. if there's enough</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- static information, such as statically know arguments, to emit a</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- more efficient implementation inline.</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- Returns 'Nothing' if this primop should use its out-of-line</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- implementation (defined elsewhere) and 'Just' together with a code</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- generating function that takes the output regs as arguments</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- otherwise.</span><span>
</span><a name="line-158"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-159"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span>     </span><span class="hs-comment">-- ^ The primop</span><span>
</span><a name="line-160"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The primop arguments</span><span>
</span><a name="line-161"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><a name="shouldInlinePrimOp"><a href="StgCmmPrim.html#shouldInlinePrimOp"><span class="hs-identifier">shouldInlinePrimOp</span></a></a><span> </span><a name="local-6989586621680976535"><a href="#local-6989586621680976535"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">NewByteArrayOp_Char</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976536"><a href="#local-6989586621680976536"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976537"><a href="#local-6989586621680976537"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976537"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976536"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-165"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976538"><a href="#local-6989586621680976538"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doNewByteArrayOp"><span class="hs-identifier hs-var">doNewByteArrayOp</span></a><span> </span><a href="#local-6989586621680976538"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976536"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976539"><a href="#local-6989586621680976539"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">NewArrayOp</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976540"><a href="#local-6989586621680976540"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976541"><a href="#local-6989586621680976541"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680976542"><a href="#local-6989586621680976542"><span class="hs-identifier">init</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976541"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976540"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-169"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976543"><a href="#local-6989586621680976543"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-170"></a><span>      </span><a href="StgCmmPrim.html#doNewArrayOp"><span class="hs-identifier hs-var">doNewArrayOp</span></a><span> </span><a href="#local-6989586621680976543"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsRep"><span class="hs-identifier hs-var">arrPtrsRep</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976540"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="CLabel.html#mkMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_DIRTY_infoLabel</span></a><span>
</span><a name="line-171"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976540"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-172"></a><span>         </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSizeW"><span class="hs-identifier hs-var">nonHdrSizeW</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsRep"><span class="hs-identifier hs-var">arrPtrsRep</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976540"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-174"></a><span>         </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_size</span><span> </span><a href="#local-6989586621680976539"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-176"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976540"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976542"><span class="hs-identifier hs-var">init</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopyArrayOp</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976544"><a href="#local-6989586621680976544"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976545"><a href="#local-6989586621680976545"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976546"><a href="#local-6989586621680976546"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976547"><a href="#local-6989586621680976547"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976548"><a href="#local-6989586621680976548"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-180"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopyArrayOp"><span class="hs-identifier hs-var">doCopyArrayOp</span></a><span> </span><a href="#local-6989586621680976544"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976545"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976546"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976547"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976548"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopyMutableArrayOp</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976549"><a href="#local-6989586621680976549"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976550"><a href="#local-6989586621680976550"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976551"><a href="#local-6989586621680976551"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976552"><a href="#local-6989586621680976552"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976553"><a href="#local-6989586621680976553"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-184"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopyMutableArrayOp"><span class="hs-identifier hs-var">doCopyMutableArrayOp</span></a><span> </span><a href="#local-6989586621680976549"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976550"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976551"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976552"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976553"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopyArrayArrayOp</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976554"><a href="#local-6989586621680976554"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976555"><a href="#local-6989586621680976555"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976556"><a href="#local-6989586621680976556"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976557"><a href="#local-6989586621680976557"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976558"><a href="#local-6989586621680976558"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopyArrayOp"><span class="hs-identifier hs-var">doCopyArrayOp</span></a><span> </span><a href="#local-6989586621680976554"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976555"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976556"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976557"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976558"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopyMutableArrayArrayOp</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976559"><a href="#local-6989586621680976559"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976560"><a href="#local-6989586621680976560"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976561"><a href="#local-6989586621680976561"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976562"><a href="#local-6989586621680976562"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976563"><a href="#local-6989586621680976563"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-192"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopyMutableArrayOp"><span class="hs-identifier hs-var">doCopyMutableArrayOp</span></a><span> </span><a href="#local-6989586621680976559"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976560"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976561"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976562"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976563"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976564"><a href="#local-6989586621680976564"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CloneArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976565"><a href="#local-6989586621680976565"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976566"><a href="#local-6989586621680976566"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976567"><a href="#local-6989586621680976567"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976568"><a href="#local-6989586621680976568"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976564"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976568"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976567"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976564"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-196"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976569"><a href="#local-6989586621680976569"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneArray"><span class="hs-identifier hs-var">emitCloneArray</span></a><span> </span><a href="CLabel.html#mkMAP_FROZEN_CLEAN_infoLabel"><span class="hs-identifier hs-var">mkMAP_FROZEN_CLEAN_infoLabel</span></a><span> </span><a href="#local-6989586621680976569"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976565"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976566"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976567"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976570"><a href="#local-6989586621680976570"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CloneMutableArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976571"><a href="#local-6989586621680976571"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976572"><a href="#local-6989586621680976572"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976573"><a href="#local-6989586621680976573"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976574"><a href="#local-6989586621680976574"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976570"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976574"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976573"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976570"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-200"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976575"><a href="#local-6989586621680976575"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneArray"><span class="hs-identifier hs-var">emitCloneArray</span></a><span> </span><a href="CLabel.html#mkMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_DIRTY_infoLabel</span></a><span> </span><a href="#local-6989586621680976575"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976571"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976572"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976573"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976576"><a href="#local-6989586621680976576"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">FreezeArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976577"><a href="#local-6989586621680976577"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976578"><a href="#local-6989586621680976578"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976579"><a href="#local-6989586621680976579"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976580"><a href="#local-6989586621680976580"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976576"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976580"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976579"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976576"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-204"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976581"><a href="#local-6989586621680976581"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneArray"><span class="hs-identifier hs-var">emitCloneArray</span></a><span> </span><a href="CLabel.html#mkMAP_FROZEN_CLEAN_infoLabel"><span class="hs-identifier hs-var">mkMAP_FROZEN_CLEAN_infoLabel</span></a><span> </span><a href="#local-6989586621680976581"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976577"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976578"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976579"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976582"><a href="#local-6989586621680976582"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">ThawArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976583"><a href="#local-6989586621680976583"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976584"><a href="#local-6989586621680976584"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976585"><a href="#local-6989586621680976585"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976586"><a href="#local-6989586621680976586"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976582"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976586"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976585"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976582"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-208"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976587"><a href="#local-6989586621680976587"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneArray"><span class="hs-identifier hs-var">emitCloneArray</span></a><span> </span><a href="CLabel.html#mkMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_DIRTY_infoLabel</span></a><span> </span><a href="#local-6989586621680976587"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976583"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976584"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976585"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976588"><a href="#local-6989586621680976588"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">NewSmallArrayOp</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976589"><a href="#local-6989586621680976589"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976590"><a href="#local-6989586621680976590"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680976591"><a href="#local-6989586621680976591"><span class="hs-identifier">init</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976588"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976590"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976589"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976588"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-212"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976592"><a href="#local-6989586621680976592"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-213"></a><span>      </span><a href="StgCmmPrim.html#doNewArrayOp"><span class="hs-identifier hs-var">doNewArrayOp</span></a><span> </span><a href="#local-6989586621680976592"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsRep"><span class="hs-identifier hs-var">smallArrPtrsRep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976589"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="CLabel.html#mkSMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_DIRTY_infoLabel</span></a><span>
</span><a name="line-214"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680976588"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976589"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-215"></a><span>         </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680976588"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgSmallMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680976588"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-217"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976589"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976591"><span class="hs-identifier hs-var">init</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopySmallArrayOp</span><span>
</span><a name="line-220"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976593"><a href="#local-6989586621680976593"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976594"><a href="#local-6989586621680976594"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976595"><a href="#local-6989586621680976595"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976596"><a href="#local-6989586621680976596"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976597"><a href="#local-6989586621680976597"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-221"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopySmallArrayOp"><span class="hs-identifier hs-var">doCopySmallArrayOp</span></a><span> </span><a href="#local-6989586621680976593"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976594"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976595"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976596"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976597"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">CopySmallMutableArrayOp</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621680976598"><a href="#local-6989586621680976598"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976599"><a href="#local-6989586621680976599"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976600"><a href="#local-6989586621680976600"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976601"><a href="#local-6989586621680976601"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976602"><a href="#local-6989586621680976602"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-225"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#doCopySmallMutableArrayOp"><span class="hs-identifier hs-var">doCopySmallMutableArrayOp</span></a><span> </span><a href="#local-6989586621680976598"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976599"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680976600"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680976601"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976602"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976603"><a href="#local-6989586621680976603"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CloneSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976604"><a href="#local-6989586621680976604"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976605"><a href="#local-6989586621680976605"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976606"><a href="#local-6989586621680976606"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976607"><a href="#local-6989586621680976607"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976603"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976607"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976606"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976603"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-229"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976608"><a href="#local-6989586621680976608"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneSmallArray"><span class="hs-identifier hs-var">emitCloneSmallArray</span></a><span> </span><a href="CLabel.html#mkSMAP_FROZEN_CLEAN_infoLabel"><span class="hs-identifier hs-var">mkSMAP_FROZEN_CLEAN_infoLabel</span></a><span> </span><a href="#local-6989586621680976608"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976604"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976605"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976606"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976609"><a href="#local-6989586621680976609"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CloneSmallMutableArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976610"><a href="#local-6989586621680976610"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976611"><a href="#local-6989586621680976611"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976612"><a href="#local-6989586621680976612"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976613"><a href="#local-6989586621680976613"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976609"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976613"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976612"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976609"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-233"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976614"><a href="#local-6989586621680976614"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneSmallArray"><span class="hs-identifier hs-var">emitCloneSmallArray</span></a><span> </span><a href="CLabel.html#mkSMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_DIRTY_infoLabel</span></a><span> </span><a href="#local-6989586621680976614"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976610"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976611"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976612"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976615"><a href="#local-6989586621680976615"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">FreezeSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976616"><a href="#local-6989586621680976616"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976617"><a href="#local-6989586621680976617"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976618"><a href="#local-6989586621680976618"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976619"><a href="#local-6989586621680976619"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976615"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976619"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976618"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976615"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-237"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976620"><a href="#local-6989586621680976620"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneSmallArray"><span class="hs-identifier hs-var">emitCloneSmallArray</span></a><span> </span><a href="CLabel.html#mkSMAP_FROZEN_CLEAN_infoLabel"><span class="hs-identifier hs-var">mkSMAP_FROZEN_CLEAN_infoLabel</span></a><span> </span><a href="#local-6989586621680976620"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976616"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976617"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976618"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976621"><a href="#local-6989586621680976621"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">ThawSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976622"><a href="#local-6989586621680976622"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680976623"><a href="#local-6989586621680976623"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a name="local-6989586621680976624"><a href="#local-6989586621680976624"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680976625"><a href="#local-6989586621680976625"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680976621"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#asUnsigned"><span class="hs-identifier hs-var">asUnsigned</span></a><span> </span><a href="#local-6989586621680976625"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621680976624"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maxInlineAllocSize</span><span> </span><a href="#local-6989586621680976621"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-241"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976626"><a href="#local-6989586621680976626"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitCloneSmallArray"><span class="hs-identifier hs-var">emitCloneSmallArray</span></a><span> </span><a href="CLabel.html#mkSMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_DIRTY_infoLabel</span></a><span> </span><a href="#local-6989586621680976626"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976622"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680976623"><span class="hs-identifier hs-var">src_off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621680976624"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-identifier">shouldInlinePrimOp</span><span> </span><a name="local-6989586621680976627"><a href="#local-6989586621680976627"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976628"><a href="#local-6989586621680976628"><span class="hs-identifier">primop</span></a></a><span> </span><a name="local-6989586621680976629"><a href="#local-6989586621680976629"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">primOpOutOfLine</span><span> </span><a href="#local-6989586621680976628"><span class="hs-identifier hs-var">primop</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680976630"><a href="#local-6989586621680976630"><span class="hs-identifier">regs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976627"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976630"><span class="hs-identifier hs-var">regs</span></a><span> </span><a href="#local-6989586621680976628"><span class="hs-identifier hs-var">primop</span></a><span> </span><a href="#local-6989586621680976629"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- TODO: Several primops, such as 'copyArray#', only have an inline</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- implementation (below) but could possibly have both an inline</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- implementation and an out-of-line implementation, just like</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- 'newArray#'. This would lower the amount of code generated,</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- hopefully without a performance impact (needs to be measured).</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">---------------------------------------------------</span><span>
</span><a name="line-254"></a><span class="hs-identifier">cgPrimOp</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- where to put the results</span><span>
</span><a name="line-255"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span>            </span><span class="hs-comment">-- the op</span><span>
</span><a name="line-256"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="StgSyn.html#StgArg"><span class="hs-identifier hs-type">StgArg</span></a><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- arguments</span><span>
</span><a name="line-257"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><a name="cgPrimOp"><a href="StgCmmPrim.html#cgPrimOp"><span class="hs-identifier">cgPrimOp</span></a></a><span> </span><a name="local-6989586621680976631"><a href="#local-6989586621680976631"><span class="hs-identifier">results</span></a></a><span> </span><a name="local-6989586621680976632"><a href="#local-6989586621680976632"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680976633"><a href="#local-6989586621680976633"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-260"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680976634"><a href="#local-6989586621680976634"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-261"></a><span>       </span><a name="local-6989586621680976635"><a href="#local-6989586621680976635"><span class="hs-identifier">arg_exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmEnv.html#getNonVoidArgAmodes"><span class="hs-identifier hs-var">getNonVoidArgAmodes</span></a><span> </span><a href="#local-6989586621680976633"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-262"></a><span>       </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976634"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976631"><span class="hs-identifier hs-var">results</span></a><span> </span><a href="#local-6989586621680976632"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621680976635"><span class="hs-identifier hs-var">arg_exprs</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-266"></a><span class="hs-comment">--      Emitting code for a primop</span><span>
</span><a name="line-267"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-270"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- where to put the results</span><span>
</span><a name="line-271"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span>            </span><span class="hs-comment">-- the op</span><span>
</span><a name="line-272"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- arguments</span><span>
</span><a name="line-273"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- First we handle various awkward cases specially.  The remaining</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- easy cases are then handled by translateOp, defined below.</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><a name="emitPrimOp"><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier">emitPrimOp</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976636"><a href="#local-6989586621680976636"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ParOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976637"><a href="#local-6989586621680976637"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-280"></a><span>        </span><span class="hs-comment">-- for now, just implement this in a C function</span><span>
</span><a name="line-281"></a><span>        </span><span class="hs-comment">-- later, we might want to inline it.</span><span>
</span><a name="line-282"></a><span>    </span><a href="StgCmmForeign.html#emitCCall"><span class="hs-identifier hs-var">emitCCall</span></a><span>
</span><a name="line-283"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680976636"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">NoHint</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><span class="hs-special">(</span><a href="CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;newSpark&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="CLabel.html#ForeignLabelInExternalPackage"><span class="hs-identifier hs-var">ForeignLabelInExternalPackage</span></a><span> </span><span class="hs-identifier hs-var">IsFunction</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmUtils.html#baseExpr"><span class="hs-identifier hs-var">baseExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680976637"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976638"><a href="#local-6989586621680976638"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976639"><a href="#local-6989586621680976639"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SparkOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976640"><a href="#local-6989586621680976640"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-289"></a><span>        </span><span class="hs-comment">-- returns the value of arg in res.  We're going to therefore</span><span>
</span><a name="line-290"></a><span>        </span><span class="hs-comment">-- refer to arg twice (once to pass to newSpark(), and once to</span><span>
</span><a name="line-291"></a><span>        </span><span class="hs-comment">-- assign to res), so put it in a temporary.</span><span>
</span><a name="line-292"></a><span>        </span><a name="local-6989586621680976641"><a href="#local-6989586621680976641"><span class="hs-identifier">tmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#assignTemp"><span class="hs-identifier hs-var">assignTemp</span></a><span> </span><a href="#local-6989586621680976640"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-293"></a><span>        </span><a name="local-6989586621680976642"><a href="#local-6989586621680976642"><span class="hs-identifier">tmp2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976638"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>        </span><a href="StgCmmForeign.html#emitCCall"><span class="hs-identifier hs-var">emitCCall</span></a><span>
</span><a name="line-295"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680976642"><span class="hs-identifier hs-var">tmp2</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">NoHint</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-296"></a><span>            </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><span class="hs-special">(</span><a href="CLabel.html#mkForeignLabel"><span class="hs-identifier hs-var">mkForeignLabel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fsLit</span><span> </span><span class="hs-string">&quot;newSpark&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="CLabel.html#ForeignLabelInExternalPackage"><span class="hs-identifier hs-var">ForeignLabelInExternalPackage</span></a><span> </span><span class="hs-identifier hs-var">IsFunction</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmUtils.html#baseExpr"><span class="hs-identifier hs-var">baseExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976641"><span class="hs-identifier hs-var">tmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span>        </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976639"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976641"><span class="hs-identifier hs-var">tmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976643"><a href="#local-6989586621680976643"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976644"><a href="#local-6989586621680976644"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">GetCCSOfOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976645"><a href="#local-6989586621680976645"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976644"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976646"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-303"></a><span>    </span><a name="local-6989586621680976646"><a href="#local-6989586621680976646"><span class="hs-identifier">val</span></a></a><span>
</span><a name="line-304"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">gopt</span><span> </span><span class="hs-identifier hs-var">Opt_SccProfilingOn</span><span> </span><a href="#local-6989586621680976643"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmProf.html#costCentreFrom"><span class="hs-identifier hs-var">costCentreFrom</span></a><span> </span><a href="#local-6989586621680976643"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmUntag"><span class="hs-identifier hs-var">cmmUntag</span></a><span> </span><a href="#local-6989586621680976643"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976645"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                      </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroCLit"><span class="hs-identifier hs-var">zeroCLit</span></a><span> </span><a href="#local-6989586621680976643"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976647"><a href="#local-6989586621680976647"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">GetCurrentCCSOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976648"><a href="#local-6989586621680976648"><span class="hs-identifier">_dummy_arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-308"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976647"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="CmmUtils.html#cccsExpr"><span class="hs-identifier hs-var">cccsExpr</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976649"><a href="#local-6989586621680976649"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">MyThreadIdOp</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-311"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976649"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="CmmUtils.html#currentTSOExpr"><span class="hs-identifier hs-var">currentTSOExpr</span></a><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976650"><a href="#local-6989586621680976650"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976651"><a href="#local-6989586621680976651"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadMutVarOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976652"><a href="#local-6989586621680976652"><span class="hs-identifier">mutv</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-314"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976651"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976650"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976652"><span class="hs-identifier hs-var">mutv</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976650"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621680976650"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976653"><a href="#local-6989586621680976653"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976654"><a href="#local-6989586621680976654"><span class="hs-identifier">res</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">WriteMutVarOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976655"><a href="#local-6989586621680976655"><span class="hs-identifier">mutv</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976656"><a href="#local-6989586621680976656"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-317"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Without this write barrier, other CPUs may see this pointer before</span><span>
</span><a name="line-318"></a><span>        </span><span class="hs-comment">-- the writes for the closure it points to have occurred.</span><span>
</span><a name="line-319"></a><span>        </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><a href="#local-6989586621680976654"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#MO_WriteBarrier"><span class="hs-identifier hs-var">MO_WriteBarrier</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-320"></a><span>        </span><a href="StgCmmMonad.html#emitStore"><span class="hs-identifier hs-var">emitStore</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetW"><span class="hs-identifier hs-var">cmmOffsetW</span></a><span> </span><a href="#local-6989586621680976653"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976655"><span class="hs-identifier hs-var">mutv</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976653"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976656"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-321"></a><span>        </span><a href="StgCmmForeign.html#emitCCall"><span class="hs-identifier hs-var">emitCCall</span></a><span>
</span><a name="line-322"></a><span>                </span><span class="hs-special">[</span><span class="hs-comment">{-no results-}</span><span class="hs-special">]</span><span>
</span><a name="line-323"></a><span>                </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkDirty_MUT_VAR_Label"><span class="hs-identifier hs-var">mkDirty_MUT_VAR_Label</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmUtils.html#baseExpr"><span class="hs-identifier hs-var">baseExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680976655"><span class="hs-identifier hs-var">mutv</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">AddrHint</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-comment">--  #define sizzeofByteArrayzh(r,a) \</span><span>
</span><a name="line-327"></a><span class="hs-comment">--     r = ((StgArrBytes *)(a))-&gt;bytes</span><span>
</span><a name="line-328"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976657"><a href="#local-6989586621680976657"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976658"><a href="#local-6989586621680976658"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976659"><a href="#local-6989586621680976659"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-329"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976658"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976657"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976659"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976657"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976657"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">--  #define sizzeofMutableByteArrayzh(r,a) \</span><span>
</span><a name="line-332"></a><span class="hs-comment">--      r = ((StgArrBytes *)(a))-&gt;bytes</span><span>
</span><a name="line-333"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976660"><a href="#local-6989586621680976660"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976661"><a href="#local-6989586621680976661"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofMutableByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976662"><a href="#local-6989586621680976662"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-334"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976660"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976661"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofByteArrayOp</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976662"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-comment">--  #define getSizzeofMutableByteArrayzh(r,a) \</span><span>
</span><a name="line-337"></a><span class="hs-comment">--      r = ((StgArrBytes *)(a))-&gt;bytes</span><span>
</span><a name="line-338"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976663"><a href="#local-6989586621680976663"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976664"><a href="#local-6989586621680976664"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">GetSizeofMutableByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976665"><a href="#local-6989586621680976665"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-339"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976664"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976663"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976665"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976663"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976663"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">--  #define touchzh(o)                  /* nothing */</span><span>
</span><a name="line-343"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680976666"><a href="#local-6989586621680976666"><span class="hs-identifier">res</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">TouchOp</span><span> </span><a name="local-6989586621680976667"><a href="#local-6989586621680976667"><span class="hs-identifier">args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><a name="local-6989586621680976668"><a href="#local-6989586621680976668"><span class="hs-identifier">_arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-344"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><a href="#local-6989586621680976666"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#MO_Touch"><span class="hs-identifier hs-var">MO_Touch</span></a><span> </span><a href="#local-6989586621680976667"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">--  #define byteArrayContentszh(r,a) r = BYTE_ARR_CTS(a)</span><span>
</span><a name="line-347"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976669"><a href="#local-6989586621680976669"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976670"><a href="#local-6989586621680976670"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ByteArrayContents_Char</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976671"><a href="#local-6989586621680976671"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-348"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976670"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680976669"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976671"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680976669"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">--  #define stableNameToIntzh(r,s)   (r = ((StgStableName *)s)-&gt;sn)</span><span>
</span><a name="line-351"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976672"><a href="#local-6989586621680976672"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976673"><a href="#local-6989586621680976673"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">StableNameToIntOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976674"><a href="#local-6989586621680976674"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976673"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976672"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976674"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976672"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976672"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976675"><a href="#local-6989586621680976675"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976676"><a href="#local-6989586621680976676"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReallyUnsafePtrEqualityOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976677"><a href="#local-6989586621680976677"><span class="hs-identifier">arg1</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976678"><a href="#local-6989586621680976678"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-355"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976676"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680976675"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976677"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><a href="#local-6989586621680976678"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">--  #define addrToHValuezh(r,a) r=(P_)a</span><span>
</span><a name="line-358"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976679"><a href="#local-6989586621680976679"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">AddrToAnyOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976680"><a href="#local-6989586621680976680"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-359"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976679"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976680"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span class="hs-comment">--  #define hvalueToAddrzh(r, a) r=(W_)a</span><span>
</span><a name="line-362"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976681"><a href="#local-6989586621680976681"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">AnyToAddrOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976682"><a href="#local-6989586621680976682"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-363"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976681"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976682"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-comment">{- Freezing arrays-of-ptrs requires changing an info table, for the
   benefit of the generational collector.  It needs to scavenge mutable
   objects, even if they are in old space.  When they become immutable,
   they can be removed from this scavenge list.  -}</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-comment">--  #define unsafeFreezzeArrayzh(r,a)</span><span>
</span><a name="line-371"></a><span class="hs-comment">--      {</span><span>
</span><a name="line-372"></a><span class="hs-comment">--        SET_INFO((StgClosure *)a,&amp;stg_MUT_ARR_PTRS_FROZEN_DIRTY_info);</span><span>
</span><a name="line-373"></a><span class="hs-comment">--        r = a;</span><span>
</span><a name="line-374"></a><span class="hs-comment">--      }</span><span>
</span><a name="line-375"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976683"><a href="#local-6989586621680976683"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">UnsafeFreezeArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976684"><a href="#local-6989586621680976684"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-376"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-377"></a><span>   </span><span class="hs-special">[</span><span> </span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680976684"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkMAP_FROZEN_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_FROZEN_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-378"></a><span>     </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976683"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976684"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-379"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976685"><a href="#local-6989586621680976685"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">UnsafeFreezeArrayArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976686"><a href="#local-6989586621680976686"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-380"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-381"></a><span>   </span><span class="hs-special">[</span><span> </span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680976686"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkMAP_FROZEN_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_FROZEN_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-382"></a><span>     </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976685"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976686"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-383"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976687"><a href="#local-6989586621680976687"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">UnsafeFreezeSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976688"><a href="#local-6989586621680976688"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-384"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-385"></a><span>   </span><span class="hs-special">[</span><span> </span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680976688"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkSMAP_FROZEN_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_FROZEN_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-386"></a><span>     </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976687"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976688"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">--  #define unsafeFreezzeByteArrayzh(r,a)       r=(a)</span><span>
</span><a name="line-389"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976689"><a href="#local-6989586621680976689"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">UnsafeFreezeByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976690"><a href="#local-6989586621680976690"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-390"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976689"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976690"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-comment">-- Reading/writing pointer arrays</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976691"><a href="#local-6989586621680976691"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadArrayOp</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680976692"><a href="#local-6989586621680976692"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976693"><a href="#local-6989586621680976693"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976691"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976692"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976693"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-395"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976694"><a href="#local-6989586621680976694"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">IndexArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976695"><a href="#local-6989586621680976695"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976696"><a href="#local-6989586621680976696"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976694"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976695"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976696"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-396"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976697"><a href="#local-6989586621680976697"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976698"><a href="#local-6989586621680976698"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976699"><a href="#local-6989586621680976699"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier hs-var">doWritePtrArrayOp</span></a><span> </span><a href="#local-6989586621680976697"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976698"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976699"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976700"><a href="#local-6989586621680976700"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">IndexArrayArrayOp_ByteArray</span><span>         </span><span class="hs-special">[</span><a name="local-6989586621680976701"><a href="#local-6989586621680976701"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976702"><a href="#local-6989586621680976702"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976700"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976701"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976702"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-399"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976703"><a href="#local-6989586621680976703"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">IndexArrayArrayOp_ArrayArray</span><span>        </span><span class="hs-special">[</span><a name="local-6989586621680976704"><a href="#local-6989586621680976704"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976705"><a href="#local-6989586621680976705"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976703"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976704"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976705"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-400"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976706"><a href="#local-6989586621680976706"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadArrayArrayOp_ByteArray</span><span>          </span><span class="hs-special">[</span><a name="local-6989586621680976707"><a href="#local-6989586621680976707"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976708"><a href="#local-6989586621680976708"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976706"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976707"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976708"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-401"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976709"><a href="#local-6989586621680976709"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadArrayArrayOp_MutableByteArray</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680976710"><a href="#local-6989586621680976710"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976711"><a href="#local-6989586621680976711"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976709"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976710"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976711"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-402"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976712"><a href="#local-6989586621680976712"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadArrayArrayOp_ArrayArray</span><span>         </span><span class="hs-special">[</span><a name="local-6989586621680976713"><a href="#local-6989586621680976713"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976714"><a href="#local-6989586621680976714"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976712"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976713"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976714"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-403"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976715"><a href="#local-6989586621680976715"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadArrayArrayOp_MutableArrayArray</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680976716"><a href="#local-6989586621680976716"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976717"><a href="#local-6989586621680976717"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier hs-var">doReadPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976715"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976716"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976717"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-404"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteArrayArrayOp_ByteArray</span><span>         </span><span class="hs-special">[</span><a name="local-6989586621680976718"><a href="#local-6989586621680976718"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976719"><a href="#local-6989586621680976719"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976720"><a href="#local-6989586621680976720"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier hs-var">doWritePtrArrayOp</span></a><span> </span><a href="#local-6989586621680976718"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976719"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976720"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-405"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteArrayArrayOp_MutableByteArray</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680976721"><a href="#local-6989586621680976721"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976722"><a href="#local-6989586621680976722"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976723"><a href="#local-6989586621680976723"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier hs-var">doWritePtrArrayOp</span></a><span> </span><a href="#local-6989586621680976721"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976722"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976723"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-406"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteArrayArrayOp_ArrayArray</span><span>        </span><span class="hs-special">[</span><a name="local-6989586621680976724"><a href="#local-6989586621680976724"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976725"><a href="#local-6989586621680976725"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976726"><a href="#local-6989586621680976726"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier hs-var">doWritePtrArrayOp</span></a><span> </span><a href="#local-6989586621680976724"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976725"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976726"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-407"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteArrayArrayOp_MutableArrayArray</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976727"><a href="#local-6989586621680976727"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976728"><a href="#local-6989586621680976728"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976729"><a href="#local-6989586621680976729"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier hs-var">doWritePtrArrayOp</span></a><span> </span><a href="#local-6989586621680976727"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976728"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976729"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976730"><a href="#local-6989586621680976730"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ReadSmallArrayOp</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680976731"><a href="#local-6989586621680976731"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976732"><a href="#local-6989586621680976732"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadSmallPtrArrayOp"><span class="hs-identifier hs-var">doReadSmallPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976730"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976731"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976732"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-410"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680976733"><a href="#local-6989586621680976733"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">IndexSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976734"><a href="#local-6989586621680976734"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976735"><a href="#local-6989586621680976735"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doReadSmallPtrArrayOp"><span class="hs-identifier hs-var">doReadSmallPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976733"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976734"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976735"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-411"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier hs-var">WriteSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976736"><a href="#local-6989586621680976736"><span class="hs-identifier">obj</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976737"><a href="#local-6989586621680976737"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><a name="local-6989586621680976738"><a href="#local-6989586621680976738"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteSmallPtrArrayOp"><span class="hs-identifier hs-var">doWriteSmallPtrArrayOp</span></a><span> </span><a href="#local-6989586621680976736"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621680976737"><span class="hs-identifier hs-var">ix</span></a><span> </span><a href="#local-6989586621680976738"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">-- Getting the size of pointer arrays</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976739"><a href="#local-6989586621680976739"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976740"><a href="#local-6989586621680976740"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976741"><a href="#local-6989586621680976741"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-416"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976740"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976739"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976741"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-417"></a><span>    </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976739"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="SMRep.html#bytesToWordsRoundUp"><span class="hs-identifier hs-var">bytesToWordsRoundUp</span></a><span> </span><a href="#local-6989586621680976739"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680976739"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976739"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976742"><a href="#local-6989586621680976742"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976743"><a href="#local-6989586621680976743"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofMutableArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976744"><a href="#local-6989586621680976744"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-420"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976742"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976743"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofArrayOp</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976744"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-421"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976745"><a href="#local-6989586621680976745"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976746"><a href="#local-6989586621680976746"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofArrayArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976747"><a href="#local-6989586621680976747"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-422"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976745"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976746"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofArrayOp</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976747"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-423"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976748"><a href="#local-6989586621680976748"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976749"><a href="#local-6989586621680976749"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofMutableArrayArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976750"><a href="#local-6989586621680976750"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-424"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976748"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976749"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofArrayOp</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976750"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976751"><a href="#local-6989586621680976751"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976752"><a href="#local-6989586621680976752"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofSmallArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976753"><a href="#local-6989586621680976753"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-427"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680976752"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>    </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmLoadIndexW"><span class="hs-identifier hs-var">cmmLoadIndexW</span></a><span> </span><a href="#local-6989586621680976751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680976753"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-429"></a><span>     </span><span class="hs-special">(</span><a href="SMRep.html#fixedHdrSizeW"><span class="hs-identifier hs-var">fixedHdrSizeW</span></a><span> </span><a href="#local-6989586621680976751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="SMRep.html#bytesToWordsRoundUp"><span class="hs-identifier hs-var">bytesToWordsRoundUp</span></a><span> </span><a href="#local-6989586621680976751"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">oFFSET_StgSmallMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680976751"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976751"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976754"><a href="#local-6989586621680976754"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680976755"><a href="#local-6989586621680976755"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofSmallMutableArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680976756"><a href="#local-6989586621680976756"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-432"></a><span>    </span><a href="StgCmmPrim.html#emitPrimOp"><span class="hs-identifier hs-var">emitPrimOp</span></a><span> </span><a href="#local-6989586621680976754"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976755"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SizeofSmallArrayOp</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680976756"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-comment">-- IndexXXXoffAddr</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976757"><a href="#local-6989586621680976757"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976758"><a href="#local-6989586621680976758"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Char</span><span>             </span><a name="local-6989586621680976759"><a href="#local-6989586621680976759"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976757"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976758"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976759"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-437"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976760"><a href="#local-6989586621680976760"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976761"><a href="#local-6989586621680976761"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_WideChar</span><span>         </span><a name="local-6989586621680976762"><a href="#local-6989586621680976762"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976760"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976761"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976762"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-438"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976763"><a href="#local-6989586621680976763"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976764"><a href="#local-6989586621680976764"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Int</span><span>              </span><a name="local-6989586621680976765"><a href="#local-6989586621680976765"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976763"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976764"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976765"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-439"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976766"><a href="#local-6989586621680976766"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976767"><a href="#local-6989586621680976767"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Word</span><span>             </span><a name="local-6989586621680976768"><a href="#local-6989586621680976768"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976766"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976767"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976768"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-440"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976769"><a href="#local-6989586621680976769"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976770"><a href="#local-6989586621680976770"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Addr</span><span>             </span><a name="local-6989586621680976771"><a href="#local-6989586621680976771"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976769"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976770"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976771"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-441"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976772"><a href="#local-6989586621680976772"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Float</span><span>            </span><a name="local-6989586621680976773"><a href="#local-6989586621680976773"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680976772"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976773"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-442"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976774"><a href="#local-6989586621680976774"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Double</span><span>           </span><a name="local-6989586621680976775"><a href="#local-6989586621680976775"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680976774"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976775"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-443"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976776"><a href="#local-6989586621680976776"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976777"><a href="#local-6989586621680976777"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_StablePtr</span><span>        </span><a name="local-6989586621680976778"><a href="#local-6989586621680976778"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976776"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976777"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976778"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-444"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976779"><a href="#local-6989586621680976779"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976780"><a href="#local-6989586621680976780"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Int8</span><span>             </span><a name="local-6989586621680976781"><a href="#local-6989586621680976781"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_8ToWord"><span class="hs-identifier hs-var">mo_s_8ToWord</span></a><span> </span><a href="#local-6989586621680976779"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976780"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976781"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-445"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976782"><a href="#local-6989586621680976782"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976783"><a href="#local-6989586621680976783"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Int16</span><span>            </span><a name="local-6989586621680976784"><a href="#local-6989586621680976784"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976782"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680976783"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976784"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-446"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976785"><a href="#local-6989586621680976785"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976786"><a href="#local-6989586621680976786"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Int32</span><span>            </span><a name="local-6989586621680976787"><a href="#local-6989586621680976787"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976785"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976786"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976787"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-447"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976788"><a href="#local-6989586621680976788"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Int64</span><span>            </span><a name="local-6989586621680976789"><a href="#local-6989586621680976789"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680976788"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976789"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-448"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976790"><a href="#local-6989586621680976790"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976791"><a href="#local-6989586621680976791"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Word8</span><span>            </span><a name="local-6989586621680976792"><a href="#local-6989586621680976792"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976790"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976791"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976792"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-449"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976793"><a href="#local-6989586621680976793"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976794"><a href="#local-6989586621680976794"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Word16</span><span>           </span><a name="local-6989586621680976795"><a href="#local-6989586621680976795"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680976793"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680976794"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976795"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-450"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976796"><a href="#local-6989586621680976796"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976797"><a href="#local-6989586621680976797"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Word32</span><span>           </span><a name="local-6989586621680976798"><a href="#local-6989586621680976798"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976796"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976797"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976798"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-451"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976799"><a href="#local-6989586621680976799"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexOffAddrOp_Word64</span><span>           </span><a name="local-6989586621680976800"><a href="#local-6989586621680976800"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680976799"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976800"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- ReadXXXoffAddr, which are identical, for our purposes, to IndexXXXoffAddr.</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976801"><a href="#local-6989586621680976801"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976802"><a href="#local-6989586621680976802"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Char</span><span>             </span><a name="local-6989586621680976803"><a href="#local-6989586621680976803"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976801"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976802"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976803"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-456"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976804"><a href="#local-6989586621680976804"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976805"><a href="#local-6989586621680976805"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_WideChar</span><span>         </span><a name="local-6989586621680976806"><a href="#local-6989586621680976806"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976805"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976806"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-457"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976807"><a href="#local-6989586621680976807"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976808"><a href="#local-6989586621680976808"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Int</span><span>              </span><a name="local-6989586621680976809"><a href="#local-6989586621680976809"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976807"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976808"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976809"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-458"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976810"><a href="#local-6989586621680976810"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976811"><a href="#local-6989586621680976811"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Word</span><span>             </span><a name="local-6989586621680976812"><a href="#local-6989586621680976812"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976810"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976811"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976812"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-459"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976813"><a href="#local-6989586621680976813"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976814"><a href="#local-6989586621680976814"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Addr</span><span>             </span><a name="local-6989586621680976815"><a href="#local-6989586621680976815"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976813"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976814"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976815"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-460"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976816"><a href="#local-6989586621680976816"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Float</span><span>            </span><a name="local-6989586621680976817"><a href="#local-6989586621680976817"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680976816"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976817"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-461"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976818"><a href="#local-6989586621680976818"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Double</span><span>           </span><a name="local-6989586621680976819"><a href="#local-6989586621680976819"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680976818"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976819"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-462"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976820"><a href="#local-6989586621680976820"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976821"><a href="#local-6989586621680976821"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_StablePtr</span><span>        </span><a name="local-6989586621680976822"><a href="#local-6989586621680976822"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976820"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976821"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976822"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-463"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976823"><a href="#local-6989586621680976823"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976824"><a href="#local-6989586621680976824"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Int8</span><span>             </span><a name="local-6989586621680976825"><a href="#local-6989586621680976825"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_8ToWord"><span class="hs-identifier hs-var">mo_s_8ToWord</span></a><span> </span><a href="#local-6989586621680976823"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976824"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976825"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-464"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976826"><a href="#local-6989586621680976826"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976827"><a href="#local-6989586621680976827"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Int16</span><span>            </span><a name="local-6989586621680976828"><a href="#local-6989586621680976828"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976826"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680976827"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976828"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-465"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976829"><a href="#local-6989586621680976829"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976830"><a href="#local-6989586621680976830"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Int32</span><span>            </span><a name="local-6989586621680976831"><a href="#local-6989586621680976831"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976829"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976830"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976831"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-466"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976832"><a href="#local-6989586621680976832"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Int64</span><span>            </span><a name="local-6989586621680976833"><a href="#local-6989586621680976833"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680976832"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976833"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-467"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976834"><a href="#local-6989586621680976834"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976835"><a href="#local-6989586621680976835"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Word8</span><span>            </span><a name="local-6989586621680976836"><a href="#local-6989586621680976836"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976834"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976835"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976836"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-468"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976837"><a href="#local-6989586621680976837"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976838"><a href="#local-6989586621680976838"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Word16</span><span>           </span><a name="local-6989586621680976839"><a href="#local-6989586621680976839"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680976837"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680976838"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976839"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-469"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976840"><a href="#local-6989586621680976840"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976841"><a href="#local-6989586621680976841"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Word32</span><span>           </span><a name="local-6989586621680976842"><a href="#local-6989586621680976842"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976840"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976841"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976842"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-470"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976843"><a href="#local-6989586621680976843"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadOffAddrOp_Word64</span><span>           </span><a name="local-6989586621680976844"><a href="#local-6989586621680976844"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680976843"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976844"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-comment">-- IndexXXXArray</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976845"><a href="#local-6989586621680976845"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976846"><a href="#local-6989586621680976846"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Char</span><span>             </span><a name="local-6989586621680976847"><a href="#local-6989586621680976847"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976845"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976846"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976847"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-475"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976848"><a href="#local-6989586621680976848"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976849"><a href="#local-6989586621680976849"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_WideChar</span><span>         </span><a name="local-6989586621680976850"><a href="#local-6989586621680976850"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976848"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976849"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976850"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-476"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976851"><a href="#local-6989586621680976851"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976852"><a href="#local-6989586621680976852"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Int</span><span>              </span><a name="local-6989586621680976853"><a href="#local-6989586621680976853"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976851"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976852"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976853"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-477"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976854"><a href="#local-6989586621680976854"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976855"><a href="#local-6989586621680976855"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word</span><span>             </span><a name="local-6989586621680976856"><a href="#local-6989586621680976856"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976854"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976855"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976856"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-478"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976857"><a href="#local-6989586621680976857"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976858"><a href="#local-6989586621680976858"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Addr</span><span>             </span><a name="local-6989586621680976859"><a href="#local-6989586621680976859"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976857"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976858"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976859"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-479"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976860"><a href="#local-6989586621680976860"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Float</span><span>            </span><a name="local-6989586621680976861"><a href="#local-6989586621680976861"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680976860"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976861"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-480"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976862"><a href="#local-6989586621680976862"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Double</span><span>           </span><a name="local-6989586621680976863"><a href="#local-6989586621680976863"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680976862"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976863"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-481"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976864"><a href="#local-6989586621680976864"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976865"><a href="#local-6989586621680976865"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_StablePtr</span><span>        </span><a name="local-6989586621680976866"><a href="#local-6989586621680976866"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976864"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976865"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976866"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-482"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976867"><a href="#local-6989586621680976867"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976868"><a href="#local-6989586621680976868"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Int8</span><span>             </span><a name="local-6989586621680976869"><a href="#local-6989586621680976869"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_8ToWord"><span class="hs-identifier hs-var">mo_s_8ToWord</span></a><span> </span><a href="#local-6989586621680976867"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976868"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976869"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-483"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976870"><a href="#local-6989586621680976870"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976871"><a href="#local-6989586621680976871"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Int16</span><span>            </span><a name="local-6989586621680976872"><a href="#local-6989586621680976872"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976870"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span>  </span><a href="#local-6989586621680976871"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976872"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-484"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976873"><a href="#local-6989586621680976873"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976874"><a href="#local-6989586621680976874"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Int32</span><span>            </span><a name="local-6989586621680976875"><a href="#local-6989586621680976875"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976873"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span>  </span><a href="#local-6989586621680976874"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976875"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-485"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976876"><a href="#local-6989586621680976876"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Int64</span><span>            </span><a name="local-6989586621680976877"><a href="#local-6989586621680976877"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span>  </span><a href="#local-6989586621680976876"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976877"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-486"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976878"><a href="#local-6989586621680976878"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976879"><a href="#local-6989586621680976879"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8</span><span>            </span><a name="local-6989586621680976880"><a href="#local-6989586621680976880"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976878"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976879"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976880"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-487"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976881"><a href="#local-6989586621680976881"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976882"><a href="#local-6989586621680976882"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word16</span><span>           </span><a name="local-6989586621680976883"><a href="#local-6989586621680976883"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680976881"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span>  </span><a href="#local-6989586621680976882"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976883"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-488"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976884"><a href="#local-6989586621680976884"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976885"><a href="#local-6989586621680976885"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word32</span><span>           </span><a name="local-6989586621680976886"><a href="#local-6989586621680976886"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976884"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span>  </span><a href="#local-6989586621680976885"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976886"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-489"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976887"><a href="#local-6989586621680976887"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word64</span><span>           </span><a name="local-6989586621680976888"><a href="#local-6989586621680976888"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span>  </span><a href="#local-6989586621680976887"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976888"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-comment">-- ReadXXXArray, identical to IndexXXXArray.</span><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976889"><a href="#local-6989586621680976889"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976890"><a href="#local-6989586621680976890"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Char</span><span>             </span><a name="local-6989586621680976891"><a href="#local-6989586621680976891"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976889"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976890"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976891"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-494"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976892"><a href="#local-6989586621680976892"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976893"><a href="#local-6989586621680976893"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_WideChar</span><span>         </span><a name="local-6989586621680976894"><a href="#local-6989586621680976894"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976892"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680976893"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976894"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-495"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976895"><a href="#local-6989586621680976895"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976896"><a href="#local-6989586621680976896"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Int</span><span>              </span><a name="local-6989586621680976897"><a href="#local-6989586621680976897"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976895"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976896"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976897"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-496"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976898"><a href="#local-6989586621680976898"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976899"><a href="#local-6989586621680976899"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word</span><span>             </span><a name="local-6989586621680976900"><a href="#local-6989586621680976900"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976898"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976899"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976900"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-497"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976901"><a href="#local-6989586621680976901"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976902"><a href="#local-6989586621680976902"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Addr</span><span>             </span><a name="local-6989586621680976903"><a href="#local-6989586621680976903"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976901"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976902"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976903"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-498"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976904"><a href="#local-6989586621680976904"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Float</span><span>            </span><a name="local-6989586621680976905"><a href="#local-6989586621680976905"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680976904"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976905"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-499"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976906"><a href="#local-6989586621680976906"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Double</span><span>           </span><a name="local-6989586621680976907"><a href="#local-6989586621680976907"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680976906"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976907"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-500"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976908"><a href="#local-6989586621680976908"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976909"><a href="#local-6989586621680976909"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_StablePtr</span><span>        </span><a name="local-6989586621680976910"><a href="#local-6989586621680976910"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976908"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680976909"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976910"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-501"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976911"><a href="#local-6989586621680976911"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976912"><a href="#local-6989586621680976912"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Int8</span><span>             </span><a name="local-6989586621680976913"><a href="#local-6989586621680976913"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_8ToWord"><span class="hs-identifier hs-var">mo_s_8ToWord</span></a><span> </span><a href="#local-6989586621680976911"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976912"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976913"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-502"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976914"><a href="#local-6989586621680976914"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976915"><a href="#local-6989586621680976915"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Int16</span><span>            </span><a name="local-6989586621680976916"><a href="#local-6989586621680976916"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976914"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span>  </span><a href="#local-6989586621680976915"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976916"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-503"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976917"><a href="#local-6989586621680976917"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976918"><a href="#local-6989586621680976918"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Int32</span><span>            </span><a name="local-6989586621680976919"><a href="#local-6989586621680976919"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976917"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span>  </span><a href="#local-6989586621680976918"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976919"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-504"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976920"><a href="#local-6989586621680976920"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Int64</span><span>            </span><a name="local-6989586621680976921"><a href="#local-6989586621680976921"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span>  </span><a href="#local-6989586621680976920"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976921"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-505"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976922"><a href="#local-6989586621680976922"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976923"><a href="#local-6989586621680976923"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8</span><span>            </span><a name="local-6989586621680976924"><a href="#local-6989586621680976924"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976922"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680976923"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976924"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-506"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976925"><a href="#local-6989586621680976925"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976926"><a href="#local-6989586621680976926"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word16</span><span>           </span><a name="local-6989586621680976927"><a href="#local-6989586621680976927"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680976925"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span>  </span><a href="#local-6989586621680976926"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976927"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-507"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976928"><a href="#local-6989586621680976928"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976929"><a href="#local-6989586621680976929"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word32</span><span>           </span><a name="local-6989586621680976930"><a href="#local-6989586621680976930"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976928"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span>  </span><a href="#local-6989586621680976929"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976930"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-508"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976931"><a href="#local-6989586621680976931"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word64</span><span>           </span><a name="local-6989586621680976932"><a href="#local-6989586621680976932"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span>  </span><a href="#local-6989586621680976931"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976932"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-comment">-- IndexWord8ArrayAsXXX</span><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976933"><a href="#local-6989586621680976933"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976934"><a href="#local-6989586621680976934"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsChar</span><span>      </span><a name="local-6989586621680976935"><a href="#local-6989586621680976935"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976933"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976934"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976935"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-513"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976936"><a href="#local-6989586621680976936"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976937"><a href="#local-6989586621680976937"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsWideChar</span><span>  </span><a name="local-6989586621680976938"><a href="#local-6989586621680976938"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976936"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976937"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976938"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-514"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976939"><a href="#local-6989586621680976939"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976940"><a href="#local-6989586621680976940"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsInt</span><span>       </span><a name="local-6989586621680976941"><a href="#local-6989586621680976941"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976939"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976940"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976941"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-515"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976942"><a href="#local-6989586621680976942"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976943"><a href="#local-6989586621680976943"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsWord</span><span>      </span><a name="local-6989586621680976944"><a href="#local-6989586621680976944"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976942"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976943"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976944"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-516"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976945"><a href="#local-6989586621680976945"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976946"><a href="#local-6989586621680976946"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsAddr</span><span>      </span><a name="local-6989586621680976947"><a href="#local-6989586621680976947"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976945"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976946"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976947"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-517"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976948"><a href="#local-6989586621680976948"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsFloat</span><span>     </span><a name="local-6989586621680976949"><a href="#local-6989586621680976949"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976948"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976949"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-518"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976950"><a href="#local-6989586621680976950"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsDouble</span><span>    </span><a name="local-6989586621680976951"><a href="#local-6989586621680976951"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976950"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976951"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-519"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976952"><a href="#local-6989586621680976952"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976953"><a href="#local-6989586621680976953"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsStablePtr</span><span> </span><a name="local-6989586621680976954"><a href="#local-6989586621680976954"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976952"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976953"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976954"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-520"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976955"><a href="#local-6989586621680976955"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976956"><a href="#local-6989586621680976956"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsInt16</span><span>     </span><a name="local-6989586621680976957"><a href="#local-6989586621680976957"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976955"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976956"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976957"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-521"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976958"><a href="#local-6989586621680976958"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976959"><a href="#local-6989586621680976959"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsInt32</span><span>     </span><a name="local-6989586621680976960"><a href="#local-6989586621680976960"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976958"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976959"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976960"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-522"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976961"><a href="#local-6989586621680976961"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsInt64</span><span>     </span><a name="local-6989586621680976962"><a href="#local-6989586621680976962"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976961"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976962"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-523"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976963"><a href="#local-6989586621680976963"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976964"><a href="#local-6989586621680976964"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsWord16</span><span>    </span><a name="local-6989586621680976965"><a href="#local-6989586621680976965"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680976963"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976964"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976965"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-524"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976966"><a href="#local-6989586621680976966"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976967"><a href="#local-6989586621680976967"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsWord32</span><span>    </span><a name="local-6989586621680976968"><a href="#local-6989586621680976968"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976966"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976967"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976968"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-525"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976969"><a href="#local-6989586621680976969"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">IndexByteArrayOp_Word8AsWord64</span><span>    </span><a name="local-6989586621680976970"><a href="#local-6989586621680976970"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976969"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976970"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-comment">-- ReadInt8ArrayAsXXX, identical to IndexInt8ArrayAsXXX</span><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976971"><a href="#local-6989586621680976971"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976972"><a href="#local-6989586621680976972"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsChar</span><span>      </span><a name="local-6989586621680976973"><a href="#local-6989586621680976973"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span> </span><a href="#local-6989586621680976971"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976972"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976973"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-530"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976974"><a href="#local-6989586621680976974"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976975"><a href="#local-6989586621680976975"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsWideChar</span><span>  </span><a name="local-6989586621680976976"><a href="#local-6989586621680976976"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680976974"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976975"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976976"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-531"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976977"><a href="#local-6989586621680976977"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976978"><a href="#local-6989586621680976978"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsInt</span><span>       </span><a name="local-6989586621680976979"><a href="#local-6989586621680976979"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976977"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976978"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976979"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-532"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976980"><a href="#local-6989586621680976980"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976981"><a href="#local-6989586621680976981"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsWord</span><span>      </span><a name="local-6989586621680976982"><a href="#local-6989586621680976982"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976980"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976981"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976982"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-533"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976983"><a href="#local-6989586621680976983"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976984"><a href="#local-6989586621680976984"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsAddr</span><span>      </span><a name="local-6989586621680976985"><a href="#local-6989586621680976985"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976983"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976984"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976985"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-534"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976986"><a href="#local-6989586621680976986"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsFloat</span><span>     </span><a name="local-6989586621680976987"><a href="#local-6989586621680976987"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976986"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976987"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-535"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976988"><a href="#local-6989586621680976988"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsDouble</span><span>    </span><a name="local-6989586621680976989"><a href="#local-6989586621680976989"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976988"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976989"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-536"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976990"><a href="#local-6989586621680976990"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976991"><a href="#local-6989586621680976991"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsStablePtr</span><span> </span><a name="local-6989586621680976992"><a href="#local-6989586621680976992"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680976990"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976991"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976992"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-537"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976993"><a href="#local-6989586621680976993"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976994"><a href="#local-6989586621680976994"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsInt16</span><span>     </span><a name="local-6989586621680976995"><a href="#local-6989586621680976995"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680976993"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976994"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976995"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-538"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680976996"><a href="#local-6989586621680976996"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680976997"><a href="#local-6989586621680976997"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsInt32</span><span>     </span><a name="local-6989586621680976998"><a href="#local-6989586621680976998"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680976996"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976997"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680976998"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-539"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680976999"><a href="#local-6989586621680976999"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsInt64</span><span>     </span><a name="local-6989586621680977000"><a href="#local-6989586621680977000"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680976999"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977000"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-540"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977001"><a href="#local-6989586621680977001"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977002"><a href="#local-6989586621680977002"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsWord16</span><span>    </span><a name="local-6989586621680977003"><a href="#local-6989586621680977003"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680977001"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977002"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977003"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-541"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977004"><a href="#local-6989586621680977004"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977005"><a href="#local-6989586621680977005"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsWord32</span><span>    </span><a name="local-6989586621680977006"><a href="#local-6989586621680977006"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680977004"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977005"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977006"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-542"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977007"><a href="#local-6989586621680977007"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">ReadByteArrayOp_Word8AsWord64</span><span>    </span><a name="local-6989586621680977008"><a href="#local-6989586621680977008"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977007"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977008"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- WriteXXXoffAddr</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977009"><a href="#local-6989586621680977009"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977010"><a href="#local-6989586621680977010"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Char</span><span>             </span><a name="local-6989586621680977011"><a href="#local-6989586621680977011"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977009"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977010"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977011"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-547"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977012"><a href="#local-6989586621680977012"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977013"><a href="#local-6989586621680977013"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_WideChar</span><span>         </span><a name="local-6989586621680977014"><a href="#local-6989586621680977014"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977012"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977013"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977014"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-548"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977015"><a href="#local-6989586621680977015"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977016"><a href="#local-6989586621680977016"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Int</span><span>              </span><a name="local-6989586621680977017"><a href="#local-6989586621680977017"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977015"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977016"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977017"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-549"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977018"><a href="#local-6989586621680977018"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977019"><a href="#local-6989586621680977019"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Word</span><span>             </span><a name="local-6989586621680977020"><a href="#local-6989586621680977020"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977018"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977019"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977020"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-550"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977021"><a href="#local-6989586621680977021"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977022"><a href="#local-6989586621680977022"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Addr</span><span>             </span><a name="local-6989586621680977023"><a href="#local-6989586621680977023"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977021"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977022"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977023"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-551"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977024"><a href="#local-6989586621680977024"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Float</span><span>            </span><a name="local-6989586621680977025"><a href="#local-6989586621680977025"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680977024"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977025"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-552"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977026"><a href="#local-6989586621680977026"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Double</span><span>           </span><a name="local-6989586621680977027"><a href="#local-6989586621680977027"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680977026"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977027"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-553"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977028"><a href="#local-6989586621680977028"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977029"><a href="#local-6989586621680977029"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_StablePtr</span><span>        </span><a name="local-6989586621680977030"><a href="#local-6989586621680977030"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977028"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977029"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977030"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-554"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977031"><a href="#local-6989586621680977031"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977032"><a href="#local-6989586621680977032"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Int8</span><span>             </span><a name="local-6989586621680977033"><a href="#local-6989586621680977033"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977031"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977032"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977033"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-555"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977034"><a href="#local-6989586621680977034"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977035"><a href="#local-6989586621680977035"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Int16</span><span>            </span><a name="local-6989586621680977036"><a href="#local-6989586621680977036"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977034"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680977035"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977036"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-556"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977037"><a href="#local-6989586621680977037"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977038"><a href="#local-6989586621680977038"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Int32</span><span>            </span><a name="local-6989586621680977039"><a href="#local-6989586621680977039"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977037"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977038"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977039"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-557"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977040"><a href="#local-6989586621680977040"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Int64</span><span>            </span><a name="local-6989586621680977041"><a href="#local-6989586621680977041"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680977040"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977041"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-558"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977042"><a href="#local-6989586621680977042"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977043"><a href="#local-6989586621680977043"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Word8</span><span>            </span><a name="local-6989586621680977044"><a href="#local-6989586621680977044"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977042"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977043"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977044"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-559"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977045"><a href="#local-6989586621680977045"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977046"><a href="#local-6989586621680977046"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Word16</span><span>           </span><a name="local-6989586621680977047"><a href="#local-6989586621680977047"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977045"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680977046"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977047"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-560"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977048"><a href="#local-6989586621680977048"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977049"><a href="#local-6989586621680977049"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Word32</span><span>           </span><a name="local-6989586621680977050"><a href="#local-6989586621680977050"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977048"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977049"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977050"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-561"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977051"><a href="#local-6989586621680977051"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteOffAddrOp_Word64</span><span>           </span><a name="local-6989586621680977052"><a href="#local-6989586621680977052"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680977051"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977052"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-562"></a><span>
</span><a name="line-563"></a><span class="hs-comment">-- WriteXXXArray</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977053"><a href="#local-6989586621680977053"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977054"><a href="#local-6989586621680977054"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Char</span><span>             </span><a name="local-6989586621680977055"><a href="#local-6989586621680977055"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977053"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977054"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977055"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-566"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977056"><a href="#local-6989586621680977056"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977057"><a href="#local-6989586621680977057"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_WideChar</span><span>         </span><a name="local-6989586621680977058"><a href="#local-6989586621680977058"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977056"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977057"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977058"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-567"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977059"><a href="#local-6989586621680977059"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977060"><a href="#local-6989586621680977060"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Int</span><span>              </span><a name="local-6989586621680977061"><a href="#local-6989586621680977061"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977059"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977060"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977061"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-568"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977062"><a href="#local-6989586621680977062"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977063"><a href="#local-6989586621680977063"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word</span><span>             </span><a name="local-6989586621680977064"><a href="#local-6989586621680977064"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977062"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977063"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977064"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-569"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977065"><a href="#local-6989586621680977065"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977066"><a href="#local-6989586621680977066"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Addr</span><span>             </span><a name="local-6989586621680977067"><a href="#local-6989586621680977067"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977065"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977066"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977067"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-570"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977068"><a href="#local-6989586621680977068"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Float</span><span>            </span><a name="local-6989586621680977069"><a href="#local-6989586621680977069"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f32</span><span> </span><a href="#local-6989586621680977068"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977069"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-571"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977070"><a href="#local-6989586621680977070"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Double</span><span>           </span><a name="local-6989586621680977071"><a href="#local-6989586621680977071"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">f64</span><span> </span><a href="#local-6989586621680977070"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977071"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-572"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977072"><a href="#local-6989586621680977072"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977073"><a href="#local-6989586621680977073"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_StablePtr</span><span>        </span><a name="local-6989586621680977074"><a href="#local-6989586621680977074"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977072"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977073"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977074"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-573"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977075"><a href="#local-6989586621680977075"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977076"><a href="#local-6989586621680977076"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Int8</span><span>             </span><a name="local-6989586621680977077"><a href="#local-6989586621680977077"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977075"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977076"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977077"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-574"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977078"><a href="#local-6989586621680977078"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977079"><a href="#local-6989586621680977079"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Int16</span><span>            </span><a name="local-6989586621680977080"><a href="#local-6989586621680977080"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977078"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680977079"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977080"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-575"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977081"><a href="#local-6989586621680977081"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977082"><a href="#local-6989586621680977082"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Int32</span><span>            </span><a name="local-6989586621680977083"><a href="#local-6989586621680977083"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977081"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977082"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977083"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-576"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977084"><a href="#local-6989586621680977084"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Int64</span><span>            </span><a name="local-6989586621680977085"><a href="#local-6989586621680977085"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680977084"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977085"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-577"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977086"><a href="#local-6989586621680977086"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977087"><a href="#local-6989586621680977087"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8</span><span>            </span><a name="local-6989586621680977088"><a href="#local-6989586621680977088"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977086"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span>  </span><a href="#local-6989586621680977087"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977088"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-578"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977089"><a href="#local-6989586621680977089"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977090"><a href="#local-6989586621680977090"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word16</span><span>           </span><a name="local-6989586621680977091"><a href="#local-6989586621680977091"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977089"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b16</span><span> </span><a href="#local-6989586621680977090"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977091"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-579"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977092"><a href="#local-6989586621680977092"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977093"><a href="#local-6989586621680977093"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word32</span><span>           </span><a name="local-6989586621680977094"><a href="#local-6989586621680977094"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977092"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b32</span><span> </span><a href="#local-6989586621680977093"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977094"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-580"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977095"><a href="#local-6989586621680977095"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word64</span><span>           </span><a name="local-6989586621680977096"><a href="#local-6989586621680977096"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b64</span><span> </span><a href="#local-6989586621680977095"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977096"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-comment">-- WriteInt8ArrayAsXXX</span><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977097"><a href="#local-6989586621680977097"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977098"><a href="#local-6989586621680977098"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsChar</span><span>       </span><a name="local-6989586621680977099"><a href="#local-6989586621680977099"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span> </span><a href="#local-6989586621680977097"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977098"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977099"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-585"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977100"><a href="#local-6989586621680977100"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977101"><a href="#local-6989586621680977101"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsWideChar</span><span>   </span><a name="local-6989586621680977102"><a href="#local-6989586621680977102"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977100"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977101"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977102"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-586"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977103"><a href="#local-6989586621680977103"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsInt</span><span>        </span><a name="local-6989586621680977104"><a href="#local-6989586621680977104"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977103"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977104"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-587"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977105"><a href="#local-6989586621680977105"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsWord</span><span>       </span><a name="local-6989586621680977106"><a href="#local-6989586621680977106"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977105"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977106"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-588"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977107"><a href="#local-6989586621680977107"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsAddr</span><span>       </span><a name="local-6989586621680977108"><a href="#local-6989586621680977108"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977107"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977108"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-589"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977109"><a href="#local-6989586621680977109"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsFloat</span><span>      </span><a name="local-6989586621680977110"><a href="#local-6989586621680977110"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977109"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977110"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-590"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977111"><a href="#local-6989586621680977111"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsDouble</span><span>     </span><a name="local-6989586621680977112"><a href="#local-6989586621680977112"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977111"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977112"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-591"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977113"><a href="#local-6989586621680977113"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsStablePtr</span><span>  </span><a name="local-6989586621680977114"><a href="#local-6989586621680977114"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977113"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977114"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-592"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977115"><a href="#local-6989586621680977115"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977116"><a href="#local-6989586621680977116"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsInt16</span><span>      </span><a name="local-6989586621680977117"><a href="#local-6989586621680977117"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977115"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977116"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977117"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-593"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977118"><a href="#local-6989586621680977118"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977119"><a href="#local-6989586621680977119"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsInt32</span><span>      </span><a name="local-6989586621680977120"><a href="#local-6989586621680977120"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977118"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977119"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977120"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-594"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977121"><a href="#local-6989586621680977121"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsInt64</span><span>      </span><a name="local-6989586621680977122"><a href="#local-6989586621680977122"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977121"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977122"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-595"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977123"><a href="#local-6989586621680977123"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977124"><a href="#local-6989586621680977124"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsWord16</span><span>     </span><a name="local-6989586621680977125"><a href="#local-6989586621680977125"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977123"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977124"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977125"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-596"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977126"><a href="#local-6989586621680977126"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977127"><a href="#local-6989586621680977127"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsWord32</span><span>     </span><a name="local-6989586621680977128"><a href="#local-6989586621680977128"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977126"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977127"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977128"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-597"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621680977129"><a href="#local-6989586621680977129"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-identifier hs-var">WriteByteArrayOp_Word8AsWord64</span><span>     </span><a name="local-6989586621680977130"><a href="#local-6989586621680977130"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">b8</span><span> </span><a href="#local-6989586621680977129"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977130"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span class="hs-comment">-- Copying and setting byte arrays</span><span>
</span><a name="line-600"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CopyByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977131"><a href="#local-6989586621680977131"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977132"><a href="#local-6989586621680977132"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977133"><a href="#local-6989586621680977133"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977134"><a href="#local-6989586621680977134"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977135"><a href="#local-6989586621680977135"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-601"></a><span>    </span><a href="StgCmmPrim.html#doCopyByteArrayOp"><span class="hs-identifier hs-var">doCopyByteArrayOp</span></a><span> </span><a href="#local-6989586621680977131"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977132"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680977133"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977134"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><a href="#local-6989586621680977135"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-602"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CopyMutableByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977136"><a href="#local-6989586621680977136"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977137"><a href="#local-6989586621680977137"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977138"><a href="#local-6989586621680977138"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977139"><a href="#local-6989586621680977139"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977140"><a href="#local-6989586621680977140"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-603"></a><span>    </span><a href="StgCmmPrim.html#doCopyMutableByteArrayOp"><span class="hs-identifier hs-var">doCopyMutableByteArrayOp</span></a><span> </span><a href="#local-6989586621680977136"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977137"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680977138"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977139"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><a href="#local-6989586621680977140"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-604"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CopyByteArrayToAddrOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977141"><a href="#local-6989586621680977141"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977142"><a href="#local-6989586621680977142"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977143"><a href="#local-6989586621680977143"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977144"><a href="#local-6989586621680977144"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-605"></a><span>    </span><a href="StgCmmPrim.html#doCopyByteArrayToAddrOp"><span class="hs-identifier hs-var">doCopyByteArrayToAddrOp</span></a><span> </span><a href="#local-6989586621680977141"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977142"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680977143"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977144"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-606"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CopyMutableByteArrayToAddrOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977145"><a href="#local-6989586621680977145"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977146"><a href="#local-6989586621680977146"><span class="hs-identifier">src_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977147"><a href="#local-6989586621680977147"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977148"><a href="#local-6989586621680977148"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-607"></a><span>    </span><a href="StgCmmPrim.html#doCopyMutableByteArrayToAddrOp"><span class="hs-identifier hs-var">doCopyMutableByteArrayToAddrOp</span></a><span> </span><a href="#local-6989586621680977145"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977146"><span class="hs-identifier hs-var">src_off</span></a><span> </span><a href="#local-6989586621680977147"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977148"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-608"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CopyAddrToByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977149"><a href="#local-6989586621680977149"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977150"><a href="#local-6989586621680977150"><span class="hs-identifier">dst</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977151"><a href="#local-6989586621680977151"><span class="hs-identifier">dst_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977152"><a href="#local-6989586621680977152"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-609"></a><span>    </span><a href="StgCmmPrim.html#doCopyAddrToByteArrayOp"><span class="hs-identifier hs-var">doCopyAddrToByteArrayOp</span></a><span> </span><a href="#local-6989586621680977149"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977150"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977151"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><a href="#local-6989586621680977152"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-610"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">SetByteArrayOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977153"><a href="#local-6989586621680977153"><span class="hs-identifier">ba</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977154"><a href="#local-6989586621680977154"><span class="hs-identifier">off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977155"><a href="#local-6989586621680977155"><span class="hs-identifier">len</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977156"><a href="#local-6989586621680977156"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-611"></a><span>    </span><a href="StgCmmPrim.html#doSetByteArrayOp"><span class="hs-identifier hs-var">doSetByteArrayOp</span></a><span> </span><a href="#local-6989586621680977153"><span class="hs-identifier hs-var">ba</span></a><span> </span><a href="#local-6989586621680977154"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="#local-6989586621680977155"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977156"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span class="hs-comment">-- Comparing byte arrays</span><span>
</span><a name="line-614"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977157"><a href="#local-6989586621680977157"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CompareByteArraysOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977158"><a href="#local-6989586621680977158"><span class="hs-identifier">ba1</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977159"><a href="#local-6989586621680977159"><span class="hs-identifier">ba1_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977160"><a href="#local-6989586621680977160"><span class="hs-identifier">ba2</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977161"><a href="#local-6989586621680977161"><span class="hs-identifier">ba2_off</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977162"><a href="#local-6989586621680977162"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-615"></a><span>    </span><a href="StgCmmPrim.html#doCompareByteArraysOp"><span class="hs-identifier hs-var">doCompareByteArraysOp</span></a><span> </span><a href="#local-6989586621680977157"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977158"><span class="hs-identifier hs-var">ba1</span></a><span> </span><a href="#local-6989586621680977159"><span class="hs-identifier hs-var">ba1_off</span></a><span> </span><a href="#local-6989586621680977160"><span class="hs-identifier hs-var">ba2</span></a><span> </span><a href="#local-6989586621680977161"><span class="hs-identifier hs-var">ba2_off</span></a><span> </span><a href="#local-6989586621680977162"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977163"><a href="#local-6989586621680977163"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">BSwap16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977164"><a href="#local-6989586621680977164"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitBSwapCall"><span class="hs-identifier hs-var">emitBSwapCall</span></a><span> </span><a href="#local-6989586621680977163"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977164"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-618"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977165"><a href="#local-6989586621680977165"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">BSwap32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977166"><a href="#local-6989586621680977166"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitBSwapCall"><span class="hs-identifier hs-var">emitBSwapCall</span></a><span> </span><a href="#local-6989586621680977165"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977166"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-619"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977167"><a href="#local-6989586621680977167"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">BSwap64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977168"><a href="#local-6989586621680977168"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitBSwapCall"><span class="hs-identifier hs-var">emitBSwapCall</span></a><span> </span><a href="#local-6989586621680977167"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977168"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-620"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977169"><a href="#local-6989586621680977169"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977170"><a href="#local-6989586621680977170"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">BSwapOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977171"><a href="#local-6989586621680977171"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitBSwapCall"><span class="hs-identifier hs-var">emitBSwapCall</span></a><span> </span><a href="#local-6989586621680977170"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977171"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977169"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-comment">-- Population count</span><span>
</span><a name="line-623"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977172"><a href="#local-6989586621680977172"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PopCnt8Op</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977173"><a href="#local-6989586621680977173"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier hs-var">emitPopCntCall</span></a><span> </span><a href="#local-6989586621680977172"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977173"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span>
</span><a name="line-624"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977174"><a href="#local-6989586621680977174"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PopCnt16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977175"><a href="#local-6989586621680977175"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier hs-var">emitPopCntCall</span></a><span> </span><a href="#local-6989586621680977174"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977175"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-625"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977176"><a href="#local-6989586621680977176"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PopCnt32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977177"><a href="#local-6989586621680977177"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier hs-var">emitPopCntCall</span></a><span> </span><a href="#local-6989586621680977176"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977177"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-626"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977178"><a href="#local-6989586621680977178"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PopCnt64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977179"><a href="#local-6989586621680977179"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier hs-var">emitPopCntCall</span></a><span> </span><a href="#local-6989586621680977178"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977179"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-627"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977180"><a href="#local-6989586621680977180"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977181"><a href="#local-6989586621680977181"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PopCntOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977182"><a href="#local-6989586621680977182"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier hs-var">emitPopCntCall</span></a><span> </span><a href="#local-6989586621680977181"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977182"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977180"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span class="hs-comment">-- Parallel bit deposit</span><span>
</span><a name="line-630"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977183"><a href="#local-6989586621680977183"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pdep8Op</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977184"><a href="#local-6989586621680977184"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977185"><a href="#local-6989586621680977185"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier hs-var">emitPdepCall</span></a><span> </span><a href="#local-6989586621680977183"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977184"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977185"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span>
</span><a name="line-631"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977186"><a href="#local-6989586621680977186"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pdep16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977187"><a href="#local-6989586621680977187"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977188"><a href="#local-6989586621680977188"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier hs-var">emitPdepCall</span></a><span> </span><a href="#local-6989586621680977186"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977187"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977188"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-632"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977189"><a href="#local-6989586621680977189"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pdep32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977190"><a href="#local-6989586621680977190"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977191"><a href="#local-6989586621680977191"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier hs-var">emitPdepCall</span></a><span> </span><a href="#local-6989586621680977189"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977190"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977191"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-633"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977192"><a href="#local-6989586621680977192"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pdep64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977193"><a href="#local-6989586621680977193"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977194"><a href="#local-6989586621680977194"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier hs-var">emitPdepCall</span></a><span> </span><a href="#local-6989586621680977192"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977193"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977194"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-634"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977195"><a href="#local-6989586621680977195"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977196"><a href="#local-6989586621680977196"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PdepOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977197"><a href="#local-6989586621680977197"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977198"><a href="#local-6989586621680977198"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier hs-var">emitPdepCall</span></a><span> </span><a href="#local-6989586621680977196"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977197"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977198"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977195"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- Parallel bit extract</span><span>
</span><a name="line-637"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977199"><a href="#local-6989586621680977199"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pext8Op</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977200"><a href="#local-6989586621680977200"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977201"><a href="#local-6989586621680977201"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier hs-var">emitPextCall</span></a><span> </span><a href="#local-6989586621680977199"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977200"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977201"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span>
</span><a name="line-638"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977202"><a href="#local-6989586621680977202"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pext16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977203"><a href="#local-6989586621680977203"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977204"><a href="#local-6989586621680977204"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier hs-var">emitPextCall</span></a><span> </span><a href="#local-6989586621680977202"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977203"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977204"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-639"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977205"><a href="#local-6989586621680977205"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pext32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977206"><a href="#local-6989586621680977206"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977207"><a href="#local-6989586621680977207"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier hs-var">emitPextCall</span></a><span> </span><a href="#local-6989586621680977205"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977206"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977207"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-640"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977208"><a href="#local-6989586621680977208"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Pext64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977209"><a href="#local-6989586621680977209"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977210"><a href="#local-6989586621680977210"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier hs-var">emitPextCall</span></a><span> </span><a href="#local-6989586621680977208"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977209"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977210"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-641"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977211"><a href="#local-6989586621680977211"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977212"><a href="#local-6989586621680977212"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PextOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977213"><a href="#local-6989586621680977213"><span class="hs-identifier">src</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977214"><a href="#local-6989586621680977214"><span class="hs-identifier">mask</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier hs-var">emitPextCall</span></a><span> </span><a href="#local-6989586621680977212"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977213"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977214"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977211"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-comment">-- count leading zeros</span><span>
</span><a name="line-644"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977215"><a href="#local-6989586621680977215"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Clz8Op</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977216"><a href="#local-6989586621680977216"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier hs-var">emitClzCall</span></a><span> </span><a href="#local-6989586621680977215"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977216"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span>
</span><a name="line-645"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977217"><a href="#local-6989586621680977217"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Clz16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977218"><a href="#local-6989586621680977218"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier hs-var">emitClzCall</span></a><span> </span><a href="#local-6989586621680977217"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977218"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-646"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977219"><a href="#local-6989586621680977219"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Clz32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977220"><a href="#local-6989586621680977220"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier hs-var">emitClzCall</span></a><span> </span><a href="#local-6989586621680977219"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977220"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-647"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977221"><a href="#local-6989586621680977221"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Clz64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977222"><a href="#local-6989586621680977222"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier hs-var">emitClzCall</span></a><span> </span><a href="#local-6989586621680977221"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977222"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-648"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977223"><a href="#local-6989586621680977223"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977224"><a href="#local-6989586621680977224"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">ClzOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977225"><a href="#local-6989586621680977225"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier hs-var">emitClzCall</span></a><span> </span><a href="#local-6989586621680977224"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977225"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977223"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span class="hs-comment">-- count trailing zeros</span><span>
</span><a name="line-651"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977226"><a href="#local-6989586621680977226"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Ctz8Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977227"><a href="#local-6989586621680977227"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier hs-var">emitCtzCall</span></a><span> </span><a href="#local-6989586621680977226"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977227"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span>
</span><a name="line-652"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977228"><a href="#local-6989586621680977228"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Ctz16Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977229"><a href="#local-6989586621680977229"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier hs-var">emitCtzCall</span></a><span> </span><a href="#local-6989586621680977228"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977229"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span>
</span><a name="line-653"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977230"><a href="#local-6989586621680977230"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Ctz32Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977231"><a href="#local-6989586621680977231"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier hs-var">emitCtzCall</span></a><span> </span><a href="#local-6989586621680977230"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977231"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-654"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977232"><a href="#local-6989586621680977232"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Ctz64Op</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977233"><a href="#local-6989586621680977233"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier hs-var">emitCtzCall</span></a><span> </span><a href="#local-6989586621680977232"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977233"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-655"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977234"><a href="#local-6989586621680977234"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977235"><a href="#local-6989586621680977235"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CtzOp</span><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977236"><a href="#local-6989586621680977236"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier hs-var">emitCtzCall</span></a><span> </span><a href="#local-6989586621680977235"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977236"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977234"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-comment">-- Unsigned int to floating point conversions</span><span>
</span><a name="line-658"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977237"><a href="#local-6989586621680977237"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Word2FloatOp</span><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977238"><a href="#local-6989586621680977238"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977237"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-659"></a><span>                                            </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UF_Conv"><span class="hs-identifier hs-var">MO_UF_Conv</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977238"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span>
</span><a name="line-660"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><a name="local-6989586621680977239"><a href="#local-6989586621680977239"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Word2DoubleOp</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977240"><a href="#local-6989586621680977240"><span class="hs-identifier">w</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977239"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-661"></a><span>                                            </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UF_Conv"><span class="hs-identifier hs-var">MO_UF_Conv</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977240"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span>
</span><a name="line-662"></a><span>
</span><a name="line-663"></a><span class="hs-comment">-- SIMD primops</span><span>
</span><a name="line-664"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977241"><a href="#local-6989586621680977241"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977242"><a href="#local-6989586621680977242"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecBroadcastOp</span><span> </span><a name="local-6989586621680977243"><a href="#local-6989586621680977243"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977244"><a href="#local-6989586621680977244"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977245"><a href="#local-6989586621680977245"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977246"><a href="#local-6989586621680977246"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-665"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977241"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977243"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977244"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-666"></a><span>    </span><a href="StgCmmPrim.html#doVecPackOp"><span class="hs-identifier hs-var">doVecPackOp</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecElemInjectCast"><span class="hs-identifier hs-var">vecElemInjectCast</span></a><span> </span><a href="#local-6989586621680977241"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977243"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977249"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977247"><span class="hs-identifier hs-var">zeros</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621680977244"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977246"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977242"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-667"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-668"></a><span>    </span><span class="hs-identifier">zeros</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-669"></a><span>    </span><a name="local-6989586621680977247"><a href="#local-6989586621680977247"><span class="hs-identifier">zeros</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmExpr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621680977244"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977248"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span>    </span><span class="hs-identifier">zero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span>
</span><a name="line-672"></a><span>    </span><a name="local-6989586621680977248"><a href="#local-6989586621680977248"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977243"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-673"></a><span>             </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-674"></a><span>             </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-675"></a><span>             </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmFloat"><span class="hs-identifier hs-var">CmmFloat</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-678"></a><span>    </span><a name="local-6989586621680977249"><a href="#local-6989586621680977249"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977243"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977244"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977245"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977250"><a href="#local-6989586621680977250"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977251"><a href="#local-6989586621680977251"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecPackOp</span><span> </span><a name="local-6989586621680977252"><a href="#local-6989586621680977252"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977253"><a href="#local-6989586621680977253"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977254"><a href="#local-6989586621680977254"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977255"><a href="#local-6989586621680977255"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-681"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977250"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977252"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977253"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-682"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977255"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIsNot</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680977253"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-683"></a><span>        </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;emitPrimOp: VecPackOp has wrong number of arguments&quot;</span><span>
</span><a name="line-684"></a><span>    </span><a href="StgCmmPrim.html#doVecPackOp"><span class="hs-identifier hs-var">doVecPackOp</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecElemInjectCast"><span class="hs-identifier hs-var">vecElemInjectCast</span></a><span> </span><a href="#local-6989586621680977250"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977252"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977258"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977256"><span class="hs-identifier hs-var">zeros</span></a><span> </span><a href="#local-6989586621680977255"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621680977251"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-685"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-686"></a><span>    </span><span class="hs-identifier">zeros</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-687"></a><span>    </span><a name="local-6989586621680977256"><a href="#local-6989586621680977256"><span class="hs-identifier">zeros</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmExpr.html#CmmVec"><span class="hs-identifier hs-var">CmmVec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621680977253"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977257"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>
</span><a name="line-689"></a><span>    </span><span class="hs-identifier">zero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a><span>
</span><a name="line-690"></a><span>    </span><a name="local-6989586621680977257"><a href="#local-6989586621680977257"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977252"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-691"></a><span>             </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-692"></a><span>             </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-693"></a><span>             </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmFloat"><span class="hs-identifier hs-var">CmmFloat</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-696"></a><span>    </span><a name="local-6989586621680977258"><a href="#local-6989586621680977258"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977252"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977253"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977254"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977259"><a href="#local-6989586621680977259"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977260"><a href="#local-6989586621680977260"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecUnpackOp</span><span> </span><a name="local-6989586621680977261"><a href="#local-6989586621680977261"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977262"><a href="#local-6989586621680977262"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977263"><a href="#local-6989586621680977263"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977264"><a href="#local-6989586621680977264"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-699"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977259"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977261"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977262"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977263"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-700"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977260"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">lengthIsNot</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621680977262"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-701"></a><span>        </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;emitPrimOp: VecUnpackOp has wrong number of results&quot;</span><span>
</span><a name="line-702"></a><span>    </span><a href="StgCmmPrim.html#doVecUnpackOp"><span class="hs-identifier hs-var">doVecUnpackOp</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecElemProjectCast"><span class="hs-identifier hs-var">vecElemProjectCast</span></a><span> </span><a href="#local-6989586621680977259"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977261"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977263"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977265"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977264"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-6989586621680977260"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-703"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-704"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-705"></a><span>    </span><a name="local-6989586621680977265"><a href="#local-6989586621680977265"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977261"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977262"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977263"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-706"></a><span>
</span><a name="line-707"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977266"><a href="#local-6989586621680977266"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977267"><a href="#local-6989586621680977267"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecInsertOp</span><span> </span><a name="local-6989586621680977268"><a href="#local-6989586621680977268"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977269"><a href="#local-6989586621680977269"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977270"><a href="#local-6989586621680977270"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977271"><a href="#local-6989586621680977271"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977272"><a href="#local-6989586621680977272"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977273"><a href="#local-6989586621680977273"><span class="hs-identifier">i</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-708"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977266"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977268"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977269"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977270"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-709"></a><span>    </span><a href="StgCmmPrim.html#doVecInsertOp"><span class="hs-identifier hs-var">doVecInsertOp</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecElemInjectCast"><span class="hs-identifier hs-var">vecElemInjectCast</span></a><span> </span><a href="#local-6989586621680977266"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977268"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977270"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977274"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977271"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621680977272"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621680977273"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621680977267"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-710"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-712"></a><span>    </span><a name="local-6989586621680977274"><a href="#local-6989586621680977274"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977268"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977269"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977270"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977275"><a href="#local-6989586621680977275"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977276"><a href="#local-6989586621680977276"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecIndexByteArrayOp</span><span> </span><a name="local-6989586621680977277"><a href="#local-6989586621680977277"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977278"><a href="#local-6989586621680977278"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977279"><a href="#local-6989586621680977279"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977280"><a href="#local-6989586621680977280"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-715"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977275"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977277"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977278"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977279"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-716"></a><span>    </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977281"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977276"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977280"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-717"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-718"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-719"></a><span>    </span><a name="local-6989586621680977281"><a href="#local-6989586621680977281"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977277"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977278"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977279"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977282"><a href="#local-6989586621680977282"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977283"><a href="#local-6989586621680977283"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecReadByteArrayOp</span><span> </span><a name="local-6989586621680977284"><a href="#local-6989586621680977284"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977285"><a href="#local-6989586621680977285"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977286"><a href="#local-6989586621680977286"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977287"><a href="#local-6989586621680977287"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-722"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977282"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977284"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977285"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977286"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-723"></a><span>    </span><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier hs-var">doIndexByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977288"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977283"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977287"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-724"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-725"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-726"></a><span>    </span><a name="local-6989586621680977288"><a href="#local-6989586621680977288"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977284"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977285"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977286"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977289"><a href="#local-6989586621680977289"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977290"><a href="#local-6989586621680977290"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecWriteByteArrayOp</span><span> </span><a name="local-6989586621680977291"><a href="#local-6989586621680977291"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977292"><a href="#local-6989586621680977292"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977293"><a href="#local-6989586621680977293"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977294"><a href="#local-6989586621680977294"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-729"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977289"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977291"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977292"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977293"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-730"></a><span>    </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977295"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977290"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977294"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-731"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-732"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-733"></a><span>    </span><a name="local-6989586621680977295"><a href="#local-6989586621680977295"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977291"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977292"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977293"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977296"><a href="#local-6989586621680977296"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977297"><a href="#local-6989586621680977297"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecIndexOffAddrOp</span><span> </span><a name="local-6989586621680977298"><a href="#local-6989586621680977298"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977299"><a href="#local-6989586621680977299"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977300"><a href="#local-6989586621680977300"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977301"><a href="#local-6989586621680977301"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-736"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977296"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977298"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977299"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977300"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-737"></a><span>    </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977302"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977297"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977301"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-738"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-739"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-740"></a><span>    </span><a name="local-6989586621680977302"><a href="#local-6989586621680977302"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977298"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977299"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977300"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-741"></a><span>
</span><a name="line-742"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977303"><a href="#local-6989586621680977303"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977304"><a href="#local-6989586621680977304"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecReadOffAddrOp</span><span> </span><a name="local-6989586621680977305"><a href="#local-6989586621680977305"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977306"><a href="#local-6989586621680977306"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977307"><a href="#local-6989586621680977307"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977308"><a href="#local-6989586621680977308"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-743"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977303"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977305"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977306"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977307"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-744"></a><span>    </span><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier hs-var">doIndexOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977309"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977304"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977308"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-745"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-746"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-747"></a><span>    </span><a name="local-6989586621680977309"><a href="#local-6989586621680977309"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977305"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977306"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977307"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977310"><a href="#local-6989586621680977310"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977311"><a href="#local-6989586621680977311"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecWriteOffAddrOp</span><span> </span><a name="local-6989586621680977312"><a href="#local-6989586621680977312"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977313"><a href="#local-6989586621680977313"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977314"><a href="#local-6989586621680977314"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977315"><a href="#local-6989586621680977315"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-750"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977310"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977312"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977313"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977314"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-751"></a><span>    </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977316"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977311"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977315"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-752"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-753"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-754"></a><span>    </span><a name="local-6989586621680977316"><a href="#local-6989586621680977316"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977312"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977313"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977314"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977317"><a href="#local-6989586621680977317"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977318"><a href="#local-6989586621680977318"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecIndexScalarByteArrayOp</span><span> </span><a name="local-6989586621680977319"><a href="#local-6989586621680977319"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977320"><a href="#local-6989586621680977320"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977321"><a href="#local-6989586621680977321"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977322"><a href="#local-6989586621680977322"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-757"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977317"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977319"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977320"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977321"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-758"></a><span>    </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977323"><span class="hs-identifier hs-var">vecty</span></a><span> </span><a href="#local-6989586621680977324"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977318"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977322"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-759"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-760"></a><span>    </span><span class="hs-identifier">vecty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-761"></a><span>    </span><a name="local-6989586621680977323"><a href="#local-6989586621680977323"><span class="hs-identifier">vecty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977319"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977320"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977321"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-762"></a><span>
</span><a name="line-763"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-764"></a><span>    </span><a name="local-6989586621680977324"><a href="#local-6989586621680977324"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977319"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977321"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977325"><a href="#local-6989586621680977325"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977326"><a href="#local-6989586621680977326"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecReadScalarByteArrayOp</span><span> </span><a name="local-6989586621680977327"><a href="#local-6989586621680977327"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977328"><a href="#local-6989586621680977328"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977329"><a href="#local-6989586621680977329"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977330"><a href="#local-6989586621680977330"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-767"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977325"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977327"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977328"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977329"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-768"></a><span>    </span><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier hs-var">doIndexByteArrayOpAs</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977331"><span class="hs-identifier hs-var">vecty</span></a><span> </span><a href="#local-6989586621680977332"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977326"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977330"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-769"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-770"></a><span>    </span><span class="hs-identifier">vecty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-771"></a><span>    </span><a name="local-6989586621680977331"><a href="#local-6989586621680977331"><span class="hs-identifier">vecty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977327"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977328"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977329"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-774"></a><span>    </span><a name="local-6989586621680977332"><a href="#local-6989586621680977332"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977327"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977329"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977333"><a href="#local-6989586621680977333"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977334"><a href="#local-6989586621680977334"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecWriteScalarByteArrayOp</span><span> </span><a name="local-6989586621680977335"><a href="#local-6989586621680977335"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977336"><a href="#local-6989586621680977336"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977337"><a href="#local-6989586621680977337"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977338"><a href="#local-6989586621680977338"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-777"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977333"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977335"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977336"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977337"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-778"></a><span>    </span><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier hs-var">doWriteByteArrayOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977339"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977334"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977338"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-779"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-780"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-781"></a><span>    </span><a name="local-6989586621680977339"><a href="#local-6989586621680977339"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977335"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977337"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-782"></a><span>
</span><a name="line-783"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977340"><a href="#local-6989586621680977340"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977341"><a href="#local-6989586621680977341"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecIndexScalarOffAddrOp</span><span> </span><a name="local-6989586621680977342"><a href="#local-6989586621680977342"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977343"><a href="#local-6989586621680977343"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977344"><a href="#local-6989586621680977344"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977345"><a href="#local-6989586621680977345"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-784"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977340"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977342"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977343"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977344"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-785"></a><span>    </span><a href="StgCmmPrim.html#doIndexOffAddrOpAs"><span class="hs-identifier hs-var">doIndexOffAddrOpAs</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977346"><span class="hs-identifier hs-var">vecty</span></a><span> </span><a href="#local-6989586621680977347"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977341"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977345"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-786"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-787"></a><span>    </span><span class="hs-identifier">vecty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-788"></a><span>    </span><a name="local-6989586621680977346"><a href="#local-6989586621680977346"><span class="hs-identifier">vecty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977342"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977343"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977344"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-789"></a><span>
</span><a name="line-790"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-791"></a><span>    </span><a name="local-6989586621680977347"><a href="#local-6989586621680977347"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977342"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977344"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-792"></a><span>
</span><a name="line-793"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977348"><a href="#local-6989586621680977348"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977349"><a href="#local-6989586621680977349"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecReadScalarOffAddrOp</span><span> </span><a name="local-6989586621680977350"><a href="#local-6989586621680977350"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977351"><a href="#local-6989586621680977351"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977352"><a href="#local-6989586621680977352"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977353"><a href="#local-6989586621680977353"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-794"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977348"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977350"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977351"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977352"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-795"></a><span>    </span><a href="StgCmmPrim.html#doIndexOffAddrOpAs"><span class="hs-identifier hs-var">doIndexOffAddrOpAs</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977354"><span class="hs-identifier hs-var">vecty</span></a><span> </span><a href="#local-6989586621680977355"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977349"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977353"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-796"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-797"></a><span>    </span><span class="hs-identifier">vecty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-798"></a><span>    </span><a name="local-6989586621680977354"><a href="#local-6989586621680977354"><span class="hs-identifier">vecty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977350"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977351"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977352"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-799"></a><span>
</span><a name="line-800"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-801"></a><span>    </span><a name="local-6989586621680977355"><a href="#local-6989586621680977355"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977350"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977352"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977356"><a href="#local-6989586621680977356"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977357"><a href="#local-6989586621680977357"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecWriteScalarOffAddrOp</span><span> </span><a name="local-6989586621680977358"><a href="#local-6989586621680977358"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977359"><a href="#local-6989586621680977359"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977360"><a href="#local-6989586621680977360"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977361"><a href="#local-6989586621680977361"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-804"></a><span>    </span><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier hs-var">checkVecCompatibility</span></a><span> </span><a href="#local-6989586621680977356"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977358"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977359"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977360"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-805"></a><span>    </span><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier hs-var">doWriteOffAddrOp</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977362"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977357"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977361"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-806"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-807"></a><span>    </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-808"></a><span>    </span><a name="local-6989586621680977362"><a href="#local-6989586621680977362"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977358"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977360"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-809"></a><span>
</span><a name="line-810"></a><span class="hs-comment">-- Prefetch</span><span>
</span><a name="line-811"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchByteArrayOp3</span><span>        </span><a name="local-6989586621680977363"><a href="#local-6989586621680977363"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchByteArrayOp"><span class="hs-identifier hs-var">doPrefetchByteArrayOp</span></a><span> </span><span class="hs-number">3</span><span>  </span><a href="#local-6989586621680977363"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-812"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchMutableByteArrayOp3</span><span> </span><a name="local-6989586621680977364"><a href="#local-6989586621680977364"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchMutableByteArrayOp"><span class="hs-identifier hs-var">doPrefetchMutableByteArrayOp</span></a><span> </span><span class="hs-number">3</span><span>  </span><a href="#local-6989586621680977364"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-813"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchAddrOp3</span><span>             </span><a name="local-6989586621680977365"><a href="#local-6989586621680977365"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchAddrOp"><span class="hs-identifier hs-var">doPrefetchAddrOp</span></a><span>  </span><span class="hs-number">3</span><span>  </span><a href="#local-6989586621680977365"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-814"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchValueOp3</span><span>            </span><a name="local-6989586621680977366"><a href="#local-6989586621680977366"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchValueOp"><span class="hs-identifier hs-var">doPrefetchValueOp</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="#local-6989586621680977366"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchByteArrayOp2</span><span>        </span><a name="local-6989586621680977367"><a href="#local-6989586621680977367"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchByteArrayOp"><span class="hs-identifier hs-var">doPrefetchByteArrayOp</span></a><span> </span><span class="hs-number">2</span><span>  </span><a href="#local-6989586621680977367"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-817"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchMutableByteArrayOp2</span><span> </span><a name="local-6989586621680977368"><a href="#local-6989586621680977368"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchMutableByteArrayOp"><span class="hs-identifier hs-var">doPrefetchMutableByteArrayOp</span></a><span> </span><span class="hs-number">2</span><span>  </span><a href="#local-6989586621680977368"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-818"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchAddrOp2</span><span>             </span><a name="local-6989586621680977369"><a href="#local-6989586621680977369"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchAddrOp"><span class="hs-identifier hs-var">doPrefetchAddrOp</span></a><span> </span><span class="hs-number">2</span><span>  </span><a href="#local-6989586621680977369"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-819"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchValueOp2</span><span>           </span><a name="local-6989586621680977370"><a href="#local-6989586621680977370"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchValueOp"><span class="hs-identifier hs-var">doPrefetchValueOp</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621680977370"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchByteArrayOp1</span><span>        </span><a name="local-6989586621680977371"><a href="#local-6989586621680977371"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchByteArrayOp"><span class="hs-identifier hs-var">doPrefetchByteArrayOp</span></a><span> </span><span class="hs-number">1</span><span>  </span><a href="#local-6989586621680977371"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-822"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchMutableByteArrayOp1</span><span> </span><a name="local-6989586621680977372"><a href="#local-6989586621680977372"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchMutableByteArrayOp"><span class="hs-identifier hs-var">doPrefetchMutableByteArrayOp</span></a><span> </span><span class="hs-number">1</span><span>  </span><a href="#local-6989586621680977372"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-823"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchAddrOp1</span><span>             </span><a name="local-6989586621680977373"><a href="#local-6989586621680977373"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchAddrOp"><span class="hs-identifier hs-var">doPrefetchAddrOp</span></a><span> </span><span class="hs-number">1</span><span>  </span><a href="#local-6989586621680977373"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-824"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchValueOp1</span><span>            </span><a name="local-6989586621680977374"><a href="#local-6989586621680977374"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchValueOp"><span class="hs-identifier hs-var">doPrefetchValueOp</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621680977374"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchByteArrayOp0</span><span>        </span><a name="local-6989586621680977375"><a href="#local-6989586621680977375"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchByteArrayOp"><span class="hs-identifier hs-var">doPrefetchByteArrayOp</span></a><span> </span><span class="hs-number">0</span><span>  </span><a href="#local-6989586621680977375"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-827"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchMutableByteArrayOp0</span><span> </span><a name="local-6989586621680977376"><a href="#local-6989586621680977376"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchMutableByteArrayOp"><span class="hs-identifier hs-var">doPrefetchMutableByteArrayOp</span></a><span> </span><span class="hs-number">0</span><span>  </span><a href="#local-6989586621680977376"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-828"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchAddrOp0</span><span>             </span><a name="local-6989586621680977377"><a href="#local-6989586621680977377"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchAddrOp"><span class="hs-identifier hs-var">doPrefetchAddrOp</span></a><span> </span><span class="hs-number">0</span><span>  </span><a href="#local-6989586621680977377"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-829"></a><span class="hs-identifier">emitPrimOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">PrefetchValueOp0</span><span>            </span><a name="local-6989586621680977378"><a href="#local-6989586621680977378"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doPrefetchValueOp"><span class="hs-identifier hs-var">doPrefetchValueOp</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977378"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-comment">-- Atomic read-modify-write</span><span>
</span><a name="line-832"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977379"><a href="#local-6989586621680977379"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977380"><a href="#local-6989586621680977380"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchAddByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977381"><a href="#local-6989586621680977381"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977382"><a href="#local-6989586621680977382"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977383"><a href="#local-6989586621680977383"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-833"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977380"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_Add"><span class="hs-identifier hs-var">AMO_Add</span></a><span> </span><a href="#local-6989586621680977381"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977382"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977379"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977383"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-834"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977384"><a href="#local-6989586621680977384"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977385"><a href="#local-6989586621680977385"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchSubByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977386"><a href="#local-6989586621680977386"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977387"><a href="#local-6989586621680977387"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977388"><a href="#local-6989586621680977388"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-835"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977385"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_Sub"><span class="hs-identifier hs-var">AMO_Sub</span></a><span> </span><a href="#local-6989586621680977386"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977387"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977384"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977388"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-836"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977389"><a href="#local-6989586621680977389"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977390"><a href="#local-6989586621680977390"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchAndByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977391"><a href="#local-6989586621680977391"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977392"><a href="#local-6989586621680977392"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977393"><a href="#local-6989586621680977393"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-837"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977390"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_And"><span class="hs-identifier hs-var">AMO_And</span></a><span> </span><a href="#local-6989586621680977391"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977392"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977389"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977393"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-838"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977394"><a href="#local-6989586621680977394"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977395"><a href="#local-6989586621680977395"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchNandByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977396"><a href="#local-6989586621680977396"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977397"><a href="#local-6989586621680977397"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977398"><a href="#local-6989586621680977398"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-839"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977395"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_Nand"><span class="hs-identifier hs-var">AMO_Nand</span></a><span> </span><a href="#local-6989586621680977396"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977397"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977394"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977398"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-840"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977399"><a href="#local-6989586621680977399"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977400"><a href="#local-6989586621680977400"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchOrByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977401"><a href="#local-6989586621680977401"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977402"><a href="#local-6989586621680977402"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977403"><a href="#local-6989586621680977403"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-841"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977400"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_Or"><span class="hs-identifier hs-var">AMO_Or</span></a><span> </span><a href="#local-6989586621680977401"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977402"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977399"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977403"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-842"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977404"><a href="#local-6989586621680977404"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977405"><a href="#local-6989586621680977405"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">FetchXorByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977406"><a href="#local-6989586621680977406"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977407"><a href="#local-6989586621680977407"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977408"><a href="#local-6989586621680977408"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-843"></a><span>    </span><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier hs-var">doAtomicRMW</span></a><span> </span><a href="#local-6989586621680977405"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="CmmMachOp.html#AMO_Xor"><span class="hs-identifier hs-var">AMO_Xor</span></a><span> </span><a href="#local-6989586621680977406"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977407"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977404"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977408"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-844"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977409"><a href="#local-6989586621680977409"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977410"><a href="#local-6989586621680977410"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">AtomicReadByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977411"><a href="#local-6989586621680977411"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977412"><a href="#local-6989586621680977412"><span class="hs-identifier">ix</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-845"></a><span>    </span><a href="StgCmmPrim.html#doAtomicReadByteArray"><span class="hs-identifier hs-var">doAtomicReadByteArray</span></a><span> </span><a href="#local-6989586621680977410"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977411"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977412"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977409"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-846"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977413"><a href="#local-6989586621680977413"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">AtomicWriteByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977414"><a href="#local-6989586621680977414"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977415"><a href="#local-6989586621680977415"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977416"><a href="#local-6989586621680977416"><span class="hs-identifier">val</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-847"></a><span>    </span><a href="StgCmmPrim.html#doAtomicWriteByteArray"><span class="hs-identifier hs-var">doAtomicWriteByteArray</span></a><span> </span><a href="#local-6989586621680977414"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977415"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977413"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977416"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-848"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977417"><a href="#local-6989586621680977417"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977418"><a href="#local-6989586621680977418"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">CasByteArrayOp_Int</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977419"><a href="#local-6989586621680977419"><span class="hs-identifier">mba</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977420"><a href="#local-6989586621680977420"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977421"><a href="#local-6989586621680977421"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977422"><a href="#local-6989586621680977422"><span class="hs-identifier">new</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-849"></a><span>    </span><a href="StgCmmPrim.html#doCasByteArray"><span class="hs-identifier hs-var">doCasByteArray</span></a><span> </span><a href="#local-6989586621680977418"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977419"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680977420"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977417"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977421"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621680977422"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-850"></a><span>
</span><a name="line-851"></a><span class="hs-comment">-- The rest just translate straightforwardly</span><span>
</span><a name="line-852"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977423"><a href="#local-6989586621680977423"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977424"><a href="#local-6989586621680977424"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621680977425"><a href="#local-6989586621680977425"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977426"><a href="#local-6989586621680977426"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-853"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="StgCmmPrim.html#nopOp"><span class="hs-identifier hs-var">nopOp</span></a><span> </span><a href="#local-6989586621680977425"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-854"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977424"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977426"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680977427"><a href="#local-6989586621680977427"><span class="hs-identifier">mop</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977428"><a href="#local-6989586621680977428"><span class="hs-identifier">rep</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#narrowOp"><span class="hs-identifier hs-var">narrowOp</span></a><span> </span><a href="#local-6989586621680977425"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-857"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977424"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-858"></a><span>           </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977427"><span class="hs-identifier hs-var">mop</span></a><span> </span><a href="#local-6989586621680977428"><span class="hs-identifier hs-var">rep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977423"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977427"><span class="hs-identifier hs-var">mop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977423"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977428"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977426"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-859"></a><span>
</span><a name="line-860"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977429"><a href="#local-6989586621680977429"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977430"><a href="#local-6989586621680977430"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><a name="local-6989586621680977431"><a href="#local-6989586621680977431"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621680977432"><a href="#local-6989586621680977432"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680977433"><a href="#local-6989586621680977433"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-861"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-keyword">prim</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#callishOp"><span class="hs-identifier hs-var">callishOp</span></a><span> </span><a href="#local-6989586621680977432"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-862"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><a href="#local-6989586621680977430"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">prim</span><span> </span><a href="#local-6989586621680977433"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-863"></a><span>
</span><a name="line-864"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977435"><a href="#local-6989586621680977435"><span class="hs-identifier">mop</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#translateOp"><span class="hs-identifier hs-var">translateOp</span></a><span> </span><a href="#local-6989586621680977429"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977432"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-865"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977436"><a href="#local-6989586621680977436"><span class="hs-identifier">stmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977431"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977435"><span class="hs-identifier hs-var">mop</span></a><span> </span><a href="#local-6989586621680977433"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-866"></a><span>     </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><a href="#local-6989586621680977436"><span class="hs-identifier hs-var">stmt</span></a><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span class="hs-identifier">emitPrimOp</span><span> </span><a name="local-6989586621680977437"><a href="#local-6989586621680977437"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977438"><a href="#local-6989586621680977438"><span class="hs-identifier">results</span></a></a><span> </span><a name="local-6989586621680977439"><a href="#local-6989586621680977439"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680977440"><a href="#local-6989586621680977440"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-869"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="StgCmmPrim.html#callishPrimOpSupported"><span class="hs-identifier hs-var">callishPrimOpSupported</span></a><span> </span><a href="#local-6989586621680977437"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977439"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-870"></a><span>          </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621680977441"><a href="#local-6989586621680977441"><span class="hs-identifier">op</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkUnsafeCall"><span class="hs-identifier hs-var">mkUnsafeCall</span></a><span> </span><span class="hs-special">(</span><a href="CmmNode.html#PrimTarget"><span class="hs-identifier hs-var">PrimTarget</span></a><span> </span><a href="#local-6989586621680977441"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977438"><span class="hs-identifier hs-var">results</span></a><span> </span><a href="#local-6989586621680977440"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-871"></a><span>          </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621680977442"><a href="#local-6989586621680977442"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680977442"><span class="hs-identifier hs-var">gen</span></a><span> </span><a href="#local-6989586621680977438"><span class="hs-identifier hs-var">results</span></a><span> </span><a href="#local-6989586621680977440"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-872"></a><span>
</span><a name="line-873"></a><span class="hs-keyword">type</span><span> </span><a name="GenericOp"><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier">GenericOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmNode.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-874"></a><span>
</span><a name="line-875"></a><span class="hs-identifier">callishPrimOpSupported</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CmmMachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-876"></a><a name="callishPrimOpSupported"><a href="StgCmmPrim.html#callishPrimOpSupported"><span class="hs-identifier">callishPrimOpSupported</span></a></a><span> </span><a name="local-6989586621680977443"><a href="#local-6989586621680977443"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977444"><a href="#local-6989586621680977444"><span class="hs-identifier">op</span></a></a><span>
</span><a name="line-877"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977444"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-878"></a><span>      </span><span class="hs-identifier hs-var">IntQuotRemOp</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-879"></a><span>                         </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-var">MO_S_QuotRem</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-881"></a><span>                         </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericIntQuotRemOp"><span class="hs-identifier hs-var">genericIntQuotRemOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>
</span><a name="line-883"></a><span>      </span><span class="hs-identifier hs-var">Int8QuotRemOp</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-884"></a><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-var">MO_S_QuotRem</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-885"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericIntQuotRemOp"><span class="hs-identifier hs-var">genericIntQuotRemOp</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span>
</span><a name="line-887"></a><span>      </span><span class="hs-identifier hs-var">Int16QuotRemOp</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-var">MO_S_QuotRem</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-889"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericIntQuotRemOp"><span class="hs-identifier hs-var">genericIntQuotRemOp</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a><span>      </span><span class="hs-identifier hs-var">WordQuotRemOp</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-893"></a><span>                         </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-var">MO_U_QuotRem</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-894"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-895"></a><span>                         </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericWordQuotRemOp"><span class="hs-identifier hs-var">genericWordQuotRemOp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-896"></a><span>
</span><a name="line-897"></a><span>      </span><span class="hs-identifier hs-var">WordQuotRem2Op</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>                          </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_QuotRem2"><span class="hs-identifier hs-var">MO_U_QuotRem2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericWordQuotRem2Op"><span class="hs-identifier hs-var">genericWordQuotRem2Op</span></a><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-900"></a><span>
</span><a name="line-901"></a><span>      </span><span class="hs-identifier hs-var">Word8QuotRemOp</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-902"></a><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-var">MO_U_QuotRem</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-903"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericWordQuotRemOp"><span class="hs-identifier hs-var">genericWordQuotRemOp</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-904"></a><span>
</span><a name="line-905"></a><span>      </span><span class="hs-identifier hs-var">Word16QuotRemOp</span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-906"></a><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-var">MO_U_QuotRem</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#genericWordQuotRemOp"><span class="hs-identifier hs-var">genericWordQuotRemOp</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span>      </span><span class="hs-identifier hs-var">WordAdd2Op</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-910"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add2"><span class="hs-identifier hs-var">MO_Add2</span></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-911"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericWordAdd2Op"><span class="hs-identifier hs-var">genericWordAdd2Op</span></a><span>
</span><a name="line-912"></a><span>
</span><a name="line-913"></a><span>      </span><span class="hs-identifier hs-var">WordAddCOp</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-914"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_AddWordC"><span class="hs-identifier hs-var">MO_AddWordC</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-915"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericWordAddCOp"><span class="hs-identifier hs-var">genericWordAddCOp</span></a><span>
</span><a name="line-916"></a><span>
</span><a name="line-917"></a><span>      </span><span class="hs-identifier hs-var">WordSubCOp</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SubWordC"><span class="hs-identifier hs-var">MO_SubWordC</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-919"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericWordSubCOp"><span class="hs-identifier hs-var">genericWordSubCOp</span></a><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span>      </span><span class="hs-identifier hs-var">IntAddCOp</span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_AddIntC"><span class="hs-identifier hs-var">MO_AddIntC</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-923"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericIntAddCOp"><span class="hs-identifier hs-var">genericIntAddCOp</span></a><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span>      </span><span class="hs-identifier hs-var">IntSubCOp</span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-926"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SubIntC"><span class="hs-identifier hs-var">MO_SubIntC</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-927"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericIntSubCOp"><span class="hs-identifier hs-var">genericIntSubCOp</span></a><span>
</span><a name="line-928"></a><span>
</span><a name="line-929"></a><span>      </span><span class="hs-identifier hs-var">WordMul2Op</span><span>     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-930"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Mul2"><span class="hs-identifier hs-var">MO_U_Mul2</span></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="StgCmmPrim.html#genericWordMul2Op"><span class="hs-identifier hs-var">genericWordMul2Op</span></a><span>
</span><a name="line-932"></a><span>      </span><span class="hs-identifier hs-var">FloatFabsOp</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-933"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="CmmMachOp.html#MO_F32_Fabs"><span class="hs-identifier hs-var">MO_F32_Fabs</span></a><span>
</span><a name="line-934"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#genericFabsOp"><span class="hs-identifier hs-var">genericFabsOp</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-935"></a><span>      </span><span class="hs-identifier hs-var">DoubleFabsOp</span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977445"><span class="hs-identifier hs-var">ncg</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680977447"><span class="hs-identifier hs-var">x86ish</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977448"><span class="hs-identifier hs-var">ppc</span></a><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>                         </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680977446"><span class="hs-identifier hs-var">llvm</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="CmmMachOp.html#MO_F64_Fabs"><span class="hs-identifier hs-var">MO_F64_Fabs</span></a><span>
</span><a name="line-937"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#genericFabsOp"><span class="hs-identifier hs-var">genericFabsOp</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span>
</span><a name="line-938"></a><span>
</span><a name="line-939"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;emitPrimOp: can't translate PrimOp &quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621680977444"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-941"></a><span>  </span><a name="local-6989586621680977445"><a href="#local-6989586621680977445"><span class="hs-identifier">ncg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">hscTarget</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-942"></a><span>           </span><span class="hs-identifier hs-var">HscAsm</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-943"></a><span>           </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-944"></a><span>  </span><a name="local-6989586621680977446"><a href="#local-6989586621680977446"><span class="hs-identifier">llvm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">hscTarget</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-945"></a><span>           </span><span class="hs-identifier hs-var">HscLlvm</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-946"></a><span>           </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-947"></a><span>  </span><a name="local-6989586621680977447"><a href="#local-6989586621680977447"><span class="hs-identifier">x86ish</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-948"></a><span>             </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-949"></a><span>             </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-950"></a><span>             </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-951"></a><span>  </span><a name="local-6989586621680977448"><a href="#local-6989586621680977448"><span class="hs-identifier">ppc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621680977443"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-952"></a><span>          </span><span class="hs-identifier hs-var">ArchPPC</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-953"></a><span>          </span><span class="hs-identifier hs-var">ArchPPC_64</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-954"></a><span>          </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-955"></a><span>
</span><a name="line-956"></a><span class="hs-identifier">genericIntQuotRemOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-957"></a><a name="genericIntQuotRemOp"><a href="StgCmmPrim.html#genericIntQuotRemOp"><span class="hs-identifier">genericIntQuotRemOp</span></a></a><span> </span><a name="local-6989586621680977449"><a href="#local-6989586621680977449"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977450"><a href="#local-6989586621680977450"><span class="hs-identifier">res_q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977451"><a href="#local-6989586621680977451"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977452"><a href="#local-6989586621680977452"><span class="hs-identifier">arg_x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977453"><a href="#local-6989586621680977453"><span class="hs-identifier">arg_y</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-958"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977450"><span class="hs-identifier hs-var">res_q</span></a><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span>              </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Quot"><span class="hs-identifier hs-var">MO_S_Quot</span></a><span> </span><a href="#local-6989586621680977449"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977452"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977453"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="MkGraph.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-960"></a><span>            </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977451"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>              </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Rem"><span class="hs-identifier hs-var">MO_S_Rem</span></a><span>  </span><a href="#local-6989586621680977449"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977452"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977453"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span class="hs-identifier">genericIntQuotRemOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericIntQuotRemOp&quot;</span><span>
</span><a name="line-963"></a><span>
</span><a name="line-964"></a><span class="hs-identifier">genericWordQuotRemOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-965"></a><a name="genericWordQuotRemOp"><a href="StgCmmPrim.html#genericWordQuotRemOp"><span class="hs-identifier">genericWordQuotRemOp</span></a></a><span> </span><a name="local-6989586621680977454"><a href="#local-6989586621680977454"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977455"><a href="#local-6989586621680977455"><span class="hs-identifier">res_q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977456"><a href="#local-6989586621680977456"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977457"><a href="#local-6989586621680977457"><span class="hs-identifier">arg_x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977458"><a href="#local-6989586621680977458"><span class="hs-identifier">arg_y</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-966"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977455"><span class="hs-identifier hs-var">res_q</span></a><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>               </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Quot"><span class="hs-identifier hs-var">MO_U_Quot</span></a><span> </span><a href="#local-6989586621680977454"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977457"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977458"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="MkGraph.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-968"></a><span>             </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977456"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span>
</span><a name="line-969"></a><span>               </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Rem"><span class="hs-identifier hs-var">MO_U_Rem</span></a><span>  </span><a href="#local-6989586621680977454"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977457"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977458"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-970"></a><span class="hs-identifier">genericWordQuotRemOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordQuotRemOp&quot;</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-identifier">genericWordQuotRem2Op</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-973"></a><a name="genericWordQuotRem2Op"><a href="StgCmmPrim.html#genericWordQuotRem2Op"><span class="hs-identifier">genericWordQuotRem2Op</span></a></a><span> </span><a name="local-6989586621680977459"><a href="#local-6989586621680977459"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977460"><a href="#local-6989586621680977460"><span class="hs-identifier">res_q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977461"><a href="#local-6989586621680977461"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977462"><a href="#local-6989586621680977462"><span class="hs-identifier">arg_x_high</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977463"><a href="#local-6989586621680977463"><span class="hs-identifier">arg_x_low</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977464"><a href="#local-6989586621680977464"><span class="hs-identifier">arg_y</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-974"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621680977477"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">widthInBits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977473"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621680977462"><span class="hs-identifier hs-var">arg_x_high</span></a><span> </span><a href="#local-6989586621680977463"><span class="hs-identifier hs-var">arg_x_low</span></a><span>
</span><a name="line-975"></a><span>    </span><span class="hs-keyword">where</span><span>    </span><a name="local-6989586621680977465"><a href="#local-6989586621680977465"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977462"><span class="hs-identifier hs-var">arg_x_high</span></a><span>
</span><a name="line-976"></a><span>             </span><a name="local-6989586621680977466"><a href="#local-6989586621680977466"><span class="hs-identifier">shl</span></a></a><span>   </span><a name="local-6989586621680977478"><a href="#local-6989586621680977478"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977479"><a href="#local-6989586621680977479"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Shl"><span class="hs-identifier hs-var">MO_Shl</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977478"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977479"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-977"></a><span>             </span><a name="local-6989586621680977467"><a href="#local-6989586621680977467"><span class="hs-identifier">shr</span></a></a><span>   </span><a name="local-6989586621680977480"><a href="#local-6989586621680977480"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977481"><a href="#local-6989586621680977481"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Shr"><span class="hs-identifier hs-var">MO_U_Shr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977480"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977481"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-978"></a><span>             </span><a name="local-6989586621680977468"><a href="#local-6989586621680977468"><span class="hs-identifier">or</span></a></a><span>    </span><a name="local-6989586621680977482"><a href="#local-6989586621680977482"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977483"><a href="#local-6989586621680977483"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Or"><span class="hs-identifier hs-var">MO_Or</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977482"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977483"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-979"></a><span>             </span><a name="local-6989586621680977469"><a href="#local-6989586621680977469"><span class="hs-identifier">ge</span></a></a><span>    </span><a name="local-6989586621680977484"><a href="#local-6989586621680977484"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977485"><a href="#local-6989586621680977485"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Ge"><span class="hs-identifier hs-var">MO_U_Ge</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977484"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977485"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-980"></a><span>             </span><a name="local-6989586621680977470"><a href="#local-6989586621680977470"><span class="hs-identifier">ne</span></a></a><span>    </span><a name="local-6989586621680977486"><a href="#local-6989586621680977486"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977487"><a href="#local-6989586621680977487"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977486"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977487"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-981"></a><span>             </span><a name="local-6989586621680977471"><a href="#local-6989586621680977471"><span class="hs-identifier">minus</span></a></a><span> </span><a name="local-6989586621680977488"><a href="#local-6989586621680977488"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977489"><a href="#local-6989586621680977489"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977488"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977489"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-982"></a><span>             </span><a name="local-6989586621680977472"><a href="#local-6989586621680977472"><span class="hs-identifier">times</span></a></a><span> </span><a name="local-6989586621680977490"><a href="#local-6989586621680977490"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977491"><a href="#local-6989586621680977491"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977490"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977491"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-983"></a><span>             </span><a name="local-6989586621680977473"><a href="#local-6989586621680977473"><span class="hs-identifier">zero</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680977476"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-984"></a><span>             </span><a name="local-6989586621680977474"><a href="#local-6989586621680977474"><span class="hs-identifier">one</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680977476"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-985"></a><span>             </span><a name="local-6989586621680977475"><a href="#local-6989586621680977475"><span class="hs-identifier">negone</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680977476"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">widthInBits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>             </span><a name="local-6989586621680977476"><a href="#local-6989586621680977476"><span class="hs-identifier">lit</span></a></a><span> </span><a name="local-6989586621680977492"><a href="#local-6989586621680977492"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><a href="#local-6989586621680977492"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977459"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-987"></a><span>
</span><a name="line-988"></a><span>             </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><a href="MkGraph.html#CmmAGraph"><span class="hs-identifier hs-type">CmmAGraph</span></a><span>
</span><a name="line-989"></a><span>             </span><a name="local-6989586621680977477"><a href="#local-6989586621680977477"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621680977493"><a href="#local-6989586621680977493"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621680977494"><a href="#local-6989586621680977494"><span class="hs-identifier">high</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977460"><span class="hs-identifier hs-var">res_q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977493"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="MkGraph.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span>
</span><a name="line-990"></a><span>                                      </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977461"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977494"><span class="hs-identifier hs-var">high</span></a><span class="hs-special">)</span><span>
</span><a name="line-991"></a><span>             </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621680977495"><a href="#local-6989586621680977495"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621680977496"><a href="#local-6989586621680977496"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621680977497"><a href="#local-6989586621680977497"><span class="hs-identifier">high</span></a></a><span> </span><a name="local-6989586621680977498"><a href="#local-6989586621680977498"><span class="hs-identifier">low</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-992"></a><span>                 </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977499"><a href="#local-6989586621680977499"><span class="hs-identifier">roverflowedBit</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-993"></a><span>                    </span><a name="local-6989586621680977500"><a href="#local-6989586621680977500"><span class="hs-identifier">rhigh'</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-994"></a><span>                    </span><a name="local-6989586621680977501"><a href="#local-6989586621680977501"><span class="hs-identifier">rhigh''</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-995"></a><span>                    </span><a name="local-6989586621680977502"><a href="#local-6989586621680977502"><span class="hs-identifier">rlow'</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-996"></a><span>                    </span><a name="local-6989586621680977503"><a href="#local-6989586621680977503"><span class="hs-identifier">risge</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-997"></a><span>                    </span><a name="local-6989586621680977504"><a href="#local-6989586621680977504"><span class="hs-identifier">racc'</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977465"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-998"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977505"><a href="#local-6989586621680977505"><span class="hs-identifier">high'</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977500"><span class="hs-identifier hs-var">rhigh'</span></a><span class="hs-special">)</span><span>
</span><a name="line-999"></a><span>                        </span><a name="local-6989586621680977506"><a href="#local-6989586621680977506"><span class="hs-identifier">isge</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977503"><span class="hs-identifier hs-var">risge</span></a><span class="hs-special">)</span><span>
</span><a name="line-1000"></a><span>                        </span><a name="local-6989586621680977507"><a href="#local-6989586621680977507"><span class="hs-identifier">overflowedBit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977499"><span class="hs-identifier hs-var">roverflowedBit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1001"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977508"><a href="#local-6989586621680977508"><span class="hs-identifier">this</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-1002"></a><span>                               </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977499"><span class="hs-identifier hs-var">roverflowedBit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1003"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977467"><span class="hs-identifier hs-var">shr</span></a><span> </span><a href="#local-6989586621680977497"><span class="hs-identifier hs-var">high</span></a><span> </span><a href="#local-6989586621680977475"><span class="hs-identifier hs-var">negone</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1004"></a><span>                                </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977500"><span class="hs-identifier hs-var">rhigh'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1005"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977468"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977466"><span class="hs-identifier hs-var">shl</span></a><span> </span><a href="#local-6989586621680977497"><span class="hs-identifier hs-var">high</span></a><span> </span><a href="#local-6989586621680977474"><span class="hs-identifier hs-var">one</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977467"><span class="hs-identifier hs-var">shr</span></a><span> </span><a href="#local-6989586621680977498"><span class="hs-identifier hs-var">low</span></a><span> </span><a href="#local-6989586621680977475"><span class="hs-identifier hs-var">negone</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1006"></a><span>                                </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977502"><span class="hs-identifier hs-var">rlow'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1007"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977466"><span class="hs-identifier hs-var">shl</span></a><span> </span><a href="#local-6989586621680977498"><span class="hs-identifier hs-var">low</span></a><span> </span><a href="#local-6989586621680977474"><span class="hs-identifier hs-var">one</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1008"></a><span>                                </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977503"><span class="hs-identifier hs-var">risge</span></a><span class="hs-special">)</span><span>
</span><a name="line-1009"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977468"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977507"><span class="hs-identifier hs-var">overflowedBit</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680977470"><span class="hs-identifier hs-var">ne</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680977473"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span>
</span><a name="line-1010"></a><span>                                              </span><span class="hs-special">(</span><a href="#local-6989586621680977505"><span class="hs-identifier hs-var">high'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680977469"><span class="hs-identifier hs-var">ge</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680977464"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1011"></a><span>                                </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977501"><span class="hs-identifier hs-var">rhigh''</span></a><span class="hs-special">)</span><span>
</span><a name="line-1012"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977505"><span class="hs-identifier hs-var">high'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680977471"><span class="hs-identifier hs-var">minus</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977464"><span class="hs-identifier hs-var">arg_y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680977472"><span class="hs-identifier hs-var">times</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680977506"><span class="hs-identifier hs-var">isge</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1013"></a><span>                                </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977504"><span class="hs-identifier hs-var">racc'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1014"></a><span>                                          </span><span class="hs-special">(</span><a href="#local-6989586621680977468"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977466"><span class="hs-identifier hs-var">shl</span></a><span> </span><a href="#local-6989586621680977496"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621680977474"><span class="hs-identifier hs-var">one</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977506"><span class="hs-identifier hs-var">isge</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1015"></a><span>                    </span><a name="local-6989586621680977509"><a href="#local-6989586621680977509"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680977477"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977495"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977504"><span class="hs-identifier hs-var">racc'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1016"></a><span>                                      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977501"><span class="hs-identifier hs-var">rhigh''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1017"></a><span>                                      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977502"><span class="hs-identifier hs-var">rlow'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977508"><span class="hs-identifier hs-var">this</span></a><span> </span><a href="MkGraph.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621680977509"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-1019"></a><span class="hs-identifier">genericWordQuotRem2Op</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordQuotRem2Op&quot;</span><span>
</span><a name="line-1020"></a><span>
</span><a name="line-1021"></a><span class="hs-identifier">genericWordAdd2Op</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1022"></a><a name="genericWordAdd2Op"><a href="StgCmmPrim.html#genericWordAdd2Op"><span class="hs-identifier">genericWordAdd2Op</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977510"><a href="#local-6989586621680977510"><span class="hs-identifier">res_h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977511"><a href="#local-6989586621680977511"><span class="hs-identifier">res_l</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977512"><a href="#local-6989586621680977512"><span class="hs-identifier">arg_x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977513"><a href="#local-6989586621680977513"><span class="hs-identifier">arg_y</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1023"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977514"><a href="#local-6989586621680977514"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1024"></a><span>       </span><a name="local-6989586621680977515"><a href="#local-6989586621680977515"><span class="hs-identifier">r1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977512"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1025"></a><span>       </span><a name="local-6989586621680977516"><a href="#local-6989586621680977516"><span class="hs-identifier">r2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977512"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977517"><a href="#local-6989586621680977517"><span class="hs-identifier">topHalf</span></a></a><span> </span><a name="local-6989586621680977524"><a href="#local-6989586621680977524"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Shr"><span class="hs-identifier hs-var">MO_U_Shr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977524"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977522"><span class="hs-identifier hs-var">hww</span></a><span class="hs-special">]</span><span>
</span><a name="line-1027"></a><span>           </span><a name="local-6989586621680977518"><a href="#local-6989586621680977518"><span class="hs-identifier">toTopHalf</span></a></a><span> </span><a name="local-6989586621680977525"><a href="#local-6989586621680977525"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Shl"><span class="hs-identifier hs-var">MO_Shl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977525"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977522"><span class="hs-identifier hs-var">hww</span></a><span class="hs-special">]</span><span>
</span><a name="line-1028"></a><span>           </span><a name="local-6989586621680977519"><a href="#local-6989586621680977519"><span class="hs-identifier">bottomHalf</span></a></a><span> </span><a name="local-6989586621680977526"><a href="#local-6989586621680977526"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_And"><span class="hs-identifier hs-var">MO_And</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977526"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977523"><span class="hs-identifier hs-var">hwm</span></a><span class="hs-special">]</span><span>
</span><a name="line-1029"></a><span>           </span><a name="local-6989586621680977520"><a href="#local-6989586621680977520"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-6989586621680977527"><a href="#local-6989586621680977527"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977528"><a href="#local-6989586621680977528"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977527"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977528"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1030"></a><span>           </span><a name="local-6989586621680977521"><a href="#local-6989586621680977521"><span class="hs-identifier">or</span></a></a><span> </span><a name="local-6989586621680977529"><a href="#local-6989586621680977529"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977530"><a href="#local-6989586621680977530"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Or"><span class="hs-identifier hs-var">MO_Or</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977529"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977530"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1031"></a><span>           </span><a name="local-6989586621680977522"><a href="#local-6989586621680977522"><span class="hs-identifier">hww</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">widthInBits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">halfWordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1032"></a><span>                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1033"></a><span>           </span><a name="local-6989586621680977523"><a href="#local-6989586621680977523"><span class="hs-identifier">hwm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">halfWordMask</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977514"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span>       </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-1035"></a><span>          </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977515"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1036"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621680977520"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977519"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977512"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977519"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977513"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1037"></a><span>           </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977516"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1038"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621680977520"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977517"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977515"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1039"></a><span>                    </span><span class="hs-special">(</span><a href="#local-6989586621680977520"><span class="hs-identifier hs-var">add</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977517"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977512"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977517"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977513"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1040"></a><span>           </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977510"><span class="hs-identifier hs-var">res_h</span></a><span class="hs-special">)</span><span>
</span><a name="line-1041"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621680977517"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977516"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1042"></a><span>           </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977511"><span class="hs-identifier hs-var">res_l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1043"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621680977521"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977518"><span class="hs-identifier hs-var">toTopHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977516"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1044"></a><span>                   </span><span class="hs-special">(</span><a href="#local-6989586621680977519"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977515"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1045"></a><span class="hs-identifier">genericWordAdd2Op</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordAdd2Op&quot;</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span class="hs-comment">-- | Implements branchless recovery of the carry flag @c@ by checking the</span><span>
</span><a name="line-1048"></a><span class="hs-comment">-- leftmost bits of both inputs @a@ and @b@ and result @r = a + b@:</span><span>
</span><a name="line-1049"></a><span class="hs-comment">--</span><span>
</span><a name="line-1050"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1051"></a><span class="hs-comment">--    c = a&amp;b | (a|b)&amp;~r</span><span>
</span><a name="line-1052"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1053"></a><span class="hs-comment">--</span><span>
</span><a name="line-1054"></a><span class="hs-comment">-- https://brodowsky.it-sky.net/2015/04/02/how-to-recover-the-carry-bit/</span><span>
</span><a name="line-1055"></a><span class="hs-identifier">genericWordAddCOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1056"></a><a name="genericWordAddCOp"><a href="StgCmmPrim.html#genericWordAddCOp"><span class="hs-identifier">genericWordAddCOp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977531"><a href="#local-6989586621680977531"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977532"><a href="#local-6989586621680977532"><span class="hs-identifier">res_c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977533"><a href="#local-6989586621680977533"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977534"><a href="#local-6989586621680977534"><span class="hs-identifier">bb</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1057"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977535"><a href="#local-6989586621680977535"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1058"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1059"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977531"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAdd"><span class="hs-identifier hs-var">mo_wordAdd</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977533"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977534"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1060"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977532"><span class="hs-identifier hs-var">res_c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1061"></a><span>          </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1062"></a><span>            </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1063"></a><span>              </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977533"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977534"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1064"></a><span>              </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1065"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977533"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977534"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1066"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977531"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1067"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-1068"></a><span>            </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1069"></a><span>            </span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE_IN_BITS</span><span> </span><a href="#local-6989586621680977535"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1070"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1071"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1072"></a><span class="hs-identifier">genericWordAddCOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordAddCOp&quot;</span><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span class="hs-comment">-- | Implements branchless recovery of the carry flag @c@ by checking the</span><span>
</span><a name="line-1075"></a><span class="hs-comment">-- leftmost bits of both inputs @a@ and @b@ and result @r = a - b@:</span><span>
</span><a name="line-1076"></a><span class="hs-comment">--</span><span>
</span><a name="line-1077"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1078"></a><span class="hs-comment">--    c = ~a&amp;b | (~a|b)&amp;r</span><span>
</span><a name="line-1079"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1080"></a><span class="hs-comment">--</span><span>
</span><a name="line-1081"></a><span class="hs-comment">-- https://brodowsky.it-sky.net/2015/04/02/how-to-recover-the-carry-bit/</span><span>
</span><a name="line-1082"></a><span class="hs-identifier">genericWordSubCOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1083"></a><a name="genericWordSubCOp"><a href="StgCmmPrim.html#genericWordSubCOp"><span class="hs-identifier">genericWordSubCOp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977536"><a href="#local-6989586621680977536"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977537"><a href="#local-6989586621680977537"><span class="hs-identifier">res_c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977538"><a href="#local-6989586621680977538"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977539"><a href="#local-6989586621680977539"><span class="hs-identifier">bb</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1084"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977540"><a href="#local-6989586621680977540"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1085"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1086"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977536"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSub"><span class="hs-identifier hs-var">mo_wordSub</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977538"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977539"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1087"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977537"><span class="hs-identifier hs-var">res_c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1088"></a><span>          </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1089"></a><span>            </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1090"></a><span>              </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1091"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977538"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1092"></a><span>                </span><a href="#local-6989586621680977539"><span class="hs-identifier hs-var">bb</span></a><span>
</span><a name="line-1093"></a><span>              </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1094"></a><span>              </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1095"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1096"></a><span>                  </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977538"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1097"></a><span>                  </span><a href="#local-6989586621680977539"><span class="hs-identifier hs-var">bb</span></a><span>
</span><a name="line-1098"></a><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1099"></a><span>                </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977536"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-1101"></a><span>            </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1102"></a><span>            </span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE_IN_BITS</span><span> </span><a href="#local-6989586621680977540"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1104"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1105"></a><span class="hs-identifier">genericWordSubCOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordSubCOp&quot;</span><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span class="hs-identifier">genericIntAddCOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1108"></a><a name="genericIntAddCOp"><a href="StgCmmPrim.html#genericIntAddCOp"><span class="hs-identifier">genericIntAddCOp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977541"><a href="#local-6989586621680977541"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977542"><a href="#local-6989586621680977542"><span class="hs-identifier">res_c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977543"><a href="#local-6989586621680977543"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977544"><a href="#local-6989586621680977544"><span class="hs-identifier">bb</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1109"></a><span class="hs-comment">{-
   With some bit-twiddling, we can define int{Add,Sub}Czh portably in
   C, and without needing any comparisons.  This may not be the
   fastest way to do it - if you have better code, please send it! --SDM

   Return : r = a + b,  c = 0 if no overflow, 1 on overflow.

   We currently don't make use of the r value if c is != 0 (i.e.
   overflow), we just convert to big integers and try again.  This
   could be improved by making r and c the correct values for
   plugging into a new J#.

   { r = ((I_)(a)) + ((I_)(b));                                 \
     c = ((StgWord)(~(((I_)(a))^((I_)(b))) &amp; (((I_)(a))^r)))    \
         &gt;&gt; (BITS_IN (I_) - 1);                                 \
   }
   Wading through the mass of bracketry, it seems to reduce to:
   c = ( (~(a^b)) &amp; (a^r) ) &gt;&gt;unsigned (BITS_IN(I_)-1)

-}</span><span>
</span><a name="line-1129"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977545"><a href="#local-6989586621680977545"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1130"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1131"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977541"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAdd"><span class="hs-identifier hs-var">mo_wordAdd</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977543"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977544"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1132"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977542"><span class="hs-identifier hs-var">res_c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1133"></a><span>          </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1134"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1135"></a><span>                    </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977543"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977544"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1136"></a><span>                    </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977543"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977541"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1137"></a><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1138"></a><span>                </span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE_IN_BITS</span><span> </span><a href="#local-6989586621680977545"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1139"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1140"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1141"></a><span class="hs-identifier">genericIntAddCOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericIntAddCOp&quot;</span><span>
</span><a name="line-1142"></a><span>
</span><a name="line-1143"></a><span class="hs-identifier">genericIntSubCOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1144"></a><a name="genericIntSubCOp"><a href="StgCmmPrim.html#genericIntSubCOp"><span class="hs-identifier">genericIntSubCOp</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977546"><a href="#local-6989586621680977546"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977547"><a href="#local-6989586621680977547"><span class="hs-identifier">res_c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977548"><a href="#local-6989586621680977548"><span class="hs-identifier">aa</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977549"><a href="#local-6989586621680977549"><span class="hs-identifier">bb</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1145"></a><span class="hs-comment">{- Similarly:
   #define subIntCzh(r,c,a,b)                                   \
   { r = ((I_)(a)) - ((I_)(b));                                 \
     c = ((StgWord)((((I_)(a))^((I_)(b))) &amp; (((I_)(a))^r)))     \
         &gt;&gt; (BITS_IN (I_) - 1);                                 \
   }

   c =  ((a^b) &amp; (a^r)) &gt;&gt;unsigned (BITS_IN(I_)-1)
-}</span><span>
</span><a name="line-1154"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977550"><a href="#local-6989586621680977550"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1155"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1156"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977546"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSub"><span class="hs-identifier hs-var">mo_wordSub</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977548"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977549"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1157"></a><span>        </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977547"><span class="hs-identifier hs-var">res_c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1158"></a><span>          </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1159"></a><span>                </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1160"></a><span>                    </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977548"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><a href="#local-6989586621680977549"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1161"></a><span>                    </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977548"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span> </span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977546"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1162"></a><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1163"></a><span>                </span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE_IN_BITS</span><span> </span><a href="#local-6989586621680977550"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1164"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1165"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1166"></a><span class="hs-identifier">genericIntSubCOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericIntSubCOp&quot;</span><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span class="hs-identifier">genericWordMul2Op</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1169"></a><a name="genericWordMul2Op"><a href="StgCmmPrim.html#genericWordMul2Op"><span class="hs-identifier">genericWordMul2Op</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977551"><a href="#local-6989586621680977551"><span class="hs-identifier">res_h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977552"><a href="#local-6989586621680977552"><span class="hs-identifier">res_l</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977553"><a href="#local-6989586621680977553"><span class="hs-identifier">arg_x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977554"><a href="#local-6989586621680977554"><span class="hs-identifier">arg_y</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1170"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977555"><a href="#local-6989586621680977555"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1171"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977556"><a href="#local-6989586621680977556"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977553"><span class="hs-identifier hs-var">arg_x</span></a><span>
</span><a name="line-1172"></a><span>      </span><a name="local-6989586621680977557"><a href="#local-6989586621680977557"><span class="hs-identifier">xlyl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977556"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1173"></a><span>      </span><a name="local-6989586621680977558"><a href="#local-6989586621680977558"><span class="hs-identifier">xlyh</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977556"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1174"></a><span>      </span><a name="local-6989586621680977559"><a href="#local-6989586621680977559"><span class="hs-identifier">xhyl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977556"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1175"></a><span>      </span><a name="local-6989586621680977560"><a href="#local-6989586621680977560"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977556"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1176"></a><span>      </span><span class="hs-comment">-- This generic implementation is very simple and slow. We might</span><span>
</span><a name="line-1177"></a><span>      </span><span class="hs-comment">-- well be able to do better, but for now this at least works.</span><span>
</span><a name="line-1178"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977561"><a href="#local-6989586621680977561"><span class="hs-identifier">topHalf</span></a></a><span> </span><a name="local-6989586621680977570"><a href="#local-6989586621680977570"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Shr"><span class="hs-identifier hs-var">MO_U_Shr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977570"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977568"><span class="hs-identifier hs-var">hww</span></a><span class="hs-special">]</span><span>
</span><a name="line-1179"></a><span>          </span><a name="local-6989586621680977562"><a href="#local-6989586621680977562"><span class="hs-identifier">toTopHalf</span></a></a><span> </span><a name="local-6989586621680977571"><a href="#local-6989586621680977571"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Shl"><span class="hs-identifier hs-var">MO_Shl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977571"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977568"><span class="hs-identifier hs-var">hww</span></a><span class="hs-special">]</span><span>
</span><a name="line-1180"></a><span>          </span><a name="local-6989586621680977563"><a href="#local-6989586621680977563"><span class="hs-identifier">bottomHalf</span></a></a><span> </span><a name="local-6989586621680977572"><a href="#local-6989586621680977572"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_And"><span class="hs-identifier hs-var">MO_And</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977572"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977569"><span class="hs-identifier hs-var">hwm</span></a><span class="hs-special">]</span><span>
</span><a name="line-1181"></a><span>          </span><a name="local-6989586621680977564"><a href="#local-6989586621680977564"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-6989586621680977573"><a href="#local-6989586621680977573"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977574"><a href="#local-6989586621680977574"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977573"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977574"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1182"></a><span>          </span><a name="local-6989586621680977565"><a href="#local-6989586621680977565"><span class="hs-identifier">sum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1</span><span> </span><a href="#local-6989586621680977564"><span class="hs-identifier hs-var">add</span></a><span>
</span><a name="line-1183"></a><span>          </span><a name="local-6989586621680977566"><a href="#local-6989586621680977566"><span class="hs-identifier">mul</span></a></a><span> </span><a name="local-6989586621680977575"><a href="#local-6989586621680977575"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977576"><a href="#local-6989586621680977576"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977575"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977576"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1184"></a><span>          </span><a name="local-6989586621680977567"><a href="#local-6989586621680977567"><span class="hs-identifier">or</span></a></a><span> </span><a name="local-6989586621680977577"><a href="#local-6989586621680977577"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977578"><a href="#local-6989586621680977578"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Or"><span class="hs-identifier hs-var">MO_Or</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977577"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977578"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1185"></a><span>          </span><a name="local-6989586621680977568"><a href="#local-6989586621680977568"><span class="hs-identifier">hww</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">widthInBits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">halfWordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1186"></a><span>                               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1187"></a><span>          </span><a name="local-6989586621680977569"><a href="#local-6989586621680977569"><span class="hs-identifier">hwm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">halfWordMask</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977555"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1188"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span>
</span><a name="line-1189"></a><span>             </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977557"><span class="hs-identifier hs-var">xlyl</span></a><span>
</span><a name="line-1190"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977566"><span class="hs-identifier hs-var">mul</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977553"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977554"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1191"></a><span>              </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977558"><span class="hs-identifier hs-var">xlyh</span></a><span>
</span><a name="line-1192"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977566"><span class="hs-identifier hs-var">mul</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977553"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977554"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1193"></a><span>              </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977559"><span class="hs-identifier hs-var">xhyl</span></a><span>
</span><a name="line-1194"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977566"><span class="hs-identifier hs-var">mul</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977553"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><a href="#local-6989586621680977554"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1195"></a><span>              </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977560"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1196"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977565"><span class="hs-identifier hs-var">sum</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span>    </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977557"><span class="hs-identifier hs-var">xlyl</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1197"></a><span>                        </span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977559"><span class="hs-identifier hs-var">xhyl</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1198"></a><span>                        </span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977558"><span class="hs-identifier hs-var">xlyh</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1199"></a><span>              </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977552"><span class="hs-identifier hs-var">res_l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1200"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977567"><span class="hs-identifier hs-var">or</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977563"><span class="hs-identifier hs-var">bottomHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977557"><span class="hs-identifier hs-var">xlyl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1201"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621680977562"><span class="hs-identifier hs-var">toTopHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977560"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1202"></a><span>              </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977551"><span class="hs-identifier hs-var">res_h</span></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680977565"><span class="hs-identifier hs-var">sum</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977566"><span class="hs-identifier hs-var">mul</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977553"><span class="hs-identifier hs-var">arg_x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><a href="#local-6989586621680977554"><span class="hs-identifier hs-var">arg_y</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1204"></a><span>                        </span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977559"><span class="hs-identifier hs-var">xhyl</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1205"></a><span>                        </span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977558"><span class="hs-identifier hs-var">xlyh</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1206"></a><span>                        </span><a href="#local-6989586621680977561"><span class="hs-identifier hs-var">topHalf</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977560"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1207"></a><span class="hs-identifier">genericWordMul2Op</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericWordMul2Op&quot;</span><span>
</span><a name="line-1208"></a><span>
</span><a name="line-1209"></a><span class="hs-comment">-- This replicates what we had in libraries/base/GHC/Float.hs:</span><span>
</span><a name="line-1210"></a><span class="hs-comment">--</span><span>
</span><a name="line-1211"></a><span class="hs-comment">--    abs x    | x == 0    = 0 -- handles (-0.0)</span><span>
</span><a name="line-1212"></a><span class="hs-comment">--             | x &gt;  0    = x</span><span>
</span><a name="line-1213"></a><span class="hs-comment">--             | otherwise = negateFloat x</span><span>
</span><a name="line-1214"></a><span class="hs-identifier">genericFabsOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmPrim.html#GenericOp"><span class="hs-identifier hs-type">GenericOp</span></a><span>
</span><a name="line-1215"></a><a name="genericFabsOp"><a href="StgCmmPrim.html#genericFabsOp"><span class="hs-identifier">genericFabsOp</span></a></a><span> </span><a name="local-6989586621680977579"><a href="#local-6989586621680977579"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977580"><a href="#local-6989586621680977580"><span class="hs-identifier">res_r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977581"><a href="#local-6989586621680977581"><span class="hs-identifier">aa</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1216"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977582"><a href="#local-6989586621680977582"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1217"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977583"><a href="#local-6989586621680977583"><span class="hs-identifier">zero</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmFloat"><span class="hs-identifier hs-var">CmmFloat</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977579"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1218"></a><span>
</span><a name="line-1219"></a><span>          </span><a name="local-6989586621680977584"><a href="#local-6989586621680977584"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621680977589"><a href="#local-6989586621680977589"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977590"><a href="#local-6989586621680977590"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Eq"><span class="hs-identifier hs-var">MO_F_Eq</span></a><span> </span><a href="#local-6989586621680977579"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977589"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977590"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1220"></a><span>          </span><a name="local-6989586621680977585"><a href="#local-6989586621680977585"><span class="hs-identifier">gt</span></a></a><span> </span><a name="local-6989586621680977591"><a href="#local-6989586621680977591"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680977592"><a href="#local-6989586621680977592"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Gt"><span class="hs-identifier hs-var">MO_F_Gt</span></a><span> </span><a href="#local-6989586621680977579"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977591"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977592"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1221"></a><span>
</span><a name="line-1222"></a><span>          </span><a name="local-6989586621680977586"><a href="#local-6989586621680977586"><span class="hs-identifier">neg</span></a></a><span> </span><a name="local-6989586621680977593"><a href="#local-6989586621680977593"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Neg"><span class="hs-identifier hs-var">MO_F_Neg</span></a><span> </span><a href="#local-6989586621680977579"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977593"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span>          </span><a name="local-6989586621680977587"><a href="#local-6989586621680977587"><span class="hs-identifier">g1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977580"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977583"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">]</span><span>
</span><a name="line-1225"></a><span>          </span><a name="local-6989586621680977588"><a href="#local-6989586621680977588"><span class="hs-identifier">g2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977580"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977581"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span>
</span><a name="line-1226"></a><span>
</span><a name="line-1227"></a><span>      </span><a name="local-6989586621680977594"><a href="#local-6989586621680977594"><span class="hs-identifier">res_t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977582"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977581"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">)</span><span>
</span><a name="line-1228"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977595"><a href="#local-6989586621680977595"><span class="hs-identifier">g3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><span class="hs-special">[</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977594"><span class="hs-identifier hs-var">res_t</span></a><span> </span><a href="#local-6989586621680977581"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">,</span><span>
</span><a name="line-1229"></a><span>                           </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977580"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977586"><span class="hs-identifier hs-var">neg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977594"><span class="hs-identifier hs-var">res_t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1230"></a><span>
</span><a name="line-1231"></a><span>      </span><a name="local-6989586621680977596"><a href="#local-6989586621680977596"><span class="hs-identifier">g4</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThenElse"><span class="hs-identifier hs-var">mkCmmIfThenElse</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977585"><span class="hs-identifier hs-var">gt</span></a><span> </span><a href="#local-6989586621680977581"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-6989586621680977583"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977588"><span class="hs-identifier hs-var">g2</span></a><span> </span><a href="#local-6989586621680977595"><span class="hs-identifier hs-var">g3</span></a><span>
</span><a name="line-1232"></a><span>
</span><a name="line-1233"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThenElse"><span class="hs-identifier hs-var">mkCmmIfThenElse</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977584"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621680977581"><span class="hs-identifier hs-var">aa</span></a><span> </span><a href="#local-6989586621680977583"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977587"><span class="hs-identifier hs-var">g1</span></a><span> </span><a href="#local-6989586621680977596"><span class="hs-identifier hs-var">g4</span></a><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-identifier">genericFabsOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;genericFabsOp&quot;</span><span>
</span><a name="line-1236"></a><span>
</span><a name="line-1237"></a><span class="hs-comment">-- These PrimOps are NOPs in Cmm</span><span>
</span><a name="line-1238"></a><span>
</span><a name="line-1239"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1240"></a><a name="nopOp"><a href="StgCmmPrim.html#nopOp"><span class="hs-identifier">nopOp</span></a></a><span> </span><span class="hs-identifier hs-var">Int2WordOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1241"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier hs-var">Word2IntOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1242"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier hs-var">Int2AddrOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier hs-var">Addr2IntOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1244"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier hs-var">ChrOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-comment">-- Int# and Char# are rep'd the same</span><span>
</span><a name="line-1245"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier hs-var">OrdOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1246"></a><span class="hs-identifier">nopOp</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1247"></a><span>
</span><a name="line-1248"></a><span class="hs-comment">-- These PrimOps turn into double casts</span><span>
</span><a name="line-1249"></a><span>
</span><a name="line-1250"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Width</span><span class="hs-special">)</span><span>
</span><a name="line-1251"></a><a name="narrowOp"><a href="StgCmmPrim.html#narrowOp"><span class="hs-identifier">narrowOp</span></a></a><span> </span><span class="hs-identifier hs-var">Narrow8IntOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1252"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier hs-var">Narrow16IntOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1253"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier hs-var">Narrow32IntOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1254"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier hs-var">Narrow8WordOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1255"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier hs-var">Narrow16WordOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier hs-var">Narrow32WordOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1257"></a><span class="hs-identifier">narrowOp</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1258"></a><span>
</span><a name="line-1259"></a><span class="hs-comment">-- Native word signless ops</span><span>
</span><a name="line-1260"></a><span>
</span><a name="line-1261"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1262"></a><a name="translateOp"><a href="StgCmmPrim.html#translateOp"><span class="hs-identifier">translateOp</span></a></a><span> </span><a name="local-6989586621680977597"><a href="#local-6989586621680977597"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntAddOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAdd"><span class="hs-identifier hs-var">mo_wordAdd</span></a><span> </span><a href="#local-6989586621680977597"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977598"><a href="#local-6989586621680977598"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntSubOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSub"><span class="hs-identifier hs-var">mo_wordSub</span></a><span> </span><a href="#local-6989586621680977598"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1264"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977599"><a href="#local-6989586621680977599"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordAddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAdd"><span class="hs-identifier hs-var">mo_wordAdd</span></a><span> </span><a href="#local-6989586621680977599"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1265"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977600"><a href="#local-6989586621680977600"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordSubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSub"><span class="hs-identifier hs-var">mo_wordSub</span></a><span> </span><a href="#local-6989586621680977600"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1266"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977601"><a href="#local-6989586621680977601"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrAddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAdd"><span class="hs-identifier hs-var">mo_wordAdd</span></a><span> </span><a href="#local-6989586621680977601"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1267"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977602"><a href="#local-6989586621680977602"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrSubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSub"><span class="hs-identifier hs-var">mo_wordSub</span></a><span> </span><a href="#local-6989586621680977602"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>
</span><a name="line-1269"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977603"><a href="#local-6989586621680977603"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntEqOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977603"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977604"><a href="#local-6989586621680977604"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntNeOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNe"><span class="hs-identifier hs-var">mo_wordNe</span></a><span> </span><a href="#local-6989586621680977604"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977605"><a href="#local-6989586621680977605"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordEqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977605"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977606"><a href="#local-6989586621680977606"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordNeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNe"><span class="hs-identifier hs-var">mo_wordNe</span></a><span> </span><a href="#local-6989586621680977606"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1273"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977607"><a href="#local-6989586621680977607"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrEqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977607"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1274"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977608"><a href="#local-6989586621680977608"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrNeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNe"><span class="hs-identifier hs-var">mo_wordNe</span></a><span> </span><a href="#local-6989586621680977608"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1275"></a><span>
</span><a name="line-1276"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977609"><a href="#local-6989586621680977609"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AndOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977609"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1277"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977610"><a href="#local-6989586621680977610"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">OrOp</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977610"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1278"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977611"><a href="#local-6989586621680977611"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">XorOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977611"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1279"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977612"><a href="#local-6989586621680977612"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">NotOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977612"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977613"><a href="#local-6989586621680977613"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SllOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordShl"><span class="hs-identifier hs-var">mo_wordShl</span></a><span> </span><a href="#local-6989586621680977613"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1281"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977614"><a href="#local-6989586621680977614"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SrlOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977614"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977615"><a href="#local-6989586621680977615"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrRemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordURem"><span class="hs-identifier hs-var">mo_wordURem</span></a><span> </span><a href="#local-6989586621680977615"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>
</span><a name="line-1285"></a><span class="hs-comment">-- Native word signed ops</span><span>
</span><a name="line-1286"></a><span>
</span><a name="line-1287"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977616"><a href="#local-6989586621680977616"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntMulOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordMul"><span class="hs-identifier hs-var">mo_wordMul</span></a><span> </span><a href="#local-6989586621680977616"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1288"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977617"><a href="#local-6989586621680977617"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntMulMayOfloOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-var">MO_S_MulMayOflo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977617"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1289"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977618"><a href="#local-6989586621680977618"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntQuotOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSQuot"><span class="hs-identifier hs-var">mo_wordSQuot</span></a><span> </span><a href="#local-6989586621680977618"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1290"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977619"><a href="#local-6989586621680977619"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntRemOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSRem"><span class="hs-identifier hs-var">mo_wordSRem</span></a><span> </span><a href="#local-6989586621680977619"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1291"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977620"><a href="#local-6989586621680977620"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntNegOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSNeg"><span class="hs-identifier hs-var">mo_wordSNeg</span></a><span> </span><a href="#local-6989586621680977620"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span>
</span><a name="line-1294"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977621"><a href="#local-6989586621680977621"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntGeOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSGe"><span class="hs-identifier hs-var">mo_wordSGe</span></a><span> </span><a href="#local-6989586621680977621"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977622"><a href="#local-6989586621680977622"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntLeOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSLe"><span class="hs-identifier hs-var">mo_wordSLe</span></a><span> </span><a href="#local-6989586621680977622"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1296"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977623"><a href="#local-6989586621680977623"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntGtOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSGt"><span class="hs-identifier hs-var">mo_wordSGt</span></a><span> </span><a href="#local-6989586621680977623"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977624"><a href="#local-6989586621680977624"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntLtOp</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSLt"><span class="hs-identifier hs-var">mo_wordSLt</span></a><span> </span><a href="#local-6989586621680977624"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>
</span><a name="line-1299"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977625"><a href="#local-6989586621680977625"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AndIOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordAnd"><span class="hs-identifier hs-var">mo_wordAnd</span></a><span> </span><a href="#local-6989586621680977625"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1300"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977626"><a href="#local-6989586621680977626"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">OrIOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordOr"><span class="hs-identifier hs-var">mo_wordOr</span></a><span> </span><a href="#local-6989586621680977626"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1301"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977627"><a href="#local-6989586621680977627"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">XorIOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordXor"><span class="hs-identifier hs-var">mo_wordXor</span></a><span> </span><a href="#local-6989586621680977627"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1302"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977628"><a href="#local-6989586621680977628"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">NotIOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordNot"><span class="hs-identifier hs-var">mo_wordNot</span></a><span> </span><a href="#local-6989586621680977628"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1303"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977629"><a href="#local-6989586621680977629"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">ISllOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordShl"><span class="hs-identifier hs-var">mo_wordShl</span></a><span> </span><a href="#local-6989586621680977629"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1304"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977630"><a href="#local-6989586621680977630"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">ISraOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordSShr"><span class="hs-identifier hs-var">mo_wordSShr</span></a><span> </span><a href="#local-6989586621680977630"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1305"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977631"><a href="#local-6989586621680977631"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">ISrlOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977631"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>
</span><a name="line-1307"></a><span class="hs-comment">-- Native word unsigned ops</span><span>
</span><a name="line-1308"></a><span>
</span><a name="line-1309"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977632"><a href="#local-6989586621680977632"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordGeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUGe"><span class="hs-identifier hs-var">mo_wordUGe</span></a><span> </span><a href="#local-6989586621680977632"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1310"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977633"><a href="#local-6989586621680977633"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordLeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordULe"><span class="hs-identifier hs-var">mo_wordULe</span></a><span> </span><a href="#local-6989586621680977633"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1311"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977634"><a href="#local-6989586621680977634"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordGtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUGt"><span class="hs-identifier hs-var">mo_wordUGt</span></a><span> </span><a href="#local-6989586621680977634"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1312"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977635"><a href="#local-6989586621680977635"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordLtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordULt"><span class="hs-identifier hs-var">mo_wordULt</span></a><span> </span><a href="#local-6989586621680977635"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977636"><a href="#local-6989586621680977636"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordMulOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordMul"><span class="hs-identifier hs-var">mo_wordMul</span></a><span> </span><a href="#local-6989586621680977636"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1315"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977637"><a href="#local-6989586621680977637"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordQuotOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUQuot"><span class="hs-identifier hs-var">mo_wordUQuot</span></a><span> </span><a href="#local-6989586621680977637"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1316"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977638"><a href="#local-6989586621680977638"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordRemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordURem"><span class="hs-identifier hs-var">mo_wordURem</span></a><span> </span><a href="#local-6989586621680977638"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1317"></a><span>
</span><a name="line-1318"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977639"><a href="#local-6989586621680977639"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrGeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUGe"><span class="hs-identifier hs-var">mo_wordUGe</span></a><span> </span><a href="#local-6989586621680977639"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977640"><a href="#local-6989586621680977640"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrLeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordULe"><span class="hs-identifier hs-var">mo_wordULe</span></a><span> </span><a href="#local-6989586621680977640"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1320"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977641"><a href="#local-6989586621680977641"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrGtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUGt"><span class="hs-identifier hs-var">mo_wordUGt</span></a><span> </span><a href="#local-6989586621680977641"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1321"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977642"><a href="#local-6989586621680977642"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">AddrLtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordULt"><span class="hs-identifier hs-var">mo_wordULt</span></a><span> </span><a href="#local-6989586621680977642"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span class="hs-comment">-- Int8# signed ops</span><span>
</span><a name="line-1324"></a><span>
</span><a name="line-1325"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977643"><a href="#local-6989586621680977643"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int8Extend</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977643"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1326"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977644"><a href="#local-6989586621680977644"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int8Narrow</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977644"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1327"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8NegOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Neg"><span class="hs-identifier hs-var">MO_S_Neg</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1328"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8AddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1329"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8SubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1330"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8MulOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1331"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8QuotOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Quot"><span class="hs-identifier hs-var">MO_S_Quot</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1332"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8RemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Rem"><span class="hs-identifier hs-var">MO_S_Rem</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1333"></a><span>
</span><a name="line-1334"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8EqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Eq"><span class="hs-identifier hs-var">MO_Eq</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1335"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8GeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Ge"><span class="hs-identifier hs-var">MO_S_Ge</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1336"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8GtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Gt"><span class="hs-identifier hs-var">MO_S_Gt</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1337"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8LeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Le"><span class="hs-identifier hs-var">MO_S_Le</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1338"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8LtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Lt"><span class="hs-identifier hs-var">MO_S_Lt</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int8NeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1340"></a><span>
</span><a name="line-1341"></a><span class="hs-comment">-- Word8# unsigned ops</span><span>
</span><a name="line-1342"></a><span>
</span><a name="line-1343"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977645"><a href="#local-6989586621680977645"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Word8Extend</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977645"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977646"><a href="#local-6989586621680977646"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Word8Narrow</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977646"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1345"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8NotOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Not"><span class="hs-identifier hs-var">MO_Not</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1346"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8AddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8SubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1348"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8MulOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8QuotOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Quot"><span class="hs-identifier hs-var">MO_U_Quot</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1350"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8RemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Rem"><span class="hs-identifier hs-var">MO_U_Rem</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><span>
</span><a name="line-1352"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8EqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Eq"><span class="hs-identifier hs-var">MO_Eq</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1353"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8GeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Ge"><span class="hs-identifier hs-var">MO_U_Ge</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1354"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8GtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Gt"><span class="hs-identifier hs-var">MO_U_Gt</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1355"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8LeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Le"><span class="hs-identifier hs-var">MO_U_Le</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1356"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8LtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Lt"><span class="hs-identifier hs-var">MO_U_Lt</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1357"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word8NeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span class="hs-comment">-- Int16# signed ops</span><span>
</span><a name="line-1360"></a><span>
</span><a name="line-1361"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977647"><a href="#local-6989586621680977647"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int16Extend</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977647"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1362"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977648"><a href="#local-6989586621680977648"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int16Narrow</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977648"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1363"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16NegOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Neg"><span class="hs-identifier hs-var">MO_S_Neg</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1364"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16AddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1365"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16SubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1366"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16MulOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16QuotOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Quot"><span class="hs-identifier hs-var">MO_S_Quot</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1368"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16RemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Rem"><span class="hs-identifier hs-var">MO_S_Rem</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16EqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Eq"><span class="hs-identifier hs-var">MO_Eq</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1371"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16GeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Ge"><span class="hs-identifier hs-var">MO_S_Ge</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1372"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16GtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Gt"><span class="hs-identifier hs-var">MO_S_Gt</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1373"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16LeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Le"><span class="hs-identifier hs-var">MO_S_Le</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1374"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16LtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_S_Lt"><span class="hs-identifier hs-var">MO_S_Lt</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1375"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Int16NeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1376"></a><span>
</span><a name="line-1377"></a><span class="hs-comment">-- Word16# unsigned ops</span><span>
</span><a name="line-1378"></a><span>
</span><a name="line-1379"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977649"><a href="#local-6989586621680977649"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Word16Extend</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977649"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1380"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977650"><a href="#local-6989586621680977650"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Word16Narrow</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977650"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1381"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16NotOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Not"><span class="hs-identifier hs-var">MO_Not</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16AddOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1383"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16SubOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1384"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16MulOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Mul"><span class="hs-identifier hs-var">MO_Mul</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1385"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16QuotOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Quot"><span class="hs-identifier hs-var">MO_U_Quot</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1386"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16RemOp</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Rem"><span class="hs-identifier hs-var">MO_U_Rem</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1387"></a><span>
</span><a name="line-1388"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16EqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Eq"><span class="hs-identifier hs-var">MO_Eq</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16GeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Ge"><span class="hs-identifier hs-var">MO_U_Ge</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1390"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16GtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Gt"><span class="hs-identifier hs-var">MO_U_Gt</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1391"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16LeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Le"><span class="hs-identifier hs-var">MO_U_Le</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1392"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16LtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Lt"><span class="hs-identifier hs-var">MO_U_Lt</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1393"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Word16NeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span> </span><span class="hs-identifier hs-var">W16</span><span class="hs-special">)</span><span>
</span><a name="line-1394"></a><span>
</span><a name="line-1395"></a><span class="hs-comment">-- Char# ops</span><span>
</span><a name="line-1396"></a><span>
</span><a name="line-1397"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977651"><a href="#local-6989586621680977651"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharEqOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Eq"><span class="hs-identifier hs-var">MO_Eq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977651"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1398"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977652"><a href="#local-6989586621680977652"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharNeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ne"><span class="hs-identifier hs-var">MO_Ne</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977652"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1399"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977653"><a href="#local-6989586621680977653"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharGeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Ge"><span class="hs-identifier hs-var">MO_U_Ge</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977653"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1400"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977654"><a href="#local-6989586621680977654"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharLeOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Le"><span class="hs-identifier hs-var">MO_U_Le</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977654"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1401"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977655"><a href="#local-6989586621680977655"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharGtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Gt"><span class="hs-identifier hs-var">MO_U_Gt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977655"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1402"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977656"><a href="#local-6989586621680977656"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">CharLtOp</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_U_Lt"><span class="hs-identifier hs-var">MO_U_Lt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977656"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1403"></a><span>
</span><a name="line-1404"></a><span class="hs-comment">-- Double ops</span><span>
</span><a name="line-1405"></a><span>
</span><a name="line-1406"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleEqOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Eq"><span class="hs-identifier hs-var">MO_F_Eq</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1407"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleNeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Ne"><span class="hs-identifier hs-var">MO_F_Ne</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1408"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleGeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Ge"><span class="hs-identifier hs-var">MO_F_Ge</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1409"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleLeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Le"><span class="hs-identifier hs-var">MO_F_Le</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1410"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleGtOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Gt"><span class="hs-identifier hs-var">MO_F_Gt</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1411"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleLtOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Lt"><span class="hs-identifier hs-var">MO_F_Lt</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>
</span><a name="line-1413"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleAddOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Add"><span class="hs-identifier hs-var">MO_F_Add</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleSubOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Sub"><span class="hs-identifier hs-var">MO_F_Sub</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1415"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleMulOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Mul"><span class="hs-identifier hs-var">MO_F_Mul</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1416"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleDivOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Quot"><span class="hs-identifier hs-var">MO_F_Quot</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">DoubleNegOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Neg"><span class="hs-identifier hs-var">MO_F_Neg</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><span>
</span><a name="line-1419"></a><span class="hs-comment">-- Float ops</span><span>
</span><a name="line-1420"></a><span>
</span><a name="line-1421"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatEqOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Eq"><span class="hs-identifier hs-var">MO_F_Eq</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1422"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatNeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Ne"><span class="hs-identifier hs-var">MO_F_Ne</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1423"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatGeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Ge"><span class="hs-identifier hs-var">MO_F_Ge</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatLeOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Le"><span class="hs-identifier hs-var">MO_F_Le</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1425"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatGtOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Gt"><span class="hs-identifier hs-var">MO_F_Gt</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1426"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatLtOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Lt"><span class="hs-identifier hs-var">MO_F_Lt</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatAddOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Add"><span class="hs-identifier hs-var">MO_F_Add</span></a><span>  </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1429"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatSubOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Sub"><span class="hs-identifier hs-var">MO_F_Sub</span></a><span>  </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1430"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatMulOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Mul"><span class="hs-identifier hs-var">MO_F_Mul</span></a><span>  </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1431"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatDivOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Quot"><span class="hs-identifier hs-var">MO_F_Quot</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1432"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatNegOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_F_Neg"><span class="hs-identifier hs-var">MO_F_Neg</span></a><span>  </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1433"></a><span>
</span><a name="line-1434"></a><span class="hs-comment">-- Vector ops</span><span>
</span><a name="line-1435"></a><span>
</span><a name="line-1436"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecAddOp</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><a name="local-6989586621680977657"><a href="#local-6989586621680977657"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977658"><a href="#local-6989586621680977658"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Add"><span class="hs-identifier hs-var">MO_VF_Add</span></a><span>  </span><a href="#local-6989586621680977657"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977658"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1437"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecSubOp</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><a name="local-6989586621680977659"><a href="#local-6989586621680977659"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977660"><a href="#local-6989586621680977660"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Sub"><span class="hs-identifier hs-var">MO_VF_Sub</span></a><span>  </span><a href="#local-6989586621680977659"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977660"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1438"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecMulOp</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><a name="local-6989586621680977661"><a href="#local-6989586621680977661"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977662"><a href="#local-6989586621680977662"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Mul"><span class="hs-identifier hs-var">MO_VF_Mul</span></a><span>  </span><a href="#local-6989586621680977661"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977662"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecDivOp</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><a name="local-6989586621680977663"><a href="#local-6989586621680977663"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977664"><a href="#local-6989586621680977664"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Quot"><span class="hs-identifier hs-var">MO_VF_Quot</span></a><span> </span><a href="#local-6989586621680977663"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977664"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecNegOp</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><a name="local-6989586621680977665"><a href="#local-6989586621680977665"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977666"><a href="#local-6989586621680977666"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Neg"><span class="hs-identifier hs-var">MO_VF_Neg</span></a><span>  </span><a href="#local-6989586621680977665"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977666"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecAddOp</span><span>  </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977667"><a href="#local-6989586621680977667"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977668"><a href="#local-6989586621680977668"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Add"><span class="hs-identifier hs-var">MO_V_Add</span></a><span>   </span><a href="#local-6989586621680977667"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977668"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1443"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecSubOp</span><span>  </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977669"><a href="#local-6989586621680977669"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977670"><a href="#local-6989586621680977670"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Sub"><span class="hs-identifier hs-var">MO_V_Sub</span></a><span>   </span><a href="#local-6989586621680977669"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977670"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecMulOp</span><span>  </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977671"><a href="#local-6989586621680977671"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977672"><a href="#local-6989586621680977672"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Mul"><span class="hs-identifier hs-var">MO_V_Mul</span></a><span>   </span><a href="#local-6989586621680977671"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977672"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecQuotOp</span><span> </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977673"><a href="#local-6989586621680977673"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977674"><a href="#local-6989586621680977674"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VS_Quot"><span class="hs-identifier hs-var">MO_VS_Quot</span></a><span> </span><a href="#local-6989586621680977673"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977674"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1446"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecRemOp</span><span>  </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977675"><a href="#local-6989586621680977675"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977676"><a href="#local-6989586621680977676"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VS_Rem"><span class="hs-identifier hs-var">MO_VS_Rem</span></a><span>  </span><a href="#local-6989586621680977675"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977676"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecNegOp</span><span>  </span><span class="hs-identifier hs-var">IntVec</span><span> </span><a name="local-6989586621680977677"><a href="#local-6989586621680977677"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977678"><a href="#local-6989586621680977678"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VS_Neg"><span class="hs-identifier hs-var">MO_VS_Neg</span></a><span>  </span><a href="#local-6989586621680977677"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977678"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>
</span><a name="line-1449"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecAddOp</span><span>  </span><span class="hs-identifier hs-var">WordVec</span><span> </span><a name="local-6989586621680977679"><a href="#local-6989586621680977679"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977680"><a href="#local-6989586621680977680"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Add"><span class="hs-identifier hs-var">MO_V_Add</span></a><span>   </span><a href="#local-6989586621680977679"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977680"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecSubOp</span><span>  </span><span class="hs-identifier hs-var">WordVec</span><span> </span><a name="local-6989586621680977681"><a href="#local-6989586621680977681"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977682"><a href="#local-6989586621680977682"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Sub"><span class="hs-identifier hs-var">MO_V_Sub</span></a><span>   </span><a href="#local-6989586621680977681"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977682"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecMulOp</span><span>  </span><span class="hs-identifier hs-var">WordVec</span><span> </span><a name="local-6989586621680977683"><a href="#local-6989586621680977683"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977684"><a href="#local-6989586621680977684"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Mul"><span class="hs-identifier hs-var">MO_V_Mul</span></a><span>   </span><a href="#local-6989586621680977683"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977684"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecQuotOp</span><span> </span><span class="hs-identifier hs-var">WordVec</span><span> </span><a name="local-6989586621680977685"><a href="#local-6989586621680977685"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977686"><a href="#local-6989586621680977686"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VU_Quot"><span class="hs-identifier hs-var">MO_VU_Quot</span></a><span> </span><a href="#local-6989586621680977685"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977686"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VecRemOp</span><span>  </span><span class="hs-identifier hs-var">WordVec</span><span> </span><a name="local-6989586621680977687"><a href="#local-6989586621680977687"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977688"><a href="#local-6989586621680977688"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VU_Rem"><span class="hs-identifier hs-var">MO_VU_Rem</span></a><span>  </span><a href="#local-6989586621680977687"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680977688"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1454"></a><span>
</span><a name="line-1455"></a><span class="hs-comment">-- Conversions</span><span>
</span><a name="line-1456"></a><span>
</span><a name="line-1457"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977689"><a href="#local-6989586621680977689"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int2DoubleOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SF_Conv"><span class="hs-identifier hs-var">MO_SF_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977689"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977690"><a href="#local-6989586621680977690"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Double2IntOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_FS_Conv"><span class="hs-identifier hs-var">MO_FS_Conv</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977690"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>
</span><a name="line-1460"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977691"><a href="#local-6989586621680977691"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Int2FloatOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SF_Conv"><span class="hs-identifier hs-var">MO_SF_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977691"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1461"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977692"><a href="#local-6989586621680977692"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">Float2IntOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_FS_Conv"><span class="hs-identifier hs-var">MO_FS_Conv</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977692"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Float2DoubleOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_FF_Conv"><span class="hs-identifier hs-var">MO_FF_Conv</span></a><span> </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-identifier hs-var">W64</span><span class="hs-special">)</span><span>
</span><a name="line-1464"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">Double2FloatOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_FF_Conv"><span class="hs-identifier hs-var">MO_FF_Conv</span></a><span> </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1465"></a><span>
</span><a name="line-1466"></a><span class="hs-comment">-- Word comparisons masquerading as more exotic things.</span><span>
</span><a name="line-1467"></a><span>
</span><a name="line-1468"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977693"><a href="#local-6989586621680977693"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameMutVarOp</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977693"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977694"><a href="#local-6989586621680977694"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameMVarOp</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977694"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977695"><a href="#local-6989586621680977695"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameMutableArrayOp</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977695"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1471"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977696"><a href="#local-6989586621680977696"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameMutableByteArrayOp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977696"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977697"><a href="#local-6989586621680977697"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameMutableArrayArrayOp</span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977697"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977698"><a href="#local-6989586621680977698"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameSmallMutableArrayOp</span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977698"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977699"><a href="#local-6989586621680977699"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">SameTVarOp</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977699"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1475"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977700"><a href="#local-6989586621680977700"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">EqStablePtrOp</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977700"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1476"></a><span class="hs-comment">-- See Note [Comparing stable names]</span><span>
</span><a name="line-1477"></a><span class="hs-identifier">translateOp</span><span> </span><a name="local-6989586621680977701"><a href="#local-6989586621680977701"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">EqStableNameOp</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordEq"><span class="hs-identifier hs-var">mo_wordEq</span></a><span> </span><a href="#local-6989586621680977701"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>
</span><a name="line-1479"></a><span class="hs-identifier">translateOp</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-comment">-- Note [Comparing stable names]</span><span>
</span><a name="line-1482"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-1483"></a><span class="hs-comment">--</span><span>
</span><a name="line-1484"></a><span class="hs-comment">-- A StableName# is actually a pointer to a stable name object (SNO)</span><span>
</span><a name="line-1485"></a><span class="hs-comment">-- containing an index into the stable name table (SNT). We</span><span>
</span><a name="line-1486"></a><span class="hs-comment">-- used to compare StableName#s by following the pointers to the</span><span>
</span><a name="line-1487"></a><span class="hs-comment">-- SNOs and checking whether they held the same SNT indices. However,</span><span>
</span><a name="line-1488"></a><span class="hs-comment">-- this is not necessary: there is a one-to-one correspondence</span><span>
</span><a name="line-1489"></a><span class="hs-comment">-- between SNOs and entries in the SNT, so simple pointer equality</span><span>
</span><a name="line-1490"></a><span class="hs-comment">-- does the trick.</span><span>
</span><a name="line-1491"></a><span>
</span><a name="line-1492"></a><span class="hs-comment">-- These primops are implemented by CallishMachOps, because they sometimes</span><span>
</span><a name="line-1493"></a><span class="hs-comment">-- turn into foreign calls depending on the backend.</span><span>
</span><a name="line-1494"></a><span>
</span><a name="line-1495"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimOp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#CallishMachOp"><span class="hs-identifier hs-type">CallishMachOp</span></a><span>
</span><a name="line-1496"></a><a name="callishOp"><a href="StgCmmPrim.html#callishOp"><span class="hs-identifier">callishOp</span></a></a><span> </span><span class="hs-identifier hs-var">DoublePowerOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Pwr"><span class="hs-identifier hs-var">MO_F64_Pwr</span></a><span>
</span><a name="line-1497"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleSinOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Sin"><span class="hs-identifier hs-var">MO_F64_Sin</span></a><span>
</span><a name="line-1498"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleCosOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Cos"><span class="hs-identifier hs-var">MO_F64_Cos</span></a><span>
</span><a name="line-1499"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleTanOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Tan"><span class="hs-identifier hs-var">MO_F64_Tan</span></a><span>
</span><a name="line-1500"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleSinhOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Sinh"><span class="hs-identifier hs-var">MO_F64_Sinh</span></a><span>
</span><a name="line-1501"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleCoshOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Cosh"><span class="hs-identifier hs-var">MO_F64_Cosh</span></a><span>
</span><a name="line-1502"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleTanhOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Tanh"><span class="hs-identifier hs-var">MO_F64_Tanh</span></a><span>
</span><a name="line-1503"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAsinOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Asin"><span class="hs-identifier hs-var">MO_F64_Asin</span></a><span>
</span><a name="line-1504"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAcosOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Acos"><span class="hs-identifier hs-var">MO_F64_Acos</span></a><span>
</span><a name="line-1505"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAtanOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Atan"><span class="hs-identifier hs-var">MO_F64_Atan</span></a><span>
</span><a name="line-1506"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAsinhOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Asinh"><span class="hs-identifier hs-var">MO_F64_Asinh</span></a><span>
</span><a name="line-1507"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAcoshOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Acosh"><span class="hs-identifier hs-var">MO_F64_Acosh</span></a><span>
</span><a name="line-1508"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleAtanhOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Atanh"><span class="hs-identifier hs-var">MO_F64_Atanh</span></a><span>
</span><a name="line-1509"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleLogOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Log"><span class="hs-identifier hs-var">MO_F64_Log</span></a><span>
</span><a name="line-1510"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleExpOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Exp"><span class="hs-identifier hs-var">MO_F64_Exp</span></a><span>
</span><a name="line-1511"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">DoubleSqrtOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F64_Sqrt"><span class="hs-identifier hs-var">MO_F64_Sqrt</span></a><span>
</span><a name="line-1512"></a><span>
</span><a name="line-1513"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatPowerOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Pwr"><span class="hs-identifier hs-var">MO_F32_Pwr</span></a><span>
</span><a name="line-1514"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatSinOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Sin"><span class="hs-identifier hs-var">MO_F32_Sin</span></a><span>
</span><a name="line-1515"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatCosOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Cos"><span class="hs-identifier hs-var">MO_F32_Cos</span></a><span>
</span><a name="line-1516"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatTanOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Tan"><span class="hs-identifier hs-var">MO_F32_Tan</span></a><span>
</span><a name="line-1517"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatSinhOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Sinh"><span class="hs-identifier hs-var">MO_F32_Sinh</span></a><span>
</span><a name="line-1518"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatCoshOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Cosh"><span class="hs-identifier hs-var">MO_F32_Cosh</span></a><span>
</span><a name="line-1519"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatTanhOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Tanh"><span class="hs-identifier hs-var">MO_F32_Tanh</span></a><span>
</span><a name="line-1520"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAsinOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Asin"><span class="hs-identifier hs-var">MO_F32_Asin</span></a><span>
</span><a name="line-1521"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAcosOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Acos"><span class="hs-identifier hs-var">MO_F32_Acos</span></a><span>
</span><a name="line-1522"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAtanOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Atan"><span class="hs-identifier hs-var">MO_F32_Atan</span></a><span>
</span><a name="line-1523"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAsinhOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Asinh"><span class="hs-identifier hs-var">MO_F32_Asinh</span></a><span>
</span><a name="line-1524"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAcoshOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Acosh"><span class="hs-identifier hs-var">MO_F32_Acosh</span></a><span>
</span><a name="line-1525"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatAtanhOp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Atanh"><span class="hs-identifier hs-var">MO_F32_Atanh</span></a><span>
</span><a name="line-1526"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatLogOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Log"><span class="hs-identifier hs-var">MO_F32_Log</span></a><span>
</span><a name="line-1527"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatExpOp</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Exp"><span class="hs-identifier hs-var">MO_F32_Exp</span></a><span>
</span><a name="line-1528"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier hs-var">FloatSqrtOp</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="CmmMachOp.html#MO_F32_Sqrt"><span class="hs-identifier hs-var">MO_F32_Sqrt</span></a><span>
</span><a name="line-1529"></a><span>
</span><a name="line-1530"></a><span class="hs-identifier">callishOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1531"></a><span>
</span><a name="line-1532"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-1533"></a><span class="hs-comment">-- Helpers for translating various minor variants of array indexing.</span><span>
</span><a name="line-1534"></a><span>
</span><a name="line-1535"></a><span class="hs-identifier">doIndexOffAddrOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1536"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1537"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1538"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1539"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1540"></a><a name="doIndexOffAddrOp"><a href="StgCmmPrim.html#doIndexOffAddrOp"><span class="hs-identifier">doIndexOffAddrOp</span></a></a><span> </span><a name="local-6989586621680977702"><a href="#local-6989586621680977702"><span class="hs-identifier">maybe_post_read_cast</span></a></a><span> </span><a name="local-6989586621680977703"><a href="#local-6989586621680977703"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977704"><a href="#local-6989586621680977704"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977705"><a href="#local-6989586621680977705"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977706"><a href="#local-6989586621680977706"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1541"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977702"><span class="hs-identifier hs-var">maybe_post_read_cast</span></a><span> </span><a href="#local-6989586621680977703"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977704"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977705"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977703"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977706"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1542"></a><span class="hs-identifier">doIndexOffAddrOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1543"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doIndexOffAddrOp&quot;</span><span>
</span><a name="line-1544"></a><span>
</span><a name="line-1545"></a><span class="hs-identifier">doIndexOffAddrOpAs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1546"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1547"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1548"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1549"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1550"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1551"></a><a name="doIndexOffAddrOpAs"><a href="StgCmmPrim.html#doIndexOffAddrOpAs"><span class="hs-identifier">doIndexOffAddrOpAs</span></a></a><span> </span><a name="local-6989586621680977707"><a href="#local-6989586621680977707"><span class="hs-identifier">maybe_post_read_cast</span></a></a><span> </span><a name="local-6989586621680977708"><a href="#local-6989586621680977708"><span class="hs-identifier">rep</span></a></a><span> </span><a name="local-6989586621680977709"><a href="#local-6989586621680977709"><span class="hs-identifier">idx_rep</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977710"><a href="#local-6989586621680977710"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977711"><a href="#local-6989586621680977711"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977712"><a href="#local-6989586621680977712"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1552"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977707"><span class="hs-identifier hs-var">maybe_post_read_cast</span></a><span> </span><a href="#local-6989586621680977708"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977710"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977711"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977709"><span class="hs-identifier hs-var">idx_rep</span></a><span> </span><a href="#local-6989586621680977712"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1553"></a><span class="hs-identifier">doIndexOffAddrOpAs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1554"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doIndexOffAddrOpAs&quot;</span><span>
</span><a name="line-1555"></a><span>
</span><a name="line-1556"></a><span class="hs-identifier">doIndexByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1557"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1558"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1559"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1560"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1561"></a><a name="doIndexByteArrayOp"><a href="StgCmmPrim.html#doIndexByteArrayOp"><span class="hs-identifier">doIndexByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977713"><a href="#local-6989586621680977713"><span class="hs-identifier">maybe_post_read_cast</span></a></a><span> </span><a name="local-6989586621680977714"><a href="#local-6989586621680977714"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977715"><a href="#local-6989586621680977715"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977716"><a href="#local-6989586621680977716"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977717"><a href="#local-6989586621680977717"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1562"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977718"><a href="#local-6989586621680977718"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1563"></a><span>        </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977718"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977713"><span class="hs-identifier hs-var">maybe_post_read_cast</span></a><span> </span><a href="#local-6989586621680977714"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977715"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977716"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977714"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977717"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1564"></a><span class="hs-identifier">doIndexByteArrayOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1565"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doIndexByteArrayOp&quot;</span><span>
</span><a name="line-1566"></a><span>
</span><a name="line-1567"></a><span class="hs-identifier">doIndexByteArrayOpAs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1568"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1569"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1570"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1571"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1572"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1573"></a><a name="doIndexByteArrayOpAs"><a href="StgCmmPrim.html#doIndexByteArrayOpAs"><span class="hs-identifier">doIndexByteArrayOpAs</span></a></a><span> </span><a name="local-6989586621680977719"><a href="#local-6989586621680977719"><span class="hs-identifier">maybe_post_read_cast</span></a></a><span> </span><a name="local-6989586621680977720"><a href="#local-6989586621680977720"><span class="hs-identifier">rep</span></a></a><span> </span><a name="local-6989586621680977721"><a href="#local-6989586621680977721"><span class="hs-identifier">idx_rep</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680977722"><a href="#local-6989586621680977722"><span class="hs-identifier">res</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977723"><a href="#local-6989586621680977723"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977724"><a href="#local-6989586621680977724"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1574"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977725"><a href="#local-6989586621680977725"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1575"></a><span>        </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977725"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977719"><span class="hs-identifier hs-var">maybe_post_read_cast</span></a><span> </span><a href="#local-6989586621680977720"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977722"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977723"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977721"><span class="hs-identifier hs-var">idx_rep</span></a><span> </span><a href="#local-6989586621680977724"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1576"></a><span class="hs-identifier">doIndexByteArrayOpAs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1577"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doIndexByteArrayOpAs&quot;</span><span>
</span><a name="line-1578"></a><span>
</span><a name="line-1579"></a><span class="hs-identifier">doReadPtrArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>
</span><a name="line-1580"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1581"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1582"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><a name="doReadPtrArrayOp"><a href="StgCmmPrim.html#doReadPtrArrayOp"><span class="hs-identifier">doReadPtrArrayOp</span></a></a><span> </span><a name="local-6989586621680977726"><a href="#local-6989586621680977726"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680977727"><a href="#local-6989586621680977727"><span class="hs-identifier">addr</span></a></a><span> </span><a name="local-6989586621680977728"><a href="#local-6989586621680977728"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1584"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977729"><a href="#local-6989586621680977729"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1585"></a><span>        </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680977729"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621680977729"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977726"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977727"><span class="hs-identifier hs-var">addr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621680977729"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977728"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1586"></a><span>
</span><a name="line-1587"></a><span class="hs-identifier">doWriteOffAddrOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1588"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1589"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1590"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1591"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1592"></a><a name="doWriteOffAddrOp"><a href="StgCmmPrim.html#doWriteOffAddrOp"><span class="hs-identifier">doWriteOffAddrOp</span></a></a><span> </span><a name="local-6989586621680977730"><a href="#local-6989586621680977730"><span class="hs-identifier">maybe_pre_write_cast</span></a></a><span> </span><a name="local-6989586621680977731"><a href="#local-6989586621680977731"><span class="hs-identifier">idx_ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977732"><a href="#local-6989586621680977732"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977733"><a href="#local-6989586621680977733"><span class="hs-identifier">idx</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977734"><a href="#local-6989586621680977734"><span class="hs-identifier">val</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1593"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier hs-var">mkBasicIndexedWrite</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977730"><span class="hs-identifier hs-var">maybe_pre_write_cast</span></a><span> </span><a href="#local-6989586621680977732"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977731"><span class="hs-identifier hs-var">idx_ty</span></a><span> </span><a href="#local-6989586621680977733"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621680977734"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1594"></a><span class="hs-identifier">doWriteOffAddrOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1595"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doWriteOffAddrOp&quot;</span><span>
</span><a name="line-1596"></a><span>
</span><a name="line-1597"></a><span class="hs-identifier">doWriteByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1598"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1599"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span class="hs-special">]</span><span>
</span><a name="line-1600"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1601"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1602"></a><a name="doWriteByteArrayOp"><a href="StgCmmPrim.html#doWriteByteArrayOp"><span class="hs-identifier">doWriteByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977735"><a href="#local-6989586621680977735"><span class="hs-identifier">maybe_pre_write_cast</span></a></a><span> </span><a name="local-6989586621680977736"><a href="#local-6989586621680977736"><span class="hs-identifier">idx_ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680977737"><a href="#local-6989586621680977737"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977738"><a href="#local-6989586621680977738"><span class="hs-identifier">idx</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977739"><a href="#local-6989586621680977739"><span class="hs-identifier">val</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1603"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977740"><a href="#local-6989586621680977740"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1604"></a><span>        </span><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier hs-var">mkBasicIndexedWrite</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977740"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977735"><span class="hs-identifier hs-var">maybe_pre_write_cast</span></a><span> </span><a href="#local-6989586621680977737"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977736"><span class="hs-identifier hs-var">idx_ty</span></a><span> </span><a href="#local-6989586621680977738"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621680977739"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1605"></a><span class="hs-identifier">doWriteByteArrayOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1606"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doWriteByteArrayOp&quot;</span><span>
</span><a name="line-1607"></a><span>
</span><a name="line-1608"></a><span class="hs-identifier">doWritePtrArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1609"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1610"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1611"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1612"></a><a name="doWritePtrArrayOp"><a href="StgCmmPrim.html#doWritePtrArrayOp"><span class="hs-identifier">doWritePtrArrayOp</span></a></a><span> </span><a name="local-6989586621680977741"><a href="#local-6989586621680977741"><span class="hs-identifier">addr</span></a></a><span> </span><a name="local-6989586621680977742"><a href="#local-6989586621680977742"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680977743"><a href="#local-6989586621680977743"><span class="hs-identifier">val</span></a></a><span>
</span><a name="line-1613"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977744"><a href="#local-6989586621680977744"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1614"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977745"><a href="#local-6989586621680977745"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977743"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1615"></a><span>       </span><span class="hs-comment">-- This write barrier is to ensure that the heap writes to the object</span><span>
</span><a name="line-1616"></a><span>       </span><span class="hs-comment">-- referred to by val have happened before we write val into the array.</span><span>
</span><a name="line-1617"></a><span>       </span><span class="hs-comment">-- See #12469 for details.</span><span>
</span><a name="line-1618"></a><span>       </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="CmmMachOp.html#MO_WriteBarrier"><span class="hs-identifier hs-var">MO_WriteBarrier</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1619"></a><span>       </span><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier hs-var">mkBasicIndexedWrite</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977741"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977745"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977742"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621680977743"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1620"></a><span>       </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680977741"><span class="hs-identifier hs-var">addr</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1621"></a><span>  </span><span class="hs-comment">-- the write barrier.  We must write a byte into the mark table:</span><span>
</span><a name="line-1622"></a><span>  </span><span class="hs-comment">-- bits8[a + header_size + StgMutArrPtrs_size(a) + x &gt;&gt; N]</span><span>
</span><a name="line-1623"></a><span>       </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkStore"><span class="hs-identifier hs-var">mkStore</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-1624"></a><span>         </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1625"></a><span>          </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977741"><span class="hs-identifier hs-var">addr</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1626"></a><span>                         </span><span class="hs-special">(</span><a href="StgCmmPrim.html#loadArrPtrsSize"><span class="hs-identifier hs-var">loadArrPtrsSize</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977741"><span class="hs-identifier hs-var">addr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span>          </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_wordUShr"><span class="hs-identifier hs-var">mo_wordUShr</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977742"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">,</span><span>
</span><a name="line-1628"></a><span>                                           </span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mUT_ARR_PTRS_CARD_BITS</span><span> </span><a href="#local-6989586621680977744"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier hs-var">W8</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1630"></a><span>
</span><a name="line-1631"></a><span class="hs-identifier">loadArrPtrsSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1632"></a><a name="loadArrPtrsSize"><a href="StgCmmPrim.html#loadArrPtrsSize"><span class="hs-identifier">loadArrPtrsSize</span></a></a><span> </span><a name="local-6989586621680977746"><a href="#local-6989586621680977746"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977747"><a href="#local-6989586621680977747"><span class="hs-identifier">addr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977746"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977747"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977748"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977746"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1633"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621680977748"><a href="#local-6989586621680977748"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680977746"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680977746"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1634"></a><span>
</span><a name="line-1635"></a><span class="hs-identifier">mkBasicIndexedRead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>      </span><span class="hs-comment">-- Initial offset in bytes</span><span>
</span><a name="line-1636"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span> </span><span class="hs-comment">-- Optional result cast</span><span>
</span><a name="line-1637"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>      </span><span class="hs-comment">-- Type of element we are accessing</span><span>
</span><a name="line-1638"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>     </span><span class="hs-comment">-- Destination</span><span>
</span><a name="line-1639"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Base address</span><span>
</span><a name="line-1640"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>      </span><span class="hs-comment">-- Type of element by which we are indexing</span><span>
</span><a name="line-1641"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Index</span><span>
</span><a name="line-1642"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1643"></a><a name="mkBasicIndexedRead"><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier">mkBasicIndexedRead</span></a></a><span> </span><a name="local-6989586621680977749"><a href="#local-6989586621680977749"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621680977750"><a href="#local-6989586621680977750"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977751"><a href="#local-6989586621680977751"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680977752"><a href="#local-6989586621680977752"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977753"><a href="#local-6989586621680977753"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680977754"><a href="#local-6989586621680977754"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1644"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977755"><a href="#local-6989586621680977755"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1645"></a><span>        </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977751"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#cmmLoadIndexOffExpr"><span class="hs-identifier hs-var">cmmLoadIndexOffExpr</span></a><span> </span><a href="#local-6989586621680977755"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977749"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="#local-6989586621680977750"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977752"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977753"><span class="hs-identifier hs-var">idx_ty</span></a><span> </span><a href="#local-6989586621680977754"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">)</span><span>
</span><a name="line-1646"></a><span class="hs-identifier">mkBasicIndexedRead</span><span> </span><a name="local-6989586621680977756"><a href="#local-6989586621680977756"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977757"><a href="#local-6989586621680977757"><span class="hs-identifier">cast</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977758"><a href="#local-6989586621680977758"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977759"><a href="#local-6989586621680977759"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680977760"><a href="#local-6989586621680977760"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977761"><a href="#local-6989586621680977761"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680977762"><a href="#local-6989586621680977762"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1647"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977763"><a href="#local-6989586621680977763"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1648"></a><span>        </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977759"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977757"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-1649"></a><span>                                   </span><a href="StgCmmPrim.html#cmmLoadIndexOffExpr"><span class="hs-identifier hs-var">cmmLoadIndexOffExpr</span></a><span> </span><a href="#local-6989586621680977763"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977756"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="#local-6989586621680977758"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680977760"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977761"><span class="hs-identifier hs-var">idx_ty</span></a><span> </span><a href="#local-6989586621680977762"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1650"></a><span>
</span><a name="line-1651"></a><span class="hs-identifier">mkBasicIndexedWrite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>      </span><span class="hs-comment">-- Initial offset in bytes</span><span>
</span><a name="line-1652"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span> </span><span class="hs-comment">-- Optional value cast</span><span>
</span><a name="line-1653"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Base address</span><span>
</span><a name="line-1654"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>      </span><span class="hs-comment">-- Type of element by which we are indexing</span><span>
</span><a name="line-1655"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Index</span><span>
</span><a name="line-1656"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Value to write</span><span>
</span><a name="line-1657"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1658"></a><a name="mkBasicIndexedWrite"><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier">mkBasicIndexedWrite</span></a></a><span> </span><a name="local-6989586621680977764"><a href="#local-6989586621680977764"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621680977765"><a href="#local-6989586621680977765"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977766"><a href="#local-6989586621680977766"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680977767"><a href="#local-6989586621680977767"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680977768"><a href="#local-6989586621680977768"><span class="hs-identifier">val</span></a></a><span>
</span><a name="line-1659"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977769"><a href="#local-6989586621680977769"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1660"></a><span>        </span><a href="StgCmmMonad.html#emitStore"><span class="hs-identifier hs-var">emitStore</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680977769"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977764"><span class="hs-identifier hs-var">off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680977766"><span class="hs-identifier hs-var">idx_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977765"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977767"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977768"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1661"></a><span class="hs-identifier">mkBasicIndexedWrite</span><span> </span><a name="local-6989586621680977770"><a href="#local-6989586621680977770"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977771"><a href="#local-6989586621680977771"><span class="hs-identifier">cast</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977772"><a href="#local-6989586621680977772"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977773"><a href="#local-6989586621680977773"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680977774"><a href="#local-6989586621680977774"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680977775"><a href="#local-6989586621680977775"><span class="hs-identifier">val</span></a></a><span>
</span><a name="line-1662"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier hs-var">mkBasicIndexedWrite</span></a><span> </span><a href="#local-6989586621680977770"><span class="hs-identifier hs-var">off</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680977772"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977773"><span class="hs-identifier hs-var">idx_ty</span></a><span> </span><a href="#local-6989586621680977774"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977771"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977775"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1663"></a><span>
</span><a name="line-1664"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1665"></a><span class="hs-comment">-- Misc utils</span><span>
</span><a name="line-1666"></a><span>
</span><a name="line-1667"></a><span class="hs-identifier">cmmIndexOffExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-1668"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>  </span><span class="hs-comment">-- Initial offset in bytes</span><span>
</span><a name="line-1669"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span>    </span><span class="hs-comment">-- Width of element by which we are indexing</span><span>
</span><a name="line-1670"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>  </span><span class="hs-comment">-- Base address</span><span>
</span><a name="line-1671"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>  </span><span class="hs-comment">-- Index</span><span>
</span><a name="line-1672"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1673"></a><a name="cmmIndexOffExpr"><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier">cmmIndexOffExpr</span></a></a><span> </span><a name="local-6989586621680977776"><a href="#local-6989586621680977776"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977777"><a href="#local-6989586621680977777"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621680977778"><a href="#local-6989586621680977778"><span class="hs-identifier">width</span></a></a><span> </span><a name="local-6989586621680977779"><a href="#local-6989586621680977779"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977780"><a href="#local-6989586621680977780"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1674"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="CmmUtils.html#cmmIndexExpr"><span class="hs-identifier hs-var">cmmIndexExpr</span></a><span> </span><a href="#local-6989586621680977776"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977778"><span class="hs-identifier hs-var">width</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977776"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977779"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977777"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977780"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1675"></a><span>
</span><a name="line-1676"></a><span class="hs-identifier">cmmLoadIndexOffExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-1677"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>  </span><span class="hs-comment">-- Initial offset in bytes</span><span>
</span><a name="line-1678"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>  </span><span class="hs-comment">-- Type of element we are accessing</span><span>
</span><a name="line-1679"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>  </span><span class="hs-comment">-- Base address</span><span>
</span><a name="line-1680"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>  </span><span class="hs-comment">-- Type of element by which we are indexing</span><span>
</span><a name="line-1681"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>  </span><span class="hs-comment">-- Index</span><span>
</span><a name="line-1682"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1683"></a><a name="cmmLoadIndexOffExpr"><a href="StgCmmPrim.html#cmmLoadIndexOffExpr"><span class="hs-identifier">cmmLoadIndexOffExpr</span></a></a><span> </span><a name="local-6989586621680977781"><a href="#local-6989586621680977781"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977782"><a href="#local-6989586621680977782"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621680977783"><a href="#local-6989586621680977783"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977784"><a href="#local-6989586621680977784"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977785"><a href="#local-6989586621680977785"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680977786"><a href="#local-6989586621680977786"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1684"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680977781"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977782"><span class="hs-identifier hs-var">off</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680977785"><span class="hs-identifier hs-var">idx_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977784"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977786"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977783"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1685"></a><span>
</span><a name="line-1686"></a><span class="hs-identifier">setInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MkGraph.html#CmmAGraph"><span class="hs-identifier hs-type">CmmAGraph</span></a><span>
</span><a name="line-1687"></a><a name="setInfo"><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier">setInfo</span></a></a><span> </span><a name="local-6989586621680977787"><a href="#local-6989586621680977787"><span class="hs-identifier">closure_ptr</span></a></a><span> </span><a name="local-6989586621680977788"><a href="#local-6989586621680977788"><span class="hs-identifier">info_ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkGraph.html#mkStore"><span class="hs-identifier hs-var">mkStore</span></a><span> </span><a href="#local-6989586621680977787"><span class="hs-identifier hs-var">closure_ptr</span></a><span> </span><a href="#local-6989586621680977788"><span class="hs-identifier hs-var">info_ptr</span></a><span>
</span><a name="line-1688"></a><span>
</span><a name="line-1689"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-1690"></a><span class="hs-comment">-- Helpers for translating vector primops.</span><span>
</span><a name="line-1691"></a><span>
</span><a name="line-1692"></a><span class="hs-identifier">vecVmmType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Length</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1693"></a><a name="vecVmmType"><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier">vecVmmType</span></a></a><span> </span><a name="local-6989586621680977789"><a href="#local-6989586621680977789"><span class="hs-identifier">pocat</span></a></a><span> </span><a name="local-6989586621680977790"><a href="#local-6989586621680977790"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977791"><a href="#local-6989586621680977791"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">vec</span><span> </span><a href="#local-6989586621680977790"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier hs-var">vecCmmCat</span></a><span> </span><a href="#local-6989586621680977789"><span class="hs-identifier hs-var">pocat</span></a><span> </span><a href="#local-6989586621680977791"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1694"></a><span>
</span><a name="line-1695"></a><span class="hs-identifier">vecCmmCat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>
</span><a name="line-1696"></a><a name="vecCmmCat"><a href="StgCmmPrim.html#vecCmmCat"><span class="hs-identifier">vecCmmCat</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmBits</span><span>
</span><a name="line-1697"></a><span class="hs-identifier">vecCmmCat</span><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmBits</span><span>
</span><a name="line-1698"></a><span class="hs-identifier">vecCmmCat</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cmmFloat</span><span>
</span><a name="line-1699"></a><span>
</span><a name="line-1700"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1701"></a><a name="vecElemInjectCast"><a href="StgCmmPrim.html#vecElemInjectCast"><span class="hs-identifier">vecElemInjectCast</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1702"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977792"><a href="#local-6989586621680977792"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W8</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span>  </span><a href="#local-6989586621680977792"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1703"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977793"><a href="#local-6989586621680977793"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977793"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1704"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977794"><a href="#local-6989586621680977794"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977794"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1705"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1706"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977795"><a href="#local-6989586621680977795"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W8</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo8"><span class="hs-identifier hs-var">mo_WordTo8</span></a><span>  </span><a href="#local-6989586621680977795"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1707"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977796"><a href="#local-6989586621680977796"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo16"><span class="hs-identifier hs-var">mo_WordTo16</span></a><span> </span><a href="#local-6989586621680977796"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1708"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><a name="local-6989586621680977797"><a href="#local-6989586621680977797"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_WordTo32"><span class="hs-identifier hs-var">mo_WordTo32</span></a><span> </span><a href="#local-6989586621680977797"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1709"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1710"></a><span class="hs-identifier">vecElemInjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>        </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1711"></a><span>
</span><a name="line-1712"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>
</span><a name="line-1713"></a><a name="vecElemProjectCast"><a href="StgCmmPrim.html#vecElemProjectCast"><span class="hs-identifier">vecElemProjectCast</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1714"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977798"><a href="#local-6989586621680977798"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W8</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_8ToWord"><span class="hs-identifier hs-var">mo_s_8ToWord</span></a><span>  </span><a href="#local-6989586621680977798"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1715"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977799"><a href="#local-6989586621680977799"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_16ToWord"><span class="hs-identifier hs-var">mo_s_16ToWord</span></a><span> </span><a href="#local-6989586621680977799"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1716"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977800"><a href="#local-6989586621680977800"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680977800"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1717"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">IntVec</span><span>   </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1718"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977801"><a href="#local-6989586621680977801"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W8</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_8ToWord"><span class="hs-identifier hs-var">mo_u_8ToWord</span></a><span>  </span><a href="#local-6989586621680977801"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1719"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977802"><a href="#local-6989586621680977802"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W16</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_16ToWord"><span class="hs-identifier hs-var">mo_u_16ToWord</span></a><span> </span><a href="#local-6989586621680977802"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1720"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><a name="local-6989586621680977803"><a href="#local-6989586621680977803"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_u_32ToWord"><span class="hs-identifier hs-var">mo_u_32ToWord</span></a><span> </span><a href="#local-6989586621680977803"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1721"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier hs-var">WordVec</span><span>  </span><span class="hs-identifier hs-var">W64</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1722"></a><span class="hs-identifier">vecElemProjectCast</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>        </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1723"></a><span>
</span><a name="line-1724"></a><span class="hs-comment">-- Check to make sure that we can generate code for the specified vector type</span><span>
</span><a name="line-1725"></a><span class="hs-comment">-- given the current set of dynamic flags.</span><span>
</span><a name="line-1726"></a><span class="hs-identifier">checkVecCompatibility</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Length</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1727"></a><a name="checkVecCompatibility"><a href="StgCmmPrim.html#checkVecCompatibility"><span class="hs-identifier">checkVecCompatibility</span></a></a><span> </span><a name="local-6989586621680977804"><a href="#local-6989586621680977804"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680977805"><a href="#local-6989586621680977805"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621680977806"><a href="#local-6989586621680977806"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621680977807"><a href="#local-6989586621680977807"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1728"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hscTarget</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">HscLlvm</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1729"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;SIMD vector instructions require the LLVM back-end.&quot;</span><span>
</span><a name="line-1730"></a><span>                         </span><span class="hs-special">,</span><span class="hs-string">&quot;Please use -fllvm.&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1731"></a><span>    </span><a href="#local-6989586621680977808"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621680977809"><span class="hs-identifier hs-var">vecWidth</span></a><span> </span><a href="#local-6989586621680977805"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977806"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621680977807"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-1732"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1733"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PrimOpVecCat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Length</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1734"></a><span>    </span><a name="local-6989586621680977808"><a href="#local-6989586621680977808"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-identifier hs-var">W128</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-identifier hs-var">W32</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSseEnabled</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1735"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;128-bit wide single-precision floating point &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1736"></a><span>                </span><span class="hs-string">&quot;SIMD vector instructions require at least -msse.&quot;</span><span>
</span><a name="line-1737"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier hs-var">W128</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSse2Enabled</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1738"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;128-bit wide integer and double precision &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1739"></a><span>                </span><span class="hs-string">&quot;SIMD vector instructions require at least -msse2.&quot;</span><span>
</span><a name="line-1740"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier hs-var">W256</span><span> </span><span class="hs-identifier hs-var">FloatVec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAvxEnabled</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1741"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;256-bit wide floating point &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1742"></a><span>                </span><span class="hs-string">&quot;SIMD vector instructions require at least -mavx.&quot;</span><span>
</span><a name="line-1743"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier hs-var">W256</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAvx2Enabled</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1744"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;256-bit wide integer &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1745"></a><span>                </span><span class="hs-string">&quot;SIMD vector instructions require at least -mavx2.&quot;</span><span>
</span><a name="line-1746"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier hs-var">W512</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAvx512fEnabled</span><span> </span><a href="#local-6989586621680977804"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1747"></a><span>        </span><span class="hs-identifier hs-var">sorry</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;512-bit wide &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1748"></a><span>                </span><span class="hs-string">&quot;SIMD vector instructions require -mavx512f.&quot;</span><span>
</span><a name="line-1749"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span>    </span><a name="local-6989586621680977809"><a href="#local-6989586621680977809"><span class="hs-identifier">vecWidth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#vecVmmType"><span class="hs-identifier hs-var">vecVmmType</span></a><span> </span><a href="#local-6989586621680977805"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621680977806"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621680977807"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1752"></a><span>
</span><a name="line-1753"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-1754"></a><span class="hs-comment">-- Helpers for translating vector packing and unpacking.</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span class="hs-identifier">doVecPackOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>  </span><span class="hs-comment">-- Cast from element to vector component</span><span>
</span><a name="line-1757"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>       </span><span class="hs-comment">-- Type of vector</span><span>
</span><a name="line-1758"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- Initial vector</span><span>
</span><a name="line-1759"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- Elements</span><span>
</span><a name="line-1760"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span>     </span><span class="hs-comment">-- Destination for result</span><span>
</span><a name="line-1761"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1762"></a><a name="doVecPackOp"><a href="StgCmmPrim.html#doVecPackOp"><span class="hs-identifier">doVecPackOp</span></a></a><span> </span><a name="local-6989586621680977810"><a href="#local-6989586621680977810"><span class="hs-identifier">maybe_pre_write_cast</span></a></a><span> </span><a name="local-6989586621680977811"><a href="#local-6989586621680977811"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977812"><a href="#local-6989586621680977812"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621680977813"><a href="#local-6989586621680977813"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621680977814"><a href="#local-6989586621680977814"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1763"></a><span>    </span><a name="local-6989586621680977828"><a href="#local-6989586621680977828"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977811"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1764"></a><span>    </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977828"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977812"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1765"></a><span>    </span><a href="#local-6989586621680977815"><span class="hs-identifier hs-var">vecPack</span></a><span> </span><a href="#local-6989586621680977828"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977813"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1766"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1767"></a><span>    </span><span class="hs-identifier">vecPack</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1768"></a><span>    </span><a name="local-6989586621680977815"><a href="#local-6989586621680977815"><span class="hs-identifier">vecPack</span></a></a><span> </span><a name="local-6989586621680977819"><a href="#local-6989586621680977819"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1769"></a><span>        </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977814"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977819"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1770"></a><span>
</span><a name="line-1771"></a><span>    </span><span class="hs-identifier">vecPack</span><span> </span><a name="local-6989586621680977820"><a href="#local-6989586621680977820"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680977821"><a href="#local-6989586621680977821"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680977822"><a href="#local-6989586621680977822"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977823"><a href="#local-6989586621680977823"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1772"></a><span>        </span><a name="local-6989586621680977825"><a href="#local-6989586621680977825"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><a href="#local-6989586621680977811"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1773"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isFloatType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977811"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1774"></a><span>          </span><span class="hs-keyword">then</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977825"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Insert"><span class="hs-identifier hs-var">MO_VF_Insert</span></a><span> </span><a href="#local-6989586621680977817"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977818"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span>
</span><a name="line-1775"></a><span>                                                    </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977820"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977816"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621680977821"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977824"><span class="hs-identifier hs-var">iLit</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1776"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977825"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Insert"><span class="hs-identifier hs-var">MO_V_Insert</span></a><span> </span><a href="#local-6989586621680977817"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977818"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span>
</span><a name="line-1777"></a><span>                                                    </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977820"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977816"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621680977821"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977824"><span class="hs-identifier hs-var">iLit</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><span>        </span><a href="#local-6989586621680977815"><span class="hs-identifier hs-var">vecPack</span></a><span> </span><a href="#local-6989586621680977825"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977822"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977823"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1779"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1780"></a><span>        </span><span class="hs-comment">-- vector indices are always 32-bits</span><span>
</span><a name="line-1781"></a><span>        </span><a name="local-6989586621680977824"><a href="#local-6989586621680977824"><span class="hs-identifier">iLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621680977823"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1782"></a><span>
</span><a name="line-1783"></a><span>    </span><span class="hs-identifier">cast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1784"></a><span>    </span><a name="local-6989586621680977816"><a href="#local-6989586621680977816"><span class="hs-identifier">cast</span></a></a><span> </span><a name="local-6989586621680977826"><a href="#local-6989586621680977826"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977810"><span class="hs-identifier hs-var">maybe_pre_write_cast</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1785"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680977826"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1786"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977827"><a href="#local-6989586621680977827"><span class="hs-identifier">cast</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977827"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977826"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span>
</span><a name="line-1787"></a><span>
</span><a name="line-1788"></a><span>    </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Length</span><span>
</span><a name="line-1789"></a><span>    </span><a name="local-6989586621680977817"><a href="#local-6989586621680977817"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">vecLength</span><span> </span><a href="#local-6989586621680977811"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1790"></a><span>
</span><a name="line-1791"></a><span>    </span><span class="hs-identifier">wid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-1792"></a><span>    </span><a name="local-6989586621680977818"><a href="#local-6989586621680977818"><span class="hs-identifier">wid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977811"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1793"></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">doVecUnpackOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>  </span><span class="hs-comment">-- Cast from vector component to element result</span><span>
</span><a name="line-1795"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>       </span><span class="hs-comment">-- Type of vector</span><span>
</span><a name="line-1796"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- Vector</span><span>
</span><a name="line-1797"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Element results</span><span>
</span><a name="line-1798"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1799"></a><a name="doVecUnpackOp"><a href="StgCmmPrim.html#doVecUnpackOp"><span class="hs-identifier">doVecUnpackOp</span></a></a><span> </span><a name="local-6989586621680977829"><a href="#local-6989586621680977829"><span class="hs-identifier">maybe_post_read_cast</span></a></a><span> </span><a name="local-6989586621680977830"><a href="#local-6989586621680977830"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977831"><a href="#local-6989586621680977831"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621680977832"><a href="#local-6989586621680977832"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1800"></a><span>    </span><a href="#local-6989586621680977833"><span class="hs-identifier hs-var">vecUnpack</span></a><span> </span><a href="#local-6989586621680977832"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1801"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1802"></a><span>    </span><span class="hs-identifier">vecUnpack</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1803"></a><span>    </span><a name="local-6989586621680977833"><a href="#local-6989586621680977833"><span class="hs-identifier">vecUnpack</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1804"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1805"></a><span>
</span><a name="line-1806"></a><span>    </span><span class="hs-identifier">vecUnpack</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680977837"><a href="#local-6989586621680977837"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680977838"><a href="#local-6989586621680977838"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680977839"><a href="#local-6989586621680977839"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1807"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isFloatType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977830"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1808"></a><span>          </span><span class="hs-keyword">then</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977837"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977834"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Extract"><span class="hs-identifier hs-var">MO_VF_Extract</span></a><span> </span><a href="#local-6989586621680977835"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977836"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span>
</span><a name="line-1809"></a><span>                                             </span><span class="hs-special">[</span><a href="#local-6989586621680977831"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977840"><span class="hs-identifier hs-var">iLit</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1810"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977837"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977834"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Extract"><span class="hs-identifier hs-var">MO_V_Extract</span></a><span> </span><a href="#local-6989586621680977835"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977836"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span>
</span><a name="line-1811"></a><span>                                             </span><span class="hs-special">[</span><a href="#local-6989586621680977831"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977840"><span class="hs-identifier hs-var">iLit</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1812"></a><span>        </span><a href="#local-6989586621680977833"><span class="hs-identifier hs-var">vecUnpack</span></a><span> </span><a href="#local-6989586621680977838"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977839"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1813"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1814"></a><span>        </span><span class="hs-comment">-- vector indices are always 32-bits</span><span>
</span><a name="line-1815"></a><span>        </span><a name="local-6989586621680977840"><a href="#local-6989586621680977840"><span class="hs-identifier">iLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621680977839"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span>
</span><a name="line-1816"></a><span>
</span><a name="line-1817"></a><span>    </span><span class="hs-identifier">cast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1818"></a><span>    </span><a name="local-6989586621680977834"><a href="#local-6989586621680977834"><span class="hs-identifier">cast</span></a></a><span> </span><a name="local-6989586621680977841"><a href="#local-6989586621680977841"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977829"><span class="hs-identifier hs-var">maybe_post_read_cast</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1819"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680977841"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1820"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977842"><a href="#local-6989586621680977842"><span class="hs-identifier">cast</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977842"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977841"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span>
</span><a name="line-1821"></a><span>
</span><a name="line-1822"></a><span>    </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Length</span><span>
</span><a name="line-1823"></a><span>    </span><a name="local-6989586621680977835"><a href="#local-6989586621680977835"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">vecLength</span><span> </span><a href="#local-6989586621680977830"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1824"></a><span>
</span><a name="line-1825"></a><span>    </span><span class="hs-identifier">wid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-1826"></a><span>    </span><a name="local-6989586621680977836"><a href="#local-6989586621680977836"><span class="hs-identifier">wid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977830"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1827"></a><span>
</span><a name="line-1828"></a><span class="hs-identifier">doVecInsertOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CmmMachOp.html#MachOp"><span class="hs-identifier hs-type">MachOp</span></a><span>  </span><span class="hs-comment">-- Cast from element to vector component</span><span>
</span><a name="line-1829"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>       </span><span class="hs-comment">-- Vector type</span><span>
</span><a name="line-1830"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- Source vector</span><span>
</span><a name="line-1831"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- Element</span><span>
</span><a name="line-1832"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- Index at which to insert element</span><span>
</span><a name="line-1833"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span>     </span><span class="hs-comment">-- Destination for result</span><span>
</span><a name="line-1834"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1835"></a><a name="doVecInsertOp"><a href="StgCmmPrim.html#doVecInsertOp"><span class="hs-identifier">doVecInsertOp</span></a></a><span> </span><a name="local-6989586621680977843"><a href="#local-6989586621680977843"><span class="hs-identifier">maybe_pre_write_cast</span></a></a><span> </span><a name="local-6989586621680977844"><a href="#local-6989586621680977844"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680977845"><a href="#local-6989586621680977845"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977846"><a href="#local-6989586621680977846"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621680977847"><a href="#local-6989586621680977847"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680977848"><a href="#local-6989586621680977848"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1836"></a><span>    </span><a name="local-6989586621680977854"><a href="#local-6989586621680977854"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1837"></a><span>    </span><span class="hs-comment">-- vector indices are always 32-bits</span><span>
</span><a name="line-1838"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">idx'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1839"></a><span>        </span><a name="local-6989586621680977855"><a href="#local-6989586621680977855"><span class="hs-identifier">idx'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_SS_Conv"><span class="hs-identifier hs-var">MO_SS_Conv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977854"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">W32</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977847"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">]</span><span>
</span><a name="line-1840"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isFloatType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977844"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1841"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977848"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_VF_Insert"><span class="hs-identifier hs-var">MO_VF_Insert</span></a><span> </span><a href="#local-6989586621680977850"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977851"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977845"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977849"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621680977846"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977855"><span class="hs-identifier hs-var">idx'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1842"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="StgCmmMonad.html#emitAssign"><span class="hs-identifier hs-var">emitAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977848"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_V_Insert"><span class="hs-identifier hs-var">MO_V_Insert</span></a><span> </span><a href="#local-6989586621680977850"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621680977851"><span class="hs-identifier hs-var">wid</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977845"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977849"><span class="hs-identifier hs-var">cast</span></a><span> </span><a href="#local-6989586621680977846"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680977855"><span class="hs-identifier hs-var">idx'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1843"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1844"></a><span>    </span><span class="hs-identifier">cast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1845"></a><span>    </span><a name="local-6989586621680977849"><a href="#local-6989586621680977849"><span class="hs-identifier">cast</span></a></a><span> </span><a name="local-6989586621680977852"><a href="#local-6989586621680977852"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680977843"><span class="hs-identifier hs-var">maybe_pre_write_cast</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1846"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680977852"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-1847"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621680977853"><a href="#local-6989586621680977853"><span class="hs-identifier">cast</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span> </span><a href="#local-6989586621680977853"><span class="hs-identifier hs-var">cast</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680977852"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span>
</span><a name="line-1848"></a><span>
</span><a name="line-1849"></a><span>    </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Length</span><span>
</span><a name="line-1850"></a><span>    </span><a name="local-6989586621680977850"><a href="#local-6989586621680977850"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">vecLength</span><span> </span><a href="#local-6989586621680977844"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1851"></a><span>
</span><a name="line-1852"></a><span>    </span><span class="hs-identifier">wid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Width</span><span>
</span><a name="line-1853"></a><span>    </span><a name="local-6989586621680977851"><a href="#local-6989586621680977851"><span class="hs-identifier">wid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">vecElemType</span><span> </span><a href="#local-6989586621680977844"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1854"></a><span>
</span><a name="line-1855"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-1856"></a><span class="hs-comment">-- Helpers for translating prefetching.</span><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span>
</span><a name="line-1859"></a><span class="hs-comment">-- | Translate byte array prefetch operations into proper primcalls.</span><span>
</span><a name="line-1860"></a><span class="hs-identifier">doPrefetchByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1861"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1862"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1863"></a><a name="doPrefetchByteArrayOp"><a href="StgCmmPrim.html#doPrefetchByteArrayOp"><span class="hs-identifier">doPrefetchByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977856"><a href="#local-6989586621680977856"><span class="hs-identifier">locality</span></a></a><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977857"><a href="#local-6989586621680977857"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977858"><a href="#local-6989586621680977858"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1864"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977859"><a href="#local-6989586621680977859"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1865"></a><span>        </span><a href="StgCmmPrim.html#mkBasicPrefetch"><span class="hs-identifier hs-var">mkBasicPrefetch</span></a><span> </span><a href="#local-6989586621680977856"><span class="hs-identifier hs-var">locality</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977859"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621680977857"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977858"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1866"></a><span class="hs-identifier">doPrefetchByteArrayOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1867"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doPrefetchByteArrayOp&quot;</span><span>
</span><a name="line-1868"></a><span>
</span><a name="line-1869"></a><span class="hs-comment">-- | Translate mutable byte array prefetch operations into proper primcalls.</span><span>
</span><a name="line-1870"></a><span class="hs-identifier">doPrefetchMutableByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1871"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1872"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1873"></a><a name="doPrefetchMutableByteArrayOp"><a href="StgCmmPrim.html#doPrefetchMutableByteArrayOp"><span class="hs-identifier">doPrefetchMutableByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977860"><a href="#local-6989586621680977860"><span class="hs-identifier">locality</span></a></a><span>  </span><span class="hs-special">[</span><a name="local-6989586621680977861"><a href="#local-6989586621680977861"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977862"><a href="#local-6989586621680977862"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1874"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977863"><a href="#local-6989586621680977863"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1875"></a><span>        </span><a href="StgCmmPrim.html#mkBasicPrefetch"><span class="hs-identifier hs-var">mkBasicPrefetch</span></a><span> </span><a href="#local-6989586621680977860"><span class="hs-identifier hs-var">locality</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977863"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621680977861"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977862"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1876"></a><span class="hs-identifier">doPrefetchMutableByteArrayOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1877"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doPrefetchByteArrayOp&quot;</span><span>
</span><a name="line-1878"></a><span>
</span><a name="line-1879"></a><span class="hs-comment">-- | Translate address prefetch operations into proper primcalls.</span><span>
</span><a name="line-1880"></a><span class="hs-identifier">doPrefetchAddrOp</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1881"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1882"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1883"></a><a name="doPrefetchAddrOp"><a href="StgCmmPrim.html#doPrefetchAddrOp"><span class="hs-identifier">doPrefetchAddrOp</span></a></a><span> </span><a name="local-6989586621680977864"><a href="#local-6989586621680977864"><span class="hs-identifier">locality</span></a></a><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977865"><a href="#local-6989586621680977865"><span class="hs-identifier">addr</span></a></a><span class="hs-special">,</span><a name="local-6989586621680977866"><a href="#local-6989586621680977866"><span class="hs-identifier">idx</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1884"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#mkBasicPrefetch"><span class="hs-identifier hs-var">mkBasicPrefetch</span></a><span> </span><a href="#local-6989586621680977864"><span class="hs-identifier hs-var">locality</span></a><span> </span><span class="hs-number">0</span><span>  </span><a href="#local-6989586621680977865"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680977866"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-1885"></a><span class="hs-identifier">doPrefetchAddrOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1886"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doPrefetchAddrOp&quot;</span><span>
</span><a name="line-1887"></a><span>
</span><a name="line-1888"></a><span class="hs-comment">-- | Translate value prefetch operations into proper primcalls.</span><span>
</span><a name="line-1889"></a><span class="hs-identifier">doPrefetchValueOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1890"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1891"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1892"></a><a name="doPrefetchValueOp"><a href="StgCmmPrim.html#doPrefetchValueOp"><span class="hs-identifier">doPrefetchValueOp</span></a></a><span>  </span><a name="local-6989586621680977867"><a href="#local-6989586621680977867"><span class="hs-identifier">locality</span></a></a><span>   </span><span class="hs-special">[</span><a name="local-6989586621680977868"><a href="#local-6989586621680977868"><span class="hs-identifier">addr</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1893"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977869"><a href="#local-6989586621680977869"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1894"></a><span>        </span><a href="StgCmmPrim.html#mkBasicPrefetch"><span class="hs-identifier hs-var">mkBasicPrefetch</span></a><span> </span><a href="#local-6989586621680977867"><span class="hs-identifier hs-var">locality</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621680977868"><span class="hs-identifier hs-var">addr</span></a><span>  </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wordWidth</span><span> </span><a href="#local-6989586621680977869"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1895"></a><span class="hs-identifier">doPrefetchValueOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1896"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;StgCmmPrim: doPrefetchValueOp&quot;</span><span>
</span><a name="line-1897"></a><span>
</span><a name="line-1898"></a><span class="hs-comment">-- | helper to generate prefetch primcalls</span><span>
</span><a name="line-1899"></a><span class="hs-identifier">mkBasicPrefetch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- Locality level 0-3</span><span>
</span><a name="line-1900"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>      </span><span class="hs-comment">-- Initial offset in bytes</span><span>
</span><a name="line-1901"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Base address</span><span>
</span><a name="line-1902"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>      </span><span class="hs-comment">-- Index</span><span>
</span><a name="line-1903"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1904"></a><a name="mkBasicPrefetch"><a href="StgCmmPrim.html#mkBasicPrefetch"><span class="hs-identifier">mkBasicPrefetch</span></a></a><span> </span><a name="local-6989586621680977870"><a href="#local-6989586621680977870"><span class="hs-identifier">locality</span></a></a><span> </span><a name="local-6989586621680977871"><a href="#local-6989586621680977871"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621680977872"><a href="#local-6989586621680977872"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621680977873"><a href="#local-6989586621680977873"><span class="hs-identifier">idx</span></a></a><span>
</span><a name="line-1905"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977874"><a href="#local-6989586621680977874"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1906"></a><span>        </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Prefetch_Data"><span class="hs-identifier hs-var">MO_Prefetch_Data</span></a><span> </span><a href="#local-6989586621680977870"><span class="hs-identifier hs-var">locality</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="CmmUtils.html#cmmIndexExpr"><span class="hs-identifier hs-var">cmmIndexExpr</span></a><span> </span><a href="#local-6989586621680977874"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-identifier hs-var">W8</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977874"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977872"><span class="hs-identifier hs-var">base</span></a><span> </span><a href="#local-6989586621680977871"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977873"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">]</span><span>
</span><a name="line-1907"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1910"></a><span class="hs-comment">-- Allocating byte arrays</span><span>
</span><a name="line-1911"></a><span>
</span><a name="line-1912"></a><span class="hs-comment">-- | Takes a register to return the newly allocated array in and the</span><span>
</span><a name="line-1913"></a><span class="hs-comment">-- size of the new array in bytes. Allocates a new</span><span>
</span><a name="line-1914"></a><span class="hs-comment">-- 'MutableByteArray#'.</span><span>
</span><a name="line-1915"></a><span class="hs-identifier">doNewByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1916"></a><a name="doNewByteArrayOp"><a href="StgCmmPrim.html#doNewByteArrayOp"><span class="hs-identifier">doNewByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977875"><a href="#local-6989586621680977875"><span class="hs-identifier">res_r</span></a></a><span> </span><a name="local-6989586621680977876"><a href="#local-6989586621680977876"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1917"></a><span>    </span><a name="local-6989586621680977877"><a href="#local-6989586621680977877"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1918"></a><span>
</span><a name="line-1919"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977878"><a href="#local-6989586621680977878"><span class="hs-identifier">info_ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmUtils.html#mkLblExpr"><span class="hs-identifier hs-var">mkLblExpr</span></a><span> </span><a href="CLabel.html#mkArrWords_infoLabel"><span class="hs-identifier hs-var">mkArrWords_infoLabel</span></a><span>
</span><a name="line-1920"></a><span>        </span><a name="local-6989586621680977879"><a href="#local-6989586621680977879"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#arrWordsRep"><span class="hs-identifier hs-var">arrWordsRep</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977876"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1921"></a><span>
</span><a name="line-1922"></a><span>    </span><a href="StgCmmTicky.html#tickyAllocPrim"><span class="hs-identifier hs-var">tickyAllocPrim</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1923"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSize"><span class="hs-identifier hs-var">nonHdrSize</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977879"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1924"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroExpr"><span class="hs-identifier hs-var">zeroExpr</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1925"></a><span>
</span><a name="line-1926"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977880"><a href="#local-6989586621680977880"><span class="hs-identifier">hdr_size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1927"></a><span>
</span><a name="line-1928"></a><span>    </span><a name="local-6989586621680977881"><a href="#local-6989586621680977881"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmHeap.html#allocHeapClosure"><span class="hs-identifier hs-var">allocHeapClosure</span></a><span> </span><a href="#local-6989586621680977879"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977878"><span class="hs-identifier hs-var">info_ptr</span></a><span> </span><a href="CmmUtils.html#cccsExpr"><span class="hs-identifier hs-var">cccsExpr</span></a><span>
</span><a name="line-1929"></a><span>                     </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977876"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span>
</span><a name="line-1930"></a><span>                        </span><a href="#local-6989586621680977880"><span class="hs-identifier hs-var">hdr_size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgArrBytes_bytes</span><span> </span><a href="#local-6989586621680977877"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-1931"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977875"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977881"><span class="hs-identifier hs-var">base</span></a><span>
</span><a name="line-1934"></a><span>
</span><a name="line-1935"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1936"></a><span class="hs-comment">-- Comparing byte arrays</span><span>
</span><a name="line-1937"></a><span>
</span><a name="line-1938"></a><span class="hs-identifier">doCompareByteArraysOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1939"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1940"></a><a name="doCompareByteArraysOp"><a href="StgCmmPrim.html#doCompareByteArraysOp"><span class="hs-identifier">doCompareByteArraysOp</span></a></a><span> </span><a name="local-6989586621680977882"><a href="#local-6989586621680977882"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680977883"><a href="#local-6989586621680977883"><span class="hs-identifier">ba1</span></a></a><span> </span><a name="local-6989586621680977884"><a href="#local-6989586621680977884"><span class="hs-identifier">ba1_off</span></a></a><span> </span><a name="local-6989586621680977885"><a href="#local-6989586621680977885"><span class="hs-identifier">ba2</span></a></a><span> </span><a name="local-6989586621680977886"><a href="#local-6989586621680977886"><span class="hs-identifier">ba2_off</span></a></a><span> </span><a name="local-6989586621680977887"><a href="#local-6989586621680977887"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1941"></a><span>    </span><a name="local-6989586621680977888"><a href="#local-6989586621680977888"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-1942"></a><span>    </span><a name="local-6989586621680977889"><a href="#local-6989586621680977889"><span class="hs-identifier">ba1_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977883"><span class="hs-identifier hs-var">ba1</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977884"><span class="hs-identifier hs-var">ba1_off</span></a><span>
</span><a name="line-1943"></a><span>    </span><a name="local-6989586621680977890"><a href="#local-6989586621680977890"><span class="hs-identifier">ba2_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977885"><span class="hs-identifier hs-var">ba2</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977886"><span class="hs-identifier hs-var">ba2_off</span></a><span>
</span><a name="line-1944"></a><span>
</span><a name="line-1945"></a><span>    </span><span class="hs-comment">-- short-cut in case of equal pointers avoiding a costly</span><span>
</span><a name="line-1946"></a><span>    </span><span class="hs-comment">-- subroutine call to the memcmp(3) routine; the Cmm logic below</span><span>
</span><a name="line-1947"></a><span>    </span><span class="hs-comment">-- results in assembly code being generated for</span><span>
</span><a name="line-1948"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1949"></a><span>    </span><span class="hs-comment">--   cmpPrefix10 :: ByteArray# -&gt; ByteArray# -&gt; Int#</span><span>
</span><a name="line-1950"></a><span>    </span><span class="hs-comment">--   cmpPrefix10 ba1 ba2 = compareByteArrays# ba1 0# ba2 0# 10#</span><span>
</span><a name="line-1951"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1952"></a><span>    </span><span class="hs-comment">-- that looks like</span><span>
</span><a name="line-1953"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1954"></a><span>    </span><span class="hs-comment">--          leaq 16(%r14),%rax</span><span>
</span><a name="line-1955"></a><span>    </span><span class="hs-comment">--          leaq 16(%rsi),%rbx</span><span>
</span><a name="line-1956"></a><span>    </span><span class="hs-comment">--          xorl %ecx,%ecx</span><span>
</span><a name="line-1957"></a><span>    </span><span class="hs-comment">--          cmpq %rbx,%rax</span><span>
</span><a name="line-1958"></a><span>    </span><span class="hs-comment">--          je l_ptr_eq</span><span>
</span><a name="line-1959"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1960"></a><span>    </span><span class="hs-comment">--          ; NB: the common case (unequal pointers) falls-through</span><span>
</span><a name="line-1961"></a><span>    </span><span class="hs-comment">--          ; the conditional jump, and therefore matches the</span><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-comment">--          ; usual static branch prediction convention of modern cpus</span><span>
</span><a name="line-1963"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1964"></a><span>    </span><span class="hs-comment">--          subq $8,%rsp</span><span>
</span><a name="line-1965"></a><span>    </span><span class="hs-comment">--          movq %rbx,%rsi</span><span>
</span><a name="line-1966"></a><span>    </span><span class="hs-comment">--          movq %rax,%rdi</span><span>
</span><a name="line-1967"></a><span>    </span><span class="hs-comment">--          movl $10,%edx</span><span>
</span><a name="line-1968"></a><span>    </span><span class="hs-comment">--          xorl %eax,%eax</span><span>
</span><a name="line-1969"></a><span>    </span><span class="hs-comment">--          call memcmp</span><span>
</span><a name="line-1970"></a><span>    </span><span class="hs-comment">--          addq $8,%rsp</span><span>
</span><a name="line-1971"></a><span>    </span><span class="hs-comment">--          movslq %eax,%rax</span><span>
</span><a name="line-1972"></a><span>    </span><span class="hs-comment">--          movq %rax,%rcx</span><span>
</span><a name="line-1973"></a><span>    </span><span class="hs-comment">--  l_ptr_eq:</span><span>
</span><a name="line-1974"></a><span>    </span><span class="hs-comment">--          movq %rcx,%rbx</span><span>
</span><a name="line-1975"></a><span>    </span><span class="hs-comment">--          jmp *(%rbp)</span><span>
</span><a name="line-1976"></a><span>
</span><a name="line-1977"></a><span>    </span><a name="local-6989586621680977891"><a href="#local-6989586621680977891"><span class="hs-identifier">l_ptr_eq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a><span>
</span><a name="line-1978"></a><span>    </span><a name="local-6989586621680977892"><a href="#local-6989586621680977892"><span class="hs-identifier">l_ptr_ne</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a><span>
</span><a name="line-1979"></a><span>
</span><a name="line-1980"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977882"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroExpr"><span class="hs-identifier hs-var">zeroExpr</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1981"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="MkGraph.html#mkCbranch"><span class="hs-identifier hs-var">mkCbranch</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmEqWord"><span class="hs-identifier hs-var">cmmEqWord</span></a><span> </span><a href="#local-6989586621680977888"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977889"><span class="hs-identifier hs-var">ba1_p</span></a><span> </span><a href="#local-6989586621680977890"><span class="hs-identifier hs-var">ba2_p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1982"></a><span>                    </span><a href="#local-6989586621680977891"><span class="hs-identifier hs-var">l_ptr_eq</span></a><span> </span><a href="#local-6989586621680977892"><span class="hs-identifier hs-var">l_ptr_ne</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1983"></a><span>
</span><a name="line-1984"></a><span>    </span><a href="StgCmmMonad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a><span> </span><a href="#local-6989586621680977892"><span class="hs-identifier hs-var">l_ptr_ne</span></a><span>
</span><a name="line-1985"></a><span>    </span><a href="StgCmmPrim.html#emitMemcmpCall"><span class="hs-identifier hs-var">emitMemcmpCall</span></a><span> </span><a href="#local-6989586621680977882"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680977889"><span class="hs-identifier hs-var">ba1_p</span></a><span> </span><a href="#local-6989586621680977890"><span class="hs-identifier hs-var">ba2_p</span></a><span> </span><a href="#local-6989586621680977887"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1986"></a><span>
</span><a name="line-1987"></a><span>    </span><a href="StgCmmMonad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a><span> </span><a href="#local-6989586621680977891"><span class="hs-identifier hs-var">l_ptr_eq</span></a><span>
</span><a name="line-1988"></a><span>
</span><a name="line-1989"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1990"></a><span class="hs-comment">-- Copying byte arrays</span><span>
</span><a name="line-1991"></a><span>
</span><a name="line-1992"></a><span class="hs-comment">-- | Takes a source 'ByteArray#', an offset in the source array, a</span><span>
</span><a name="line-1993"></a><span class="hs-comment">-- destination 'MutableByteArray#', an offset into the destination</span><span>
</span><a name="line-1994"></a><span class="hs-comment">-- array, and the number of bytes to copy.  Copies the given number of</span><span>
</span><a name="line-1995"></a><span class="hs-comment">-- bytes from the source array to the destination array.</span><span>
</span><a name="line-1996"></a><span class="hs-identifier">doCopyByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-1997"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1998"></a><a name="doCopyByteArrayOp"><a href="StgCmmPrim.html#doCopyByteArrayOp"><span class="hs-identifier">doCopyByteArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopyByteArray"><span class="hs-identifier hs-var">emitCopyByteArray</span></a><span> </span><a href="#local-6989586621680977893"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-1999"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2000"></a><span>    </span><span class="hs-comment">-- Copy data (we assume the arrays aren't overlapping since</span><span>
</span><a name="line-2001"></a><span>    </span><span class="hs-comment">-- they're of different types)</span><span>
</span><a name="line-2002"></a><span>    </span><a name="local-6989586621680977893"><a href="#local-6989586621680977893"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977894"><a href="#local-6989586621680977894"><span class="hs-identifier">_src</span></a></a><span> </span><a name="local-6989586621680977895"><a href="#local-6989586621680977895"><span class="hs-identifier">_dst</span></a></a><span> </span><a name="local-6989586621680977896"><a href="#local-6989586621680977896"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977897"><a href="#local-6989586621680977897"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977898"><a href="#local-6989586621680977898"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2003"></a><span>        </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680977896"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977897"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977898"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2004"></a><span>
</span><a name="line-2005"></a><span class="hs-comment">-- | Takes a source 'MutableByteArray#', an offset in the source</span><span>
</span><a name="line-2006"></a><span class="hs-comment">-- array, a destination 'MutableByteArray#', an offset into the</span><span>
</span><a name="line-2007"></a><span class="hs-comment">-- destination array, and the number of bytes to copy.  Copies the</span><span>
</span><a name="line-2008"></a><span class="hs-comment">-- given number of bytes from the source array to the destination</span><span>
</span><a name="line-2009"></a><span class="hs-comment">-- array.</span><span>
</span><a name="line-2010"></a><span class="hs-identifier">doCopyMutableByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2011"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2012"></a><a name="doCopyMutableByteArrayOp"><a href="StgCmmPrim.html#doCopyMutableByteArrayOp"><span class="hs-identifier">doCopyMutableByteArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopyByteArray"><span class="hs-identifier hs-var">emitCopyByteArray</span></a><span> </span><a href="#local-6989586621680977899"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-2013"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2014"></a><span>    </span><span class="hs-comment">-- The only time the memory might overlap is when the two arrays</span><span>
</span><a name="line-2015"></a><span>    </span><span class="hs-comment">-- we were provided are the same array!</span><span>
</span><a name="line-2016"></a><span>    </span><span class="hs-comment">-- TODO: Optimize branch for common case of no aliasing.</span><span>
</span><a name="line-2017"></a><span>    </span><a name="local-6989586621680977899"><a href="#local-6989586621680977899"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977900"><a href="#local-6989586621680977900"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977901"><a href="#local-6989586621680977901"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680977902"><a href="#local-6989586621680977902"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977903"><a href="#local-6989586621680977903"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977904"><a href="#local-6989586621680977904"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2018"></a><span>        </span><a name="local-6989586621680977905"><a href="#local-6989586621680977905"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2019"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680977906"><a href="#local-6989586621680977906"><span class="hs-identifier">moveCall</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977907"><a href="#local-6989586621680977907"><span class="hs-identifier">cpyCall</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmMonad.html#forkAltPair"><span class="hs-identifier hs-var">forkAltPair</span></a><span>
</span><a name="line-2020"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemmoveCall"><span class="hs-identifier hs-var">emitMemmoveCall</span></a><span> </span><a href="#local-6989586621680977902"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977903"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977904"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2021"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span>  </span><a href="#local-6989586621680977902"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977903"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977904"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2022"></a><span>        </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThenElse"><span class="hs-identifier hs-var">mkCmmIfThenElse</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmEqWord"><span class="hs-identifier hs-var">cmmEqWord</span></a><span> </span><a href="#local-6989586621680977905"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977900"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977901"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977906"><span class="hs-identifier hs-var">moveCall</span></a><span> </span><a href="#local-6989586621680977907"><span class="hs-identifier hs-var">cpyCall</span></a><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span class="hs-identifier">emitCopyByteArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2025"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2026"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2027"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2028"></a><a name="emitCopyByteArray"><a href="StgCmmPrim.html#emitCopyByteArray"><span class="hs-identifier">emitCopyByteArray</span></a></a><span> </span><a name="local-6989586621680977908"><a href="#local-6989586621680977908"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977909"><a href="#local-6989586621680977909"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977910"><a href="#local-6989586621680977910"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680977911"><a href="#local-6989586621680977911"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680977912"><a href="#local-6989586621680977912"><span class="hs-identifier">dst_off</span></a></a><span> </span><a name="local-6989586621680977913"><a href="#local-6989586621680977913"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2029"></a><span>    </span><a name="local-6989586621680977914"><a href="#local-6989586621680977914"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2030"></a><span>    </span><a name="local-6989586621680977915"><a href="#local-6989586621680977915"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977911"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977912"><span class="hs-identifier hs-var">dst_off</span></a><span>
</span><a name="line-2031"></a><span>    </span><a name="local-6989586621680977916"><a href="#local-6989586621680977916"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977909"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977914"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977910"><span class="hs-identifier hs-var">src_off</span></a><span>
</span><a name="line-2032"></a><span>    </span><a href="#local-6989586621680977908"><span class="hs-identifier hs-var">copy</span></a><span> </span><a href="#local-6989586621680977909"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977911"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977915"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977916"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977913"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2033"></a><span>
</span><a name="line-2034"></a><span class="hs-comment">-- | Takes a source 'ByteArray#', an offset in the source array, a</span><span>
</span><a name="line-2035"></a><span class="hs-comment">-- destination 'Addr#', and the number of bytes to copy.  Copies the given</span><span>
</span><a name="line-2036"></a><span class="hs-comment">-- number of bytes from the source array to the destination memory region.</span><span>
</span><a name="line-2037"></a><span class="hs-identifier">doCopyByteArrayToAddrOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2038"></a><a name="doCopyByteArrayToAddrOp"><a href="StgCmmPrim.html#doCopyByteArrayToAddrOp"><span class="hs-identifier">doCopyByteArrayToAddrOp</span></a></a><span> </span><a name="local-6989586621680977917"><a href="#local-6989586621680977917"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977918"><a href="#local-6989586621680977918"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680977919"><a href="#local-6989586621680977919"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977920"><a href="#local-6989586621680977920"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2039"></a><span>    </span><span class="hs-comment">-- Use memcpy (we are allowed to assume the arrays aren't overlapping)</span><span>
</span><a name="line-2040"></a><span>    </span><a name="local-6989586621680977921"><a href="#local-6989586621680977921"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2041"></a><span>    </span><a name="local-6989586621680977922"><a href="#local-6989586621680977922"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977921"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977921"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977917"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977921"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977918"><span class="hs-identifier hs-var">src_off</span></a><span>
</span><a name="line-2042"></a><span>    </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680977919"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977922"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977920"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2043"></a><span>
</span><a name="line-2044"></a><span class="hs-comment">-- | Takes a source 'MutableByteArray#', an offset in the source array, a</span><span>
</span><a name="line-2045"></a><span class="hs-comment">-- destination 'Addr#', and the number of bytes to copy.  Copies the given</span><span>
</span><a name="line-2046"></a><span class="hs-comment">-- number of bytes from the source array to the destination memory region.</span><span>
</span><a name="line-2047"></a><span class="hs-identifier">doCopyMutableByteArrayToAddrOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2048"></a><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2049"></a><a name="doCopyMutableByteArrayToAddrOp"><a href="StgCmmPrim.html#doCopyMutableByteArrayToAddrOp"><span class="hs-identifier">doCopyMutableByteArrayToAddrOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#doCopyByteArrayToAddrOp"><span class="hs-identifier hs-var">doCopyByteArrayToAddrOp</span></a><span>
</span><a name="line-2050"></a><span>
</span><a name="line-2051"></a><span class="hs-comment">-- | Takes a source 'Addr#', a destination 'MutableByteArray#', an offset into</span><span>
</span><a name="line-2052"></a><span class="hs-comment">-- the destination array, and the number of bytes to copy.  Copies the given</span><span>
</span><a name="line-2053"></a><span class="hs-comment">-- number of bytes from the source memory region to the destination array.</span><span>
</span><a name="line-2054"></a><span class="hs-identifier">doCopyAddrToByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2055"></a><a name="doCopyAddrToByteArrayOp"><a href="StgCmmPrim.html#doCopyAddrToByteArrayOp"><span class="hs-identifier">doCopyAddrToByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977923"><a href="#local-6989586621680977923"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977924"><a href="#local-6989586621680977924"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680977925"><a href="#local-6989586621680977925"><span class="hs-identifier">dst_off</span></a></a><span> </span><a name="local-6989586621680977926"><a href="#local-6989586621680977926"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2056"></a><span>    </span><span class="hs-comment">-- Use memcpy (we are allowed to assume the arrays aren't overlapping)</span><span>
</span><a name="line-2057"></a><span>    </span><a name="local-6989586621680977927"><a href="#local-6989586621680977927"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2058"></a><span>    </span><a name="local-6989586621680977928"><a href="#local-6989586621680977928"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977927"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977927"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977924"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977927"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977925"><span class="hs-identifier hs-var">dst_off</span></a><span>
</span><a name="line-2059"></a><span>    </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680977928"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977923"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977926"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2060"></a><span>
</span><a name="line-2061"></a><span>
</span><a name="line-2062"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-2063"></a><span class="hs-comment">-- Setting byte arrays</span><span>
</span><a name="line-2064"></a><span>
</span><a name="line-2065"></a><span class="hs-comment">-- | Takes a 'MutableByteArray#', an offset into the array, a length,</span><span>
</span><a name="line-2066"></a><span class="hs-comment">-- and a byte, and sets each of the selected bytes in the array to the</span><span>
</span><a name="line-2067"></a><span class="hs-comment">-- character.</span><span>
</span><a name="line-2068"></a><span class="hs-identifier">doSetByteArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2069"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2070"></a><a name="doSetByteArrayOp"><a href="StgCmmPrim.html#doSetByteArrayOp"><span class="hs-identifier">doSetByteArrayOp</span></a></a><span> </span><a name="local-6989586621680977929"><a href="#local-6989586621680977929"><span class="hs-identifier">ba</span></a></a><span> </span><a name="local-6989586621680977930"><a href="#local-6989586621680977930"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621680977931"><a href="#local-6989586621680977931"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621680977932"><a href="#local-6989586621680977932"><span class="hs-identifier">c</span></a></a><span>
</span><a name="line-2071"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977933"><a href="#local-6989586621680977933"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2072"></a><span>         </span><a name="local-6989586621680977934"><a href="#local-6989586621680977934"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExpr"><span class="hs-identifier hs-var">cmmOffsetExpr</span></a><span> </span><a href="#local-6989586621680977933"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977933"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977929"><span class="hs-identifier hs-var">ba</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680977933"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977930"><span class="hs-identifier hs-var">off</span></a><span>
</span><a name="line-2073"></a><span>         </span><a href="StgCmmPrim.html#emitMemsetCall"><span class="hs-identifier hs-var">emitMemsetCall</span></a><span> </span><a href="#local-6989586621680977934"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680977932"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621680977931"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-2076"></a><span class="hs-comment">-- Allocating arrays</span><span>
</span><a name="line-2077"></a><span>
</span><a name="line-2078"></a><span class="hs-comment">-- | Allocate a new array.</span><span>
</span><a name="line-2079"></a><span class="hs-identifier">doNewArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span>             </span><span class="hs-comment">-- ^ return register</span><span>
</span><a name="line-2080"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#SMRep"><span class="hs-identifier hs-type">SMRep</span></a><span>                 </span><span class="hs-comment">-- ^ representation of the array</span><span>
</span><a name="line-2081"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span>                </span><span class="hs-comment">-- ^ info pointer</span><span>
</span><a name="line-2082"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span class="hs-special">,</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ header payload</span><span>
</span><a name="line-2083"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>               </span><span class="hs-comment">-- ^ array size</span><span>
</span><a name="line-2084"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>               </span><span class="hs-comment">-- ^ initial element</span><span>
</span><a name="line-2085"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2086"></a><a name="doNewArrayOp"><a href="StgCmmPrim.html#doNewArrayOp"><span class="hs-identifier">doNewArrayOp</span></a></a><span> </span><a name="local-6989586621680977935"><a href="#local-6989586621680977935"><span class="hs-identifier">res_r</span></a></a><span> </span><a name="local-6989586621680977936"><a href="#local-6989586621680977936"><span class="hs-identifier">rep</span></a></a><span> </span><a name="local-6989586621680977937"><a href="#local-6989586621680977937"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621680977938"><a href="#local-6989586621680977938"><span class="hs-identifier">payload</span></a></a><span> </span><a name="local-6989586621680977939"><a href="#local-6989586621680977939"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680977940"><a href="#local-6989586621680977940"><span class="hs-identifier">init</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2087"></a><span>    </span><a name="local-6989586621680977941"><a href="#local-6989586621680977941"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2088"></a><span>
</span><a name="line-2089"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977942"><a href="#local-6989586621680977942"><span class="hs-identifier">info_ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmUtils.html#mkLblExpr"><span class="hs-identifier hs-var">mkLblExpr</span></a><span> </span><a href="#local-6989586621680977937"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-2090"></a><span>
</span><a name="line-2091"></a><span>    </span><a href="StgCmmTicky.html#tickyAllocPrim"><span class="hs-identifier hs-var">tickyAllocPrim</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#hdrSize"><span class="hs-identifier hs-var">hdrSize</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977936"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2092"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSize"><span class="hs-identifier hs-var">nonHdrSize</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977936"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2093"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroExpr"><span class="hs-identifier hs-var">zeroExpr</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2094"></a><span>
</span><a name="line-2095"></a><span>    </span><a name="local-6989586621680977943"><a href="#local-6989586621680977943"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmHeap.html#allocHeapClosure"><span class="hs-identifier hs-var">allocHeapClosure</span></a><span> </span><a href="#local-6989586621680977936"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680977942"><span class="hs-identifier hs-var">info_ptr</span></a><span> </span><a href="CmmUtils.html#cccsExpr"><span class="hs-identifier hs-var">cccsExpr</span></a><span> </span><a href="#local-6989586621680977938"><span class="hs-identifier hs-var">payload</span></a><span>
</span><a name="line-2096"></a><span>
</span><a name="line-2097"></a><span>    </span><a name="local-6989586621680977944"><a href="#local-6989586621680977944"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2098"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680977944"><span class="hs-identifier hs-var">arr</span></a><span> </span><a href="#local-6989586621680977943"><span class="hs-identifier hs-var">base</span></a><span>
</span><a name="line-2099"></a><span>
</span><a name="line-2100"></a><span>    </span><span class="hs-comment">-- Initialise all elements of the array</span><span>
</span><a name="line-2101"></a><span>    </span><a name="local-6989586621680977945"><a href="#local-6989586621680977945"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#assignTemp"><span class="hs-identifier hs-var">assignTemp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977944"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SMRep.html#hdrSize"><span class="hs-identifier hs-var">hdrSize</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977936"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span>
</span><a name="line-2102"></a><span>    </span><a name="local-6989586621680977946"><a href="#local-6989586621680977946"><span class="hs-identifier">for</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a><span>
</span><a name="line-2103"></a><span>    </span><a href="StgCmmMonad.html#emitLabel"><span class="hs-identifier hs-var">emitLabel</span></a><span> </span><a href="#local-6989586621680977946"><span class="hs-identifier hs-var">for</span></a><span>
</span><a name="line-2104"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977947"><a href="#local-6989586621680977947"><span class="hs-identifier">loopBody</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2105"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="MkGraph.html#mkStore"><span class="hs-identifier hs-var">mkStore</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977945"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977940"><span class="hs-identifier hs-var">init</span></a><span>
</span><a name="line-2106"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977945"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetW"><span class="hs-identifier hs-var">cmmOffsetW</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977945"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2107"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="MkGraph.html#mkBranch"><span class="hs-identifier hs-var">mkBranch</span></a><span> </span><a href="#local-6989586621680977946"><span class="hs-identifier hs-var">for</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2108"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThen"><span class="hs-identifier hs-var">mkCmmIfThen</span></a><span>
</span><a name="line-2109"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmULtWord"><span class="hs-identifier hs-var">cmmULtWord</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977945"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2110"></a><span>         </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetW"><span class="hs-identifier hs-var">cmmOffsetW</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977944"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2111"></a><span>          </span><span class="hs-special">(</span><a href="SMRep.html#hdrSizeW"><span class="hs-identifier hs-var">hdrSizeW</span></a><span> </span><a href="#local-6989586621680977941"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977936"><span class="hs-identifier hs-var">rep</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621680977939"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2112"></a><span>        </span><span class="hs-special">(</span><a href="MkGraph.html#catAGraphs"><span class="hs-identifier hs-var">catAGraphs</span></a><span> </span><a href="#local-6989586621680977947"><span class="hs-identifier hs-var">loopBody</span></a><span class="hs-special">)</span><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977935"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680977944"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><span>
</span><a name="line-2116"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-2117"></a><span class="hs-comment">-- Copying pointer arrays</span><span>
</span><a name="line-2118"></a><span>
</span><a name="line-2119"></a><span class="hs-comment">-- EZY: This code has an unusually high amount of assignTemp calls, seen</span><span>
</span><a name="line-2120"></a><span class="hs-comment">-- nowhere else in the code generator.  This is mostly because these</span><span>
</span><a name="line-2121"></a><span class="hs-comment">-- &quot;primitive&quot; ops result in a surprisingly large amount of code.  It</span><span>
</span><a name="line-2122"></a><span class="hs-comment">-- will likely be worthwhile to optimize what is emitted here, so that</span><span>
</span><a name="line-2123"></a><span class="hs-comment">-- our optimization passes don't waste time repeatedly optimizing the</span><span>
</span><a name="line-2124"></a><span class="hs-comment">-- same bits of code.</span><span>
</span><a name="line-2125"></a><span>
</span><a name="line-2126"></a><span class="hs-comment">-- More closely imitates 'assignTemp' from the old code generator, which</span><span>
</span><a name="line-2127"></a><span class="hs-comment">-- returns a CmmExpr rather than a LocalReg.</span><span>
</span><a name="line-2128"></a><span class="hs-identifier">assignTempE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2129"></a><a name="assignTempE"><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier">assignTempE</span></a></a><span> </span><a name="local-6989586621680977948"><a href="#local-6989586621680977948"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2130"></a><span>    </span><a name="local-6989586621680977949"><a href="#local-6989586621680977949"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmUtils.html#assignTemp"><span class="hs-identifier hs-var">assignTemp</span></a><span> </span><a href="#local-6989586621680977948"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2131"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680977949"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2132"></a><span>
</span><a name="line-2133"></a><span class="hs-comment">-- | Takes a source 'Array#', an offset in the source array, a</span><span>
</span><a name="line-2134"></a><span class="hs-comment">-- destination 'MutableArray#', an offset into the destination array,</span><span>
</span><a name="line-2135"></a><span class="hs-comment">-- and the number of elements to copy.  Copies the given number of</span><span>
</span><a name="line-2136"></a><span class="hs-comment">-- elements from the source array to the destination array.</span><span>
</span><a name="line-2137"></a><span class="hs-identifier">doCopyArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2138"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2139"></a><a name="doCopyArrayOp"><a href="StgCmmPrim.html#doCopyArrayOp"><span class="hs-identifier">doCopyArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopyArray"><span class="hs-identifier hs-var">emitCopyArray</span></a><span> </span><a href="#local-6989586621680977950"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-2140"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2141"></a><span>    </span><span class="hs-comment">-- Copy data (we assume the arrays aren't overlapping since</span><span>
</span><a name="line-2142"></a><span>    </span><span class="hs-comment">-- they're of different types)</span><span>
</span><a name="line-2143"></a><span>    </span><a name="local-6989586621680977950"><a href="#local-6989586621680977950"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977951"><a href="#local-6989586621680977951"><span class="hs-identifier">_src</span></a></a><span> </span><a name="local-6989586621680977952"><a href="#local-6989586621680977952"><span class="hs-identifier">_dst</span></a></a><span> </span><a name="local-6989586621680977953"><a href="#local-6989586621680977953"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977954"><a href="#local-6989586621680977954"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977955"><a href="#local-6989586621680977955"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2144"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977956"><a href="#local-6989586621680977956"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2145"></a><span>           </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680977953"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977954"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977956"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977955"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2146"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977956"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2147"></a><span>
</span><a name="line-2148"></a><span>
</span><a name="line-2149"></a><span class="hs-comment">-- | Takes a source 'MutableArray#', an offset in the source array, a</span><span>
</span><a name="line-2150"></a><span class="hs-comment">-- destination 'MutableArray#', an offset into the destination array,</span><span>
</span><a name="line-2151"></a><span class="hs-comment">-- and the number of elements to copy.  Copies the given number of</span><span>
</span><a name="line-2152"></a><span class="hs-comment">-- elements from the source array to the destination array.</span><span>
</span><a name="line-2153"></a><span class="hs-identifier">doCopyMutableArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2154"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2155"></a><a name="doCopyMutableArrayOp"><a href="StgCmmPrim.html#doCopyMutableArrayOp"><span class="hs-identifier">doCopyMutableArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopyArray"><span class="hs-identifier hs-var">emitCopyArray</span></a><span> </span><a href="#local-6989586621680977957"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-2156"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2157"></a><span>    </span><span class="hs-comment">-- The only time the memory might overlap is when the two arrays</span><span>
</span><a name="line-2158"></a><span>    </span><span class="hs-comment">-- we were provided are the same array!</span><span>
</span><a name="line-2159"></a><span>    </span><span class="hs-comment">-- TODO: Optimize branch for common case of no aliasing.</span><span>
</span><a name="line-2160"></a><span>    </span><a name="local-6989586621680977957"><a href="#local-6989586621680977957"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977958"><a href="#local-6989586621680977958"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977959"><a href="#local-6989586621680977959"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680977960"><a href="#local-6989586621680977960"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977961"><a href="#local-6989586621680977961"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977962"><a href="#local-6989586621680977962"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2161"></a><span>        </span><a name="local-6989586621680977963"><a href="#local-6989586621680977963"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2162"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680977964"><a href="#local-6989586621680977964"><span class="hs-identifier">moveCall</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977965"><a href="#local-6989586621680977965"><span class="hs-identifier">cpyCall</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmMonad.html#forkAltPair"><span class="hs-identifier hs-var">forkAltPair</span></a><span>
</span><a name="line-2163"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemmoveCall"><span class="hs-identifier hs-var">emitMemmoveCall</span></a><span> </span><a href="#local-6989586621680977960"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977961"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977963"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977962"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2164"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977963"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2165"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span>  </span><a href="#local-6989586621680977960"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977961"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977963"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977962"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2166"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977963"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2167"></a><span>        </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThenElse"><span class="hs-identifier hs-var">mkCmmIfThenElse</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmEqWord"><span class="hs-identifier hs-var">cmmEqWord</span></a><span> </span><a href="#local-6989586621680977963"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977958"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977959"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977964"><span class="hs-identifier hs-var">moveCall</span></a><span> </span><a href="#local-6989586621680977965"><span class="hs-identifier hs-var">cpyCall</span></a><span>
</span><a name="line-2168"></a><span>
</span><a name="line-2169"></a><span class="hs-identifier">emitCopyArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>
</span><a name="line-2170"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ copy function</span><span>
</span><a name="line-2171"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ source array</span><span>
</span><a name="line-2172"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ offset in source array</span><span>
</span><a name="line-2173"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ destination array</span><span>
</span><a name="line-2174"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ offset in destination array</span><span>
</span><a name="line-2175"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>        </span><span class="hs-comment">-- ^ number of elements to copy</span><span>
</span><a name="line-2176"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2177"></a><a name="emitCopyArray"><a href="StgCmmPrim.html#emitCopyArray"><span class="hs-identifier">emitCopyArray</span></a></a><span> </span><a name="local-6989586621680977966"><a href="#local-6989586621680977966"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977967"><a href="#local-6989586621680977967"><span class="hs-identifier">src0</span></a></a><span> </span><a name="local-6989586621680977968"><a href="#local-6989586621680977968"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680977969"><a href="#local-6989586621680977969"><span class="hs-identifier">dst0</span></a></a><span> </span><a name="local-6989586621680977970"><a href="#local-6989586621680977970"><span class="hs-identifier">dst_off0</span></a></a><span> </span><a name="local-6989586621680977971"><a href="#local-6989586621680977971"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2178"></a><span>    </span><a name="local-6989586621680977972"><a href="#local-6989586621680977972"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2179"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680977971"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2180"></a><span>        </span><span class="hs-comment">-- Passed as arguments (be careful)</span><span>
</span><a name="line-2181"></a><span>        </span><a name="local-6989586621680977973"><a href="#local-6989586621680977973"><span class="hs-identifier">src</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><a href="#local-6989586621680977967"><span class="hs-identifier hs-var">src0</span></a><span>
</span><a name="line-2182"></a><span>        </span><a name="local-6989586621680977974"><a href="#local-6989586621680977974"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><a href="#local-6989586621680977969"><span class="hs-identifier hs-var">dst0</span></a><span>
</span><a name="line-2183"></a><span>        </span><a name="local-6989586621680977975"><a href="#local-6989586621680977975"><span class="hs-identifier">dst_off</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><a href="#local-6989586621680977970"><span class="hs-identifier hs-var">dst_off0</span></a><span>
</span><a name="line-2184"></a><span>
</span><a name="line-2185"></a><span>        </span><span class="hs-comment">-- Set the dirty bit in the header.</span><span>
</span><a name="line-2186"></a><span>        </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680977974"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkMAP_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2187"></a><span>
</span><a name="line-2188"></a><span>        </span><a name="local-6989586621680977976"><a href="#local-6989586621680977976"><span class="hs-identifier">dst_elems_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977974"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-2189"></a><span>                       </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2190"></a><span>        </span><a name="local-6989586621680977977"><a href="#local-6989586621680977977"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977976"><span class="hs-identifier hs-var">dst_elems_p</span></a><span> </span><a href="#local-6989586621680977975"><span class="hs-identifier hs-var">dst_off</span></a><span>
</span><a name="line-2191"></a><span>        </span><a name="local-6989586621680977978"><a href="#local-6989586621680977978"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2192"></a><span>                 </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977973"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977968"><span class="hs-identifier hs-var">src_off</span></a><span>
</span><a name="line-2193"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680977979"><a href="#local-6989586621680977979"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977971"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2194"></a><span>
</span><a name="line-2195"></a><span>        </span><a href="#local-6989586621680977966"><span class="hs-identifier hs-var">copy</span></a><span> </span><a href="#local-6989586621680977973"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977974"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680977977"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977978"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680977979"><span class="hs-identifier hs-var">bytes</span></a><span>
</span><a name="line-2196"></a><span>
</span><a name="line-2197"></a><span>        </span><span class="hs-comment">-- The base address of the destination card table</span><span>
</span><a name="line-2198"></a><span>        </span><a name="local-6989586621680977980"><a href="#local-6989586621680977980"><span class="hs-identifier">dst_cards_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977976"><span class="hs-identifier hs-var">dst_elems_p</span></a><span>
</span><a name="line-2199"></a><span>                       </span><span class="hs-special">(</span><a href="StgCmmPrim.html#loadArrPtrsSize"><span class="hs-identifier hs-var">loadArrPtrsSize</span></a><span> </span><a href="#local-6989586621680977972"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977974"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-2200"></a><span>
</span><a name="line-2201"></a><span>        </span><a href="StgCmmPrim.html#emitSetCards"><span class="hs-identifier hs-var">emitSetCards</span></a><span> </span><a href="#local-6989586621680977975"><span class="hs-identifier hs-var">dst_off</span></a><span> </span><a href="#local-6989586621680977980"><span class="hs-identifier hs-var">dst_cards_p</span></a><span> </span><a href="#local-6989586621680977971"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2202"></a><span>
</span><a name="line-2203"></a><span class="hs-identifier">doCopySmallArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2204"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2205"></a><a name="doCopySmallArrayOp"><a href="StgCmmPrim.html#doCopySmallArrayOp"><span class="hs-identifier">doCopySmallArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopySmallArray"><span class="hs-identifier hs-var">emitCopySmallArray</span></a><span> </span><a href="#local-6989586621680977981"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-2206"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2207"></a><span>    </span><span class="hs-comment">-- Copy data (we assume the arrays aren't overlapping since</span><span>
</span><a name="line-2208"></a><span>    </span><span class="hs-comment">-- they're of different types)</span><span>
</span><a name="line-2209"></a><span>    </span><a name="local-6989586621680977981"><a href="#local-6989586621680977981"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977982"><a href="#local-6989586621680977982"><span class="hs-identifier">_src</span></a></a><span> </span><a name="local-6989586621680977983"><a href="#local-6989586621680977983"><span class="hs-identifier">_dst</span></a></a><span> </span><a name="local-6989586621680977984"><a href="#local-6989586621680977984"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977985"><a href="#local-6989586621680977985"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977986"><a href="#local-6989586621680977986"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2210"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680977987"><a href="#local-6989586621680977987"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2211"></a><span>           </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680977984"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977985"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977987"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977986"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2212"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977987"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2213"></a><span>
</span><a name="line-2214"></a><span>
</span><a name="line-2215"></a><span class="hs-identifier">doCopySmallMutableArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2216"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2217"></a><a name="doCopySmallMutableArrayOp"><a href="StgCmmPrim.html#doCopySmallMutableArrayOp"><span class="hs-identifier">doCopySmallMutableArrayOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#emitCopySmallArray"><span class="hs-identifier hs-var">emitCopySmallArray</span></a><span> </span><a href="#local-6989586621680977988"><span class="hs-identifier hs-var">copy</span></a><span>
</span><a name="line-2218"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2219"></a><span>    </span><span class="hs-comment">-- The only time the memory might overlap is when the two arrays</span><span>
</span><a name="line-2220"></a><span>    </span><span class="hs-comment">-- we were provided are the same array!</span><span>
</span><a name="line-2221"></a><span>    </span><span class="hs-comment">-- TODO: Optimize branch for common case of no aliasing.</span><span>
</span><a name="line-2222"></a><span>    </span><a name="local-6989586621680977988"><a href="#local-6989586621680977988"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977989"><a href="#local-6989586621680977989"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680977990"><a href="#local-6989586621680977990"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680977991"><a href="#local-6989586621680977991"><span class="hs-identifier">dst_p</span></a></a><span> </span><a name="local-6989586621680977992"><a href="#local-6989586621680977992"><span class="hs-identifier">src_p</span></a></a><span> </span><a name="local-6989586621680977993"><a href="#local-6989586621680977993"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2223"></a><span>        </span><a name="local-6989586621680977994"><a href="#local-6989586621680977994"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2224"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680977995"><a href="#local-6989586621680977995"><span class="hs-identifier">moveCall</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680977996"><a href="#local-6989586621680977996"><span class="hs-identifier">cpyCall</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmMonad.html#forkAltPair"><span class="hs-identifier hs-var">forkAltPair</span></a><span>
</span><a name="line-2225"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemmoveCall"><span class="hs-identifier hs-var">emitMemmoveCall</span></a><span> </span><a href="#local-6989586621680977991"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977992"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977994"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977993"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2226"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977994"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2227"></a><span>            </span><span class="hs-special">(</span><a href="StgCmmMonad.html#getCode"><span class="hs-identifier hs-var">getCode</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span>  </span><a href="#local-6989586621680977991"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680977992"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680977994"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977993"><span class="hs-identifier hs-var">bytes</span></a><span class="hs-special">)</span><span>
</span><a name="line-2228"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680977994"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2229"></a><span>        </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="StgCmmMonad.html#mkCmmIfThenElse"><span class="hs-identifier hs-var">mkCmmIfThenElse</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmEqWord"><span class="hs-identifier hs-var">cmmEqWord</span></a><span> </span><a href="#local-6989586621680977994"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680977989"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680977990"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977995"><span class="hs-identifier hs-var">moveCall</span></a><span> </span><a href="#local-6989586621680977996"><span class="hs-identifier hs-var">cpyCall</span></a><span>
</span><a name="line-2230"></a><span>
</span><a name="line-2231"></a><span class="hs-identifier">emitCopySmallArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a><span>
</span><a name="line-2232"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ copy function</span><span>
</span><a name="line-2233"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ source array</span><span>
</span><a name="line-2234"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ offset in source array</span><span>
</span><a name="line-2235"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ destination array</span><span>
</span><a name="line-2236"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>        </span><span class="hs-comment">-- ^ offset in destination array</span><span>
</span><a name="line-2237"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>        </span><span class="hs-comment">-- ^ number of elements to copy</span><span>
</span><a name="line-2238"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2239"></a><a name="emitCopySmallArray"><a href="StgCmmPrim.html#emitCopySmallArray"><span class="hs-identifier">emitCopySmallArray</span></a></a><span> </span><a name="local-6989586621680977997"><a href="#local-6989586621680977997"><span class="hs-identifier">copy</span></a></a><span> </span><a name="local-6989586621680977998"><a href="#local-6989586621680977998"><span class="hs-identifier">src0</span></a></a><span> </span><a name="local-6989586621680977999"><a href="#local-6989586621680977999"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680978000"><a href="#local-6989586621680978000"><span class="hs-identifier">dst0</span></a></a><span> </span><a name="local-6989586621680978001"><a href="#local-6989586621680978001"><span class="hs-identifier">dst_off</span></a></a><span> </span><a name="local-6989586621680978002"><a href="#local-6989586621680978002"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2240"></a><span>    </span><a name="local-6989586621680978003"><a href="#local-6989586621680978003"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2241"></a><span>
</span><a name="line-2242"></a><span>    </span><span class="hs-comment">-- Passed as arguments (be careful)</span><span>
</span><a name="line-2243"></a><span>    </span><a name="local-6989586621680978004"><a href="#local-6989586621680978004"><span class="hs-identifier">src</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><a href="#local-6989586621680977998"><span class="hs-identifier hs-var">src0</span></a><span>
</span><a name="line-2244"></a><span>    </span><a name="local-6989586621680978005"><a href="#local-6989586621680978005"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><a href="#local-6989586621680978000"><span class="hs-identifier hs-var">dst0</span></a><span>
</span><a name="line-2245"></a><span>
</span><a name="line-2246"></a><span>    </span><span class="hs-comment">-- Set the dirty bit in the header.</span><span>
</span><a name="line-2247"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680978005"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkSMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2248"></a><span>
</span><a name="line-2249"></a><span>    </span><a name="local-6989586621680978006"><a href="#local-6989586621680978006"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2250"></a><span>             </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978005"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680978001"><span class="hs-identifier hs-var">dst_off</span></a><span>
</span><a name="line-2251"></a><span>    </span><a name="local-6989586621680978007"><a href="#local-6989586621680978007"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2252"></a><span>             </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978004"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680977999"><span class="hs-identifier hs-var">src_off</span></a><span>
</span><a name="line-2253"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978008"><a href="#local-6989586621680978008"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680978003"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978002"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2254"></a><span>
</span><a name="line-2255"></a><span>    </span><a href="#local-6989586621680977997"><span class="hs-identifier hs-var">copy</span></a><span> </span><a href="#local-6989586621680978004"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680978005"><span class="hs-identifier hs-var">dst</span></a><span> </span><a href="#local-6989586621680978006"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680978007"><span class="hs-identifier hs-var">src_p</span></a><span> </span><a href="#local-6989586621680978008"><span class="hs-identifier hs-var">bytes</span></a><span>
</span><a name="line-2256"></a><span>
</span><a name="line-2257"></a><span class="hs-comment">-- | Takes an info table label, a register to return the newly</span><span>
</span><a name="line-2258"></a><span class="hs-comment">-- allocated array in, a source array, an offset in the source array,</span><span>
</span><a name="line-2259"></a><span class="hs-comment">-- and the number of elements to copy. Allocates a new array and</span><span>
</span><a name="line-2260"></a><span class="hs-comment">-- initializes it from the source array.</span><span>
</span><a name="line-2261"></a><span class="hs-identifier">emitCloneArray</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2262"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2263"></a><a name="emitCloneArray"><a href="StgCmmPrim.html#emitCloneArray"><span class="hs-identifier">emitCloneArray</span></a></a><span> </span><a name="local-6989586621680978009"><a href="#local-6989586621680978009"><span class="hs-identifier">info_p</span></a></a><span> </span><a name="local-6989586621680978010"><a href="#local-6989586621680978010"><span class="hs-identifier">res_r</span></a></a><span> </span><a name="local-6989586621680978011"><a href="#local-6989586621680978011"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680978012"><a href="#local-6989586621680978012"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680978013"><a href="#local-6989586621680978013"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2264"></a><span>    </span><a name="local-6989586621680978014"><a href="#local-6989586621680978014"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2265"></a><span>
</span><a name="line-2266"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978015"><a href="#local-6989586621680978015"><span class="hs-identifier">info_ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmUtils.html#mkLblExpr"><span class="hs-identifier hs-var">mkLblExpr</span></a><span> </span><a href="#local-6989586621680978009"><span class="hs-identifier hs-var">info_p</span></a><span>
</span><a name="line-2267"></a><span>        </span><a name="local-6989586621680978016"><a href="#local-6989586621680978016"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#arrPtrsRep"><span class="hs-identifier hs-var">arrPtrsRep</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978013"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2268"></a><span>
</span><a name="line-2269"></a><span>    </span><a href="StgCmmTicky.html#tickyAllocPrim"><span class="hs-identifier hs-var">tickyAllocPrim</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2270"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSize"><span class="hs-identifier hs-var">nonHdrSize</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978016"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2271"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroExpr"><span class="hs-identifier hs-var">zeroExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2272"></a><span>
</span><a name="line-2273"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978017"><a href="#local-6989586621680978017"><span class="hs-identifier">hdr_size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2274"></a><span>
</span><a name="line-2275"></a><span>    </span><a name="local-6989586621680978018"><a href="#local-6989586621680978018"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmHeap.html#allocHeapClosure"><span class="hs-identifier hs-var">allocHeapClosure</span></a><span> </span><a href="#local-6989586621680978016"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680978015"><span class="hs-identifier hs-var">info_ptr</span></a><span> </span><a href="CmmUtils.html#cccsExpr"><span class="hs-identifier hs-var">cccsExpr</span></a><span>
</span><a name="line-2276"></a><span>                     </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978013"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span>
</span><a name="line-2277"></a><span>                        </span><a href="#local-6989586621680978017"><span class="hs-identifier hs-var">hdr_size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2278"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSizeW"><span class="hs-identifier hs-var">nonHdrSizeW</span></a><span> </span><a href="#local-6989586621680978016"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2279"></a><span>                        </span><a href="#local-6989586621680978017"><span class="hs-identifier hs-var">hdr_size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgMutArrPtrs_size</span><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2280"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-2281"></a><span>
</span><a name="line-2282"></a><span>    </span><a name="local-6989586621680978019"><a href="#local-6989586621680978019"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2283"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680978019"><span class="hs-identifier hs-var">arr</span></a><span> </span><a href="#local-6989586621680978018"><span class="hs-identifier hs-var">base</span></a><span>
</span><a name="line-2284"></a><span>
</span><a name="line-2285"></a><span>    </span><a name="local-6989586621680978020"><a href="#local-6989586621680978020"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680978019"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2286"></a><span>             </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSize"><span class="hs-identifier hs-var">arrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2287"></a><span>    </span><a name="local-6989586621680978021"><a href="#local-6989586621680978021"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978011"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-2288"></a><span>             </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmAddWord"><span class="hs-identifier hs-var">cmmAddWord</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2289"></a><span>              </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrPtrsHdrSizeW"><span class="hs-identifier hs-var">arrPtrsHdrSizeW</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680978012"><span class="hs-identifier hs-var">src_off</span></a><span class="hs-special">)</span><span>
</span><a name="line-2290"></a><span>
</span><a name="line-2291"></a><span>    </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680978020"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680978021"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978013"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2292"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680978014"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2293"></a><span>
</span><a name="line-2294"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680978010"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680978019"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2295"></a><span>
</span><a name="line-2296"></a><span class="hs-comment">-- | Takes an info table label, a register to return the newly</span><span>
</span><a name="line-2297"></a><span class="hs-comment">-- allocated array in, a source array, an offset in the source array,</span><span>
</span><a name="line-2298"></a><span class="hs-comment">-- and the number of elements to copy. Allocates a new array and</span><span>
</span><a name="line-2299"></a><span class="hs-comment">-- initializes it from the source array.</span><span>
</span><a name="line-2300"></a><span class="hs-identifier">emitCloneSmallArray</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmNode.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span>
</span><a name="line-2301"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2302"></a><a name="emitCloneSmallArray"><a href="StgCmmPrim.html#emitCloneSmallArray"><span class="hs-identifier">emitCloneSmallArray</span></a></a><span> </span><a name="local-6989586621680978022"><a href="#local-6989586621680978022"><span class="hs-identifier">info_p</span></a></a><span> </span><a name="local-6989586621680978023"><a href="#local-6989586621680978023"><span class="hs-identifier">res_r</span></a></a><span> </span><a name="local-6989586621680978024"><a href="#local-6989586621680978024"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680978025"><a href="#local-6989586621680978025"><span class="hs-identifier">src_off</span></a></a><span> </span><a name="local-6989586621680978026"><a href="#local-6989586621680978026"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2303"></a><span>    </span><a name="local-6989586621680978027"><a href="#local-6989586621680978027"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2304"></a><span>
</span><a name="line-2305"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978028"><a href="#local-6989586621680978028"><span class="hs-identifier">info_ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmUtils.html#mkLblExpr"><span class="hs-identifier hs-var">mkLblExpr</span></a><span> </span><a href="#local-6989586621680978022"><span class="hs-identifier hs-var">info_p</span></a><span>
</span><a name="line-2306"></a><span>        </span><a name="local-6989586621680978029"><a href="#local-6989586621680978029"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#smallArrPtrsRep"><span class="hs-identifier hs-var">smallArrPtrsRep</span></a><span> </span><a href="#local-6989586621680978026"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2307"></a><span>
</span><a name="line-2308"></a><span>    </span><a href="StgCmmTicky.html#tickyAllocPrim"><span class="hs-identifier hs-var">tickyAllocPrim</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2309"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#nonHdrSize"><span class="hs-identifier hs-var">nonHdrSize</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978029"><span class="hs-identifier hs-var">rep</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2310"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#zeroExpr"><span class="hs-identifier hs-var">zeroExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2311"></a><span>
</span><a name="line-2312"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978030"><a href="#local-6989586621680978030"><span class="hs-identifier">hdr_size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SMRep.html#fixedHdrSize"><span class="hs-identifier hs-var">fixedHdrSize</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2313"></a><span>
</span><a name="line-2314"></a><span>    </span><a name="local-6989586621680978031"><a href="#local-6989586621680978031"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmHeap.html#allocHeapClosure"><span class="hs-identifier hs-var">allocHeapClosure</span></a><span> </span><a href="#local-6989586621680978029"><span class="hs-identifier hs-var">rep</span></a><span> </span><a href="#local-6989586621680978028"><span class="hs-identifier hs-var">info_ptr</span></a><span> </span><a href="CmmUtils.html#cccsExpr"><span class="hs-identifier hs-var">cccsExpr</span></a><span>
</span><a name="line-2315"></a><span>                     </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978026"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span>
</span><a name="line-2316"></a><span>                        </span><a href="#local-6989586621680978030"><span class="hs-identifier hs-var">hdr_size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">oFFSET_StgSmallMutArrPtrs_ptrs</span><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2317"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-2318"></a><span>
</span><a name="line-2319"></a><span>    </span><a name="local-6989586621680978032"><a href="#local-6989586621680978032"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bWord</span><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2320"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><a href="#local-6989586621680978032"><span class="hs-identifier hs-var">arr</span></a><span> </span><a href="#local-6989586621680978031"><span class="hs-identifier hs-var">base</span></a><span>
</span><a name="line-2321"></a><span>
</span><a name="line-2322"></a><span>    </span><a name="local-6989586621680978033"><a href="#local-6989586621680978033"><span class="hs-identifier">dst_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetB"><span class="hs-identifier hs-var">cmmOffsetB</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680978032"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2323"></a><span>             </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2324"></a><span>    </span><a name="local-6989586621680978034"><a href="#local-6989586621680978034"><span class="hs-identifier">src_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CmmUtils.html#cmmOffsetExprW"><span class="hs-identifier hs-var">cmmOffsetExprW</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978024"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-2325"></a><span>             </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmAddWord"><span class="hs-identifier hs-var">cmmAddWord</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2326"></a><span>              </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSizeW"><span class="hs-identifier hs-var">smallArrPtrsHdrSizeW</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680978025"><span class="hs-identifier hs-var">src_off</span></a><span class="hs-special">)</span><span>
</span><a name="line-2327"></a><span>
</span><a name="line-2328"></a><span>    </span><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier hs-var">emitMemcpyCall</span></a><span> </span><a href="#local-6989586621680978033"><span class="hs-identifier hs-var">dst_p</span></a><span> </span><a href="#local-6989586621680978034"><span class="hs-identifier hs-var">src_p</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#wordsToBytes"><span class="hs-identifier hs-var">wordsToBytes</span></a><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978026"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2329"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">wORD_SIZE</span><span> </span><a href="#local-6989586621680978027"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2330"></a><span>
</span><a name="line-2331"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680978023"><span class="hs-identifier hs-var">res_r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><a href="#local-6989586621680978032"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2332"></a><span>
</span><a name="line-2333"></a><span class="hs-comment">-- | Takes and offset in the destination array, the base address of</span><span>
</span><a name="line-2334"></a><span class="hs-comment">-- the card table, and the number of elements affected (*not* the</span><span>
</span><a name="line-2335"></a><span class="hs-comment">-- number of cards). The number of elements may not be zero.</span><span>
</span><a name="line-2336"></a><span class="hs-comment">-- Marks the relevant cards as dirty.</span><span>
</span><a name="line-2337"></a><span class="hs-identifier">emitSetCards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SMRep.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2338"></a><a name="emitSetCards"><a href="StgCmmPrim.html#emitSetCards"><span class="hs-identifier">emitSetCards</span></a></a><span> </span><a name="local-6989586621680978035"><a href="#local-6989586621680978035"><span class="hs-identifier">dst_start</span></a></a><span> </span><a name="local-6989586621680978036"><a href="#local-6989586621680978036"><span class="hs-identifier">dst_cards_start</span></a></a><span> </span><a name="local-6989586621680978037"><a href="#local-6989586621680978037"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2339"></a><span>    </span><a name="local-6989586621680978038"><a href="#local-6989586621680978038"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2340"></a><span>    </span><a name="local-6989586621680978039"><a href="#local-6989586621680978039"><span class="hs-identifier">start_card</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="StgCmmPrim.html#assignTempE"><span class="hs-identifier hs-var">assignTempE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="StgCmmPrim.html#cardCmm"><span class="hs-identifier hs-var">cardCmm</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978035"><span class="hs-identifier hs-var">dst_start</span></a><span>
</span><a name="line-2341"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978040"><a href="#local-6989586621680978040"><span class="hs-identifier">end_card</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#cardCmm"><span class="hs-identifier hs-var">cardCmm</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2342"></a><span>                   </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmSubWord"><span class="hs-identifier hs-var">cmmSubWord</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2343"></a><span>                    </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmAddWord"><span class="hs-identifier hs-var">cmmAddWord</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978035"><span class="hs-identifier hs-var">dst_start</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978037"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2344"></a><span>                    </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2345"></a><span>    </span><a href="StgCmmPrim.html#emitMemsetCall"><span class="hs-identifier hs-var">emitMemsetCall</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmAddWord"><span class="hs-identifier hs-var">cmmAddWord</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978036"><span class="hs-identifier hs-var">dst_cards_start</span></a><span> </span><a href="#local-6989586621680978039"><span class="hs-identifier hs-var">start_card</span></a><span class="hs-special">)</span><span>
</span><a name="line-2346"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-2347"></a><span>        </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmAddWord"><span class="hs-identifier hs-var">cmmAddWord</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#cmmSubWord"><span class="hs-identifier hs-var">cmmSubWord</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978040"><span class="hs-identifier hs-var">end_card</span></a><span> </span><a href="#local-6989586621680978039"><span class="hs-identifier hs-var">start_card</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978038"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2348"></a><span>        </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- no alignment (1 byte)</span><span>
</span><a name="line-2349"></a><span>
</span><a name="line-2350"></a><span class="hs-comment">-- Convert an element index to a card index</span><span>
</span><a name="line-2351"></a><span class="hs-identifier">cardCmm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2352"></a><a name="cardCmm"><a href="StgCmmPrim.html#cardCmm"><span class="hs-identifier">cardCmm</span></a></a><span> </span><a name="local-6989586621680978041"><a href="#local-6989586621680978041"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680978042"><a href="#local-6989586621680978042"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2353"></a><span>    </span><a href="CmmUtils.html#cmmUShrWord"><span class="hs-identifier hs-var">cmmUShrWord</span></a><span> </span><a href="#local-6989586621680978041"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978042"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="CmmUtils.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a><span> </span><a href="#local-6989586621680978041"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mUT_ARR_PTRS_CARD_BITS</span><span> </span><a href="#local-6989586621680978041"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2354"></a><span>
</span><a name="line-2355"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-2356"></a><span class="hs-comment">-- SmallArray PrimOp implementations</span><span>
</span><a name="line-2357"></a><span>
</span><a name="line-2358"></a><span class="hs-identifier">doReadSmallPtrArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>
</span><a name="line-2359"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2360"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2361"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2362"></a><a name="doReadSmallPtrArrayOp"><a href="StgCmmPrim.html#doReadSmallPtrArrayOp"><span class="hs-identifier">doReadSmallPtrArrayOp</span></a></a><span> </span><a name="local-6989586621680978043"><a href="#local-6989586621680978043"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978044"><a href="#local-6989586621680978044"><span class="hs-identifier">addr</span></a></a><span> </span><a name="local-6989586621680978045"><a href="#local-6989586621680978045"><span class="hs-identifier">idx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2363"></a><span>    </span><a name="local-6989586621680978046"><a href="#local-6989586621680978046"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2364"></a><span>    </span><a href="StgCmmPrim.html#mkBasicIndexedRead"><span class="hs-identifier hs-var">mkBasicIndexedRead</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978046"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621680978046"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680978043"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621680978044"><span class="hs-identifier hs-var">addr</span></a><span>
</span><a name="line-2365"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">gcWord</span><span> </span><a href="#local-6989586621680978046"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680978045"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-2366"></a><span>
</span><a name="line-2367"></a><span class="hs-identifier">doWriteSmallPtrArrayOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2368"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2369"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>
</span><a name="line-2370"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2371"></a><a name="doWriteSmallPtrArrayOp"><a href="StgCmmPrim.html#doWriteSmallPtrArrayOp"><span class="hs-identifier">doWriteSmallPtrArrayOp</span></a></a><span> </span><a name="local-6989586621680978047"><a href="#local-6989586621680978047"><span class="hs-identifier">addr</span></a></a><span> </span><a name="local-6989586621680978048"><a href="#local-6989586621680978048"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680978049"><a href="#local-6989586621680978049"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2372"></a><span>    </span><a name="local-6989586621680978050"><a href="#local-6989586621680978050"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2373"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978051"><a href="#local-6989586621680978051"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CmmExpr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a><span> </span><a href="#local-6989586621680978050"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680978049"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-2374"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="CmmMachOp.html#MO_WriteBarrier"><span class="hs-identifier hs-var">MO_WriteBarrier</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- #12469</span><span>
</span><a name="line-2375"></a><span>    </span><a href="StgCmmPrim.html#mkBasicIndexedWrite"><span class="hs-identifier hs-var">mkBasicIndexedWrite</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#smallArrPtrsHdrSize"><span class="hs-identifier hs-var">smallArrPtrsHdrSize</span></a><span> </span><a href="#local-6989586621680978050"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621680978047"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621680978051"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680978048"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621680978049"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-2376"></a><span>    </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-special">(</span><a href="StgCmmPrim.html#setInfo"><span class="hs-identifier hs-var">setInfo</span></a><span> </span><a href="#local-6989586621680978047"><span class="hs-identifier hs-var">addr</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a href="CLabel.html#mkSMAP_DIRTY_infoLabel"><span class="hs-identifier hs-var">mkSMAP_DIRTY_infoLabel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2377"></a><span>
</span><a name="line-2378"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-2379"></a><span class="hs-comment">-- Atomic read-modify-write</span><span>
</span><a name="line-2380"></a><span>
</span><a name="line-2381"></a><span class="hs-comment">-- | Emit an atomic modification to a byte array element. The result</span><span>
</span><a name="line-2382"></a><span class="hs-comment">-- reg contains that previous value of the element. Implies a full</span><span>
</span><a name="line-2383"></a><span class="hs-comment">-- memory barrier.</span><span>
</span><a name="line-2384"></a><span class="hs-identifier">doAtomicRMW</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>      </span><span class="hs-comment">-- ^ Result reg</span><span>
</span><a name="line-2385"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmMachOp.html#AtomicMachOp"><span class="hs-identifier hs-type">AtomicMachOp</span></a><span>  </span><span class="hs-comment">-- ^ Atomic op (e.g. add)</span><span>
</span><a name="line-2386"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- ^ MutableByteArray#</span><span>
</span><a name="line-2387"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- ^ Index</span><span>
</span><a name="line-2388"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>       </span><span class="hs-comment">-- ^ Type of element by which we are indexing</span><span>
</span><a name="line-2389"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>       </span><span class="hs-comment">-- ^ Op argument (e.g. amount to add)</span><span>
</span><a name="line-2390"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2391"></a><a name="doAtomicRMW"><a href="StgCmmPrim.html#doAtomicRMW"><span class="hs-identifier">doAtomicRMW</span></a></a><span> </span><a name="local-6989586621680978052"><a href="#local-6989586621680978052"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978053"><a href="#local-6989586621680978053"><span class="hs-identifier">amop</span></a></a><span> </span><a name="local-6989586621680978054"><a href="#local-6989586621680978054"><span class="hs-identifier">mba</span></a></a><span> </span><a name="local-6989586621680978055"><a href="#local-6989586621680978055"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680978056"><a href="#local-6989586621680978056"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680978057"><a href="#local-6989586621680978057"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2392"></a><span>    </span><a name="local-6989586621680978058"><a href="#local-6989586621680978058"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2393"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978059"><a href="#local-6989586621680978059"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680978056"><span class="hs-identifier hs-var">idx_ty</span></a><span>
</span><a name="line-2394"></a><span>        </span><a name="local-6989586621680978060"><a href="#local-6989586621680978060"><span class="hs-identifier">addr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680978058"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680978058"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2395"></a><span>                </span><a href="#local-6989586621680978059"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-6989586621680978054"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680978055"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-2396"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2397"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978052"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2398"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_AtomicRMW"><span class="hs-identifier hs-var">MO_AtomicRMW</span></a><span> </span><a href="#local-6989586621680978059"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-6989586621680978053"><span class="hs-identifier hs-var">amop</span></a><span class="hs-special">)</span><span>
</span><a name="line-2399"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978060"><span class="hs-identifier hs-var">addr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978057"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2400"></a><span>
</span><a name="line-2401"></a><span class="hs-comment">-- | Emit an atomic read to a byte array that acts as a memory barrier.</span><span>
</span><a name="line-2402"></a><span class="hs-identifier">doAtomicReadByteArray</span><span>
</span><a name="line-2403"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>  </span><span class="hs-comment">-- ^ Result reg</span><span>
</span><a name="line-2404"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ MutableByteArray#</span><span>
</span><a name="line-2405"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ Index</span><span>
</span><a name="line-2406"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>   </span><span class="hs-comment">-- ^ Type of element by which we are indexing</span><span>
</span><a name="line-2407"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2408"></a><a name="doAtomicReadByteArray"><a href="StgCmmPrim.html#doAtomicReadByteArray"><span class="hs-identifier">doAtomicReadByteArray</span></a></a><span> </span><a name="local-6989586621680978061"><a href="#local-6989586621680978061"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978062"><a href="#local-6989586621680978062"><span class="hs-identifier">mba</span></a></a><span> </span><a name="local-6989586621680978063"><a href="#local-6989586621680978063"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680978064"><a href="#local-6989586621680978064"><span class="hs-identifier">idx_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2409"></a><span>    </span><a name="local-6989586621680978065"><a href="#local-6989586621680978065"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2410"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978066"><a href="#local-6989586621680978066"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680978064"><span class="hs-identifier hs-var">idx_ty</span></a><span>
</span><a name="line-2411"></a><span>        </span><a name="local-6989586621680978067"><a href="#local-6989586621680978067"><span class="hs-identifier">addr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680978065"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680978065"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2412"></a><span>                </span><a href="#local-6989586621680978066"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-6989586621680978062"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680978063"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-2413"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2414"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978061"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2415"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_AtomicRead"><span class="hs-identifier hs-var">MO_AtomicRead</span></a><span> </span><a href="#local-6989586621680978066"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2416"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978067"><span class="hs-identifier hs-var">addr</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2417"></a><span>
</span><a name="line-2418"></a><span class="hs-comment">-- | Emit an atomic write to a byte array that acts as a memory barrier.</span><span>
</span><a name="line-2419"></a><span class="hs-identifier">doAtomicWriteByteArray</span><span>
</span><a name="line-2420"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ MutableByteArray#</span><span>
</span><a name="line-2421"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ Index</span><span>
</span><a name="line-2422"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>   </span><span class="hs-comment">-- ^ Type of element by which we are indexing</span><span>
</span><a name="line-2423"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ Value to write</span><span>
</span><a name="line-2424"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2425"></a><a name="doAtomicWriteByteArray"><a href="StgCmmPrim.html#doAtomicWriteByteArray"><span class="hs-identifier">doAtomicWriteByteArray</span></a></a><span> </span><a name="local-6989586621680978068"><a href="#local-6989586621680978068"><span class="hs-identifier">mba</span></a></a><span> </span><a name="local-6989586621680978069"><a href="#local-6989586621680978069"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680978070"><a href="#local-6989586621680978070"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680978071"><a href="#local-6989586621680978071"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2426"></a><span>    </span><a name="local-6989586621680978072"><a href="#local-6989586621680978072"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2427"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978073"><a href="#local-6989586621680978073"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680978070"><span class="hs-identifier hs-var">idx_ty</span></a><span>
</span><a name="line-2428"></a><span>        </span><a name="local-6989586621680978074"><a href="#local-6989586621680978074"><span class="hs-identifier">addr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680978072"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680978072"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2429"></a><span>                </span><a href="#local-6989586621680978073"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-6989586621680978068"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680978069"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-2430"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2431"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-comment">{- no results -}</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2432"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_AtomicWrite"><span class="hs-identifier hs-var">MO_AtomicWrite</span></a><span> </span><a href="#local-6989586621680978073"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2433"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978074"><span class="hs-identifier hs-var">addr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978071"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2434"></a><span>
</span><a name="line-2435"></a><span class="hs-identifier">doCasByteArray</span><span>
</span><a name="line-2436"></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span>  </span><span class="hs-comment">-- ^ Result reg</span><span>
</span><a name="line-2437"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ MutableByteArray#</span><span>
</span><a name="line-2438"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ Index</span><span>
</span><a name="line-2439"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CmmType</span><span>   </span><span class="hs-comment">-- ^ Type of element by which we are indexing</span><span>
</span><a name="line-2440"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ Old value</span><span>
</span><a name="line-2441"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span>   </span><span class="hs-comment">-- ^ New value</span><span>
</span><a name="line-2442"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2443"></a><a name="doCasByteArray"><a href="StgCmmPrim.html#doCasByteArray"><span class="hs-identifier">doCasByteArray</span></a></a><span> </span><a name="local-6989586621680978075"><a href="#local-6989586621680978075"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978076"><a href="#local-6989586621680978076"><span class="hs-identifier">mba</span></a></a><span> </span><a name="local-6989586621680978077"><a href="#local-6989586621680978077"><span class="hs-identifier">idx</span></a></a><span> </span><a name="local-6989586621680978078"><a href="#local-6989586621680978078"><span class="hs-identifier">idx_ty</span></a></a><span> </span><a name="local-6989586621680978079"><a href="#local-6989586621680978079"><span class="hs-identifier">old</span></a></a><span> </span><a name="local-6989586621680978080"><a href="#local-6989586621680978080"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2444"></a><span>    </span><a name="local-6989586621680978081"><a href="#local-6989586621680978081"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2445"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978082"><a href="#local-6989586621680978082"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeWidth</span><span> </span><a href="#local-6989586621680978078"><span class="hs-identifier hs-var">idx_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2446"></a><span>        </span><a name="local-6989586621680978083"><a href="#local-6989586621680978083"><span class="hs-identifier">addr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="StgCmmPrim.html#cmmIndexOffExpr"><span class="hs-identifier hs-var">cmmIndexOffExpr</span></a><span> </span><a href="#local-6989586621680978081"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="SMRep.html#arrWordsHdrSize"><span class="hs-identifier hs-var">arrWordsHdrSize</span></a><span> </span><a href="#local-6989586621680978081"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2447"></a><span>               </span><a href="#local-6989586621680978082"><span class="hs-identifier hs-var">width</span></a><span> </span><a href="#local-6989586621680978076"><span class="hs-identifier hs-var">mba</span></a><span> </span><a href="#local-6989586621680978077"><span class="hs-identifier hs-var">idx</span></a><span>
</span><a name="line-2448"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2449"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978075"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2450"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Cmpxchg"><span class="hs-identifier hs-var">MO_Cmpxchg</span></a><span> </span><a href="#local-6989586621680978082"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2451"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978083"><span class="hs-identifier hs-var">addr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978079"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978080"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2452"></a><span>
</span><a name="line-2453"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-2454"></a><span class="hs-comment">-- Helpers for emitting function calls</span><span>
</span><a name="line-2455"></a><span>
</span><a name="line-2456"></a><span class="hs-comment">-- | Emit a call to @memcpy@.</span><span>
</span><a name="line-2457"></a><span class="hs-identifier">emitMemcpyCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2458"></a><a name="emitMemcpyCall"><a href="StgCmmPrim.html#emitMemcpyCall"><span class="hs-identifier">emitMemcpyCall</span></a></a><span> </span><a name="local-6989586621680978084"><a href="#local-6989586621680978084"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680978085"><a href="#local-6989586621680978085"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680978086"><a href="#local-6989586621680978086"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680978087"><a href="#local-6989586621680978087"><span class="hs-identifier">align</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2459"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2460"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-comment">{-no results-}</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2461"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Memcpy"><span class="hs-identifier hs-var">MO_Memcpy</span></a><span> </span><a href="#local-6989586621680978087"><span class="hs-identifier hs-var">align</span></a><span class="hs-special">)</span><span>
</span><a name="line-2462"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978084"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978085"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978086"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2463"></a><span>
</span><a name="line-2464"></a><span class="hs-comment">-- | Emit a call to @memmove@.</span><span>
</span><a name="line-2465"></a><span class="hs-identifier">emitMemmoveCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2466"></a><a name="emitMemmoveCall"><a href="StgCmmPrim.html#emitMemmoveCall"><span class="hs-identifier">emitMemmoveCall</span></a></a><span> </span><a name="local-6989586621680978088"><a href="#local-6989586621680978088"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680978089"><a href="#local-6989586621680978089"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680978090"><a href="#local-6989586621680978090"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680978091"><a href="#local-6989586621680978091"><span class="hs-identifier">align</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2467"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2468"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-comment">{- no results -}</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2469"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Memmove"><span class="hs-identifier hs-var">MO_Memmove</span></a><span> </span><a href="#local-6989586621680978091"><span class="hs-identifier hs-var">align</span></a><span class="hs-special">)</span><span>
</span><a name="line-2470"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978088"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978089"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978090"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2471"></a><span>
</span><a name="line-2472"></a><span class="hs-comment">-- | Emit a call to @memset@.  The second argument must fit inside an</span><span>
</span><a name="line-2473"></a><span class="hs-comment">-- unsigned char.</span><span>
</span><a name="line-2474"></a><span class="hs-identifier">emitMemsetCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2475"></a><a name="emitMemsetCall"><a href="StgCmmPrim.html#emitMemsetCall"><span class="hs-identifier">emitMemsetCall</span></a></a><span> </span><a name="local-6989586621680978092"><a href="#local-6989586621680978092"><span class="hs-identifier">dst</span></a></a><span> </span><a name="local-6989586621680978093"><a href="#local-6989586621680978093"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621680978094"><a href="#local-6989586621680978094"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680978095"><a href="#local-6989586621680978095"><span class="hs-identifier">align</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2476"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2477"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-comment">{- no results -}</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2478"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Memset"><span class="hs-identifier hs-var">MO_Memset</span></a><span> </span><a href="#local-6989586621680978095"><span class="hs-identifier hs-var">align</span></a><span class="hs-special">)</span><span>
</span><a name="line-2479"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978092"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978093"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978094"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2480"></a><span>
</span><a name="line-2481"></a><span class="hs-identifier">emitMemcmpCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2482"></a><a name="emitMemcmpCall"><a href="StgCmmPrim.html#emitMemcmpCall"><span class="hs-identifier">emitMemcmpCall</span></a></a><span> </span><a name="local-6989586621680978096"><a href="#local-6989586621680978096"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978097"><a href="#local-6989586621680978097"><span class="hs-identifier">ptr1</span></a></a><span> </span><a name="local-6989586621680978098"><a href="#local-6989586621680978098"><span class="hs-identifier">ptr2</span></a></a><span> </span><a name="local-6989586621680978099"><a href="#local-6989586621680978099"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680978100"><a href="#local-6989586621680978100"><span class="hs-identifier">align</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2483"></a><span>    </span><span class="hs-comment">-- 'MO_Memcmp' is assumed to return an 32bit 'CInt' because all</span><span>
</span><a name="line-2484"></a><span>    </span><span class="hs-comment">-- code-gens currently call out to the @memcmp(3)@ C function.</span><span>
</span><a name="line-2485"></a><span>    </span><span class="hs-comment">-- This was easier than moving the sign-extensions into</span><span>
</span><a name="line-2486"></a><span>    </span><span class="hs-comment">-- all the code-gens.</span><span>
</span><a name="line-2487"></a><span>    </span><a name="local-6989586621680978101"><a href="#local-6989586621680978101"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2488"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680978102"><a href="#local-6989586621680978102"><span class="hs-identifier">is32Bit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">typeWidth</span><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#localRegType"><span class="hs-identifier hs-var">localRegType</span></a><span> </span><a href="#local-6989586621680978096"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">W32</span><span>
</span><a name="line-2489"></a><span>
</span><a name="line-2490"></a><span>    </span><a name="local-6989586621680978103"><a href="#local-6989586621680978103"><span class="hs-identifier">cres</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680978102"><span class="hs-identifier hs-var">is32Bit</span></a><span>
</span><a name="line-2491"></a><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621680978096"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-2492"></a><span>              </span><span class="hs-keyword">else</span><span> </span><a href="StgCmmUtils.html#newTemp"><span class="hs-identifier hs-var">newTemp</span></a><span> </span><span class="hs-identifier hs-var">b32</span><span>
</span><a name="line-2493"></a><span>
</span><a name="line-2494"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2495"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978103"><span class="hs-identifier hs-var">cres</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2496"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Memcmp"><span class="hs-identifier hs-var">MO_Memcmp</span></a><span> </span><a href="#local-6989586621680978100"><span class="hs-identifier hs-var">align</span></a><span class="hs-special">)</span><span>
</span><a name="line-2497"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978097"><span class="hs-identifier hs-var">ptr1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978098"><span class="hs-identifier hs-var">ptr2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978099"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2498"></a><span>
</span><a name="line-2499"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621680978102"><span class="hs-identifier hs-var">is32Bit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2500"></a><span>      </span><a href="StgCmmMonad.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MkGraph.html#mkAssign"><span class="hs-identifier hs-var">mkAssign</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680978096"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-2501"></a><span>                      </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a><span>
</span><a name="line-2502"></a><span>                         </span><span class="hs-special">(</span><a href="CmmMachOp.html#mo_s_32ToWord"><span class="hs-identifier hs-var">mo_s_32ToWord</span></a><span> </span><a href="#local-6989586621680978101"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-2503"></a><span>                         </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CmmExpr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a><span> </span><a href="#local-6989586621680978103"><span class="hs-identifier hs-var">cres</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2504"></a><span>
</span><a name="line-2505"></a><span class="hs-identifier">emitBSwapCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2506"></a><a name="emitBSwapCall"><a href="StgCmmPrim.html#emitBSwapCall"><span class="hs-identifier">emitBSwapCall</span></a></a><span> </span><a name="local-6989586621680978104"><a href="#local-6989586621680978104"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978105"><a href="#local-6989586621680978105"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978106"><a href="#local-6989586621680978106"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2507"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2508"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978104"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2509"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_BSwap"><span class="hs-identifier hs-var">MO_BSwap</span></a><span> </span><a href="#local-6989586621680978106"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2510"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978105"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2511"></a><span>
</span><a name="line-2512"></a><span class="hs-identifier">emitPopCntCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2513"></a><a name="emitPopCntCall"><a href="StgCmmPrim.html#emitPopCntCall"><span class="hs-identifier">emitPopCntCall</span></a></a><span> </span><a name="local-6989586621680978107"><a href="#local-6989586621680978107"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978108"><a href="#local-6989586621680978108"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978109"><a href="#local-6989586621680978109"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2514"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2515"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978107"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2516"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_PopCnt"><span class="hs-identifier hs-var">MO_PopCnt</span></a><span> </span><a href="#local-6989586621680978109"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2517"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978108"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2518"></a><span>
</span><a name="line-2519"></a><span class="hs-identifier">emitPdepCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2520"></a><a name="emitPdepCall"><a href="StgCmmPrim.html#emitPdepCall"><span class="hs-identifier">emitPdepCall</span></a></a><span> </span><a name="local-6989586621680978110"><a href="#local-6989586621680978110"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978111"><a href="#local-6989586621680978111"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978112"><a href="#local-6989586621680978112"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621680978113"><a href="#local-6989586621680978113"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2521"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2522"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978110"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2523"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Pdep"><span class="hs-identifier hs-var">MO_Pdep</span></a><span> </span><a href="#local-6989586621680978113"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2524"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978111"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978112"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2525"></a><span>
</span><a name="line-2526"></a><span class="hs-identifier">emitPextCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2527"></a><a name="emitPextCall"><a href="StgCmmPrim.html#emitPextCall"><span class="hs-identifier">emitPextCall</span></a></a><span> </span><a name="local-6989586621680978114"><a href="#local-6989586621680978114"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978115"><a href="#local-6989586621680978115"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978116"><a href="#local-6989586621680978116"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621680978117"><a href="#local-6989586621680978117"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2528"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2529"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978114"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2530"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Pext"><span class="hs-identifier hs-var">MO_Pext</span></a><span> </span><a href="#local-6989586621680978117"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2531"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978115"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680978116"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2532"></a><span>
</span><a name="line-2533"></a><span class="hs-identifier">emitClzCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2534"></a><a name="emitClzCall"><a href="StgCmmPrim.html#emitClzCall"><span class="hs-identifier">emitClzCall</span></a></a><span> </span><a name="local-6989586621680978118"><a href="#local-6989586621680978118"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978119"><a href="#local-6989586621680978119"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978120"><a href="#local-6989586621680978120"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2535"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2536"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978118"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2537"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Clz"><span class="hs-identifier hs-var">MO_Clz</span></a><span> </span><a href="#local-6989586621680978120"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2538"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978119"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2539"></a><span>
</span><a name="line-2540"></a><span class="hs-identifier">emitCtzCall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CmmExpr.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CmmExpr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Width</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="StgCmmMonad.html#FCode"><span class="hs-identifier hs-type">FCode</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2541"></a><a name="emitCtzCall"><a href="StgCmmPrim.html#emitCtzCall"><span class="hs-identifier">emitCtzCall</span></a></a><span> </span><a name="local-6989586621680978121"><a href="#local-6989586621680978121"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621680978122"><a href="#local-6989586621680978122"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680978123"><a href="#local-6989586621680978123"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2542"></a><span>    </span><a href="StgCmmForeign.html#emitPrimCall"><span class="hs-identifier hs-var">emitPrimCall</span></a><span>
</span><a name="line-2543"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978121"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2544"></a><span>        </span><span class="hs-special">(</span><a href="CmmMachOp.html#MO_Ctz"><span class="hs-identifier hs-var">MO_Ctz</span></a><span> </span><a href="#local-6989586621680978123"><span class="hs-identifier hs-var">width</span></a><span class="hs-special">)</span><span>
</span><a name="line-2545"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680978122"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2546"></a></pre></body></html>