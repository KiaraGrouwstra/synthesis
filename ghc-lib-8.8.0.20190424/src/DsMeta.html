<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- The purpose of this module is to transform an HsExpr into a CoreExpr which</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- when evaluated, returns a (Meta.Q Meta.Exp) computation analogous to the</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- input HsExpr. We do this in the DsM monad, which supplies access to</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- CoreExpr's of the &quot;smart constructors&quot; of the Meta.Exp datatype.</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- It also defines a bunch of knownKeyNames, in the same way as is done</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- in prelude/PrelNames.  It's much more convenient to do it here, because</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- otherwise we have to recompile PrelNames whenever we add a Name, which is</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- a Royal Pain (triggers other recompilation).</span><span>
</span><a name="line-18"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">DsMeta</span><span class="hs-special">(</span><span> </span><a href="DsMeta.html#dsBracket"><span class="hs-identifier hs-var">dsBracket</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span>   </span><a href="DsExpr.html"><span class="hs-identifier">DsExpr</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="DsExpr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="MatchLit.html"><span class="hs-identifier">MatchLit</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="DsMonad.html"><span class="hs-identifier">DsMonad</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Language.Haskell.TH</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TH</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsSyn</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">PrelNames</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- To avoid clashes with DsMeta.varName we must make a local alias for</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- OccName.varName we do this by removing varName from the import of</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- OccName above, making a qualified instance of OccName and using</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- OccNameAlias.varName where varName ws previously used in this file.</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">OccName</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isDataOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isVarOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isTcOcc</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Module</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Id</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-keyword">hiding</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isVarOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isTcOcc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">varName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tcName</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="THNames.html"><span class="hs-identifier">THNames</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">NameEnv</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">NameSet</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcType</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCon</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreSyn</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MkCore</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreUtils</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BasicTypes</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Bag</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FastString</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ForeignCall</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Maybes</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MonadUtils</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">unpack</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-70"></a><span class="hs-identifier">dsBracket</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsBracket</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">PendingTcSplice</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-identifier hs-type">CoreExpr</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- Returns a CoreExpr of type TH.ExpQ</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- The quoted thing is parameterised over Name, even though it has</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- been type checked.  We don't want all those type decorations!</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><a name="dsBracket"><a href="DsMeta.html#dsBracket"><span class="hs-identifier">dsBracket</span></a></a><span> </span><a name="local-6989586621681882484"><a href="#local-6989586621681882484"><span class="hs-identifier">brack</span></a></a><span> </span><a name="local-6989586621681882485"><a href="#local-6989586621681882485"><span class="hs-identifier">splices</span></a></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#dsExtendMetaEnv"><span class="hs-identifier hs-var">dsExtendMetaEnv</span></a><span> </span><a href="#local-6989586621681882486"><span class="hs-identifier hs-var">new_bit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882487"><span class="hs-identifier hs-var">do_brack</span></a><span> </span><a href="#local-6989586621681882484"><span class="hs-identifier hs-var">brack</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>    </span><a name="local-6989586621681882486"><a href="#local-6989586621681882486"><span class="hs-identifier">new_bit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNameEnv</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882488"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">DsSplice</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882489"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">PendingTcSplice</span><span> </span><a name="local-6989586621681882488"><a href="#local-6989586621681882488"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681882489"><a href="#local-6989586621681882489"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882485"><span class="hs-identifier hs-var">splices</span></a><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>    </span><a name="local-6989586621681882487"><a href="#local-6989586621681882487"><span class="hs-identifier">do_brack</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarBr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882490"><a href="#local-6989586621681882490"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882491"><a href="#local-6989586621681882491"><span class="hs-identifier">e1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><a href="#local-6989586621681882490"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882491"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExpBr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882492"><a href="#local-6989586621681882492"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882493"><a href="#local-6989586621681882493"><span class="hs-identifier">e1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681882492"><span class="hs-identifier hs-var">e</span></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882493"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882494"><a href="#local-6989586621681882494"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882495"><a href="#local-6989586621681882495"><span class="hs-identifier">p1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTopP"><span class="hs-identifier hs-var">repTopP</span></a><span> </span><a href="#local-6989586621681882494"><span class="hs-identifier hs-var">p</span></a><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882495"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypBr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882496"><a href="#local-6989586621681882496"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882497"><a href="#local-6989586621681882497"><span class="hs-identifier">t1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882496"><span class="hs-identifier hs-var">t</span></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882497"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DecBrG</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882498"><a href="#local-6989586621681882498"><span class="hs-identifier">gp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882499"><a href="#local-6989586621681882499"><span class="hs-identifier">ds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTopDs"><span class="hs-identifier hs-var">repTopDs</span></a><span> </span><a href="#local-6989586621681882498"><span class="hs-identifier hs-var">gp</span></a><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882499"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DecBrL</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;dsBracket: unexpected DecBrL&quot;</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TExpBr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882500"><a href="#local-6989586621681882500"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882501"><a href="#local-6989586621681882501"><span class="hs-identifier">e1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681882500"><span class="hs-identifier hs-var">e</span></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882501"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-identifier">do_brack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XBracket</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;dsBracket: unexpected XBracket&quot;</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">{- -------------- Examples --------------------

  [| \x -&gt; x |]
====&gt;
  gensym (unpackString &quot;x&quot;#) `bindQ` \ x1::String -&gt;
  lam (pvar x1) (var x1)


  [| \x -&gt; $(f [| x |]) |]
====&gt;
  gensym (unpackString &quot;x&quot;#) `bindQ` \ x1::String -&gt;
  lam (pvar x1) (f (var x1))
-}</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-106"></a><span class="hs-comment">--                      Declarations</span><span>
</span><a name="line-107"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-identifier">repTopP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><a name="repTopP"><a href="DsMeta.html#repTopP"><span class="hs-identifier">repTopP</span></a></a><span> </span><a name="local-6989586621681882502"><a href="#local-6989586621681882502"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882503"><a href="#local-6989586621681882503"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">collectPatBinders</span><span> </span><a href="#local-6989586621681882502"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>                 </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882504"><a href="#local-6989586621681882504"><span class="hs-identifier">pat'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882503"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681882502"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>                 </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882503"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681882504"><span class="hs-identifier hs-var">pat'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-identifier">repTopDs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsGroup</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Dec</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><a name="repTopDs"><a href="DsMeta.html#repTopDs"><span class="hs-identifier">repTopDs</span></a></a><span> </span><a name="local-6989586621681882505"><a href="#local-6989586621681882505"><span class="hs-identifier">group</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsGroup</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hs_valds</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882506"><a href="#local-6989586621681882506"><span class="hs-identifier">valds</span></a></a><span>
</span><a name="line-116"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_splcds</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882507"><a href="#local-6989586621681882507"><span class="hs-identifier">splcds</span></a></a><span>
</span><a name="line-117"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_tyclds</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882508"><a href="#local-6989586621681882508"><span class="hs-identifier">tyclds</span></a></a><span>
</span><a name="line-118"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_derivds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882509"><a href="#local-6989586621681882509"><span class="hs-identifier">derivds</span></a></a><span>
</span><a name="line-119"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_fixds</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882510"><a href="#local-6989586621681882510"><span class="hs-identifier">fixds</span></a></a><span>
</span><a name="line-120"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_defds</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882511"><a href="#local-6989586621681882511"><span class="hs-identifier">defds</span></a></a><span>
</span><a name="line-121"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_fords</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882512"><a href="#local-6989586621681882512"><span class="hs-identifier">fords</span></a></a><span>
</span><a name="line-122"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_warnds</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882513"><a href="#local-6989586621681882513"><span class="hs-identifier">warnds</span></a></a><span>
</span><a name="line-123"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_annds</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882514"><a href="#local-6989586621681882514"><span class="hs-identifier">annds</span></a></a><span>
</span><a name="line-124"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_ruleds</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882515"><a href="#local-6989586621681882515"><span class="hs-identifier">ruleds</span></a></a><span>
</span><a name="line-125"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_docs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882516"><a href="#local-6989586621681882516"><span class="hs-identifier">docs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882527"><a href="#local-6989586621681882527"><span class="hs-identifier">bndrs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#hsScopedTvBinders"><span class="hs-identifier hs-var">hsScopedTvBinders</span></a><span> </span><a href="#local-6989586621681882506"><span class="hs-identifier hs-var">valds</span></a><span>
</span><a name="line-127"></a><span>                       </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">hsGroupBinders</span><span> </span><a href="#local-6989586621681882505"><span class="hs-identifier hs-var">group</span></a><span>
</span><a name="line-128"></a><span>                       </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">hsPatSynSelectors</span><span> </span><a href="#local-6989586621681882506"><span class="hs-identifier hs-var">valds</span></a><span>
</span><a name="line-129"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882528"><a href="#local-6989586621681882528"><span class="hs-identifier">instds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882508"><span class="hs-identifier hs-var">tyclds</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier">group_instds</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-130"></a><span>        </span><a name="local-6989586621681882529"><a href="#local-6989586621681882529"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681882527"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>        </span><span class="hs-comment">-- Bind all the names mainly to avoid repeated use of explicit strings.</span><span>
</span><a name="line-133"></a><span>        </span><span class="hs-comment">-- Thus we get</span><span>
</span><a name="line-134"></a><span>        </span><span class="hs-comment">--      do { t :: String &lt;- genSym &quot;T&quot; ;</span><span>
</span><a name="line-135"></a><span>        </span><span class="hs-comment">--           return (Data t [] ...more t's... }</span><span>
</span><a name="line-136"></a><span>        </span><span class="hs-comment">-- The other important reason is that the output must mention</span><span>
</span><a name="line-137"></a><span>        </span><span class="hs-comment">-- only &quot;T&quot;, not &quot;Foo:T&quot; where Foo is the current module</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>        </span><a name="local-6989586621681882539"><a href="#local-6989586621681882539"><span class="hs-identifier">decls</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882529"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-140"></a><span>                  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882530"><a href="#local-6989586621681882530"><span class="hs-identifier">val_ds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_val_binds"><span class="hs-identifier hs-var">rep_val_binds</span></a><span> </span><a href="#local-6989586621681882506"><span class="hs-identifier hs-var">valds</span></a><span>
</span><a name="line-141"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882517"><span class="hs-identifier hs-var">no_splice</span></a><span> </span><a href="#local-6989586621681882507"><span class="hs-identifier hs-var">splcds</span></a><span>
</span><a name="line-142"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882531"><a href="#local-6989586621681882531"><span class="hs-identifier">tycl_ds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repTyClD"><span class="hs-identifier hs-var">repTyClD</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tyClGroupTyClDecls</span><span> </span><a href="#local-6989586621681882508"><span class="hs-identifier hs-var">tyclds</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882532"><a href="#local-6989586621681882532"><span class="hs-identifier">role_ds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repRoleD"><span class="hs-identifier hs-var">repRoleD</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-identifier">group_roles</span><span> </span><a href="#local-6989586621681882508"><span class="hs-identifier hs-var">tyclds</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882533"><a href="#local-6989586621681882533"><span class="hs-identifier">inst_ds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repInstD"><span class="hs-identifier hs-var">repInstD</span></a><span> </span><a href="#local-6989586621681882528"><span class="hs-identifier hs-var">instds</span></a><span>
</span><a name="line-145"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882534"><a href="#local-6989586621681882534"><span class="hs-identifier">deriv_ds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repStandaloneDerivD"><span class="hs-identifier hs-var">repStandaloneDerivD</span></a><span> </span><a href="#local-6989586621681882509"><span class="hs-identifier hs-var">derivds</span></a><span>
</span><a name="line-146"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882535"><a href="#local-6989586621681882535"><span class="hs-identifier">fix_ds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repFixD"><span class="hs-identifier hs-var">repFixD</span></a><span> </span><a href="#local-6989586621681882510"><span class="hs-identifier hs-var">fixds</span></a><span>
</span><a name="line-147"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882518"><span class="hs-identifier hs-var">no_default_decl</span></a><span> </span><a href="#local-6989586621681882511"><span class="hs-identifier hs-var">defds</span></a><span>
</span><a name="line-148"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882536"><a href="#local-6989586621681882536"><span class="hs-identifier">for_ds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repForD"><span class="hs-identifier hs-var">repForD</span></a><span> </span><a href="#local-6989586621681882512"><span class="hs-identifier hs-var">fords</span></a><span>
</span><a name="line-149"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882519"><span class="hs-identifier hs-var">no_warn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wd_warnings</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>                                                           </span><a href="#local-6989586621681882513"><span class="hs-identifier hs-var">warnds</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882537"><a href="#local-6989586621681882537"><span class="hs-identifier">ann_ds</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repAnnD"><span class="hs-identifier hs-var">repAnnD</span></a><span> </span><a href="#local-6989586621681882514"><span class="hs-identifier hs-var">annds</span></a><span>
</span><a name="line-152"></a><span>                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882538"><a href="#local-6989586621681882538"><span class="hs-identifier">rule_ds</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repRuleD"><span class="hs-identifier hs-var">repRuleD</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rds_rules</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>                                                            </span><a href="#local-6989586621681882515"><span class="hs-identifier hs-var">ruleds</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882520"><span class="hs-identifier hs-var">no_doc</span></a><span> </span><a href="#local-6989586621681882516"><span class="hs-identifier hs-var">docs</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span>                        </span><span class="hs-comment">-- more needed</span><span>
</span><a name="line-157"></a><span>                     </span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#de_loc"><span class="hs-identifier hs-var">de_loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#sort_by_loc"><span class="hs-identifier hs-var">sort_by_loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-158"></a><span>                                </span><a href="#local-6989586621681882530"><span class="hs-identifier hs-var">val_ds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><a href="#local-6989586621681882531"><span class="hs-identifier hs-var">tycl_ds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882532"><span class="hs-identifier hs-var">role_ds</span></a><span>
</span><a name="line-159"></a><span>                                       </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621681882535"><span class="hs-identifier hs-var">fix_ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>                                       </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882533"><span class="hs-identifier hs-var">inst_ds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882538"><span class="hs-identifier hs-var">rule_ds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882536"><span class="hs-identifier hs-var">for_ds</span></a><span>
</span><a name="line-161"></a><span>                                       </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882537"><span class="hs-identifier hs-var">ann_ds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882534"><span class="hs-identifier hs-var">deriv_ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>        </span><a name="local-6989586621681882540"><a href="#local-6989586621681882540"><span class="hs-identifier">decl_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-164"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882541"><a href="#local-6989586621681882541"><span class="hs-identifier">core_list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreList%27"><span class="hs-identifier hs-var">coreList'</span></a><span> </span><a href="#local-6989586621681882540"><span class="hs-identifier hs-var">decl_ty</span></a><span> </span><a href="#local-6989586621681882539"><span class="hs-identifier hs-var">decls</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>        </span><a name="local-6989586621681882542"><a href="#local-6989586621681882542"><span class="hs-identifier">dec_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="THNames.html#decTyConName"><span class="hs-identifier hs-var">decTyConName</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-167"></a><span>        </span><a name="local-6989586621681882543"><a href="#local-6989586621681882543"><span class="hs-identifier">q_decs</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSequenceQ"><span class="hs-identifier hs-var">repSequenceQ</span></a><span> </span><a href="#local-6989586621681882542"><span class="hs-identifier hs-var">dec_ty</span></a><span> </span><a href="#local-6989586621681882541"><span class="hs-identifier hs-var">core_list</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>        </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882529"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681882543"><span class="hs-identifier hs-var">q_decs</span></a><span>
</span><a name="line-170"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-172"></a><span>    </span><a name="local-6989586621681882517"><a href="#local-6989586621681882517"><span class="hs-identifier">no_splice</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882521"><a href="#local-6989586621681882521"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandledL"><span class="hs-identifier hs-var">notHandledL</span></a><span> </span><a href="#local-6989586621681882521"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-string">&quot;Splices within declaration brackets&quot;</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-174"></a><span>    </span><a name="local-6989586621681882518"><a href="#local-6989586621681882518"><span class="hs-identifier">no_default_decl</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882522"><a href="#local-6989586621681882522"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681882523"><a href="#local-6989586621681882523"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandledL"><span class="hs-identifier hs-var">notHandledL</span></a><span> </span><a href="#local-6989586621681882522"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-string">&quot;Default declarations&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882523"><span class="hs-identifier hs-var">decl</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>    </span><a name="local-6989586621681882519"><a href="#local-6989586621681882519"><span class="hs-identifier">no_warn</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882524"><a href="#local-6989586621681882524"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Warning</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882525"><a href="#local-6989586621681882525"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandledL"><span class="hs-identifier hs-var">notHandledL</span></a><span> </span><a href="#local-6989586621681882524"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-string">&quot;WARNING and DEPRECATION pragmas&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-178"></a><span>                    </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Pragma for declaration of&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882525"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier">no_warn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTopDs&quot;</span><span>
</span><a name="line-180"></a><span>    </span><a name="local-6989586621681882520"><a href="#local-6989586621681882520"><span class="hs-identifier">no_doc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882526"><a href="#local-6989586621681882526"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandledL"><span class="hs-identifier hs-var">notHandledL</span></a><span> </span><a href="#local-6989586621681882526"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-string">&quot;Haddock documentation&quot;</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-182"></a><span class="hs-identifier">repTopDs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsGroup</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTopDs&quot;</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-identifier">hsScopedTvBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsValBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- See Note [Scoped type variables in bindings]</span><span>
</span><a name="line-186"></a><a name="hsScopedTvBinders"><a href="DsMeta.html#hsScopedTvBinders"><span class="hs-identifier">hsScopedTvBinders</span></a></a><span> </span><a name="local-6989586621681882544"><a href="#local-6989586621681882544"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-187"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="DsMeta.html#get_scoped_tvs"><span class="hs-identifier hs-var">get_scoped_tvs</span></a><span> </span><a href="#local-6989586621681882545"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-188"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span>    </span><a name="local-6989586621681882545"><a href="#local-6989586621681882545"><span class="hs-identifier">sigs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882544"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-190"></a><span>             </span><span class="hs-identifier hs-var">ValBinds</span><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882546"><a href="#local-6989586621681882546"><span class="hs-identifier">sigs</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681882546"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-191"></a><span>             </span><span class="hs-identifier hs-var">XValBindsLR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NValBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882547"><a href="#local-6989586621681882547"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681882547"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-identifier">get_scoped_tvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-194"></a><a name="get_scoped_tvs"><a href="DsMeta.html#get_scoped_tvs"><span class="hs-identifier">get_scoped_tvs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-keyword">signature</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882554"><a href="#local-6989586621681882554"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">signature</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882549"><span class="hs-identifier hs-var">get_scoped_tvs_from_sig</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621681882554"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ClassOpSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882555"><a href="#local-6989586621681882555"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">signature</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882549"><span class="hs-identifier hs-var">get_scoped_tvs_from_sig</span></a><span> </span><a href="#local-6989586621681882555"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">PatSynSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882556"><a href="#local-6989586621681882556"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">signature</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882549"><span class="hs-identifier hs-var">get_scoped_tvs_from_sig</span></a><span> </span><a href="#local-6989586621681882556"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-201"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>    </span><a name="local-6989586621681882549"><a href="#local-6989586621681882549"><span class="hs-identifier">get_scoped_tvs_from_sig</span></a></a><span> </span><a name="local-6989586621681882550"><a href="#local-6989586621681882550"><span class="hs-identifier">sig</span></a></a><span>
</span><a name="line-205"></a><span>      </span><span class="hs-comment">-- Both implicit and explicit quantified variables</span><span>
</span><a name="line-206"></a><span>      </span><span class="hs-comment">-- We need the implicit ones for   f :: forall (a::k). blah</span><span>
</span><a name="line-207"></a><span>      </span><span class="hs-comment">--    here 'k' scopes too</span><span>
</span><a name="line-208"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882551"><a href="#local-6989586621681882551"><span class="hs-identifier">implicit_vars</span></a></a><span>
</span><a name="line-209"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882552"><a href="#local-6989586621681882552"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882550"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-210"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882553"><a href="#local-6989586621681882553"><span class="hs-identifier">explicit_vars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitLHsForAllTy</span><span> </span><a href="#local-6989586621681882552"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-211"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882551"><span class="hs-identifier hs-var">implicit_vars</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">hsLTyVarName</span><span> </span><a href="#local-6989586621681882553"><span class="hs-identifier hs-var">explicit_vars</span></a><span>
</span><a name="line-212"></a><span>    </span><span class="hs-identifier">get_scoped_tvs_from_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;get_scoped_tvs_from_sig&quot;</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">{- Notes

Note [Scoped type variables in bindings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
   f :: forall a. a -&gt; a
   f x = x::a
Here the 'forall a' brings 'a' into scope over the binding group.
To achieve this we

  a) Gensym a binding for 'a' at the same time as we do one for 'f'
     collecting the relevant binders with hsScopedTvBinders

  b) When processing the 'forall', don't gensym

The relevant places are signposted with references to this Note

Note [Scoped type variables in class and instance declarations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Scoped type variables may occur in default methods and default
signatures. We need to bring the type variables in 'foralls'
into the scope of the method bindings.

Consider
   class Foo a where
     foo :: forall (b :: k). a -&gt; Proxy b -&gt; Proxy b
     foo _ x = (x :: Proxy b)

We want to ensure that the 'b' in the type signature and the default
implementation are the same, so we do the following:

  a) Before desugaring the signature and binding of 'foo', use
     get_scoped_tvs to collect type variables in 'forall' and
     create symbols for them.
  b) Use 'addBinds' to bring these symbols into the scope of the type
     signatures and bindings.
  c) Use these symbols to generate Core for the class/instance declaration.

Note that when desugaring the signatures, we lookup the type variables
from the scope rather than recreate symbols for them. See more details
in &quot;rep_ty_sig&quot; and in Trac#14885.

Note [Binders and occurrences]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When we desugar [d| data T = MkT |]
we want to get
        Data &quot;T&quot; [] [Con &quot;MkT&quot; []] []
and *not*
        Data &quot;Foo:T&quot; [] [Con &quot;Foo:MkT&quot; []] []
That is, the new data decl should fit into whatever new module it is
asked to fit in.   We do *not* clone, though; no need for this:
        Data &quot;T79&quot; ....

But if we see this:
        data T = MkT
        foo = reifyDecl T

then we must desugar to
        foo = Data &quot;Foo:T&quot; [] [Con &quot;Foo:MkT&quot; []] []

So in repTopDs we bring the binders into scope with mkGenSyms and addBinds.
And we use lookupOcc, rather than lookupBinder
in repTyClD and repC.

Note [Don't quantify implicit type variables in quotes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If you're not careful, it's suprisingly easy to take this quoted declaration:

  [d| idProxy :: forall proxy (b :: k). proxy b -&gt; proxy b
      idProxy x = x
    |]

and have Template Haskell turn it into this:

  idProxy :: forall k proxy (b :: k). proxy b -&gt; proxy b
  idProxy x = x

Notice that we explicitly quantified the variable `k`! The latter declaration
isn't what the user wrote in the first place.

Usually, the culprit behind these bugs is taking implicitly quantified type
variables (often from the hsib_vars field of HsImplicitBinders) and putting
them into a `ForallT` or `ForallC`. Doing so caused #13018 and #13123.
-}</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">-- represent associated family instances</span><span>
</span><a name="line-301"></a><span class="hs-comment">--</span><span>
</span><a name="line-302"></a><span class="hs-identifier">repTyClD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LTyClDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><a name="repTyClD"><a href="DsMeta.html#repTyClD"><span class="hs-identifier">repTyClD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882557"><a href="#local-6989586621681882557"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882558"><a href="#local-6989586621681882558"><span class="hs-identifier">fam</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-305"></a><span>                                                  </span><a href="DsMeta.html#repFamilyDecl"><span class="hs-identifier hs-var">repFamilyDecl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621681882557"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621681882558"><span class="hs-identifier hs-var">fam</span></a><span class="hs-special">)</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-identifier">repTyClD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882559"><a href="#local-6989586621681882559"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SynDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882560"><a href="#local-6989586621681882560"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882561"><a href="#local-6989586621681882561"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882562"><a href="#local-6989586621681882562"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882563"><a href="#local-6989586621681882563"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882560"><span class="hs-identifier hs-var">tc</span></a><span>           </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-309"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882565"><a href="#local-6989586621681882565"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882561"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681882564"><a href="#local-6989586621681882564"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-310"></a><span>                </span><a href="DsMeta.html#repSynDecl"><span class="hs-identifier hs-var">repSynDecl</span></a><span> </span><a href="#local-6989586621681882563"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-6989586621681882564"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882562"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-311"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882559"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882565"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">repTyClD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882566"><a href="#local-6989586621681882566"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882567"><a href="#local-6989586621681882567"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-314"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882568"><a href="#local-6989586621681882568"><span class="hs-identifier">tvs</span></a></a><span>
</span><a name="line-315"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882569"><a href="#local-6989586621681882569"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882570"><a href="#local-6989586621681882570"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882567"><span class="hs-identifier hs-var">tc</span></a><span>           </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-317"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882572"><a href="#local-6989586621681882572"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882568"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681882571"><a href="#local-6989586621681882571"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-318"></a><span>                </span><a href="DsMeta.html#repDataDefn"><span class="hs-identifier hs-var">repDataDefn</span></a><span> </span><a href="#local-6989586621681882570"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621681882571"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-319"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882566"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882572"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-identifier">repTyClD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882573"><a href="#local-6989586621681882573"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdCtxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882574"><a href="#local-6989586621681882574"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882575"><a href="#local-6989586621681882575"><span class="hs-identifier">cls</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-322"></a><span>                             </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882576"><a href="#local-6989586621681882576"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFDs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882577"><a href="#local-6989586621681882577"><span class="hs-identifier">fds</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-323"></a><span>                             </span><span class="hs-identifier">tcdSigs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882578"><a href="#local-6989586621681882578"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdMeths</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882579"><a href="#local-6989586621681882579"><span class="hs-identifier">meth_binds</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-324"></a><span>                             </span><span class="hs-identifier">tcdATs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882580"><a href="#local-6989586621681882580"><span class="hs-identifier">ats</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATDefs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882581"><a href="#local-6989586621681882581"><span class="hs-identifier">atds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882582"><a href="#local-6989586621681882582"><span class="hs-identifier">cls1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882575"><span class="hs-identifier hs-var">cls</span></a><span>         </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-326"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882592"><a href="#local-6989586621681882592"><span class="hs-identifier">dec</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addTyVarBinds"><span class="hs-identifier hs-var">addTyVarBinds</span></a><span> </span><a href="#local-6989586621681882576"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681882583"><a href="#local-6989586621681882583"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-327"></a><span>           </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882584"><a href="#local-6989586621681882584"><span class="hs-identifier">cxt1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882574"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-328"></a><span>          </span><span class="hs-comment">-- See Note [Scoped type variables in class and instance declarations]</span><span>
</span><a name="line-329"></a><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882585"><a href="#local-6989586621681882585"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882586"><a href="#local-6989586621681882586"><span class="hs-identifier">sigs_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_sigs_binds"><span class="hs-identifier hs-var">rep_sigs_binds</span></a><span> </span><a href="#local-6989586621681882578"><span class="hs-identifier hs-var">sigs</span></a><span> </span><a href="#local-6989586621681882579"><span class="hs-identifier hs-var">meth_binds</span></a><span>
</span><a name="line-330"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882587"><a href="#local-6989586621681882587"><span class="hs-identifier">fds1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLFunDeps"><span class="hs-identifier hs-var">repLFunDeps</span></a><span> </span><a href="#local-6989586621681882577"><span class="hs-identifier hs-var">fds</span></a><span>
</span><a name="line-331"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882588"><a href="#local-6989586621681882588"><span class="hs-identifier">ats1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFamilyDecls"><span class="hs-identifier hs-var">repFamilyDecls</span></a><span> </span><a href="#local-6989586621681882580"><span class="hs-identifier hs-var">ats</span></a><span>
</span><a name="line-332"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882589"><a href="#local-6989586621681882589"><span class="hs-identifier">atds1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repAssocTyFamDefaults"><span class="hs-identifier hs-var">repAssocTyFamDefaults</span></a><span> </span><a href="#local-6989586621681882581"><span class="hs-identifier hs-var">atds</span></a><span>
</span><a name="line-333"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882590"><a href="#local-6989586621681882590"><span class="hs-identifier">decls1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882588"><span class="hs-identifier hs-var">ats1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882589"><span class="hs-identifier hs-var">atds1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882586"><span class="hs-identifier hs-var">sigs_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882591"><a href="#local-6989586621681882591"><span class="hs-identifier">decls2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repClass"><span class="hs-identifier hs-var">repClass</span></a><span> </span><a href="#local-6989586621681882584"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><a href="#local-6989586621681882582"><span class="hs-identifier hs-var">cls1</span></a><span> </span><a href="#local-6989586621681882583"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882587"><span class="hs-identifier hs-var">fds1</span></a><span> </span><a href="#local-6989586621681882590"><span class="hs-identifier hs-var">decls1</span></a><span>
</span><a name="line-335"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882585"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681882591"><span class="hs-identifier hs-var">decls2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-336"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882573"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882592"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-337"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-identifier">repTyClD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyClD&quot;</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-342"></a><span class="hs-identifier">repRoleD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LRoleAnnotDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-343"></a><a name="repRoleD"><a href="DsMeta.html#repRoleD"><span class="hs-identifier">repRoleD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882593"><a href="#local-6989586621681882593"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RoleAnnotDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882594"><a href="#local-6989586621681882594"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621681882595"><a href="#local-6989586621681882595"><span class="hs-identifier">roles</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-344"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882596"><a href="#local-6989586621681882596"><span class="hs-identifier">tycon1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882594"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-345"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882597"><a href="#local-6989586621681882597"><span class="hs-identifier">roles1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repRole"><span class="hs-identifier hs-var">repRole</span></a><span> </span><a href="#local-6989586621681882595"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-346"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882598"><a href="#local-6989586621681882598"><span class="hs-identifier">roles2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#roleTyConName"><span class="hs-identifier hs-var">roleTyConName</span></a><span> </span><a href="#local-6989586621681882597"><span class="hs-identifier hs-var">roles1</span></a><span>
</span><a name="line-347"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882599"><a href="#local-6989586621681882599"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repRoleAnnotD"><span class="hs-identifier hs-var">repRoleAnnotD</span></a><span> </span><a href="#local-6989586621681882596"><span class="hs-identifier hs-var">tycon1</span></a><span> </span><a href="#local-6989586621681882598"><span class="hs-identifier hs-var">roles2</span></a><span>
</span><a name="line-348"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882593"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882599"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-349"></a><span class="hs-identifier">repRoleD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repRoleD&quot;</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-352"></a><span class="hs-identifier">repDataDefn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-353"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>                        </span><span class="hs-comment">-- the repTyClD case</span><span>
</span><a name="line-355"></a><span>                      </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>                        </span><span class="hs-comment">-- the repDataFamInstD case</span><span>
</span><a name="line-357"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsDataDefn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-358"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-359"></a><a name="repDataDefn"><a href="DsMeta.html#repDataDefn"><span class="hs-identifier">repDataDefn</span></a></a><span> </span><a name="local-6989586621681882600"><a href="#local-6989586621681882600"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681882601"><a href="#local-6989586621681882601"><span class="hs-identifier">opts</span></a></a><span>
</span><a name="line-360"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882602"><a href="#local-6989586621681882602"><span class="hs-identifier">new_or_data</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882603"><a href="#local-6989586621681882603"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882604"><a href="#local-6989586621681882604"><span class="hs-identifier">ksig</span></a></a><span>
</span><a name="line-361"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882605"><a href="#local-6989586621681882605"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882606"><a href="#local-6989586621681882606"><span class="hs-identifier">mb_derivs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882607"><a href="#local-6989586621681882607"><span class="hs-identifier">cxt1</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882603"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-363"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882608"><a href="#local-6989586621681882608"><span class="hs-identifier">derivs1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDerivs"><span class="hs-identifier hs-var">repDerivs</span></a><span> </span><a href="#local-6989586621681882606"><span class="hs-identifier hs-var">mb_derivs</span></a><span>
</span><a name="line-364"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882602"><span class="hs-identifier hs-var">new_or_data</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882605"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-365"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewType</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681882609"><a href="#local-6989586621681882609"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882610"><a href="#local-6989586621681882610"><span class="hs-identifier">con'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repC"><span class="hs-identifier hs-var">repC</span></a><span> </span><a href="#local-6989586621681882609"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-366"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882611"><a href="#local-6989586621681882611"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMaybeLTy"><span class="hs-identifier hs-var">repMaybeLTy</span></a><span> </span><a href="#local-6989586621681882604"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-367"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repNewtype"><span class="hs-identifier hs-var">repNewtype</span></a><span> </span><a href="#local-6989586621681882607"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><a href="#local-6989586621681882600"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681882601"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621681882611"><span class="hs-identifier hs-var">ksig'</span></a><span> </span><a href="#local-6989586621681882610"><span class="hs-identifier hs-var">con'</span></a><span>
</span><a name="line-368"></a><span>                                                </span><a href="#local-6989586621681882608"><span class="hs-identifier hs-var">derivs1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-369"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NewType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#failWithDs"><span class="hs-identifier hs-var">failWithDs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Multiple constructors for newtype:&quot;</span><span>
</span><a name="line-370"></a><span>                                       </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">pprQuotedList</span><span>
</span><a name="line-371"></a><span>                                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getConNames</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621681882605"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882612"><a href="#local-6989586621681882612"><span class="hs-identifier">ksig'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMaybeLTy"><span class="hs-identifier hs-var">repMaybeLTy</span></a><span> </span><a href="#local-6989586621681882604"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-373"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882613"><a href="#local-6989586621681882613"><span class="hs-identifier">consL</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repC"><span class="hs-identifier hs-var">repC</span></a><span> </span><a href="#local-6989586621681882605"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-374"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882614"><a href="#local-6989586621681882614"><span class="hs-identifier">cons1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#conQTyConName"><span class="hs-identifier hs-var">conQTyConName</span></a><span> </span><a href="#local-6989586621681882613"><span class="hs-identifier hs-var">consL</span></a><span>
</span><a name="line-375"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repData"><span class="hs-identifier hs-var">repData</span></a><span> </span><a href="#local-6989586621681882607"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><a href="#local-6989586621681882600"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681882601"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621681882612"><span class="hs-identifier hs-var">ksig'</span></a><span> </span><a href="#local-6989586621681882614"><span class="hs-identifier hs-var">cons1</span></a><span>
</span><a name="line-376"></a><span>                                         </span><a href="#local-6989586621681882608"><span class="hs-identifier hs-var">derivs1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-377"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-378"></a><span class="hs-identifier">repDataDefn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsDataDefn</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repDataDefn&quot;</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">repSynDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-381"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-382"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-383"></a><a name="repSynDecl"><a href="DsMeta.html#repSynDecl"><span class="hs-identifier">repSynDecl</span></a></a><span> </span><a name="local-6989586621681882615"><a href="#local-6989586621681882615"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681882616"><a href="#local-6989586621681882616"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621681882617"><a href="#local-6989586621681882617"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-384"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882618"><a href="#local-6989586621681882618"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882617"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-385"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTySyn"><span class="hs-identifier hs-var">repTySyn</span></a><span> </span><a href="#local-6989586621681882615"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681882616"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882618"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-identifier">repFamilyDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LFamilyDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><a name="repFamilyDecl"><a href="DsMeta.html#repFamilyDecl"><span class="hs-identifier">repFamilyDecl</span></a></a><span> </span><a name="local-6989586621681882619"><a href="#local-6989586621681882619"><span class="hs-identifier">decl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882620"><a href="#local-6989586621681882620"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamilyDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdInfo</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882621"><a href="#local-6989586621681882621"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-389"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdLName</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882622"><a href="#local-6989586621681882622"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-390"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdTyVars</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882623"><a href="#local-6989586621681882623"><span class="hs-identifier">tvs</span></a></a><span>
</span><a name="line-391"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdResultSig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882624"><a href="#local-6989586621681882624"><span class="hs-identifier">resultSig</span></a></a><span>
</span><a name="line-392"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdInjectivityAnn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882625"><a href="#local-6989586621681882625"><span class="hs-identifier">injectivity</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882626"><a href="#local-6989586621681882626"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882622"><span class="hs-identifier hs-var">tc</span></a><span>           </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-394"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">mkHsQTvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-395"></a><span>             </span><a name="local-6989586621681882627"><a href="#local-6989586621681882627"><span class="hs-identifier">mkHsQTvs</span></a></a><span> </span><a name="local-6989586621681882629"><a href="#local-6989586621681882629"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvsRn</span><span>
</span><a name="line-396"></a><span>                                                </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-397"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_dependent</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">emptyNameSet</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-398"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882629"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-399"></a><span>             </span><a name="local-6989586621681882628"><a href="#local-6989586621681882628"><span class="hs-identifier">resTyVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882624"><span class="hs-identifier hs-var">resultSig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-400"></a><span>                     </span><span class="hs-identifier hs-var">TyVarSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882630"><a href="#local-6989586621681882630"><span class="hs-identifier">bndr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681882627"><span class="hs-identifier hs-var">mkHsQTvs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882630"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">]</span><span>
</span><a name="line-401"></a><span>                     </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681882627"><span class="hs-identifier hs-var">mkHsQTvs</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-402"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882640"><a href="#local-6989586621681882640"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882623"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681882631"><a href="#local-6989586621681882631"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-403"></a><span>                </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882628"><span class="hs-identifier hs-var">resTyVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-404"></a><span>           </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882621"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-405"></a><span>             </span><span class="hs-identifier hs-var">ClosedTypeFamily</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-406"></a><span>                 </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;abstract closed type family&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882619"><span class="hs-identifier hs-var">decl</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>             </span><span class="hs-identifier hs-var">ClosedTypeFamily</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681882632"><a href="#local-6989586621681882632"><span class="hs-identifier">eqns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-408"></a><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882633"><a href="#local-6989586621681882633"><span class="hs-identifier">eqns1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTyFamEqn"><span class="hs-identifier hs-var">repTyFamEqn</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882632"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-409"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882634"><a href="#local-6989586621681882634"><span class="hs-identifier">eqns2</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#tySynEqnQTyConName"><span class="hs-identifier hs-var">tySynEqnQTyConName</span></a><span> </span><a href="#local-6989586621681882633"><span class="hs-identifier hs-var">eqns1</span></a><span>
</span><a name="line-410"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882635"><a href="#local-6989586621681882635"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFamilyResultSig"><span class="hs-identifier hs-var">repFamilyResultSig</span></a><span> </span><a href="#local-6989586621681882624"><span class="hs-identifier hs-var">resultSig</span></a><span>
</span><a name="line-411"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882636"><a href="#local-6989586621681882636"><span class="hs-identifier">inj</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repInjectivityAnn"><span class="hs-identifier hs-var">repInjectivityAnn</span></a><span> </span><a href="#local-6989586621681882625"><span class="hs-identifier hs-var">injectivity</span></a><span>
</span><a name="line-412"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repClosedFamilyD"><span class="hs-identifier hs-var">repClosedFamilyD</span></a><span> </span><a href="#local-6989586621681882626"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-6989586621681882631"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882635"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621681882636"><span class="hs-identifier hs-var">inj</span></a><span> </span><a href="#local-6989586621681882634"><span class="hs-identifier hs-var">eqns2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-413"></a><span>             </span><span class="hs-identifier hs-var">OpenTypeFamily</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-414"></a><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882637"><a href="#local-6989586621681882637"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFamilyResultSig"><span class="hs-identifier hs-var">repFamilyResultSig</span></a><span> </span><a href="#local-6989586621681882624"><span class="hs-identifier hs-var">resultSig</span></a><span>
</span><a name="line-415"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882638"><a href="#local-6989586621681882638"><span class="hs-identifier">inj</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repInjectivityAnn"><span class="hs-identifier hs-var">repInjectivityAnn</span></a><span> </span><a href="#local-6989586621681882625"><span class="hs-identifier hs-var">injectivity</span></a><span>
</span><a name="line-416"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repOpenFamilyD"><span class="hs-identifier hs-var">repOpenFamilyD</span></a><span> </span><a href="#local-6989586621681882626"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-6989586621681882631"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882637"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621681882638"><span class="hs-identifier hs-var">inj</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-417"></a><span>             </span><span class="hs-identifier hs-var">DataFamily</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-418"></a><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882639"><a href="#local-6989586621681882639"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFamilyResultSigToMaybeKind"><span class="hs-identifier hs-var">repFamilyResultSigToMaybeKind</span></a><span> </span><a href="#local-6989586621681882624"><span class="hs-identifier hs-var">resultSig</span></a><span>
</span><a name="line-419"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repDataFamilyD"><span class="hs-identifier hs-var">repDataFamilyD</span></a><span> </span><a href="#local-6989586621681882626"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-6989586621681882631"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681882639"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-420"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882620"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882640"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-422"></a><span class="hs-identifier">repFamilyDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repFamilyDecl&quot;</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">-- | Represent result signature of a type family</span><span>
</span><a name="line-425"></a><span class="hs-identifier">repFamilyResultSig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span class="hs-special">)</span><span>
</span><a name="line-426"></a><a name="repFamilyResultSig"><a href="DsMeta.html#repFamilyResultSig"><span class="hs-identifier">repFamilyResultSig</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoSig</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repNoSig"><span class="hs-identifier hs-var">repNoSig</span></a><span>
</span><a name="line-427"></a><span class="hs-identifier">repFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">KindSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882641"><a href="#local-6989586621681882641"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882642"><a href="#local-6989586621681882642"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882641"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-428"></a><span>                                          </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repKindSig"><span class="hs-identifier hs-var">repKindSig</span></a><span> </span><a href="#local-6989586621681882642"><span class="hs-identifier hs-var">ki'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-429"></a><span class="hs-identifier">repFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyVarSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882643"><a href="#local-6989586621681882643"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882644"><a href="#local-6989586621681882644"><span class="hs-identifier">bndr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTyVarBndr"><span class="hs-identifier hs-var">repTyVarBndr</span></a><span> </span><a href="#local-6989586621681882643"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-430"></a><span>                                          </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyVarSig"><span class="hs-identifier hs-var">repTyVarSig</span></a><span> </span><a href="#local-6989586621681882644"><span class="hs-identifier hs-var">bndr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-431"></a><span class="hs-identifier">repFamilyResultSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XFamilyResultSig</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repFamilyResultSig&quot;</span><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">-- | Represent result signature using a Maybe Kind. Used with data families,</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- where the result signature can be either missing or a kind but never a named</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- result variable.</span><span>
</span><a name="line-436"></a><span class="hs-identifier">repFamilyResultSigToMaybeKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-437"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-438"></a><a name="repFamilyResultSigToMaybeKind"><a href="DsMeta.html#repFamilyResultSigToMaybeKind"><span class="hs-identifier">repFamilyResultSigToMaybeKind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoSig</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-439"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#coreNothing"><span class="hs-identifier hs-var">coreNothing</span></a><span> </span><a href="THNames.html#kindQTyConName"><span class="hs-identifier hs-var">kindQTyConName</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-440"></a><span class="hs-identifier">repFamilyResultSigToMaybeKind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">KindSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882645"><a href="#local-6989586621681882645"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-441"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882646"><a href="#local-6989586621681882646"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882645"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-442"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#coreJust"><span class="hs-identifier hs-var">coreJust</span></a><span> </span><a href="THNames.html#kindQTyConName"><span class="hs-identifier hs-var">kindQTyConName</span></a><span> </span><a href="#local-6989586621681882646"><span class="hs-identifier hs-var">ki'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-443"></a><span class="hs-identifier">repFamilyResultSigToMaybeKind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repFamilyResultSigToMaybeKind&quot;</span><span>
</span><a name="line-444"></a><span>
</span><a name="line-445"></a><span class="hs-comment">-- | Represent injectivity annotation of a type family</span><span>
</span><a name="line-446"></a><span class="hs-identifier">repInjectivityAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LInjectivityAnn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-447"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.InjectivityAnn</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-448"></a><a name="repInjectivityAnn"><a href="DsMeta.html#repInjectivityAnn"><span class="hs-identifier">repInjectivityAnn</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-449"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#coreNothing"><span class="hs-identifier hs-var">coreNothing</span></a><span> </span><a href="THNames.html#injAnnTyConName"><span class="hs-identifier hs-var">injAnnTyConName</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-450"></a><span class="hs-identifier">repInjectivityAnn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InjectivityAnn</span><span> </span><a name="local-6989586621681882647"><a href="#local-6989586621681882647"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621681882648"><a href="#local-6989586621681882648"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882649"><a href="#local-6989586621681882649"><span class="hs-identifier">lhs'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882647"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-452"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882650"><a href="#local-6989586621681882650"><span class="hs-identifier">rhs1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882648"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-453"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882651"><a href="#local-6989586621681882651"><span class="hs-identifier">rhs2</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><a href="#local-6989586621681882650"><span class="hs-identifier hs-var">rhs1</span></a><span>
</span><a name="line-454"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882652"><a href="#local-6989586621681882652"><span class="hs-identifier">injAnn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#injectivityAnnName"><span class="hs-identifier hs-var">injectivityAnnName</span></a><span> </span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882649"><span class="hs-identifier hs-var">lhs'</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882651"><span class="hs-identifier hs-var">rhs2</span></a><span class="hs-special">]</span><span>
</span><a name="line-455"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#coreJust"><span class="hs-identifier hs-var">coreJust</span></a><span> </span><a href="THNames.html#injAnnTyConName"><span class="hs-identifier hs-var">injAnnTyConName</span></a><span> </span><a href="#local-6989586621681882652"><span class="hs-identifier hs-var">injAnn</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-identifier">repFamilyDecls</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LFamilyDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span>
</span><a name="line-458"></a><a name="repFamilyDecls"><a href="DsMeta.html#repFamilyDecls"><span class="hs-identifier">repFamilyDecls</span></a></a><span> </span><a name="local-6989586621681882653"><a href="#local-6989586621681882653"><span class="hs-identifier">fds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="DsMeta.html#de_loc"><span class="hs-identifier hs-var">de_loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repFamilyDecl"><span class="hs-identifier hs-var">repFamilyDecl</span></a><span> </span><a href="#local-6989586621681882653"><span class="hs-identifier hs-var">fds</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-identifier">repAssocTyFamDefaults</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LTyFamDefltEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span>
</span><a name="line-461"></a><a name="repAssocTyFamDefaults"><a href="DsMeta.html#repAssocTyFamDefaults"><span class="hs-identifier">repAssocTyFamDefaults</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882654"><span class="hs-identifier hs-var">rep_deflt</span></a><span>
</span><a name="line-462"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>     </span><span class="hs-comment">-- very like repTyFamEqn, but different in the details</span><span>
</span><a name="line-464"></a><span>    </span><span class="hs-identifier">rep_deflt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LTyFamDefltEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>    </span><a name="local-6989586621681882654"><a href="#local-6989586621681882654"><span class="hs-identifier">rep_deflt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882656"><a href="#local-6989586621681882656"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-466"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882657"><a href="#local-6989586621681882657"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-467"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882658"><a href="#local-6989586621681882658"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-468"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882659"><a href="#local-6989586621681882659"><span class="hs-identifier">fixity</span></a></a><span>
</span><a name="line-469"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882660"><a href="#local-6989586621681882660"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-470"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882658"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-471"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882661"><a href="#local-6989586621681882661"><span class="hs-identifier">tc1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882656"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-472"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882662"><a href="#local-6989586621681882662"><span class="hs-identifier">no_bndrs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">bndrs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-473"></a><span>                         </span><a href="DsMeta.html#coreNothingList"><span class="hs-identifier hs-var">coreNothingList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span>
</span><a name="line-474"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882663"><a href="#local-6989586621681882663"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsLTyVarBndrsToTypes</span><span> </span><a href="#local-6989586621681882658"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882669"><a href="#local-6989586621681882669"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882659"><span class="hs-identifier hs-var">fixity</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-476"></a><span>                      </span><span class="hs-identifier hs-var">Prefix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882664"><a href="#local-6989586621681882664"><span class="hs-identifier">head_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repNamedTyCon"><span class="hs-identifier hs-var">repNamedTyCon</span></a><span> </span><a href="#local-6989586621681882661"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-477"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681882664"><span class="hs-identifier hs-var">head_ty</span></a><span> </span><a href="#local-6989586621681882663"><span class="hs-identifier hs-var">tys1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-478"></a><span>                      </span><span class="hs-identifier hs-var">Infix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882665"><a href="#local-6989586621681882665"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621681882666"><a href="#local-6989586621681882666"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621681882667"><a href="#local-6989586621681882667"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882655"><span class="hs-identifier hs-var">checkTys</span></a><span> </span><a href="#local-6989586621681882663"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-479"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882668"><a href="#local-6989586621681882668"><span class="hs-identifier">head_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTInfix"><span class="hs-identifier hs-var">repTInfix</span></a><span> </span><a href="#local-6989586621681882665"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621681882661"><span class="hs-identifier hs-var">tc1</span></a><span> </span><a href="#local-6989586621681882666"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-480"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681882668"><span class="hs-identifier hs-var">head_ty</span></a><span> </span><a href="#local-6989586621681882667"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-481"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882670"><a href="#local-6989586621681882670"><span class="hs-identifier">rhs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882660"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-482"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882671"><a href="#local-6989586621681882671"><span class="hs-identifier">eqn1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTySynEqn"><span class="hs-identifier hs-var">repTySynEqn</span></a><span> </span><a href="#local-6989586621681882662"><span class="hs-identifier hs-var">no_bndrs</span></a><span> </span><a href="#local-6989586621681882669"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621681882670"><span class="hs-identifier hs-var">rhs1</span></a><span>
</span><a name="line-483"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTySynInst"><span class="hs-identifier hs-var">repTySynInst</span></a><span> </span><a href="#local-6989586621681882671"><span class="hs-identifier hs-var">eqn1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-484"></a><span>    </span><span class="hs-identifier">rep_deflt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repAssocTyFamDefaults&quot;</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span>    </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">]</span><span>
</span><a name="line-487"></a><span>    </span><a name="local-6989586621681882655"><a href="#local-6989586621681882655"><span class="hs-identifier">checkTys</span></a></a><span> </span><a name="local-6989586621681882672"><a href="#local-6989586621681882672"><span class="hs-identifier">tys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882672"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-488"></a><span>    </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repAssocTyFamDefaults:checkTys&quot;</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-491"></a><span class="hs-comment">-- represent fundeps</span><span>
</span><a name="line-492"></a><span class="hs-comment">--</span><span>
</span><a name="line-493"></a><span class="hs-identifier">repLFunDeps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsFunDep</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.FunDep</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-494"></a><a name="repLFunDeps"><a href="DsMeta.html#repLFunDeps"><span class="hs-identifier">repLFunDeps</span></a></a><span> </span><a name="local-6989586621681882673"><a href="#local-6989586621681882673"><span class="hs-identifier">fds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#funDepTyConName"><span class="hs-identifier hs-var">funDepTyConName</span></a><span> </span><a href="DsMeta.html#repLFunDep"><span class="hs-identifier hs-var">repLFunDep</span></a><span> </span><a href="#local-6989586621681882673"><span class="hs-identifier hs-var">fds</span></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-identifier">repLFunDep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsFunDep</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FunDep</span><span class="hs-special">)</span><span>
</span><a name="line-497"></a><a name="repLFunDep"><a href="DsMeta.html#repLFunDep"><span class="hs-identifier">repLFunDep</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882674"><a href="#local-6989586621681882674"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882675"><a href="#local-6989586621681882675"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681882676"><a href="#local-6989586621681882676"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882674"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-499"></a><span>        </span><a name="local-6989586621681882677"><a href="#local-6989586621681882677"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882675"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-500"></a><span>        </span><a href="DsMeta.html#repFunDep"><span class="hs-identifier hs-var">repFunDep</span></a><span> </span><a href="#local-6989586621681882676"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621681882677"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-comment">-- Represent instance declarations</span><span>
</span><a name="line-503"></a><span class="hs-comment">--</span><span>
</span><a name="line-504"></a><span class="hs-identifier">repInstD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-505"></a><a name="repInstD"><a href="DsMeta.html#repInstD"><span class="hs-identifier">repInstD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882678"><a href="#local-6989586621681882678"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyFamInstD</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882679"><a href="#local-6989586621681882679"><span class="hs-identifier">fi_decl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882680"><a href="#local-6989586621681882680"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTyFamInstD"><span class="hs-identifier hs-var">repTyFamInstD</span></a><span> </span><a href="#local-6989586621681882679"><span class="hs-identifier hs-var">fi_decl</span></a><span>
</span><a name="line-507"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882678"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882680"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-508"></a><span class="hs-identifier">repInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882681"><a href="#local-6989586621681882681"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstD</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882682"><a href="#local-6989586621681882682"><span class="hs-identifier">fi_decl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882683"><a href="#local-6989586621681882683"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDataFamInstD"><span class="hs-identifier hs-var">repDataFamInstD</span></a><span> </span><a href="#local-6989586621681882682"><span class="hs-identifier hs-var">fi_decl</span></a><span>
</span><a name="line-510"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882681"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882683"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-511"></a><span class="hs-identifier">repInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882684"><a href="#local-6989586621681882684"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClsInstD</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882685"><a href="#local-6989586621681882685"><span class="hs-identifier">cls_decl</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882686"><a href="#local-6989586621681882686"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repClsInstD"><span class="hs-identifier hs-var">repClsInstD</span></a><span> </span><a href="#local-6989586621681882685"><span class="hs-identifier hs-var">cls_decl</span></a><span>
</span><a name="line-513"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882684"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882686"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-514"></a><span class="hs-identifier">repInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repInstD&quot;</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">repClsInstD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ClsInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-517"></a><a name="repClsInstD"><a href="DsMeta.html#repClsInstD"><span class="hs-identifier">repClsInstD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClsInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_poly_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882687"><a href="#local-6989586621681882687"><span class="hs-identifier">ty</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882688"><a href="#local-6989586621681882688"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-518"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_sigs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882689"><a href="#local-6989586621681882689"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_tyfam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882690"><a href="#local-6989586621681882690"><span class="hs-identifier">ats</span></a></a><span>
</span><a name="line-519"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882691"><a href="#local-6989586621681882691"><span class="hs-identifier">adts</span></a></a><span>
</span><a name="line-520"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cid_overlap_mode</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882692"><a href="#local-6989586621681882692"><span class="hs-identifier">overlap</span></a></a><span>
</span><a name="line-521"></a><span>                         </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-522"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addSimpleTyVarBinds"><span class="hs-identifier hs-var">addSimpleTyVarBinds</span></a><span> </span><a href="#local-6989586621681882693"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-523"></a><span>            </span><span class="hs-comment">-- We must bring the type variables into scope, so their</span><span>
</span><a name="line-524"></a><span>            </span><span class="hs-comment">-- occurrences don't fail, even though the binders don't</span><span>
</span><a name="line-525"></a><span>            </span><span class="hs-comment">-- appear in the resulting data structure</span><span>
</span><a name="line-526"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-527"></a><span>            </span><span class="hs-comment">-- But we do NOT bring the binders of 'binds' into scope</span><span>
</span><a name="line-528"></a><span>            </span><span class="hs-comment">-- because they are properly regarded as occurrences</span><span>
</span><a name="line-529"></a><span>            </span><span class="hs-comment">-- For example, the method names should be bound to</span><span>
</span><a name="line-530"></a><span>            </span><span class="hs-comment">-- the selector Ids, not to fresh names (Trac #5410)</span><span>
</span><a name="line-531"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-532"></a><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882696"><a href="#local-6989586621681882696"><span class="hs-identifier">cxt1</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882694"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-533"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882697"><a href="#local-6989586621681882697"><span class="hs-identifier">inst_ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882695"><span class="hs-identifier hs-var">inst_ty</span></a><span>
</span><a name="line-534"></a><span>          </span><span class="hs-comment">-- See Note [Scoped type variables in class and instance declarations]</span><span>
</span><a name="line-535"></a><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882698"><a href="#local-6989586621681882698"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882699"><a href="#local-6989586621681882699"><span class="hs-identifier">sigs_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_sigs_binds"><span class="hs-identifier hs-var">rep_sigs_binds</span></a><span> </span><a href="#local-6989586621681882689"><span class="hs-identifier hs-var">sigs</span></a><span> </span><a href="#local-6989586621681882688"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-536"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882700"><a href="#local-6989586621681882700"><span class="hs-identifier">ats1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTyFamInstD"><span class="hs-identifier hs-var">repTyFamInstD</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882690"><span class="hs-identifier hs-var">ats</span></a><span>
</span><a name="line-537"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882701"><a href="#local-6989586621681882701"><span class="hs-identifier">adts1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repDataFamInstD"><span class="hs-identifier hs-var">repDataFamInstD</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882691"><span class="hs-identifier hs-var">adts</span></a><span>
</span><a name="line-538"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882702"><a href="#local-6989586621681882702"><span class="hs-identifier">decls1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882700"><span class="hs-identifier hs-var">ats1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882701"><span class="hs-identifier hs-var">adts1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882699"><span class="hs-identifier hs-var">sigs_binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882703"><a href="#local-6989586621681882703"><span class="hs-identifier">rOver</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repOverlap"><span class="hs-identifier hs-var">repOverlap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882692"><span class="hs-identifier hs-var">overlap</span></a><span class="hs-special">)</span><span>
</span><a name="line-540"></a><span>               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882704"><a href="#local-6989586621681882704"><span class="hs-identifier">decls2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repInst"><span class="hs-identifier hs-var">repInst</span></a><span> </span><a href="#local-6989586621681882703"><span class="hs-identifier hs-var">rOver</span></a><span> </span><a href="#local-6989586621681882696"><span class="hs-identifier hs-var">cxt1</span></a><span> </span><a href="#local-6989586621681882697"><span class="hs-identifier hs-var">inst_ty1</span></a><span> </span><a href="#local-6989586621681882702"><span class="hs-identifier hs-var">decls1</span></a><span>
</span><a name="line-541"></a><span>               </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882698"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681882704"><span class="hs-identifier hs-var">decls2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-542"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-543"></a><span>   </span><span class="hs-special">(</span><a name="local-6989586621681882693"><a href="#local-6989586621681882693"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882694"><a href="#local-6989586621681882694"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882695"><a href="#local-6989586621681882695"><span class="hs-identifier">inst_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitLHsInstDeclTy</span><span> </span><a href="#local-6989586621681882687"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-544"></a><span class="hs-identifier">repClsInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XClsInstDecl</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repClsInstD&quot;</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-identifier">repStandaloneDerivD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LDerivDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-547"></a><a name="repStandaloneDerivD"><a href="DsMeta.html#repStandaloneDerivD"><span class="hs-identifier">repStandaloneDerivD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882705"><a href="#local-6989586621681882705"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DerivDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">deriv_strategy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882706"><a href="#local-6989586621681882706"><span class="hs-identifier">strat</span></a></a><span>
</span><a name="line-548"></a><span>                                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">deriv_type</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882707"><a href="#local-6989586621681882707"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-549"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882714"><a href="#local-6989586621681882714"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addSimpleTyVarBinds"><span class="hs-identifier hs-var">addSimpleTyVarBinds</span></a><span> </span><a href="#local-6989586621681882708"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-550"></a><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882711"><a href="#local-6989586621681882711"><span class="hs-identifier">cxt'</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882709"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-551"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882712"><a href="#local-6989586621681882712"><span class="hs-identifier">strat'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDerivStrategy"><span class="hs-identifier hs-var">repDerivStrategy</span></a><span> </span><a href="#local-6989586621681882706"><span class="hs-identifier hs-var">strat</span></a><span>
</span><a name="line-552"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882713"><a href="#local-6989586621681882713"><span class="hs-identifier">inst_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882710"><span class="hs-identifier hs-var">inst_ty</span></a><span>
</span><a name="line-553"></a><span>                   </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repDeriv"><span class="hs-identifier hs-var">repDeriv</span></a><span> </span><a href="#local-6989586621681882712"><span class="hs-identifier hs-var">strat'</span></a><span> </span><a href="#local-6989586621681882711"><span class="hs-identifier hs-var">cxt'</span></a><span> </span><a href="#local-6989586621681882713"><span class="hs-identifier hs-var">inst_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-554"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882705"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882714"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-555"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-556"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621681882708"><a href="#local-6989586621681882708"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882709"><a href="#local-6989586621681882709"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882710"><a href="#local-6989586621681882710"><span class="hs-identifier">inst_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitLHsInstDeclTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWildCards</span><span> </span><a href="#local-6989586621681882707"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span class="hs-identifier">repStandaloneDerivD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repStandaloneDerivD&quot;</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-identifier">repTyFamInstD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-560"></a><a name="repTyFamInstD"><a href="DsMeta.html#repTyFamInstD"><span class="hs-identifier">repTyFamInstD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyFamInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882715"><a href="#local-6989586621681882715"><span class="hs-identifier">eqn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882716"><a href="#local-6989586621681882716"><span class="hs-identifier">eqn1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTyFamEqn"><span class="hs-identifier hs-var">repTyFamEqn</span></a><span> </span><a href="#local-6989586621681882715"><span class="hs-identifier hs-var">eqn</span></a><span>
</span><a name="line-562"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTySynInst"><span class="hs-identifier hs-var">repTySynInst</span></a><span> </span><a href="#local-6989586621681882716"><span class="hs-identifier hs-var">eqn1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-identifier">repTyFamEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyFamInstEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TySynEqnQ</span><span class="hs-special">)</span><span>
</span><a name="line-565"></a><a name="repTyFamEqn"><a href="DsMeta.html#repTyFamEqn"><span class="hs-identifier">repTyFamEqn</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882717"><a href="#local-6989586621681882717"><span class="hs-identifier">var_names</span></a></a><span>
</span><a name="line-566"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882718"><a href="#local-6989586621681882718"><span class="hs-identifier">tc_name</span></a></a><span>
</span><a name="line-567"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882719"><a href="#local-6989586621681882719"><span class="hs-identifier">mb_bndrs</span></a></a><span>
</span><a name="line-568"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882720"><a href="#local-6989586621681882720"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-569"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882721"><a href="#local-6989586621681882721"><span class="hs-identifier">fixity</span></a></a><span>
</span><a name="line-570"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882722"><a href="#local-6989586621681882722"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-571"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882725"><a href="#local-6989586621681882725"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882718"><span class="hs-identifier hs-var">tc_name</span></a><span>     </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-572"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882726"><a href="#local-6989586621681882726"><span class="hs-identifier">hs_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvsRn</span><span>
</span><a name="line-573"></a><span>                               </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882717"><span class="hs-identifier hs-var">var_names</span></a><span>
</span><a name="line-574"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_dependent</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">emptyNameSet</span><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-comment">-- Yuk</span><span>
</span><a name="line-575"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621681882719"><span class="hs-identifier hs-var">mb_bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-576"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882726"><span class="hs-identifier hs-var">hs_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-577"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882727"><a href="#local-6989586621681882727"><span class="hs-identifier">mb_bndrs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMaybeList"><span class="hs-identifier hs-var">repMaybeList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span>
</span><a name="line-578"></a><span>                                        </span><a href="DsMeta.html#repTyVarBndr"><span class="hs-identifier hs-var">repTyVarBndr</span></a><span>
</span><a name="line-579"></a><span>                                        </span><a href="#local-6989586621681882719"><span class="hs-identifier hs-var">mb_bndrs</span></a><span>
</span><a name="line-580"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882733"><a href="#local-6989586621681882733"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882721"><span class="hs-identifier hs-var">fixity</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-581"></a><span>                        </span><span class="hs-identifier hs-var">Prefix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repNamedTyCon"><span class="hs-identifier hs-var">repNamedTyCon</span></a><span> </span><a href="#local-6989586621681882725"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882720"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-582"></a><span>                        </span><span class="hs-identifier hs-var">Infix</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621681882728"><a href="#local-6989586621681882728"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621681882729"><a href="#local-6989586621681882729"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681882730"><a href="#local-6989586621681882730"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882723"><span class="hs-identifier hs-var">checkTys</span></a><span> </span><a href="#local-6989586621681882720"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-583"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882731"><a href="#local-6989586621681882731"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882728"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-584"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882732"><a href="#local-6989586621681882732"><span class="hs-identifier">t2'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882729"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-585"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTInfix"><span class="hs-identifier hs-var">repTInfix</span></a><span> </span><a href="#local-6989586621681882731"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621681882725"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681882732"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882730"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-586"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882734"><a href="#local-6989586621681882734"><span class="hs-identifier">rhs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882722"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-587"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTySynEqn"><span class="hs-identifier hs-var">repTySynEqn</span></a><span> </span><a href="#local-6989586621681882727"><span class="hs-identifier hs-var">mb_bndrs1</span></a><span> </span><a href="#local-6989586621681882733"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-6989586621681882734"><span class="hs-identifier hs-var">rhs1</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-588"></a><span>     </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span>
</span><a name="line-589"></a><span>           </span><a name="local-6989586621681882723"><a href="#local-6989586621681882723"><span class="hs-identifier">checkTys</span></a></a><span> </span><a name="local-6989586621681882724"><a href="#local-6989586621681882724"><span class="hs-identifier">tys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882724"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-590"></a><span>           </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyFamEqn:checkTys&quot;</span><span>
</span><a name="line-591"></a><span class="hs-identifier">repTyFamEqn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyFamEqn&quot;</span><span>
</span><a name="line-592"></a><span class="hs-identifier">repTyFamEqn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XFamEqn</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyFamEqn&quot;</span><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span class="hs-identifier">repTyArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><a name="repTyArgs"><a href="DsMeta.html#repTyArgs"><span class="hs-identifier">repTyArgs</span></a></a><span> </span><a name="local-6989586621681882735"><a href="#local-6989586621681882735"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882735"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-596"></a><span class="hs-identifier">repTyArgs</span><span> </span><a name="local-6989586621681882736"><a href="#local-6989586621681882736"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621681882737"><a href="#local-6989586621681882737"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882739"><a href="#local-6989586621681882739"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882736"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-597"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882740"><a href="#local-6989586621681882740"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882737"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-598"></a><span>                                    </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681882739"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621681882740"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-599"></a><span class="hs-identifier">repTyArgs</span><span> </span><a name="local-6989586621681882741"><a href="#local-6989586621681882741"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882742"><a href="#local-6989586621681882742"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882744"><a href="#local-6989586621681882744"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882741"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-600"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882745"><a href="#local-6989586621681882745"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882742"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-601"></a><span>                                       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTappKind"><span class="hs-identifier hs-var">repTappKind</span></a><span> </span><a href="#local-6989586621681882744"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621681882745"><span class="hs-identifier hs-var">ki'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-602"></a><span class="hs-identifier">repTyArgs</span><span> </span><a name="local-6989586621681882746"><a href="#local-6989586621681882746"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><a href="#local-6989586621681882746"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-identifier">repDataFamInstD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DataFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-605"></a><a name="repDataFamInstD"><a href="DsMeta.html#repDataFamInstD"><span class="hs-identifier">repDataFamInstD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_eqn</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-606"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882748"><a href="#local-6989586621681882748"><span class="hs-identifier">var_names</span></a></a><span>
</span><a name="line-607"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882749"><a href="#local-6989586621681882749"><span class="hs-identifier">tc_name</span></a></a><span>
</span><a name="line-608"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882750"><a href="#local-6989586621681882750"><span class="hs-identifier">mb_bndrs</span></a></a><span>
</span><a name="line-609"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882751"><a href="#local-6989586621681882751"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-610"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882752"><a href="#local-6989586621681882752"><span class="hs-identifier">fixity</span></a></a><span>
</span><a name="line-611"></a><span>                                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882753"><a href="#local-6989586621681882753"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882756"><a href="#local-6989586621681882756"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882749"><span class="hs-identifier hs-var">tc_name</span></a><span>         </span><span class="hs-comment">-- See note [Binders and occurrences]</span><span>
</span><a name="line-613"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882757"><a href="#local-6989586621681882757"><span class="hs-identifier">hs_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvsRn</span><span>
</span><a name="line-614"></a><span>                                 </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882748"><span class="hs-identifier hs-var">var_names</span></a><span>
</span><a name="line-615"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_dependent</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">emptyNameSet</span><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-comment">-- Yuk</span><span>
</span><a name="line-616"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621681882750"><span class="hs-identifier hs-var">mb_bndrs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-617"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier hs-var">addTyClTyVarBinds</span></a><span> </span><a href="#local-6989586621681882757"><span class="hs-identifier hs-var">hs_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-618"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882758"><a href="#local-6989586621681882758"><span class="hs-identifier">mb_bndrs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMaybeList"><span class="hs-identifier hs-var">repMaybeList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span>
</span><a name="line-619"></a><span>                                        </span><a href="DsMeta.html#repTyVarBndr"><span class="hs-identifier hs-var">repTyVarBndr</span></a><span>
</span><a name="line-620"></a><span>                                        </span><a href="#local-6989586621681882750"><span class="hs-identifier hs-var">mb_bndrs</span></a><span>
</span><a name="line-621"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882764"><a href="#local-6989586621681882764"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882752"><span class="hs-identifier hs-var">fixity</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-622"></a><span>                        </span><span class="hs-identifier hs-var">Prefix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repNamedTyCon"><span class="hs-identifier hs-var">repNamedTyCon</span></a><span> </span><a href="#local-6989586621681882756"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882751"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-623"></a><span>                        </span><span class="hs-identifier hs-var">Infix</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621681882759"><a href="#local-6989586621681882759"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621681882760"><a href="#local-6989586621681882760"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681882761"><a href="#local-6989586621681882761"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882754"><span class="hs-identifier hs-var">checkTys</span></a><span> </span><a href="#local-6989586621681882751"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-624"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882762"><a href="#local-6989586621681882762"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882759"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-625"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882763"><a href="#local-6989586621681882763"><span class="hs-identifier">t2'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882760"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-626"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyArgs"><span class="hs-identifier hs-var">repTyArgs</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repTInfix"><span class="hs-identifier hs-var">repTInfix</span></a><span> </span><a href="#local-6989586621681882762"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621681882756"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681882763"><span class="hs-identifier hs-var">t2'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882761"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-627"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repDataDefn"><span class="hs-identifier hs-var">repDataDefn</span></a><span> </span><a href="#local-6989586621681882756"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882758"><span class="hs-identifier hs-var">mb_bndrs1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882764"><span class="hs-identifier hs-var">tys1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882753"><span class="hs-identifier hs-var">defn</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTypeArg</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span>
</span><a name="line-630"></a><span>            </span><a name="local-6989586621681882754"><a href="#local-6989586621681882754"><span class="hs-identifier">checkTys</span></a></a><span> </span><a name="local-6989586621681882755"><a href="#local-6989586621681882755"><span class="hs-identifier">tys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">HsValArg</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882755"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-631"></a><span>            </span><span class="hs-identifier">checkTys</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repDataFamInstD:checkTys&quot;</span><span>
</span><a name="line-632"></a><span>
</span><a name="line-633"></a><span class="hs-identifier">repDataFamInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repDataFamInstD&quot;</span><span>
</span><a name="line-635"></a><span class="hs-identifier">repDataFamInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XFamEqn</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repDataFamInstD&quot;</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-identifier">repForD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ForeignDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-639"></a><a name="repForD"><a href="DsMeta.html#repForD"><span class="hs-identifier">repForD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882765"><a href="#local-6989586621681882765"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForeignImport</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882766"><a href="#local-6989586621681882766"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882767"><a href="#local-6989586621681882767"><span class="hs-identifier">typ</span></a></a><span>
</span><a name="line-640"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fi</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CImport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882768"><a href="#local-6989586621681882768"><span class="hs-identifier">cc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-641"></a><span>                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882769"><a href="#local-6989586621681882769"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681882770"><a href="#local-6989586621681882770"><span class="hs-identifier">mch</span></a></a><span> </span><a name="local-6989586621681882771"><a href="#local-6989586621681882771"><span class="hs-identifier">cis</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882779"><a href="#local-6989586621681882779"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882766"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-643"></a><span>      </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882780"><a href="#local-6989586621681882780"><span class="hs-identifier">typ'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repHsSigType"><span class="hs-identifier hs-var">repHsSigType</span></a><span> </span><a href="#local-6989586621681882767"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-644"></a><span>      </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882781"><a href="#local-6989586621681882781"><span class="hs-identifier">cc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repCCallConv"><span class="hs-identifier hs-var">repCCallConv</span></a><span> </span><a href="#local-6989586621681882768"><span class="hs-identifier hs-var">cc</span></a><span>
</span><a name="line-645"></a><span>      </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882782"><a href="#local-6989586621681882782"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSafety"><span class="hs-identifier hs-var">repSafety</span></a><span> </span><a href="#local-6989586621681882769"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-646"></a><span>      </span><a name="local-6989586621681882783"><a href="#local-6989586621681882783"><span class="hs-identifier">cis'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882772"><span class="hs-identifier hs-var">conv_cimportspec</span></a><span> </span><a href="#local-6989586621681882771"><span class="hs-identifier hs-var">cis</span></a><span>
</span><a name="line-647"></a><span>      </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882784"><a href="#local-6989586621681882784"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882774"><span class="hs-identifier hs-var">static</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882775"><span class="hs-identifier hs-var">chStr</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882783"><span class="hs-identifier hs-var">cis'</span></a><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>      </span><a name="local-6989586621681882785"><a href="#local-6989586621681882785"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#forImpDName"><span class="hs-identifier hs-var">forImpDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882781"><span class="hs-identifier hs-var">cc'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882782"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882784"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882779"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882780"><span class="hs-identifier hs-var">typ'</span></a><span class="hs-special">]</span><span>
</span><a name="line-649"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882765"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882785"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span>
</span><a name="line-650"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-651"></a><span>    </span><a name="local-6989586621681882772"><a href="#local-6989586621681882772"><span class="hs-identifier">conv_cimportspec</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CLabel</span><span> </span><a name="local-6989586621681882776"><a href="#local-6989586621681882776"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-652"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Foreign label&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">doubleQuotes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882776"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>    </span><span class="hs-identifier">conv_cimportspec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CFunction</span><span> </span><span class="hs-identifier hs-var">DynamicTarget</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-string">&quot;dynamic&quot;</span><span>
</span><a name="line-654"></a><span>    </span><span class="hs-identifier">conv_cimportspec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StaticTarget</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882777"><a href="#local-6989586621681882777"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681882777"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>    </span><span class="hs-identifier">conv_cimportspec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StaticTarget</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;conv_cimportspec: values not supported yet&quot;</span><span>
</span><a name="line-658"></a><span>    </span><span class="hs-identifier">conv_cimportspec</span><span> </span><span class="hs-identifier hs-var">CWrapper</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-string">&quot;wrapper&quot;</span><span>
</span><a name="line-659"></a><span>    </span><span class="hs-comment">-- these calling conventions do not support headers and the static keyword</span><span>
</span><a name="line-660"></a><span>    </span><a name="local-6989586621681882773"><a href="#local-6989586621681882773"><span class="hs-identifier">raw_cconv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681882768"><span class="hs-identifier hs-var">cc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">PrimCallConv</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621681882768"><span class="hs-identifier hs-var">cc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">JavaScriptCallConv</span><span>
</span><a name="line-661"></a><span>    </span><a name="local-6989586621681882774"><a href="#local-6989586621681882774"><span class="hs-identifier">static</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882771"><span class="hs-identifier hs-var">cis</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-662"></a><span>                 </span><span class="hs-identifier hs-var">CFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StaticTarget</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621681882773"><span class="hs-identifier hs-var">raw_cconv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;static &quot;</span><span>
</span><a name="line-663"></a><span>                 </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-664"></a><span>    </span><a name="local-6989586621681882775"><a href="#local-6989586621681882775"><span class="hs-identifier">chStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882770"><span class="hs-identifier hs-var">mch</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-665"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Header</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882778"><a href="#local-6989586621681882778"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621681882773"><span class="hs-identifier hs-var">raw_cconv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681882778"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-666"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-667"></a><span class="hs-identifier">repForD</span><span> </span><a name="local-6989586621681882786"><a href="#local-6989586621681882786"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Foreign declaration&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882786"><span class="hs-identifier hs-var">decl</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-identifier">repCCallConv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CCallConv</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Callconv</span><span class="hs-special">)</span><span>
</span><a name="line-670"></a><a name="repCCallConv"><a href="DsMeta.html#repCCallConv"><span class="hs-identifier">repCCallConv</span></a></a><span> </span><span class="hs-identifier hs-var">CCallConv</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#cCallName"><span class="hs-identifier hs-var">cCallName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-671"></a><span class="hs-identifier">repCCallConv</span><span> </span><span class="hs-identifier hs-var">StdCallConv</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#stdCallName"><span class="hs-identifier hs-var">stdCallName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span class="hs-identifier">repCCallConv</span><span> </span><span class="hs-identifier hs-var">CApiConv</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#cApiCallName"><span class="hs-identifier hs-var">cApiCallName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-673"></a><span class="hs-identifier">repCCallConv</span><span> </span><span class="hs-identifier hs-var">PrimCallConv</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#primCallName"><span class="hs-identifier hs-var">primCallName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-674"></a><span class="hs-identifier">repCCallConv</span><span> </span><span class="hs-identifier hs-var">JavaScriptCallConv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#javaScriptCallName"><span class="hs-identifier hs-var">javaScriptCallName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-identifier">repSafety</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Safety</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Safety</span><span class="hs-special">)</span><span>
</span><a name="line-677"></a><a name="repSafety"><a href="DsMeta.html#repSafety"><span class="hs-identifier">repSafety</span></a></a><span> </span><span class="hs-identifier hs-var">PlayRisky</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unsafeName"><span class="hs-identifier hs-var">unsafeName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-678"></a><span class="hs-identifier">repSafety</span><span> </span><span class="hs-identifier hs-var">PlayInterruptible</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#interruptibleName"><span class="hs-identifier hs-var">interruptibleName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-679"></a><span class="hs-identifier">repSafety</span><span> </span><span class="hs-identifier hs-var">PlaySafe</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#safeName"><span class="hs-identifier hs-var">safeName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-680"></a><span>
</span><a name="line-681"></a><span class="hs-identifier">repFixD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LFixitySig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-682"></a><a name="repFixD"><a href="DsMeta.html#repFixD"><span class="hs-identifier">repFixD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882787"><a href="#local-6989586621681882787"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FixitySig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882788"><a href="#local-6989586621681882788"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Fixity</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882789"><a href="#local-6989586621681882789"><span class="hs-identifier">prec</span></a></a><span> </span><a name="local-6989586621681882790"><a href="#local-6989586621681882790"><span class="hs-identifier">dir</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882791"><a href="#local-6989586621681882791"><span class="hs-identifier">prec'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreIntLit"><span class="hs-identifier hs-var">coreIntLit</span></a><span> </span><a href="#local-6989586621681882789"><span class="hs-identifier hs-var">prec</span></a><span>
</span><a name="line-684"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882792"><a href="#local-6989586621681882792"><span class="hs-identifier">rep_fn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882790"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-685"></a><span>                        </span><span class="hs-identifier hs-var">InfixL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="THNames.html#infixLDName"><span class="hs-identifier hs-var">infixLDName</span></a><span>
</span><a name="line-686"></a><span>                        </span><span class="hs-identifier hs-var">InfixR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="THNames.html#infixRDName"><span class="hs-identifier hs-var">infixRDName</span></a><span>
</span><a name="line-687"></a><span>                        </span><span class="hs-identifier hs-var">InfixN</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="THNames.html#infixNDName"><span class="hs-identifier hs-var">infixNDName</span></a><span>
</span><a name="line-688"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882793"><a href="#local-6989586621681882793"><span class="hs-identifier">do_one</span></a></a><span> </span><a name="local-6989586621681882794"><a href="#local-6989586621681882794"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-689"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882795"><a href="#local-6989586621681882795"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882794"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-690"></a><span>                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882796"><a href="#local-6989586621681882796"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="#local-6989586621681882792"><span class="hs-identifier hs-var">rep_fn</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882791"><span class="hs-identifier hs-var">prec'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882795"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">]</span><span>
</span><a name="line-691"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882787"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><a href="#local-6989586621681882796"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-692"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681882793"><span class="hs-identifier hs-var">do_one</span></a><span> </span><a href="#local-6989586621681882788"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-693"></a><span class="hs-identifier">repFixD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repFixD&quot;</span><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-identifier">repRuleD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LRuleDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-696"></a><a name="repRuleD"><a href="DsMeta.html#repRuleD"><span class="hs-identifier">repRuleD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882797"><a href="#local-6989586621681882797"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRule</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882798"><a href="#local-6989586621681882798"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-697"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_act</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882799"><a href="#local-6989586621681882799"><span class="hs-identifier">act</span></a></a><span>
</span><a name="line-698"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_tyvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882800"><a href="#local-6989586621681882800"><span class="hs-identifier">ty_bndrs</span></a></a><span>
</span><a name="line-699"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_tmvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882801"><a href="#local-6989586621681882801"><span class="hs-identifier">tm_bndrs</span></a></a><span>
</span><a name="line-700"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882802"><a href="#local-6989586621681882802"><span class="hs-identifier">lhs</span></a></a><span>
</span><a name="line-701"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rd_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882803"><a href="#local-6989586621681882803"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882814"><a href="#local-6989586621681882814"><span class="hs-identifier">rule</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier hs-var">addHsTyVarBinds</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621681882800"><span class="hs-identifier hs-var">ty_bndrs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621681882804"><a href="#local-6989586621681882804"><span class="hs-identifier">ex_bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-703"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882805"><a href="#local-6989586621681882805"><span class="hs-identifier">tm_bndr_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="DsMeta.html#ruleBndrNames"><span class="hs-identifier hs-var">ruleBndrNames</span></a><span> </span><a href="#local-6989586621681882801"><span class="hs-identifier hs-var">tm_bndrs</span></a><span>
</span><a name="line-704"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882806"><a href="#local-6989586621681882806"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681882805"><span class="hs-identifier hs-var">tm_bndr_names</span></a><span>
</span><a name="line-705"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882813"><a href="#local-6989586621681882813"><span class="hs-identifier">rule</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882806"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-706"></a><span>                      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882807"><a href="#local-6989586621681882807"><span class="hs-identifier">ty_bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681882800"><span class="hs-identifier hs-var">ty_bndrs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-707"></a><span>                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#coreNothingList"><span class="hs-identifier hs-var">coreNothingList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span>
</span><a name="line-708"></a><span>                             </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#coreJustList"><span class="hs-identifier hs-var">coreJustList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span>
</span><a name="line-709"></a><span>                                          </span><a href="#local-6989586621681882804"><span class="hs-identifier hs-var">ex_bndrs</span></a><span>
</span><a name="line-710"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882808"><a href="#local-6989586621681882808"><span class="hs-identifier">tm_bndrs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#ruleBndrQTyConName"><span class="hs-identifier hs-var">ruleBndrQTyConName</span></a><span>
</span><a name="line-711"></a><span>                                                </span><a href="DsMeta.html#repRuleBndr"><span class="hs-identifier hs-var">repRuleBndr</span></a><span>
</span><a name="line-712"></a><span>                                                </span><a href="#local-6989586621681882801"><span class="hs-identifier hs-var">tm_bndrs</span></a><span>
</span><a name="line-713"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882809"><a href="#local-6989586621681882809"><span class="hs-identifier">n'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882798"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-714"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882810"><a href="#local-6989586621681882810"><span class="hs-identifier">act'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPhases"><span class="hs-identifier hs-var">repPhases</span></a><span> </span><a href="#local-6989586621681882799"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-715"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882811"><a href="#local-6989586621681882811"><span class="hs-identifier">lhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681882802"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-716"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882812"><a href="#local-6989586621681882812"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681882803"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-717"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPragRule"><span class="hs-identifier hs-var">repPragRule</span></a><span> </span><a href="#local-6989586621681882809"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-6989586621681882807"><span class="hs-identifier hs-var">ty_bndrs'</span></a><span> </span><a href="#local-6989586621681882808"><span class="hs-identifier hs-var">tm_bndrs'</span></a><span> </span><a href="#local-6989586621681882811"><span class="hs-identifier hs-var">lhs'</span></a><span> </span><a href="#local-6989586621681882812"><span class="hs-identifier hs-var">rhs'</span></a><span> </span><a href="#local-6989586621681882810"><span class="hs-identifier hs-var">act'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-718"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882806"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681882813"><span class="hs-identifier hs-var">rule</span></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-719"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882797"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882814"><span class="hs-identifier hs-var">rule</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-720"></a><span class="hs-identifier">repRuleD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repRuleD&quot;</span><span>
</span><a name="line-721"></a><span>
</span><a name="line-722"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LRuleBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-723"></a><a name="ruleBndrNames"><a href="DsMeta.html#ruleBndrNames"><span class="hs-identifier">ruleBndrNames</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882815"><a href="#local-6989586621681882815"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882815"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-724"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndrSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882816"><a href="#local-6989586621681882816"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681882817"><a href="#local-6989586621681882817"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">HsWC</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882818"><a href="#local-6989586621681882818"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882817"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-726"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882816"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681882818"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-727"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndrSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;ruleBndrNames&quot;</span><span>
</span><a name="line-729"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndrSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsWildCardBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;ruleBndrNames&quot;</span><span>
</span><a name="line-731"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XRuleBndr</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;ruleBndrNames&quot;</span><span>
</span><a name="line-732"></a><span class="hs-identifier">ruleBndrNames</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;ruleBndrNames: Impossible Match&quot;</span><span> </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-733"></a><span>
</span><a name="line-734"></a><span class="hs-identifier">repRuleBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LRuleBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.RuleBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-735"></a><a name="repRuleBndr"><a href="DsMeta.html#repRuleBndr"><span class="hs-identifier">repRuleBndr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882819"><a href="#local-6989586621681882819"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882820"><a href="#local-6989586621681882820"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681882819"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-737"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#ruleVarName"><span class="hs-identifier hs-var">ruleVarName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882820"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-738"></a><span class="hs-identifier">repRuleBndr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RuleBndrSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882821"><a href="#local-6989586621681882821"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681882822"><a href="#local-6989586621681882822"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882823"><a href="#local-6989586621681882823"><span class="hs-identifier">n'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681882821"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-740"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882824"><a href="#local-6989586621681882824"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsSigWcType</span><span> </span><a href="#local-6989586621681882822"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-741"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#typedRuleVarName"><span class="hs-identifier hs-var">typedRuleVarName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882823"><span class="hs-identifier hs-var">n'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882824"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-742"></a><span class="hs-identifier">repRuleBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repRuleBndr&quot;</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-identifier">repAnnD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LAnnDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-745"></a><a name="repAnnD"><a href="DsMeta.html#repAnnD"><span class="hs-identifier">repAnnD</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882825"><a href="#local-6989586621681882825"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAnnotation</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882826"><a href="#local-6989586621681882826"><span class="hs-identifier">ann_prov</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882827"><a href="#local-6989586621681882827"><span class="hs-identifier">exp</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882828"><a href="#local-6989586621681882828"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repAnnProv"><span class="hs-identifier hs-var">repAnnProv</span></a><span> </span><a href="#local-6989586621681882826"><span class="hs-identifier hs-var">ann_prov</span></a><span>
</span><a name="line-747"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882829"><a href="#local-6989586621681882829"><span class="hs-identifier">exp'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repE"><span class="hs-identifier hs-var">repE</span></a><span> </span><a href="#local-6989586621681882827"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-748"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882830"><a href="#local-6989586621681882830"><span class="hs-identifier">dec</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPragAnn"><span class="hs-identifier hs-var">repPragAnn</span></a><span> </span><a href="#local-6989586621681882828"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621681882829"><span class="hs-identifier hs-var">exp'</span></a><span>
</span><a name="line-749"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882825"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882830"><span class="hs-identifier hs-var">dec</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-750"></a><span class="hs-identifier">repAnnD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repAnnD&quot;</span><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-identifier">repAnnProv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">AnnProvenance</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.AnnTarget</span><span class="hs-special">)</span><span>
</span><a name="line-753"></a><a name="repAnnProv"><a href="DsMeta.html#repAnnProv"><span class="hs-identifier">repAnnProv</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValueAnnProvenance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882831"><a href="#local-6989586621681882831"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-754"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882832"><a href="#local-6989586621681882832"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#globalVar"><span class="hs-identifier hs-var">globalVar</span></a><span> </span><a href="#local-6989586621681882831"><span class="hs-identifier hs-var">n</span></a><span>  </span><span class="hs-comment">-- ANNs are allowed only at top-level</span><span>
</span><a name="line-755"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#valueAnnotationName"><span class="hs-identifier hs-var">valueAnnotationName</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681882832"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-756"></a><span class="hs-identifier">repAnnProv</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeAnnProvenance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882833"><a href="#local-6989586621681882833"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882834"><a href="#local-6989586621681882834"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#globalVar"><span class="hs-identifier hs-var">globalVar</span></a><span> </span><a href="#local-6989586621681882833"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-758"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#typeAnnotationName"><span class="hs-identifier hs-var">typeAnnotationName</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681882834"><span class="hs-identifier hs-var">n'</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-759"></a><span class="hs-identifier">repAnnProv</span><span> </span><span class="hs-identifier hs-var">ModuleAnnProvenance</span><span>
</span><a name="line-760"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#moduleAnnotationName"><span class="hs-identifier hs-var">moduleAnnotationName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-763"></a><span class="hs-comment">--                      Constructors</span><span>
</span><a name="line-764"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span class="hs-identifier">repC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LConDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ConQ</span><span class="hs-special">)</span><span>
</span><a name="line-767"></a><a name="repC"><a href="DsMeta.html#repC"><span class="hs-identifier">repC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclH98</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882835"><a href="#local-6989586621681882835"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-768"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-770"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882836"><a href="#local-6989586621681882836"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repDataCon"><span class="hs-identifier hs-var">repDataCon</span></a><span> </span><a href="#local-6989586621681882835"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621681882836"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span class="hs-identifier">repC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclH98</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882837"><a href="#local-6989586621681882837"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-774"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882838"><a href="#local-6989586621681882838"><span class="hs-identifier">is_existential</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-775"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882839"><a href="#local-6989586621681882839"><span class="hs-identifier">con_tvs</span></a></a><span>
</span><a name="line-776"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882840"><a href="#local-6989586621681882840"><span class="hs-identifier">mcxt</span></a></a><span>
</span><a name="line-777"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882841"><a href="#local-6989586621681882841"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier hs-var">addHsTyVarBinds</span></a><span> </span><a href="#local-6989586621681882839"><span class="hs-identifier hs-var">con_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621681882842"><a href="#local-6989586621681882842"><span class="hs-identifier">ex_bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-779"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882843"><a href="#local-6989586621681882843"><span class="hs-identifier">c'</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDataCon"><span class="hs-identifier hs-var">repDataCon</span></a><span> </span><a href="#local-6989586621681882837"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621681882841"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-780"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882844"><a href="#local-6989586621681882844"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMbContext"><span class="hs-identifier hs-var">repMbContext</span></a><span> </span><a href="#local-6989586621681882840"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-781"></a><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621681882838"><span class="hs-identifier hs-var">is_existential</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><a href="#local-6989586621681882840"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-782"></a><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882843"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-783"></a><span>              </span><span class="hs-keyword">else</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#forallCName"><span class="hs-identifier hs-var">forallCName</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882842"><span class="hs-identifier hs-var">ex_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882844"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882843"><span class="hs-identifier hs-var">c'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-785"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span class="hs-identifier">repC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDeclGADT</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_names</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882845"><a href="#local-6989586621681882845"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-788"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_qvars</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882846"><a href="#local-6989586621681882846"><span class="hs-identifier">qtvs</span></a></a><span>
</span><a name="line-789"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882847"><a href="#local-6989586621681882847"><span class="hs-identifier">mcxt</span></a></a><span>
</span><a name="line-790"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882848"><a href="#local-6989586621681882848"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-791"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882849"><a href="#local-6989586621681882849"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-792"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isEmptyLHsQTvs</span><span> </span><a href="#local-6989586621681882846"><span class="hs-identifier hs-var">qtvs</span></a><span>  </span><span class="hs-comment">-- No implicit or explicit variables</span><span>
</span><a name="line-793"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882847"><span class="hs-identifier hs-var">mcxt</span></a><span>      </span><span class="hs-comment">-- No context</span><span>
</span><a name="line-794"></a><span>                         </span><span class="hs-comment">-- ==&gt; no need for a forall</span><span>
</span><a name="line-795"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repGadtDataCons"><span class="hs-identifier hs-var">repGadtDataCons</span></a><span> </span><a href="#local-6989586621681882845"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621681882848"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621681882849"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-798"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addTyVarBinds"><span class="hs-identifier hs-var">addTyVarBinds</span></a><span> </span><a href="#local-6989586621681882846"><span class="hs-identifier hs-var">qtvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621681882850"><a href="#local-6989586621681882850"><span class="hs-identifier">ex_bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-799"></a><span>             </span><span class="hs-comment">-- See Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-800"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882851"><a href="#local-6989586621681882851"><span class="hs-identifier">c'</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repGadtDataCons"><span class="hs-identifier hs-var">repGadtDataCons</span></a><span> </span><a href="#local-6989586621681882845"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621681882848"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621681882849"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-801"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882852"><a href="#local-6989586621681882852"><span class="hs-identifier">ctxt'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMbContext"><span class="hs-identifier hs-var">repMbContext</span></a><span> </span><a href="#local-6989586621681882847"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-802"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621681882846"><span class="hs-identifier hs-var">qtvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><a href="#local-6989586621681882847"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-803"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882851"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-804"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#forallCName"><span class="hs-identifier hs-var">forallCName</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882850"><span class="hs-identifier hs-var">ex_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882852"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681882851"><span class="hs-identifier hs-var">c'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-805"></a><span>
</span><a name="line-806"></a><span class="hs-identifier">repC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repC&quot;</span><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span>
</span><a name="line-809"></a><span class="hs-identifier">repMbContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span class="hs-special">)</span><span>
</span><a name="line-810"></a><a name="repMbContext"><a href="DsMeta.html#repMbContext"><span class="hs-identifier">repMbContext</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repContext"><span class="hs-identifier hs-var">repContext</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-811"></a><span class="hs-identifier">repMbContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882853"><a href="#local-6989586621681882853"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repContext"><span class="hs-identifier hs-var">repContext</span></a><span> </span><a href="#local-6989586621681882853"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span class="hs-identifier">repSrcUnpackedness</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcUnpackedness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.SourceUnpackednessQ</span><span class="hs-special">)</span><span>
</span><a name="line-814"></a><a name="repSrcUnpackedness"><a href="DsMeta.html#repSrcUnpackedness"><span class="hs-identifier">repSrcUnpackedness</span></a></a><span> </span><span class="hs-identifier hs-var">SrcUnpack</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sourceUnpackName"><span class="hs-identifier hs-var">sourceUnpackName</span></a><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-815"></a><span class="hs-identifier">repSrcUnpackedness</span><span> </span><span class="hs-identifier hs-var">SrcNoUnpack</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sourceNoUnpackName"><span class="hs-identifier hs-var">sourceNoUnpackName</span></a><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-816"></a><span class="hs-identifier">repSrcUnpackedness</span><span> </span><span class="hs-identifier hs-var">NoSrcUnpack</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#noSourceUnpackednessName"><span class="hs-identifier hs-var">noSourceUnpackednessName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-identifier">repSrcStrictness</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcStrictness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.SourceStrictnessQ</span><span class="hs-special">)</span><span>
</span><a name="line-819"></a><a name="repSrcStrictness"><a href="DsMeta.html#repSrcStrictness"><span class="hs-identifier">repSrcStrictness</span></a></a><span> </span><span class="hs-identifier hs-var">SrcLazy</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sourceLazyName"><span class="hs-identifier hs-var">sourceLazyName</span></a><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-820"></a><span class="hs-identifier">repSrcStrictness</span><span> </span><span class="hs-identifier hs-var">SrcStrict</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sourceStrictName"><span class="hs-identifier hs-var">sourceStrictName</span></a><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-821"></a><span class="hs-identifier">repSrcStrictness</span><span> </span><span class="hs-identifier hs-var">NoSrcStrict</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#noSourceStrictnessName"><span class="hs-identifier hs-var">noSourceStrictnessName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span class="hs-identifier">repBangTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LBangType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.BangTypeQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><a name="repBangTy"><a href="DsMeta.html#repBangTy"><span class="hs-identifier">repBangTy</span></a></a><span> </span><a name="local-6989586621681882854"><a href="#local-6989586621681882854"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-825"></a><span>  </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882861"><a href="#local-6989586621681882861"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSrcUnpackedness"><span class="hs-identifier hs-var">repSrcUnpackedness</span></a><span> </span><a href="#local-6989586621681882855"><span class="hs-identifier hs-var">su'</span></a><span>
</span><a name="line-826"></a><span>  </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882862"><a href="#local-6989586621681882862"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSrcStrictness"><span class="hs-identifier hs-var">repSrcStrictness</span></a><span> </span><a href="#local-6989586621681882856"><span class="hs-identifier hs-var">ss'</span></a><span>
</span><a name="line-827"></a><span>  </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882863"><a href="#local-6989586621681882863"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#bangName"><span class="hs-identifier hs-var">bangName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882861"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882862"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-828"></a><span>  </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882864"><a href="#local-6989586621681882864"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882857"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-829"></a><span>  </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#bangTypeName"><span class="hs-identifier hs-var">bangTypeName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882863"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882864"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-830"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-831"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621681882855"><a href="#local-6989586621681882855"><span class="hs-identifier">su'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882856"><a href="#local-6989586621681882856"><span class="hs-identifier">ss'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882857"><a href="#local-6989586621681882857"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882854"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-832"></a><span>            </span><span class="hs-identifier hs-var">HsBangTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSrcBang</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882858"><a href="#local-6989586621681882858"><span class="hs-identifier">su</span></a></a><span> </span><a name="local-6989586621681882859"><a href="#local-6989586621681882859"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681882860"><a href="#local-6989586621681882860"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882858"><span class="hs-identifier hs-var">su</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882859"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882860"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-833"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NoSrcUnpack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">NoSrcStrict</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882854"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-836"></a><span class="hs-comment">--                      Deriving clauses</span><span>
</span><a name="line-837"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-identifier">repDerivs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsDeriving</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DerivClauseQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-840"></a><a name="repDerivs"><a href="DsMeta.html#repDerivs"><span class="hs-identifier">repDerivs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882865"><a href="#local-6989586621681882865"><span class="hs-identifier">clauses</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#derivClauseQTyConName"><span class="hs-identifier hs-var">derivClauseQTyConName</span></a><span> </span><a href="DsMeta.html#repDerivClause"><span class="hs-identifier hs-var">repDerivClause</span></a><span> </span><a href="#local-6989586621681882865"><span class="hs-identifier hs-var">clauses</span></a><span>
</span><a name="line-842"></a><span>
</span><a name="line-843"></a><span class="hs-identifier">repDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsDerivingClause</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-844"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DerivClauseQ</span><span class="hs-special">)</span><span>
</span><a name="line-845"></a><a name="repDerivClause"><a href="DsMeta.html#repDerivClause"><span class="hs-identifier">repDerivClause</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsDerivingClause</span><span>
</span><a name="line-846"></a><span>                          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">deriv_clause_strategy</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882866"><a href="#local-6989586621681882866"><span class="hs-identifier">dcs</span></a></a><span>
</span><a name="line-847"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">deriv_clause_tys</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882867"><a href="#local-6989586621681882867"><span class="hs-identifier">dct</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-848"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882870"><a href="#local-6989586621681882870"><span class="hs-identifier">dcs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDerivStrategy"><span class="hs-identifier hs-var">repDerivStrategy</span></a><span> </span><a href="#local-6989586621681882866"><span class="hs-identifier hs-var">dcs</span></a><span>
</span><a name="line-849"></a><span>       </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882871"><a href="#local-6989586621681882871"><span class="hs-identifier">dct'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#typeQTyConName"><span class="hs-identifier hs-var">typeQTyConName</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882868"><span class="hs-identifier hs-var">rep_deriv_ty</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">hsSigType</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882867"><span class="hs-identifier hs-var">dct</span></a><span>
</span><a name="line-850"></a><span>       </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#derivClauseName"><span class="hs-identifier hs-var">derivClauseName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882870"><span class="hs-identifier hs-var">dcs'</span></a><span class="hs-special">,</span><a href="#local-6989586621681882871"><span class="hs-identifier hs-var">dct'</span></a><span class="hs-special">]</span><span>
</span><a name="line-851"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-852"></a><span>    </span><span class="hs-identifier">rep_deriv_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-853"></a><span>    </span><a name="local-6989586621681882868"><a href="#local-6989586621681882868"><span class="hs-identifier">rep_deriv_ty</span></a></a><span> </span><a name="local-6989586621681882869"><a href="#local-6989586621681882869"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882869"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-854"></a><span class="hs-identifier">repDerivClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repDerivClause&quot;</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-identifier">rep_sigs_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-857"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-858"></a><span class="hs-comment">-- Represent signatures and methods in class/instance declarations.</span><span>
</span><a name="line-859"></a><span class="hs-comment">-- See Note [Scoped type variables in class and instance declarations]</span><span>
</span><a name="line-860"></a><span class="hs-comment">--</span><span>
</span><a name="line-861"></a><span class="hs-comment">-- Why not use 'repBinds': we have already created symbols for methods in</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- 'repTopDs' via 'hsGroupBinders'. However in 'repBinds', we recreate</span><span>
</span><a name="line-863"></a><span class="hs-comment">-- these fun_id via 'collectHsValBinders decs', which would lead to the</span><span>
</span><a name="line-864"></a><span class="hs-comment">-- instance declarations failing in TH.</span><span>
</span><a name="line-865"></a><a name="rep_sigs_binds"><a href="DsMeta.html#rep_sigs_binds"><span class="hs-identifier">rep_sigs_binds</span></a></a><span> </span><a name="local-6989586621681882872"><a href="#local-6989586621681882872"><span class="hs-identifier">sigs</span></a></a><span> </span><a name="local-6989586621681882873"><a href="#local-6989586621681882873"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-866"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882874"><a href="#local-6989586621681882874"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="DsMeta.html#get_scoped_tvs"><span class="hs-identifier hs-var">get_scoped_tvs</span></a><span> </span><a href="#local-6989586621681882872"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-867"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882875"><a href="#local-6989586621681882875"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681882874"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-868"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882876"><a href="#local-6989586621681882876"><span class="hs-identifier">sigs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882875"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#rep_sigs"><span class="hs-identifier hs-var">rep_sigs</span></a><span> </span><a href="#local-6989586621681882872"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-869"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882877"><a href="#local-6989586621681882877"><span class="hs-identifier">binds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882875"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#rep_binds"><span class="hs-identifier hs-var">rep_binds</span></a><span> </span><a href="#local-6989586621681882873"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-870"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882875"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#de_loc"><span class="hs-identifier hs-var">de_loc</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#sort_by_loc"><span class="hs-identifier hs-var">sort_by_loc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882876"><span class="hs-identifier hs-var">sigs1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681882877"><span class="hs-identifier hs-var">binds1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-873"></a><span class="hs-comment">--   Signatures in a class decl, or a group of bindings</span><span>
</span><a name="line-874"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span class="hs-identifier">rep_sigs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-877"></a><span>        </span><span class="hs-comment">-- We silently ignore ones we don't recognise</span><span>
</span><a name="line-878"></a><a name="rep_sigs"><a href="DsMeta.html#rep_sigs"><span class="hs-identifier">rep_sigs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><a href="DsMeta.html#rep_sig"><span class="hs-identifier hs-var">rep_sig</span></a><span>
</span><a name="line-879"></a><span>
</span><a name="line-880"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-881"></a><a name="rep_sig"><a href="DsMeta.html#rep_sig"><span class="hs-identifier">rep_sig</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882878"><a href="#local-6989586621681882878"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882879"><a href="#local-6989586621681882879"><span class="hs-identifier">nms</span></a></a><span> </span><a name="local-6989586621681882880"><a href="#local-6989586621681882880"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#rep_wc_ty_sig"><span class="hs-identifier hs-var">rep_wc_ty_sig</span></a><span> </span><a href="THNames.html#sigDName"><span class="hs-identifier hs-var">sigDName</span></a><span> </span><a href="#local-6989586621681882878"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621681882880"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882879"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-883"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882881"><a href="#local-6989586621681882881"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatSynSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882882"><a href="#local-6989586621681882882"><span class="hs-identifier">nms</span></a></a><span> </span><a name="local-6989586621681882883"><a href="#local-6989586621681882883"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-884"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#rep_patsyn_ty_sig"><span class="hs-identifier hs-var">rep_patsyn_ty_sig</span></a><span> </span><a href="#local-6989586621681882881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621681882883"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882882"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-885"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882884"><a href="#local-6989586621681882884"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClassOpSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882885"><a href="#local-6989586621681882885"><span class="hs-identifier">is_deflt</span></a></a><span> </span><a name="local-6989586621681882886"><a href="#local-6989586621681882886"><span class="hs-identifier">nms</span></a></a><span> </span><a name="local-6989586621681882887"><a href="#local-6989586621681882887"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681882885"><span class="hs-identifier hs-var">is_deflt</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#rep_ty_sig"><span class="hs-identifier hs-var">rep_ty_sig</span></a><span> </span><a href="THNames.html#defaultSigDName"><span class="hs-identifier hs-var">defaultSigDName</span></a><span> </span><a href="#local-6989586621681882884"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621681882887"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882886"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-887"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#rep_ty_sig"><span class="hs-identifier hs-var">rep_ty_sig</span></a><span> </span><a href="THNames.html#sigDName"><span class="hs-identifier hs-var">sigDName</span></a><span> </span><a href="#local-6989586621681882884"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621681882887"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882886"><span class="hs-identifier hs-var">nms</span></a><span>
</span><a name="line-888"></a><span class="hs-identifier">rep_sig</span><span> </span><a name="local-6989586621681882888"><a href="#local-6989586621681882888"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IdSig</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;rep_sig IdSig&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882888"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-889"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FixSig</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- fixity sigs at top level</span><span>
</span><a name="line-890"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882889"><a href="#local-6989586621681882889"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InlineSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882890"><a href="#local-6989586621681882890"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621681882891"><a href="#local-6989586621681882891"><span class="hs-identifier">ispec</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_inline"><span class="hs-identifier hs-var">rep_inline</span></a><span> </span><a href="#local-6989586621681882890"><span class="hs-identifier hs-var">nm</span></a><span> </span><a href="#local-6989586621681882891"><span class="hs-identifier hs-var">ispec</span></a><span> </span><a href="#local-6989586621681882889"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-891"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882892"><a href="#local-6989586621681882892"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882893"><a href="#local-6989586621681882893"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621681882894"><a href="#local-6989586621681882894"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621681882895"><a href="#local-6989586621681882895"><span class="hs-identifier">ispec</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621681882896"><a href="#local-6989586621681882896"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#rep_specialise"><span class="hs-identifier hs-var">rep_specialise</span></a><span> </span><a href="#local-6989586621681882893"><span class="hs-identifier hs-var">nm</span></a><span> </span><a href="#local-6989586621681882896"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621681882895"><span class="hs-identifier hs-var">ispec</span></a><span> </span><a href="#local-6989586621681882892"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882894"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-893"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882897"><a href="#local-6989586621681882897"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SpecInstSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882898"><a href="#local-6989586621681882898"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_specialiseInst"><span class="hs-identifier hs-var">rep_specialiseInst</span></a><span> </span><a href="#local-6989586621681882898"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621681882897"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-894"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MinimalSig</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;MINIMAL pragmas&quot;</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-895"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SCCFunSig</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;SCC pragmas&quot;</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-896"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681882899"><a href="#local-6989586621681882899"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CompleteMatchSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882900"><a href="#local-6989586621681882900"><span class="hs-identifier">_st</span></a></a><span> </span><a name="local-6989586621681882901"><a href="#local-6989586621681882901"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-6989586621681882902"><a href="#local-6989586621681882902"><span class="hs-identifier">mty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-897"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_complete_sig"><span class="hs-identifier hs-var">rep_complete_sig</span></a><span> </span><a href="#local-6989586621681882901"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-6989586621681882902"><span class="hs-identifier hs-var">mty</span></a><span> </span><a href="#local-6989586621681882899"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-898"></a><span class="hs-identifier">rep_sig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_sig&quot;</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span class="hs-identifier">rep_ty_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsSigType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-901"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-902"></a><span class="hs-comment">-- Don't create the implicit and explicit variables when desugaring signatures,</span><span>
</span><a name="line-903"></a><span class="hs-comment">-- see Note [Scoped type variables in class and instance declarations].</span><span>
</span><a name="line-904"></a><span class="hs-comment">-- and Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-905"></a><a name="rep_ty_sig"><a href="DsMeta.html#rep_ty_sig"><span class="hs-identifier">rep_ty_sig</span></a></a><span> </span><a name="local-6989586621681882903"><a href="#local-6989586621681882903"><span class="hs-identifier">mk_sig</span></a></a><span> </span><a name="local-6989586621681882904"><a href="#local-6989586621681882904"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681882905"><a href="#local-6989586621681882905"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621681882906"><a href="#local-6989586621681882906"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-906"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882907"><a href="#local-6989586621681882907"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882905"><span class="hs-identifier hs-var">sig_ty</span></a><span>
</span><a name="line-907"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882908"><a href="#local-6989586621681882908"><span class="hs-identifier">explicit_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882909"><a href="#local-6989586621681882909"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882910"><a href="#local-6989586621681882910"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitLHsSigmaTy</span><span> </span><a href="#local-6989586621681882907"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-908"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882911"><a href="#local-6989586621681882911"><span class="hs-identifier">nm1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882906"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-909"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882912"><a href="#local-6989586621681882912"><span class="hs-identifier">rep_in_scope_tv</span></a></a><span> </span><a name="local-6989586621681882913"><a href="#local-6989586621681882913"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882914"><a href="#local-6989586621681882914"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsLTyVarName</span><span> </span><a href="#local-6989586621681882913"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-910"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyVarBndrWithKind"><span class="hs-identifier hs-var">repTyVarBndrWithKind</span></a><span> </span><a href="#local-6989586621681882913"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621681882914"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-911"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882915"><a href="#local-6989586621681882915"><span class="hs-identifier">th_explicit_tvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span> </span><a href="#local-6989586621681882912"><span class="hs-identifier hs-var">rep_in_scope_tv</span></a><span>
</span><a name="line-912"></a><span>                                    </span><a href="#local-6989586621681882908"><span class="hs-identifier hs-var">explicit_tvs</span></a><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span>         </span><span class="hs-comment">-- NB: Don't pass any implicit type variables to repList above</span><span>
</span><a name="line-915"></a><span>         </span><span class="hs-comment">-- See Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-916"></a><span>
</span><a name="line-917"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882916"><a href="#local-6989586621681882916"><span class="hs-identifier">th_ctxt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882909"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-918"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882917"><a href="#local-6989586621681882917"><span class="hs-identifier">th_ty</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882910"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-919"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882918"><a href="#local-6989586621681882918"><span class="hs-identifier">ty1</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681882908"><span class="hs-identifier hs-var">explicit_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681882909"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-920"></a><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681882917"><span class="hs-identifier hs-var">th_ty</span></a><span>
</span><a name="line-921"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><a href="DsMeta.html#repTForall"><span class="hs-identifier hs-var">repTForall</span></a><span> </span><a href="#local-6989586621681882915"><span class="hs-identifier hs-var">th_explicit_tvs</span></a><span> </span><a href="#local-6989586621681882916"><span class="hs-identifier hs-var">th_ctxt</span></a><span> </span><a href="#local-6989586621681882917"><span class="hs-identifier hs-var">th_ty</span></a><span>
</span><a name="line-922"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882919"><a href="#local-6989586621681882919"><span class="hs-identifier">sig</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repProto"><span class="hs-identifier hs-var">repProto</span></a><span> </span><a href="#local-6989586621681882903"><span class="hs-identifier hs-var">mk_sig</span></a><span> </span><a href="#local-6989586621681882911"><span class="hs-identifier hs-var">nm1</span></a><span> </span><a href="#local-6989586621681882918"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-923"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882904"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882919"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-924"></a><span class="hs-identifier">rep_ty_sig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_ty_sig&quot;</span><span>
</span><a name="line-925"></a><span>
</span><a name="line-926"></a><span class="hs-identifier">rep_patsyn_ty_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsSigType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-927"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-928"></a><span class="hs-comment">-- represents a pattern synonym type signature;</span><span>
</span><a name="line-929"></a><span class="hs-comment">-- see Note [Pattern synonym type signatures and Template Haskell] in Convert</span><span>
</span><a name="line-930"></a><span class="hs-comment">--</span><span>
</span><a name="line-931"></a><span class="hs-comment">-- Don't create the implicit and explicit variables when desugaring signatures,</span><span>
</span><a name="line-932"></a><span class="hs-comment">-- see Note [Scoped type variables in class and instance declarations]</span><span>
</span><a name="line-933"></a><span class="hs-comment">-- and Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-934"></a><a name="rep_patsyn_ty_sig"><a href="DsMeta.html#rep_patsyn_ty_sig"><span class="hs-identifier">rep_patsyn_ty_sig</span></a></a><span> </span><a name="local-6989586621681882920"><a href="#local-6989586621681882920"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681882921"><a href="#local-6989586621681882921"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621681882922"><a href="#local-6989586621681882922"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-935"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882923"><a href="#local-6989586621681882923"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681882921"><span class="hs-identifier hs-var">sig_ty</span></a><span>
</span><a name="line-936"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681882924"><a href="#local-6989586621681882924"><span class="hs-identifier">univs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882925"><a href="#local-6989586621681882925"><span class="hs-identifier">reqs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882926"><a href="#local-6989586621681882926"><span class="hs-identifier">exis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882927"><a href="#local-6989586621681882927"><span class="hs-identifier">provs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681882928"><a href="#local-6989586621681882928"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitLHsPatSynTy</span><span> </span><a href="#local-6989586621681882923"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-937"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882929"><a href="#local-6989586621681882929"><span class="hs-identifier">nm1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882922"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-938"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882930"><a href="#local-6989586621681882930"><span class="hs-identifier">rep_in_scope_tv</span></a></a><span> </span><a name="local-6989586621681882931"><a href="#local-6989586621681882931"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882932"><a href="#local-6989586621681882932"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsLTyVarName</span><span> </span><a href="#local-6989586621681882931"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyVarBndrWithKind"><span class="hs-identifier hs-var">repTyVarBndrWithKind</span></a><span> </span><a href="#local-6989586621681882931"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621681882932"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-940"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882933"><a href="#local-6989586621681882933"><span class="hs-identifier">th_univs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span> </span><a href="#local-6989586621681882930"><span class="hs-identifier hs-var">rep_in_scope_tv</span></a><span> </span><a href="#local-6989586621681882924"><span class="hs-identifier hs-var">univs</span></a><span>
</span><a name="line-941"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882934"><a href="#local-6989586621681882934"><span class="hs-identifier">th_exis</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span> </span><a href="#local-6989586621681882930"><span class="hs-identifier hs-var">rep_in_scope_tv</span></a><span> </span><a href="#local-6989586621681882926"><span class="hs-identifier hs-var">exis</span></a><span>
</span><a name="line-942"></a><span>
</span><a name="line-943"></a><span>         </span><span class="hs-comment">-- NB: Don't pass any implicit type variables to repList above</span><span>
</span><a name="line-944"></a><span>         </span><span class="hs-comment">-- See Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-945"></a><span>
</span><a name="line-946"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882935"><a href="#local-6989586621681882935"><span class="hs-identifier">th_reqs</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882925"><span class="hs-identifier hs-var">reqs</span></a><span>
</span><a name="line-947"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882936"><a href="#local-6989586621681882936"><span class="hs-identifier">th_provs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681882927"><span class="hs-identifier hs-var">provs</span></a><span>
</span><a name="line-948"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882937"><a href="#local-6989586621681882937"><span class="hs-identifier">th_ty</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681882928"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-949"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882938"><a href="#local-6989586621681882938"><span class="hs-identifier">ty1</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTForall"><span class="hs-identifier hs-var">repTForall</span></a><span> </span><a href="#local-6989586621681882933"><span class="hs-identifier hs-var">th_univs</span></a><span> </span><a href="#local-6989586621681882935"><span class="hs-identifier hs-var">th_reqs</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span>
</span><a name="line-950"></a><span>                       </span><a href="DsMeta.html#repTForall"><span class="hs-identifier hs-var">repTForall</span></a><span> </span><a href="#local-6989586621681882934"><span class="hs-identifier hs-var">th_exis</span></a><span> </span><a href="#local-6989586621681882936"><span class="hs-identifier hs-var">th_provs</span></a><span> </span><a href="#local-6989586621681882937"><span class="hs-identifier hs-var">th_ty</span></a><span>
</span><a name="line-951"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882939"><a href="#local-6989586621681882939"><span class="hs-identifier">sig</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repProto"><span class="hs-identifier hs-var">repProto</span></a><span> </span><a href="THNames.html#patSynSigDName"><span class="hs-identifier hs-var">patSynSigDName</span></a><span> </span><a href="#local-6989586621681882929"><span class="hs-identifier hs-var">nm1</span></a><span> </span><a href="#local-6989586621681882938"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-952"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882920"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882939"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-953"></a><span class="hs-identifier">rep_patsyn_ty_sig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_patsyn_ty_sig&quot;</span><span>
</span><a name="line-954"></a><span>
</span><a name="line-955"></a><span class="hs-identifier">rep_wc_ty_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-956"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-957"></a><a name="rep_wc_ty_sig"><a href="DsMeta.html#rep_wc_ty_sig"><span class="hs-identifier">rep_wc_ty_sig</span></a></a><span> </span><a name="local-6989586621681882940"><a href="#local-6989586621681882940"><span class="hs-identifier">mk_sig</span></a></a><span> </span><a name="local-6989586621681882941"><a href="#local-6989586621681882941"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681882942"><a href="#local-6989586621681882942"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621681882943"><a href="#local-6989586621681882943"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-958"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_ty_sig"><span class="hs-identifier hs-var">rep_ty_sig</span></a><span> </span><a href="#local-6989586621681882940"><span class="hs-identifier hs-var">mk_sig</span></a><span> </span><a href="#local-6989586621681882941"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621681882942"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882943"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-959"></a><span>
</span><a name="line-960"></a><span class="hs-identifier">rep_inline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-961"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">InlinePragma</span><span>      </span><span class="hs-comment">-- Never defaultInlinePragma</span><span>
</span><a name="line-962"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-963"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-964"></a><a name="rep_inline"><a href="DsMeta.html#rep_inline"><span class="hs-identifier">rep_inline</span></a></a><span> </span><a name="local-6989586621681882944"><a href="#local-6989586621681882944"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621681882945"><a href="#local-6989586621681882945"><span class="hs-identifier">ispec</span></a></a><span> </span><a name="local-6989586621681882946"><a href="#local-6989586621681882946"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-965"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882947"><a href="#local-6989586621681882947"><span class="hs-identifier">nm1</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882944"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-966"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882948"><a href="#local-6989586621681882948"><span class="hs-identifier">inline</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repInline"><span class="hs-identifier hs-var">repInline</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">inl_inline</span><span> </span><a href="#local-6989586621681882945"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-967"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882949"><a href="#local-6989586621681882949"><span class="hs-identifier">rm</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repRuleMatch"><span class="hs-identifier hs-var">repRuleMatch</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">inl_rule</span><span> </span><a href="#local-6989586621681882945"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-968"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882950"><a href="#local-6989586621681882950"><span class="hs-identifier">phases</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPhases"><span class="hs-identifier hs-var">repPhases</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">inl_act</span><span> </span><a href="#local-6989586621681882945"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-969"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882951"><a href="#local-6989586621681882951"><span class="hs-identifier">pragma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPragInl"><span class="hs-identifier hs-var">repPragInl</span></a><span> </span><a href="#local-6989586621681882947"><span class="hs-identifier hs-var">nm1</span></a><span> </span><a href="#local-6989586621681882948"><span class="hs-identifier hs-var">inline</span></a><span> </span><a href="#local-6989586621681882949"><span class="hs-identifier hs-var">rm</span></a><span> </span><a href="#local-6989586621681882950"><span class="hs-identifier hs-var">phases</span></a><span>
</span><a name="line-970"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882946"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882951"><span class="hs-identifier hs-var">pragma</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-971"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-972"></a><span>
</span><a name="line-973"></a><span class="hs-identifier">rep_specialise</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsSigType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">InlinePragma</span><span>
</span><a name="line-974"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-975"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-976"></a><a name="rep_specialise"><a href="DsMeta.html#rep_specialise"><span class="hs-identifier">rep_specialise</span></a></a><span> </span><a name="local-6989586621681882952"><a href="#local-6989586621681882952"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621681882953"><a href="#local-6989586621681882953"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681882954"><a href="#local-6989586621681882954"><span class="hs-identifier">ispec</span></a></a><span> </span><a name="local-6989586621681882955"><a href="#local-6989586621681882955"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-977"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882956"><a href="#local-6989586621681882956"><span class="hs-identifier">nm1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882952"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-978"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882957"><a href="#local-6989586621681882957"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repHsSigType"><span class="hs-identifier hs-var">repHsSigType</span></a><span> </span><a href="#local-6989586621681882953"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-979"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882958"><a href="#local-6989586621681882958"><span class="hs-identifier">phases</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPhases"><span class="hs-identifier hs-var">repPhases</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">inl_act</span><span> </span><a href="#local-6989586621681882954"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-980"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882959"><a href="#local-6989586621681882959"><span class="hs-identifier">inline</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inl_inline</span><span> </span><a href="#local-6989586621681882954"><span class="hs-identifier hs-var">ispec</span></a><span>
</span><a name="line-981"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882961"><a href="#local-6989586621681882961"><span class="hs-identifier">pragma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">noUserInlineSpec</span><span> </span><a href="#local-6989586621681882959"><span class="hs-identifier hs-var">inline</span></a><span>
</span><a name="line-982"></a><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- SPECIALISE</span><span>
</span><a name="line-983"></a><span>                     </span><a href="DsMeta.html#repPragSpec"><span class="hs-identifier hs-var">repPragSpec</span></a><span> </span><a href="#local-6989586621681882956"><span class="hs-identifier hs-var">nm1</span></a><span> </span><a href="#local-6989586621681882957"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621681882958"><span class="hs-identifier hs-var">phases</span></a><span>
</span><a name="line-984"></a><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- SPECIALISE INLINE</span><span>
</span><a name="line-985"></a><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882960"><a href="#local-6989586621681882960"><span class="hs-identifier">inline1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repInline"><span class="hs-identifier hs-var">repInline</span></a><span> </span><a href="#local-6989586621681882959"><span class="hs-identifier hs-var">inline</span></a><span>
</span><a name="line-986"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPragSpecInl"><span class="hs-identifier hs-var">repPragSpecInl</span></a><span> </span><a href="#local-6989586621681882956"><span class="hs-identifier hs-var">nm1</span></a><span> </span><a href="#local-6989586621681882957"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621681882960"><span class="hs-identifier hs-var">inline1</span></a><span> </span><a href="#local-6989586621681882958"><span class="hs-identifier hs-var">phases</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-987"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882955"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882961"><span class="hs-identifier hs-var">pragma</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-988"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span class="hs-identifier">rep_specialiseInst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsSigType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-991"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-992"></a><a name="rep_specialiseInst"><a href="DsMeta.html#rep_specialiseInst"><span class="hs-identifier">rep_specialiseInst</span></a></a><span> </span><a name="local-6989586621681882962"><a href="#local-6989586621681882962"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681882963"><a href="#local-6989586621681882963"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-993"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882964"><a href="#local-6989586621681882964"><span class="hs-identifier">ty1</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repHsSigType"><span class="hs-identifier hs-var">repHsSigType</span></a><span> </span><a href="#local-6989586621681882962"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-994"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882965"><a href="#local-6989586621681882965"><span class="hs-identifier">pragma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPragSpecInst"><span class="hs-identifier hs-var">repPragSpecInst</span></a><span> </span><a href="#local-6989586621681882964"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-995"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882963"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882965"><span class="hs-identifier hs-var">pragma</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-996"></a><span>
</span><a name="line-997"></a><span class="hs-identifier">repInline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">InlineSpec</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Inline</span><span class="hs-special">)</span><span>
</span><a name="line-998"></a><a name="repInline"><a href="DsMeta.html#repInline"><span class="hs-identifier">repInline</span></a></a><span> </span><span class="hs-identifier hs-var">NoInline</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#noInlineDataConName"><span class="hs-identifier hs-var">noInlineDataConName</span></a><span>
</span><a name="line-999"></a><span class="hs-identifier">repInline</span><span> </span><span class="hs-identifier hs-var">Inline</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#inlineDataConName"><span class="hs-identifier hs-var">inlineDataConName</span></a><span>
</span><a name="line-1000"></a><span class="hs-identifier">repInline</span><span> </span><span class="hs-identifier hs-var">Inlinable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#inlinableDataConName"><span class="hs-identifier hs-var">inlinableDataConName</span></a><span>
</span><a name="line-1001"></a><span class="hs-identifier">repInline</span><span> </span><a name="local-6989586621681882966"><a href="#local-6989586621681882966"><span class="hs-identifier">spec</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;repInline&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681882966"><span class="hs-identifier hs-var">spec</span></a><span class="hs-special">)</span><span>
</span><a name="line-1002"></a><span>
</span><a name="line-1003"></a><span class="hs-identifier">repRuleMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RuleMatchInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.RuleMatch</span><span class="hs-special">)</span><span>
</span><a name="line-1004"></a><a name="repRuleMatch"><a href="DsMeta.html#repRuleMatch"><span class="hs-identifier">repRuleMatch</span></a></a><span> </span><span class="hs-identifier hs-var">ConLike</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#conLikeDataConName"><span class="hs-identifier hs-var">conLikeDataConName</span></a><span>
</span><a name="line-1005"></a><span class="hs-identifier">repRuleMatch</span><span> </span><span class="hs-identifier hs-var">FunLike</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#funLikeDataConName"><span class="hs-identifier hs-var">funLikeDataConName</span></a><span>
</span><a name="line-1006"></a><span>
</span><a name="line-1007"></a><span class="hs-identifier">repPhases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Activation</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span class="hs-special">)</span><span>
</span><a name="line-1008"></a><a name="repPhases"><a href="DsMeta.html#repPhases"><span class="hs-identifier">repPhases</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ActiveBefore</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882967"><a href="#local-6989586621681882967"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882968"><a href="#local-6989586621681882968"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreIntLit"><span class="hs-identifier hs-var">coreIntLit</span></a><span> </span><a href="#local-6989586621681882967"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1009"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#dataCon%27"><span class="hs-identifier hs-var">dataCon'</span></a><span> </span><a href="THNames.html#beforePhaseDataConName"><span class="hs-identifier hs-var">beforePhaseDataConName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882968"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1010"></a><span class="hs-identifier">repPhases</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ActiveAfter</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882969"><a href="#local-6989586621681882969"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681882970"><a href="#local-6989586621681882970"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreIntLit"><span class="hs-identifier hs-var">coreIntLit</span></a><span> </span><a href="#local-6989586621681882969"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1011"></a><span>                                  </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#dataCon%27"><span class="hs-identifier hs-var">dataCon'</span></a><span> </span><a href="THNames.html#fromPhaseDataConName"><span class="hs-identifier hs-var">fromPhaseDataConName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882970"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1012"></a><span class="hs-identifier">repPhases</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#allPhasesDataConName"><span class="hs-identifier hs-var">allPhasesDataConName</span></a><span>
</span><a name="line-1013"></a><span>
</span><a name="line-1014"></a><span class="hs-identifier">rep_complete_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1015"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-1016"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-1017"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1018"></a><a name="rep_complete_sig"><a href="DsMeta.html#rep_complete_sig"><span class="hs-identifier">rep_complete_sig</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681882971"><a href="#local-6989586621681882971"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681882972"><a href="#local-6989586621681882972"><span class="hs-identifier">mty</span></a></a><span> </span><a name="local-6989586621681882973"><a href="#local-6989586621681882973"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-1019"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882974"><a href="#local-6989586621681882974"><span class="hs-identifier">mty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMaybe"><span class="hs-identifier hs-var">repMaybe</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882972"><span class="hs-identifier hs-var">mty</span></a><span>
</span><a name="line-1020"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882975"><a href="#local-6989586621681882975"><span class="hs-identifier">cls'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681882971"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-1021"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882976"><a href="#local-6989586621681882976"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPragComplete"><span class="hs-identifier hs-var">repPragComplete</span></a><span> </span><a href="#local-6989586621681882975"><span class="hs-identifier hs-var">cls'</span></a><span> </span><a href="#local-6989586621681882974"><span class="hs-identifier hs-var">mty'</span></a><span>
</span><a name="line-1022"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882973"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882976"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1023"></a><span>
</span><a name="line-1024"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-1025"></a><span class="hs-comment">--                      Types</span><span>
</span><a name="line-1026"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-1027"></a><span>
</span><a name="line-1028"></a><span class="hs-identifier">addSimpleTyVarBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>                </span><span class="hs-comment">-- the binders to be added</span><span>
</span><a name="line-1029"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- action in the ext env</span><span>
</span><a name="line-1030"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1031"></a><a name="addSimpleTyVarBinds"><a href="DsMeta.html#addSimpleTyVarBinds"><span class="hs-identifier">addSimpleTyVarBinds</span></a></a><span> </span><a name="local-6989586621681882977"><a href="#local-6989586621681882977"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621681882978"><a href="#local-6989586621681882978"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1032"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882979"><a href="#local-6989586621681882979"><span class="hs-identifier">fresh_names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681882977"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1033"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882980"><a href="#local-6989586621681882980"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882979"><span class="hs-identifier hs-var">fresh_names</span></a><span> </span><a href="#local-6989586621681882978"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-1034"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882979"><span class="hs-identifier hs-var">fresh_names</span></a><span> </span><a href="#local-6989586621681882980"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1035"></a><span>
</span><a name="line-1036"></a><span class="hs-identifier">addHsTyVarBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- the binders to be added</span><span>
</span><a name="line-1037"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882482"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- action in the ext env</span><span>
</span><a name="line-1038"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882482"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1039"></a><a name="addHsTyVarBinds"><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier">addHsTyVarBinds</span></a></a><span> </span><a name="local-6989586621681882981"><a href="#local-6989586621681882981"><span class="hs-identifier">exp_tvs</span></a></a><span> </span><a name="local-6989586621681882982"><a href="#local-6989586621681882982"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1040"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882986"><a href="#local-6989586621681882986"><span class="hs-identifier">fresh_exp_names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">hsLTyVarName</span><span> </span><a href="#local-6989586621681882981"><span class="hs-identifier hs-var">exp_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1041"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882988"><a href="#local-6989586621681882988"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882986"><span class="hs-identifier hs-var">fresh_exp_names</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1042"></a><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882987"><a href="#local-6989586621681882987"><span class="hs-identifier">kbs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span> </span><a href="#local-6989586621681882983"><span class="hs-identifier hs-var">mk_tv_bndr</span></a><span>
</span><a name="line-1043"></a><span>                                     </span><span class="hs-special">(</span><a href="#local-6989586621681882981"><span class="hs-identifier hs-var">exp_tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">zip</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681882986"><span class="hs-identifier hs-var">fresh_exp_names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1044"></a><span>                    </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621681882982"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621681882987"><span class="hs-identifier hs-var">kbs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1045"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882986"><span class="hs-identifier hs-var">fresh_exp_names</span></a><span> </span><a href="#local-6989586621681882988"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1046"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1047"></a><span>    </span><a name="local-6989586621681882983"><a href="#local-6989586621681882983"><span class="hs-identifier">mk_tv_bndr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621681882984"><a href="#local-6989586621681882984"><span class="hs-identifier">tv</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621681882985"><a href="#local-6989586621681882985"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTyVarBndrWithKind"><span class="hs-identifier hs-var">repTyVarBndrWithKind</span></a><span> </span><a href="#local-6989586621681882984"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreVar"><span class="hs-identifier hs-var">coreVar</span></a><span> </span><a href="#local-6989586621681882985"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-1048"></a><span>
</span><a name="line-1049"></a><span class="hs-identifier">addTyVarBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>                    </span><span class="hs-comment">-- the binders to be added</span><span>
</span><a name="line-1050"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- action in the ext env</span><span>
</span><a name="line-1051"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1052"></a><span class="hs-comment">-- gensym a list of type variables and enter them into the meta environment;</span><span>
</span><a name="line-1053"></a><span class="hs-comment">-- the computations passed as the second argument is executed in that extended</span><span>
</span><a name="line-1054"></a><span class="hs-comment">-- meta environment and gets the *new* names on Core-level as an argument</span><span>
</span><a name="line-1055"></a><a name="addTyVarBinds"><a href="DsMeta.html#addTyVarBinds"><span class="hs-identifier">addTyVarBinds</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsQTvsRn</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882989"><a href="#local-6989586621681882989"><span class="hs-identifier">imp_tvs</span></a></a><span class="hs-special">}</span><span>
</span><a name="line-1056"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681882990"><a href="#local-6989586621681882990"><span class="hs-identifier">exp_tvs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><span>              </span><a name="local-6989586621681882991"><a href="#local-6989586621681882991"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1058"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addSimpleTyVarBinds"><span class="hs-identifier hs-var">addSimpleTyVarBinds</span></a><span> </span><a href="#local-6989586621681882989"><span class="hs-identifier hs-var">imp_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1059"></a><span>    </span><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier hs-var">addHsTyVarBinds</span></a><span> </span><a href="#local-6989586621681882990"><span class="hs-identifier hs-var">exp_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1060"></a><span>    </span><a href="#local-6989586621681882991"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-1061"></a><span class="hs-identifier">addTyVarBinds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XLHsQTyVars</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;addTyVarBinds&quot;</span><span>
</span><a name="line-1062"></a><span>
</span><a name="line-1063"></a><span class="hs-identifier">addTyClTyVarBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-1064"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882480"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882480"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1066"></a><span>
</span><a name="line-1067"></a><span class="hs-comment">-- Used for data/newtype declarations, and family instances,</span><span>
</span><a name="line-1068"></a><span class="hs-comment">-- so that the nested type variables work right</span><span>
</span><a name="line-1069"></a><span class="hs-comment">--    instance C (T a) where</span><span>
</span><a name="line-1070"></a><span class="hs-comment">--      type W (T a) = blah</span><span>
</span><a name="line-1071"></a><span class="hs-comment">-- The 'a' in the type instance is the one bound by the instance decl</span><span>
</span><a name="line-1072"></a><a name="addTyClTyVarBinds"><a href="DsMeta.html#addTyClTyVarBinds"><span class="hs-identifier">addTyClTyVarBinds</span></a></a><span> </span><a name="local-6989586621681882992"><a href="#local-6989586621681882992"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621681882993"><a href="#local-6989586621681882993"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1073"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681882997"><a href="#local-6989586621681882997"><span class="hs-identifier">tv_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hsAllLTyVarNames</span><span> </span><a href="#local-6989586621681882992"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1074"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882998"><a href="#local-6989586621681882998"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsGetMetaEnv"><span class="hs-identifier hs-var">dsGetMetaEnv</span></a><span>
</span><a name="line-1075"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681882999"><a href="#local-6989586621681882999"><span class="hs-identifier">freshNames</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filterOut</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elemNameEnv</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681882998"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681882997"><span class="hs-identifier hs-var">tv_names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>            </span><span class="hs-comment">-- Make fresh names for the ones that are not already in scope</span><span>
</span><a name="line-1077"></a><span>            </span><span class="hs-comment">-- This makes things work for family declarations</span><span>
</span><a name="line-1078"></a><span>
</span><a name="line-1079"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883001"><a href="#local-6989586621681883001"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681882999"><span class="hs-identifier hs-var">freshNames</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1080"></a><span>                 </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883000"><a href="#local-6989586621681883000"><span class="hs-identifier">kbs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#tyVarBndrQTyConName"><span class="hs-identifier hs-var">tyVarBndrQTyConName</span></a><span> </span><a href="#local-6989586621681882994"><span class="hs-identifier hs-var">mk_tv_bndr</span></a><span>
</span><a name="line-1081"></a><span>                                     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsQTvExplicit</span><span> </span><a href="#local-6989586621681882992"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1082"></a><span>                    </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621681882993"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621681883000"><span class="hs-identifier hs-var">kbs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1083"></a><span>
</span><a name="line-1084"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681882999"><span class="hs-identifier hs-var">freshNames</span></a><span> </span><a href="#local-6989586621681883001"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1085"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1086"></a><span>    </span><span class="hs-identifier">mk_tv_bndr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><span>    </span><a name="local-6989586621681882994"><a href="#local-6989586621681882994"><span class="hs-identifier">mk_tv_bndr</span></a></a><span> </span><a name="local-6989586621681882995"><a href="#local-6989586621681882995"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681882996"><a href="#local-6989586621681882996"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsLTyVarName</span><span> </span><a href="#local-6989586621681882995"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTyVarBndrWithKind"><span class="hs-identifier hs-var">repTyVarBndrWithKind</span></a><span> </span><a href="#local-6989586621681882995"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621681882996"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1089"></a><span>
</span><a name="line-1090"></a><span class="hs-comment">-- Produce kinded binder constructors from the Haskell tyvar binders</span><span>
</span><a name="line-1091"></a><span class="hs-comment">--</span><span>
</span><a name="line-1092"></a><span class="hs-identifier">repTyVarBndrWithKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-1093"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-1094"></a><a name="repTyVarBndrWithKind"><a href="DsMeta.html#repTyVarBndrWithKind"><span class="hs-identifier">repTyVarBndrWithKind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UserTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681883002"><a href="#local-6989586621681883002"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-1095"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repPlainTV"><span class="hs-identifier hs-var">repPlainTV</span></a><span> </span><a href="#local-6989586621681883002"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1096"></a><span class="hs-identifier">repTyVarBndrWithKind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">KindedTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883003"><a href="#local-6989586621681883003"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681883004"><a href="#local-6989586621681883004"><span class="hs-identifier">nm</span></a></a><span>
</span><a name="line-1097"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883003"><span class="hs-identifier hs-var">ki</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="DsMeta.html#repKindedTV"><span class="hs-identifier hs-var">repKindedTV</span></a><span> </span><a href="#local-6989586621681883004"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1098"></a><span class="hs-identifier">repTyVarBndrWithKind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyVarBndrWithKind&quot;</span><span>
</span><a name="line-1099"></a><span>
</span><a name="line-1100"></a><span class="hs-comment">-- | Represent a type variable binder</span><span>
</span><a name="line-1101"></a><span class="hs-identifier">repTyVarBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><a name="repTyVarBndr"><a href="DsMeta.html#repTyVarBndr"><span class="hs-identifier">repTyVarBndr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UserTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883005"><a href="#local-6989586621681883005"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883006"><a href="#local-6989586621681883006"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><a href="#local-6989586621681883005"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1104"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPlainTV"><span class="hs-identifier hs-var">repPlainTV</span></a><span> </span><a href="#local-6989586621681883006"><span class="hs-identifier hs-var">nm'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1105"></a><span class="hs-identifier">repTyVarBndr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">KindedTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883007"><a href="#local-6989586621681883007"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883008"><a href="#local-6989586621681883008"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1106"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883009"><a href="#local-6989586621681883009"><span class="hs-identifier">nm'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><a href="#local-6989586621681883007"><span class="hs-identifier hs-var">nm</span></a><span>
</span><a name="line-1107"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883010"><a href="#local-6989586621681883010"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883008"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1108"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repKindedTV"><span class="hs-identifier hs-var">repKindedTV</span></a><span> </span><a href="#local-6989586621681883009"><span class="hs-identifier hs-var">nm'</span></a><span> </span><a href="#local-6989586621681883010"><span class="hs-identifier hs-var">ki'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1109"></a><span class="hs-identifier">repTyVarBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repTyVarBndr&quot;</span><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><span class="hs-comment">-- represent a type context</span><span>
</span><a name="line-1112"></a><span class="hs-comment">--</span><span>
</span><a name="line-1113"></a><span class="hs-identifier">repLContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><a name="repLContext"><a href="DsMeta.html#repLContext"><span class="hs-identifier">repLContext</span></a></a><span> </span><a name="local-6989586621681883011"><a href="#local-6989586621681883011"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repContext"><span class="hs-identifier hs-var">repContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883011"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>
</span><a name="line-1116"></a><span class="hs-identifier">repContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsContext</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><a name="repContext"><a href="DsMeta.html#repContext"><span class="hs-identifier">repContext</span></a></a><span> </span><a name="local-6989586621681883012"><a href="#local-6989586621681883012"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883013"><a href="#local-6989586621681883013"><span class="hs-identifier">preds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#typeQTyConName"><span class="hs-identifier hs-var">typeQTyConName</span></a><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883012"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1118"></a><span>                     </span><a href="DsMeta.html#repCtxt"><span class="hs-identifier hs-var">repCtxt</span></a><span> </span><a href="#local-6989586621681883013"><span class="hs-identifier hs-var">preds</span></a><span>
</span><a name="line-1119"></a><span>
</span><a name="line-1120"></a><span class="hs-identifier">repHsSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsSigType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><a name="repHsSigType"><a href="DsMeta.html#repHsSigType"><span class="hs-identifier">repHsSigType</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883014"><a href="#local-6989586621681883014"><span class="hs-identifier">implicit_tvs</span></a></a><span>
</span><a name="line-1122"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883015"><a href="#local-6989586621681883015"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883016"><a href="#local-6989586621681883016"><span class="hs-identifier">explicit_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883017"><a href="#local-6989586621681883017"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883018"><a href="#local-6989586621681883018"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitLHsSigmaTy</span><span> </span><a href="#local-6989586621681883015"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1124"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addSimpleTyVarBinds"><span class="hs-identifier hs-var">addSimpleTyVarBinds</span></a><span> </span><a href="#local-6989586621681883014"><span class="hs-identifier hs-var">implicit_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1125"></a><span>      </span><span class="hs-comment">-- See Note [Don't quantify implicit type variables in quotes]</span><span>
</span><a name="line-1126"></a><span>    </span><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier hs-var">addHsTyVarBinds</span></a><span> </span><a href="#local-6989586621681883016"><span class="hs-identifier hs-var">explicit_tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621681883019"><a href="#local-6989586621681883019"><span class="hs-identifier">th_explicit_tvs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1127"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883020"><a href="#local-6989586621681883020"><span class="hs-identifier">th_ctxt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681883017"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1128"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883021"><a href="#local-6989586621681883021"><span class="hs-identifier">th_ty</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883018"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1129"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681883016"><span class="hs-identifier hs-var">explicit_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883017"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1130"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681883021"><span class="hs-identifier hs-var">th_ty</span></a><span>
</span><a name="line-1131"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="DsMeta.html#repTForall"><span class="hs-identifier hs-var">repTForall</span></a><span> </span><a href="#local-6989586621681883019"><span class="hs-identifier hs-var">th_explicit_tvs</span></a><span> </span><a href="#local-6989586621681883020"><span class="hs-identifier hs-var">th_ctxt</span></a><span> </span><a href="#local-6989586621681883021"><span class="hs-identifier hs-var">th_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1132"></a><span class="hs-identifier">repHsSigType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repHsSigType&quot;</span><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span class="hs-identifier">repHsSigWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><a name="repHsSigWcType"><a href="DsMeta.html#repHsSigWcType"><span class="hs-identifier">repHsSigWcType</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWC</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883022"><a href="#local-6989586621681883022"><span class="hs-identifier">sig1</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1136"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repHsSigType"><span class="hs-identifier hs-var">repHsSigType</span></a><span> </span><a href="#local-6989586621681883022"><span class="hs-identifier hs-var">sig1</span></a><span>
</span><a name="line-1137"></a><span class="hs-identifier">repHsSigWcType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsWildCardBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repHsSigWcType&quot;</span><span>
</span><a name="line-1138"></a><span>
</span><a name="line-1139"></a><span class="hs-comment">-- yield the representation of a list of types</span><span>
</span><a name="line-1140"></a><span class="hs-identifier">repLTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">]</span><span>
</span><a name="line-1141"></a><a name="repLTys"><a href="DsMeta.html#repLTys"><span class="hs-identifier">repLTys</span></a></a><span> </span><a name="local-6989586621681883023"><a href="#local-6989586621681883023"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883023"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1142"></a><span>
</span><a name="line-1143"></a><span class="hs-comment">-- represent a type</span><span>
</span><a name="line-1144"></a><span class="hs-identifier">repLTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-1145"></a><a name="repLTy"><a href="DsMeta.html#repLTy"><span class="hs-identifier">repLTy</span></a></a><span> </span><a name="local-6989586621681883024"><a href="#local-6989586621681883024"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTy"><span class="hs-identifier hs-var">repTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883024"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1146"></a><span>
</span><a name="line-1147"></a><span class="hs-identifier">repForall</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><span class="hs-comment">-- Arg of repForall is always HsForAllTy or HsQualTy</span><span>
</span><a name="line-1149"></a><a name="repForall"><a href="DsMeta.html#repForall"><span class="hs-identifier">repForall</span></a></a><span> </span><a name="local-6989586621681883025"><a href="#local-6989586621681883025"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1150"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883026"><a href="#local-6989586621681883026"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883027"><a href="#local-6989586621681883027"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883028"><a href="#local-6989586621681883028"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitLHsSigmaTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621681883025"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1151"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#addHsTyVarBinds"><span class="hs-identifier hs-var">addHsTyVarBinds</span></a><span> </span><a href="#local-6989586621681883026"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681883029"><a href="#local-6989586621681883029"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1152"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883030"><a href="#local-6989586621681883030"><span class="hs-identifier">ctxt1</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLContext"><span class="hs-identifier hs-var">repLContext</span></a><span> </span><a href="#local-6989586621681883027"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1153"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883031"><a href="#local-6989586621681883031"><span class="hs-identifier">ty1</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883028"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-1154"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTForall"><span class="hs-identifier hs-var">repTForall</span></a><span> </span><a href="#local-6989586621681883029"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621681883030"><span class="hs-identifier hs-var">ctxt1</span></a><span> </span><a href="#local-6989586621681883031"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-1157"></a><a name="repTy"><a href="DsMeta.html#repTy"><span class="hs-identifier">repTy</span></a></a><span> </span><a name="local-6989586621681883032"><a href="#local-6989586621681883032"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsForAllTy</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repForall"><span class="hs-identifier hs-var">repForall</span></a><span> </span><a href="#local-6989586621681883032"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1158"></a><span class="hs-identifier">repTy</span><span> </span><a name="local-6989586621681883033"><a href="#local-6989586621681883033"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQualTy</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repForall"><span class="hs-identifier hs-var">repForall</span></a><span> </span><a href="#local-6989586621681883033"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1159"></a><span>
</span><a name="line-1160"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883034"><a href="#local-6989586621681883034"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isLiftedTypeKindTyConName</span><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTStar"><span class="hs-identifier hs-var">repTStar</span></a><span>
</span><a name="line-1162"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">hasKey</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">constraintKindTyConKey</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTConstraint"><span class="hs-identifier hs-var">repTConstraint</span></a><span>
</span><a name="line-1163"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">hasKey</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">funTyConKey</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repArrowTyCon"><span class="hs-identifier hs-var">repArrowTyCon</span></a><span>
</span><a name="line-1164"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isTvOcc</span><span> </span><a href="#local-6989586621681883035"><span class="hs-identifier hs-var">occ</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883036"><a href="#local-6989586621681883036"><span class="hs-identifier">tv1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1165"></a><span>                       </span><a href="DsMeta.html#repTvar"><span class="hs-identifier hs-var">repTvar</span></a><span> </span><a href="#local-6989586621681883036"><span class="hs-identifier hs-var">tv1</span></a><span>
</span><a name="line-1166"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isDataOcc</span><span> </span><a href="#local-6989586621681883035"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883037"><a href="#local-6989586621681883037"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1167"></a><span>                       </span><a href="DsMeta.html#repPromotedDataCon"><span class="hs-identifier hs-var">repPromotedDataCon</span></a><span> </span><a href="#local-6989586621681883037"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-1168"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">eqTyConName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTequality"><span class="hs-identifier hs-var">repTequality</span></a><span>
</span><a name="line-1169"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883038"><a href="#local-6989586621681883038"><span class="hs-identifier">tc1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1170"></a><span>                       </span><a href="DsMeta.html#repNamedTyCon"><span class="hs-identifier hs-var">repNamedTyCon</span></a><span> </span><a href="#local-6989586621681883038"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-1171"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1172"></a><span>    </span><a name="local-6989586621681883035"><a href="#local-6989586621681883035"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nameOccName</span><span> </span><a href="#local-6989586621681883034"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1173"></a><span>
</span><a name="line-1174"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAppTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883039"><a href="#local-6989586621681883039"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681883040"><a href="#local-6989586621681883040"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1175"></a><span>                                </span><a name="local-6989586621681883041"><a href="#local-6989586621681883041"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883039"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1176"></a><span>                                </span><a name="local-6989586621681883042"><a href="#local-6989586621681883042"><span class="hs-identifier">a1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883040"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1177"></a><span>                                </span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681883041"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621681883042"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-1178"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAppKindTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883043"><a href="#local-6989586621681883043"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681883044"><a href="#local-6989586621681883044"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1179"></a><span>                                </span><a name="local-6989586621681883045"><a href="#local-6989586621681883045"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883043"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1180"></a><span>                                </span><a name="local-6989586621681883046"><a href="#local-6989586621681883046"><span class="hs-identifier">ki1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883044"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1181"></a><span>                                </span><a href="DsMeta.html#repTappKind"><span class="hs-identifier hs-var">repTappKind</span></a><span> </span><a href="#local-6989586621681883045"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621681883046"><span class="hs-identifier hs-var">ki1</span></a><span>
</span><a name="line-1182"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsFunTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883047"><a href="#local-6989586621681883047"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681883048"><a href="#local-6989586621681883048"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1183"></a><span>                                </span><a name="local-6989586621681883049"><a href="#local-6989586621681883049"><span class="hs-identifier">f1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883047"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1184"></a><span>                                </span><a name="local-6989586621681883050"><a href="#local-6989586621681883050"><span class="hs-identifier">a1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883048"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1185"></a><span>                                </span><a name="local-6989586621681883051"><a href="#local-6989586621681883051"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repArrowTyCon"><span class="hs-identifier hs-var">repArrowTyCon</span></a><span>
</span><a name="line-1186"></a><span>                                </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883051"><span class="hs-identifier hs-var">tcon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883049"><span class="hs-identifier hs-var">f1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883050"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">]</span><span>
</span><a name="line-1187"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsListTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883052"><a href="#local-6989586621681883052"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1188"></a><span>                                </span><a name="local-6989586621681883053"><a href="#local-6989586621681883053"><span class="hs-identifier">t1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883052"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1189"></a><span>                                </span><a name="local-6989586621681883054"><a href="#local-6989586621681883054"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repListTyCon"><span class="hs-identifier hs-var">repListTyCon</span></a><span>
</span><a name="line-1190"></a><span>                                </span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681883054"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883053"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1191"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTupleTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">HsUnboxedTuple</span><span> </span><a name="local-6989586621681883055"><a href="#local-6989586621681883055"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1192"></a><span>                                </span><a name="local-6989586621681883056"><a href="#local-6989586621681883056"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><a href="#local-6989586621681883055"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1193"></a><span>                                </span><a name="local-6989586621681883057"><a href="#local-6989586621681883057"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repUnboxedTupleTyCon"><span class="hs-identifier hs-var">repUnboxedTupleTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681883055"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1194"></a><span>                                </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883057"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883056"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-1195"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTupleTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883058"><a href="#local-6989586621681883058"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883059"><a href="#local-6989586621681883059"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><a href="#local-6989586621681883058"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1196"></a><span>                                 </span><a name="local-6989586621681883060"><a href="#local-6989586621681883060"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTupleTyCon"><span class="hs-identifier hs-var">repTupleTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681883058"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1197"></a><span>                                 </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883060"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883059"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-1198"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSumTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883061"><a href="#local-6989586621681883061"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883062"><a href="#local-6989586621681883062"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><a href="#local-6989586621681883061"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1199"></a><span>                                 </span><a name="local-6989586621681883063"><a href="#local-6989586621681883063"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repUnboxedSumTyCon"><span class="hs-identifier hs-var">repUnboxedSumTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681883061"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1200"></a><span>                                 </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883063"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883062"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-1201"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsOpTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883064"><a href="#local-6989586621681883064"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621681883065"><a href="#local-6989586621681883065"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681883066"><a href="#local-6989586621681883066"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">nlHsTyVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883065"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">nlHsAppTy</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681883064"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1202"></a><span>                                   </span><span class="hs-special">`</span><span class="hs-identifier hs-var">nlHsAppTy</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681883066"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883067"><a href="#local-6989586621681883067"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883067"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1204"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsStarTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="DsMeta.html#repTStar"><span class="hs-identifier hs-var">repTStar</span></a><span>
</span><a name="line-1205"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsKindSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883068"><a href="#local-6989586621681883068"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621681883069"><a href="#local-6989586621681883069"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1206"></a><span>                                </span><a name="local-6989586621681883070"><a href="#local-6989586621681883070"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883068"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1207"></a><span>                                </span><a name="local-6989586621681883071"><a href="#local-6989586621681883071"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883069"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1208"></a><span>                                </span><a href="DsMeta.html#repTSig"><span class="hs-identifier hs-var">repTSig</span></a><span> </span><a href="#local-6989586621681883070"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621681883071"><span class="hs-identifier hs-var">k1</span></a><span>
</span><a name="line-1209"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSpliceTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883072"><a href="#local-6989586621681883072"><span class="hs-identifier">splice</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repSplice"><span class="hs-identifier hs-var">repSplice</span></a><span> </span><a href="#local-6989586621681883072"><span class="hs-identifier hs-var">splice</span></a><span>
</span><a name="line-1210"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitListTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883073"><a href="#local-6989586621681883073"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1211"></a><span>                                    </span><a name="local-6989586621681883074"><a href="#local-6989586621681883074"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><a href="#local-6989586621681883073"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1212"></a><span>                                    </span><a href="DsMeta.html#repTPromotedList"><span class="hs-identifier hs-var">repTPromotedList</span></a><span> </span><a href="#local-6989586621681883074"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-1213"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsExplicitTupleTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883075"><a href="#local-6989586621681883075"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1214"></a><span>                                    </span><a name="local-6989586621681883076"><a href="#local-6989586621681883076"><span class="hs-identifier">tys1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTys"><span class="hs-identifier hs-var">repLTys</span></a><span> </span><a href="#local-6989586621681883075"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1215"></a><span>                                    </span><a name="local-6989586621681883077"><a href="#local-6989586621681883077"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPromotedTupleTyCon"><span class="hs-identifier hs-var">repPromotedTupleTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681883075"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1216"></a><span>                                    </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883077"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883076"><span class="hs-identifier hs-var">tys1</span></a><span>
</span><a name="line-1217"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTyLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883078"><a href="#local-6989586621681883078"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1218"></a><span>                          </span><a name="local-6989586621681883079"><a href="#local-6989586621681883079"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTyLit"><span class="hs-identifier hs-var">repTyLit</span></a><span> </span><a href="#local-6989586621681883078"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-1219"></a><span>                          </span><a href="DsMeta.html#repTLit"><span class="hs-identifier hs-var">repTLit</span></a><span> </span><a href="#local-6989586621681883079"><span class="hs-identifier hs-var">lit'</span></a><span>
</span><a name="line-1220"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWildCardTy</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repTWildCard"><span class="hs-identifier hs-var">repTWildCard</span></a><span>
</span><a name="line-1221"></a><span class="hs-identifier">repTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIParamTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883080"><a href="#local-6989586621681883080"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681883081"><a href="#local-6989586621681883081"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1222"></a><span>                             </span><a name="local-6989586621681883082"><a href="#local-6989586621681883082"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_implicit_param_name"><span class="hs-identifier hs-var">rep_implicit_param_name</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883080"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1223"></a><span>                             </span><a name="local-6989586621681883083"><a href="#local-6989586621681883083"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883081"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1224"></a><span>                             </span><a href="DsMeta.html#repTImplicitParam"><span class="hs-identifier hs-var">repTImplicitParam</span></a><span> </span><a href="#local-6989586621681883082"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-6989586621681883083"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-1225"></a><span>
</span><a name="line-1226"></a><span class="hs-identifier">repTy</span><span> </span><a name="local-6989586621681883084"><a href="#local-6989586621681883084"><span class="hs-identifier">ty</span></a></a><span>                      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Exotic form of type&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883084"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span class="hs-identifier">repTyLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsTyLit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyLitQ</span><span class="hs-special">)</span><span>
</span><a name="line-1229"></a><a name="repTyLit"><a href="DsMeta.html#repTyLit"><span class="hs-identifier">repTyLit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsNumTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883085"><a href="#local-6989586621681883085"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883086"><a href="#local-6989586621681883086"><span class="hs-identifier">iExpr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mkIntegerExpr</span><span> </span><a href="#local-6989586621681883085"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1230"></a><span>                            </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#numTyLitName"><span class="hs-identifier hs-var">numTyLitName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883086"><span class="hs-identifier hs-var">iExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1231"></a><span class="hs-identifier">repTyLit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsStrTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883087"><a href="#local-6989586621681883087"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883088"><a href="#local-6989586621681883088"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mkStringExprFS</span><span> </span><a href="#local-6989586621681883087"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1232"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#strTyLitName"><span class="hs-identifier hs-var">strTyLitName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883088"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1233"></a><span>                            </span><span class="hs-special">}</span><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-comment">-- | Represent a type wrapped in a Maybe</span><span>
</span><a name="line-1236"></a><span class="hs-identifier">repMaybeLTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsKind</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-1237"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1238"></a><a name="repMaybeLTy"><a href="DsMeta.html#repMaybeLTy"><span class="hs-identifier">repMaybeLTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repMaybe"><span class="hs-identifier hs-var">repMaybe</span></a><span> </span><a href="THNames.html#kindQTyConName"><span class="hs-identifier hs-var">kindQTyConName</span></a><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span>
</span><a name="line-1239"></a><span>
</span><a name="line-1240"></a><span class="hs-identifier">repRole</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Role</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Role</span><span class="hs-special">)</span><span>
</span><a name="line-1241"></a><a name="repRole"><a href="DsMeta.html#repRole"><span class="hs-identifier">repRole</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#nominalRName"><span class="hs-identifier hs-var">nominalRName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1242"></a><span class="hs-identifier">repRole</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Representational</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#representationalRName"><span class="hs-identifier hs-var">representationalRName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">repRole</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Phantom</span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#phantomRName"><span class="hs-identifier hs-var">phantomRName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1244"></a><span class="hs-identifier">repRole</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#inferRName"><span class="hs-identifier hs-var">inferRName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1245"></a><span class="hs-identifier">repRole</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repRole: Impossible Match&quot;</span><span> </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1246"></a><span>
</span><a name="line-1247"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1248"></a><span class="hs-comment">--              Splices</span><span>
</span><a name="line-1249"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span class="hs-identifier">repSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsSplice</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882479"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1252"></a><span class="hs-comment">-- See Note [How brackets and nested splices are handled] in TcSplice</span><span>
</span><a name="line-1253"></a><span class="hs-comment">-- We return a CoreExpr of any old type; the context should know</span><span>
</span><a name="line-1254"></a><a name="repSplice"><a href="DsMeta.html#repSplice"><span class="hs-identifier">repSplice</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypedSplice</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883089"><a href="#local-6989586621681883089"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_splice"><span class="hs-identifier hs-var">rep_splice</span></a><span> </span><a href="#local-6989586621681883089"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1255"></a><span class="hs-identifier">repSplice</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsUntypedSplice</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883090"><a href="#local-6989586621681883090"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_splice"><span class="hs-identifier hs-var">rep_splice</span></a><span> </span><a href="#local-6989586621681883090"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1256"></a><span class="hs-identifier">repSplice</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQuasiQuote</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883091"><a href="#local-6989586621681883091"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_splice"><span class="hs-identifier hs-var">rep_splice</span></a><span> </span><a href="#local-6989586621681883091"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1257"></a><span class="hs-identifier">repSplice</span><span> </span><a name="local-6989586621681883092"><a href="#local-6989586621681883092"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSpliced</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;repSplice&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883092"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1258"></a><span class="hs-identifier">repSplice</span><span> </span><a name="local-6989586621681883093"><a href="#local-6989586621681883093"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSplicedT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;repSpliceT&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883093"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1259"></a><span class="hs-identifier">repSplice</span><span> </span><a name="local-6989586621681883094"><a href="#local-6989586621681883094"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">XSplice</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;repSplice&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883094"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>
</span><a name="line-1261"></a><span class="hs-identifier">rep_splice</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882478"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><a name="rep_splice"><a href="DsMeta.html#rep_splice"><span class="hs-identifier">rep_splice</span></a></a><span> </span><a name="local-6989586621681883095"><a href="#local-6989586621681883095"><span class="hs-identifier">splice_name</span></a></a><span>
</span><a name="line-1263"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883096"><a href="#local-6989586621681883096"><span class="hs-identifier">mb_val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupMetaEnv"><span class="hs-identifier hs-var">dsLookupMetaEnv</span></a><span> </span><a href="#local-6989586621681883095"><span class="hs-identifier hs-var">splice_name</span></a><span>
</span><a name="line-1264"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883096"><span class="hs-identifier hs-var">mb_val</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1265"></a><span>           </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DsSplice</span><span> </span><a name="local-6989586621681883097"><a href="#local-6989586621681883097"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883098"><a href="#local-6989586621681883098"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsExpr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a><span> </span><a href="#local-6989586621681883097"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1266"></a><span>                                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a href="#local-6989586621681883098"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1267"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;HsSplice&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883095"><span class="hs-identifier hs-var">splice_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1268"></a><span>                        </span><span class="hs-comment">-- Should not happen; statically checked</span><span>
</span><a name="line-1269"></a><span>
</span><a name="line-1270"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1271"></a><span class="hs-comment">--              Expressions</span><span>
</span><a name="line-1272"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1273"></a><span>
</span><a name="line-1274"></a><span class="hs-identifier">repLEs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1275"></a><a name="repLEs"><a href="DsMeta.html#repLEs"><span class="hs-identifier">repLEs</span></a></a><span> </span><a name="local-6989586621681883099"><a href="#local-6989586621681883099"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#expQTyConName"><span class="hs-identifier hs-var">expQTyConName</span></a><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883099"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-1276"></a><span>
</span><a name="line-1277"></a><span class="hs-comment">-- FIXME: some of these panics should be converted into proper error messages</span><span>
</span><a name="line-1278"></a><span class="hs-comment">--        unless we can make sure that constructs, which are plainly not</span><span>
</span><a name="line-1279"></a><span class="hs-comment">--        supported in TH already lead to error messages at an earlier stage</span><span>
</span><a name="line-1280"></a><span class="hs-identifier">repLE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-1281"></a><a name="repLE"><a href="DsMeta.html#repLE"><span class="hs-identifier">repLE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883100"><a href="#local-6989586621681883100"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681883101"><a href="#local-6989586621681883101"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621681883100"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repE"><span class="hs-identifier hs-var">repE</span></a><span> </span><a href="#local-6989586621681883101"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><a name="repE"><a href="DsMeta.html#repE"><span class="hs-identifier">repE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883102"><a href="#local-6989586621681883102"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1285"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883103"><a href="#local-6989586621681883103"><span class="hs-identifier">mb_val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupMetaEnv"><span class="hs-identifier hs-var">dsLookupMetaEnv</span></a><span> </span><a href="#local-6989586621681883102"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1286"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883103"><span class="hs-identifier hs-var">mb_val</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1287"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883104"><a href="#local-6989586621681883104"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#globalVar"><span class="hs-identifier hs-var">globalVar</span></a><span> </span><a href="#local-6989586621681883102"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1288"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repVarOrCon"><span class="hs-identifier hs-var">repVarOrCon</span></a><span> </span><a href="#local-6989586621681883102"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681883104"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1289"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DsBound</span><span> </span><a name="local-6989586621681883105"><a href="#local-6989586621681883105"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#repVarOrCon"><span class="hs-identifier hs-var">repVarOrCon</span></a><span> </span><a href="#local-6989586621681883102"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreVar"><span class="hs-identifier hs-var">coreVar</span></a><span> </span><a href="#local-6989586621681883105"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-1290"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DsSplice</span><span> </span><a name="local-6989586621681883106"><a href="#local-6989586621681883106"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883107"><a href="#local-6989586621681883107"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsExpr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a><span> </span><a href="#local-6989586621681883106"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1291"></a><span>                                 </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a href="#local-6989586621681883107"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883108"><a href="#local-6989586621681883108"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep_implicit_param_name"><span class="hs-identifier hs-var">rep_implicit_param_name</span></a><span> </span><a href="#local-6989586621681883108"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="DsMeta.html#repImplicitParamVar"><span class="hs-identifier hs-var">repImplicitParamVar</span></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsOverLabel</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883109"><a href="#local-6989586621681883109"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repOverLabel"><span class="hs-identifier hs-var">repOverLabel</span></a><span> </span><a href="#local-6989586621681883109"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1294"></a><span>
</span><a name="line-1295"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883110"><a href="#local-6989586621681883110"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFld</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883111"><a href="#local-6989586621681883111"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883111"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1296"></a><span>  </span><span class="hs-identifier hs-var">Unambiguous</span><span> </span><a name="local-6989586621681883112"><a href="#local-6989586621681883112"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#repE"><span class="hs-identifier hs-var">repE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">noLoc</span><span> </span><a href="#local-6989586621681883112"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span>  </span><span class="hs-identifier hs-var">Ambiguous</span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Ambiguous record selectors&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883110"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>  </span><span class="hs-identifier hs-var">XAmbiguousFieldOcc</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;XAmbiguous record selectors&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883110"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span>        </span><span class="hs-comment">-- Remember, we're desugaring renamer output here, so</span><span>
</span><a name="line-1301"></a><span>        </span><span class="hs-comment">-- HsOverlit can definitely occur</span><span>
</span><a name="line-1302"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsOverLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883113"><a href="#local-6989586621681883113"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883114"><a href="#local-6989586621681883114"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repOverloadedLiteral"><span class="hs-identifier hs-var">repOverloadedLiteral</span></a><span> </span><a href="#local-6989586621681883113"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repLit"><span class="hs-identifier hs-var">repLit</span></a><span> </span><a href="#local-6989586621681883114"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1303"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883115"><a href="#local-6989586621681883115"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883116"><a href="#local-6989586621681883116"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLiteral"><span class="hs-identifier hs-var">repLiteral</span></a><span> </span><a href="#local-6989586621681883115"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">;</span><span>           </span><a href="DsMeta.html#repLit"><span class="hs-identifier hs-var">repLit</span></a><span> </span><a href="#local-6989586621681883116"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1304"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLam</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681883117"><a href="#local-6989586621681883117"><span class="hs-identifier">m</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLambda"><span class="hs-identifier hs-var">repLambda</span></a><span> </span><a href="#local-6989586621681883117"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1305"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLamCase</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883118"><a href="#local-6989586621681883118"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883119"><a href="#local-6989586621681883119"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repMatchTup"><span class="hs-identifier hs-var">repMatchTup</span></a><span> </span><a href="#local-6989586621681883118"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1307"></a><span>                        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883120"><a href="#local-6989586621681883120"><span class="hs-identifier">core_ms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#matchQTyConName"><span class="hs-identifier hs-var">matchQTyConName</span></a><span> </span><a href="#local-6989586621681883119"><span class="hs-identifier hs-var">ms'</span></a><span>
</span><a name="line-1308"></a><span>                        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repLamCase"><span class="hs-identifier hs-var">repLamCase</span></a><span> </span><a href="#local-6989586621681883120"><span class="hs-identifier hs-var">core_ms</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1309"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883121"><a href="#local-6989586621681883121"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883122"><a href="#local-6989586621681883122"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><a name="local-6989586621681883123"><a href="#local-6989586621681883123"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883121"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883124"><a href="#local-6989586621681883124"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883122"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repApp"><span class="hs-identifier hs-var">repApp</span></a><span> </span><a href="#local-6989586621681883123"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681883124"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">}</span><span>
</span><a name="line-1310"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsAppType</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883125"><a href="#local-6989586621681883125"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621681883126"><a href="#local-6989586621681883126"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883127"><a href="#local-6989586621681883127"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883125"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1311"></a><span>                            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883128"><a href="#local-6989586621681883128"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621681883126"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1312"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repAppType"><span class="hs-identifier hs-var">repAppType</span></a><span> </span><a href="#local-6989586621681883127"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681883128"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">OpApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883129"><a href="#local-6989586621681883129"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621681883130"><a href="#local-6989586621681883130"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621681883131"><a href="#local-6989586621681883131"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1315"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883132"><a href="#local-6989586621681883132"><span class="hs-identifier">arg1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883129"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">;</span><span>
</span><a name="line-1316"></a><span>       </span><a name="local-6989586621681883133"><a href="#local-6989586621681883133"><span class="hs-identifier">arg2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883131"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">;</span><span>
</span><a name="line-1317"></a><span>       </span><a name="local-6989586621681883134"><a href="#local-6989586621681883134"><span class="hs-identifier">the_op</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883130"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1318"></a><span>       </span><a href="DsMeta.html#repInfixApp"><span class="hs-identifier hs-var">repInfixApp</span></a><span> </span><a href="#local-6989586621681883132"><span class="hs-identifier hs-var">arg1</span></a><span> </span><a href="#local-6989586621681883134"><span class="hs-identifier hs-var">the_op</span></a><span> </span><a href="#local-6989586621681883133"><span class="hs-identifier hs-var">arg2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1319"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NegApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883135"><a href="#local-6989586621681883135"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1320"></a><span>                              </span><a name="local-6989586621681883136"><a href="#local-6989586621681883136"><span class="hs-identifier">a</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883135"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1321"></a><span>                              </span><a name="local-6989586621681883137"><a href="#local-6989586621681883137"><span class="hs-identifier">negateVar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><span class="hs-identifier hs-var">negateName</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="DsMeta.html#repVar"><span class="hs-identifier hs-var">repVar</span></a><span>
</span><a name="line-1322"></a><span>                              </span><a href="#local-6989586621681883137"><span class="hs-identifier hs-var">negateVar</span></a><span> </span><span class="hs-special">`</span><a href="DsMeta.html#repApp"><span class="hs-identifier hs-var">repApp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681883136"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1323"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883138"><a href="#local-6989586621681883138"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883138"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1324"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SectionL</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883139"><a href="#local-6989586621681883139"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883140"><a href="#local-6989586621681883140"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883141"><a href="#local-6989586621681883141"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883139"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883142"><a href="#local-6989586621681883142"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883140"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repSectionL"><span class="hs-identifier hs-var">repSectionL</span></a><span> </span><a href="#local-6989586621681883141"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681883142"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1325"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SectionR</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883143"><a href="#local-6989586621681883143"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883144"><a href="#local-6989586621681883144"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883145"><a href="#local-6989586621681883145"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883143"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883146"><a href="#local-6989586621681883146"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883144"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repSectionR"><span class="hs-identifier hs-var">repSectionR</span></a><span> </span><a href="#local-6989586621681883145"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681883146"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1326"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsCase</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883147"><a href="#local-6989586621681883147"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883148"><a href="#local-6989586621681883148"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1327"></a><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883149"><a href="#local-6989586621681883149"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883147"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1328"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883150"><a href="#local-6989586621681883150"><span class="hs-identifier">ms2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repMatchTup"><span class="hs-identifier hs-var">repMatchTup</span></a><span> </span><a href="#local-6989586621681883148"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1329"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883151"><a href="#local-6989586621681883151"><span class="hs-identifier">core_ms2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#matchQTyConName"><span class="hs-identifier hs-var">matchQTyConName</span></a><span> </span><a href="#local-6989586621681883150"><span class="hs-identifier hs-var">ms2</span></a><span>
</span><a name="line-1330"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repCaseE"><span class="hs-identifier hs-var">repCaseE</span></a><span> </span><a href="#local-6989586621681883149"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-6989586621681883151"><span class="hs-identifier hs-var">core_ms2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1331"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIf</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883152"><a href="#local-6989586621681883152"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883153"><a href="#local-6989586621681883153"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621681883154"><a href="#local-6989586621681883154"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1332"></a><span>                              </span><a name="local-6989586621681883155"><a href="#local-6989586621681883155"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883152"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1333"></a><span>                              </span><a name="local-6989586621681883156"><a href="#local-6989586621681883156"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883153"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-1334"></a><span>                              </span><a name="local-6989586621681883157"><a href="#local-6989586621681883157"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883154"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1335"></a><span>                              </span><a href="DsMeta.html#repCond"><span class="hs-identifier hs-var">repCond</span></a><span> </span><a href="#local-6989586621681883155"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681883156"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621681883157"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1336"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsMultiIf</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883158"><a href="#local-6989586621681883158"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1337"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883159"><a href="#local-6989586621681883159"><span class="hs-identifier">binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883160"><a href="#local-6989586621681883160"><span class="hs-identifier">alts'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repLGRHS"><span class="hs-identifier hs-var">repLGRHS</span></a><span> </span><a href="#local-6989586621681883158"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-1338"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883161"><a href="#local-6989586621681883161"><span class="hs-identifier">expr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMultiIf"><span class="hs-identifier hs-var">repMultiIf</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883160"><span class="hs-identifier hs-var">alts'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621681883159"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883161"><span class="hs-identifier hs-var">expr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1340"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsLet</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883162"><a href="#local-6989586621681883162"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883163"><a href="#local-6989586621681883163"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883164"><a href="#local-6989586621681883164"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883165"><a href="#local-6989586621681883165"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883162"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1341"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883166"><a href="#local-6989586621681883166"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883164"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883163"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1342"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883167"><a href="#local-6989586621681883167"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLetE"><span class="hs-identifier hs-var">repLetE</span></a><span> </span><a href="#local-6989586621681883165"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621681883166"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1343"></a><span>                                     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883164"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883167"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span class="hs-comment">-- FIXME: I haven't got the types here right yet</span><span>
</span><a name="line-1346"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883168"><a href="#local-6989586621681883168"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsDo</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883169"><a href="#local-6989586621681883169"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883170"><a href="#local-6989586621681883170"><span class="hs-identifier">sts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883169"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">DoExpr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">GhciStmtCtxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1348"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883171"><a href="#local-6989586621681883171"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883172"><a href="#local-6989586621681883172"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLSts"><span class="hs-identifier hs-var">repLSts</span></a><span> </span><a href="#local-6989586621681883170"><span class="hs-identifier hs-var">sts</span></a><span class="hs-special">;</span><span>
</span><a name="line-1349"></a><span>        </span><a name="local-6989586621681883173"><a href="#local-6989586621681883173"><span class="hs-identifier">e'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repDoE"><span class="hs-identifier hs-var">repDoE</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883172"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-1350"></a><span>        </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883171"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883173"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1351"></a><span>
</span><a name="line-1352"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">ListComp</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883169"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1353"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883174"><a href="#local-6989586621681883174"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883175"><a href="#local-6989586621681883175"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLSts"><span class="hs-identifier hs-var">repLSts</span></a><span> </span><a href="#local-6989586621681883170"><span class="hs-identifier hs-var">sts</span></a><span class="hs-special">;</span><span>
</span><a name="line-1354"></a><span>        </span><a name="local-6989586621681883176"><a href="#local-6989586621681883176"><span class="hs-identifier">e'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repComp"><span class="hs-identifier hs-var">repComp</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883175"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-1355"></a><span>        </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883174"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883176"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1356"></a><span>
</span><a name="line-1357"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">MDoExpr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883169"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1358"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883177"><a href="#local-6989586621681883177"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883178"><a href="#local-6989586621681883178"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLSts"><span class="hs-identifier hs-var">repLSts</span></a><span> </span><a href="#local-6989586621681883170"><span class="hs-identifier hs-var">sts</span></a><span class="hs-special">;</span><span>
</span><a name="line-1359"></a><span>        </span><a name="local-6989586621681883179"><a href="#local-6989586621681883179"><span class="hs-identifier">e'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMDoE"><span class="hs-identifier hs-var">repMDoE</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883178"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-1360"></a><span>        </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883177"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883179"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1361"></a><span>
</span><a name="line-1362"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1363"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;monad comprehension and [: :]&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883168"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplicitList</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883180"><a href="#local-6989586621681883180"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883181"><a href="#local-6989586621681883181"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLEs"><span class="hs-identifier hs-var">repLEs</span></a><span> </span><a href="#local-6989586621681883180"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repListExp"><span class="hs-identifier hs-var">repListExp</span></a><span> </span><a href="#local-6989586621681883181"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1366"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883182"><a href="#local-6989586621681883182"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplicitTuple</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883183"><a href="#local-6989586621681883183"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621681883184"><a href="#local-6989586621681883184"><span class="hs-identifier">boxed</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-identifier hs-var">tupArgPresent</span><span> </span><a href="#local-6989586621681883183"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Tuple sections&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883182"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1368"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isBoxed</span><span> </span><a href="#local-6989586621681883184"><span class="hs-identifier hs-var">boxed</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883186"><a href="#local-6989586621681883186"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLEs"><span class="hs-identifier hs-var">repLEs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883185"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Present</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883185"><a href="#local-6989586621681883185"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883183"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-1369"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTup"><span class="hs-identifier hs-var">repTup</span></a><span> </span><a href="#local-6989586621681883186"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1370"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883188"><a href="#local-6989586621681883188"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLEs"><span class="hs-identifier hs-var">repLEs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883187"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Present</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883187"><a href="#local-6989586621681883187"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883183"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-1371"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repUnboxedTup"><span class="hs-identifier hs-var">repUnboxedTup</span></a><span> </span><a href="#local-6989586621681883188"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1372"></a><span>
</span><a name="line-1373"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplicitSum</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883189"><a href="#local-6989586621681883189"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621681883190"><a href="#local-6989586621681883190"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621681883191"><a href="#local-6989586621681883191"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1374"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883192"><a href="#local-6989586621681883192"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883191"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1375"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repUnboxedSum"><span class="hs-identifier hs-var">repUnboxedSum</span></a><span> </span><a href="#local-6989586621681883192"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621681883189"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621681883190"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1376"></a><span>
</span><a name="line-1377"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecordCon</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883193"><a href="#local-6989586621681883193"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883194"><a href="#local-6989586621681883194"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1378"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883195"><a href="#local-6989586621681883195"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883193"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">;</span><span>
</span><a name="line-1379"></a><span>        </span><a name="local-6989586621681883196"><a href="#local-6989586621681883196"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFields"><span class="hs-identifier hs-var">repFields</span></a><span> </span><a href="#local-6989586621681883194"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">;</span><span>
</span><a name="line-1380"></a><span>        </span><a href="DsMeta.html#repRecCon"><span class="hs-identifier hs-var">repRecCon</span></a><span> </span><a href="#local-6989586621681883195"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681883196"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1381"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecordUpd</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883197"><a href="#local-6989586621681883197"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883198"><a href="#local-6989586621681883198"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883199"><a href="#local-6989586621681883199"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883197"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span>
</span><a name="line-1383"></a><span>        </span><a name="local-6989586621681883200"><a href="#local-6989586621681883200"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repUpdFields"><span class="hs-identifier hs-var">repUpdFields</span></a><span> </span><a href="#local-6989586621681883198"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">;</span><span>
</span><a name="line-1384"></a><span>        </span><a href="DsMeta.html#repRecUpd"><span class="hs-identifier hs-var">repRecUpd</span></a><span> </span><a href="#local-6989586621681883199"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681883200"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExprWithTySig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883201"><a href="#local-6989586621681883201"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621681883202"><a href="#local-6989586621681883202"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1387"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883203"><a href="#local-6989586621681883203"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883201"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1388"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883204"><a href="#local-6989586621681883204"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repHsSigWcType"><span class="hs-identifier hs-var">repHsSigWcType</span></a><span> </span><a href="#local-6989586621681883202"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1389"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repSigExp"><span class="hs-identifier hs-var">repSigExp</span></a><span> </span><a href="#local-6989586621681883203"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621681883204"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1390"></a><span>
</span><a name="line-1391"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ArithSeq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883205"><a href="#local-6989586621681883205"><span class="hs-identifier">aseq</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1392"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883205"><span class="hs-identifier hs-var">aseq</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1393"></a><span>    </span><span class="hs-identifier hs-var">From</span><span> </span><a name="local-6989586621681883206"><a href="#local-6989586621681883206"><span class="hs-identifier">e</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883207"><a href="#local-6989586621681883207"><span class="hs-identifier">ds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883206"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repFrom"><span class="hs-identifier hs-var">repFrom</span></a><span> </span><a href="#local-6989586621681883207"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1394"></a><span>    </span><span class="hs-identifier hs-var">FromThen</span><span> </span><a name="local-6989586621681883208"><a href="#local-6989586621681883208"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621681883209"><a href="#local-6989586621681883209"><span class="hs-identifier">e2</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1395"></a><span>                             </span><a name="local-6989586621681883210"><a href="#local-6989586621681883210"><span class="hs-identifier">ds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883208"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1396"></a><span>                             </span><a name="local-6989586621681883211"><a href="#local-6989586621681883211"><span class="hs-identifier">ds2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883209"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1397"></a><span>                             </span><a href="DsMeta.html#repFromThen"><span class="hs-identifier hs-var">repFromThen</span></a><span> </span><a href="#local-6989586621681883210"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621681883211"><span class="hs-identifier hs-var">ds2</span></a><span>
</span><a name="line-1398"></a><span>    </span><span class="hs-identifier hs-var">FromTo</span><span>   </span><a name="local-6989586621681883212"><a href="#local-6989586621681883212"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621681883213"><a href="#local-6989586621681883213"><span class="hs-identifier">e2</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1399"></a><span>                             </span><a name="local-6989586621681883214"><a href="#local-6989586621681883214"><span class="hs-identifier">ds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883212"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1400"></a><span>                             </span><a name="local-6989586621681883215"><a href="#local-6989586621681883215"><span class="hs-identifier">ds2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883213"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1401"></a><span>                             </span><a href="DsMeta.html#repFromTo"><span class="hs-identifier hs-var">repFromTo</span></a><span> </span><a href="#local-6989586621681883214"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621681883215"><span class="hs-identifier hs-var">ds2</span></a><span>
</span><a name="line-1402"></a><span>    </span><span class="hs-identifier hs-var">FromThenTo</span><span> </span><a name="local-6989586621681883216"><a href="#local-6989586621681883216"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621681883217"><a href="#local-6989586621681883217"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621681883218"><a href="#local-6989586621681883218"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1403"></a><span>                             </span><a name="local-6989586621681883219"><a href="#local-6989586621681883219"><span class="hs-identifier">ds1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883216"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1404"></a><span>                             </span><a name="local-6989586621681883220"><a href="#local-6989586621681883220"><span class="hs-identifier">ds2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883217"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1405"></a><span>                             </span><a name="local-6989586621681883221"><a href="#local-6989586621681883221"><span class="hs-identifier">ds3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883218"><span class="hs-identifier hs-var">e3</span></a><span>
</span><a name="line-1406"></a><span>                             </span><a href="DsMeta.html#repFromThenTo"><span class="hs-identifier hs-var">repFromThenTo</span></a><span> </span><a href="#local-6989586621681883219"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621681883220"><span class="hs-identifier hs-var">ds2</span></a><span> </span><a href="#local-6989586621681883221"><span class="hs-identifier hs-var">ds3</span></a><span>
</span><a name="line-1407"></a><span>
</span><a name="line-1408"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSpliceE</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883222"><a href="#local-6989586621681883222"><span class="hs-identifier">splice</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repSplice"><span class="hs-identifier hs-var">repSplice</span></a><span> </span><a href="#local-6989586621681883222"><span class="hs-identifier hs-var">splice</span></a><span>
</span><a name="line-1409"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsStatic</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883223"><a href="#local-6989586621681883223"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883223"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#staticEName"><span class="hs-identifier hs-var">staticEName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span>
</span><a name="line-1410"></a><span class="hs-identifier">repE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsUnboundVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883224"><a href="#local-6989586621681883224"><span class="hs-identifier">uv</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1411"></a><span>                               </span><a name="local-6989586621681883225"><a href="#local-6989586621681883225"><span class="hs-identifier">occ</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#occNameLit"><span class="hs-identifier hs-var">occNameLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unboundVarOcc</span><span> </span><a href="#local-6989586621681883224"><span class="hs-identifier hs-var">uv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>                               </span><a name="local-6989586621681883226"><a href="#local-6989586621681883226"><span class="hs-identifier">sname</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repNameS"><span class="hs-identifier hs-var">repNameS</span></a><span> </span><a href="#local-6989586621681883225"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-1413"></a><span>                               </span><a href="DsMeta.html#repUnboundVar"><span class="hs-identifier hs-var">repUnboundVar</span></a><span> </span><a href="#local-6989586621681883226"><span class="hs-identifier hs-var">sname</span></a><span>
</span><a name="line-1414"></a><span>
</span><a name="line-1415"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883227"><a href="#local-6989586621681883227"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsCoreAnn</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Core annotations&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883227"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1416"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883228"><a href="#local-6989586621681883228"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsSCC</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Cost centres&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883228"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883229"><a href="#local-6989586621681883229"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTickPragma</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Tick Pragma&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883229"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><span class="hs-identifier">repE</span><span> </span><a name="local-6989586621681883230"><a href="#local-6989586621681883230"><span class="hs-identifier">e</span></a></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Expression form&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883230"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><span>
</span><a name="line-1420"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1421"></a><span class="hs-comment">-- Building representations of auxillary structures like Match, Clause, Stmt,</span><span>
</span><a name="line-1422"></a><span>
</span><a name="line-1423"></a><span class="hs-identifier">repMatchTup</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">LMatch</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.MatchQ</span><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><a name="repMatchTup"><a href="DsMeta.html#repMatchTup"><span class="hs-identifier">repMatchTup</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681883231"><a href="#local-6989586621681883231"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-1425"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883232"><a href="#local-6989586621681883232"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883233"><a href="#local-6989586621681883233"><span class="hs-identifier">wheres</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1426"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883234"><a href="#local-6989586621681883234"><span class="hs-identifier">ss1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">collectPatBinders</span><span> </span><a href="#local-6989586621681883231"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883234"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1428"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883235"><a href="#local-6989586621681883235"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883231"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1429"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883236"><a href="#local-6989586621681883236"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883237"><a href="#local-6989586621681883237"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883233"><span class="hs-identifier hs-var">wheres</span></a><span>
</span><a name="line-1430"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883236"><span class="hs-identifier hs-var">ss2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1431"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883238"><a href="#local-6989586621681883238"><span class="hs-identifier">gs</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repGuards"><span class="hs-identifier hs-var">repGuards</span></a><span> </span><a href="#local-6989586621681883232"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-1432"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883239"><a href="#local-6989586621681883239"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repMatch"><span class="hs-identifier hs-var">repMatch</span></a><span> </span><a href="#local-6989586621681883235"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621681883238"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621681883237"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1433"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883234"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883236"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883239"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1434"></a><span class="hs-identifier">repMatchTup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repMatchTup: case alt with more than one arg&quot;</span><span>
</span><a name="line-1435"></a><span>
</span><a name="line-1436"></a><span class="hs-identifier">repClauseTup</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">LMatch</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ClauseQ</span><span class="hs-special">)</span><span>
</span><a name="line-1437"></a><a name="repClauseTup"><a href="DsMeta.html#repClauseTup"><span class="hs-identifier">repClauseTup</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883240"><a href="#local-6989586621681883240"><span class="hs-identifier">ps</span></a></a><span>
</span><a name="line-1438"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883241"><a href="#local-6989586621681883241"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883242"><a href="#local-6989586621681883242"><span class="hs-identifier">wheres</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1439"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883243"><a href="#local-6989586621681883243"><span class="hs-identifier">ss1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">collectPatsBinders</span><span> </span><a href="#local-6989586621681883240"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883243"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1441"></a><span>       </span><a name="local-6989586621681883244"><a href="#local-6989586621681883244"><span class="hs-identifier">ps1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883240"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1442"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883245"><a href="#local-6989586621681883245"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883246"><a href="#local-6989586621681883246"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883242"><span class="hs-identifier hs-var">wheres</span></a><span>
</span><a name="line-1443"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883245"><span class="hs-identifier hs-var">ss2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1444"></a><span>       </span><a name="local-6989586621681883247"><a href="#local-6989586621681883247"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repGuards"><span class="hs-identifier hs-var">repGuards</span></a><span> </span><a href="#local-6989586621681883241"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-1445"></a><span>     </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883248"><a href="#local-6989586621681883248"><span class="hs-identifier">clause</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repClause"><span class="hs-identifier hs-var">repClause</span></a><span> </span><a href="#local-6989586621681883244"><span class="hs-identifier hs-var">ps1</span></a><span> </span><a href="#local-6989586621681883247"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621681883246"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1446"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883243"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883245"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883248"><span class="hs-identifier hs-var">clause</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1447"></a><span class="hs-identifier">repClauseTup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XGRHSs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repClauseTup&quot;</span><span>
</span><a name="line-1448"></a><span class="hs-identifier">repClauseTup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repClauseTup&quot;</span><span>
</span><a name="line-1449"></a><span>
</span><a name="line-1450"></a><span class="hs-identifier">repGuards</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><a name="repGuards"><a href="DsMeta.html#repGuards"><span class="hs-identifier">repGuards</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621681883249"><a href="#local-6989586621681883249"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1452"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><a name="local-6989586621681883250"><a href="#local-6989586621681883250"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883249"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repNormal"><span class="hs-identifier hs-var">repNormal</span></a><span> </span><a href="#local-6989586621681883250"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1453"></a><span class="hs-identifier">repGuards</span><span> </span><a name="local-6989586621681883251"><a href="#local-6989586621681883251"><span class="hs-identifier">other</span></a></a><span>
</span><a name="line-1454"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883252"><a href="#local-6989586621681883252"><span class="hs-identifier">zs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repLGRHS"><span class="hs-identifier hs-var">repLGRHS</span></a><span> </span><a href="#local-6989586621681883251"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1455"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883253"><a href="#local-6989586621681883253"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883254"><a href="#local-6989586621681883254"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><a href="#local-6989586621681883252"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-1456"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883255"><a href="#local-6989586621681883255"><span class="hs-identifier">gd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repGuarded"><span class="hs-identifier hs-var">repGuarded</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883254"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1457"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621681883253"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883255"><span class="hs-identifier hs-var">gd</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1458"></a><span>
</span><a name="line-1459"></a><span class="hs-identifier">repLGRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LGRHS</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-1460"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1461"></a><a name="repLGRHS"><a href="DsMeta.html#repLGRHS"><span class="hs-identifier">repLGRHS</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BodyStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883256"><a href="#local-6989586621681883256"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a name="local-6989586621681883257"><a href="#local-6989586621681883257"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1462"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883258"><a href="#local-6989586621681883258"><span class="hs-identifier">guarded</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLNormalGE"><span class="hs-identifier hs-var">repLNormalGE</span></a><span> </span><a href="#local-6989586621681883256"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621681883257"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1463"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883258"><span class="hs-identifier hs-var">guarded</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1464"></a><span class="hs-identifier">repLGRHS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883259"><a href="#local-6989586621681883259"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621681883260"><a href="#local-6989586621681883260"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1465"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883261"><a href="#local-6989586621681883261"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883262"><a href="#local-6989586621681883262"><span class="hs-identifier">ss'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLSts"><span class="hs-identifier hs-var">repLSts</span></a><span> </span><a href="#local-6989586621681883259"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1466"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883263"><a href="#local-6989586621681883263"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883261"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883260"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1467"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883264"><a href="#local-6989586621681883264"><span class="hs-identifier">guarded</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPatGE"><span class="hs-identifier hs-var">repPatGE</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883262"><span class="hs-identifier hs-var">ss'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883263"><span class="hs-identifier hs-var">rhs'</span></a><span>
</span><a name="line-1468"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883261"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883264"><span class="hs-identifier hs-var">guarded</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">repLGRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repLGRHS&quot;</span><span>
</span><a name="line-1470"></a><span>
</span><a name="line-1471"></a><span class="hs-identifier">repFields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsRecordBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><a name="repFields"><a href="DsMeta.html#repFields"><span class="hs-identifier">repFields</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883265"><a href="#local-6989586621681883265"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#fieldExpQTyConName"><span class="hs-identifier hs-var">fieldExpQTyConName</span></a><span> </span><a href="#local-6989586621681883266"><span class="hs-identifier hs-var">rep_fld</span></a><span> </span><a href="#local-6989586621681883265"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1474"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1475"></a><span>    </span><span class="hs-identifier">rep_fld</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsRecField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-1476"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><span>    </span><a name="local-6989586621681883266"><a href="#local-6989586621681883266"><span class="hs-identifier">rep_fld</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883267"><a href="#local-6989586621681883267"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883268"><a href="#local-6989586621681883268"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsRecFieldSel</span><span> </span><a href="#local-6989586621681883267"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>                               </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883269"><a href="#local-6989586621681883269"><span class="hs-identifier">e</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621681883267"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1479"></a><span>                               </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repFieldExp"><span class="hs-identifier hs-var">repFieldExp</span></a><span> </span><a href="#local-6989586621681883268"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621681883269"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-identifier">repUpdFields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsRecUpdField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1482"></a><a name="repUpdFields"><a href="DsMeta.html#repUpdFields"><span class="hs-identifier">repUpdFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#fieldExpQTyConName"><span class="hs-identifier hs-var">fieldExpQTyConName</span></a><span> </span><a href="#local-6989586621681883270"><span class="hs-identifier hs-var">rep_fld</span></a><span>
</span><a name="line-1483"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1484"></a><span>    </span><span class="hs-identifier">rep_fld</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsRecUpdField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1485"></a><span>    </span><a name="local-6989586621681883270"><a href="#local-6989586621681883270"><span class="hs-identifier">rep_fld</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883271"><a href="#local-6989586621681883271"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621681883272"><a href="#local-6989586621681883272"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldLbl</span><span> </span><a href="#local-6989586621681883272"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1486"></a><span>      </span><span class="hs-identifier hs-var">Unambiguous</span><span> </span><a name="local-6989586621681883273"><a href="#local-6989586621681883273"><span class="hs-identifier">sel_name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883274"><a href="#local-6989586621681883274"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cL</span><span> </span><a href="#local-6989586621681883271"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621681883273"><span class="hs-identifier hs-var">sel_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1487"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883275"><a href="#local-6989586621681883275"><span class="hs-identifier">e</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621681883272"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1488"></a><span>                                   </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repFieldExp"><span class="hs-identifier hs-var">repFieldExp</span></a><span> </span><a href="#local-6989586621681883274"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621681883275"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1489"></a><span>      </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Ambiguous record updates&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883272"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1490"></a><span>
</span><a name="line-1491"></a><span>
</span><a name="line-1492"></a><span>
</span><a name="line-1493"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1494"></a><span class="hs-comment">-- Representing Stmt's is tricky, especially if bound variables</span><span>
</span><a name="line-1495"></a><span class="hs-comment">-- shadow each other. Consider:  [| do { x &lt;- f 1; x &lt;- f x; g x } |]</span><span>
</span><a name="line-1496"></a><span class="hs-comment">-- First gensym new names for every variable in any of the patterns.</span><span>
</span><a name="line-1497"></a><span class="hs-comment">-- both static (x'1 and x'2), and dynamic ((gensym &quot;x&quot;) and (gensym &quot;y&quot;))</span><span>
</span><a name="line-1498"></a><span class="hs-comment">-- if variables didn't shaddow, the static gensym wouldn't be necessary</span><span>
</span><a name="line-1499"></a><span class="hs-comment">-- and we could reuse the original names (x and x).</span><span>
</span><a name="line-1500"></a><span class="hs-comment">--</span><span>
</span><a name="line-1501"></a><span class="hs-comment">-- do { x'1 &lt;- gensym &quot;x&quot;</span><span>
</span><a name="line-1502"></a><span class="hs-comment">--    ; x'2 &lt;- gensym &quot;x&quot;</span><span>
</span><a name="line-1503"></a><span class="hs-comment">--    ; doE [ BindSt (pvar x'1) [| f 1 |]</span><span>
</span><a name="line-1504"></a><span class="hs-comment">--          , BindSt (pvar x'2) [| f x |]</span><span>
</span><a name="line-1505"></a><span class="hs-comment">--          , NoBindSt [| g x |]</span><span>
</span><a name="line-1506"></a><span class="hs-comment">--          ]</span><span>
</span><a name="line-1507"></a><span class="hs-comment">--    }</span><span>
</span><a name="line-1508"></a><span>
</span><a name="line-1509"></a><span class="hs-comment">-- The strategy is to translate a whole list of do-bindings by building a</span><span>
</span><a name="line-1510"></a><span class="hs-comment">-- bigger environment, and a bigger set of meta bindings</span><span>
</span><a name="line-1511"></a><span class="hs-comment">-- (like:  x'1 &lt;- gensym &quot;x&quot; ) and then combining these with the translations</span><span>
</span><a name="line-1512"></a><span class="hs-comment">-- of the expressions within the Do</span><span>
</span><a name="line-1513"></a><span>
</span><a name="line-1514"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1515"></a><span class="hs-comment">-- The helper function repSts computes the translation of each sub expression</span><span>
</span><a name="line-1516"></a><span class="hs-comment">-- and a bunch of prefix bindings denoting the dynamic renaming.</span><span>
</span><a name="line-1517"></a><span>
</span><a name="line-1518"></a><span class="hs-identifier">repLSts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LStmt</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1519"></a><a name="repLSts"><a href="DsMeta.html#repLSts"><span class="hs-identifier">repLSts</span></a></a><span> </span><a name="local-6989586621681883276"><a href="#local-6989586621681883276"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883276"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1520"></a><span>
</span><a name="line-1521"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Stmt</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1522"></a><a name="repSts"><a href="DsMeta.html#repSts"><span class="hs-identifier">repSts</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BindStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883277"><a href="#local-6989586621681883277"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621681883278"><a href="#local-6989586621681883278"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883279"><a href="#local-6989586621681883279"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1523"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883280"><a href="#local-6989586621681883280"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883278"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1524"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883281"><a href="#local-6989586621681883281"><span class="hs-identifier">ss1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">collectPatBinders</span><span> </span><a href="#local-6989586621681883277"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1525"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883281"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1526"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883282"><a href="#local-6989586621681883282"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883277"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span>
</span><a name="line-1527"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883283"><a href="#local-6989586621681883283"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883284"><a href="#local-6989586621681883284"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><a href="#local-6989586621681883279"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1528"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883285"><a href="#local-6989586621681883285"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBindSt"><span class="hs-identifier hs-var">repBindSt</span></a><span> </span><a href="#local-6989586621681883282"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621681883280"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1529"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883281"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883283"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883285"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681883284"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-1530"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LetStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883286"><a href="#local-6989586621681883286"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883287"><a href="#local-6989586621681883287"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1531"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883288"><a href="#local-6989586621681883288"><span class="hs-identifier">ss1</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883289"><a href="#local-6989586621681883289"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883286"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1532"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883290"><a href="#local-6989586621681883290"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLetSt"><span class="hs-identifier hs-var">repLetSt</span></a><span> </span><a href="#local-6989586621681883289"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1533"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883291"><a href="#local-6989586621681883291"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883292"><a href="#local-6989586621681883292"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883288"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><a href="#local-6989586621681883287"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1534"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883288"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883291"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883290"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681883292"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1535"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BodyStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883293"><a href="#local-6989586621681883293"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883294"><a href="#local-6989586621681883294"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1536"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883295"><a href="#local-6989586621681883295"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883293"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1537"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883296"><a href="#local-6989586621681883296"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repNoBindSt"><span class="hs-identifier hs-var">repNoBindSt</span></a><span> </span><a href="#local-6989586621681883295"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1538"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883297"><a href="#local-6989586621681883297"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883298"><a href="#local-6989586621681883298"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><a href="#local-6989586621681883294"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1539"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883297"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883296"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681883298"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1540"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883299"><a href="#local-6989586621681883299"><span class="hs-identifier">stmt_blocks</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883300"><a href="#local-6989586621681883300"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1541"></a><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883306"><a href="#local-6989586621681883306"><span class="hs-identifier">ss_s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883307"><a href="#local-6989586621681883307"><span class="hs-identifier">stmt_blocks1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapAndUnzipM</span><span> </span><a href="#local-6989586621681883301"><span class="hs-identifier hs-var">rep_stmt_block</span></a><span> </span><a href="#local-6989586621681883299"><span class="hs-identifier hs-var">stmt_blocks</span></a><span>
</span><a name="line-1542"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681883308"><a href="#local-6989586621681883308"><span class="hs-identifier">stmt_blocks2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883307"><span class="hs-identifier hs-var">stmt_blocks1</span></a><span>
</span><a name="line-1543"></a><span>            </span><a name="local-6989586621681883309"><a href="#local-6989586621681883309"><span class="hs-identifier">ss1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621681883306"><span class="hs-identifier hs-var">ss_s</span></a><span>
</span><a name="line-1544"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883310"><a href="#local-6989586621681883310"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repParSt"><span class="hs-identifier hs-var">repParSt</span></a><span> </span><a href="#local-6989586621681883308"><span class="hs-identifier hs-var">stmt_blocks2</span></a><span>
</span><a name="line-1545"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883311"><a href="#local-6989586621681883311"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883312"><a href="#local-6989586621681883312"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883309"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><a href="#local-6989586621681883300"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1546"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883309"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883311"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883310"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681883312"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1547"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1548"></a><span>     </span><span class="hs-identifier">rep_stmt_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ParStmtBlock</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-1549"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1550"></a><span>     </span><a name="local-6989586621681883301"><a href="#local-6989586621681883301"><span class="hs-identifier">rep_stmt_block</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParStmtBlock</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883302"><a href="#local-6989586621681883302"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1551"></a><span>       </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883303"><a href="#local-6989586621681883303"><span class="hs-identifier">ss1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883304"><a href="#local-6989586621681883304"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883302"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1552"></a><span>          </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883305"><a href="#local-6989586621681883305"><span class="hs-identifier">zs1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#stmtQTyConName"><span class="hs-identifier hs-var">stmtQTyConName</span></a><span> </span><a href="#local-6989586621681883304"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-1553"></a><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883303"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883305"><span class="hs-identifier hs-var">zs1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1554"></a><span>     </span><span class="hs-identifier">rep_stmt_block</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XParStmtBlock</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repSts&quot;</span><span>
</span><a name="line-1555"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">LastStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883313"><a href="#local-6989586621681883313"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span>
</span><a name="line-1556"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883314"><a href="#local-6989586621681883314"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883313"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1557"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883315"><a href="#local-6989586621681883315"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repNoBindSt"><span class="hs-identifier hs-var">repNoBindSt</span></a><span> </span><a href="#local-6989586621681883314"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1558"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883315"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1559"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883316"><a href="#local-6989586621681883316"><span class="hs-identifier">stmt</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">RecStmt</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883317"><a href="#local-6989586621681883317"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1560"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681883318"><a href="#local-6989586621681883318"><span class="hs-identifier">binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">collectLStmtsBinders</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">recS_stmts</span><span> </span><a href="#local-6989586621681883316"><span class="hs-identifier hs-var">stmt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1561"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883319"><a href="#local-6989586621681883319"><span class="hs-identifier">ss1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681883318"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1562"></a><span>       </span><span class="hs-comment">-- Bring all of binders in the recursive group into scope for the</span><span>
</span><a name="line-1563"></a><span>       </span><span class="hs-comment">-- whole group.</span><span>
</span><a name="line-1564"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883320"><a href="#local-6989586621681883320"><span class="hs-identifier">ss1_other</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883321"><a href="#local-6989586621681883321"><span class="hs-identifier">rss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883319"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">recS_stmts</span><span> </span><a href="#local-6989586621681883316"><span class="hs-identifier hs-var">stmt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1565"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">MASSERT</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-identifier">ss1</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">sort</span><span> </span><span class="hs-identifier">ss1_other</span><span class="hs-special">)</span><span>
</span><a name="line-1566"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883322"><a href="#local-6989586621681883322"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repRecSt"><span class="hs-identifier hs-var">repRecSt</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883321"><span class="hs-identifier hs-var">rss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1567"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883323"><a href="#local-6989586621681883323"><span class="hs-identifier">ss2</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883324"><a href="#local-6989586621681883324"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883319"><span class="hs-identifier hs-var">ss1</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repSts"><span class="hs-identifier hs-var">repSts</span></a><span> </span><a href="#local-6989586621681883317"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1568"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883319"><span class="hs-identifier hs-var">ss1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621681883323"><span class="hs-identifier hs-var">ss2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883322"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621681883324"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1569"></a><span class="hs-identifier">repSts</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1570"></a><span class="hs-identifier">repSts</span><span> </span><a name="local-6989586621681883325"><a href="#local-6989586621681883325"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Exotic statement&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883325"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1571"></a><span>
</span><a name="line-1572"></a><span>
</span><a name="line-1573"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1574"></a><span class="hs-comment">--                      Bindings</span><span>
</span><a name="line-1575"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1576"></a><span>
</span><a name="line-1577"></a><span class="hs-identifier">repBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsLocalBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1578"></a><a name="repBinds"><a href="DsMeta.html#repBinds"><span class="hs-identifier">repBinds</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EmptyLocalBinds</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1579"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883326"><a href="#local-6989586621681883326"><span class="hs-identifier">core_list</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1580"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883326"><span class="hs-identifier hs-var">core_list</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span class="hs-identifier">repBinds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IPBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883327"><a href="#local-6989586621681883327"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>   </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883328"><a href="#local-6989586621681883328"><span class="hs-identifier">ips</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#rep_implicit_param_bind"><span class="hs-identifier hs-var">rep_implicit_param_bind</span></a><span> </span><a href="#local-6989586621681883327"><span class="hs-identifier hs-var">decs</span></a><span>
</span><a name="line-1584"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883329"><a href="#local-6989586621681883329"><span class="hs-identifier">core_list</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span>
</span><a name="line-1585"></a><span>                                </span><span class="hs-special">(</span><a href="DsMeta.html#de_loc"><span class="hs-identifier hs-var">de_loc</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#sort_by_loc"><span class="hs-identifier hs-var">sort_by_loc</span></a><span> </span><a href="#local-6989586621681883328"><span class="hs-identifier hs-var">ips</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1586"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883329"><span class="hs-identifier hs-var">core_list</span></a><span class="hs-special">)</span><span>
</span><a name="line-1587"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-1588"></a><span>
</span><a name="line-1589"></a><span class="hs-identifier">repBinds</span><span> </span><a name="local-6989586621681883330"><a href="#local-6989586621681883330"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">XHsIPBinds</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1590"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Implicit parameter binds extension&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883330"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1591"></a><span>
</span><a name="line-1592"></a><span class="hs-identifier">repBinds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883331"><a href="#local-6989586621681883331"><span class="hs-identifier">decs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1593"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>   </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883332"><a href="#local-6989586621681883332"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#hsScopedTvBinders"><span class="hs-identifier hs-var">hsScopedTvBinders</span></a><span> </span><a href="#local-6989586621681883331"><span class="hs-identifier hs-var">decs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">collectHsValBinders</span><span> </span><a href="#local-6989586621681883331"><span class="hs-identifier hs-var">decs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1594"></a><span>                </span><span class="hs-comment">-- No need to worry about detailed scopes within</span><span>
</span><a name="line-1595"></a><span>                </span><span class="hs-comment">-- the binding group, because we are talking Names</span><span>
</span><a name="line-1596"></a><span>                </span><span class="hs-comment">-- here, so we can safely treat it as a mutually</span><span>
</span><a name="line-1597"></a><span>                </span><span class="hs-comment">-- recursive group</span><span>
</span><a name="line-1598"></a><span>                </span><span class="hs-comment">-- For hsScopedTvBinders see Note [Scoped type variables in bindings]</span><span>
</span><a name="line-1599"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883333"><a href="#local-6989586621681883333"><span class="hs-identifier">ss</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681883332"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1600"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883334"><a href="#local-6989586621681883334"><span class="hs-identifier">prs</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883333"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#rep_val_binds"><span class="hs-identifier hs-var">rep_val_binds</span></a><span> </span><a href="#local-6989586621681883331"><span class="hs-identifier hs-var">decs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1601"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883335"><a href="#local-6989586621681883335"><span class="hs-identifier">core_list</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span>
</span><a name="line-1602"></a><span>                                </span><span class="hs-special">(</span><a href="DsMeta.html#de_loc"><span class="hs-identifier hs-var">de_loc</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#sort_by_loc"><span class="hs-identifier hs-var">sort_by_loc</span></a><span> </span><a href="#local-6989586621681883334"><span class="hs-identifier hs-var">prs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1603"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883333"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883335"><span class="hs-identifier hs-var">core_list</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1604"></a><span class="hs-identifier">repBinds</span><span> </span><a name="local-6989586621681883336"><a href="#local-6989586621681883336"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsLocalBindsLR</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Local binds extensions&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883336"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span class="hs-identifier">rep_implicit_param_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LIPBind</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-1607"></a><a name="rep_implicit_param_bind"><a href="DsMeta.html#rep_implicit_param_bind"><span class="hs-identifier">rep_implicit_param_bind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883337"><a href="#local-6989586621681883337"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IPBind</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883338"><a href="#local-6989586621681883338"><span class="hs-identifier">ename</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883339"><a href="#local-6989586621681883339"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1608"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883341"><a href="#local-6989586621681883341"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883338"><span class="hs-identifier hs-var">ename</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1609"></a><span>                    </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883340"><a href="#local-6989586621681883340"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#rep_implicit_param_name"><span class="hs-identifier hs-var">rep_implicit_param_name</span></a><span> </span><a href="#local-6989586621681883340"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1610"></a><span>                    </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1611"></a><span>                        </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_implicit_param_bind: post typechecking&quot;</span><span>
</span><a name="line-1612"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883342"><a href="#local-6989586621681883342"><span class="hs-identifier">rhs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repE"><span class="hs-identifier hs-var">repE</span></a><span> </span><a href="#local-6989586621681883339"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1613"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883343"><a href="#local-6989586621681883343"><span class="hs-identifier">ipb</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repImplicitParamBind"><span class="hs-identifier hs-var">repImplicitParamBind</span></a><span> </span><a href="#local-6989586621681883341"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681883342"><span class="hs-identifier hs-var">rhs'</span></a><span>
</span><a name="line-1614"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883337"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883343"><span class="hs-identifier hs-var">ipb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1615"></a><span class="hs-identifier">rep_implicit_param_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883344"><a href="#local-6989586621681883344"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">XIPBind</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1616"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Implicit parameter bind extension&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883344"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1617"></a><span class="hs-identifier">rep_implicit_param_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_implicit_param_bind: Impossible Match&quot;</span><span>
</span><a name="line-1618"></a><span>                            </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1619"></a><span>
</span><a name="line-1620"></a><span class="hs-identifier">rep_implicit_param_name</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsIPName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-1621"></a><a name="rep_implicit_param_name"><a href="DsMeta.html#rep_implicit_param_name"><span class="hs-identifier">rep_implicit_param_name</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIPName</span><span> </span><a name="local-6989586621681883345"><a href="#local-6989586621681883345"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681883345"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1622"></a><span>
</span><a name="line-1623"></a><span class="hs-identifier">rep_val_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsValBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1624"></a><span class="hs-comment">-- Assumes: all the binders of the binding are already in the meta-env</span><span>
</span><a name="line-1625"></a><a name="rep_val_binds"><a href="DsMeta.html#rep_val_binds"><span class="hs-identifier">rep_val_binds</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XValBindsLR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NValBinds</span><span> </span><a name="local-6989586621681883346"><a href="#local-6989586621681883346"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621681883347"><a href="#local-6989586621681883347"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1626"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883348"><a href="#local-6989586621681883348"><span class="hs-identifier">core1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_binds"><span class="hs-identifier hs-var">rep_binds</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unionManyBags</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621681883346"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1627"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883349"><a href="#local-6989586621681883349"><span class="hs-identifier">core2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#rep_sigs"><span class="hs-identifier hs-var">rep_sigs</span></a><span> </span><a href="#local-6989586621681883347"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-1628"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883348"><span class="hs-identifier hs-var">core1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681883349"><span class="hs-identifier hs-var">core2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1629"></a><span class="hs-identifier">rep_val_binds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1630"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_val_binds: ValBinds&quot;</span><span>
</span><a name="line-1631"></a><span>
</span><a name="line-1632"></a><span class="hs-identifier">rep_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsBinds</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1633"></a><a name="rep_binds"><a href="DsMeta.html#rep_binds"><span class="hs-identifier">rep_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#rep_bind"><span class="hs-identifier hs-var">rep_bind</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span>
</span><a name="line-1634"></a><span>
</span><a name="line-1635"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsBind</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span class="hs-comment">-- Assumes: all the binders of the binding are already in the meta-env</span><span>
</span><a name="line-1637"></a><span>
</span><a name="line-1638"></a><span class="hs-comment">-- Note GHC treats declarations of a variable (not a pattern)</span><span>
</span><a name="line-1639"></a><span class="hs-comment">-- e.g.  x = g 5 as a Fun MonoBinds. This is indicated by a single match</span><span>
</span><a name="line-1640"></a><span class="hs-comment">-- with an empty list of patterns</span><span>
</span><a name="line-1641"></a><a name="rep_bind"><a href="DsMeta.html#rep_bind"><span class="hs-identifier">rep_bind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883350"><a href="#local-6989586621681883350"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span>
</span><a name="line-1642"></a><span>                 </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883351"><a href="#local-6989586621681883351"><span class="hs-identifier">fn</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1643"></a><span>                   </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span>
</span><a name="line-1644"></a><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span>
</span><a name="line-1645"></a><span>                                       </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1646"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883352"><a href="#local-6989586621681883352"><span class="hs-identifier">guards</span></a></a><span>
</span><a name="line-1647"></a><span>                                                     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883353"><a href="#local-6989586621681883353"><span class="hs-identifier">wheres</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1648"></a><span>                                      </span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883354"><a href="#local-6989586621681883354"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883355"><a href="#local-6989586621681883355"><span class="hs-identifier">wherecore</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883353"><span class="hs-identifier hs-var">wheres</span></a><span>
</span><a name="line-1650"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883356"><a href="#local-6989586621681883356"><span class="hs-identifier">guardcore</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883354"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repGuards"><span class="hs-identifier hs-var">repGuards</span></a><span> </span><a href="#local-6989586621681883352"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span>
</span><a name="line-1651"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883357"><a href="#local-6989586621681883357"><span class="hs-identifier">fn'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681883351"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-1652"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883358"><a href="#local-6989586621681883358"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPvar"><span class="hs-identifier hs-var">repPvar</span></a><span> </span><a href="#local-6989586621681883357"><span class="hs-identifier hs-var">fn'</span></a><span>
</span><a name="line-1653"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883359"><a href="#local-6989586621681883359"><span class="hs-identifier">ans</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repVal"><span class="hs-identifier hs-var">repVal</span></a><span> </span><a href="#local-6989586621681883358"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621681883356"><span class="hs-identifier hs-var">guardcore</span></a><span> </span><a href="#local-6989586621681883355"><span class="hs-identifier hs-var">wherecore</span></a><span>
</span><a name="line-1654"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883360"><a href="#local-6989586621681883360"><span class="hs-identifier">ans'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883354"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883359"><span class="hs-identifier hs-var">ans</span></a><span>
</span><a name="line-1655"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883350"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883360"><span class="hs-identifier hs-var">ans'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1656"></a><span>
</span><a name="line-1657"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883361"><a href="#local-6989586621681883361"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883362"><a href="#local-6989586621681883362"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-1658"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883363"><a href="#local-6989586621681883363"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1659"></a><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883364"><a href="#local-6989586621681883364"><span class="hs-identifier">ms1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repClauseTup"><span class="hs-identifier hs-var">repClauseTup</span></a><span> </span><a href="#local-6989586621681883363"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1660"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883365"><a href="#local-6989586621681883365"><span class="hs-identifier">fn'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681883362"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-1661"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883366"><a href="#local-6989586621681883366"><span class="hs-identifier">ans</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repFun"><span class="hs-identifier hs-var">repFun</span></a><span> </span><a href="#local-6989586621681883365"><span class="hs-identifier hs-var">fn'</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883364"><span class="hs-identifier hs-var">ms1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1662"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883361"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883366"><span class="hs-identifier hs-var">ans</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1663"></a><span>
</span><a name="line-1664"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">XMatchGroup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind&quot;</span><span>
</span><a name="line-1665"></a><span>
</span><a name="line-1666"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883367"><a href="#local-6989586621681883367"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883368"><a href="#local-6989586621681883368"><span class="hs-identifier">pat</span></a></a><span>
</span><a name="line-1667"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883369"><a href="#local-6989586621681883369"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883370"><a href="#local-6989586621681883370"><span class="hs-identifier">wheres</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1668"></a><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883371"><a href="#local-6989586621681883371"><span class="hs-identifier">patcore</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883368"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1669"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883372"><a href="#local-6989586621681883372"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883373"><a href="#local-6989586621681883373"><span class="hs-identifier">wherecore</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBinds"><span class="hs-identifier hs-var">repBinds</span></a><span> </span><a href="#local-6989586621681883370"><span class="hs-identifier hs-var">wheres</span></a><span>
</span><a name="line-1670"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883374"><a href="#local-6989586621681883374"><span class="hs-identifier">guardcore</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883372"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#repGuards"><span class="hs-identifier hs-var">repGuards</span></a><span> </span><a href="#local-6989586621681883369"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span>
</span><a name="line-1671"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883375"><a href="#local-6989586621681883375"><span class="hs-identifier">ans</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repVal"><span class="hs-identifier hs-var">repVal</span></a><span> </span><a href="#local-6989586621681883371"><span class="hs-identifier hs-var">patcore</span></a><span> </span><a href="#local-6989586621681883374"><span class="hs-identifier hs-var">guardcore</span></a><span> </span><a href="#local-6989586621681883373"><span class="hs-identifier hs-var">wherecore</span></a><span>
</span><a name="line-1672"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883376"><a href="#local-6989586621681883376"><span class="hs-identifier">ans'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883372"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883375"><span class="hs-identifier hs-var">ans</span></a><span>
</span><a name="line-1673"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883367"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883376"><span class="hs-identifier hs-var">ans'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1674"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XGRHSs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind&quot;</span><span>
</span><a name="line-1675"></a><span>
</span><a name="line-1676"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarBind</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883377"><a href="#local-6989586621681883377"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883378"><a href="#local-6989586621681883378"><span class="hs-identifier">e</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1677"></a><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883379"><a href="#local-6989586621681883379"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><a href="#local-6989586621681883377"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1678"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883380"><a href="#local-6989586621681883380"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883378"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1679"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883381"><a href="#local-6989586621681883381"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repNormal"><span class="hs-identifier hs-var">repNormal</span></a><span> </span><a href="#local-6989586621681883380"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1680"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883382"><a href="#local-6989586621681883382"><span class="hs-identifier">patcore</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPvar"><span class="hs-identifier hs-var">repPvar</span></a><span> </span><a href="#local-6989586621681883379"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1681"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883383"><a href="#local-6989586621681883383"><span class="hs-identifier">empty_decls</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#decQTyConName"><span class="hs-identifier hs-var">decQTyConName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1682"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883384"><a href="#local-6989586621681883384"><span class="hs-identifier">ans</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repVal"><span class="hs-identifier hs-var">repVal</span></a><span> </span><a href="#local-6989586621681883382"><span class="hs-identifier hs-var">patcore</span></a><span> </span><a href="#local-6989586621681883381"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621681883383"><span class="hs-identifier hs-var">empty_decls</span></a><span>
</span><a name="line-1683"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">srcLocSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getSrcLoc</span><span> </span><a href="#local-6989586621681883377"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883384"><span class="hs-identifier hs-var">ans</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1684"></a><span>
</span><a name="line-1685"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AbsBinds</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind: AbsBinds&quot;</span><span>
</span><a name="line-1686"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621681883385"><a href="#local-6989586621681883385"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatSynBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PSB</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883386"><a href="#local-6989586621681883386"><span class="hs-identifier">syn</span></a></a><span>
</span><a name="line-1687"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883387"><a href="#local-6989586621681883387"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1688"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883388"><a href="#local-6989586621681883388"><span class="hs-identifier">pat</span></a></a><span>
</span><a name="line-1689"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883389"><a href="#local-6989586621681883389"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1690"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883409"><a href="#local-6989586621681883409"><span class="hs-identifier">syn'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681883386"><span class="hs-identifier hs-var">syn</span></a><span>
</span><a name="line-1691"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883410"><a href="#local-6989586621681883410"><span class="hs-identifier">dir'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPatSynDir"><span class="hs-identifier hs-var">repPatSynDir</span></a><span> </span><a href="#local-6989586621681883389"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-1692"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883411"><a href="#local-6989586621681883411"><span class="hs-identifier">ss</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883390"><span class="hs-identifier hs-var">mkGenArgSyms</span></a><span> </span><a href="#local-6989586621681883387"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1693"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883414"><a href="#local-6989586621681883414"><span class="hs-identifier">patSynD'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883411"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-1694"></a><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883412"><a href="#local-6989586621681883412"><span class="hs-identifier">args'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPatSynArgs"><span class="hs-identifier hs-var">repPatSynArgs</span></a><span> </span><a href="#local-6989586621681883387"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1695"></a><span>            </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883413"><a href="#local-6989586621681883413"><span class="hs-identifier">pat'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883388"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1696"></a><span>            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPatSynD"><span class="hs-identifier hs-var">repPatSynD</span></a><span> </span><a href="#local-6989586621681883409"><span class="hs-identifier hs-var">syn'</span></a><span> </span><a href="#local-6989586621681883412"><span class="hs-identifier hs-var">args'</span></a><span> </span><a href="#local-6989586621681883410"><span class="hs-identifier hs-var">dir'</span></a><span> </span><a href="#local-6989586621681883413"><span class="hs-identifier hs-var">pat'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1697"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883415"><a href="#local-6989586621681883415"><span class="hs-identifier">patSynD''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883392"><span class="hs-identifier hs-var">wrapGenArgSyms</span></a><span> </span><a href="#local-6989586621681883387"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621681883411"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883414"><span class="hs-identifier hs-var">patSynD'</span></a><span>
</span><a name="line-1698"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883385"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883415"><span class="hs-identifier hs-var">patSynD''</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1699"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1700"></a><span>    </span><span class="hs-identifier">mkGenArgSyms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsPatSynDetails</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span>
</span><a name="line-1701"></a><span>    </span><span class="hs-comment">-- for Record Pattern Synonyms we want to conflate the selector</span><span>
</span><a name="line-1702"></a><span>    </span><span class="hs-comment">-- and the pattern-only names in order to provide a nicer TH</span><span>
</span><a name="line-1703"></a><span>    </span><span class="hs-comment">-- API. Whereas inside GHC, record pattern synonym selectors and</span><span>
</span><a name="line-1704"></a><span>    </span><span class="hs-comment">-- their pattern-only bound right hand sides have different names,</span><span>
</span><a name="line-1705"></a><span>    </span><span class="hs-comment">-- we want to treat them the same in TH. This is the reason why we</span><span>
</span><a name="line-1706"></a><span>    </span><span class="hs-comment">-- need an adjusted mkGenArgSyms in the `RecCon` case below.</span><span>
</span><a name="line-1707"></a><span>    </span><a name="local-6989586621681883390"><a href="#local-6989586621681883390"><span class="hs-identifier">mkGenArgSyms</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621681883393"><a href="#local-6989586621681883393"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883393"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1708"></a><span>    </span><span class="hs-identifier">mkGenArgSyms</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621681883394"><a href="#local-6989586621681883394"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621681883395"><a href="#local-6989586621681883395"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883394"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883395"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1709"></a><span>    </span><span class="hs-identifier">mkGenArgSyms</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621681883396"><a href="#local-6989586621681883396"><span class="hs-identifier">fields</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1710"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681883397"><a href="#local-6989586621681883397"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">recordPatSynPatVar</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883396"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1711"></a><span>                 </span><a name="local-6989586621681883398"><a href="#local-6989586621681883398"><span class="hs-identifier">sels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">recordPatSynSelectorId</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883396"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1712"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883399"><a href="#local-6989586621681883399"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681883398"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1713"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621681883391"><span class="hs-identifier hs-var">replaceNames</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621681883398"><span class="hs-identifier hs-var">sels</span></a><span> </span><a href="#local-6989586621681883397"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883399"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1714"></a><span>
</span><a name="line-1715"></a><span>    </span><a name="local-6989586621681883391"><a href="#local-6989586621681883391"><span class="hs-identifier">replaceNames</span></a></a><span> </span><a name="local-6989586621681883400"><a href="#local-6989586621681883400"><span class="hs-identifier">selsPats</span></a></a><span> </span><a name="local-6989586621681883401"><a href="#local-6989586621681883401"><span class="hs-identifier">genSyms</span></a></a><span>
</span><a name="line-1716"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883405"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883403"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883402"><a href="#local-6989586621681883402"><span class="hs-identifier">sel</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883403"><a href="#local-6989586621681883403"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883401"><span class="hs-identifier hs-var">genSyms</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883404"><a href="#local-6989586621681883404"><span class="hs-identifier">sel'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681883405"><a href="#local-6989586621681883405"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883400"><span class="hs-identifier hs-var">selsPats</span></a><span>
</span><a name="line-1717"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883402"><span class="hs-identifier hs-var">sel</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621681883404"><span class="hs-identifier hs-var">sel'</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1718"></a><span>
</span><a name="line-1719"></a><span>    </span><span class="hs-identifier">wrapGenArgSyms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsPatSynDetails</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-1720"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-1721"></a><span>    </span><a name="local-6989586621681883392"><a href="#local-6989586621681883392"><span class="hs-identifier">wrapGenArgSyms</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621681883406"><a href="#local-6989586621681883406"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681883406"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-1722"></a><span>    </span><span class="hs-identifier">wrapGenArgSyms</span><span> </span><span class="hs-identifier">_</span><span>          </span><a name="local-6989586621681883407"><a href="#local-6989586621681883407"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621681883408"><a href="#local-6989586621681883408"><span class="hs-identifier">dec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883407"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883408"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-1723"></a><span>
</span><a name="line-1724"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatSynBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XPatSynBind</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1725"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind: XPatSynBind&quot;</span><span>
</span><a name="line-1726"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsBindsLR</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind: XHsBindsLR&quot;</span><span>
</span><a name="line-1727"></a><span class="hs-identifier">rep_bind</span><span> </span><span class="hs-identifier">_</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;rep_bind: Impossible match!&quot;</span><span>
</span><a name="line-1728"></a><span>                                      </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1729"></a><span>
</span><a name="line-1730"></a><span class="hs-identifier">repPatSynD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-1731"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynArgsQ</span><span>
</span><a name="line-1732"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynDirQ</span><span>
</span><a name="line-1733"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span>
</span><a name="line-1734"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-1735"></a><a name="repPatSynD"><a href="DsMeta.html#repPatSynD"><span class="hs-identifier">repPatSynD</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883416"><a href="#local-6989586621681883416"><span class="hs-identifier">syn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883417"><a href="#local-6989586621681883417"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883418"><a href="#local-6989586621681883418"><span class="hs-identifier">dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883419"><a href="#local-6989586621681883419"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1736"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#patSynDName"><span class="hs-identifier hs-var">patSynDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883416"><span class="hs-identifier hs-var">syn</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883417"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883418"><span class="hs-identifier hs-var">dir</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883419"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span>
</span><a name="line-1737"></a><span>
</span><a name="line-1738"></a><span class="hs-identifier">repPatSynArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsPatSynDetails</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynArgsQ</span><span class="hs-special">)</span><span>
</span><a name="line-1739"></a><a name="repPatSynArgs"><a href="DsMeta.html#repPatSynArgs"><span class="hs-identifier">repPatSynArgs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621681883420"><a href="#local-6989586621681883420"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1740"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883421"><a href="#local-6989586621681883421"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883420"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1741"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPrefixPatSynArgs"><span class="hs-identifier hs-var">repPrefixPatSynArgs</span></a><span> </span><a href="#local-6989586621681883421"><span class="hs-identifier hs-var">args'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1742"></a><span class="hs-identifier">repPatSynArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621681883422"><a href="#local-6989586621681883422"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621681883423"><a href="#local-6989586621681883423"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1743"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883424"><a href="#local-6989586621681883424"><span class="hs-identifier">arg1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883422"><span class="hs-identifier hs-var">arg1</span></a><span>
</span><a name="line-1744"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883425"><a href="#local-6989586621681883425"><span class="hs-identifier">arg2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883423"><span class="hs-identifier hs-var">arg2</span></a><span>
</span><a name="line-1745"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repInfixPatSynArgs"><span class="hs-identifier hs-var">repInfixPatSynArgs</span></a><span> </span><a href="#local-6989586621681883424"><span class="hs-identifier hs-var">arg1'</span></a><span> </span><a href="#local-6989586621681883425"><span class="hs-identifier hs-var">arg2'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1746"></a><span class="hs-identifier">repPatSynArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621681883426"><a href="#local-6989586621681883426"><span class="hs-identifier">fields</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883428"><a href="#local-6989586621681883428"><span class="hs-identifier">sels'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883427"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1748"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repRecordPatSynArgs"><span class="hs-identifier hs-var">repRecordPatSynArgs</span></a><span> </span><a href="#local-6989586621681883428"><span class="hs-identifier hs-var">sels'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1749"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681883427"><a href="#local-6989586621681883427"><span class="hs-identifier">sels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">recordPatSynSelectorId</span><span> </span><a href="#local-6989586621681883426"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span class="hs-identifier">repPrefixPatSynArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynArgsQ</span><span class="hs-special">)</span><span>
</span><a name="line-1752"></a><a name="repPrefixPatSynArgs"><a href="DsMeta.html#repPrefixPatSynArgs"><span class="hs-identifier">repPrefixPatSynArgs</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883429"><a href="#local-6989586621681883429"><span class="hs-identifier">nms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#prefixPatSynName"><span class="hs-identifier hs-var">prefixPatSynName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883429"><span class="hs-identifier hs-var">nms</span></a><span class="hs-special">]</span><span>
</span><a name="line-1753"></a><span>
</span><a name="line-1754"></a><span class="hs-identifier">repInfixPatSynArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynArgsQ</span><span class="hs-special">)</span><span>
</span><a name="line-1755"></a><a name="repInfixPatSynArgs"><a href="DsMeta.html#repInfixPatSynArgs"><span class="hs-identifier">repInfixPatSynArgs</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883430"><a href="#local-6989586621681883430"><span class="hs-identifier">nm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883431"><a href="#local-6989586621681883431"><span class="hs-identifier">nm2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#infixPatSynName"><span class="hs-identifier hs-var">infixPatSynName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883430"><span class="hs-identifier hs-var">nm1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883431"><span class="hs-identifier hs-var">nm2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1756"></a><span>
</span><a name="line-1757"></a><span class="hs-identifier">repRecordPatSynArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span>
</span><a name="line-1758"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynArgsQ</span><span class="hs-special">)</span><span>
</span><a name="line-1759"></a><a name="repRecordPatSynArgs"><a href="DsMeta.html#repRecordPatSynArgs"><span class="hs-identifier">repRecordPatSynArgs</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883432"><a href="#local-6989586621681883432"><span class="hs-identifier">sels</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recordPatSynName"><span class="hs-identifier hs-var">recordPatSynName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883432"><span class="hs-identifier hs-var">sels</span></a><span class="hs-special">]</span><span>
</span><a name="line-1760"></a><span>
</span><a name="line-1761"></a><span class="hs-identifier">repPatSynDir</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsPatSynDir</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynDirQ</span><span class="hs-special">)</span><span>
</span><a name="line-1762"></a><a name="repPatSynDir"><a href="DsMeta.html#repPatSynDir"><span class="hs-identifier">repPatSynDir</span></a></a><span> </span><span class="hs-identifier hs-var">Unidirectional</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unidirPatSynName"><span class="hs-identifier hs-var">unidirPatSynName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1763"></a><span class="hs-identifier">repPatSynDir</span><span> </span><span class="hs-identifier hs-var">ImplicitBidirectional</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#implBidirPatSynName"><span class="hs-identifier hs-var">implBidirPatSynName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1764"></a><span class="hs-identifier">repPatSynDir</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplicitBidirectional</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883433"><a href="#local-6989586621681883433"><span class="hs-identifier">clauses</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1765"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883434"><a href="#local-6989586621681883434"><span class="hs-identifier">clauses'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#repClauseTup"><span class="hs-identifier hs-var">repClauseTup</span></a><span> </span><a href="#local-6989586621681883433"><span class="hs-identifier hs-var">clauses</span></a><span>
</span><a name="line-1766"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repExplBidirPatSynDir"><span class="hs-identifier hs-var">repExplBidirPatSynDir</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883434"><span class="hs-identifier hs-var">clauses'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1767"></a><span class="hs-identifier">repPatSynDir</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExplicitBidirectional</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XMatchGroup</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repPatSynDir&quot;</span><span>
</span><a name="line-1768"></a><span>
</span><a name="line-1769"></a><span class="hs-identifier">repExplBidirPatSynDir</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ClauseQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatSynDirQ</span><span class="hs-special">)</span><span>
</span><a name="line-1770"></a><a name="repExplBidirPatSynDir"><a href="DsMeta.html#repExplBidirPatSynDir"><span class="hs-identifier">repExplBidirPatSynDir</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883435"><a href="#local-6989586621681883435"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#explBidirPatSynName"><span class="hs-identifier hs-var">explBidirPatSynName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883435"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">]</span><span>
</span><a name="line-1771"></a><span>
</span><a name="line-1772"></a><span>
</span><a name="line-1773"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1774"></a><span class="hs-comment">-- Since everything in a Bind is mutually recursive we need rename all</span><span>
</span><a name="line-1775"></a><span class="hs-comment">-- all the variables simultaneously. For example:</span><span>
</span><a name="line-1776"></a><span class="hs-comment">-- [| AndMonoBinds (f x = x + g 2) (g x = f 1 + 2) |] would translate to</span><span>
</span><a name="line-1777"></a><span class="hs-comment">-- do { f'1 &lt;- gensym &quot;f&quot;</span><span>
</span><a name="line-1778"></a><span class="hs-comment">--    ; g'2 &lt;- gensym &quot;g&quot;</span><span>
</span><a name="line-1779"></a><span class="hs-comment">--    ; [ do { x'3 &lt;- gensym &quot;x&quot;; fun f'1 [pvar x'3] [| x + g2 |]},</span><span>
</span><a name="line-1780"></a><span class="hs-comment">--        do { x'4 &lt;- gensym &quot;x&quot;; fun g'2 [pvar x'4] [| f 1 + 2 |]}</span><span>
</span><a name="line-1781"></a><span class="hs-comment">--      ]}</span><span>
</span><a name="line-1782"></a><span class="hs-comment">-- This requires collecting the bindings (f'1 &lt;- gensym &quot;f&quot;), and the</span><span>
</span><a name="line-1783"></a><span class="hs-comment">-- environment ( f |-&gt; f'1 ) from each binding, and then unioning them</span><span>
</span><a name="line-1784"></a><span class="hs-comment">-- together. As we do this we collect GenSymBinds's which represent the renamed</span><span>
</span><a name="line-1785"></a><span class="hs-comment">-- variables bound by the Bindings. In order not to lose track of these</span><span>
</span><a name="line-1786"></a><span class="hs-comment">-- representations we build a shadow datatype MB with the same structure as</span><span>
</span><a name="line-1787"></a><span class="hs-comment">-- MonoBinds, but which has slots for the representations</span><span>
</span><a name="line-1788"></a><span>
</span><a name="line-1789"></a><span>
</span><a name="line-1790"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1791"></a><span class="hs-comment">-- GHC allows a more general form of lambda abstraction than specified</span><span>
</span><a name="line-1792"></a><span class="hs-comment">-- by Haskell 98. In particular it allows guarded lambda's like :</span><span>
</span><a name="line-1793"></a><span class="hs-comment">-- (\  x | even x -&gt; 0 | odd x -&gt; 1) at the moment we can't represent this in</span><span>
</span><a name="line-1794"></a><span class="hs-comment">-- Haskell Template's Meta.Exp type so we punt if it isn't a simple thing like</span><span>
</span><a name="line-1795"></a><span class="hs-comment">-- (\ p1 .. pn -&gt; exp) by causing an error.</span><span>
</span><a name="line-1796"></a><span>
</span><a name="line-1797"></a><span class="hs-identifier">repLambda</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LMatch</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-1798"></a><a name="repLambda"><a href="DsMeta.html#repLambda"><span class="hs-identifier">repLambda</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883436"><a href="#local-6989586621681883436"><span class="hs-identifier">ps</span></a></a><span>
</span><a name="line-1799"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621681883437"><a href="#local-6989586621681883437"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1800"></a><span>                                              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EmptyLocalBinds</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1801"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681883438"><a href="#local-6989586621681883438"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">collectPatsBinders</span><span> </span><a href="#local-6989586621681883436"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1802"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883439"><a href="#local-6989586621681883439"><span class="hs-identifier">ss</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier hs-var">mkGenSyms</span></a><span> </span><a href="#local-6989586621681883438"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1803"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883442"><a href="#local-6989586621681883442"><span class="hs-identifier">lam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#addBinds"><span class="hs-identifier hs-var">addBinds</span></a><span> </span><a href="#local-6989586621681883439"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-1804"></a><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883440"><a href="#local-6989586621681883440"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883436"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883441"><a href="#local-6989586621681883441"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883437"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repLam"><span class="hs-identifier hs-var">repLam</span></a><span> </span><a href="#local-6989586621681883440"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621681883441"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1805"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier hs-var">wrapGenSyms</span></a><span> </span><a href="#local-6989586621681883439"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621681883442"><span class="hs-identifier hs-var">lam</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1806"></a><span>
</span><a name="line-1807"></a><span class="hs-identifier">repLambda</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883443"><a href="#local-6989586621681883443"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Guarded labmdas&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pprMatch</span><span> </span><a href="#local-6989586621681883443"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1808"></a><span>
</span><a name="line-1809"></a><span>
</span><a name="line-1810"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-1811"></a><span class="hs-comment">--                      Patterns</span><span>
</span><a name="line-1812"></a><span class="hs-comment">-- repP deals with patterns.  It assumes that we have already</span><span>
</span><a name="line-1813"></a><span class="hs-comment">-- walked over the pattern(s) once to collect the binders, and</span><span>
</span><a name="line-1814"></a><span class="hs-comment">-- have extended the environment.  So every pattern-bound</span><span>
</span><a name="line-1815"></a><span class="hs-comment">-- variable should already appear in the environment.</span><span>
</span><a name="line-1816"></a><span>
</span><a name="line-1817"></a><span class="hs-comment">-- Process a list of patterns</span><span>
</span><a name="line-1818"></a><span class="hs-identifier">repLPs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1819"></a><a name="repLPs"><a href="DsMeta.html#repLPs"><span class="hs-identifier">repLPs</span></a></a><span> </span><a name="local-6989586621681883444"><a href="#local-6989586621681883444"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#patQTyConName"><span class="hs-identifier hs-var">patQTyConName</span></a><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883444"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1820"></a><span>
</span><a name="line-1821"></a><span class="hs-identifier">repLP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-1822"></a><a name="repLP"><a href="DsMeta.html#repLP"><span class="hs-identifier">repLP</span></a></a><span> </span><a name="local-6989586621681883445"><a href="#local-6989586621681883445"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repP"><span class="hs-identifier hs-var">repP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883445"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1823"></a><span>
</span><a name="line-1824"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-1825"></a><a name="repP"><a href="DsMeta.html#repP"><span class="hs-identifier">repP</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WildPat</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repPwild"><span class="hs-identifier hs-var">repPwild</span></a><span>
</span><a name="line-1826"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LitPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883446"><a href="#local-6989586621681883446"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883447"><a href="#local-6989586621681883447"><span class="hs-identifier">l2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLiteral"><span class="hs-identifier hs-var">repLiteral</span></a><span> </span><a href="#local-6989586621681883446"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPlit"><span class="hs-identifier hs-var">repPlit</span></a><span> </span><a href="#local-6989586621681883447"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1827"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883448"><a href="#local-6989586621681883448"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883449"><a href="#local-6989586621681883449"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883448"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPvar"><span class="hs-identifier hs-var">repPvar</span></a><span> </span><a href="#local-6989586621681883449"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1828"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LazyPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883450"><a href="#local-6989586621681883450"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883451"><a href="#local-6989586621681883451"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883450"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPtilde"><span class="hs-identifier hs-var">repPtilde</span></a><span> </span><a href="#local-6989586621681883451"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1829"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BangPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883452"><a href="#local-6989586621681883452"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883453"><a href="#local-6989586621681883453"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883452"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPbang"><span class="hs-identifier hs-var">repPbang</span></a><span> </span><a href="#local-6989586621681883453"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1830"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AsPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883454"><a href="#local-6989586621681883454"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883455"><a href="#local-6989586621681883455"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883456"><a href="#local-6989586621681883456"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier hs-var">lookupLBinder</span></a><span> </span><a href="#local-6989586621681883454"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883457"><a href="#local-6989586621681883457"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883455"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1831"></a><span>                             </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPaspat"><span class="hs-identifier hs-var">repPaspat</span></a><span> </span><a href="#local-6989586621681883456"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621681883457"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1832"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883458"><a href="#local-6989586621681883458"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883458"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1833"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListPat</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621681883459"><a href="#local-6989586621681883459"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883460"><a href="#local-6989586621681883460"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883459"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPlist"><span class="hs-identifier hs-var">repPlist</span></a><span> </span><a href="#local-6989586621681883460"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1834"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883461"><a href="#local-6989586621681883461"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883462"><a href="#local-6989586621681883462"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883463"><a href="#local-6989586621681883463"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repP"><span class="hs-identifier hs-var">repP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListPat</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621681883462"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1835"></a><span>                                </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883464"><a href="#local-6989586621681883464"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repE"><span class="hs-identifier hs-var">repE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">syn_expr</span><span> </span><a href="#local-6989586621681883461"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1836"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPview"><span class="hs-identifier hs-var">repPview</span></a><span> </span><a href="#local-6989586621681883464"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621681883463"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">}</span><span>
</span><a name="line-1837"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TuplePat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883465"><a href="#local-6989586621681883465"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621681883466"><a href="#local-6989586621681883466"><span class="hs-identifier">boxed</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1838"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isBoxed</span><span> </span><a href="#local-6989586621681883466"><span class="hs-identifier hs-var">boxed</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883467"><a href="#local-6989586621681883467"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883465"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPtup"><span class="hs-identifier hs-var">repPtup</span></a><span> </span><a href="#local-6989586621681883467"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1839"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883468"><a href="#local-6989586621681883468"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883465"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPunboxedTup"><span class="hs-identifier hs-var">repPunboxedTup</span></a><span> </span><a href="#local-6989586621681883468"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1840"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SumPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883469"><a href="#local-6989586621681883469"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621681883470"><a href="#local-6989586621681883470"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621681883471"><a href="#local-6989586621681883471"><span class="hs-identifier">arity</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883472"><a href="#local-6989586621681883472"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883469"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1841"></a><span>                                 </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPunboxedSum"><span class="hs-identifier hs-var">repPunboxedSum</span></a><span> </span><a href="#local-6989586621681883472"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621681883470"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621681883471"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1842"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a name="local-6989586621681883473"><a href="#local-6989586621681883473"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621681883474"><a href="#local-6989586621681883474"><span class="hs-identifier">details</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1843"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883479"><a href="#local-6989586621681883479"><span class="hs-identifier">con_str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883473"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-1844"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883474"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1845"></a><span>         </span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621681883480"><a href="#local-6989586621681883480"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883481"><a href="#local-6989586621681883481"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLPs"><span class="hs-identifier hs-var">repLPs</span></a><span> </span><a href="#local-6989586621681883480"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPcon"><span class="hs-identifier hs-var">repPcon</span></a><span> </span><a href="#local-6989586621681883479"><span class="hs-identifier hs-var">con_str</span></a><span> </span><a href="#local-6989586621681883481"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1846"></a><span>         </span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621681883482"><a href="#local-6989586621681883482"><span class="hs-identifier">rec</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883483"><a href="#local-6989586621681883483"><span class="hs-identifier">fps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#fieldPatQTyConName"><span class="hs-identifier hs-var">fieldPatQTyConName</span></a><span> </span><a href="#local-6989586621681883475"><span class="hs-identifier hs-var">rep_fld</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rec_flds</span><span> </span><a href="#local-6989586621681883482"><span class="hs-identifier hs-var">rec</span></a><span class="hs-special">)</span><span>
</span><a name="line-1847"></a><span>                            </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPrec"><span class="hs-identifier hs-var">repPrec</span></a><span> </span><a href="#local-6989586621681883479"><span class="hs-identifier hs-var">con_str</span></a><span> </span><a href="#local-6989586621681883483"><span class="hs-identifier hs-var">fps</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1848"></a><span>         </span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621681883484"><a href="#local-6989586621681883484"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621681883485"><a href="#local-6989586621681883485"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883486"><a href="#local-6989586621681883486"><span class="hs-identifier">p1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883484"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">;</span><span>
</span><a name="line-1849"></a><span>                                </span><a name="local-6989586621681883487"><a href="#local-6989586621681883487"><span class="hs-identifier">p2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883485"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">;</span><span>
</span><a name="line-1850"></a><span>                                </span><a href="DsMeta.html#repPinfix"><span class="hs-identifier hs-var">repPinfix</span></a><span> </span><a href="#local-6989586621681883486"><span class="hs-identifier hs-var">p1'</span></a><span> </span><a href="#local-6989586621681883479"><span class="hs-identifier hs-var">con_str</span></a><span> </span><a href="#local-6989586621681883487"><span class="hs-identifier hs-var">p2'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1851"></a><span>   </span><span class="hs-special">}</span><span>
</span><a name="line-1852"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1853"></a><span>   </span><span class="hs-identifier">rep_fld</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsRecField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">,</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1854"></a><span>   </span><a name="local-6989586621681883475"><a href="#local-6989586621681883475"><span class="hs-identifier">rep_fld</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883476"><a href="#local-6989586621681883476"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883477"><a href="#local-6989586621681883477"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsRecFieldSel</span><span> </span><a href="#local-6989586621681883476"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1855"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883478"><a href="#local-6989586621681883478"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621681883476"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1856"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fieldPatName"><span class="hs-identifier hs-var">fieldPatName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883477"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><a href="#local-6989586621681883478"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883488"><a href="#local-6989586621681883488"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883489"><a href="#local-6989586621681883489"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repOverloadedLiteral"><span class="hs-identifier hs-var">repOverloadedLiteral</span></a><span> </span><a href="#local-6989586621681883488"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1859"></a><span>                                         </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPlit"><span class="hs-identifier hs-var">repPlit</span></a><span> </span><a href="#local-6989586621681883489"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1860"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ViewPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883490"><a href="#local-6989586621681883490"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621681883491"><a href="#local-6989586621681883491"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883492"><a href="#local-6989586621681883492"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883490"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681883493"><a href="#local-6989586621681883493"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883491"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPview"><span class="hs-identifier hs-var">repPview</span></a><span> </span><a href="#local-6989586621681883492"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621681883493"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1861"></a><span class="hs-identifier">repP</span><span> </span><a name="local-6989586621681883494"><a href="#local-6989586621681883494"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">NPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Negative overloaded patterns&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883494"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1862"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883495"><a href="#local-6989586621681883495"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621681883496"><a href="#local-6989586621681883496"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883497"><a href="#local-6989586621681883497"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLP"><span class="hs-identifier hs-var">repLP</span></a><span> </span><a href="#local-6989586621681883495"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1863"></a><span>                         </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883498"><a href="#local-6989586621681883498"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsSigWcType</span><span> </span><a href="#local-6989586621681883496"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1864"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repPsig"><span class="hs-identifier hs-var">repPsig</span></a><span> </span><a href="#local-6989586621681883497"><span class="hs-identifier hs-var">p'</span></a><span> </span><a href="#local-6989586621681883498"><span class="hs-identifier hs-var">t'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1865"></a><span class="hs-identifier">repP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SplicePat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883499"><a href="#local-6989586621681883499"><span class="hs-identifier">splice</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repSplice"><span class="hs-identifier hs-var">repSplice</span></a><span> </span><a href="#local-6989586621681883499"><span class="hs-identifier hs-var">splice</span></a><span>
</span><a name="line-1866"></a><span>
</span><a name="line-1867"></a><span class="hs-identifier">repP</span><span> </span><a name="local-6989586621681883500"><a href="#local-6989586621681883500"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Exotic pattern&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883500"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1868"></a><span>
</span><a name="line-1869"></a><span class="hs-comment">----------------------------------------------------------</span><span>
</span><a name="line-1870"></a><span class="hs-comment">-- Declaration ordering helpers</span><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span class="hs-identifier">sort_by_loc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882477"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882477"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1873"></a><a name="sort_by_loc"><a href="DsMeta.html#sort_by_loc"><span class="hs-identifier">sort_by_loc</span></a></a><span> </span><a name="local-6989586621681883501"><a href="#local-6989586621681883501"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sortBy</span><span> </span><a href="#local-6989586621681883502"><span class="hs-identifier hs-var">comp</span></a><span> </span><a href="#local-6989586621681883501"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1874"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681883502"><a href="#local-6989586621681883502"><span class="hs-identifier">comp</span></a></a><span> </span><a name="local-6989586621681883503"><a href="#local-6989586621681883503"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621681883504"><a href="#local-6989586621681883504"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621681883503"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621681883504"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-1875"></a><span>
</span><a name="line-1876"></a><span class="hs-identifier">de_loc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681882475"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681882476"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882476"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-1877"></a><a name="de_loc"><a href="DsMeta.html#de_loc"><span class="hs-identifier">de_loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-1878"></a><span>
</span><a name="line-1879"></a><span class="hs-comment">----------------------------------------------------------</span><span>
</span><a name="line-1880"></a><span class="hs-comment">--      The meta-environment</span><span>
</span><a name="line-1881"></a><span>
</span><a name="line-1882"></a><span class="hs-comment">-- A name/identifier association for fresh names of locally bound entities</span><span>
</span><a name="line-1883"></a><span class="hs-keyword">type</span><span> </span><a name="GenSymBind"><a href="DsMeta.html#GenSymBind"><span class="hs-identifier">GenSymBind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Id</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Gensym the string and bind it to the Id</span><span>
</span><a name="line-1884"></a><span>                                </span><span class="hs-comment">-- I.e.         (x, x_id) means</span><span>
</span><a name="line-1885"></a><span>                                </span><span class="hs-comment">--      let x_id = gensym &quot;x&quot; in ...</span><span>
</span><a name="line-1886"></a><span>
</span><a name="line-1887"></a><span class="hs-comment">-- Generate a fresh name for a locally bound entity</span><span>
</span><a name="line-1888"></a><span>
</span><a name="line-1889"></a><span class="hs-identifier">mkGenSyms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span>
</span><a name="line-1890"></a><span class="hs-comment">-- We can use the existing name.  For example:</span><span>
</span><a name="line-1891"></a><span class="hs-comment">--      [| \x_77 -&gt; x_77 + x_77 |]</span><span>
</span><a name="line-1892"></a><span class="hs-comment">-- desugars to</span><span>
</span><a name="line-1893"></a><span class="hs-comment">--      do { x_77 &lt;- genSym &quot;x&quot;; .... }</span><span>
</span><a name="line-1894"></a><span class="hs-comment">-- We use the same x_77 in the desugared program, but with the type Bndr</span><span>
</span><a name="line-1895"></a><span class="hs-comment">-- instead of Int</span><span>
</span><a name="line-1896"></a><span class="hs-comment">--</span><span>
</span><a name="line-1897"></a><span class="hs-comment">-- We do make it an Internal name, though (hence localiseName)</span><span>
</span><a name="line-1898"></a><span class="hs-comment">--</span><span>
</span><a name="line-1899"></a><span class="hs-comment">-- Nevertheless, it's monadic because we have to generate nameTy</span><span>
</span><a name="line-1900"></a><a name="mkGenSyms"><a href="DsMeta.html#mkGenSyms"><span class="hs-identifier">mkGenSyms</span></a></a><span> </span><a name="local-6989586621681883505"><a href="#local-6989586621681883505"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883506"><a href="#local-6989586621681883506"><span class="hs-identifier">var_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span>
</span><a name="line-1901"></a><span>                  </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681883507"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkLocalId</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">localiseName</span><span> </span><a href="#local-6989586621681883507"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883506"><span class="hs-identifier hs-var">var_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621681883507"><a href="#local-6989586621681883507"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883505"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1902"></a><span>
</span><a name="line-1903"></a><span>
</span><a name="line-1904"></a><span class="hs-identifier">addBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><a href="#local-6989586621681882474"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><a href="#local-6989586621681882474"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1905"></a><span class="hs-comment">-- Add a list of fresh names for locally bound entities to the</span><span>
</span><a name="line-1906"></a><span class="hs-comment">-- meta environment (which is part of the state carried around</span><span>
</span><a name="line-1907"></a><span class="hs-comment">-- by the desugarer monad)</span><span>
</span><a name="line-1908"></a><a name="addBinds"><a href="DsMeta.html#addBinds"><span class="hs-identifier">addBinds</span></a></a><span> </span><a name="local-6989586621681883508"><a href="#local-6989586621681883508"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621681883509"><a href="#local-6989586621681883509"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#dsExtendMetaEnv"><span class="hs-identifier hs-var">dsExtendMetaEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkNameEnv</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621681883510"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">DsBound</span><span> </span><a href="#local-6989586621681883511"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883510"><a href="#local-6989586621681883510"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883511"><a href="#local-6989586621681883511"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883508"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883509"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1909"></a><span>
</span><a name="line-1910"></a><span class="hs-comment">-- Look up a locally bound name</span><span>
</span><a name="line-1911"></a><span class="hs-comment">--</span><span>
</span><a name="line-1912"></a><span class="hs-identifier">lookupLBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-1913"></a><a name="lookupLBinder"><a href="DsMeta.html#lookupLBinder"><span class="hs-identifier">lookupLBinder</span></a></a><span> </span><a name="local-6989586621681883512"><a href="#local-6989586621681883512"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#lookupBinder"><span class="hs-identifier hs-var">lookupBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883512"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1914"></a><span>
</span><a name="line-1915"></a><span class="hs-identifier">lookupBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-1916"></a><a name="lookupBinder"><a href="DsMeta.html#lookupBinder"><span class="hs-identifier">lookupBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span>
</span><a name="line-1917"></a><span>  </span><span class="hs-comment">-- Binders are brought into scope before the pattern or what-not is</span><span>
</span><a name="line-1918"></a><span>  </span><span class="hs-comment">-- desugared.  Moreover, in instance declaration the binder of a method</span><span>
</span><a name="line-1919"></a><span>  </span><span class="hs-comment">-- will be the selector Id and hence a global; so we need the</span><span>
</span><a name="line-1920"></a><span>  </span><span class="hs-comment">-- globalVar case of lookupOcc</span><span>
</span><a name="line-1921"></a><span>
</span><a name="line-1922"></a><span class="hs-comment">-- Look up a name that is either locally bound or a global name</span><span>
</span><a name="line-1923"></a><span class="hs-comment">--</span><span>
</span><a name="line-1924"></a><span class="hs-comment">--  * If it is a global name, generate the &quot;original name&quot; representation (ie,</span><span>
</span><a name="line-1925"></a><span class="hs-comment">--   the &lt;module&gt;:&lt;name&gt; form) for the associated entity</span><span>
</span><a name="line-1926"></a><span class="hs-comment">--</span><span>
</span><a name="line-1927"></a><span class="hs-identifier">lookupLOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-1928"></a><span class="hs-comment">-- Lookup an occurrence; it can't be a splice.</span><span>
</span><a name="line-1929"></a><span class="hs-comment">-- Use the in-scope bindings if they exist</span><span>
</span><a name="line-1930"></a><a name="lookupLOcc"><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier">lookupLOcc</span></a></a><span> </span><a name="local-6989586621681883513"><a href="#local-6989586621681883513"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883513"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1931"></a><span>
</span><a name="line-1932"></a><span class="hs-identifier">lookupOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-1933"></a><a name="lookupOcc"><a href="DsMeta.html#lookupOcc"><span class="hs-identifier">lookupOcc</span></a></a><span> </span><a name="local-6989586621681883514"><a href="#local-6989586621681883514"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1934"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>  </span><a name="local-6989586621681883515"><a href="#local-6989586621681883515"><span class="hs-identifier">mb_val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupMetaEnv"><span class="hs-identifier hs-var">dsLookupMetaEnv</span></a><span> </span><a href="#local-6989586621681883514"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1935"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883515"><span class="hs-identifier hs-var">mb_val</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1936"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#globalVar"><span class="hs-identifier hs-var">globalVar</span></a><span> </span><a href="#local-6989586621681883514"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1937"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DsBound</span><span> </span><a name="local-6989586621681883516"><a href="#local-6989586621681883516"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreVar"><span class="hs-identifier hs-var">coreVar</span></a><span> </span><a href="#local-6989586621681883516"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1938"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DsSplice</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;repE:lookupOcc&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883514"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1939"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1940"></a><span>
</span><a name="line-1941"></a><span class="hs-identifier">globalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-1942"></a><span class="hs-comment">-- Not bound by the meta-env</span><span>
</span><a name="line-1943"></a><span class="hs-comment">-- Could be top-level; or could be local</span><span>
</span><a name="line-1944"></a><span class="hs-comment">--      f x = $(g [| x |])</span><span>
</span><a name="line-1945"></a><span class="hs-comment">-- Here the x will be local</span><span>
</span><a name="line-1946"></a><a name="globalVar"><a href="DsMeta.html#globalVar"><span class="hs-identifier">globalVar</span></a></a><span> </span><a name="local-6989586621681883517"><a href="#local-6989586621681883517"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-1947"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isExternalName</span><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1948"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883523"><a href="#local-6989586621681883523"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><a href="#local-6989586621681883519"><span class="hs-identifier hs-var">name_mod</span></a><span>
</span><a name="line-1949"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883524"><a href="#local-6989586621681883524"><span class="hs-identifier">pkg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><a href="#local-6989586621681883520"><span class="hs-identifier hs-var">name_pkg</span></a><span>
</span><a name="line-1950"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883525"><a href="#local-6989586621681883525"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#nameLit"><span class="hs-identifier hs-var">nameLit</span></a><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1951"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="#local-6989586621681883522"><span class="hs-identifier hs-var">mk_varg</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883524"><span class="hs-identifier hs-var">pkg</span></a><span class="hs-special">,</span><a href="#local-6989586621681883523"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">,</span><a href="#local-6989586621681883525"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1952"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1953"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883526"><a href="#local-6989586621681883526"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#nameLit"><span class="hs-identifier hs-var">nameLit</span></a><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1954"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883527"><a href="#local-6989586621681883527"><span class="hs-identifier">uni</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreIntLit"><span class="hs-identifier hs-var">coreIntLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getUnique</span><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1955"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#mkNameLName"><span class="hs-identifier hs-var">mkNameLName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883526"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><a href="#local-6989586621681883527"><span class="hs-identifier hs-var">uni</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1956"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1957"></a><span>      </span><a name="local-6989586621681883518"><a href="#local-6989586621681883518"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isExternalName</span><span> </span><span class="hs-identifier hs-var">name</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">nameModule</span><span> </span><span class="hs-identifier">name</span><span>
</span><a name="line-1958"></a><span>      </span><a name="local-6989586621681883519"><a href="#local-6989586621681883519"><span class="hs-identifier">name_mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">moduleNameString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-6989586621681883518"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1959"></a><span>      </span><a name="local-6989586621681883520"><a href="#local-6989586621681883520"><span class="hs-identifier">name_pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unitIdString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681883518"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>
</span><a name="line-1960"></a><span>      </span><a name="local-6989586621681883521"><a href="#local-6989586621681883521"><span class="hs-identifier">name_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nameOccName</span><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1961"></a><span>      </span><a name="local-6989586621681883522"><a href="#local-6989586621681883522"><span class="hs-identifier">mk_varg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">OccName.isDataOcc</span><span> </span><a href="#local-6989586621681883521"><span class="hs-identifier hs-var">name_occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="THNames.html#mkNameG_dName"><span class="hs-identifier hs-var">mkNameG_dName</span></a><span>
</span><a name="line-1962"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">OccName.isVarOcc</span><span>  </span><a href="#local-6989586621681883521"><span class="hs-identifier hs-var">name_occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="THNames.html#mkNameG_vName"><span class="hs-identifier hs-var">mkNameG_vName</span></a><span>
</span><a name="line-1963"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">OccName.isTcOcc</span><span>   </span><a href="#local-6989586621681883521"><span class="hs-identifier hs-var">name_occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="THNames.html#mkNameG_tcName"><span class="hs-identifier hs-var">mkNameG_tcName</span></a><span>
</span><a name="line-1964"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pprPanic</span><span> </span><span class="hs-string">&quot;DsMeta.globalVar&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883517"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1965"></a><span>
</span><a name="line-1966"></a><span class="hs-identifier">lookupType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>      </span><span class="hs-comment">-- Name of type constructor (e.g. TH.ExpQ)</span><span>
</span><a name="line-1967"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-identifier hs-type">Type</span><span>  </span><span class="hs-comment">-- The type</span><span>
</span><a name="line-1968"></a><a name="lookupType"><a href="DsMeta.html#lookupType"><span class="hs-identifier">lookupType</span></a></a><span> </span><a name="local-6989586621681883528"><a href="#local-6989586621681883528"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883529"><a href="#local-6989586621681883529"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupTyCon"><span class="hs-identifier hs-var">dsLookupTyCon</span></a><span> </span><a href="#local-6989586621681883528"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-special">;</span><span>
</span><a name="line-1969"></a><span>                          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkTyConApp</span><span> </span><a href="#local-6989586621681883529"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1970"></a><span>
</span><a name="line-1971"></a><span class="hs-identifier">wrapGenSyms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#GenSymBind"><span class="hs-identifier hs-type">GenSymBind</span></a><span class="hs-special">]</span><span>
</span><a name="line-1972"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882473"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882473"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1973"></a><span class="hs-comment">-- wrapGenSyms [(nm1,id1), (nm2,id2)] y</span><span>
</span><a name="line-1974"></a><span class="hs-comment">--      --&gt; bindQ (gensym nm1) (\ id1 -&gt;</span><span>
</span><a name="line-1975"></a><span class="hs-comment">--          bindQ (gensym nm2 (\ id2 -&gt;</span><span>
</span><a name="line-1976"></a><span class="hs-comment">--          y))</span><span>
</span><a name="line-1977"></a><span>
</span><a name="line-1978"></a><a name="wrapGenSyms"><a href="DsMeta.html#wrapGenSyms"><span class="hs-identifier">wrapGenSyms</span></a></a><span> </span><a name="local-6989586621681883530"><a href="#local-6989586621681883530"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621681883531"><a href="#local-6989586621681883531"><span class="hs-identifier">body</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883532"><a href="#local-6989586621681883532"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1979"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883542"><a href="#local-6989586621681883542"><span class="hs-identifier">var_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="THNames.html#nameTyConName"><span class="hs-identifier hs-var">nameTyConName</span></a><span>
</span><a name="line-1980"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621681883534"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621681883542"><span class="hs-identifier hs-var">var_ty</span></a><span> </span><a href="#local-6989586621681883530"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1981"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1982"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621681883533"><a href="#local-6989586621681883533"><span class="hs-identifier">elt_ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tcTyConAppArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprType</span><span> </span><a href="#local-6989586621681883532"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1983"></a><span>        </span><span class="hs-comment">-- b :: Q a, so we can get the type 'a' by looking at the</span><span>
</span><a name="line-1984"></a><span>        </span><span class="hs-comment">-- argument type. NB: this relies on Q being a data/newtype,</span><span>
</span><a name="line-1985"></a><span>        </span><span class="hs-comment">-- not a type synonym</span><span>
</span><a name="line-1986"></a><span>
</span><a name="line-1987"></a><span>    </span><a name="local-6989586621681883534"><a href="#local-6989586621681883534"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681883531"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1988"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621681883535"><a href="#local-6989586621681883535"><span class="hs-identifier">var_ty</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621681883536"><a href="#local-6989586621681883536"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><a name="local-6989586621681883537"><a href="#local-6989586621681883537"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621681883538"><a href="#local-6989586621681883538"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1989"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883539"><a href="#local-6989586621681883539"><span class="hs-identifier">body'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681883534"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621681883535"><span class="hs-identifier hs-var">var_ty</span></a><span> </span><a href="#local-6989586621681883538"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1990"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883540"><a href="#local-6989586621681883540"><span class="hs-identifier">lit_str</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#nameLit"><span class="hs-identifier hs-var">nameLit</span></a><span> </span><a href="#local-6989586621681883536"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1991"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883541"><a href="#local-6989586621681883541"><span class="hs-identifier">gensym_app</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repGensym"><span class="hs-identifier hs-var">repGensym</span></a><span> </span><a href="#local-6989586621681883540"><span class="hs-identifier hs-var">lit_str</span></a><span>
</span><a name="line-1992"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repBindQ"><span class="hs-identifier hs-var">repBindQ</span></a><span> </span><a href="#local-6989586621681883535"><span class="hs-identifier hs-var">var_ty</span></a><span> </span><a href="#local-6989586621681883533"><span class="hs-identifier hs-var">elt_ty</span></a><span>
</span><a name="line-1993"></a><span>                      </span><a href="#local-6989586621681883541"><span class="hs-identifier hs-var">gensym_app</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lam</span><span> </span><a href="#local-6989586621681883537"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621681883539"><span class="hs-identifier hs-var">body'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1994"></a><span>
</span><a name="line-1995"></a><span class="hs-identifier">nameLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-1996"></a><a name="nameLit"><a href="DsMeta.html#nameLit"><span class="hs-identifier">nameLit</span></a></a><span> </span><a name="local-6989586621681883543"><a href="#local-6989586621681883543"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">occNameString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameOccName</span><span> </span><a href="#local-6989586621681883543"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1997"></a><span>
</span><a name="line-1998"></a><span class="hs-identifier">occNameLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OccName</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-1999"></a><a name="occNameLit"><a href="DsMeta.html#occNameLit"><span class="hs-identifier">occNameLit</span></a></a><span> </span><a name="local-6989586621681883544"><a href="#local-6989586621681883544"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">occNameString</span><span> </span><a href="#local-6989586621681883544"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2000"></a><span>
</span><a name="line-2001"></a><span>
</span><a name="line-2002"></a><span class="hs-comment">-- %*********************************************************************</span><span>
</span><a name="line-2003"></a><span class="hs-comment">-- %*                                                                   *</span><span>
</span><a name="line-2004"></a><span class="hs-comment">--              Constructing code</span><span>
</span><a name="line-2005"></a><span class="hs-comment">-- %*                                                                   *</span><span>
</span><a name="line-2006"></a><span class="hs-comment">-- %*********************************************************************</span><span>
</span><a name="line-2007"></a><span>
</span><a name="line-2008"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2009"></a><span class="hs-comment">-- PHANTOM TYPES for consistency. In order to make sure we do this correct</span><span>
</span><a name="line-2010"></a><span class="hs-comment">-- we invent a new datatype which uses phantom types.</span><span>
</span><a name="line-2011"></a><span>
</span><a name="line-2012"></a><span class="hs-keyword">newtype</span><span> </span><a name="Core"><a href="DsMeta.html#Core"><span class="hs-identifier">Core</span></a></a><span> </span><a name="local-6989586621681881797"><a href="#local-6989586621681881797"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MkC"><a href="DsMeta.html#MkC"><span class="hs-identifier">MkC</span></a></a><span> </span><span class="hs-identifier hs-type">CoreExpr</span><span>
</span><a name="line-2013"></a><span class="hs-identifier">unC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882472"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoreExpr</span><span>
</span><a name="line-2014"></a><a name="unC"><a href="DsMeta.html#unC"><span class="hs-identifier">unC</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883545"><a href="#local-6989586621681883545"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681883545"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2015"></a><span>
</span><a name="line-2016"></a><span class="hs-identifier">rep2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-type">CoreExpr</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882471"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2017"></a><a name="rep2"><a href="DsMeta.html#rep2"><span class="hs-identifier">rep2</span></a></a><span> </span><a name="local-6989586621681883546"><a href="#local-6989586621681883546"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681883547"><a href="#local-6989586621681883547"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883548"><a href="#local-6989586621681883548"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupGlobalId"><span class="hs-identifier hs-var">dsLookupGlobalId</span></a><span> </span><a href="#local-6989586621681883546"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2018"></a><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-identifier hs-var">App</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621681883548"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883547"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2019"></a><span>
</span><a name="line-2020"></a><span class="hs-identifier">dataCon'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">CoreExpr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882470"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2021"></a><a name="dataCon%27"><a href="DsMeta.html#dataCon%27"><span class="hs-identifier">dataCon'</span></a></a><span> </span><a name="local-6989586621681883549"><a href="#local-6989586621681883549"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621681883550"><a href="#local-6989586621681883550"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883551"><a href="#local-6989586621681883551"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsLookupDataCon"><span class="hs-identifier hs-var">dsLookupDataCon</span></a><span> </span><a href="#local-6989586621681883549"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2022"></a><span>                     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mkCoreConApps</span><span> </span><a href="#local-6989586621681883551"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621681883550"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span class="hs-identifier">dataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681882469"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2025"></a><a name="dataCon"><a href="DsMeta.html#dataCon"><span class="hs-identifier">dataCon</span></a></a><span> </span><a name="local-6989586621681883552"><a href="#local-6989586621681883552"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#dataCon%27"><span class="hs-identifier hs-var">dataCon'</span></a><span> </span><a href="#local-6989586621681883552"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2026"></a><span>
</span><a name="line-2027"></a><span>
</span><a name="line-2028"></a><span class="hs-comment">-- %*********************************************************************</span><span>
</span><a name="line-2029"></a><span class="hs-comment">-- %*                                                                   *</span><span>
</span><a name="line-2030"></a><span class="hs-comment">--              The 'smart constructors'</span><span>
</span><a name="line-2031"></a><span class="hs-comment">-- %*                                                                   *</span><span>
</span><a name="line-2032"></a><span class="hs-comment">-- %*********************************************************************</span><span>
</span><a name="line-2033"></a><span>
</span><a name="line-2034"></a><span class="hs-comment">--------------- Patterns -----------------</span><span>
</span><a name="line-2035"></a><span class="hs-identifier">repPlit</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2036"></a><a name="repPlit"><a href="DsMeta.html#repPlit"><span class="hs-identifier">repPlit</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883553"><a href="#local-6989586621681883553"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#litPName"><span class="hs-identifier hs-var">litPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883553"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-2037"></a><span>
</span><a name="line-2038"></a><span class="hs-identifier">repPvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2039"></a><a name="repPvar"><a href="DsMeta.html#repPvar"><span class="hs-identifier">repPvar</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883554"><a href="#local-6989586621681883554"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#varPName"><span class="hs-identifier hs-var">varPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883554"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2040"></a><span>
</span><a name="line-2041"></a><span class="hs-identifier">repPtup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2042"></a><a name="repPtup"><a href="DsMeta.html#repPtup"><span class="hs-identifier">repPtup</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883555"><a href="#local-6989586621681883555"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tupPName"><span class="hs-identifier hs-var">tupPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883555"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2043"></a><span>
</span><a name="line-2044"></a><span class="hs-identifier">repPunboxedTup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2045"></a><a name="repPunboxedTup"><a href="DsMeta.html#repPunboxedTup"><span class="hs-identifier">repPunboxedTup</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883556"><a href="#local-6989586621681883556"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedTupPName"><span class="hs-identifier hs-var">unboxedTupPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883556"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2046"></a><span>
</span><a name="line-2047"></a><span class="hs-identifier">repPunboxedSum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.SumAlt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.SumArity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2048"></a><span class="hs-comment">-- Note: not Core TH.SumAlt or Core TH.SumArity; it's easier to be direct here</span><span>
</span><a name="line-2049"></a><a name="repPunboxedSum"><a href="DsMeta.html#repPunboxedSum"><span class="hs-identifier">repPunboxedSum</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883557"><a href="#local-6989586621681883557"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883558"><a href="#local-6989586621681883558"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621681883559"><a href="#local-6989586621681883559"><span class="hs-identifier">arity</span></a></a><span>
</span><a name="line-2050"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883560"><a href="#local-6989586621681883560"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2051"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedSumPName"><span class="hs-identifier hs-var">unboxedSumPName</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681883557"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-2052"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883560"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883558"><span class="hs-identifier hs-var">alt</span></a><span>
</span><a name="line-2053"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883560"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883559"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2054"></a><span>
</span><a name="line-2055"></a><span class="hs-identifier">repPcon</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2056"></a><a name="repPcon"><a href="DsMeta.html#repPcon"><span class="hs-identifier">repPcon</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883561"><a href="#local-6989586621681883561"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883562"><a href="#local-6989586621681883562"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#conPName"><span class="hs-identifier hs-var">conPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883561"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883562"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2057"></a><span>
</span><a name="line-2058"></a><span class="hs-identifier">repPrec</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">,</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2059"></a><a name="repPrec"><a href="DsMeta.html#repPrec"><span class="hs-identifier">repPrec</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883563"><a href="#local-6989586621681883563"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883564"><a href="#local-6989586621681883564"><span class="hs-identifier">rps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recPName"><span class="hs-identifier hs-var">recPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883563"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-6989586621681883564"><span class="hs-identifier hs-var">rps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2060"></a><span>
</span><a name="line-2061"></a><span class="hs-identifier">repPinfix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2062"></a><a name="repPinfix"><a href="DsMeta.html#repPinfix"><span class="hs-identifier">repPinfix</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883565"><a href="#local-6989586621681883565"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883566"><a href="#local-6989586621681883566"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883567"><a href="#local-6989586621681883567"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#infixPName"><span class="hs-identifier hs-var">infixPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883565"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883566"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883567"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2063"></a><span>
</span><a name="line-2064"></a><span class="hs-identifier">repPtilde</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2065"></a><a name="repPtilde"><a href="DsMeta.html#repPtilde"><span class="hs-identifier">repPtilde</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883568"><a href="#local-6989586621681883568"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tildePName"><span class="hs-identifier hs-var">tildePName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883568"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-2066"></a><span>
</span><a name="line-2067"></a><span class="hs-identifier">repPbang</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2068"></a><a name="repPbang"><a href="DsMeta.html#repPbang"><span class="hs-identifier">repPbang</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883569"><a href="#local-6989586621681883569"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#bangPName"><span class="hs-identifier hs-var">bangPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883569"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-2069"></a><span>
</span><a name="line-2070"></a><span class="hs-identifier">repPaspat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2071"></a><a name="repPaspat"><a href="DsMeta.html#repPaspat"><span class="hs-identifier">repPaspat</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883570"><a href="#local-6989586621681883570"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883571"><a href="#local-6989586621681883571"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#asPName"><span class="hs-identifier hs-var">asPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883570"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883571"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-2072"></a><span>
</span><a name="line-2073"></a><span class="hs-identifier">repPwild</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2074"></a><a name="repPwild"><a href="DsMeta.html#repPwild"><span class="hs-identifier">repPwild</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#wildPName"><span class="hs-identifier hs-var">wildPName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2075"></a><span>
</span><a name="line-2076"></a><span class="hs-identifier">repPlist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2077"></a><a name="repPlist"><a href="DsMeta.html#repPlist"><span class="hs-identifier">repPlist</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883572"><a href="#local-6989586621681883572"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#listPName"><span class="hs-identifier hs-var">listPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883572"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-2078"></a><span>
</span><a name="line-2079"></a><span class="hs-identifier">repPview</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2080"></a><a name="repPview"><a href="DsMeta.html#repPview"><span class="hs-identifier">repPview</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883573"><a href="#local-6989586621681883573"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883574"><a href="#local-6989586621681883574"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#viewPName"><span class="hs-identifier hs-var">viewPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883573"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621681883574"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-2081"></a><span>
</span><a name="line-2082"></a><span class="hs-identifier">repPsig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">)</span><span>
</span><a name="line-2083"></a><a name="repPsig"><a href="DsMeta.html#repPsig"><span class="hs-identifier">repPsig</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883575"><a href="#local-6989586621681883575"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883576"><a href="#local-6989586621681883576"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sigPName"><span class="hs-identifier hs-var">sigPName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883575"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883576"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-2084"></a><span>
</span><a name="line-2085"></a><span class="hs-comment">--------------- Expressions -----------------</span><span>
</span><a name="line-2086"></a><span class="hs-identifier">repVarOrCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2087"></a><a name="repVarOrCon"><a href="DsMeta.html#repVarOrCon"><span class="hs-identifier">repVarOrCon</span></a></a><span> </span><a name="local-6989586621681883577"><a href="#local-6989586621681883577"><span class="hs-identifier">vc</span></a></a><span> </span><a name="local-6989586621681883578"><a href="#local-6989586621681883578"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isDataOcc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameOccName</span><span> </span><a href="#local-6989586621681883577"><span class="hs-identifier hs-var">vc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repCon"><span class="hs-identifier hs-var">repCon</span></a><span> </span><a href="#local-6989586621681883578"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-2088"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repVar"><span class="hs-identifier hs-var">repVar</span></a><span> </span><a href="#local-6989586621681883578"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-2089"></a><span>
</span><a name="line-2090"></a><span class="hs-identifier">repVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2091"></a><a name="repVar"><a href="DsMeta.html#repVar"><span class="hs-identifier">repVar</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883579"><a href="#local-6989586621681883579"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#varEName"><span class="hs-identifier hs-var">varEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883579"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2092"></a><span>
</span><a name="line-2093"></a><span class="hs-identifier">repCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2094"></a><a name="repCon"><a href="DsMeta.html#repCon"><span class="hs-identifier">repCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883580"><a href="#local-6989586621681883580"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#conEName"><span class="hs-identifier hs-var">conEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883580"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2095"></a><span>
</span><a name="line-2096"></a><span class="hs-identifier">repLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Lit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2097"></a><a name="repLit"><a href="DsMeta.html#repLit"><span class="hs-identifier">repLit</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883581"><a href="#local-6989586621681883581"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#litEName"><span class="hs-identifier hs-var">litEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883581"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-2098"></a><span>
</span><a name="line-2099"></a><span class="hs-identifier">repApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2100"></a><a name="repApp"><a href="DsMeta.html#repApp"><span class="hs-identifier">repApp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883582"><a href="#local-6989586621681883582"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883583"><a href="#local-6989586621681883583"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#appEName"><span class="hs-identifier hs-var">appEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883582"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883583"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2101"></a><span>
</span><a name="line-2102"></a><span class="hs-identifier">repAppType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2103"></a><a name="repAppType"><a href="DsMeta.html#repAppType"><span class="hs-identifier">repAppType</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883584"><a href="#local-6989586621681883584"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883585"><a href="#local-6989586621681883585"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#appTypeEName"><span class="hs-identifier hs-var">appTypeEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883584"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883585"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2104"></a><span>
</span><a name="line-2105"></a><span class="hs-identifier">repLam</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2106"></a><a name="repLam"><a href="DsMeta.html#repLam"><span class="hs-identifier">repLam</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883586"><a href="#local-6989586621681883586"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883587"><a href="#local-6989586621681883587"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#lamEName"><span class="hs-identifier hs-var">lamEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883586"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883587"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2107"></a><span>
</span><a name="line-2108"></a><span class="hs-identifier">repLamCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.MatchQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2109"></a><a name="repLamCase"><a href="DsMeta.html#repLamCase"><span class="hs-identifier">repLamCase</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883588"><a href="#local-6989586621681883588"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#lamCaseEName"><span class="hs-identifier hs-var">lamCaseEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883588"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">]</span><span>
</span><a name="line-2110"></a><span>
</span><a name="line-2111"></a><span class="hs-identifier">repTup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2112"></a><a name="repTup"><a href="DsMeta.html#repTup"><span class="hs-identifier">repTup</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883589"><a href="#local-6989586621681883589"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tupEName"><span class="hs-identifier hs-var">tupEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883589"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><span class="hs-identifier">repUnboxedTup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><a name="repUnboxedTup"><a href="DsMeta.html#repUnboxedTup"><span class="hs-identifier">repUnboxedTup</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883590"><a href="#local-6989586621681883590"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedTupEName"><span class="hs-identifier hs-var">unboxedTupEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883590"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-2116"></a><span>
</span><a name="line-2117"></a><span class="hs-identifier">repUnboxedSum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.SumAlt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.SumArity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2118"></a><span class="hs-comment">-- Note: not Core TH.SumAlt or Core TH.SumArity; it's easier to be direct here</span><span>
</span><a name="line-2119"></a><a name="repUnboxedSum"><a href="DsMeta.html#repUnboxedSum"><span class="hs-identifier">repUnboxedSum</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883591"><a href="#local-6989586621681883591"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883592"><a href="#local-6989586621681883592"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621681883593"><a href="#local-6989586621681883593"><span class="hs-identifier">arity</span></a></a><span>
</span><a name="line-2120"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883594"><a href="#local-6989586621681883594"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2121"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedSumEName"><span class="hs-identifier hs-var">unboxedSumEName</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681883591"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2122"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883594"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883592"><span class="hs-identifier hs-var">alt</span></a><span>
</span><a name="line-2123"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883594"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883593"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2124"></a><span>
</span><a name="line-2125"></a><span class="hs-identifier">repCond</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2126"></a><a name="repCond"><a href="DsMeta.html#repCond"><span class="hs-identifier">repCond</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883595"><a href="#local-6989586621681883595"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883596"><a href="#local-6989586621681883596"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883597"><a href="#local-6989586621681883597"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#condEName"><span class="hs-identifier hs-var">condEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883595"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883596"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621681883597"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-2127"></a><span>
</span><a name="line-2128"></a><span class="hs-identifier">repMultiIf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2129"></a><a name="repMultiIf"><a href="DsMeta.html#repMultiIf"><span class="hs-identifier">repMultiIf</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883598"><a href="#local-6989586621681883598"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#multiIfEName"><span class="hs-identifier hs-var">multiIfEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883598"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">]</span><span>
</span><a name="line-2130"></a><span>
</span><a name="line-2131"></a><span class="hs-identifier">repLetE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2132"></a><a name="repLetE"><a href="DsMeta.html#repLetE"><span class="hs-identifier">repLetE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883599"><a href="#local-6989586621681883599"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883600"><a href="#local-6989586621681883600"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#letEName"><span class="hs-identifier hs-var">letEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883599"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883600"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2133"></a><span>
</span><a name="line-2134"></a><span class="hs-identifier">repCaseE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.MatchQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span class="hs-special">(</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2135"></a><a name="repCaseE"><a href="DsMeta.html#repCaseE"><span class="hs-identifier">repCaseE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883601"><a href="#local-6989586621681883601"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883602"><a href="#local-6989586621681883602"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#caseEName"><span class="hs-identifier hs-var">caseEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883601"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883602"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">]</span><span>
</span><a name="line-2136"></a><span>
</span><a name="line-2137"></a><span class="hs-identifier">repDoE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2138"></a><a name="repDoE"><a href="DsMeta.html#repDoE"><span class="hs-identifier">repDoE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883603"><a href="#local-6989586621681883603"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#doEName"><span class="hs-identifier hs-var">doEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883603"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-2139"></a><span>
</span><a name="line-2140"></a><span class="hs-identifier">repMDoE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2141"></a><a name="repMDoE"><a href="DsMeta.html#repMDoE"><span class="hs-identifier">repMDoE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883604"><a href="#local-6989586621681883604"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#mdoEName"><span class="hs-identifier hs-var">mdoEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883604"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-2142"></a><span>
</span><a name="line-2143"></a><span class="hs-identifier">repComp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2144"></a><a name="repComp"><a href="DsMeta.html#repComp"><span class="hs-identifier">repComp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883605"><a href="#local-6989586621681883605"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#compEName"><span class="hs-identifier hs-var">compEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883605"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-2145"></a><span>
</span><a name="line-2146"></a><span class="hs-identifier">repListExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2147"></a><a name="repListExp"><a href="DsMeta.html#repListExp"><span class="hs-identifier">repListExp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883606"><a href="#local-6989586621681883606"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#listEName"><span class="hs-identifier hs-var">listEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883606"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-2148"></a><span>
</span><a name="line-2149"></a><span class="hs-identifier">repSigExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2150"></a><a name="repSigExp"><a href="DsMeta.html#repSigExp"><span class="hs-identifier">repSigExp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883607"><a href="#local-6989586621681883607"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883608"><a href="#local-6989586621681883608"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sigEName"><span class="hs-identifier hs-var">sigEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883607"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621681883608"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-2151"></a><span>
</span><a name="line-2152"></a><span class="hs-identifier">repRecCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2153"></a><a name="repRecCon"><a href="DsMeta.html#repRecCon"><span class="hs-identifier">repRecCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883609"><a href="#local-6989586621681883609"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883610"><a href="#local-6989586621681883610"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recConEName"><span class="hs-identifier hs-var">recConEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883609"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-6989586621681883610"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2154"></a><span>
</span><a name="line-2155"></a><span class="hs-identifier">repRecUpd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2156"></a><a name="repRecUpd"><a href="DsMeta.html#repRecUpd"><span class="hs-identifier">repRecUpd</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883611"><a href="#local-6989586621681883611"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883612"><a href="#local-6989586621681883612"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recUpdEName"><span class="hs-identifier hs-var">recUpdEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883611"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621681883612"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2157"></a><span>
</span><a name="line-2158"></a><span class="hs-identifier">repFieldExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.FieldExp</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2159"></a><a name="repFieldExp"><a href="DsMeta.html#repFieldExp"><span class="hs-identifier">repFieldExp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883613"><a href="#local-6989586621681883613"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883614"><a href="#local-6989586621681883614"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fieldExpName"><span class="hs-identifier hs-var">fieldExpName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883613"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><a href="#local-6989586621681883614"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-2160"></a><span>
</span><a name="line-2161"></a><span class="hs-identifier">repInfixApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2162"></a><a name="repInfixApp"><a href="DsMeta.html#repInfixApp"><span class="hs-identifier">repInfixApp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883615"><a href="#local-6989586621681883615"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883616"><a href="#local-6989586621681883616"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883617"><a href="#local-6989586621681883617"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#infixAppName"><span class="hs-identifier hs-var">infixAppName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883615"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883616"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621681883617"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-2163"></a><span>
</span><a name="line-2164"></a><span class="hs-identifier">repSectionL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2165"></a><a name="repSectionL"><a href="DsMeta.html#repSectionL"><span class="hs-identifier">repSectionL</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883618"><a href="#local-6989586621681883618"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883619"><a href="#local-6989586621681883619"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sectionLName"><span class="hs-identifier hs-var">sectionLName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883618"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883619"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2166"></a><span>
</span><a name="line-2167"></a><span class="hs-identifier">repSectionR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2168"></a><a name="repSectionR"><a href="DsMeta.html#repSectionR"><span class="hs-identifier">repSectionR</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883620"><a href="#local-6989586621681883620"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883621"><a href="#local-6989586621681883621"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sectionRName"><span class="hs-identifier hs-var">sectionRName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883620"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883621"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2169"></a><span>
</span><a name="line-2170"></a><span class="hs-identifier">repImplicitParamVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2171"></a><a name="repImplicitParamVar"><a href="DsMeta.html#repImplicitParamVar"><span class="hs-identifier">repImplicitParamVar</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883622"><a href="#local-6989586621681883622"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#implicitParamVarEName"><span class="hs-identifier hs-var">implicitParamVarEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883622"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-2172"></a><span>
</span><a name="line-2173"></a><span class="hs-comment">------------ Right hand sides (guarded expressions) ----</span><span>
</span><a name="line-2174"></a><span class="hs-identifier">repGuarded</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2175"></a><a name="repGuarded"><a href="DsMeta.html#repGuarded"><span class="hs-identifier">repGuarded</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883623"><a href="#local-6989586621681883623"><span class="hs-identifier">pairs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#guardedBName"><span class="hs-identifier hs-var">guardedBName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883623"><span class="hs-identifier hs-var">pairs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2176"></a><span>
</span><a name="line-2177"></a><span class="hs-identifier">repNormal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2178"></a><a name="repNormal"><a href="DsMeta.html#repNormal"><span class="hs-identifier">repNormal</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883624"><a href="#local-6989586621681883624"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#normalBName"><span class="hs-identifier hs-var">normalBName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883624"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2179"></a><span>
</span><a name="line-2180"></a><span class="hs-comment">------------ Guards ----</span><span>
</span><a name="line-2181"></a><span class="hs-identifier">repLNormalGE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-2182"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2183"></a><a name="repLNormalGE"><a href="DsMeta.html#repLNormalGE"><span class="hs-identifier">repLNormalGE</span></a></a><span> </span><a name="local-6989586621681883625"><a href="#local-6989586621681883625"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621681883626"><a href="#local-6989586621681883626"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883627"><a href="#local-6989586621681883627"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883625"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-2184"></a><span>                      </span><a name="local-6989586621681883628"><a href="#local-6989586621681883628"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLE"><span class="hs-identifier hs-var">repLE</span></a><span> </span><a href="#local-6989586621681883626"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2185"></a><span>                      </span><a href="DsMeta.html#repNormalGE"><span class="hs-identifier hs-var">repNormalGE</span></a><span> </span><a href="#local-6989586621681883627"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-6989586621681883628"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-2186"></a><span>
</span><a name="line-2187"></a><span class="hs-identifier">repNormalGE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2188"></a><a name="repNormalGE"><a href="DsMeta.html#repNormalGE"><span class="hs-identifier">repNormalGE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883629"><a href="#local-6989586621681883629"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883630"><a href="#local-6989586621681883630"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#normalGEName"><span class="hs-identifier hs-var">normalGEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883629"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883630"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2189"></a><span>
</span><a name="line-2190"></a><span class="hs-identifier">repPatGE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Guard</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TH.Exp</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2191"></a><a name="repPatGE"><a href="DsMeta.html#repPatGE"><span class="hs-identifier">repPatGE</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883631"><a href="#local-6989586621681883631"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883632"><a href="#local-6989586621681883632"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#patGEName"><span class="hs-identifier hs-var">patGEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883631"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883632"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span class="hs-comment">------------- Stmts -------------------</span><span>
</span><a name="line-2194"></a><span class="hs-identifier">repBindSt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2195"></a><a name="repBindSt"><a href="DsMeta.html#repBindSt"><span class="hs-identifier">repBindSt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883633"><a href="#local-6989586621681883633"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883634"><a href="#local-6989586621681883634"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#bindSName"><span class="hs-identifier hs-var">bindSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883633"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><a href="#local-6989586621681883634"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2196"></a><span>
</span><a name="line-2197"></a><span class="hs-identifier">repLetSt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2198"></a><a name="repLetSt"><a href="DsMeta.html#repLetSt"><span class="hs-identifier">repLetSt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883635"><a href="#local-6989586621681883635"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#letSName"><span class="hs-identifier hs-var">letSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883635"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2199"></a><span>
</span><a name="line-2200"></a><span class="hs-identifier">repNoBindSt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2201"></a><a name="repNoBindSt"><a href="DsMeta.html#repNoBindSt"><span class="hs-identifier">repNoBindSt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883636"><a href="#local-6989586621681883636"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#noBindSName"><span class="hs-identifier hs-var">noBindSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883636"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2202"></a><span>
</span><a name="line-2203"></a><span class="hs-identifier">repParSt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2204"></a><a name="repParSt"><a href="DsMeta.html#repParSt"><span class="hs-identifier">repParSt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883637"><a href="#local-6989586621681883637"><span class="hs-identifier">sss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#parSName"><span class="hs-identifier hs-var">parSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883637"><span class="hs-identifier hs-var">sss</span></a><span class="hs-special">]</span><span>
</span><a name="line-2205"></a><span>
</span><a name="line-2206"></a><span class="hs-identifier">repRecSt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.StmtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2207"></a><a name="repRecSt"><a href="DsMeta.html#repRecSt"><span class="hs-identifier">repRecSt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883638"><a href="#local-6989586621681883638"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recSName"><span class="hs-identifier hs-var">recSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883638"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-2208"></a><span>
</span><a name="line-2209"></a><span class="hs-comment">-------------- Range (Arithmetic sequences) -----------</span><span>
</span><a name="line-2210"></a><span class="hs-identifier">repFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2211"></a><a name="repFrom"><a href="DsMeta.html#repFrom"><span class="hs-identifier">repFrom</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883639"><a href="#local-6989586621681883639"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fromEName"><span class="hs-identifier hs-var">fromEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883639"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-2212"></a><span>
</span><a name="line-2213"></a><span class="hs-identifier">repFromThen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2214"></a><a name="repFromThen"><a href="DsMeta.html#repFromThen"><span class="hs-identifier">repFromThen</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883640"><a href="#local-6989586621681883640"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883641"><a href="#local-6989586621681883641"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fromThenEName"><span class="hs-identifier hs-var">fromThenEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883640"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883641"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2215"></a><span>
</span><a name="line-2216"></a><span class="hs-identifier">repFromTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2217"></a><a name="repFromTo"><a href="DsMeta.html#repFromTo"><span class="hs-identifier">repFromTo</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883642"><a href="#local-6989586621681883642"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883643"><a href="#local-6989586621681883643"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fromToEName"><span class="hs-identifier hs-var">fromToEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883642"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883643"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2218"></a><span>
</span><a name="line-2219"></a><span class="hs-identifier">repFromThenTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2220"></a><a name="repFromThenTo"><a href="DsMeta.html#repFromThenTo"><span class="hs-identifier">repFromThenTo</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883644"><a href="#local-6989586621681883644"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883645"><a href="#local-6989586621681883645"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883646"><a href="#local-6989586621681883646"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#fromThenToEName"><span class="hs-identifier hs-var">fromThenToEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883644"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621681883645"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621681883646"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-2221"></a><span>
</span><a name="line-2222"></a><span class="hs-comment">------------ Match and Clause Tuples -----------</span><span>
</span><a name="line-2223"></a><span class="hs-identifier">repMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.MatchQ</span><span class="hs-special">)</span><span>
</span><a name="line-2224"></a><a name="repMatch"><a href="DsMeta.html#repMatch"><span class="hs-identifier">repMatch</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883647"><a href="#local-6989586621681883647"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883648"><a href="#local-6989586621681883648"><span class="hs-identifier">bod</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883649"><a href="#local-6989586621681883649"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#matchName"><span class="hs-identifier hs-var">matchName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883647"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883648"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883649"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2225"></a><span>
</span><a name="line-2226"></a><span class="hs-identifier">repClause</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PatQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ClauseQ</span><span class="hs-special">)</span><span>
</span><a name="line-2227"></a><a name="repClause"><a href="DsMeta.html#repClause"><span class="hs-identifier">repClause</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883650"><a href="#local-6989586621681883650"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883651"><a href="#local-6989586621681883651"><span class="hs-identifier">bod</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883652"><a href="#local-6989586621681883652"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#clauseName"><span class="hs-identifier hs-var">clauseName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883650"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883651"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883652"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2228"></a><span>
</span><a name="line-2229"></a><span class="hs-comment">-------------- Dec -----------------------------</span><span>
</span><a name="line-2230"></a><span class="hs-identifier">repVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.PatQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.BodyQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2231"></a><a name="repVal"><a href="DsMeta.html#repVal"><span class="hs-identifier">repVal</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883653"><a href="#local-6989586621681883653"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883654"><a href="#local-6989586621681883654"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883655"><a href="#local-6989586621681883655"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#valDName"><span class="hs-identifier hs-var">valDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883653"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883654"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883655"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2232"></a><span>
</span><a name="line-2233"></a><span class="hs-identifier">repFun</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ClauseQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2234"></a><a name="repFun"><a href="DsMeta.html#repFun"><span class="hs-identifier">repFun</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883656"><a href="#local-6989586621681883656"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883657"><a href="#local-6989586621681883657"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#funDName"><span class="hs-identifier hs-var">funDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883656"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883657"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-2235"></a><span>
</span><a name="line-2236"></a><span class="hs-identifier">repData</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-2237"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2238"></a><span>                  </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2239"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.ConQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DerivClauseQ</span><span class="hs-special">]</span><span>
</span><a name="line-2240"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2241"></a><a name="repData"><a href="DsMeta.html#repData"><span class="hs-identifier">repData</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883658"><a href="#local-6989586621681883658"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883659"><a href="#local-6989586621681883659"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883660"><a href="#local-6989586621681883660"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883661"><a href="#local-6989586621681883661"><span class="hs-identifier">ksig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883662"><a href="#local-6989586621681883662"><span class="hs-identifier">cons</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883663"><a href="#local-6989586621681883663"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2242"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#dataDName"><span class="hs-identifier hs-var">dataDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883658"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883659"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883660"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883661"><span class="hs-identifier hs-var">ksig</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883662"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883663"><span class="hs-identifier hs-var">derivs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2243"></a><span class="hs-identifier">repData</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883664"><a href="#local-6989586621681883664"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883665"><a href="#local-6989586621681883665"><span class="hs-identifier">mb_bndrs</span></a></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883666"><a href="#local-6989586621681883666"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883667"><a href="#local-6989586621681883667"><span class="hs-identifier">ksig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883668"><a href="#local-6989586621681883668"><span class="hs-identifier">cons</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2244"></a><span>        </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883669"><a href="#local-6989586621681883669"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2245"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#dataInstDName"><span class="hs-identifier hs-var">dataInstDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883664"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883665"><span class="hs-identifier hs-var">mb_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883666"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883667"><span class="hs-identifier hs-var">ksig</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883668"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883669"><span class="hs-identifier hs-var">derivs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2246"></a><span>
</span><a name="line-2247"></a><span class="hs-identifier">repNewtype</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-2248"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2249"></a><span>                     </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2250"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ConQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DerivClauseQ</span><span class="hs-special">]</span><span>
</span><a name="line-2251"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2252"></a><a name="repNewtype"><a href="DsMeta.html#repNewtype"><span class="hs-identifier">repNewtype</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883670"><a href="#local-6989586621681883670"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883671"><a href="#local-6989586621681883671"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883672"><a href="#local-6989586621681883672"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883673"><a href="#local-6989586621681883673"><span class="hs-identifier">ksig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883674"><a href="#local-6989586621681883674"><span class="hs-identifier">con</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2253"></a><span>           </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883675"><a href="#local-6989586621681883675"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2254"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#newtypeDName"><span class="hs-identifier hs-var">newtypeDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883670"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883671"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883672"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883673"><span class="hs-identifier hs-var">ksig</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883674"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883675"><span class="hs-identifier hs-var">derivs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2255"></a><span class="hs-identifier">repNewtype</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883676"><a href="#local-6989586621681883676"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883677"><a href="#local-6989586621681883677"><span class="hs-identifier">mb_bndrs</span></a></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883678"><a href="#local-6989586621681883678"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883679"><a href="#local-6989586621681883679"><span class="hs-identifier">ksig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883680"><a href="#local-6989586621681883680"><span class="hs-identifier">con</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2256"></a><span>           </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883681"><a href="#local-6989586621681883681"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2257"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#newtypeInstDName"><span class="hs-identifier hs-var">newtypeInstDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883676"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883677"><span class="hs-identifier hs-var">mb_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883678"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883679"><span class="hs-identifier hs-var">ksig</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883680"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883681"><span class="hs-identifier hs-var">derivs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2258"></a><span>
</span><a name="line-2259"></a><span class="hs-identifier">repTySyn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-2260"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2261"></a><a name="repTySyn"><a href="DsMeta.html#repTySyn"><span class="hs-identifier">repTySyn</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883682"><a href="#local-6989586621681883682"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883683"><a href="#local-6989586621681883683"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883684"><a href="#local-6989586621681883684"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2262"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tySynDName"><span class="hs-identifier hs-var">tySynDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883682"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883683"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883684"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2263"></a><span>
</span><a name="line-2264"></a><span class="hs-identifier">repInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.Overlap</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2265"></a><span>           </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2266"></a><a name="repInst"><a href="DsMeta.html#repInst"><span class="hs-identifier">repInst</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883685"><a href="#local-6989586621681883685"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883686"><a href="#local-6989586621681883686"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883687"><a href="#local-6989586621681883687"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883688"><a href="#local-6989586621681883688"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#instanceWithOverlapDName"><span class="hs-identifier hs-var">instanceWithOverlapDName</span></a><span>
</span><a name="line-2267"></a><span>                                                              </span><span class="hs-special">[</span><a href="#local-6989586621681883685"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883686"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883687"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883688"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2268"></a><span>
</span><a name="line-2269"></a><span class="hs-identifier">repDerivStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LDerivStrategy</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2270"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2271"></a><a name="repDerivStrategy"><a href="DsMeta.html#repDerivStrategy"><span class="hs-identifier">repDerivStrategy</span></a></a><span> </span><a name="local-6989586621681883689"><a href="#local-6989586621681883689"><span class="hs-identifier">mds</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2272"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883689"><span class="hs-identifier hs-var">mds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2273"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883690"><span class="hs-identifier hs-var">nothing</span></a><span>
</span><a name="line-2274"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883692"><a href="#local-6989586621681883692"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2275"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883692"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2276"></a><span>        </span><span class="hs-identifier hs-var">StockStrategy</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883691"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#repStockStrategy"><span class="hs-identifier hs-var">repStockStrategy</span></a><span>
</span><a name="line-2277"></a><span>        </span><span class="hs-identifier hs-var">AnyclassStrategy</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883691"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#repAnyclassStrategy"><span class="hs-identifier hs-var">repAnyclassStrategy</span></a><span>
</span><a name="line-2278"></a><span>        </span><span class="hs-identifier hs-var">NewtypeStrategy</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883691"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#repNewtypeStrategy"><span class="hs-identifier hs-var">repNewtypeStrategy</span></a><span>
</span><a name="line-2279"></a><span>        </span><span class="hs-identifier hs-var">ViaStrategy</span><span> </span><a name="local-6989586621681883693"><a href="#local-6989586621681883693"><span class="hs-identifier">ty</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883694"><a href="#local-6989586621681883694"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hsSigType</span><span> </span><a href="#local-6989586621681883693"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2280"></a><span>                               </span><a name="local-6989586621681883695"><a href="#local-6989586621681883695"><span class="hs-identifier">via_strat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repViaStrategy"><span class="hs-identifier hs-var">repViaStrategy</span></a><span> </span><a href="#local-6989586621681883694"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-2281"></a><span>                               </span><a href="#local-6989586621681883691"><span class="hs-identifier hs-var">just</span></a><span> </span><a href="#local-6989586621681883695"><span class="hs-identifier hs-var">via_strat</span></a><span>
</span><a name="line-2282"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2283"></a><span>  </span><a name="local-6989586621681883690"><a href="#local-6989586621681883690"><span class="hs-identifier">nothing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreNothing"><span class="hs-identifier hs-var">coreNothing</span></a><span> </span><a href="THNames.html#derivStrategyQTyConName"><span class="hs-identifier hs-var">derivStrategyQTyConName</span></a><span>
</span><a name="line-2284"></a><span>  </span><a name="local-6989586621681883691"><a href="#local-6989586621681883691"><span class="hs-identifier">just</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreJust"><span class="hs-identifier hs-var">coreJust</span></a><span>    </span><a href="THNames.html#derivStrategyQTyConName"><span class="hs-identifier hs-var">derivStrategyQTyConName</span></a><span>
</span><a name="line-2285"></a><span>
</span><a name="line-2286"></a><span class="hs-identifier">repStockStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2287"></a><a name="repStockStrategy"><a href="DsMeta.html#repStockStrategy"><span class="hs-identifier">repStockStrategy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#stockStrategyName"><span class="hs-identifier hs-var">stockStrategyName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2288"></a><span>
</span><a name="line-2289"></a><span class="hs-identifier">repAnyclassStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2290"></a><a name="repAnyclassStrategy"><a href="DsMeta.html#repAnyclassStrategy"><span class="hs-identifier">repAnyclassStrategy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#anyclassStrategyName"><span class="hs-identifier hs-var">anyclassStrategyName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2291"></a><span>
</span><a name="line-2292"></a><span class="hs-identifier">repNewtypeStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2293"></a><a name="repNewtypeStrategy"><a href="DsMeta.html#repNewtypeStrategy"><span class="hs-identifier">repNewtypeStrategy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#newtypeStrategyName"><span class="hs-identifier hs-var">newtypeStrategyName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2294"></a><span>
</span><a name="line-2295"></a><span class="hs-identifier">repViaStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2296"></a><a name="repViaStrategy"><a href="DsMeta.html#repViaStrategy"><span class="hs-identifier">repViaStrategy</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883696"><a href="#local-6989586621681883696"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#viaStrategyName"><span class="hs-identifier hs-var">viaStrategyName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883696"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-2297"></a><span>
</span><a name="line-2298"></a><span class="hs-identifier">repOverlap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">OverlapMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.Overlap</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2299"></a><a name="repOverlap"><a href="DsMeta.html#repOverlap"><span class="hs-identifier">repOverlap</span></a></a><span> </span><a name="local-6989586621681883697"><a href="#local-6989586621681883697"><span class="hs-identifier">mb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2300"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883697"><span class="hs-identifier hs-var">mb</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2301"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883698"><span class="hs-identifier hs-var">nothing</span></a><span>
</span><a name="line-2302"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883700"><a href="#local-6989586621681883700"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2303"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883700"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2304"></a><span>        </span><span class="hs-identifier hs-var">NoOverlap</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883698"><span class="hs-identifier hs-var">nothing</span></a><span>
</span><a name="line-2305"></a><span>        </span><span class="hs-identifier hs-var">Overlappable</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883699"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#overlappableDataConName"><span class="hs-identifier hs-var">overlappableDataConName</span></a><span>
</span><a name="line-2306"></a><span>        </span><span class="hs-identifier hs-var">Overlapping</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883699"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#overlappingDataConName"><span class="hs-identifier hs-var">overlappingDataConName</span></a><span>
</span><a name="line-2307"></a><span>        </span><span class="hs-identifier hs-var">Overlaps</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883699"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#overlapsDataConName"><span class="hs-identifier hs-var">overlapsDataConName</span></a><span>
</span><a name="line-2308"></a><span>        </span><span class="hs-identifier hs-var">Incoherent</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681883699"><span class="hs-identifier hs-var">just</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="DsMeta.html#dataCon"><span class="hs-identifier hs-var">dataCon</span></a><span> </span><a href="THNames.html#incoherentDataConName"><span class="hs-identifier hs-var">incoherentDataConName</span></a><span>
</span><a name="line-2309"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2310"></a><span>  </span><a name="local-6989586621681883698"><a href="#local-6989586621681883698"><span class="hs-identifier">nothing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreNothing"><span class="hs-identifier hs-var">coreNothing</span></a><span> </span><a href="THNames.html#overlapTyConName"><span class="hs-identifier hs-var">overlapTyConName</span></a><span>
</span><a name="line-2311"></a><span>  </span><a name="local-6989586621681883699"><a href="#local-6989586621681883699"><span class="hs-identifier">just</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreJust"><span class="hs-identifier hs-var">coreJust</span></a><span> </span><a href="THNames.html#overlapTyConName"><span class="hs-identifier hs-var">overlapTyConName</span></a><span>
</span><a name="line-2312"></a><span>
</span><a name="line-2313"></a><span>
</span><a name="line-2314"></a><span class="hs-identifier">repClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-2315"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.FunDep</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">]</span><span>
</span><a name="line-2316"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2317"></a><a name="repClass"><a href="DsMeta.html#repClass"><span class="hs-identifier">repClass</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883701"><a href="#local-6989586621681883701"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883702"><a href="#local-6989586621681883702"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883703"><a href="#local-6989586621681883703"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883704"><a href="#local-6989586621681883704"><span class="hs-identifier">fds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883705"><a href="#local-6989586621681883705"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2318"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#classDName"><span class="hs-identifier hs-var">classDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883701"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883702"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883703"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883704"><span class="hs-identifier hs-var">fds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883705"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-2319"></a><span>
</span><a name="line-2320"></a><span class="hs-identifier">repDeriv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.DerivStrategyQ</span><span class="hs-special">)</span><span>
</span><a name="line-2321"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span>
</span><a name="line-2322"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2323"></a><a name="repDeriv"><a href="DsMeta.html#repDeriv"><span class="hs-identifier">repDeriv</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883706"><a href="#local-6989586621681883706"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883707"><a href="#local-6989586621681883707"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883708"><a href="#local-6989586621681883708"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#standaloneDerivWithStrategyDName"><span class="hs-identifier hs-var">standaloneDerivWithStrategyDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883706"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883707"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883708"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-2325"></a><span>
</span><a name="line-2326"></a><span class="hs-identifier">repPragInl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Inline</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.RuleMatch</span><span>
</span><a name="line-2327"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2328"></a><a name="repPragInl"><a href="DsMeta.html#repPragInl"><span class="hs-identifier">repPragInl</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883709"><a href="#local-6989586621681883709"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883710"><a href="#local-6989586621681883710"><span class="hs-identifier">inline</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883711"><a href="#local-6989586621681883711"><span class="hs-identifier">rm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883712"><a href="#local-6989586621681883712"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2329"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragInlDName"><span class="hs-identifier hs-var">pragInlDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883709"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883710"><span class="hs-identifier hs-var">inline</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883711"><span class="hs-identifier hs-var">rm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883712"><span class="hs-identifier hs-var">phases</span></a><span class="hs-special">]</span><span>
</span><a name="line-2330"></a><span>
</span><a name="line-2331"></a><span class="hs-identifier">repPragSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span>
</span><a name="line-2332"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2333"></a><a name="repPragSpec"><a href="DsMeta.html#repPragSpec"><span class="hs-identifier">repPragSpec</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883713"><a href="#local-6989586621681883713"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883714"><a href="#local-6989586621681883714"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883715"><a href="#local-6989586621681883715"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2334"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragSpecDName"><span class="hs-identifier hs-var">pragSpecDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883713"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883714"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883715"><span class="hs-identifier hs-var">phases</span></a><span class="hs-special">]</span><span>
</span><a name="line-2335"></a><span>
</span><a name="line-2336"></a><span class="hs-identifier">repPragSpecInl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Inline</span><span>
</span><a name="line-2337"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2338"></a><a name="repPragSpecInl"><a href="DsMeta.html#repPragSpecInl"><span class="hs-identifier">repPragSpecInl</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883716"><a href="#local-6989586621681883716"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883717"><a href="#local-6989586621681883717"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883718"><a href="#local-6989586621681883718"><span class="hs-identifier">inline</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883719"><a href="#local-6989586621681883719"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2339"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragSpecInlDName"><span class="hs-identifier hs-var">pragSpecInlDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883716"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883717"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883718"><span class="hs-identifier hs-var">inline</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883719"><span class="hs-identifier hs-var">phases</span></a><span class="hs-special">]</span><span>
</span><a name="line-2340"></a><span>
</span><a name="line-2341"></a><span class="hs-identifier">repPragSpecInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2342"></a><a name="repPragSpecInst"><a href="DsMeta.html#repPragSpecInst"><span class="hs-identifier">repPragSpecInst</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883720"><a href="#local-6989586621681883720"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragSpecInstDName"><span class="hs-identifier hs-var">pragSpecInstDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883720"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-2343"></a><span>
</span><a name="line-2344"></a><span class="hs-identifier">repPragComplete</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2345"></a><a name="repPragComplete"><a href="DsMeta.html#repPragComplete"><span class="hs-identifier">repPragComplete</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883721"><a href="#local-6989586621681883721"><span class="hs-identifier">cls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883722"><a href="#local-6989586621681883722"><span class="hs-identifier">mty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragCompleteDName"><span class="hs-identifier hs-var">pragCompleteDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883721"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883722"><span class="hs-identifier hs-var">mty</span></a><span class="hs-special">]</span><span>
</span><a name="line-2346"></a><span>
</span><a name="line-2347"></a><span class="hs-identifier">repPragRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2348"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.RuleBndrQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span>
</span><a name="line-2349"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Phases</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2350"></a><a name="repPragRule"><a href="DsMeta.html#repPragRule"><span class="hs-identifier">repPragRule</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883723"><a href="#local-6989586621681883723"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883724"><a href="#local-6989586621681883724"><span class="hs-identifier">ty_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883725"><a href="#local-6989586621681883725"><span class="hs-identifier">tm_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883726"><a href="#local-6989586621681883726"><span class="hs-identifier">lhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883727"><a href="#local-6989586621681883727"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883728"><a href="#local-6989586621681883728"><span class="hs-identifier">phases</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2351"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragRuleDName"><span class="hs-identifier hs-var">pragRuleDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883723"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883724"><span class="hs-identifier hs-var">ty_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883725"><span class="hs-identifier hs-var">tm_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883726"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883727"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883728"><span class="hs-identifier hs-var">phases</span></a><span class="hs-special">]</span><span>
</span><a name="line-2352"></a><span>
</span><a name="line-2353"></a><span class="hs-identifier">repPragAnn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.AnnTarget</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2354"></a><a name="repPragAnn"><a href="DsMeta.html#repPragAnn"><span class="hs-identifier">repPragAnn</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883729"><a href="#local-6989586621681883729"><span class="hs-identifier">targ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883730"><a href="#local-6989586621681883730"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#pragAnnDName"><span class="hs-identifier hs-var">pragAnnDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883729"><span class="hs-identifier hs-var">targ</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883730"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2355"></a><span>
</span><a name="line-2356"></a><span class="hs-identifier">repTySynInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TySynEqnQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2357"></a><a name="repTySynInst"><a href="DsMeta.html#repTySynInst"><span class="hs-identifier">repTySynInst</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883731"><a href="#local-6989586621681883731"><span class="hs-identifier">eqn</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2358"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tySynInstDName"><span class="hs-identifier hs-var">tySynInstDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883731"><span class="hs-identifier hs-var">eqn</span></a><span class="hs-special">]</span><span>
</span><a name="line-2359"></a><span>
</span><a name="line-2360"></a><span class="hs-identifier">repDataFamilyD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-2361"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2362"></a><a name="repDataFamilyD"><a href="DsMeta.html#repDataFamilyD"><span class="hs-identifier">repDataFamilyD</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883732"><a href="#local-6989586621681883732"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883733"><a href="#local-6989586621681883733"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883734"><a href="#local-6989586621681883734"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2363"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#dataFamilyDName"><span class="hs-identifier hs-var">dataFamilyDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883732"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883733"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883734"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">]</span><span>
</span><a name="line-2364"></a><span>
</span><a name="line-2365"></a><span class="hs-identifier">repOpenFamilyD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-2366"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-2367"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span>
</span><a name="line-2368"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.InjectivityAnn</span><span class="hs-special">)</span><span>
</span><a name="line-2369"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2370"></a><a name="repOpenFamilyD"><a href="DsMeta.html#repOpenFamilyD"><span class="hs-identifier">repOpenFamilyD</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883735"><a href="#local-6989586621681883735"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883736"><a href="#local-6989586621681883736"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883737"><a href="#local-6989586621681883737"><span class="hs-identifier">result</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883738"><a href="#local-6989586621681883738"><span class="hs-identifier">inj</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2371"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#openTypeFamilyDName"><span class="hs-identifier hs-var">openTypeFamilyDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883735"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883736"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883737"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883738"><span class="hs-identifier hs-var">inj</span></a><span class="hs-special">]</span><span>
</span><a name="line-2372"></a><span>
</span><a name="line-2373"></a><span class="hs-identifier">repClosedFamilyD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>
</span><a name="line-2374"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span>
</span><a name="line-2375"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span>
</span><a name="line-2376"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">TH.InjectivityAnn</span><span class="hs-special">)</span><span>
</span><a name="line-2377"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TySynEqnQ</span><span class="hs-special">]</span><span>
</span><a name="line-2378"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2379"></a><a name="repClosedFamilyD"><a href="DsMeta.html#repClosedFamilyD"><span class="hs-identifier">repClosedFamilyD</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883739"><a href="#local-6989586621681883739"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883740"><a href="#local-6989586621681883740"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883741"><a href="#local-6989586621681883741"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883742"><a href="#local-6989586621681883742"><span class="hs-identifier">inj</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883743"><a href="#local-6989586621681883743"><span class="hs-identifier">eqns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2380"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#closedTypeFamilyDName"><span class="hs-identifier hs-var">closedTypeFamilyDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883739"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883740"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883741"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883742"><span class="hs-identifier hs-var">inj</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883743"><span class="hs-identifier hs-var">eqns</span></a><span class="hs-special">]</span><span>
</span><a name="line-2381"></a><span>
</span><a name="line-2382"></a><span class="hs-identifier">repTySynEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2383"></a><span>               </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TySynEqnQ</span><span class="hs-special">)</span><span>
</span><a name="line-2384"></a><a name="repTySynEqn"><a href="DsMeta.html#repTySynEqn"><span class="hs-identifier">repTySynEqn</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883744"><a href="#local-6989586621681883744"><span class="hs-identifier">mb_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883745"><a href="#local-6989586621681883745"><span class="hs-identifier">lhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883746"><a href="#local-6989586621681883746"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2385"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tySynEqnName"><span class="hs-identifier hs-var">tySynEqnName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883744"><span class="hs-identifier hs-var">mb_bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883745"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883746"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2386"></a><span>
</span><a name="line-2387"></a><span class="hs-identifier">repRoleAnnotD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Role</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2388"></a><a name="repRoleAnnotD"><a href="DsMeta.html#repRoleAnnotD"><span class="hs-identifier">repRoleAnnotD</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883747"><a href="#local-6989586621681883747"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883748"><a href="#local-6989586621681883748"><span class="hs-identifier">roles</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#roleAnnotDName"><span class="hs-identifier hs-var">roleAnnotDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883747"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883748"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">]</span><span>
</span><a name="line-2389"></a><span>
</span><a name="line-2390"></a><span class="hs-identifier">repFunDep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FunDep</span><span class="hs-special">)</span><span>
</span><a name="line-2391"></a><a name="repFunDep"><a href="DsMeta.html#repFunDep"><span class="hs-identifier">repFunDep</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883749"><a href="#local-6989586621681883749"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883750"><a href="#local-6989586621681883750"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#funDepName"><span class="hs-identifier hs-var">funDepName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883749"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883750"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">]</span><span>
</span><a name="line-2392"></a><span>
</span><a name="line-2393"></a><span class="hs-identifier">repProto</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2394"></a><a name="repProto"><a href="DsMeta.html#repProto"><span class="hs-identifier">repProto</span></a></a><span> </span><a name="local-6989586621681883751"><a href="#local-6989586621681883751"><span class="hs-identifier">mk_sig</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883752"><a href="#local-6989586621681883752"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883753"><a href="#local-6989586621681883753"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="#local-6989586621681883751"><span class="hs-identifier hs-var">mk_sig</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883752"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883753"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-2395"></a><span>
</span><a name="line-2396"></a><span class="hs-identifier">repImplicitParamBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.DecQ</span><span class="hs-special">)</span><span>
</span><a name="line-2397"></a><a name="repImplicitParamBind"><a href="DsMeta.html#repImplicitParamBind"><span class="hs-identifier">repImplicitParamBind</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883754"><a href="#local-6989586621681883754"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883755"><a href="#local-6989586621681883755"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#implicitParamBindDName"><span class="hs-identifier hs-var">implicitParamBindDName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883754"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883755"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2398"></a><span>
</span><a name="line-2399"></a><span class="hs-identifier">repCtxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.PredQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span class="hs-special">)</span><span>
</span><a name="line-2400"></a><a name="repCtxt"><a href="DsMeta.html#repCtxt"><span class="hs-identifier">repCtxt</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883756"><a href="#local-6989586621681883756"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#cxtName"><span class="hs-identifier hs-var">cxtName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883756"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">]</span><span>
</span><a name="line-2401"></a><span>
</span><a name="line-2402"></a><span class="hs-identifier">repDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-2403"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsConDeclDetails</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-2404"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ConQ</span><span class="hs-special">)</span><span>
</span><a name="line-2405"></a><a name="repDataCon"><a href="DsMeta.html#repDataCon"><span class="hs-identifier">repDataCon</span></a></a><span> </span><a name="local-6989586621681883757"><a href="#local-6989586621681883757"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621681883758"><a href="#local-6989586621681883758"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-2406"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883759"><a href="#local-6989586621681883759"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883757"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-comment">-- See Note [Binders and occurrences]</span><span>
</span><a name="line-2407"></a><span>         </span><a href="DsMeta.html#repConstr"><span class="hs-identifier hs-var">repConstr</span></a><span> </span><a href="#local-6989586621681883758"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883759"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-2408"></a><span>
</span><a name="line-2409"></a><span class="hs-identifier">repGadtDataCons</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-2410"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HsConDeclDetails</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-2411"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-2412"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ConQ</span><span class="hs-special">)</span><span>
</span><a name="line-2413"></a><a name="repGadtDataCons"><a href="DsMeta.html#repGadtDataCons"><span class="hs-identifier">repGadtDataCons</span></a></a><span> </span><a name="local-6989586621681883760"><a href="#local-6989586621681883760"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621681883761"><a href="#local-6989586621681883761"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621681883762"><a href="#local-6989586621681883762"><span class="hs-identifier">res_ty</span></a></a><span>
</span><a name="line-2414"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883763"><a href="#local-6989586621681883763"><span class="hs-identifier">cons'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="DsMeta.html#lookupLOcc"><span class="hs-identifier hs-var">lookupLOcc</span></a><span> </span><a href="#local-6989586621681883760"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-comment">-- See Note [Binders and occurrences]</span><span>
</span><a name="line-2415"></a><span>         </span><a href="DsMeta.html#repConstr"><span class="hs-identifier hs-var">repConstr</span></a><span> </span><a href="#local-6989586621681883761"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681883762"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883763"><span class="hs-identifier hs-var">cons'</span></a><span>
</span><a name="line-2416"></a><span>
</span><a name="line-2417"></a><span class="hs-comment">-- Invariant:</span><span>
</span><a name="line-2418"></a><span class="hs-comment">--   * for plain H98 data constructors second argument is Nothing and third</span><span>
</span><a name="line-2419"></a><span class="hs-comment">--     argument is a singleton list</span><span>
</span><a name="line-2420"></a><span class="hs-comment">--   * for GADTs data constructors second argument is (Just return_type) and</span><span>
</span><a name="line-2421"></a><span class="hs-comment">--     third argument is a non-empty list</span><span>
</span><a name="line-2422"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsConDeclDetails</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-2423"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2424"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">]</span><span>
</span><a name="line-2425"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ConQ</span><span class="hs-special">)</span><span>
</span><a name="line-2426"></a><a name="repConstr"><a href="DsMeta.html#repConstr"><span class="hs-identifier">repConstr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621681883764"><a href="#local-6989586621681883764"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681883765"><a href="#local-6989586621681883765"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-2427"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883766"><a href="#local-6989586621681883766"><span class="hs-identifier">arg_tys</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#bangTypeQTyConName"><span class="hs-identifier hs-var">bangTypeQTyConName</span></a><span> </span><a href="DsMeta.html#repBangTy"><span class="hs-identifier hs-var">repBangTy</span></a><span> </span><a href="#local-6989586621681883764"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-2428"></a><span>         </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#normalCName"><span class="hs-identifier hs-var">normalCName</span></a><span> </span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883765"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883766"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">]</span><span>
</span><a name="line-2429"></a><span>
</span><a name="line-2430"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621681883767"><a href="#local-6989586621681883767"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883768"><a href="#local-6989586621681883768"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883769"><a href="#local-6989586621681883769"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-2431"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883770"><a href="#local-6989586621681883770"><span class="hs-identifier">arg_tys</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repList"><span class="hs-identifier hs-var">repList</span></a><span> </span><a href="THNames.html#bangTypeQTyConName"><span class="hs-identifier hs-var">bangTypeQTyConName</span></a><span> </span><a href="DsMeta.html#repBangTy"><span class="hs-identifier hs-var">repBangTy</span></a><span> </span><a href="#local-6989586621681883767"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-2432"></a><span>         </span><a name="local-6989586621681883771"><a href="#local-6989586621681883771"><span class="hs-identifier">res_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883768"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-2433"></a><span>         </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#gadtCName"><span class="hs-identifier hs-var">gadtCName</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883769"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883770"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883771"><span class="hs-identifier hs-var">res_ty'</span></a><span class="hs-special">]</span><span>
</span><a name="line-2434"></a><span>
</span><a name="line-2435"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621681883772"><a href="#local-6989586621681883772"><span class="hs-identifier">ips</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681883773"><a href="#local-6989586621681883773"><span class="hs-identifier">resTy</span></a></a><span> </span><a name="local-6989586621681883774"><a href="#local-6989586621681883774"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-2436"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883783"><a href="#local-6989586621681883783"><span class="hs-identifier">args</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><a href="#local-6989586621681883775"><span class="hs-identifier hs-var">rep_ip</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883772"><span class="hs-identifier hs-var">ips</span></a><span class="hs-special">)</span><span>
</span><a name="line-2437"></a><span>         </span><a name="local-6989586621681883784"><a href="#local-6989586621681883784"><span class="hs-identifier">arg_vtys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="THNames.html#varBangTypeQTyConName"><span class="hs-identifier hs-var">varBangTypeQTyConName</span></a><span> </span><a href="#local-6989586621681883783"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2438"></a><span>         </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883773"><span class="hs-identifier hs-var">resTy</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2439"></a><span>           </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recCName"><span class="hs-identifier hs-var">recCName</span></a><span> </span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621681883774"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883784"><span class="hs-identifier hs-var">arg_vtys</span></a><span class="hs-special">]</span><span>
</span><a name="line-2440"></a><span>           </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883785"><a href="#local-6989586621681883785"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2441"></a><span>             </span><a name="local-6989586621681883786"><a href="#local-6989586621681883786"><span class="hs-identifier">res_ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repLTy"><span class="hs-identifier hs-var">repLTy</span></a><span> </span><a href="#local-6989586621681883785"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-2442"></a><span>             </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#recGadtCName"><span class="hs-identifier hs-var">recGadtCName</span></a><span> </span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier hs-var">nonEmptyCoreList</span></a><span> </span><a href="#local-6989586621681883774"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883784"><span class="hs-identifier hs-var">arg_vtys</span></a><span class="hs-special">,</span><span>
</span><a name="line-2443"></a><span>                                </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883786"><span class="hs-identifier hs-var">res_ty'</span></a><span class="hs-special">]</span><span>
</span><a name="line-2444"></a><span>
</span><a name="line-2445"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2446"></a><span>      </span><a name="local-6989586621681883775"><a href="#local-6989586621681883775"><span class="hs-identifier">rep_ip</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883778"><a href="#local-6989586621681883778"><span class="hs-identifier">ip</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681883776"><span class="hs-identifier hs-var">rep_one_ip</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_type</span><span> </span><a href="#local-6989586621681883778"><span class="hs-identifier hs-var">ip</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_names</span><span> </span><a href="#local-6989586621681883778"><span class="hs-identifier hs-var">ip</span></a><span class="hs-special">)</span><span>
</span><a name="line-2447"></a><span>
</span><a name="line-2448"></a><span>      </span><span class="hs-identifier">rep_one_ip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LBangType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LFieldOcc</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681883777"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2449"></a><span>      </span><a name="local-6989586621681883776"><a href="#local-6989586621681883776"><span class="hs-identifier">rep_one_ip</span></a></a><span> </span><a name="local-6989586621681883779"><a href="#local-6989586621681883779"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621681883780"><a href="#local-6989586621681883780"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883781"><a href="#local-6989586621681883781"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupOcc"><span class="hs-identifier hs-var">lookupOcc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">extFieldOcc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621681883780"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2450"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883782"><a href="#local-6989586621681883782"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBangTy"><span class="hs-identifier hs-var">repBangTy</span></a><span>  </span><a href="#local-6989586621681883779"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-2451"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#varBangTypeName"><span class="hs-identifier hs-var">varBangTypeName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883781"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><a href="#local-6989586621681883782"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2452"></a><span>
</span><a name="line-2453"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621681883787"><a href="#local-6989586621681883787"><span class="hs-identifier">st1</span></a></a><span> </span><a name="local-6989586621681883788"><a href="#local-6989586621681883788"><span class="hs-identifier">st2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681883789"><a href="#local-6989586621681883789"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-2454"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883790"><a href="#local-6989586621681883790"><span class="hs-identifier">arg1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBangTy"><span class="hs-identifier hs-var">repBangTy</span></a><span> </span><a href="#local-6989586621681883787"><span class="hs-identifier hs-var">st1</span></a><span>
</span><a name="line-2455"></a><span>         </span><a name="local-6989586621681883791"><a href="#local-6989586621681883791"><span class="hs-identifier">arg2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repBangTy"><span class="hs-identifier hs-var">repBangTy</span></a><span> </span><a href="#local-6989586621681883788"><span class="hs-identifier hs-var">st2</span></a><span>
</span><a name="line-2456"></a><span>         </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#infixCName"><span class="hs-identifier hs-var">infixCName</span></a><span> </span><span class="hs-special">[</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883790"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883789"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883791"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2457"></a><span>
</span><a name="line-2458"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2459"></a><span>    </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repConstr: infix GADT constructor should be in a PrefixCon&quot;</span><span>
</span><a name="line-2460"></a><span class="hs-identifier">repConstr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2461"></a><span>    </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repConstr: invariant violated&quot;</span><span>
</span><a name="line-2462"></a><span>
</span><a name="line-2463"></a><span class="hs-comment">------------ Types -------------------</span><span>
</span><a name="line-2464"></a><span>
</span><a name="line-2465"></a><span class="hs-identifier">repTForall</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.CxtQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span>
</span><a name="line-2466"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2467"></a><a name="repTForall"><a href="DsMeta.html#repTForall"><span class="hs-identifier">repTForall</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883792"><a href="#local-6989586621681883792"><span class="hs-identifier">tvars</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883793"><a href="#local-6989586621681883793"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883794"><a href="#local-6989586621681883794"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2468"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#forallTName"><span class="hs-identifier hs-var">forallTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883792"><span class="hs-identifier hs-var">tvars</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883793"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883794"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-2469"></a><span>
</span><a name="line-2470"></a><span class="hs-identifier">repTvar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2471"></a><a name="repTvar"><a href="DsMeta.html#repTvar"><span class="hs-identifier">repTvar</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883795"><a href="#local-6989586621681883795"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#varTName"><span class="hs-identifier hs-var">varTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883795"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2472"></a><span>
</span><a name="line-2473"></a><span class="hs-identifier">repTapp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2474"></a><a name="repTapp"><a href="DsMeta.html#repTapp"><span class="hs-identifier">repTapp</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883796"><a href="#local-6989586621681883796"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883797"><a href="#local-6989586621681883797"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#appTName"><span class="hs-identifier hs-var">appTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883796"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883797"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2475"></a><span>
</span><a name="line-2476"></a><span class="hs-identifier">repTappKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2477"></a><a name="repTappKind"><a href="DsMeta.html#repTappKind"><span class="hs-identifier">repTappKind</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883798"><a href="#local-6989586621681883798"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883799"><a href="#local-6989586621681883799"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#appKindTName"><span class="hs-identifier hs-var">appKindTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883798"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><a href="#local-6989586621681883799"><span class="hs-identifier hs-var">ki</span></a><span class="hs-special">]</span><span>
</span><a name="line-2478"></a><span>
</span><a name="line-2479"></a><span class="hs-identifier">repTapps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2480"></a><a name="repTapps"><a href="DsMeta.html#repTapps"><span class="hs-identifier">repTapps</span></a></a><span> </span><a name="local-6989586621681883800"><a href="#local-6989586621681883800"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681883800"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-2481"></a><span class="hs-identifier">repTapps</span><span> </span><a name="local-6989586621681883801"><a href="#local-6989586621681883801"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621681883802"><a href="#local-6989586621681883802"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621681883803"><a href="#local-6989586621681883803"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883804"><a href="#local-6989586621681883804"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681883801"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681883802"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTapps"><span class="hs-identifier hs-var">repTapps</span></a><span> </span><a href="#local-6989586621681883804"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621681883803"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2482"></a><span>
</span><a name="line-2483"></a><span class="hs-identifier">repTSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2484"></a><a name="repTSig"><a href="DsMeta.html#repTSig"><span class="hs-identifier">repTSig</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883805"><a href="#local-6989586621681883805"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883806"><a href="#local-6989586621681883806"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sigTName"><span class="hs-identifier hs-var">sigTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883805"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883806"><span class="hs-identifier hs-var">ki</span></a><span class="hs-special">]</span><span>
</span><a name="line-2485"></a><span>
</span><a name="line-2486"></a><span class="hs-identifier">repTequality</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2487"></a><a name="repTequality"><a href="DsMeta.html#repTequality"><span class="hs-identifier">repTequality</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#equalityTName"><span class="hs-identifier hs-var">equalityTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2488"></a><span>
</span><a name="line-2489"></a><span class="hs-identifier">repTPromotedList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2490"></a><a name="repTPromotedList"><a href="DsMeta.html#repTPromotedList"><span class="hs-identifier">repTPromotedList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#repPromotedNilTyCon"><span class="hs-identifier hs-var">repPromotedNilTyCon</span></a><span>
</span><a name="line-2491"></a><span class="hs-identifier">repTPromotedList</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681883807"><a href="#local-6989586621681883807"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621681883808"><a href="#local-6989586621681883808"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883809"><a href="#local-6989586621681883809"><span class="hs-identifier">tcon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repPromotedConsTyCon"><span class="hs-identifier hs-var">repPromotedConsTyCon</span></a><span>
</span><a name="line-2492"></a><span>                              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883810"><a href="#local-6989586621681883810"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681883809"><span class="hs-identifier hs-var">tcon</span></a><span> </span><a href="#local-6989586621681883807"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-2493"></a><span>                              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883811"><a href="#local-6989586621681883811"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#repTPromotedList"><span class="hs-identifier hs-var">repTPromotedList</span></a><span> </span><a href="#local-6989586621681883808"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-2494"></a><span>                              </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repTapp"><span class="hs-identifier hs-var">repTapp</span></a><span> </span><a href="#local-6989586621681883810"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681883811"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-2495"></a><span>                              </span><span class="hs-special">}</span><span>
</span><a name="line-2496"></a><span>
</span><a name="line-2497"></a><span class="hs-identifier">repTLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyLitQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2498"></a><a name="repTLit"><a href="DsMeta.html#repTLit"><span class="hs-identifier">repTLit</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883812"><a href="#local-6989586621681883812"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#litTName"><span class="hs-identifier hs-var">litTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883812"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">]</span><span>
</span><a name="line-2499"></a><span>
</span><a name="line-2500"></a><span class="hs-identifier">repTWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2501"></a><a name="repTWildCard"><a href="DsMeta.html#repTWildCard"><span class="hs-identifier">repTWildCard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#wildCardTName"><span class="hs-identifier hs-var">wildCardTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2502"></a><span>
</span><a name="line-2503"></a><span class="hs-identifier">repTImplicitParam</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2504"></a><a name="repTImplicitParam"><a href="DsMeta.html#repTImplicitParam"><span class="hs-identifier">repTImplicitParam</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883813"><a href="#local-6989586621681883813"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883814"><a href="#local-6989586621681883814"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#implicitParamTName"><span class="hs-identifier hs-var">implicitParamTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883813"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883814"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-2505"></a><span>
</span><a name="line-2506"></a><span class="hs-identifier">repTStar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2507"></a><a name="repTStar"><a href="DsMeta.html#repTStar"><span class="hs-identifier">repTStar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#starKName"><span class="hs-identifier hs-var">starKName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2508"></a><span>
</span><a name="line-2509"></a><span class="hs-identifier">repTConstraint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2510"></a><a name="repTConstraint"><a href="DsMeta.html#repTConstraint"><span class="hs-identifier">repTConstraint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#constraintKName"><span class="hs-identifier hs-var">constraintKName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2511"></a><span>
</span><a name="line-2512"></a><span class="hs-comment">--------- Type constructors --------------</span><span>
</span><a name="line-2513"></a><span>
</span><a name="line-2514"></a><span class="hs-identifier">repNamedTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2515"></a><a name="repNamedTyCon"><a href="DsMeta.html#repNamedTyCon"><span class="hs-identifier">repNamedTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883815"><a href="#local-6989586621681883815"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#conTName"><span class="hs-identifier hs-var">conTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883815"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2516"></a><span>
</span><a name="line-2517"></a><span class="hs-identifier">repTInfix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span>
</span><a name="line-2518"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2519"></a><a name="repTInfix"><a href="DsMeta.html#repTInfix"><span class="hs-identifier">repTInfix</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883816"><a href="#local-6989586621681883816"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883817"><a href="#local-6989586621681883817"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883818"><a href="#local-6989586621681883818"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#infixTName"><span class="hs-identifier hs-var">infixTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883816"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-6989586621681883817"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><a href="#local-6989586621681883818"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-2520"></a><span>
</span><a name="line-2521"></a><span class="hs-identifier">repTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2522"></a><span class="hs-comment">-- Note: not Core Int; it's easier to be direct here</span><span>
</span><a name="line-2523"></a><a name="repTupleTyCon"><a href="DsMeta.html#repTupleTyCon"><span class="hs-identifier">repTupleTyCon</span></a></a><span> </span><a name="local-6989586621681883819"><a href="#local-6989586621681883819"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883820"><a href="#local-6989586621681883820"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2524"></a><span>                     </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tupleTName"><span class="hs-identifier hs-var">tupleTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883820"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883819"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-2525"></a><span>
</span><a name="line-2526"></a><span class="hs-identifier">repUnboxedTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2527"></a><span class="hs-comment">-- Note: not Core Int; it's easier to be direct here</span><span>
</span><a name="line-2528"></a><a name="repUnboxedTupleTyCon"><a href="DsMeta.html#repUnboxedTupleTyCon"><span class="hs-identifier">repUnboxedTupleTyCon</span></a></a><span> </span><a name="local-6989586621681883821"><a href="#local-6989586621681883821"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883822"><a href="#local-6989586621681883822"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2529"></a><span>                            </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedTupleTName"><span class="hs-identifier hs-var">unboxedTupleTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883822"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883821"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-2530"></a><span>
</span><a name="line-2531"></a><span class="hs-identifier">repUnboxedSumTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TH.SumArity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2532"></a><span class="hs-comment">-- Note: not Core TH.SumArity; it's easier to be direct here</span><span>
</span><a name="line-2533"></a><a name="repUnboxedSumTyCon"><a href="DsMeta.html#repUnboxedSumTyCon"><span class="hs-identifier">repUnboxedSumTyCon</span></a></a><span> </span><a name="local-6989586621681883823"><a href="#local-6989586621681883823"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883824"><a href="#local-6989586621681883824"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2534"></a><span>                              </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboxedSumTName"><span class="hs-identifier hs-var">unboxedSumTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883824"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883823"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">]</span><span>
</span><a name="line-2535"></a><span>
</span><a name="line-2536"></a><span class="hs-identifier">repArrowTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2537"></a><a name="repArrowTyCon"><a href="DsMeta.html#repArrowTyCon"><span class="hs-identifier">repArrowTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#arrowTName"><span class="hs-identifier hs-var">arrowTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2538"></a><span>
</span><a name="line-2539"></a><span class="hs-identifier">repListTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2540"></a><a name="repListTyCon"><a href="DsMeta.html#repListTyCon"><span class="hs-identifier">repListTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#listTName"><span class="hs-identifier hs-var">listTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2541"></a><span>
</span><a name="line-2542"></a><span class="hs-identifier">repPromotedDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2543"></a><a name="repPromotedDataCon"><a href="DsMeta.html#repPromotedDataCon"><span class="hs-identifier">repPromotedDataCon</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883825"><a href="#local-6989586621681883825"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#promotedTName"><span class="hs-identifier hs-var">promotedTName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883825"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2544"></a><span>
</span><a name="line-2545"></a><span class="hs-identifier">repPromotedTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2546"></a><a name="repPromotedTupleTyCon"><a href="DsMeta.html#repPromotedTupleTyCon"><span class="hs-identifier">repPromotedTupleTyCon</span></a></a><span> </span><a name="local-6989586621681883826"><a href="#local-6989586621681883826"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883827"><a href="#local-6989586621681883827"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2547"></a><span>                             </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#promotedTupleTName"><span class="hs-identifier hs-var">promotedTupleTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883827"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883826"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-2548"></a><span>
</span><a name="line-2549"></a><span class="hs-identifier">repPromotedNilTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2550"></a><a name="repPromotedNilTyCon"><a href="DsMeta.html#repPromotedNilTyCon"><span class="hs-identifier">repPromotedNilTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#promotedNilTName"><span class="hs-identifier hs-var">promotedNilTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2551"></a><span>
</span><a name="line-2552"></a><span class="hs-identifier">repPromotedConsTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TypeQ</span><span class="hs-special">)</span><span>
</span><a name="line-2553"></a><a name="repPromotedConsTyCon"><a href="DsMeta.html#repPromotedConsTyCon"><span class="hs-identifier">repPromotedConsTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#promotedConsTName"><span class="hs-identifier hs-var">promotedConsTName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2554"></a><span>
</span><a name="line-2555"></a><span class="hs-comment">------------ TyVarBndrs -------------------</span><span>
</span><a name="line-2556"></a><span>
</span><a name="line-2557"></a><span class="hs-identifier">repPlainTV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-2558"></a><a name="repPlainTV"><a href="DsMeta.html#repPlainTV"><span class="hs-identifier">repPlainTV</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883828"><a href="#local-6989586621681883828"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#plainTVName"><span class="hs-identifier hs-var">plainTVName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883828"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">]</span><span>
</span><a name="line-2559"></a><span>
</span><a name="line-2560"></a><span class="hs-identifier">repKindedTV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span class="hs-special">)</span><span>
</span><a name="line-2561"></a><a name="repKindedTV"><a href="DsMeta.html#repKindedTV"><span class="hs-identifier">repKindedTV</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883829"><a href="#local-6989586621681883829"><span class="hs-identifier">nm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883830"><a href="#local-6989586621681883830"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#kindedTVName"><span class="hs-identifier hs-var">kindedTVName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883829"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883830"><span class="hs-identifier hs-var">ki</span></a><span class="hs-special">]</span><span>
</span><a name="line-2562"></a><span>
</span><a name="line-2563"></a><span class="hs-comment">----------------------------------------------------------</span><span>
</span><a name="line-2564"></a><span class="hs-comment">--       Type family result signature</span><span>
</span><a name="line-2565"></a><span>
</span><a name="line-2566"></a><span class="hs-identifier">repNoSig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span class="hs-special">)</span><span>
</span><a name="line-2567"></a><a name="repNoSig"><a href="DsMeta.html#repNoSig"><span class="hs-identifier">repNoSig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#noSigName"><span class="hs-identifier hs-var">noSigName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2568"></a><span>
</span><a name="line-2569"></a><span class="hs-identifier">repKindSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.KindQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span class="hs-special">)</span><span>
</span><a name="line-2570"></a><a name="repKindSig"><a href="DsMeta.html#repKindSig"><span class="hs-identifier">repKindSig</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883831"><a href="#local-6989586621681883831"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#kindSigName"><span class="hs-identifier hs-var">kindSigName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883831"><span class="hs-identifier hs-var">ki</span></a><span class="hs-special">]</span><span>
</span><a name="line-2571"></a><span>
</span><a name="line-2572"></a><span class="hs-identifier">repTyVarSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.TyVarBndrQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.FamilyResultSigQ</span><span class="hs-special">)</span><span>
</span><a name="line-2573"></a><a name="repTyVarSig"><a href="DsMeta.html#repTyVarSig"><span class="hs-identifier">repTyVarSig</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883832"><a href="#local-6989586621681883832"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#tyVarSigName"><span class="hs-identifier hs-var">tyVarSigName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883832"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">]</span><span>
</span><a name="line-2574"></a><span>
</span><a name="line-2575"></a><span class="hs-comment">----------------------------------------------------------</span><span>
</span><a name="line-2576"></a><span class="hs-comment">--              Literals</span><span>
</span><a name="line-2577"></a><span>
</span><a name="line-2578"></a><span class="hs-identifier">repLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Lit</span><span class="hs-special">)</span><span>
</span><a name="line-2579"></a><a name="repLiteral"><a href="DsMeta.html#repLiteral"><span class="hs-identifier">repLiteral</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsStringPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883833"><a href="#local-6989586621681883833"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2580"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883834"><a href="#local-6989586621681883834"><span class="hs-identifier">dflags</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2581"></a><span>       </span><a name="local-6989586621681883835"><a href="#local-6989586621681883835"><span class="hs-identifier">word8_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><span class="hs-identifier hs-var">word8TyConName</span><span>
</span><a name="line-2582"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681883836"><a href="#local-6989586621681883836"><span class="hs-identifier">w8s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621681883833"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-2583"></a><span>           </span><a name="local-6989586621681883837"><a href="#local-6989586621681883837"><span class="hs-identifier">w8s_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621681883838"><a href="#local-6989586621681883838"><span class="hs-identifier">w8</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkCoreConApps</span><span> </span><span class="hs-identifier hs-var">word8DataCon</span><span>
</span><a name="line-2584"></a><span>                                  </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkWordLit</span><span> </span><a href="#local-6989586621681883834"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621681883838"><span class="hs-identifier hs-var">w8</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883836"><span class="hs-identifier hs-var">w8s</span></a><span>
</span><a name="line-2585"></a><span>       </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#stringPrimLName"><span class="hs-identifier hs-var">stringPrimLName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">mkListExpr</span><span> </span><a href="#local-6989586621681883835"><span class="hs-identifier hs-var">word8_ty</span></a><span> </span><a href="#local-6989586621681883837"><span class="hs-identifier hs-var">w8s_expr</span></a><span class="hs-special">]</span><span>
</span><a name="line-2586"></a><span class="hs-identifier">repLiteral</span><span> </span><a name="local-6989586621681883839"><a href="#local-6989586621681883839"><span class="hs-identifier">lit</span></a></a><span>
</span><a name="line-2587"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883847"><a href="#local-6989586621681883847"><span class="hs-identifier">lit'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883839"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2588"></a><span>                   </span><span class="hs-identifier hs-var">HsIntPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883841"><a href="#local-6989586621681883841"><span class="hs-identifier">i</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_integer"><span class="hs-identifier hs-var">mk_integer</span></a><span> </span><a href="#local-6989586621681883841"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-2589"></a><span>                   </span><span class="hs-identifier hs-var">HsWordPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883842"><a href="#local-6989586621681883842"><span class="hs-identifier">w</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_integer"><span class="hs-identifier hs-var">mk_integer</span></a><span> </span><a href="#local-6989586621681883842"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-2590"></a><span>                   </span><span class="hs-identifier hs-var">HsInt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883843"><a href="#local-6989586621681883843"><span class="hs-identifier">i</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_integer"><span class="hs-identifier hs-var">mk_integer</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">il_value</span><span> </span><a href="#local-6989586621681883843"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-2591"></a><span>                   </span><span class="hs-identifier hs-var">HsFloatPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883844"><a href="#local-6989586621681883844"><span class="hs-identifier">r</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_rational"><span class="hs-identifier hs-var">mk_rational</span></a><span> </span><a href="#local-6989586621681883844"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-2592"></a><span>                   </span><span class="hs-identifier hs-var">HsDoublePrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883845"><a href="#local-6989586621681883845"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_rational"><span class="hs-identifier hs-var">mk_rational</span></a><span> </span><a href="#local-6989586621681883845"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-2593"></a><span>                   </span><span class="hs-identifier hs-var">HsCharPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883846"><a href="#local-6989586621681883846"><span class="hs-identifier">c</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#mk_char"><span class="hs-identifier hs-var">mk_char</span></a><span> </span><a href="#local-6989586621681883846"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2594"></a><span>                   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681883839"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-2595"></a><span>       </span><a name="local-6989586621681883848"><a href="#local-6989586621681883848"><span class="hs-identifier">lit_expr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MatchLit.html#dsLit"><span class="hs-identifier hs-var">dsLit</span></a><span> </span><a href="#local-6989586621681883847"><span class="hs-identifier hs-var">lit'</span></a><span>
</span><a name="line-2596"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883840"><span class="hs-identifier hs-var">mb_lit_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2597"></a><span>          </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883849"><a href="#local-6989586621681883849"><span class="hs-identifier">lit_name</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="#local-6989586621681883849"><span class="hs-identifier hs-var">lit_name</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883848"><span class="hs-identifier hs-var">lit_expr</span></a><span class="hs-special">]</span><span>
</span><a name="line-2598"></a><span>          </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><span class="hs-string">&quot;Exotic literal&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621681883839"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span>
</span><a name="line-2599"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2600"></a><span>    </span><a name="local-6989586621681883840"><a href="#local-6989586621681883840"><span class="hs-identifier">mb_lit_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681883839"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2601"></a><span>                 </span><span class="hs-identifier hs-var">HsInteger</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#integerLName"><span class="hs-identifier hs-var">integerLName</span></a><span>
</span><a name="line-2602"></a><span>                 </span><span class="hs-identifier hs-var">HsInt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#integerLName"><span class="hs-identifier hs-var">integerLName</span></a><span>
</span><a name="line-2603"></a><span>                 </span><span class="hs-identifier hs-var">HsIntPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#intPrimLName"><span class="hs-identifier hs-var">intPrimLName</span></a><span>
</span><a name="line-2604"></a><span>                 </span><span class="hs-identifier hs-var">HsWordPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#wordPrimLName"><span class="hs-identifier hs-var">wordPrimLName</span></a><span>
</span><a name="line-2605"></a><span>                 </span><span class="hs-identifier hs-var">HsFloatPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#floatPrimLName"><span class="hs-identifier hs-var">floatPrimLName</span></a><span>
</span><a name="line-2606"></a><span>                 </span><span class="hs-identifier hs-var">HsDoublePrim</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#doublePrimLName"><span class="hs-identifier hs-var">doublePrimLName</span></a><span>
</span><a name="line-2607"></a><span>                 </span><span class="hs-identifier hs-var">HsChar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#charLName"><span class="hs-identifier hs-var">charLName</span></a><span>
</span><a name="line-2608"></a><span>                 </span><span class="hs-identifier hs-var">HsCharPrim</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#charPrimLName"><span class="hs-identifier hs-var">charPrimLName</span></a><span>
</span><a name="line-2609"></a><span>                 </span><span class="hs-identifier hs-var">HsString</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#stringLName"><span class="hs-identifier hs-var">stringLName</span></a><span>
</span><a name="line-2610"></a><span>                 </span><span class="hs-identifier hs-var">HsRat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="THNames.html#rationalLName"><span class="hs-identifier hs-var">rationalLName</span></a><span>
</span><a name="line-2611"></a><span>                 </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2612"></a><span>
</span><a name="line-2613"></a><span class="hs-identifier">mk_integer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2614"></a><a name="mk_integer"><a href="DsMeta.html#mk_integer"><span class="hs-identifier">mk_integer</span></a></a><span>  </span><a name="local-6989586621681883850"><a href="#local-6989586621681883850"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883851"><a href="#local-6989586621681883851"><span class="hs-identifier">integer_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><span class="hs-identifier hs-var">integerTyConName</span><span>
</span><a name="line-2615"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsInteger</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621681883850"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621681883851"><span class="hs-identifier hs-var">integer_ty</span></a><span>
</span><a name="line-2616"></a><span>
</span><a name="line-2617"></a><span class="hs-identifier">mk_rational</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FractionalLit</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2618"></a><a name="mk_rational"><a href="DsMeta.html#mk_rational"><span class="hs-identifier">mk_rational</span></a></a><span> </span><a name="local-6989586621681883852"><a href="#local-6989586621681883852"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883853"><a href="#local-6989586621681883853"><span class="hs-identifier">rat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><span class="hs-identifier hs-var">rationalTyConName</span><span>
</span><a name="line-2619"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRat</span><span> </span><span class="hs-identifier hs-var">noExt</span><span> </span><a href="#local-6989586621681883852"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621681883853"><span class="hs-identifier hs-var">rat_ty</span></a><span>
</span><a name="line-2620"></a><span class="hs-identifier">mk_string</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2621"></a><a name="mk_string"><a href="DsMeta.html#mk_string"><span class="hs-identifier">mk_string</span></a></a><span> </span><a name="local-6989586621681883854"><a href="#local-6989586621681883854"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsString</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621681883854"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2622"></a><span>
</span><a name="line-2623"></a><span class="hs-identifier">mk_char</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2624"></a><a name="mk_char"><a href="DsMeta.html#mk_char"><span class="hs-identifier">mk_char</span></a></a><span> </span><a name="local-6989586621681883855"><a href="#local-6989586621681883855"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsChar</span><span> </span><span class="hs-identifier hs-var">NoSourceText</span><span> </span><a href="#local-6989586621681883855"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2625"></a><span>
</span><a name="line-2626"></a><span class="hs-identifier">repOverloadedLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsOverLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Lit</span><span class="hs-special">)</span><span>
</span><a name="line-2627"></a><a name="repOverloadedLiteral"><a href="DsMeta.html#repOverloadedLiteral"><span class="hs-identifier">repOverloadedLiteral</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">OverLit</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ol_val</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681883856"><a href="#local-6989586621681883856"><span class="hs-identifier">val</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2628"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883857"><a href="#local-6989586621681883857"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#mk_lit"><span class="hs-identifier hs-var">mk_lit</span></a><span> </span><a href="#local-6989586621681883856"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">;</span><span> </span><a href="DsMeta.html#repLiteral"><span class="hs-identifier hs-var">repLiteral</span></a><span> </span><a href="#local-6989586621681883857"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2629"></a><span>        </span><span class="hs-comment">-- The type Rational will be in the environment, because</span><span>
</span><a name="line-2630"></a><span>        </span><span class="hs-comment">-- the smart constructor 'TH.Syntax.rationalL' uses it in its type,</span><span>
</span><a name="line-2631"></a><span>        </span><span class="hs-comment">-- and rationalL is sucked in when any TH stuff is used</span><span>
</span><a name="line-2632"></a><span class="hs-identifier">repOverloadedLiteral</span><span> </span><span class="hs-identifier hs-var">XOverLit</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;repOverloadedLiteral&quot;</span><span>
</span><a name="line-2633"></a><span>
</span><a name="line-2634"></a><span class="hs-identifier">mk_lit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">OverLitVal</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLit</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-2635"></a><a name="mk_lit"><a href="DsMeta.html#mk_lit"><span class="hs-identifier">mk_lit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIntegral</span><span> </span><a name="local-6989586621681883858"><a href="#local-6989586621681883858"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#mk_integer"><span class="hs-identifier hs-var">mk_integer</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">il_value</span><span> </span><a href="#local-6989586621681883858"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-2636"></a><span class="hs-identifier">mk_lit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsFractional</span><span> </span><a name="local-6989586621681883859"><a href="#local-6989586621681883859"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#mk_rational"><span class="hs-identifier hs-var">mk_rational</span></a><span> </span><a href="#local-6989586621681883859"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-2637"></a><span class="hs-identifier">mk_lit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIsString</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681883860"><a href="#local-6989586621681883860"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#mk_string"><span class="hs-identifier hs-var">mk_string</span></a><span>   </span><a href="#local-6989586621681883860"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2638"></a><span>
</span><a name="line-2639"></a><span class="hs-identifier">repNameS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span>
</span><a name="line-2640"></a><a name="repNameS"><a href="DsMeta.html#repNameS"><span class="hs-identifier">repNameS</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883861"><a href="#local-6989586621681883861"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#mkNameSName"><span class="hs-identifier hs-var">mkNameSName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883861"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-2641"></a><span>
</span><a name="line-2642"></a><span class="hs-comment">--------------- Miscellaneous -------------------</span><span>
</span><a name="line-2643"></a><span>
</span><a name="line-2644"></a><span class="hs-identifier">repGensym</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-identifier hs-type">TH.Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2645"></a><a name="repGensym"><a href="DsMeta.html#repGensym"><span class="hs-identifier">repGensym</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883862"><a href="#local-6989586621681883862"><span class="hs-identifier">lit_str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#newNameName"><span class="hs-identifier hs-var">newNameName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883862"><span class="hs-identifier hs-var">lit_str</span></a><span class="hs-special">]</span><span>
</span><a name="line-2646"></a><span>
</span><a name="line-2647"></a><span class="hs-identifier">repBindQ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>        </span><span class="hs-comment">-- a and b</span><span>
</span><a name="line-2648"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882467"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681882467"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882468"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882468"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2649"></a><a name="repBindQ"><a href="DsMeta.html#repBindQ"><span class="hs-identifier">repBindQ</span></a></a><span> </span><a name="local-6989586621681883863"><a href="#local-6989586621681883863"><span class="hs-identifier">ty_a</span></a></a><span> </span><a name="local-6989586621681883864"><a href="#local-6989586621681883864"><span class="hs-identifier">ty_b</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883865"><a href="#local-6989586621681883865"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883866"><a href="#local-6989586621681883866"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2650"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#bindQName"><span class="hs-identifier hs-var">bindQName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Type</span><span> </span><a href="#local-6989586621681883863"><span class="hs-identifier hs-var">ty_a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Type</span><span> </span><a href="#local-6989586621681883864"><span class="hs-identifier hs-var">ty_b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883865"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883866"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2651"></a><span>
</span><a name="line-2652"></a><span class="hs-identifier">repSequenceQ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><a href="#local-6989586621681882466"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TH.Q</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681882466"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2653"></a><a name="repSequenceQ"><a href="DsMeta.html#repSequenceQ"><span class="hs-identifier">repSequenceQ</span></a></a><span> </span><a name="local-6989586621681883867"><a href="#local-6989586621681883867"><span class="hs-identifier">ty_a</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883868"><a href="#local-6989586621681883868"><span class="hs-identifier">list</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2654"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#sequenceQName"><span class="hs-identifier hs-var">sequenceQName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Type</span><span> </span><a href="#local-6989586621681883867"><span class="hs-identifier hs-var">ty_a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681883868"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">]</span><span>
</span><a name="line-2655"></a><span>
</span><a name="line-2656"></a><span class="hs-identifier">repUnboundVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2657"></a><a name="repUnboundVar"><a href="DsMeta.html#repUnboundVar"><span class="hs-identifier">repUnboundVar</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883869"><a href="#local-6989586621681883869"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#unboundVarEName"><span class="hs-identifier hs-var">unboundVarEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883869"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span>
</span><a name="line-2658"></a><span>
</span><a name="line-2659"></a><span class="hs-identifier">repOverLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FastString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-2660"></a><a name="repOverLabel"><a href="DsMeta.html#repOverLabel"><span class="hs-identifier">repOverLabel</span></a></a><span> </span><a name="local-6989586621681883870"><a href="#local-6989586621681883870"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2661"></a><span>                    </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883871"><a href="#local-6989586621681883871"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#coreStringLit"><span class="hs-identifier hs-var">coreStringLit</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unpackFS</span><span> </span><a href="#local-6989586621681883870"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-2662"></a><span>                    </span><a href="DsMeta.html#rep2"><span class="hs-identifier hs-var">rep2</span></a><span> </span><a href="THNames.html#labelEName"><span class="hs-identifier hs-var">labelEName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681883871"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-2663"></a><span>
</span><a name="line-2664"></a><span>
</span><a name="line-2665"></a><span class="hs-comment">------------ Lists -------------------</span><span>
</span><a name="line-2666"></a><span class="hs-comment">-- turn a list of patterns into a single pattern matching a list</span><span>
</span><a name="line-2667"></a><span>
</span><a name="line-2668"></a><span class="hs-identifier">repList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681881813"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881814"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2669"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881813"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881814"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2670"></a><a name="repList"><a href="DsMeta.html#repList"><span class="hs-identifier">repList</span></a></a><span> </span><a name="local-6989586621681883872"><a href="#local-6989586621681883872"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883873"><a href="#local-6989586621681883873"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681883874"><a href="#local-6989586621681883874"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-2671"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883875"><a href="#local-6989586621681883875"><span class="hs-identifier">args1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681883873"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681883874"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2672"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="DsMeta.html#coreList"><span class="hs-identifier hs-var">coreList</span></a><span> </span><a href="#local-6989586621681883872"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><a href="#local-6989586621681883875"><span class="hs-identifier hs-var">args1</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2673"></a><span>
</span><a name="line-2674"></a><span class="hs-identifier">coreList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>    </span><span class="hs-comment">-- Of the TyCon of the element type</span><span>
</span><a name="line-2675"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881812"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881812"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2676"></a><a name="coreList"><a href="DsMeta.html#coreList"><span class="hs-identifier">coreList</span></a></a><span> </span><a name="local-6989586621681883876"><a href="#local-6989586621681883876"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883877"><a href="#local-6989586621681883877"><span class="hs-identifier">es</span></a></a><span>
</span><a name="line-2677"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883878"><a href="#local-6989586621681883878"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883876"><span class="hs-identifier hs-var">tc_name</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreList%27"><span class="hs-identifier hs-var">coreList'</span></a><span> </span><a href="#local-6989586621681883878"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><a href="#local-6989586621681883877"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2678"></a><span>
</span><a name="line-2679"></a><span class="hs-identifier">coreList'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>       </span><span class="hs-comment">-- The element type</span><span>
</span><a name="line-2680"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881811"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881811"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-2681"></a><a name="coreList%27"><a href="DsMeta.html#coreList%27"><span class="hs-identifier">coreList'</span></a></a><span> </span><a name="local-6989586621681883879"><a href="#local-6989586621681883879"><span class="hs-identifier">elt_ty</span></a></a><span> </span><a name="local-6989586621681883880"><a href="#local-6989586621681883880"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListExpr</span><span> </span><a href="#local-6989586621681883879"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883880"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2682"></a><span>
</span><a name="line-2683"></a><span class="hs-identifier">nonEmptyCoreList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881810"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881810"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-2684"></a><span>  </span><span class="hs-comment">-- The list must be non-empty so we can get the element type</span><span>
</span><a name="line-2685"></a><span>  </span><span class="hs-comment">-- Otherwise use coreList</span><span>
</span><a name="line-2686"></a><a name="nonEmptyCoreList"><a href="DsMeta.html#nonEmptyCoreList"><span class="hs-identifier">nonEmptyCoreList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;coreList: empty argument&quot;</span><span>
</span><a name="line-2687"></a><span class="hs-identifier">nonEmptyCoreList</span><span> </span><a name="local-6989586621681883881"><a href="#local-6989586621681883881"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a name="local-6989586621681883882"><a href="#local-6989586621681883882"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListExpr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exprType</span><span> </span><a href="#local-6989586621681883882"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883881"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2688"></a><span>
</span><a name="line-2689"></a><span class="hs-identifier">coreStringLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-2690"></a><a name="coreStringLit"><a href="DsMeta.html#coreStringLit"><span class="hs-identifier">coreStringLit</span></a></a><span> </span><a name="local-6989586621681883883"><a href="#local-6989586621681883883"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883884"><a href="#local-6989586621681883884"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mkStringExpr</span><span> </span><a href="#local-6989586621681883883"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><a href="#local-6989586621681883884"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2691"></a><span>
</span><a name="line-2692"></a><span class="hs-comment">------------------- Maybe ------------------</span><span>
</span><a name="line-2693"></a><span>
</span><a name="line-2694"></a><span class="hs-identifier">repMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681881808"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881809"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2695"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881808"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881809"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2696"></a><a name="repMaybe"><a href="DsMeta.html#repMaybe"><span class="hs-identifier">repMaybe</span></a></a><span> </span><a name="local-6989586621681883885"><a href="#local-6989586621681883885"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreNothing"><span class="hs-identifier hs-var">coreNothing</span></a><span> </span><a href="#local-6989586621681883885"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-2697"></a><span class="hs-identifier">repMaybe</span><span> </span><a name="local-6989586621681883886"><a href="#local-6989586621681883886"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883887"><a href="#local-6989586621681883887"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883888"><a href="#local-6989586621681883888"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreJust"><span class="hs-identifier hs-var">coreJust</span></a><span> </span><a href="#local-6989586621681883886"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621681883887"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681883888"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-2698"></a><span>
</span><a name="line-2699"></a><span class="hs-comment">-- | Construct Core expression for Nothing of a given type name</span><span>
</span><a name="line-2700"></a><span class="hs-identifier">coreNothing</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>        </span><span class="hs-comment">-- ^ Name of the TyCon of the element type</span><span>
</span><a name="line-2701"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881807"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2702"></a><a name="coreNothing"><a href="DsMeta.html#coreNothing"><span class="hs-identifier">coreNothing</span></a></a><span> </span><a name="local-6989586621681883889"><a href="#local-6989586621681883889"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2703"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883890"><a href="#local-6989586621681883890"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883889"><span class="hs-identifier hs-var">tc_name</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreNothing%27"><span class="hs-identifier hs-var">coreNothing'</span></a><span> </span><a href="#local-6989586621681883890"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2704"></a><span>
</span><a name="line-2705"></a><span class="hs-comment">-- | Construct Core expression for Nothing of a given type</span><span>
</span><a name="line-2706"></a><span class="hs-identifier">coreNothing'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>       </span><span class="hs-comment">-- ^ The element type</span><span>
</span><a name="line-2707"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881806"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2708"></a><a name="coreNothing%27"><a href="DsMeta.html#coreNothing%27"><span class="hs-identifier">coreNothing'</span></a></a><span> </span><a name="local-6989586621681883891"><a href="#local-6989586621681883891"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkNothingExpr</span><span> </span><a href="#local-6989586621681883891"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2709"></a><span>
</span><a name="line-2710"></a><span class="hs-comment">-- | Store given Core expression in a Just of a given type name</span><span>
</span><a name="line-2711"></a><span class="hs-identifier">coreJust</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>        </span><span class="hs-comment">-- ^ Name of the TyCon of the element type</span><span>
</span><a name="line-2712"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881805"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881805"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2713"></a><a name="coreJust"><a href="DsMeta.html#coreJust"><span class="hs-identifier">coreJust</span></a></a><span> </span><a name="local-6989586621681883892"><a href="#local-6989586621681883892"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883893"><a href="#local-6989586621681883893"><span class="hs-identifier">es</span></a></a><span>
</span><a name="line-2714"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883894"><a href="#local-6989586621681883894"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883892"><span class="hs-identifier hs-var">tc_name</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreJust%27"><span class="hs-identifier hs-var">coreJust'</span></a><span> </span><a href="#local-6989586621681883894"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><a href="#local-6989586621681883893"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2715"></a><span>
</span><a name="line-2716"></a><span class="hs-comment">-- | Store given Core expression in a Just of a given type</span><span>
</span><a name="line-2717"></a><span class="hs-identifier">coreJust'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>       </span><span class="hs-comment">-- ^ The element type</span><span>
</span><a name="line-2718"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881804"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621681881804"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2719"></a><a name="coreJust%27"><a href="DsMeta.html#coreJust%27"><span class="hs-identifier">coreJust'</span></a></a><span> </span><a name="local-6989586621681883895"><a href="#local-6989586621681883895"><span class="hs-identifier">elt_ty</span></a></a><span> </span><a name="local-6989586621681883896"><a href="#local-6989586621681883896"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkJustExpr</span><span> </span><a href="#local-6989586621681883895"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><span class="hs-special">(</span><a href="DsMeta.html#unC"><span class="hs-identifier hs-var">unC</span></a><span> </span><a href="#local-6989586621681883896"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2720"></a><span>
</span><a name="line-2721"></a><span class="hs-comment">------------------- Maybe Lists ------------------</span><span>
</span><a name="line-2722"></a><span>
</span><a name="line-2723"></a><span class="hs-identifier">repMaybeList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681881802"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><a href="#local-6989586621681881803"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2724"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881802"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881803"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2725"></a><a name="repMaybeList"><a href="DsMeta.html#repMaybeList"><span class="hs-identifier">repMaybeList</span></a></a><span> </span><a name="local-6989586621681883897"><a href="#local-6989586621681883897"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#coreNothingList"><span class="hs-identifier hs-var">coreNothingList</span></a><span> </span><a href="#local-6989586621681883897"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-2726"></a><span class="hs-identifier">repMaybeList</span><span> </span><a name="local-6989586621681883898"><a href="#local-6989586621681883898"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883899"><a href="#local-6989586621681883899"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681883900"><a href="#local-6989586621681883900"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2727"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883901"><a href="#local-6989586621681883901"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883898"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-2728"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621681883902"><a href="#local-6989586621681883902"><span class="hs-identifier">args1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621681883899"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621681883900"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2729"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#coreJust%27"><span class="hs-identifier hs-var">coreJust'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListTy</span><span> </span><a href="#local-6989586621681883901"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#coreList%27"><span class="hs-identifier hs-var">coreList'</span></a><span> </span><a href="#local-6989586621681883901"><span class="hs-identifier hs-var">elt_ty</span></a><span> </span><a href="#local-6989586621681883902"><span class="hs-identifier hs-var">args1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2730"></a><span>
</span><a name="line-2731"></a><span class="hs-identifier">coreNothingList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881801"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2732"></a><a name="coreNothingList"><a href="DsMeta.html#coreNothingList"><span class="hs-identifier">coreNothingList</span></a></a><span> </span><a name="local-6989586621681883903"><a href="#local-6989586621681883903"><span class="hs-identifier">tc_name</span></a></a><span>
</span><a name="line-2733"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883904"><a href="#local-6989586621681883904"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883903"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-2734"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#coreNothing%27"><span class="hs-identifier hs-var">coreNothing'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListTy</span><span> </span><a href="#local-6989586621681883904"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2735"></a><span>
</span><a name="line-2736"></a><span class="hs-identifier">coreJustList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681881800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2737"></a><a name="coreJustList"><a href="DsMeta.html#coreJustList"><span class="hs-identifier">coreJustList</span></a></a><span> </span><a name="local-6989586621681883905"><a href="#local-6989586621681883905"><span class="hs-identifier">tc_name</span></a></a><span> </span><a name="local-6989586621681883906"><a href="#local-6989586621681883906"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-2738"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681883907"><a href="#local-6989586621681883907"><span class="hs-identifier">elt_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMeta.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a><span> </span><a href="#local-6989586621681883905"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-2739"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#coreJust%27"><span class="hs-identifier hs-var">coreJust'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListTy</span><span> </span><a href="#local-6989586621681883907"><span class="hs-identifier hs-var">elt_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681883906"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2740"></a><span>
</span><a name="line-2741"></a><span class="hs-comment">------------ Literals &amp; Variables -------------------</span><span>
</span><a name="line-2742"></a><span>
</span><a name="line-2743"></a><span class="hs-identifier">coreIntLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-2744"></a><a name="coreIntLit"><a href="DsMeta.html#coreIntLit"><span class="hs-identifier">coreIntLit</span></a></a><span> </span><a name="local-6989586621681883908"><a href="#local-6989586621681883908"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621681883909"><a href="#local-6989586621681883909"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDynFlags</span><span>
</span><a name="line-2745"></a><span>                  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkIntExprInt</span><span> </span><a href="#local-6989586621681883909"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621681883908"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2746"></a><span>
</span><a name="line-2747"></a><span class="hs-identifier">coreVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMeta.html#Core"><span class="hs-identifier hs-type">Core</span></a><span> </span><span class="hs-identifier hs-type">TH.Name</span><span>   </span><span class="hs-comment">-- The Id has type Name</span><span>
</span><a name="line-2748"></a><a name="coreVar"><a href="DsMeta.html#coreVar"><span class="hs-identifier">coreVar</span></a></a><span> </span><a name="local-6989586621681883910"><a href="#local-6989586621681883910"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#MkC"><span class="hs-identifier hs-var">MkC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><a href="#local-6989586621681883910"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-2749"></a><span>
</span><a name="line-2750"></a><span class="hs-comment">----------------- Failure -----------------------</span><span>
</span><a name="line-2751"></a><span class="hs-identifier">notHandledL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><a href="#local-6989586621681881799"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2752"></a><a name="notHandledL"><a href="DsMeta.html#notHandledL"><span class="hs-identifier">notHandledL</span></a></a><span> </span><a name="local-6989586621681883911"><a href="#local-6989586621681883911"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621681883912"><a href="#local-6989586621681883912"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-6989586621681883913"><a href="#local-6989586621681883913"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-2753"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isGoodSrcSpan</span><span> </span><a href="#local-6989586621681883911"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-2754"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621681883911"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><a href="#local-6989586621681883912"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="#local-6989586621681883913"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2755"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-2756"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DsMeta.html#notHandled"><span class="hs-identifier hs-var">notHandled</span></a><span> </span><a href="#local-6989586621681883912"><span class="hs-identifier hs-var">what</span></a><span> </span><a href="#local-6989586621681883913"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2757"></a><span>
</span><a name="line-2758"></a><span class="hs-identifier">notHandled</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SDoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DsM</span><span> </span><a href="#local-6989586621681881798"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2759"></a><a name="notHandled"><a href="DsMeta.html#notHandled"><span class="hs-identifier">notHandled</span></a></a><span> </span><a name="local-6989586621681883914"><a href="#local-6989586621681883914"><span class="hs-identifier">what</span></a></a><span> </span><a name="local-6989586621681883915"><a href="#local-6989586621681883915"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#failWithDs"><span class="hs-identifier hs-var">failWithDs</span></a><span> </span><a href="#local-6989586621681883916"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2760"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2761"></a><span>    </span><a name="local-6989586621681883916"><a href="#local-6989586621681883916"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hang</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><a href="#local-6989586621681883914"><span class="hs-identifier hs-var">what</span></a><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;not (yet) handled by Template Haskell&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2762"></a><span>             </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621681883915"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2763"></a></pre></body></html>