<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HieAst</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#mkHieFile"><span class="hs-identifier hs-var">mkHieFile</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Avail</span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Avails</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Bag</span><span>                        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Bag</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BasicTypes</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BooleanFormula</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Class</span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">FunDep</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreUtils</span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">exprType</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ConLike</span><span>                    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">conLikeName</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Config</span><span>                     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">cProjectVersion</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Desugar.html"><span class="hs-identifier">Desugar</span></a><span>                    </span><span class="hs-special">(</span><span> </span><a href="Desugar.html#deSugarExpr"><span class="hs-identifier hs-var">deSugarExpr</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FieldLabel</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsSyn</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HscTypes</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Module</span><span>                     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">ModuleName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ml_hs_file</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MonadUtils</span><span>                 </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Name</span><span>                       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nameSrcSpan</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">setNameLoc</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="TcHsSyn.html"><span class="hs-identifier">TcHsSyn</span></a><span>                    </span><span class="hs-special">(</span><span> </span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>                       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">mkFunTys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span>                 </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">mkListTy</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkSumTy</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Var</span><span>                        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Id</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Var</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">setVarName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">varName</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">varType</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="MkIface.html"><span class="hs-identifier">MkIface</span></a><span>                    </span><span class="hs-special">(</span><span> </span><a href="MkIface.html#mkIfaceExports"><span class="hs-identifier hs-var">mkIfaceExports</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="HieTypes.html"><span class="hs-identifier">HieTypes</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="HieUtils.html"><span class="hs-identifier">HieUtils</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Array</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSC</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>                 </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Reader</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Class</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- These synonyms match those defined in main/GHC.hs</span><span>
</span><a name="line-54"></a><span class="hs-keyword">type</span><span> </span><a name="RenamedSource"><a href="HieAst.html#RenamedSource"><span class="hs-identifier">RenamedSource</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">HsGroup</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LImportDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">LIE</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Avails</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-56"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">LHsDocString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">type</span><span> </span><a name="TypecheckedSource"><a href="HieAst.html#TypecheckedSource"><span class="hs-identifier">TypecheckedSource</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">LHsBinds</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{- Note [Name Remapping]
The Typechecker introduces new names for mono names in AbsBinds.
We don't care about the distinction between mono and poly bindings,
so we replace all occurrences of the mono name with the poly name.
-}</span><span>
</span><a name="line-65"></a><span class="hs-keyword">newtype</span><span> </span><a name="HieState"><a href="HieAst.html#HieState"><span class="hs-identifier">HieState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="HieState"><a href="HieAst.html#HieState"><span class="hs-identifier">HieState</span></a></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="name_remapping"><a href="HieAst.html#name_remapping"><span class="hs-identifier">name_remapping</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">M.Map</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-identifier hs-type">Id</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-identifier">initState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span>
</span><a name="line-70"></a><a name="initState"><a href="HieAst.html#initState"><span class="hs-identifier">initState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-var">HieState</span></a><span> </span><span class="hs-identifier hs-var">M.empty</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">class</span><span> </span><a name="ModifyState"><a href="HieAst.html#ModifyState"><span class="hs-identifier">ModifyState</span></a></a><span> </span><a name="local-6989586621684181260"><a href="#local-6989586621684181260"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- See Note [Name Remapping]</span><span>
</span><a name="line-73"></a><span>  </span><a name="addSubstitution"><a href="HieAst.html#addSubstitution"><span class="hs-identifier">addSubstitution</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621684181260"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684181260"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ModifyState"><span class="hs-identifier hs-type">ModifyState</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-8214565720328956135"><a href="HieAst.html#addSubstitution"><span class="hs-identifier">addSubstitution</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181997"><a href="#local-6989586621684181997"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181997"><span class="hs-identifier hs-var">hs</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ModifyState"><span class="hs-identifier hs-type">ModifyState</span></a><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>  </span><a name="local-8214565720328956135"><a href="HieAst.html#addSubstitution"><span class="hs-identifier">addSubstitution</span></a></a><span> </span><a name="local-6989586621684181994"><a href="#local-6989586621684181994"><span class="hs-identifier">mono</span></a></a><span> </span><a name="local-6989586621684181995"><a href="#local-6989586621684181995"><span class="hs-identifier">poly</span></a></a><span> </span><a name="local-6989586621684181996"><a href="#local-6989586621684181996"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-80"></a><span>    </span><a href="#local-6989586621684181996"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">{</span><span class="hs-identifier">name_remapping</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181994"><span class="hs-identifier hs-var">mono</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181995"><span class="hs-identifier hs-var">poly</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name_remapping</span><span> </span><a href="#local-6989586621684181996"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">modifyState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieAst.html#ModifyState"><span class="hs-identifier hs-type">ModifyState</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684182006"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ABExport</span><span> </span><a href="#local-6989586621684182006"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span>
</span><a name="line-83"></a><a name="modifyState"><a href="HieAst.html#modifyState"><span class="hs-identifier">modifyState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621684182007"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><a name="local-6989586621684182007"><a href="#local-6989586621684182007"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier hs-var">ABE</span><span class="hs-special">{</span><span class="hs-identifier">abe_poly</span><span class="hs-glyph">=</span><a name="local-6989586621684182008"><a href="#local-6989586621684182008"><span class="hs-identifier">poly</span></a></a><span class="hs-special">,</span><span class="hs-identifier">abe_mono</span><span class="hs-glyph">=</span><a name="local-6989586621684182009"><a href="#local-6989586621684182009"><span class="hs-identifier">mono</span></a></a><span class="hs-special">}</span><span> </span><a name="local-6989586621684182010"><a href="#local-6989586621684182010"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#addSubstitution"><span class="hs-identifier hs-var">addSubstitution</span></a><span> </span><a href="#local-6989586621684182009"><span class="hs-identifier hs-var">mono</span></a><span> </span><a href="#local-6989586621684182008"><span class="hs-identifier hs-var">poly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621684182010"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684182011"><a href="#local-6989586621684182011"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684182011"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">type</span><span> </span><a name="HieM"><a href="HieAst.html#HieM"><span class="hs-identifier">HieM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="HieAst.html#HieState"><span class="hs-identifier hs-type">HieState</span></a><span> </span><span class="hs-identifier hs-type">Hsc</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | Construct an 'HieFile' from the outputs of the typechecker.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">mkHieFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ModSummary</span><span>
</span><a name="line-92"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcGblEnv</span><span>
</span><a name="line-93"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#RenamedSource"><span class="hs-identifier hs-type">RenamedSource</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Hsc</span><span> </span><a href="HieTypes.html#HieFile"><span class="hs-identifier hs-type">HieFile</span></a><span>
</span><a name="line-94"></a><a name="mkHieFile"><a href="HieAst.html#mkHieFile"><span class="hs-identifier">mkHieFile</span></a></a><span> </span><a name="local-6989586621684182012"><a href="#local-6989586621684182012"><span class="hs-identifier">ms</span></a></a><span> </span><a name="local-6989586621684182013"><a href="#local-6989586621684182013"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621684182014"><a href="#local-6989586621684182014"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684182015"><a href="#local-6989586621684182015"><span class="hs-identifier">tc_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tcg_binds</span><span> </span><a href="#local-6989586621684182013"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621684182016"><a href="#local-6989586621684182016"><span class="hs-identifier">asts'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621684182017"><a href="#local-6989586621684182017"><span class="hs-identifier">arr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HieAst.html#getCompressedAsts"><span class="hs-identifier hs-var">getCompressedAsts</span></a><span> </span><a href="#local-6989586621684182015"><span class="hs-identifier hs-var">tc_binds</span></a><span> </span><a href="#local-6989586621684182014"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684182018"><a href="#local-6989586621684182018"><span class="hs-identifier">src_file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ml_hs_file</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">ms_location</span><span> </span><a href="#local-6989586621684182012"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-98"></a><span>  </span><a name="local-6989586621684182019"><a href="#local-6989586621684182019"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">BS.readFile</span><span> </span><a href="#local-6989586621684182018"><span class="hs-identifier hs-var">src_file</span></a><span>
</span><a name="line-99"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#HieFile"><span class="hs-identifier hs-var">HieFile</span></a><span>
</span><a name="line-100"></a><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hie_version</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieTypes.html#curHieVersion"><span class="hs-identifier hs-var">curHieVersion</span></a><span>
</span><a name="line-101"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_ghc_version</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BSC.pack</span><span> </span><span class="hs-identifier hs-var">cProjectVersion</span><span>
</span><a name="line-102"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_hs_file</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684182018"><span class="hs-identifier hs-var">src_file</span></a><span>
</span><a name="line-103"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_module</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ms_mod</span><span> </span><a href="#local-6989586621684182012"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-104"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_types</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684182017"><span class="hs-identifier hs-var">arr</span></a><span>
</span><a name="line-105"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_asts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684182016"><span class="hs-identifier hs-var">asts'</span></a><span>
</span><a name="line-106"></a><span>      </span><span class="hs-comment">-- mkIfaceExports sorts the AvailInfos for stability</span><span>
</span><a name="line-107"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MkIface.html#mkIfaceExports"><span class="hs-identifier hs-var">mkIfaceExports</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tcg_exports</span><span> </span><a href="#local-6989586621684182013"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hie_hs_src</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684182019"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-109"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">getCompressedAsts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieAst.html#TypecheckedSource"><span class="hs-identifier hs-type">TypecheckedSource</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#RenamedSource"><span class="hs-identifier hs-type">RenamedSource</span></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Hsc</span><span> </span><span class="hs-special">(</span><a href="HieTypes.html#HieASTs"><span class="hs-identifier hs-type">HieASTs</span></a><span> </span><a href="HieTypes.html#TypeIndex"><span class="hs-identifier hs-type">TypeIndex</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">A.Array</span><span> </span><a href="HieTypes.html#TypeIndex"><span class="hs-identifier hs-type">TypeIndex</span></a><span> </span><a href="HieTypes.html#HieTypeFlat"><span class="hs-identifier hs-type">HieTypeFlat</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><a name="getCompressedAsts"><a href="HieAst.html#getCompressedAsts"><span class="hs-identifier">getCompressedAsts</span></a></a><span> </span><a name="local-6989586621684182020"><a href="#local-6989586621684182020"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621684182021"><a href="#local-6989586621684182021"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-114"></a><span>  </span><a name="local-6989586621684182022"><a href="#local-6989586621684182022"><span class="hs-identifier">asts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HieAst.html#enrichHie"><span class="hs-identifier hs-var">enrichHie</span></a><span> </span><a href="#local-6989586621684182020"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621684182021"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#compressTypes"><span class="hs-identifier hs-var">compressTypes</span></a><span> </span><a href="#local-6989586621684182022"><span class="hs-identifier hs-var">asts</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-identifier">enrichHie</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieAst.html#TypecheckedSource"><span class="hs-identifier hs-type">TypecheckedSource</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#RenamedSource"><span class="hs-identifier hs-type">RenamedSource</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Hsc</span><span> </span><span class="hs-special">(</span><a href="HieTypes.html#HieASTs"><span class="hs-identifier hs-type">HieASTs</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="enrichHie"><a href="HieAst.html#enrichHie"><span class="hs-identifier">enrichHie</span></a></a><span> </span><a name="local-6989586621684182023"><a href="#local-6989586621684182023"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621684182024"><a href="#local-6989586621684182024"><span class="hs-identifier">hsGrp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621684182025"><a href="#local-6989586621684182025"><span class="hs-identifier">imports</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621684182026"><a href="#local-6989586621684182026"><span class="hs-identifier">exports</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier">runReaderT</span><span> </span><a href="HieAst.html#initState"><span class="hs-identifier hs-var">initState</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-119"></a><span>    </span><a name="local-6989586621684182029"><a href="#local-6989586621684182029"><span class="hs-identifier">tasts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="HieTypes.html#ModuleScope"><span class="hs-identifier hs-var">ModuleScope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182023"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621684182030"><a href="#local-6989586621684182030"><span class="hs-identifier">rasts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621684182027"><span class="hs-identifier hs-var">processGrp</span></a><span> </span><a href="#local-6989586621684182024"><span class="hs-identifier hs-var">hsGrp</span></a><span>
</span><a name="line-121"></a><span>    </span><a name="local-6989586621684182031"><a href="#local-6989586621684182031"><span class="hs-identifier">imps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">ideclImplicit</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182025"><span class="hs-identifier hs-var">imports</span></a><span>
</span><a name="line-122"></a><span>    </span><a name="local-6989586621684182032"><a href="#local-6989586621684182032"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="HieTypes.html#Export"><span class="hs-identifier hs-var">Export</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182026"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684182033"><a href="#local-6989586621684182033"><span class="hs-identifier">spanFile</span></a></a><span> </span><a name="local-6989586621684182037"><a href="#local-6989586621684182037"><span class="hs-identifier">children</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684182037"><span class="hs-identifier hs-var">children</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-124"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkRealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRealSrcLoc</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRealSrcLoc</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkRealSrcSpan</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realSrcSpanStart</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">nodeSpan</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621684182037"><span class="hs-identifier hs-var">children</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realSrcSpanEnd</span><span>   </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">nodeSpan</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621684182037"><span class="hs-identifier hs-var">children</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>        </span><a name="local-6989586621684182034"><a href="#local-6989586621684182034"><span class="hs-identifier">modulify</span></a></a><span> </span><a name="local-6989586621684182038"><a href="#local-6989586621684182038"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-129"></a><span>          </span><a href="HieTypes.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#simpleNodeInfo"><span class="hs-identifier hs-var">simpleNodeInfo</span></a><span> </span><span class="hs-string">&quot;Module&quot;</span><span> </span><span class="hs-string">&quot;Module&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684182033"><span class="hs-identifier hs-var">spanFile</span></a><span> </span><a href="#local-6989586621684182038"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182038"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>        </span><a name="local-6989586621684182035"><a href="#local-6989586621684182035"><span class="hs-identifier">asts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieTypes.html#HieASTs"><span class="hs-identifier hs-var">HieASTs</span></a><span>
</span><a name="line-132"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#resolveTyVarScopes"><span class="hs-identifier hs-var">resolveTyVarScopes</span></a><span>
</span><a name="line-133"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">M.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684182034"><span class="hs-identifier hs-var">modulify</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HieUtils.html#mergeSortAsts"><span class="hs-identifier hs-var">mergeSortAsts</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">M.fromListWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621684182039"><a href="#local-6989586621684182039"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcSpanFile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeSpan</span><span> </span><a href="#local-6989586621684182039"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621684182039"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182036"><span class="hs-identifier hs-var">flat_asts</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>        </span><a name="local-6989586621684182036"><a href="#local-6989586621684182036"><span class="hs-identifier">flat_asts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span>
</span><a name="line-138"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621684182029"><span class="hs-identifier hs-var">tasts</span></a><span>
</span><a name="line-139"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621684182030"><span class="hs-identifier hs-var">rasts</span></a><span>
</span><a name="line-140"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621684182031"><span class="hs-identifier hs-var">imps</span></a><span>
</span><a name="line-141"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621684182032"><span class="hs-identifier hs-var">exps</span></a><span>
</span><a name="line-142"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621684182035"><span class="hs-identifier hs-var">asts</span></a><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-6989586621684182027"><a href="#local-6989586621684182027"><span class="hs-identifier">processGrp</span></a></a><span> </span><a name="local-6989586621684182028"><a href="#local-6989586621684182028"><span class="hs-identifier">grp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-146"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="HieTypes.html#ModuleScope"><span class="hs-identifier hs-var">ModuleScope</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">hs_valds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-147"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_splcds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-148"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_tyclds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-149"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_derivds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-150"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_fixds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-151"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_defds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-152"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_fords</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-153"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_warnds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-154"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_annds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-155"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">hs_ruleds</span><span> </span><a href="#local-6989586621684182028"><span class="hs-identifier hs-var">grp</span></a><span>
</span><a name="line-156"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">getRealSpan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span>
</span><a name="line-159"></a><a name="getRealSpan"><a href="HieAst.html#getRealSpan"><span class="hs-identifier">getRealSpan</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RealSrcSpan</span><span> </span><a name="local-6989586621684182040"><a href="#local-6989586621684182040"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684182040"><span class="hs-identifier hs-var">sp</span></a><span>
</span><a name="line-160"></a><span class="hs-identifier">getRealSpan</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-identifier">grhss_span</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">GRHSs</span><span> </span><a href="#local-6989586621684182004"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621684182005"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-163"></a><a name="grhss_span"><a href="HieAst.html#grhss_span"><span class="hs-identifier">grhss_span</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684182041"><a href="#local-6989586621684182041"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621684182042"><a href="#local-6989586621684182042"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-identifier hs-var">combineSrcSpans</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684182042"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684182041"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span class="hs-identifier">grhss_span</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XGRHSs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;XGRHS has no span&quot;</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-identifier">bindingsOnly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HieTypes.html#HieAST"><span class="hs-identifier hs-type">HieAST</span></a><span> </span><a href="#local-6989586621684182003"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-167"></a><a name="bindingsOnly"><a href="HieAst.html#bindingsOnly"><span class="hs-identifier">bindingsOnly</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span class="hs-identifier">bindingsOnly</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a name="local-6989586621684182043"><a href="#local-6989586621684182043"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684182044"><a href="#local-6989586621684182044"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621684182045"><a href="#local-6989586621684182045"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">nameSrcSpan</span><span> </span><a href="#local-6989586621684182044"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-identifier hs-var">RealSrcSpan</span><span> </span><a name="local-6989586621684182046"><a href="#local-6989586621684182046"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieTypes.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="#local-6989586621684182047"><span class="hs-identifier hs-var">nodeinfo</span></a><span> </span><a href="#local-6989586621684182046"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="HieAst.html#bindingsOnly"><span class="hs-identifier hs-var">bindingsOnly</span></a><span> </span><a href="#local-6989586621684182045"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-170"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684182047"><a href="#local-6989586621684182047"><span class="hs-identifier">nodeinfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieTypes.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.singleton</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621684182044"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684182048"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>          </span><a name="local-6989586621684182048"><a href="#local-6989586621684182048"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">{</span><span class="hs-identifier">identInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.singleton</span><span> </span><a href="#local-6989586621684182043"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#bindingsOnly"><span class="hs-identifier hs-var">bindingsOnly</span></a><span> </span><a href="#local-6989586621684182045"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-identifier">concatM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621684182001"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684182001"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684182002"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684182001"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684182002"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-175"></a><a name="concatM"><a href="HieAst.html#concatM"><span class="hs-identifier">concatM</span></a></a><span> </span><a name="local-6989586621684182049"><a href="#local-6989586621684182049"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">sequence</span><span> </span><a href="#local-6989586621684182049"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">{- Note [Capturing Scopes and other non local information]
toHie is a local tranformation, but scopes of bindings cannot be known locally,
hence we have to push the relevant info down into the binding nodes.
We use the following types (*Context and *Scoped) to wrap things and
carry the required info
(Maybe Span) always carries the span of the entire binding, including rhs
-}</span><span>
</span><a name="line-184"></a><span class="hs-keyword">data</span><span> </span><a name="Context"><a href="HieAst.html#Context"><span class="hs-identifier">Context</span></a></a><span> </span><a name="local-6989586621684181259"><a href="#local-6989586621684181259"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="C"><a href="HieAst.html#C"><span class="hs-identifier">C</span></a></a><span> </span><a href="HieTypes.html#ContextInfo"><span class="hs-identifier hs-type">ContextInfo</span></a><span> </span><a href="#local-6989586621684181259"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- Used for names and bindings</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">data</span><span> </span><a name="RContext"><a href="HieAst.html#RContext"><span class="hs-identifier">RContext</span></a></a><span> </span><a name="local-6989586621684181258"><a href="#local-6989586621684181258"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RC"><a href="HieAst.html#RC"><span class="hs-identifier">RC</span></a></a><span> </span><a href="HieTypes.html#RecFieldContext"><span class="hs-identifier hs-type">RecFieldContext</span></a><span> </span><a href="#local-6989586621684181258"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-187"></a><span class="hs-keyword">data</span><span> </span><a name="RFContext"><a href="HieAst.html#RFContext"><span class="hs-identifier">RFContext</span></a></a><span> </span><a name="local-6989586621684181257"><a href="#local-6989586621684181257"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RFC"><a href="HieAst.html#RFC"><span class="hs-identifier">RFC</span></a></a><span> </span><a href="HieTypes.html#RecFieldContext"><span class="hs-identifier hs-type">RecFieldContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181257"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- ^ context for record fields</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-keyword">data</span><span> </span><a name="IEContext"><a href="HieAst.html#IEContext"><span class="hs-identifier">IEContext</span></a></a><span> </span><a name="local-6989586621684181256"><a href="#local-6989586621684181256"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="IEC"><a href="HieAst.html#IEC"><span class="hs-identifier">IEC</span></a></a><span> </span><a href="HieTypes.html#IEType"><span class="hs-identifier hs-type">IEType</span></a><span> </span><a href="#local-6989586621684181256"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- ^ context for imports/exports</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-keyword">data</span><span> </span><a name="BindContext"><a href="HieAst.html#BindContext"><span class="hs-identifier">BindContext</span></a></a><span> </span><a name="local-6989586621684181255"><a href="#local-6989586621684181255"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BC"><a href="HieAst.html#BC"><span class="hs-identifier">BC</span></a></a><span> </span><a href="HieTypes.html#BindType"><span class="hs-identifier hs-type">BindType</span></a><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><a href="#local-6989586621684181255"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- ^ context for imports/exports</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-keyword">data</span><span> </span><a name="PatSynFieldContext"><a href="HieAst.html#PatSynFieldContext"><span class="hs-identifier">PatSynFieldContext</span></a></a><span> </span><a name="local-6989586621684181254"><a href="#local-6989586621684181254"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PSC"><a href="HieAst.html#PSC"><span class="hs-identifier">PSC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181254"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- ^ context for pattern synonym fields.</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-keyword">data</span><span> </span><a name="SigContext"><a href="HieAst.html#SigContext"><span class="hs-identifier">SigContext</span></a></a><span> </span><a name="local-6989586621684181253"><a href="#local-6989586621684181253"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SC"><a href="HieAst.html#SC"><span class="hs-identifier">SC</span></a></a><span> </span><a href="HieAst.html#SigInfo"><span class="hs-identifier hs-type">SigInfo</span></a><span> </span><a href="#local-6989586621684181253"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- ^ context for type signatures</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-keyword">data</span><span> </span><a name="SigInfo"><a href="HieAst.html#SigInfo"><span class="hs-identifier">SigInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SI"><a href="HieAst.html#SI"><span class="hs-identifier">SI</span></a></a><span> </span><a href="HieAst.html#SigType"><span class="hs-identifier hs-type">SigType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-keyword">data</span><span> </span><a name="SigType"><a href="HieAst.html#SigType"><span class="hs-identifier">SigType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BindSig"><a href="HieAst.html#BindSig"><span class="hs-identifier">BindSig</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ClassSig"><a href="HieAst.html#ClassSig"><span class="hs-identifier">ClassSig</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="InstSig"><a href="HieAst.html#InstSig"><span class="hs-identifier">InstSig</span></a></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-keyword">data</span><span> </span><a name="RScoped"><a href="HieAst.html#RScoped"><span class="hs-identifier">RScoped</span></a></a><span> </span><a name="local-6989586621684181252"><a href="#local-6989586621684181252"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RS"><a href="HieAst.html#RS"><span class="hs-identifier">RS</span></a></a><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><a href="#local-6989586621684181252"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- ^ Scope spans over everything to the right of a, (mostly) not</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- including a itself</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- (Includes a in a few special cases like recursive do bindings) or</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- let/where bindings</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Pattern scope</span><span>
</span><a name="line-213"></a><span class="hs-keyword">data</span><span> </span><a name="PScoped"><a href="HieAst.html#PScoped"><span class="hs-identifier">PScoped</span></a></a><span> </span><a name="local-6989586621684181251"><a href="#local-6989586621684181251"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PS"><a href="HieAst.html#PS"><span class="hs-identifier">PS</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>                    </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span>       </span><span class="hs-comment">-- ^ use site of the pattern</span><span>
</span><a name="line-215"></a><span>                    </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span>       </span><span class="hs-comment">-- ^ pattern to the right of a, not including a</span><span>
</span><a name="line-216"></a><span>                    </span><a href="#local-6989586621684181251"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Pattern Scope</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">{- Note [TyVar Scopes]
Due to -XScopedTypeVariables, type variables can be in scope quite far from
their original binding. We resolve the scope of these type variables
in a separate pass
-}</span><span>
</span><a name="line-224"></a><span class="hs-keyword">data</span><span> </span><a name="TScoped"><a href="HieAst.html#TScoped"><span class="hs-identifier">TScoped</span></a></a><span> </span><a name="local-6989586621684181250"><a href="#local-6989586621684181250"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TS"><a href="HieAst.html#TS"><span class="hs-identifier">TS</span></a></a><span> </span><a href="HieTypes.html#TyVarScope"><span class="hs-identifier hs-type">TyVarScope</span></a><span> </span><a href="#local-6989586621684181250"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- TyVarScope</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">data</span><span> </span><a name="TVScoped"><a href="HieAst.html#TVScoped"><span class="hs-identifier">TVScoped</span></a></a><span> </span><a name="local-6989586621684181249"><a href="#local-6989586621684181249"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TVS"><a href="HieAst.html#TVS"><span class="hs-identifier">TVS</span></a></a><span> </span><a href="HieTypes.html#TyVarScope"><span class="hs-identifier hs-type">TyVarScope</span></a><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><a href="#local-6989586621684181249"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- TyVarScope</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- ^ First scope remains constant</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- Second scope is used to build up the scope of a tyvar over</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- things to its right, ala RScoped</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- | Each element scopes over the elements to the right</span><span>
</span><a name="line-232"></a><span class="hs-identifier">listScopes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684182000"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684182000"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-233"></a><a name="listScopes"><a href="HieAst.html#listScopes"><span class="hs-identifier">listScopes</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-234"></a><span class="hs-identifier">listScopes</span><span> </span><a name="local-6989586621684182050"><a href="#local-6989586621684182050"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621684182051"><a href="#local-6989586621684182051"><span class="hs-identifier">pat</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684182050"><span class="hs-identifier hs-var">rhsScope</span></a><span> </span><a href="#local-6989586621684182051"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span>
</span><a name="line-235"></a><span class="hs-identifier">listScopes</span><span> </span><a name="local-6989586621684182052"><a href="#local-6989586621684182052"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621684182053"><a href="#local-6989586621684182053"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621684182054"><a href="#local-6989586621684182054"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684182058"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684182053"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684182055"><span class="hs-identifier hs-var">pats'</span></a><span>
</span><a name="line-236"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>    </span><a name="local-6989586621684182055"><a href="#local-6989586621684182055"><span class="hs-identifier">pats'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684182056"><a href="#local-6989586621684182056"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621684182057"><a href="#local-6989586621684182057"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="#local-6989586621684182052"><span class="hs-identifier hs-var">rhsScope</span></a><span> </span><a href="#local-6989586621684182054"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-238"></a><span>    </span><a name="local-6989586621684182058"><a href="#local-6989586621684182058"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684182056"><span class="hs-identifier hs-var">scope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684182057"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | 'listScopes' specialised to 'PScoped' things</span><span>
</span><a name="line-241"></a><span class="hs-identifier">patScopes</span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HieTypes.html#Span"><span class="hs-identifier hs-type">Span</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181999"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181999"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-247"></a><a name="patScopes"><a href="HieAst.html#patScopes"><span class="hs-identifier">patScopes</span></a></a><span> </span><a name="local-6989586621684182059"><a href="#local-6989586621684182059"><span class="hs-identifier">rsp</span></a></a><span> </span><a name="local-6989586621684182060"><a href="#local-6989586621684182060"><span class="hs-identifier">useScope</span></a></a><span> </span><a name="local-6989586621684182061"><a href="#local-6989586621684182061"><span class="hs-identifier">patScope</span></a></a><span> </span><a name="local-6989586621684182062"><a href="#local-6989586621684182062"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684182063"><a href="#local-6989586621684182063"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-6989586621684182064"><a href="#local-6989586621684182064"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684182059"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684182060"><span class="hs-identifier hs-var">useScope</span></a><span> </span><a href="#local-6989586621684182063"><span class="hs-identifier hs-var">sc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621684182064"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-249"></a><span>    </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="#local-6989586621684182061"><span class="hs-identifier hs-var">patScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">dL</span><span> </span><a href="#local-6989586621684182062"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- | 'listScopes' specialised to 'TVScoped' things</span><span>
</span><a name="line-252"></a><span class="hs-identifier">tvScopes</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HieTypes.html#TyVarScope"><span class="hs-identifier hs-type">TyVarScope</span></a><span>
</span><a name="line-254"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><a href="#local-6989586621684181998"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#TVScoped"><span class="hs-identifier hs-type">TVScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><a href="#local-6989586621684181998"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-257"></a><a name="tvScopes"><a href="HieAst.html#tvScopes"><span class="hs-identifier">tvScopes</span></a></a><span> </span><a name="local-6989586621684182065"><a href="#local-6989586621684182065"><span class="hs-identifier">tvScope</span></a></a><span> </span><a name="local-6989586621684182066"><a href="#local-6989586621684182066"><span class="hs-identifier">rhsScope</span></a></a><span> </span><a name="local-6989586621684182067"><a href="#local-6989586621684182067"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684182068"><a href="#local-6989586621684182068"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-6989586621684182069"><a href="#local-6989586621684182069"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#TVS"><span class="hs-identifier hs-var">TVS</span></a><span> </span><a href="#local-6989586621684182065"><span class="hs-identifier hs-var">tvScope</span></a><span> </span><a href="#local-6989586621684182068"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684182069"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="#local-6989586621684182066"><span class="hs-identifier hs-var">rhsScope</span></a><span> </span><a href="#local-6989586621684182067"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">{- Note [Scoping Rules for SigPat]
Explicitly quantified variables in pattern type signatures are not
brought into scope in the rhs, but implicitly quantified variables
are (HsWC and HsIB).
This is unlike other signatures, where explicitly quantified variables
are brought into the RHS Scope
For example
foo :: forall a. ...;
foo = ... -- a is in scope here

bar (x :: forall a. a -&gt; a) = ... -- a is not in scope here
--   ^ a is in scope here (pattern body)

bax (x :: a) = ... -- a is in scope here
Because of HsWC and HsIB pass on their scope to their children
we must wrap the LHsType in pattern signatures in a
Shielded explictly, so that the HsWC/HsIB scope is not passed
on the the LHsType
-}</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-keyword">data</span><span> </span><a name="Shielded"><a href="HieAst.html#Shielded"><span class="hs-identifier">Shielded</span></a></a><span> </span><a name="local-6989586621684181248"><a href="#local-6989586621684181248"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SH"><a href="HieAst.html#SH"><span class="hs-identifier">SH</span></a></a><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><a href="#local-6989586621684181248"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- Ignores its TScope, uses its own scope instead</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="ProtectedSig"><a href="HieAst.html#ProtectedSig"><span class="hs-identifier">ProtectedSig</span></a></a><span> </span><a name="local-6989586621684181247"><a href="#local-6989586621684181247"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-identifier">ProtectedSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">HsWildCardBndrs</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsImplicitBndrs</span><span>
</span><a name="line-284"></a><span>                                                </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-285"></a><span>                                                </span><span class="hs-special">(</span><a href="HieAst.html#Shielded"><span class="hs-identifier hs-type">Shielded</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-identifier">ProtectedSig</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">NoExt</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-keyword">class</span><span> </span><a name="ProtectSig"><a href="HieAst.html#ProtectSig"><span class="hs-identifier">ProtectSig</span></a></a><span> </span><a name="local-6989586621684181246"><a href="#local-6989586621684181246"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-289"></a><span>  </span><a name="protectSig"><a href="HieAst.html#protectSig"><span class="hs-identifier">protectSig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HieTypes.html#Scope"><span class="hs-identifier hs-type">Scope</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NoGhcTc</span><span> </span><a href="#local-6989586621684181246"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#ProtectedSig"><span class="hs-identifier hs-type">ProtectedSig</span></a><span> </span><a href="#local-6989586621684181246"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181992"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Shielded"><span class="hs-identifier hs-type">Shielded</span></a><span> </span><a href="#local-6989586621684181992"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-292"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SH"><span class="hs-identifier hs-var">SH</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181993"><a href="#local-6989586621684181993"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181993"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><a href="#local-6989586621684181989"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Shielded"><span class="hs-identifier hs-type">Shielded</span></a><span> </span><a href="#local-6989586621684181989"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-295"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SH"><span class="hs-identifier hs-var">SH</span></a><span> </span><a name="local-6989586621684181990"><a href="#local-6989586621684181990"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-6989586621684181991"><a href="#local-6989586621684181991"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181990"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181991"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ProtectSig"><span class="hs-identifier hs-type">ProtectSig</span></a><span> </span><span class="hs-identifier hs-type">GhcTc</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-298"></a><span>  </span><a name="local-8214565720328956101"><a href="HieAst.html#protectSig"><span class="hs-identifier">protectSig</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NoExt</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ProtectSig"><span class="hs-identifier hs-type">ProtectSig</span></a><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-301"></a><span>  </span><a name="local-8214565720328956101"><a href="HieAst.html#protectSig"><span class="hs-identifier">protectSig</span></a></a><span> </span><a name="local-6989586621684181985"><a href="#local-6989586621684181985"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWC</span><span> </span><a name="local-6989586621684181986"><a href="#local-6989586621684181986"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><a name="local-6989586621684181987"><a href="#local-6989586621684181987"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181988"><a href="#local-6989586621684181988"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-302"></a><span>    </span><span class="hs-identifier hs-var">HsWC</span><span> </span><a href="#local-6989586621684181986"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><a href="#local-6989586621684181987"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SH"><span class="hs-identifier hs-var">SH</span></a><span> </span><a href="#local-6989586621684181985"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181988"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-identifier">protectSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;protectSig not given HsWC (HsIB)&quot;</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-keyword">class</span><span> </span><a name="HasLoc"><a href="HieAst.html#HasLoc"><span class="hs-identifier">HasLoc</span></a></a><span> </span><a name="local-6989586621684181245"><a href="#local-6989586621684181245"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-comment">-- ^ defined so that HsImplicitBndrs and HsWildCardBndrs can</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-comment">-- know what their implicit bindings are scoping over</span><span>
</span><a name="line-308"></a><span>  </span><a name="loc"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621684181245"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181983"><span class="hs-identifier hs-type">thing</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><a href="#local-6989586621684181983"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-311"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181984"><a href="#local-6989586621684181984"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181984"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181981"><span class="hs-identifier hs-type">thing</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><a href="#local-6989586621684181981"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-314"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181982"><a href="#local-6989586621684181982"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181982"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-317"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181980"><a href="#local-6989586621684181980"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181980"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181977"><span class="hs-identifier hs-type">thing</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsImplicitBndrs</span><span> </span><a href="#local-6989586621684181978"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181977"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-321"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181979"><a href="#local-6989586621684181979"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181979"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-322"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181974"><span class="hs-identifier hs-type">thing</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsWildCardBndrs</span><span> </span><a href="#local-6989586621684181975"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181974"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-325"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWC</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181976"><a href="#local-6989586621684181976"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181976"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181972"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181973"><a href="#local-6989586621684181973"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181973"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181970"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><a name="local-6989586621684181971"><a href="#local-6989586621684181971"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><span class="hs-identifier hs-var">combineSrcSpans</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181971"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181961"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FamEqn</span><span> </span><a href="#local-6989586621684181962"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621684181960"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181961"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-336"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181963"><a href="#local-6989586621684181963"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621684181964"><a href="#local-6989586621684181964"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181965"><a href="#local-6989586621684181965"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><span class="hs-identifier hs-var">combineSrcSpans</span><span> </span><span class="hs-special">[</span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181963"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181964"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181965"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-337"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181966"><a href="#local-6989586621684181966"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684181967"><a href="#local-6989586621684181967"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181968"><a href="#local-6989586621684181968"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181969"><a href="#local-6989586621684181969"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><span class="hs-identifier hs-var">combineSrcSpans</span><span>
</span><a name="line-338"></a><span>                                              </span><span class="hs-special">[</span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181966"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181967"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181968"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181969"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-339"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-340"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181955"><span class="hs-identifier hs-type">tm</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181956"><span class="hs-identifier hs-type">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsArg</span><span> </span><a href="#local-6989586621684181955"><span class="hs-identifier hs-type">tm</span></a><span> </span><a href="#local-6989586621684181956"><span class="hs-identifier hs-type">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-341"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621684181957"><a href="#local-6989586621684181957"><span class="hs-identifier">tm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181957"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-342"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181958"><a href="#local-6989586621684181958"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181958"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-343"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><a name="local-6989586621684181959"><a href="#local-6989586621684181959"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181959"><span class="hs-identifier hs-var">sp</span></a><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsDataDefn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-346"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621684181954"><a href="#local-6989586621684181954"><span class="hs-identifier">def</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsDataDefn</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><a href="#local-6989586621684181954"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-347"></a><span>    </span><span class="hs-comment">-- Only used for data family instances, so we only need rhs</span><span>
</span><a name="line-348"></a><span>    </span><span class="hs-comment">-- Most probably the rest will be unhelpful anyway</span><span>
</span><a name="line-349"></a><span>  </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181952"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-352"></a><span>  </span><a name="local-8214565720328956099"><a href="HieAst.html#loc"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181953"><a href="#local-6989586621684181953"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181953"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- | The main worker class</span><span>
</span><a name="line-355"></a><span class="hs-keyword">class</span><span> </span><a name="ToHie"><a href="HieAst.html#ToHie"><span class="hs-identifier">ToHie</span></a></a><span> </span><a name="local-6989586621684181244"><a href="#local-6989586621684181244"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-356"></a><span>  </span><a name="toHie"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621684181244"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieM"><span class="hs-identifier hs-type">HieM</span></a><span> </span><span class="hs-special">[</span><a href="HieTypes.html#HieAST"><span class="hs-identifier hs-type">HieAST</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">-- | Used to collect type info</span><span>
</span><a name="line-359"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621684181243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="HasType"><a href="HieAst.html#HasType"><span class="hs-identifier">HasType</span></a></a><span> </span><a name="local-6989586621684181243"><a href="#local-6989586621684181243"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>  </span><a name="getTypeNode"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621684181243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#HieM"><span class="hs-identifier hs-type">HieM</span></a><span> </span><span class="hs-special">[</span><a href="HieTypes.html#HieAST"><span class="hs-identifier hs-type">HieAST</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181951"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181951"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-363"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181950"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bag</span><span> </span><a href="#local-6989586621684181950"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-366"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181949"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621684181949"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-369"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">NoExt</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-372"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-identifier hs-type">NoExt</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-375"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEContext"><span class="hs-identifier hs-type">IEContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">ModuleName</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-378"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a name="local-6989586621684181944"><a href="#local-6989586621684181944"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RealSrcSpan</span><span> </span><a name="local-6989586621684181945"><a href="#local-6989586621684181945"><span class="hs-identifier">span</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181946"><a href="#local-6989586621684181946"><span class="hs-identifier">mname</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-379"></a><span>      </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><a href="HieTypes.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621684181948"><span class="hs-identifier hs-var">idents</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181945"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-380"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181947"><a href="#local-6989586621684181947"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">{</span><span class="hs-identifier">identInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.singleton</span><span> </span><span class="hs-special">(</span><a href="HieTypes.html#IEThing"><span class="hs-identifier hs-var">IEThing</span></a><span> </span><a href="#local-6989586621684181944"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-381"></a><span>          </span><a name="local-6989586621684181948"><a href="#local-6989586621684181948"><span class="hs-identifier">idents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.singleton</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621684181946"><span class="hs-identifier hs-var">mname</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181947"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-382"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Var</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-385"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181938"><a href="#local-6989586621684181938"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181938"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-386"></a><span>      </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a name="local-6989586621684181939"><a href="#local-6989586621684181939"><span class="hs-identifier">context</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RealSrcSpan</span><span> </span><a name="local-6989586621684181940"><a href="#local-6989586621684181940"><span class="hs-identifier">span</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181941"><a href="#local-6989586621684181941"><span class="hs-identifier">name'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-388"></a><span>        </span><a name="local-6989586621684181942"><a href="#local-6989586621684181942"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-identifier">name_remapping</span><span>
</span><a name="line-389"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181943"><a href="#local-6989586621684181943"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.findWithDefault</span><span> </span><a href="#local-6989586621684181941"><span class="hs-identifier hs-var">name'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181941"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181942"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-390"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-391"></a><span>          </span><span class="hs-special">[</span><a href="HieTypes.html#Node"><span class="hs-identifier hs-var">Node</span></a><span>
</span><a name="line-392"></a><span>            </span><span class="hs-special">(</span><a href="HieTypes.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-393"></a><span>              </span><span class="hs-identifier hs-var">M.singleton</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181943"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>                          </span><span class="hs-special">(</span><a href="HieTypes.html#IdentifierDetails"><span class="hs-identifier hs-var">IdentifierDetails</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621684181941"><span class="hs-identifier hs-var">name'</span></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>                                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.singleton</span><span> </span><a href="#local-6989586621684181939"><span class="hs-identifier hs-var">context</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>            </span><a href="#local-6989586621684181940"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-397"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-398"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181931"><a href="#local-6989586621684181931"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181931"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-402"></a><span>      </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a name="local-6989586621684181932"><a href="#local-6989586621684181932"><span class="hs-identifier">context</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RealSrcSpan</span><span> </span><a name="local-6989586621684181933"><a href="#local-6989586621684181933"><span class="hs-identifier">span</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181934"><a href="#local-6989586621684181934"><span class="hs-identifier">name'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-403"></a><span>        </span><a name="local-6989586621684181935"><a href="#local-6989586621684181935"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-identifier">name_remapping</span><span>
</span><a name="line-404"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181936"><a href="#local-6989586621684181936"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">M.lookup</span><span> </span><a href="#local-6989586621684181934"><span class="hs-identifier hs-var">name'</span></a><span> </span><a href="#local-6989586621684181935"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-405"></a><span>              </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684181937"><a href="#local-6989586621684181937"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181937"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-406"></a><span>              </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684181934"><span class="hs-identifier hs-var">name'</span></a><span>
</span><a name="line-407"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-408"></a><span>          </span><span class="hs-special">[</span><a href="HieTypes.html#Node"><span class="hs-identifier hs-var">Node</span></a><span>
</span><a name="line-409"></a><span>            </span><span class="hs-special">(</span><a href="HieTypes.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier hs-var">S.empty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-410"></a><span>              </span><span class="hs-identifier hs-var">M.singleton</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621684181936"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>                          </span><span class="hs-special">(</span><a href="HieTypes.html#IdentifierDetails"><span class="hs-identifier hs-var">IdentifierDetails</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-412"></a><span>                                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.singleton</span><span> </span><a href="#local-6989586621684181932"><span class="hs-identifier hs-var">context</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>            </span><a href="#local-6989586621684181933"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-414"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-415"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-comment">-- | Dummy instances - never called</span><span>
</span><a name="line-418"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-419"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-420"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsWcType</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-421"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-422"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-423"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-424"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-425"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-428"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181929"><a href="#local-6989586621684181929"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181930"><a href="#local-6989586621684181930"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181930"><span class="hs-identifier hs-var">bind</span></a><span> </span><a href="#local-6989586621684181929"><span class="hs-identifier hs-var">spn</span></a><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-431"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181926"><a href="#local-6989586621684181926"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181927"><a href="#local-6989586621684181927"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181927"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-432"></a><span>      </span><span class="hs-identifier hs-var">FunBind</span><span class="hs-special">{</span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181928"><a href="#local-6989586621684181928"><span class="hs-identifier">name</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieUtils.html#makeTypeNode"><span class="hs-identifier hs-var">makeTypeNode</span></a><span> </span><a href="#local-6989586621684181927"><span class="hs-identifier hs-var">bind</span></a><span> </span><a href="#local-6989586621684181926"><span class="hs-identifier hs-var">spn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621684181928"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181927"><span class="hs-identifier hs-var">bind</span></a><span> </span><a href="#local-6989586621684181926"><span class="hs-identifier hs-var">spn</span></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-436"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181924"><a href="#local-6989586621684181924"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181925"><a href="#local-6989586621684181925"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181925"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621684181924"><span class="hs-identifier hs-var">spn</span></a><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-439"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181922"><a href="#local-6989586621684181922"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181923"><a href="#local-6989586621684181923"><span class="hs-identifier">opat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeTypeNode"><span class="hs-identifier hs-var">makeTypeNode</span></a><span> </span><a href="#local-6989586621684181923"><span class="hs-identifier hs-var">opat</span></a><span> </span><a href="#local-6989586621684181922"><span class="hs-identifier hs-var">spn</span></a><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span> </span><a href="#local-6989586621684181923"><span class="hs-identifier hs-var">opat</span></a><span class="hs-special">)</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-442"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181920"><a href="#local-6989586621684181920"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181921"><a href="#local-6989586621684181921"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181921"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621684181920"><span class="hs-identifier hs-var">spn</span></a><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-comment">-- | This instance tries to construct 'HieAST' nodes which include the type of</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- the expression. It is not yet possible to do this efficiently for all</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- expression forms, so we skip filling in the type for those inputs.</span><span>
</span><a name="line-447"></a><span class="hs-comment">--</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- 'HsApp', for example, doesn't have any type information available directly on</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- the node. Our next recourse would be to desugar it into a 'CoreExpr' then</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- query the type of that. Yet both the desugaring call and the type query both</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- involve recursive calls to the function and argument! This is particularly</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- problematic when you realize that the HIE traversal will eventually visit</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- those nodes too and ask for their types again.</span><span>
</span><a name="line-454"></a><span class="hs-comment">--</span><span>
</span><a name="line-455"></a><span class="hs-comment">-- Since the above is quite costly, we just skip cases where computing the</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- expression's type is going to be expensive.</span><span>
</span><a name="line-457"></a><span class="hs-comment">--</span><span>
</span><a name="line-458"></a><span class="hs-comment">-- See #16233</span><span>
</span><a name="line-459"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-460"></a><span>  </span><a name="local-8214565720328956095"><a href="HieAst.html#getTypeNode"><span class="hs-identifier">getTypeNode</span></a></a><span> </span><a name="local-6989586621684181896"><a href="#local-6989586621684181896"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181897"><a href="#local-6989586621684181897"><span class="hs-identifier">spn</span></a></a><span> </span><a name="local-6989586621684181898"><a href="#local-6989586621684181898"><span class="hs-identifier">e'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-461"></a><span>    </span><span class="hs-comment">-- Some expression forms have their type immediately available</span><span>
</span><a name="line-462"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181906"><a href="#local-6989586621684181906"><span class="hs-identifier">tyOpt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181898"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-463"></a><span>          </span><span class="hs-identifier hs-var">HsLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181907"><a href="#local-6989586621684181907"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TcHsSyn.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a><span> </span><a href="#local-6989586621684181907"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>          </span><span class="hs-identifier hs-var">HsOverLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181908"><a href="#local-6989586621684181908"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">overLitType</span><span> </span><a href="#local-6989586621684181908"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span>          </span><span class="hs-identifier hs-var">HsLam</span><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181909"><a href="#local-6989586621684181909"><span class="hs-identifier">groupTy</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684181900"><span class="hs-identifier hs-var">matchGroupType</span></a><span> </span><a href="#local-6989586621684181909"><span class="hs-identifier hs-var">groupTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-467"></a><span>          </span><span class="hs-identifier hs-var">HsLamCase</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181910"><a href="#local-6989586621684181910"><span class="hs-identifier">groupTy</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684181900"><span class="hs-identifier hs-var">matchGroupType</span></a><span> </span><a href="#local-6989586621684181910"><span class="hs-identifier hs-var">groupTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>          </span><span class="hs-identifier hs-var">HsCase</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MG</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181911"><a href="#local-6989586621684181911"><span class="hs-identifier">groupTy</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mg_res_ty</span><span> </span><a href="#local-6989586621684181911"><span class="hs-identifier hs-var">groupTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span>          </span><span class="hs-identifier hs-var">ExplicitList</span><span>  </span><a name="local-6989586621684181912"><a href="#local-6989586621684181912"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkListTy</span><span> </span><a href="#local-6989586621684181912"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>          </span><span class="hs-identifier hs-var">ExplicitSum</span><span>   </span><a name="local-6989586621684181913"><a href="#local-6989586621684181913"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkSumTy</span><span> </span><a href="#local-6989586621684181913"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-472"></a><span>          </span><span class="hs-identifier hs-var">HsDo</span><span>          </span><a name="local-6989586621684181914"><a href="#local-6989586621684181914"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684181914"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-473"></a><span>          </span><span class="hs-identifier hs-var">HsMultiIf</span><span>     </span><a name="local-6989586621684181915"><a href="#local-6989586621684181915"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684181915"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181906"><span class="hs-identifier hs-var">tyOpt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-479"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621684181901"><span class="hs-identifier hs-var">skipDesugaring</span></a><span> </span><a href="#local-6989586621684181898"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684181899"><span class="hs-identifier hs-var">fallback</span></a><span>
</span><a name="line-480"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-481"></a><span>            </span><a name="local-6989586621684181918"><a href="#local-6989586621684181918"><span class="hs-identifier">hs_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Hsc</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621684181916"><a href="#local-6989586621684181916"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621684181917"><a href="#local-6989586621684181917"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684181916"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621684181917"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621684181919"><a href="#local-6989586621684181919"><span class="hs-identifier">mbe</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Desugar.html#deSugarExpr"><span class="hs-identifier hs-var">deSugarExpr</span></a><span> </span><a href="#local-6989586621684181918"><span class="hs-identifier hs-var">hs_env</span></a><span> </span><a href="#local-6989586621684181896"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-483"></a><span>            </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621684181899"><span class="hs-identifier hs-var">fallback</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#makeTypeNode"><span class="hs-identifier hs-var">makeTypeNode</span></a><span> </span><a href="#local-6989586621684181898"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621684181897"><span class="hs-identifier hs-var">spn</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">exprType</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181919"><span class="hs-identifier hs-var">mbe</span></a><span>
</span><a name="line-484"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-485"></a><span>      </span><a name="local-6989586621684181899"><a href="#local-6989586621684181899"><span class="hs-identifier">fallback</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181898"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621684181897"><span class="hs-identifier hs-var">spn</span></a><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span>      </span><span class="hs-identifier">matchGroupType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MatchGroupTc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-488"></a><span>      </span><a name="local-6989586621684181900"><a href="#local-6989586621684181900"><span class="hs-identifier">matchGroupType</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">MatchGroupTc</span><span> </span><a name="local-6989586621684181903"><a href="#local-6989586621684181903"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621684181904"><a href="#local-6989586621684181904"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkFunTys</span><span> </span><a href="#local-6989586621684181903"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621684181904"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span>      </span><span class="hs-comment">-- | Skip desugaring of these expressions for performance reasons.</span><span>
</span><a name="line-491"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-492"></a><span>      </span><span class="hs-comment">-- See impact on Haddock output (esp. missing type annotations or links)</span><span>
</span><a name="line-493"></a><span>      </span><span class="hs-comment">-- before marking more things here as 'False'. See impact on Haddock</span><span>
</span><a name="line-494"></a><span>      </span><span class="hs-comment">-- performance before marking more things as 'True'.</span><span>
</span><a name="line-495"></a><span>      </span><span class="hs-identifier">skipDesugaring</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HsExpr</span><span> </span><a href="#local-6989586621684181902"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-496"></a><span>      </span><a name="local-6989586621684181901"><a href="#local-6989586621684181901"><span class="hs-identifier">skipDesugaring</span></a></a><span> </span><a name="local-6989586621684181905"><a href="#local-6989586621684181905"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181905"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-497"></a><span>        </span><span class="hs-identifier hs-var">HsVar</span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-498"></a><span>        </span><span class="hs-identifier hs-var">HsUnboundVar</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-499"></a><span>        </span><span class="hs-identifier hs-var">HsConLikeOut</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-500"></a><span>        </span><span class="hs-identifier hs-var">HsRecFld</span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-501"></a><span>        </span><span class="hs-identifier hs-var">HsOverLabel</span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-502"></a><span>        </span><span class="hs-identifier hs-var">HsIPVar</span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-503"></a><span>        </span><span class="hs-identifier hs-var">HsWrap</span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-504"></a><span>        </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-507"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MatchGroup</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GRHSs</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PatSynBind</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ModifyState"><span class="hs-identifier hs-type">ModifyState</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsBind</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BindContext"><span class="hs-identifier hs-type">BindContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-516"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a name="local-6989586621684181883"><a href="#local-6989586621684181883"><span class="hs-identifier">context</span></a></a><span> </span><a name="local-6989586621684181884"><a href="#local-6989586621684181884"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621684181885"><a href="#local-6989586621684181885"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181886"><a href="#local-6989586621684181886"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181887"><a href="#local-6989586621684181887"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-517"></a><span>    </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getTypeNode"><span class="hs-identifier hs-var">getTypeNode</span></a><span> </span><a href="#local-6989586621684181885"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181887"><span class="hs-identifier hs-var">bind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-518"></a><span>      </span><span class="hs-identifier hs-var">FunBind</span><span class="hs-special">{</span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181888"><a href="#local-6989586621684181888"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181889"><a href="#local-6989586621684181889"><span class="hs-identifier">matches</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-519"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ValBind"><span class="hs-identifier hs-var">ValBind</span></a><span> </span><a href="#local-6989586621684181883"><span class="hs-identifier hs-var">context</span></a><span> </span><a href="#local-6989586621684181884"><span class="hs-identifier hs-var">scope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181886"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181888"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-520"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181889"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-521"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-522"></a><span>      </span><span class="hs-identifier hs-var">PatBind</span><span class="hs-special">{</span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181890"><a href="#local-6989586621684181890"><span class="hs-identifier">lhs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181891"><a href="#local-6989586621684181891"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-523"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181886"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181884"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181890"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-524"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181891"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-525"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>      </span><span class="hs-identifier hs-var">VarBind</span><span class="hs-special">{</span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181892"><a href="#local-6989586621684181892"><span class="hs-identifier">expr</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-527"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181892"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-528"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-529"></a><span>      </span><span class="hs-identifier hs-var">AbsBinds</span><span class="hs-special">{</span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181893"><a href="#local-6989586621684181893"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181894"><a href="#local-6989586621684181894"><span class="hs-identifier">binds</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-530"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">local</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#modifyState"><span class="hs-identifier hs-var">modifyState</span></a><span> </span><a href="#local-6989586621684181893"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-comment">-- Note [Name Remapping]</span><span>
</span><a name="line-531"></a><span>            </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="#local-6989586621684181883"><span class="hs-identifier hs-var">context</span></a><span> </span><a href="#local-6989586621684181884"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181894"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-532"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-533"></a><span>      </span><span class="hs-identifier hs-var">PatSynBind</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181895"><a href="#local-6989586621684181895"><span class="hs-identifier">psb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-534"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181886"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181895"><span class="hs-identifier hs-var">psb</span></a><span> </span><span class="hs-comment">-- PatSynBinds only occur at the top level</span><span>
</span><a name="line-535"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-536"></a><span>      </span><span class="hs-identifier hs-var">XHsBindsLR</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LMatch</span><span> </span><a href="#local-6989586621684181877"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181878"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MatchGroup</span><span> </span><a href="#local-6989586621684181877"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181878"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-540"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181879"><a href="#local-6989586621684181879"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181879"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-541"></a><span>    </span><span class="hs-identifier hs-var">MG</span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181880"><a href="#local-6989586621684181880"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181881"><a href="#local-6989586621684181881"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FromSource</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-542"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181880"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-543"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181881"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-544"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-545"></a><span>    </span><span class="hs-identifier hs-var">MG</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-546"></a><span>    </span><span class="hs-identifier hs-var">XMatchGroup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-549"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-550"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsPatSynDir</span><span> </span><a href="#local-6989586621684181852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-551"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PatSynBind</span><span> </span><a href="#local-6989586621684181852"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-552"></a><span>    </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181853"><a href="#local-6989586621684181853"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621684181854"><a href="#local-6989586621684181854"><span class="hs-identifier">psb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181854"><span class="hs-identifier hs-var">psb</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-553"></a><span>      </span><span class="hs-identifier hs-var">PSB</span><span class="hs-special">{</span><span class="hs-identifier">psb_id</span><span class="hs-glyph">=</span><a name="local-6989586621684181855"><a href="#local-6989586621684181855"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span class="hs-glyph">=</span><a name="local-6989586621684181856"><a href="#local-6989586621684181856"><span class="hs-identifier">dets</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span class="hs-glyph">=</span><a name="local-6989586621684181857"><a href="#local-6989586621684181857"><span class="hs-identifier">pat</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span class="hs-glyph">=</span><a name="local-6989586621684181858"><a href="#local-6989586621684181858"><span class="hs-identifier">dir</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-554"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#PatSynDec"><span class="hs-identifier hs-var">PatSynDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181853"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181855"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-555"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684181864"><span class="hs-identifier hs-var">toBind</span></a><span> </span><a href="#local-6989586621684181856"><span class="hs-identifier hs-var">dets</span></a><span>
</span><a name="line-556"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621684181859"><span class="hs-identifier hs-var">lhsScope</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181857"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-557"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181858"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-558"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-559"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-560"></a><span>          </span><a name="local-6989586621684181859"><a href="#local-6989586621684181859"><span class="hs-identifier">lhsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181860"><span class="hs-identifier hs-var">varScope</span></a><span> </span><a href="#local-6989586621684181861"><span class="hs-identifier hs-var">detScope</span></a><span>
</span><a name="line-561"></a><span>          </span><a name="local-6989586621684181860"><a href="#local-6989586621684181860"><span class="hs-identifier">varScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181855"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-562"></a><span>          </span><a name="local-6989586621684181861"><a href="#local-6989586621684181861"><span class="hs-identifier">detScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181856"><span class="hs-identifier hs-var">dets</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-563"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621684181865"><a href="#local-6989586621684181865"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181865"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-564"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621684181866"><a href="#local-6989586621684181866"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181867"><a href="#local-6989586621684181867"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181866"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181867"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-565"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621684181868"><a href="#local-6989586621684181868"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621684181862"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181868"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-566"></a><span>          </span><a name="local-6989586621684181862"><a href="#local-6989586621684181862"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecordPatSynField</span><span> </span><a name="local-6989586621684181869"><a href="#local-6989586621684181869"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181870"><a href="#local-6989586621684181870"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181871"><a href="#local-6989586621684181871"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181871"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-567"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181869"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181870"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-568"></a><span>          </span><a name="local-6989586621684181863"><a href="#local-6989586621684181863"><span class="hs-identifier">detSpan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181861"><span class="hs-identifier hs-var">detScope</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-569"></a><span>            </span><a href="HieTypes.html#LocalScope"><span class="hs-identifier hs-var">LocalScope</span></a><span> </span><a name="local-6989586621684181872"><a href="#local-6989586621684181872"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684181872"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-570"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-571"></a><span>          </span><a name="local-6989586621684181864"><a href="#local-6989586621684181864"><span class="hs-identifier">toBind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621684181873"><a href="#local-6989586621684181873"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181873"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-572"></a><span>          </span><span class="hs-identifier">toBind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621684181874"><a href="#local-6989586621684181874"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181875"><a href="#local-6989586621684181875"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InfixCon</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181874"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181875"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-573"></a><span>          </span><span class="hs-identifier">toBind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621684181876"><a href="#local-6989586621684181876"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">RecCon</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#PSC"><span class="hs-identifier hs-var">PSC</span></a><span> </span><a href="#local-6989586621684181863"><span class="hs-identifier hs-var">detSpan</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181876"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-574"></a><span>      </span><span class="hs-identifier hs-var">XPatSynBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MatchGroup</span><span> </span><a href="#local-6989586621684181849"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181849"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsPatSynDir</span><span> </span><a href="#local-6989586621684181849"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-578"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181850"><a href="#local-6989586621684181850"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181850"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-identifier hs-var">ExplicitBidirectional</span><span> </span><a name="local-6989586621684181851"><a href="#local-6989586621684181851"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181851"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-580"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181841"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-583"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181842"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-584"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsMatchContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NameOrRdrName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181840"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181840"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-586"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GRHSs</span><span> </span><a href="#local-6989586621684181840"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181842"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Match</span><span> </span><a href="#local-6989586621684181840"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181842"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LMatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181841"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181842"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-589"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181843"><a href="#local-6989586621684181843"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181844"><a href="#local-6989586621684181844"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181844"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621684181843"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181844"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-590"></a><span>    </span><span class="hs-identifier hs-var">Match</span><span class="hs-special">{</span><span class="hs-identifier">m_ctxt</span><span class="hs-glyph">=</span><a name="local-6989586621684181845"><a href="#local-6989586621684181845"><span class="hs-identifier">mctx</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181846"><a href="#local-6989586621684181846"><span class="hs-identifier">pats</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span>  </span><a name="local-6989586621684181847"><a href="#local-6989586621684181847"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-591"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181845"><span class="hs-identifier hs-var">mctx</span></a><span>
</span><a name="line-592"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181848"><a href="#local-6989586621684181848"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#grhss_span"><span class="hs-identifier hs-var">grhss_span</span></a><span> </span><a href="#local-6989586621684181847"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-593"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#patScopes"><span class="hs-identifier hs-var">patScopes</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621684181848"><span class="hs-identifier hs-var">rhsScope</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181846"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-594"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181847"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-595"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-596"></a><span>    </span><span class="hs-identifier hs-var">XMatch</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181837"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsMatchContext</span><span> </span><a href="#local-6989586621684181837"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-600"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunRhs</span><span class="hs-special">{</span><span class="hs-identifier">mc_fun</span><span class="hs-glyph">=</span><a name="local-6989586621684181838"><a href="#local-6989586621684181838"><span class="hs-identifier">name</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#MatchBind"><span class="hs-identifier hs-var">MatchBind</span></a><span> </span><a href="#local-6989586621684181838"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-601"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">StmtCtxt</span><span> </span><a name="local-6989586621684181839"><a href="#local-6989586621684181839"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181839"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-602"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsMatchContext</span><span> </span><a href="#local-6989586621684181833"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsStmtContext</span><span> </span><a href="#local-6989586621684181833"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-606"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatGuard</span><span> </span><a name="local-6989586621684181834"><a href="#local-6989586621684181834"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181834"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-607"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParStmtCtxt</span><span> </span><a name="local-6989586621684181835"><a href="#local-6989586621684181835"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181835"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-608"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TransStmtCtxt</span><span> </span><a name="local-6989586621684181836"><a href="#local-6989586621684181836"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181836"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-609"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181789"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-612"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RContext"><span class="hs-identifier hs-type">RContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsRecFields</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ProtectSig"><span class="hs-identifier hs-type">ProtectSig</span></a><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-617"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#ProtectedSig"><span class="hs-identifier hs-type">ProtectedSig</span></a><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsSplice</span><span> </span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181789"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-621"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a name="local-6989586621684181790"><a href="#local-6989586621684181790"><span class="hs-identifier">rsp</span></a></a><span> </span><a name="local-6989586621684181791"><a href="#local-6989586621684181791"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621684181792"><a href="#local-6989586621684181792"><span class="hs-identifier">pscope</span></a></a><span> </span><a name="local-6989586621684181793"><a href="#local-6989586621684181793"><span class="hs-identifier">lpat</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181794"><a href="#local-6989586621684181794"><span class="hs-identifier">ospan</span></a></a><span> </span><a name="local-6989586621684181795"><a href="#local-6989586621684181795"><span class="hs-identifier">opat</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-622"></a><span>    </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getTypeNode"><span class="hs-identifier hs-var">getTypeNode</span></a><span> </span><a href="#local-6989586621684181793"><span class="hs-identifier hs-var">lpat</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181795"><span class="hs-identifier hs-var">opat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-623"></a><span>      </span><span class="hs-identifier hs-var">WildPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-624"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-625"></a><span>      </span><span class="hs-identifier hs-var">VarPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181813"><a href="#local-6989586621684181813"><span class="hs-identifier">lname</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-626"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#PatternBind"><span class="hs-identifier hs-var">PatternBind</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181813"><span class="hs-identifier hs-var">lname</span></a><span>
</span><a name="line-627"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-628"></a><span>      </span><span class="hs-identifier hs-var">LazyPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181814"><a href="#local-6989586621684181814"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-629"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181814"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-630"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-631"></a><span>      </span><span class="hs-identifier hs-var">AsPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181815"><a href="#local-6989586621684181815"><span class="hs-identifier">lname</span></a></a><span> </span><a name="local-6989586621684181816"><a href="#local-6989586621684181816"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-632"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#PatternBind"><span class="hs-identifier hs-var">PatternBind</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span>
</span><a name="line-633"></a><span>                                 </span><span class="hs-special">(</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><a href="#local-6989586621684181816"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>                                 </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>                    </span><a href="#local-6989586621684181815"><span class="hs-identifier hs-var">lname</span></a><span>
</span><a name="line-636"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181816"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-637"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-638"></a><span>      </span><span class="hs-identifier hs-var">ParPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181817"><a href="#local-6989586621684181817"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-639"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181817"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-640"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-641"></a><span>      </span><span class="hs-identifier hs-var">BangPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181818"><a href="#local-6989586621684181818"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-642"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181818"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-643"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-644"></a><span>      </span><span class="hs-identifier hs-var">ListPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181819"><a href="#local-6989586621684181819"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-645"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#patScopes"><span class="hs-identifier hs-var">patScopes</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181819"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-646"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-647"></a><span>      </span><span class="hs-identifier hs-var">TuplePat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181820"><a href="#local-6989586621684181820"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-648"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#patScopes"><span class="hs-identifier hs-var">patScopes</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181820"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-649"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-650"></a><span>      </span><span class="hs-identifier hs-var">SumPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181821"><a href="#local-6989586621684181821"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-651"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181821"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-652"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-653"></a><span>      </span><span class="hs-identifier hs-var">ConPatIn</span><span> </span><a name="local-6989586621684181822"><a href="#local-6989586621684181822"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684181823"><a href="#local-6989586621684181823"><span class="hs-identifier">dets</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-654"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181822"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-655"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684181796"><span class="hs-identifier hs-var">contextify</span></a><span> </span><a href="#local-6989586621684181823"><span class="hs-identifier hs-var">dets</span></a><span>
</span><a name="line-656"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-657"></a><span>      </span><span class="hs-identifier hs-var">ConPatOut</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181824"><a href="#local-6989586621684181824"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181825"><a href="#local-6989586621684181825"><span class="hs-identifier">dets</span></a></a><span class="hs-special">}</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-658"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">conLikeName</span><span> </span><a href="#local-6989586621684181824"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-659"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684181796"><span class="hs-identifier hs-var">contextify</span></a><span> </span><a href="#local-6989586621684181825"><span class="hs-identifier hs-var">dets</span></a><span>
</span><a name="line-660"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-661"></a><span>      </span><span class="hs-identifier hs-var">ViewPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181826"><a href="#local-6989586621684181826"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621684181827"><a href="#local-6989586621684181827"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-662"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181826"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-663"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181827"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-664"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-665"></a><span>      </span><span class="hs-identifier hs-var">SplicePat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181828"><a href="#local-6989586621684181828"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-666"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181794"><span class="hs-identifier hs-var">ospan</span></a><span> </span><a href="#local-6989586621684181828"><span class="hs-identifier hs-var">sp</span></a><span>
</span><a name="line-667"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-668"></a><span>      </span><span class="hs-identifier hs-var">LitPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-669"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-670"></a><span>      </span><span class="hs-identifier hs-var">NPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-671"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span>      </span><span class="hs-identifier hs-var">NPlusKPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181829"><a href="#local-6989586621684181829"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-673"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#PatternBind"><span class="hs-identifier hs-var">PatternBind</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181829"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-674"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-675"></a><span>      </span><span class="hs-identifier hs-var">SigPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181830"><a href="#local-6989586621684181830"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181831"><a href="#local-6989586621684181831"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-676"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181830"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-677"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181832"><a href="#local-6989586621684181832"><span class="hs-identifier">cscope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dL</span><span> </span><a href="#local-6989586621684181830"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-678"></a><span>            </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181832"><span class="hs-identifier hs-var">cscope</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span>                       </span><span class="hs-special">(</span><a href="HieAst.html#protectSig"><span class="hs-identifier hs-var">protectSig</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621684181788"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181832"><span class="hs-identifier hs-var">cscope</span></a><span> </span><a href="#local-6989586621684181831"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span>              </span><span class="hs-comment">-- See Note [Scoping Rules for SigPat]</span><span>
</span><a name="line-681"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-682"></a><span>      </span><span class="hs-identifier hs-var">CoPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-683"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-684"></a><span>      </span><span class="hs-identifier hs-var">XPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-685"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-686"></a><span>      </span><a name="local-6989586621684181796"><a href="#local-6989586621684181796"><span class="hs-identifier">contextify</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621684181798"><a href="#local-6989586621684181798"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#patScopes"><span class="hs-identifier hs-var">patScopes</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181798"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-687"></a><span>      </span><span class="hs-identifier">contextify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621684181799"><a href="#local-6989586621684181799"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181800"><a href="#local-6989586621684181800"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a href="#local-6989586621684181801"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621684181802"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-688"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">[</span><a name="local-6989586621684181801"><a href="#local-6989586621684181801"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621684181802"><a href="#local-6989586621684181802"><span class="hs-identifier">b'</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#patScopes"><span class="hs-identifier hs-var">patScopes</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181799"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621684181800"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-689"></a><span>      </span><span class="hs-identifier">contextify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621684181803"><a href="#local-6989586621684181803"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">RecCon</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="HieTypes.html#RecFieldMatch"><span class="hs-identifier hs-var">RecFieldMatch</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684181797"><span class="hs-identifier hs-var">contextify_rec</span></a><span> </span><a href="#local-6989586621684181803"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-690"></a><span>      </span><a name="local-6989586621684181797"><a href="#local-6989586621684181797"><span class="hs-identifier">contextify_rec</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><a name="local-6989586621684181804"><a href="#local-6989586621684181804"><span class="hs-identifier">fds</span></a></a><span> </span><a name="local-6989586621684181805"><a href="#local-6989586621684181805"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621684181806"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621684181807"><span class="hs-identifier hs-var">scoped_fds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181805"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-691"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-692"></a><span>          </span><a name="local-6989586621684181806"><a href="#local-6989586621684181806"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181808"><a href="#local-6989586621684181808"><span class="hs-identifier">fscope</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181809"><a href="#local-6989586621684181809"><span class="hs-identifier">spn</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecField</span><span> </span><a name="local-6989586621684181810"><a href="#local-6989586621684181810"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621684181811"><a href="#local-6989586621684181811"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181812"><a href="#local-6989586621684181812"><span class="hs-identifier">pun</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-693"></a><span>            </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181809"><span class="hs-identifier hs-var">spn</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">HsRecField</span><span> </span><a href="#local-6989586621684181810"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><a href="#local-6989586621684181790"><span class="hs-identifier hs-var">rsp</span></a><span> </span><a href="#local-6989586621684181791"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181808"><span class="hs-identifier hs-var">fscope</span></a><span> </span><a href="#local-6989586621684181811"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181812"><span class="hs-identifier hs-var">pun</span></a><span>
</span><a name="line-694"></a><span>          </span><a name="local-6989586621684181807"><a href="#local-6989586621684181807"><span class="hs-identifier">scoped_fds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="#local-6989586621684181792"><span class="hs-identifier hs-var">pscope</span></a><span> </span><a href="#local-6989586621684181804"><span class="hs-identifier hs-var">fds</span></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181783"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-697"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><a href="#local-6989586621684181784"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181783"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsLocalBinds</span><span> </span><a href="#local-6989586621684181784"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GRHSs</span><span> </span><a href="#local-6989586621684181784"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181783"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-700"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181785"><a href="#local-6989586621684181785"><span class="hs-identifier">grhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181785"><span class="hs-identifier hs-var">grhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-701"></a><span>    </span><span class="hs-identifier hs-var">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181786"><a href="#local-6989586621684181786"><span class="hs-identifier">grhss</span></a></a><span> </span><a name="local-6989586621684181787"><a href="#local-6989586621684181787"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-702"></a><span>     </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181786"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-703"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#grhss_span"><span class="hs-identifier hs-var">grhss_span</span></a><span> </span><a href="#local-6989586621684181785"><span class="hs-identifier hs-var">grhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181787"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-704"></a><span>     </span><span class="hs-special">]</span><span>
</span><a name="line-705"></a><span>    </span><span class="hs-identifier hs-var">XGRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-706"></a><span>
</span><a name="line-707"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181777"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GuardLStmt</span><span> </span><a href="#local-6989586621684181778"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GRHS</span><span> </span><a href="#local-6989586621684181778"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181777"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><a href="#local-6989586621684181778"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181777"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181779"><a href="#local-6989586621684181779"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181780"><a href="#local-6989586621684181780"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181780"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621684181779"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181780"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-712"></a><span>    </span><span class="hs-identifier hs-var">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181781"><a href="#local-6989586621684181781"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621684181782"><a href="#local-6989586621684181782"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-713"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181782"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181781"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-714"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181782"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-715"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-716"></a><span>    </span><span class="hs-identifier hs-var">XGRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181711"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-719"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdP</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-720"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasType"><span class="hs-identifier hs-type">HasType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-721"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MatchGroup</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-723"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LGRHS</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RContext"><span class="hs-identifier hs-type">RContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsRecordBinds</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AmbiguousFieldOcc</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ArithSeqInfo</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsCmdTop</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GuardLStmt</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsLocalBinds</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsWcType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NoGhcTc</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsSigWcType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NoGhcTc</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-732"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-733"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsSplice</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-734"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsTupArg</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-735"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AmbiguousFieldOcc</span><span> </span><a href="#local-6989586621684181710"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181711"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-737"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181712"><a href="#local-6989586621684181712"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181713"><a href="#local-6989586621684181713"><span class="hs-identifier">mspan</span></a></a><span> </span><a name="local-6989586621684181714"><a href="#local-6989586621684181714"><span class="hs-identifier">oexpr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getTypeNode"><span class="hs-identifier hs-var">getTypeNode</span></a><span> </span><a href="#local-6989586621684181712"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181714"><span class="hs-identifier hs-var">oexpr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-738"></a><span>      </span><span class="hs-identifier hs-var">HsVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181715"><a href="#local-6989586621684181715"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-739"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181713"><span class="hs-identifier hs-var">mspan</span></a><span> </span><a href="#local-6989586621684181715"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-740"></a><span>             </span><span class="hs-comment">-- Patch up var location since typechecker removes it</span><span>
</span><a name="line-741"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-742"></a><span>      </span><span class="hs-identifier hs-var">HsUnboundVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-743"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-744"></a><span>      </span><span class="hs-identifier hs-var">HsConLikeOut</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181716"><a href="#local-6989586621684181716"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-745"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181713"><span class="hs-identifier hs-var">mspan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conLikeName</span><span> </span><a href="#local-6989586621684181716"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-746"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-747"></a><span>      </span><span class="hs-identifier hs-var">HsRecFld</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181717"><a href="#local-6989586621684181717"><span class="hs-identifier">fld</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-748"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a href="HieTypes.html#RecFieldOcc"><span class="hs-identifier hs-var">RecFieldOcc</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181713"><span class="hs-identifier hs-var">mspan</span></a><span> </span><a href="#local-6989586621684181717"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-750"></a><span>      </span><span class="hs-identifier hs-var">HsOverLabel</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-751"></a><span>      </span><span class="hs-identifier hs-var">HsIPVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-752"></a><span>      </span><span class="hs-identifier hs-var">HsOverLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-753"></a><span>      </span><span class="hs-identifier hs-var">HsLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-754"></a><span>      </span><span class="hs-identifier hs-var">HsLam</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181718"><a href="#local-6989586621684181718"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-755"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181718"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-756"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-757"></a><span>      </span><span class="hs-identifier hs-var">HsLamCase</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181719"><a href="#local-6989586621684181719"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-758"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181719"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-759"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-760"></a><span>      </span><span class="hs-identifier hs-var">HsApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181720"><a href="#local-6989586621684181720"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181721"><a href="#local-6989586621684181721"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-761"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181720"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-762"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181721"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-763"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-764"></a><span>      </span><span class="hs-identifier hs-var">HsAppType</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181722"><a href="#local-6989586621684181722"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621684181723"><a href="#local-6989586621684181723"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-765"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181722"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-766"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181723"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-767"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-768"></a><span>      </span><span class="hs-identifier hs-var">OpApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181724"><a href="#local-6989586621684181724"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181725"><a href="#local-6989586621684181725"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181726"><a href="#local-6989586621684181726"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-769"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181724"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-770"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181725"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-771"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181726"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-772"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-773"></a><span>      </span><span class="hs-identifier hs-var">NegApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181727"><a href="#local-6989586621684181727"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-774"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181727"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-775"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-776"></a><span>      </span><span class="hs-identifier hs-var">HsPar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181728"><a href="#local-6989586621684181728"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-777"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181728"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-778"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-779"></a><span>      </span><span class="hs-identifier hs-var">SectionL</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181729"><a href="#local-6989586621684181729"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181730"><a href="#local-6989586621684181730"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-780"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181729"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-781"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181730"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-782"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-783"></a><span>      </span><span class="hs-identifier hs-var">SectionR</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181731"><a href="#local-6989586621684181731"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181732"><a href="#local-6989586621684181732"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-784"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181731"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-785"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181732"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-786"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-787"></a><span>      </span><span class="hs-identifier hs-var">ExplicitTuple</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181733"><a href="#local-6989586621684181733"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-788"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181733"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-789"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-790"></a><span>      </span><span class="hs-identifier hs-var">ExplicitSum</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181734"><a href="#local-6989586621684181734"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-791"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181734"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-792"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-793"></a><span>      </span><span class="hs-identifier hs-var">HsCase</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181735"><a href="#local-6989586621684181735"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621684181736"><a href="#local-6989586621684181736"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-794"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181735"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-795"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181736"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-796"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-797"></a><span>      </span><span class="hs-identifier hs-var">HsIf</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181737"><a href="#local-6989586621684181737"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181738"><a href="#local-6989586621684181738"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181739"><a href="#local-6989586621684181739"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-798"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181737"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-799"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181738"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-800"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181739"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-801"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-802"></a><span>      </span><span class="hs-identifier hs-var">HsMultiIf</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181740"><a href="#local-6989586621684181740"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-803"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181740"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-804"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-805"></a><span>      </span><span class="hs-identifier hs-var">HsLet</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181741"><a href="#local-6989586621684181741"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621684181742"><a href="#local-6989586621684181742"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-806"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181742"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181741"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-807"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181742"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-808"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-809"></a><span>      </span><span class="hs-identifier hs-var">HsDo</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181743"><a href="#local-6989586621684181743"><span class="hs-identifier">ispan</span></a></a><span> </span><a name="local-6989586621684181744"><a href="#local-6989586621684181744"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-810"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181743"><span class="hs-identifier hs-var">ispan</span></a><span>
</span><a name="line-811"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181744"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-812"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-813"></a><span>      </span><span class="hs-identifier hs-var">ExplicitList</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181745"><a href="#local-6989586621684181745"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-814"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181745"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-815"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-816"></a><span>      </span><span class="hs-identifier hs-var">RecordCon</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">rcon_con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181746"><a href="#local-6989586621684181746"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181747"><a href="#local-6989586621684181747"><span class="hs-identifier">binds</span></a></a><span class="hs-special">}</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-817"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181746"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-818"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="HieTypes.html#RecFieldAssign"><span class="hs-identifier hs-var">RecFieldAssign</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684181747"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-819"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-820"></a><span>      </span><span class="hs-identifier hs-var">RecordUpd</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181748"><a href="#local-6989586621684181748"><span class="hs-identifier">expr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181749"><a href="#local-6989586621684181749"><span class="hs-identifier">upds</span></a></a><span class="hs-special">}</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-821"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181748"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-822"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="HieTypes.html#RecFieldAssign"><span class="hs-identifier hs-var">RecFieldAssign</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181749"><span class="hs-identifier hs-var">upds</span></a><span>
</span><a name="line-823"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-824"></a><span>      </span><span class="hs-identifier hs-var">ExprWithTySig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181750"><a href="#local-6989586621684181750"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621684181751"><a href="#local-6989586621684181751"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-825"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181750"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-826"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181750"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181751"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-827"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-828"></a><span>      </span><span class="hs-identifier hs-var">ArithSeq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181752"><a href="#local-6989586621684181752"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-829"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181752"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-830"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-831"></a><span>      </span><span class="hs-identifier hs-var">HsSCC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181753"><a href="#local-6989586621684181753"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-832"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181753"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-833"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-834"></a><span>      </span><span class="hs-identifier hs-var">HsCoreAnn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181754"><a href="#local-6989586621684181754"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-835"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181754"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-836"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-837"></a><span>      </span><span class="hs-identifier hs-var">HsProc</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181755"><a href="#local-6989586621684181755"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181756"><a href="#local-6989586621684181756"><span class="hs-identifier">cmdtop</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-838"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181756"><span class="hs-identifier hs-var">cmdtop</span></a><span class="hs-special">)</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181755"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-839"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181756"><span class="hs-identifier hs-var">cmdtop</span></a><span>
</span><a name="line-840"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-841"></a><span>      </span><span class="hs-identifier hs-var">HsStatic</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181757"><a href="#local-6989586621684181757"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-842"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181757"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-843"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-844"></a><span>      </span><span class="hs-identifier hs-var">HsArrApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181758"><a href="#local-6989586621684181758"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181759"><a href="#local-6989586621684181759"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-845"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181758"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-846"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181759"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-847"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-848"></a><span>      </span><span class="hs-identifier hs-var">HsArrForm</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181760"><a href="#local-6989586621684181760"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181761"><a href="#local-6989586621684181761"><span class="hs-identifier">cmds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-849"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181760"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-850"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181761"><span class="hs-identifier hs-var">cmds</span></a><span>
</span><a name="line-851"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-852"></a><span>      </span><span class="hs-identifier hs-var">HsTick</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181762"><a href="#local-6989586621684181762"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-853"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181762"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-854"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-855"></a><span>      </span><span class="hs-identifier hs-var">HsBinTick</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181763"><a href="#local-6989586621684181763"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-856"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181763"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-857"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-858"></a><span>      </span><span class="hs-identifier hs-var">HsTickPragma</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181764"><a href="#local-6989586621684181764"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-859"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181764"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-860"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-861"></a><span>      </span><span class="hs-identifier hs-var">HsWrap</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181765"><a href="#local-6989586621684181765"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-862"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181713"><span class="hs-identifier hs-var">mspan</span></a><span> </span><a href="#local-6989586621684181765"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-863"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-864"></a><span>      </span><span class="hs-identifier hs-var">HsBracket</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181766"><a href="#local-6989586621684181766"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-865"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181766"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-866"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-867"></a><span>      </span><span class="hs-identifier hs-var">HsRnBracketOut</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181767"><a href="#local-6989586621684181767"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181768"><a href="#local-6989586621684181768"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-868"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181767"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-869"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181768"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-870"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-871"></a><span>      </span><span class="hs-identifier hs-var">HsTcBracketOut</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181769"><a href="#local-6989586621684181769"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181770"><a href="#local-6989586621684181770"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-872"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181769"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-873"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181770"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-874"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-875"></a><span>      </span><span class="hs-identifier hs-var">HsSpliceE</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181771"><a href="#local-6989586621684181771"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-876"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181713"><span class="hs-identifier hs-var">mspan</span></a><span> </span><a href="#local-6989586621684181771"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-877"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-878"></a><span>      </span><span class="hs-identifier hs-var">EWildPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-879"></a><span>      </span><span class="hs-identifier hs-var">EAsPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181772"><a href="#local-6989586621684181772"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181773"><a href="#local-6989586621684181773"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-880"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181772"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-881"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181773"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-882"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-883"></a><span>      </span><span class="hs-identifier hs-var">EViewPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181774"><a href="#local-6989586621684181774"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181775"><a href="#local-6989586621684181775"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-884"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181774"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-885"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181775"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-886"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-887"></a><span>      </span><span class="hs-identifier hs-var">ELazyPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181776"><a href="#local-6989586621684181776"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-888"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181776"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-889"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-890"></a><span>      </span><span class="hs-identifier hs-var">XExpr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181706"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-893"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181705"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-894"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsTupArg</span><span> </span><a href="#local-6989586621684181705"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsTupArg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181706"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-896"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181707"><a href="#local-6989586621684181707"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181708"><a href="#local-6989586621684181708"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181708"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-6989586621684181707"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181708"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-897"></a><span>    </span><span class="hs-identifier hs-var">Present</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181709"><a href="#local-6989586621684181709"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-898"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181709"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-899"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-900"></a><span>    </span><span class="hs-identifier hs-var">Missing</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-901"></a><span>    </span><span class="hs-identifier hs-var">XTupArg</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-902"></a><span>
</span><a name="line-903"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181688"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-904"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-906"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsLocalBinds</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ApplicativeArg</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-909"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181689"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span>
</span><a name="line-910"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StmtLR</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181689"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-911"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StmtLR</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><a href="#local-6989586621684181687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-912"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LStmt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181688"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181689"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-913"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181690"><a href="#local-6989586621684181690"><span class="hs-identifier">scope</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181691"><a href="#local-6989586621684181691"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181692"><a href="#local-6989586621684181692"><span class="hs-identifier">stmt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181692"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621684181691"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181692"><span class="hs-identifier hs-var">stmt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-914"></a><span>      </span><span class="hs-identifier hs-var">LastStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181693"><a href="#local-6989586621684181693"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-915"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181693"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-916"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-917"></a><span>      </span><span class="hs-identifier hs-var">BindStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181694"><a href="#local-6989586621684181694"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181695"><a href="#local-6989586621684181695"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-918"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684181695"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181690"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181694"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-919"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181695"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-920"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-921"></a><span>      </span><span class="hs-identifier hs-var">ApplicativeStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181696"><a href="#local-6989586621684181696"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-922"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684181690"><span class="hs-identifier hs-var">scope</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181696"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-923"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-924"></a><span>      </span><span class="hs-identifier hs-var">BodyStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181697"><a href="#local-6989586621684181697"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-925"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181697"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-926"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-927"></a><span>      </span><span class="hs-identifier hs-var">LetStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181698"><a href="#local-6989586621684181698"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-928"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684181690"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181698"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-929"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-930"></a><span>      </span><span class="hs-identifier hs-var">ParStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181699"><a href="#local-6989586621684181699"><span class="hs-identifier">parstmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-931"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ParStmtBlock</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181700"><a href="#local-6989586621684181700"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-932"></a><span>                          </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181700"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-933"></a><span>                     </span><a href="#local-6989586621684181699"><span class="hs-identifier hs-var">parstmts</span></a><span>
</span><a name="line-934"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-935"></a><span>      </span><span class="hs-identifier hs-var">TransStmt</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181701"><a href="#local-6989586621684181701"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181702"><a href="#local-6989586621684181702"><span class="hs-identifier">using</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181703"><a href="#local-6989586621684181703"><span class="hs-identifier">by</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-936"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="#local-6989586621684181690"><span class="hs-identifier hs-var">scope</span></a><span> </span><a href="#local-6989586621684181701"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-937"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181702"><span class="hs-identifier hs-var">using</span></a><span>
</span><a name="line-938"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181703"><span class="hs-identifier hs-var">by</span></a><span>
</span><a name="line-939"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-940"></a><span>      </span><span class="hs-identifier hs-var">RecStmt</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181704"><a href="#local-6989586621684181704"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-941"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181690"><span class="hs-identifier hs-var">scope</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181691"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181704"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-942"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-943"></a><span>      </span><span class="hs-identifier hs-var">XStmtLR</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-944"></a><span>
</span><a name="line-945"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-946"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-947"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BindContext"><span class="hs-identifier hs-type">BindContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-948"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsValBindsLR</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-950"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLocalBinds</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsLocalBinds</span><span> </span><a href="#local-6989586621684181682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-952"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181683"><a href="#local-6989586621684181683"><span class="hs-identifier">scope</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181684"><a href="#local-6989586621684181684"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621684181685"><a href="#local-6989586621684181685"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181685"><span class="hs-identifier hs-var">binds</span></a><span> </span><a href="#local-6989586621684181684"><span class="hs-identifier hs-var">sp</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181685"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-953"></a><span>      </span><span class="hs-identifier hs-var">EmptyLocalBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-954"></a><span>      </span><span class="hs-identifier hs-var">HsIPBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-955"></a><span>      </span><span class="hs-identifier hs-var">HsValBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181686"><a href="#local-6989586621684181686"><span class="hs-identifier">valBinds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-956"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181683"><span class="hs-identifier hs-var">scope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181684"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span>
</span><a name="line-957"></a><span>                      </span><a href="#local-6989586621684181686"><span class="hs-identifier hs-var">valBinds</span></a><span>
</span><a name="line-958"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-959"></a><span>      </span><span class="hs-identifier hs-var">XHsLocalBindsLR</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-960"></a><span>
</span><a name="line-961"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BindContext"><span class="hs-identifier hs-type">BindContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-963"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">XXValBindsLR</span><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-964"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsValBindsLR</span><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-965"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181677"><a href="#local-6989586621684181677"><span class="hs-identifier">sc</span></a></a><span> </span><a name="local-6989586621684181678"><a href="#local-6989586621684181678"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181678"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-966"></a><span>    </span><span class="hs-identifier hs-var">ValBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181679"><a href="#local-6989586621684181679"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621684181680"><a href="#local-6989586621684181680"><span class="hs-identifier">sigs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-967"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="#local-6989586621684181677"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181679"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-968"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a href="HieAst.html#BindSig"><span class="hs-identifier hs-var">BindSig</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181680"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-969"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-970"></a><span>    </span><span class="hs-identifier hs-var">XValBindsLR</span><span> </span><a name="local-6989586621684181681"><a href="#local-6989586621684181681"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684181677"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181681"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NHsValBindsLR</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-973"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181673"><a href="#local-6989586621684181673"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NValBinds</span><span> </span><a name="local-6989586621684181674"><a href="#local-6989586621684181674"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621684181675"><a href="#local-6989586621684181675"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-974"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="#local-6989586621684181673"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181674"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-975"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a href="HieAst.html#BindSig"><span class="hs-identifier hs-var">BindSig</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181675"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-976"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-977"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NHsValBindsLR</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-978"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181670"><a href="#local-6989586621684181670"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NValBinds</span><span> </span><a name="local-6989586621684181671"><a href="#local-6989586621684181671"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621684181672"><a href="#local-6989586621684181672"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-979"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="#local-6989586621684181670"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">bagToList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181671"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a href="HieAst.html#BindSig"><span class="hs-identifier hs-var">BindSig</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181672"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-981"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-982"></a><span>
</span><a name="line-983"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RContext"><span class="hs-identifier hs-type">RContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsRecField</span><span> </span><a href="#local-6989586621684181666"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181667"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-984"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RContext"><span class="hs-identifier hs-type">RContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsRecFields</span><span> </span><a href="#local-6989586621684181666"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181667"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-985"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a name="local-6989586621684181668"><a href="#local-6989586621684181668"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRecFields</span><span> </span><a name="local-6989586621684181669"><a href="#local-6989586621684181669"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="#local-6989586621684181668"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181669"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-986"></a><span>
</span><a name="line-987"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-keyword">label</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-988"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181660"><span class="hs-identifier hs-type">arg</span></a><span>
</span><a name="line-989"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181660"><span class="hs-identifier hs-type">arg</span></a><span>
</span><a name="line-990"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-keyword">label</span><span>
</span><a name="line-991"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621684181660"><span class="hs-identifier hs-type">arg</span></a><span>
</span><a name="line-992"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RContext"><span class="hs-identifier hs-type">RContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsRecField'</span><span> </span><span class="hs-keyword">label</span><span> </span><a href="#local-6989586621684181660"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-993"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a name="local-6989586621684181661"><a href="#local-6989586621684181661"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181662"><a href="#local-6989586621684181662"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181663"><a href="#local-6989586621684181663"><span class="hs-identifier">recfld</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181663"><span class="hs-identifier hs-var">recfld</span></a><span> </span><a href="#local-6989586621684181662"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181663"><span class="hs-identifier hs-var">recfld</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-994"></a><span>    </span><span class="hs-identifier hs-var">HsRecField</span><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621684181665"><a href="#local-6989586621684181665"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-995"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a href="#local-6989586621684181661"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181665"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">label</span><span>
</span><a name="line-996"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181665"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-997"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-998"></a><span>
</span><a name="line-999"></a><span class="hs-identifier">removeDefSrcSpan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1000"></a><a name="removeDefSrcSpan"><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier">removeDefSrcSpan</span></a></a><span> </span><a name="local-6989586621684182070"><a href="#local-6989586621684182070"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">setNameLoc</span><span> </span><a href="#local-6989586621684182070"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">noSrcSpan</span><span>
</span><a name="line-1001"></a><span>
</span><a name="line-1002"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFieldOcc</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1003"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a name="local-6989586621684181654"><a href="#local-6989586621684181654"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684181655"><a href="#local-6989586621684181655"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181656"><a href="#local-6989586621684181656"><span class="hs-identifier">nspan</span></a></a><span> </span><a name="local-6989586621684181657"><a href="#local-6989586621684181657"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181657"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1004"></a><span>    </span><span class="hs-identifier hs-var">FieldOcc</span><span> </span><a name="local-6989586621684181658"><a href="#local-6989586621684181658"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1005"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="#local-6989586621684181654"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181655"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181656"><span class="hs-identifier hs-var">nspan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier hs-var">removeDefSrcSpan</span></a><span> </span><a href="#local-6989586621684181658"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1006"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1007"></a><span>    </span><span class="hs-identifier hs-var">XFieldOcc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFieldOcc</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1010"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a name="local-6989586621684181648"><a href="#local-6989586621684181648"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684181649"><a href="#local-6989586621684181649"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181650"><a href="#local-6989586621684181650"><span class="hs-identifier">nspan</span></a></a><span> </span><a name="local-6989586621684181651"><a href="#local-6989586621684181651"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181651"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1011"></a><span>    </span><span class="hs-identifier hs-var">FieldOcc</span><span> </span><a name="local-6989586621684181652"><a href="#local-6989586621684181652"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1012"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181653"><a href="#local-6989586621684181653"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">setVarName</span><span> </span><a href="#local-6989586621684181652"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier hs-var">removeDefSrcSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181652"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-1013"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="#local-6989586621684181648"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181649"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181650"><span class="hs-identifier hs-var">nspan</span></a><span> </span><a href="#local-6989586621684181653"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1014"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-1015"></a><span>    </span><span class="hs-identifier hs-var">XFieldOcc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AmbiguousFieldOcc</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1018"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a name="local-6989586621684181642"><a href="#local-6989586621684181642"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684181643"><a href="#local-6989586621684181643"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181644"><a href="#local-6989586621684181644"><span class="hs-identifier">nspan</span></a></a><span> </span><a name="local-6989586621684181645"><a href="#local-6989586621684181645"><span class="hs-identifier">afo</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181645"><span class="hs-identifier hs-var">afo</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1019"></a><span>    </span><span class="hs-identifier hs-var">Unambiguous</span><span> </span><a name="local-6989586621684181646"><a href="#local-6989586621684181646"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1020"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="#local-6989586621684181642"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181643"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181644"><span class="hs-identifier hs-var">nspan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier hs-var">removeDefSrcSpan</span></a><span> </span><a href="#local-6989586621684181646"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1021"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1022"></a><span>    </span><span class="hs-identifier hs-var">Ambiguous</span><span> </span><a name="local-6989586621684181647"><a href="#local-6989586621684181647"><span class="hs-identifier">_name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1023"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1024"></a><span>    </span><span class="hs-identifier hs-var">XAmbiguousFieldOcc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1025"></a><span>
</span><a name="line-1026"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFContext"><span class="hs-identifier hs-type">RFContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AmbiguousFieldOcc</span><span> </span><span class="hs-identifier hs-type">GhcTc</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1027"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a name="local-6989586621684181634"><a href="#local-6989586621684181634"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621684181635"><a href="#local-6989586621684181635"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181636"><a href="#local-6989586621684181636"><span class="hs-identifier">nspan</span></a></a><span> </span><a name="local-6989586621684181637"><a href="#local-6989586621684181637"><span class="hs-identifier">afo</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181637"><span class="hs-identifier hs-var">afo</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1028"></a><span>    </span><span class="hs-identifier hs-var">Unambiguous</span><span> </span><a name="local-6989586621684181638"><a href="#local-6989586621684181638"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1029"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181639"><a href="#local-6989586621684181639"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">setVarName</span><span> </span><a href="#local-6989586621684181638"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier hs-var">removeDefSrcSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181638"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-1030"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="#local-6989586621684181634"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181635"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181636"><span class="hs-identifier hs-var">nspan</span></a><span> </span><a href="#local-6989586621684181639"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1031"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-1032"></a><span>    </span><span class="hs-identifier hs-var">Ambiguous</span><span> </span><a name="local-6989586621684181640"><a href="#local-6989586621684181640"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1033"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684181641"><a href="#local-6989586621684181641"><span class="hs-identifier">var'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">setVarName</span><span> </span><a href="#local-6989586621684181640"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#removeDefSrcSpan"><span class="hs-identifier hs-var">removeDefSrcSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621684181640"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="#local-6989586621684181634"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181635"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181636"><span class="hs-identifier hs-var">nspan</span></a><span> </span><a href="#local-6989586621684181641"><span class="hs-identifier hs-var">var'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1035"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-1036"></a><span>    </span><span class="hs-identifier hs-var">XAmbiguousFieldOcc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1037"></a><span>
</span><a name="line-1038"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181627"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-1039"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1040"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BindContext"><span class="hs-identifier hs-type">BindContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1041"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1042"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1043"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsValBindsLR</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1044"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StmtLR</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1045"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLocalBinds</span><span> </span><a href="#local-6989586621684181626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1046"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ApplicativeArg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181627"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1047"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181628"><a href="#local-6989586621684181628"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ApplicativeArgOne</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181629"><a href="#local-6989586621684181629"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181630"><a href="#local-6989586621684181630"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1048"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621684181628"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181629"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1049"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181630"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1050"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1051"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181631"><a href="#local-6989586621684181631"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ApplicativeArgMany</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181632"><a href="#local-6989586621684181632"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181633"><a href="#local-6989586621684181633"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1052"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181632"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1053"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#PS"><span class="hs-identifier hs-var">PS</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621684181631"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181633"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1054"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1055"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XApplicativeArg</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1056"></a><span>
</span><a name="line-1057"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181620"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181621"><span class="hs-identifier hs-type">rec</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsConDetails</span><span> </span><a href="#local-6989586621684181620"><span class="hs-identifier hs-type">arg</span></a><span> </span><a href="#local-6989586621684181621"><span class="hs-identifier hs-type">rec</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1058"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621684181622"><a href="#local-6989586621684181622"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181622"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1059"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621684181623"><a href="#local-6989586621684181623"><span class="hs-identifier">rec</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181623"><span class="hs-identifier hs-var">rec</span></a><span>
</span><a name="line-1060"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621684181624"><a href="#local-6989586621684181624"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181625"><a href="#local-6989586621684181625"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181624"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181625"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsCmd</span><span> </span><a href="#local-6989586621684181616"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1063"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsCmdTop</span><span> </span><a href="#local-6989586621684181616"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsCmdTop</span><span> </span><a href="#local-6989586621684181616"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1065"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181617"><a href="#local-6989586621684181617"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181618"><a href="#local-6989586621684181618"><span class="hs-identifier">top</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181618"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621684181617"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181618"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1066"></a><span>    </span><span class="hs-identifier hs-var">HsCmdTop</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181619"><a href="#local-6989586621684181619"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1067"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181619"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-1068"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1069"></a><span>    </span><span class="hs-identifier hs-var">XCmdTop</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1070"></a><span>
</span><a name="line-1071"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181596"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-1072"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PScoped"><span class="hs-identifier hs-type">PScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LPat</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#BindContext"><span class="hs-identifier hs-type">BindContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsBind</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1074"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1075"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MatchGroup</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsCmd</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1077"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsValBindsLR</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1078"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsCmd</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1079"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsCmdTop</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1080"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StmtLR</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsCmd</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1081"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsLocalBinds</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1082"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StmtLR</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsExpr</span><span> </span><a href="#local-6989586621684181595"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1083"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsCmd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GhcPass</span><span> </span><a href="#local-6989586621684181596"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1084"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181597"><a href="#local-6989586621684181597"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181598"><a href="#local-6989586621684181598"><span class="hs-identifier">cmd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181598"><span class="hs-identifier hs-var">cmd</span></a><span> </span><a href="#local-6989586621684181597"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181598"><span class="hs-identifier hs-var">cmd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1085"></a><span>      </span><span class="hs-identifier hs-var">HsCmdArrApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181599"><a href="#local-6989586621684181599"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181600"><a href="#local-6989586621684181600"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1086"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181599"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1087"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181600"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1088"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1089"></a><span>      </span><span class="hs-identifier hs-var">HsCmdArrForm</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181601"><a href="#local-6989586621684181601"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181602"><a href="#local-6989586621684181602"><span class="hs-identifier">cmdtops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1090"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181601"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1091"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181602"><span class="hs-identifier hs-var">cmdtops</span></a><span>
</span><a name="line-1092"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1093"></a><span>      </span><span class="hs-identifier hs-var">HsCmdApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181603"><a href="#local-6989586621684181603"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181604"><a href="#local-6989586621684181604"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1094"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181603"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1095"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181604"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1096"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1097"></a><span>      </span><span class="hs-identifier hs-var">HsCmdLam</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181605"><a href="#local-6989586621684181605"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1098"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181605"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-1099"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1100"></a><span>      </span><span class="hs-identifier hs-var">HsCmdPar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181606"><a href="#local-6989586621684181606"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1101"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181606"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1102"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1103"></a><span>      </span><span class="hs-identifier hs-var">HsCmdCase</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181607"><a href="#local-6989586621684181607"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621684181608"><a href="#local-6989586621684181608"><span class="hs-identifier">alts</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1104"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181607"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1105"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181608"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-1106"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1107"></a><span>      </span><span class="hs-identifier hs-var">HsCmdIf</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181609"><a href="#local-6989586621684181609"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181610"><a href="#local-6989586621684181610"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181611"><a href="#local-6989586621684181611"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1108"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181609"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1109"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181610"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1110"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181611"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1111"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1112"></a><span>      </span><span class="hs-identifier hs-var">HsCmdLet</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181612"><a href="#local-6989586621684181612"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621684181613"><a href="#local-6989586621684181613"><span class="hs-identifier">cmd'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1113"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181613"><span class="hs-identifier hs-var">cmd'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181612"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1114"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181613"><span class="hs-identifier hs-var">cmd'</span></a><span>
</span><a name="line-1115"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1116"></a><span>      </span><span class="hs-identifier hs-var">HsCmdDo</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181614"><a href="#local-6989586621684181614"><span class="hs-identifier">ispan</span></a></a><span> </span><a name="local-6989586621684181615"><a href="#local-6989586621684181615"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1117"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181614"><span class="hs-identifier hs-var">ispan</span></a><span>
</span><a name="line-1118"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#listScopes"><span class="hs-identifier hs-var">listScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181615"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1119"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1120"></a><span>      </span><span class="hs-identifier hs-var">HsCmdWrap</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1121"></a><span>      </span><span class="hs-identifier hs-var">XCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TyClGroup</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1124"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyClGroup</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181592"><a href="#local-6989586621684181592"><span class="hs-identifier">classes</span></a></a><span> </span><a name="local-6989586621684181593"><a href="#local-6989586621684181593"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621684181594"><a href="#local-6989586621684181594"><span class="hs-identifier">instances</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1125"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181592"><span class="hs-identifier hs-var">classes</span></a><span>
</span><a name="line-1126"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181593"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-1127"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181594"><span class="hs-identifier hs-var">instances</span></a><span>
</span><a name="line-1128"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1129"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XTyClGroup</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1130"></a><span>
</span><a name="line-1131"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LTyClDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1132"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181561"><a href="#local-6989586621684181561"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181562"><a href="#local-6989586621684181562"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181562"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181562"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1133"></a><span>      </span><span class="hs-identifier hs-var">FamDecl</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181563"><a href="#local-6989586621684181563"><span class="hs-identifier">fdecl</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1134"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181563"><span class="hs-identifier hs-var">fdecl</span></a><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1136"></a><span>      </span><span class="hs-identifier hs-var">SynDecl</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181564"><a href="#local-6989586621684181564"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181565"><a href="#local-6989586621684181565"><span class="hs-identifier">vars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181566"><a href="#local-6989586621684181566"><span class="hs-identifier">typ</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1137"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#SynDec"><span class="hs-identifier hs-var">SynDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181564"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1138"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684181566"><span class="hs-identifier hs-var">typ</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181565"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1139"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181566"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1140"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1141"></a><span>      </span><span class="hs-identifier hs-var">DataDecl</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181567"><a href="#local-6989586621684181567"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181568"><a href="#local-6989586621684181568"><span class="hs-identifier">vars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181569"><a href="#local-6989586621684181569"><span class="hs-identifier">defn</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1142"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#DataDec"><span class="hs-identifier hs-var">DataDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181567"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1143"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181570"><span class="hs-identifier hs-var">quant_scope</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684181571"><span class="hs-identifier hs-var">rhs_scope</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181568"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1144"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1145"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1146"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1147"></a><span>          </span><a name="local-6989586621684181570"><a href="#local-6989586621684181570"><span class="hs-identifier">quant_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><a href="#local-6989586621684181569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1148"></a><span>          </span><a name="local-6989586621684181571"><a href="#local-6989586621684181571"><span class="hs-identifier">rhs_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181572"><span class="hs-identifier hs-var">sig_sc</span></a><span> </span><span class="hs-special">`</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684181573"><span class="hs-identifier hs-var">con_sc</span></a><span> </span><span class="hs-special">`</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684181574"><span class="hs-identifier hs-var">deriv_sc</span></a><span>
</span><a name="line-1149"></a><span>          </span><a name="local-6989586621684181572"><a href="#local-6989586621684181572"><span class="hs-identifier">sig_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><a href="#local-6989586621684181569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1150"></a><span>          </span><a name="local-6989586621684181573"><a href="#local-6989586621684181573"><span class="hs-identifier">con_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><a href="#local-6989586621684181569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1151"></a><span>          </span><a name="local-6989586621684181574"><a href="#local-6989586621684181574"><span class="hs-identifier">deriv_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><a href="#local-6989586621684181569"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1152"></a><span>      </span><span class="hs-identifier hs-var">ClassDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdCtxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181575"><a href="#local-6989586621684181575"><span class="hs-identifier">context</span></a></a><span>
</span><a name="line-1153"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181576"><a href="#local-6989586621684181576"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-1154"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181577"><a href="#local-6989586621684181577"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-1155"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFDs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181578"><a href="#local-6989586621684181578"><span class="hs-identifier">deps</span></a></a><span>
</span><a name="line-1156"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdSigs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181579"><a href="#local-6989586621684181579"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-1157"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdMeths</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181580"><a href="#local-6989586621684181580"><span class="hs-identifier">meths</span></a></a><span>
</span><a name="line-1158"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181581"><a href="#local-6989586621684181581"><span class="hs-identifier">typs</span></a></a><span>
</span><a name="line-1159"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATDefs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181582"><a href="#local-6989586621684181582"><span class="hs-identifier">deftyps</span></a></a><span>
</span><a name="line-1160"></a><span>                </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1161"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#ClassDec"><span class="hs-identifier hs-var">ClassDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181576"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1162"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181575"><span class="hs-identifier hs-var">context</span></a><span>
</span><a name="line-1163"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181583"><span class="hs-identifier hs-var">context_scope</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684181584"><span class="hs-identifier hs-var">rhs_scope</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181577"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1164"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181578"><span class="hs-identifier hs-var">deps</span></a><span>
</span><a name="line-1165"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a href="HieAst.html#ClassSig"><span class="hs-identifier hs-var">ClassSig</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181561"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181579"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-1166"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#InstanceBind"><span class="hs-identifier hs-var">InstanceBind</span></a><span> </span><a href="HieTypes.html#ModuleScope"><span class="hs-identifier hs-var">ModuleScope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181580"><span class="hs-identifier hs-var">meths</span></a><span>
</span><a name="line-1167"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181581"><span class="hs-identifier hs-var">typs</span></a><span>
</span><a name="line-1168"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181582"><span class="hs-identifier hs-var">deftyps</span></a><span>
</span><a name="line-1169"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684181585"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181582"><span class="hs-identifier hs-var">deftyps</span></a><span>
</span><a name="line-1170"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1171"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1172"></a><span>          </span><a name="local-6989586621684181583"><a href="#local-6989586621684181583"><span class="hs-identifier">context_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181575"><span class="hs-identifier hs-var">context</span></a><span>
</span><a name="line-1173"></a><span>          </span><a name="local-6989586621684181584"><a href="#local-6989586621684181584"><span class="hs-identifier">rhs_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span>
</span><a name="line-1174"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181578"><span class="hs-identifier hs-var">deps</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181579"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bagToList</span><span> </span><a href="#local-6989586621684181580"><span class="hs-identifier hs-var">meths</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181581"><span class="hs-identifier hs-var">typs</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181582"><span class="hs-identifier hs-var">deftyps</span></a><span class="hs-special">]</span><span>
</span><a name="line-1175"></a><span>
</span><a name="line-1176"></a><span>          </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TyFamDefltEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span>
</span><a name="line-1177"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FamEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span>          </span><a name="local-6989586621684181585"><a href="#local-6989586621684181585"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamEqn</span><span> </span><a name="local-6989586621684181586"><a href="#local-6989586621684181586"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181587"><a href="#local-6989586621684181587"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621684181588"><a href="#local-6989586621684181588"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621684181589"><a href="#local-6989586621684181589"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621684181590"><a href="#local-6989586621684181590"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181591"><a href="#local-6989586621684181591"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1179"></a><span>             </span><span class="hs-identifier hs-var">FamEqn</span><span> </span><a href="#local-6989586621684181586"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621684181587"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621684181588"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181591"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181589"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181590"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621684181591"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1180"></a><span>          </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XFamEqn</span><span> </span><span class="hs-identifier hs-var">NoExt</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">XFamEqn</span><span> </span><span class="hs-identifier hs-var">NoExt</span><span>
</span><a name="line-1181"></a><span>      </span><span class="hs-identifier hs-var">XTyClDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1182"></a><span>
</span><a name="line-1183"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFamilyDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1184"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181551"><a href="#local-6989586621684181551"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181552"><a href="#local-6989586621684181552"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181552"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181551"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181552"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1185"></a><span>      </span><span class="hs-identifier hs-var">FamilyDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181553"><a href="#local-6989586621684181553"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621684181554"><a href="#local-6989586621684181554"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621684181555"><a href="#local-6989586621684181555"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181556"><a href="#local-6989586621684181556"><span class="hs-identifier">sig</span></a></a><span> </span><a name="local-6989586621684181557"><a href="#local-6989586621684181557"><span class="hs-identifier">inj</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1186"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#FamDec"><span class="hs-identifier hs-var">FamDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181551"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181554"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1187"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181558"><span class="hs-identifier hs-var">rhsSpan</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181555"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1188"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181553"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-1189"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a href="#local-6989586621684181560"><span class="hs-identifier hs-var">injSpan</span></a><span> </span><a href="#local-6989586621684181556"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1190"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181557"><span class="hs-identifier hs-var">inj</span></a><span>
</span><a name="line-1191"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1192"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1193"></a><span>          </span><a name="local-6989586621684181558"><a href="#local-6989586621684181558"><span class="hs-identifier">rhsSpan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181559"><span class="hs-identifier hs-var">sigSpan</span></a><span> </span><span class="hs-special">`</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684181560"><span class="hs-identifier hs-var">injSpan</span></a><span>
</span><a name="line-1194"></a><span>          </span><a name="local-6989586621684181559"><a href="#local-6989586621684181559"><span class="hs-identifier">sigSpan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684181556"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1195"></a><span>          </span><a name="local-6989586621684181560"><a href="#local-6989586621684181560"><span class="hs-identifier">injSpan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181557"><span class="hs-identifier hs-var">inj</span></a><span>
</span><a name="line-1196"></a><span>      </span><span class="hs-identifier hs-var">XFamilyDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1197"></a><span>
</span><a name="line-1198"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FamilyInfo</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1199"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ClosedTypeFamily</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684181547"><a href="#local-6989586621684181547"><span class="hs-identifier">eqns</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1200"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181547"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-1201"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621684181548"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621684181547"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-1202"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1203"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1204"></a><span>      </span><a name="local-6989586621684181548"><a href="#local-6989586621684181548"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181549"><a href="#local-6989586621684181549"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621684181550"><a href="#local-6989586621684181550"><span class="hs-identifier">ib</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181549"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181550"><span class="hs-identifier hs-var">ib</span></a><span>
</span><a name="line-1205"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1206"></a><span>
</span><a name="line-1207"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFamilyResultSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1208"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181542"><a href="#local-6989586621684181542"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181543"><a href="#local-6989586621684181543"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181544"><a href="#local-6989586621684181544"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181544"><span class="hs-identifier hs-var">sig</span></a><span> </span><a href="#local-6989586621684181543"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181544"><span class="hs-identifier hs-var">sig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1209"></a><span>      </span><span class="hs-identifier hs-var">NoSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1210"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1211"></a><span>      </span><span class="hs-identifier hs-var">KindSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181545"><a href="#local-6989586621684181545"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1212"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181545"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1213"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1214"></a><span>      </span><span class="hs-identifier hs-var">TyVarSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181546"><a href="#local-6989586621684181546"><span class="hs-identifier">bndr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1215"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TVS"><span class="hs-identifier hs-var">TVS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181542"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181546"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-1216"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1217"></a><span>      </span><span class="hs-identifier hs-var">XFamilyResultSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1218"></a><span>
</span><a name="line-1219"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FunDep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1220"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181538"><a href="#local-6989586621684181538"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181539"><a href="#local-6989586621684181539"><span class="hs-identifier">fd</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621684181540"><a href="#local-6989586621684181540"><span class="hs-identifier">lhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621684181541"><a href="#local-6989586621684181541"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1221"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181539"><span class="hs-identifier hs-var">fd</span></a><span> </span><a href="#local-6989586621684181538"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1222"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181540"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1223"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181541"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1225"></a><span>
</span><a name="line-1226"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181535"><span class="hs-identifier hs-type">pats</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181536"><span class="hs-identifier hs-type">rhs</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181535"><span class="hs-identifier hs-type">pats</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181536"><span class="hs-identifier hs-type">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1227"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FamEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><a href="#local-6989586621684181535"><span class="hs-identifier hs-type">pats</span></a><span> </span><a href="#local-6989586621684181536"><span class="hs-identifier hs-type">rhs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1228"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181537"><a href="#local-6989586621684181537"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181537"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1229"></a><span>
</span><a name="line-1230"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181525"><span class="hs-identifier hs-type">pats</span></a><span>
</span><a name="line-1231"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181526"><span class="hs-identifier hs-type">rhs</span></a><span>
</span><a name="line-1232"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181525"><span class="hs-identifier hs-type">pats</span></a><span>
</span><a name="line-1233"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181526"><span class="hs-identifier hs-type">rhs</span></a><span>
</span><a name="line-1234"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FamEqn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><a href="#local-6989586621684181525"><span class="hs-identifier hs-type">pats</span></a><span> </span><a href="#local-6989586621684181526"><span class="hs-identifier hs-type">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1235"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181527"><a href="#local-6989586621684181527"><span class="hs-identifier">fe</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">FamEqn</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181528"><a href="#local-6989586621684181528"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621684181529"><a href="#local-6989586621684181529"><span class="hs-identifier">tybndrs</span></a></a><span> </span><a name="local-6989586621684181530"><a href="#local-6989586621684181530"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181531"><a href="#local-6989586621684181531"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1236"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#InstDec"><span class="hs-identifier hs-var">InstDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181527"><span class="hs-identifier hs-var">fe</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181528"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1237"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#tvScopes"><span class="hs-identifier hs-var">tvScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181532"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181529"><span class="hs-identifier hs-var">tybndrs</span></a><span>
</span><a name="line-1238"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181530"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1239"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181531"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1240"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1241"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181532"><a href="#local-6989586621684181532"><span class="hs-identifier">scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181533"><span class="hs-identifier hs-var">patsScope</span></a><span> </span><a href="#local-6989586621684181534"><span class="hs-identifier hs-var">rhsScope</span></a><span>
</span><a name="line-1242"></a><span>          </span><a name="local-6989586621684181533"><a href="#local-6989586621684181533"><span class="hs-identifier">patsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181530"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span>
</span><a name="line-1243"></a><span>          </span><a name="local-6989586621684181534"><a href="#local-6989586621684181534"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181531"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1244"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XFamEqn</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1245"></a><span>
</span><a name="line-1246"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LInjectivityAnn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1247"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181521"><a href="#local-6989586621684181521"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181522"><a href="#local-6989586621684181522"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181522"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621684181521"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181522"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1248"></a><span>      </span><span class="hs-identifier hs-var">InjectivityAnn</span><span> </span><a name="local-6989586621684181523"><a href="#local-6989586621684181523"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621684181524"><a href="#local-6989586621684181524"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1249"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181523"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1250"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181524"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1251"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1252"></a><span>
</span><a name="line-1253"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsDataDefn</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1254"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsDataDefn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181517"><a href="#local-6989586621684181517"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181518"><a href="#local-6989586621684181518"><span class="hs-identifier">mkind</span></a></a><span> </span><a name="local-6989586621684181519"><a href="#local-6989586621684181519"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621684181520"><a href="#local-6989586621684181520"><span class="hs-identifier">derivs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1255"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181517"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1256"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181518"><span class="hs-identifier hs-var">mkind</span></a><span>
</span><a name="line-1257"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181519"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1258"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181520"><span class="hs-identifier hs-var">derivs</span></a><span>
</span><a name="line-1259"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1260"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsDataDefn</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1261"></a><span>
</span><a name="line-1262"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsDeriving</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1263"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181515"><a href="#local-6989586621684181515"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181516"><a href="#local-6989586621684181516"><span class="hs-identifier">clauses</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1264"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181515"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1265"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181516"><span class="hs-identifier hs-var">clauses</span></a><span>
</span><a name="line-1266"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1267"></a><span>
</span><a name="line-1268"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsDerivingClause</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1269"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181510"><a href="#local-6989586621684181510"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181511"><a href="#local-6989586621684181511"><span class="hs-identifier">cl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181511"><span class="hs-identifier hs-var">cl</span></a><span> </span><a href="#local-6989586621684181510"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181511"><span class="hs-identifier hs-var">cl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1270"></a><span>      </span><span class="hs-identifier hs-var">HsDerivingClause</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181512"><a href="#local-6989586621684181512"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181513"><a href="#local-6989586621684181513"><span class="hs-identifier">ispan</span></a></a><span> </span><a name="local-6989586621684181514"><a href="#local-6989586621684181514"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1271"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181512"><span class="hs-identifier hs-var">strat</span></a><span>
</span><a name="line-1272"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181513"><span class="hs-identifier hs-var">ispan</span></a><span>
</span><a name="line-1273"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181514"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1274"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1275"></a><span>      </span><span class="hs-identifier hs-var">XHsDerivingClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1276"></a><span>
</span><a name="line-1277"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DerivStrategy</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1278"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181507"><a href="#local-6989586621684181507"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181508"><a href="#local-6989586621684181508"><span class="hs-identifier">strat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181508"><span class="hs-identifier hs-var">strat</span></a><span> </span><a href="#local-6989586621684181507"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181508"><span class="hs-identifier hs-var">strat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1279"></a><span>      </span><span class="hs-identifier hs-var">StockStrategy</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1280"></a><span>      </span><span class="hs-identifier hs-var">AnyclassStrategy</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1281"></a><span>      </span><span class="hs-identifier hs-var">NewtypeStrategy</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1282"></a><span>      </span><span class="hs-identifier hs-var">ViaStrategy</span><span> </span><a name="local-6989586621684181509"><a href="#local-6989586621684181509"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181509"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1283"></a><span>
</span><a name="line-1284"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">OverlapMode</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1285"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181506"><a href="#local-6989586621684181506"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181506"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1286"></a><span>
</span><a name="line-1287"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LConDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1288"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181482"><a href="#local-6989586621684181482"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181483"><a href="#local-6989586621684181483"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181483"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181482"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181483"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1289"></a><span>      </span><span class="hs-identifier hs-var">ConDeclGADT</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_names</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181490"><a href="#local-6989586621684181490"><span class="hs-identifier">names</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_qvars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181491"><a href="#local-6989586621684181491"><span class="hs-identifier">qvars</span></a></a><span>
</span><a name="line-1290"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181492"><a href="#local-6989586621684181492"><span class="hs-identifier">ctx</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181493"><a href="#local-6989586621684181493"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181494"><a href="#local-6989586621684181494"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1291"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#ConDec"><span class="hs-identifier hs-var">ConDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181482"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181490"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1292"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181496"><span class="hs-identifier hs-var">ctxScope</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684181495"><span class="hs-identifier hs-var">rhsScope</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181491"><span class="hs-identifier hs-var">qvars</span></a><span>
</span><a name="line-1293"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181492"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1294"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181493"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1295"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181494"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1296"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1297"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1298"></a><span>          </span><a name="local-6989586621684181495"><a href="#local-6989586621684181495"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181497"><span class="hs-identifier hs-var">argsScope</span></a><span> </span><a href="#local-6989586621684181498"><span class="hs-identifier hs-var">tyScope</span></a><span>
</span><a name="line-1299"></a><span>          </span><a name="local-6989586621684181496"><a href="#local-6989586621684181496"><span class="hs-identifier">ctxScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181492"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1300"></a><span>          </span><a name="local-6989586621684181497"><a href="#local-6989586621684181497"><span class="hs-identifier">argsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181484"><span class="hs-identifier hs-var">condecl_scope</span></a><span> </span><a href="#local-6989586621684181493"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1301"></a><span>          </span><a name="local-6989586621684181498"><a href="#local-6989586621684181498"><span class="hs-identifier">tyScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181494"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1302"></a><span>      </span><span class="hs-identifier hs-var">ConDeclH98</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181499"><a href="#local-6989586621684181499"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181500"><a href="#local-6989586621684181500"><span class="hs-identifier">qvars</span></a></a><span>
</span><a name="line-1303"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181501"><a href="#local-6989586621684181501"><span class="hs-identifier">ctx</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181502"><a href="#local-6989586621684181502"><span class="hs-identifier">dets</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1304"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><a href="HieTypes.html#ConDec"><span class="hs-identifier hs-var">ConDec</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181482"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181499"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1305"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#tvScopes"><span class="hs-identifier hs-var">tvScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181503"><span class="hs-identifier hs-var">rhsScope</span></a><span> </span><a href="#local-6989586621684181500"><span class="hs-identifier hs-var">qvars</span></a><span>
</span><a name="line-1306"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181501"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1307"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181502"><span class="hs-identifier hs-var">dets</span></a><span>
</span><a name="line-1308"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1309"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1310"></a><span>          </span><a name="local-6989586621684181503"><a href="#local-6989586621684181503"><span class="hs-identifier">rhsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="#local-6989586621684181504"><span class="hs-identifier hs-var">ctxScope</span></a><span> </span><a href="#local-6989586621684181505"><span class="hs-identifier hs-var">argsScope</span></a><span>
</span><a name="line-1311"></a><span>          </span><a name="local-6989586621684181504"><a href="#local-6989586621684181504"><span class="hs-identifier">ctxScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181501"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1312"></a><span>          </span><a name="local-6989586621684181505"><a href="#local-6989586621684181505"><span class="hs-identifier">argsScope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181484"><span class="hs-identifier hs-var">condecl_scope</span></a><span> </span><a href="#local-6989586621684181502"><span class="hs-identifier hs-var">dets</span></a><span>
</span><a name="line-1313"></a><span>      </span><span class="hs-identifier hs-var">XConDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1314"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181484"><a href="#local-6989586621684181484"><span class="hs-identifier">condecl_scope</span></a></a><span> </span><a name="local-6989586621684181485"><a href="#local-6989586621684181485"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181485"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1315"></a><span>            </span><span class="hs-identifier hs-var">PrefixCon</span><span> </span><a name="local-6989586621684181486"><a href="#local-6989586621684181486"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181486"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1316"></a><span>            </span><span class="hs-identifier hs-var">InfixCon</span><span> </span><a name="local-6989586621684181487"><a href="#local-6989586621684181487"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181488"><a href="#local-6989586621684181488"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181487"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181488"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1317"></a><span>            </span><span class="hs-identifier hs-var">RecCon</span><span> </span><a name="local-6989586621684181489"><a href="#local-6989586621684181489"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181489"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">LConDeclField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1320"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181480"><a href="#local-6989586621684181480"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181481"><a href="#local-6989586621684181481"><span class="hs-identifier">decls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1321"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181480"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1322"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181481"><span class="hs-identifier hs-var">decls</span></a><span>
</span><a name="line-1323"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1324"></a><span>
</span><a name="line-1325"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181475"><span class="hs-identifier hs-type">thing</span></a><span>
</span><a name="line-1326"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><a href="#local-6989586621684181475"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1327"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsImplicitBndrs</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><a href="#local-6989586621684181475"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1328"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a name="local-6989586621684181476"><a href="#local-6989586621684181476"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsIB</span><span> </span><a name="local-6989586621684181477"><a href="#local-6989586621684181477"><span class="hs-identifier">ibrn</span></a></a><span> </span><a name="local-6989586621684181478"><a href="#local-6989586621684181478"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1329"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#bindingsOnly"><span class="hs-identifier hs-var">bindingsOnly</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#TyVarBind"><span class="hs-identifier hs-var">TyVarBind</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181479"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181476"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181477"><span class="hs-identifier hs-var">ibrn</span></a><span>
</span><a name="line-1330"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a href="#local-6989586621684181476"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181478"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1331"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1332"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181479"><a href="#local-6989586621684181479"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181478"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1333"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsImplicitBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1334"></a><span>
</span><a name="line-1335"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#HasLoc"><span class="hs-identifier hs-type">HasLoc</span></a><span> </span><a href="#local-6989586621684181470"><span class="hs-identifier hs-type">thing</span></a><span>
</span><a name="line-1336"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><a href="#local-6989586621684181470"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1337"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsWildCardBndrs</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span> </span><a href="#local-6989586621684181470"><span class="hs-identifier hs-type">thing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1338"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a name="local-6989586621684181471"><a href="#local-6989586621684181471"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsWC</span><span> </span><a name="local-6989586621684181472"><a href="#local-6989586621684181472"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621684181473"><a href="#local-6989586621684181473"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1339"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#bindingsOnly"><span class="hs-identifier hs-var">bindingsOnly</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#TyVarBind"><span class="hs-identifier hs-var">TyVarBind</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181474"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181471"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181472"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1340"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a href="#local-6989586621684181471"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181473"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1341"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1342"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181474"><a href="#local-6989586621684181474"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181473"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1343"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XHsWildCardBndrs</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SigContext"><span class="hs-identifier hs-type">SigContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1346"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a name="local-6989586621684181449"><a href="#local-6989586621684181449"><span class="hs-identifier">styp</span></a></a><span> </span><a name="local-6989586621684181450"><a href="#local-6989586621684181450"><span class="hs-identifier">msp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181451"><a href="#local-6989586621684181451"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621684181452"><a href="#local-6989586621684181452"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181452"><span class="hs-identifier hs-var">sig</span></a><span> </span><a href="#local-6989586621684181451"><span class="hs-identifier hs-var">sp</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181452"><span class="hs-identifier hs-var">sig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1347"></a><span>      </span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181453"><a href="#local-6989586621684181453"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621684181454"><a href="#local-6989586621684181454"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1348"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#TyDecl"><span class="hs-identifier hs-var">TyDecl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181453"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1349"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#UnresolvedScope"><span class="hs-identifier hs-var">UnresolvedScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621684181453"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181454"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1350"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1351"></a><span>      </span><span class="hs-identifier hs-var">PatSynSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181455"><a href="#local-6989586621684181455"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621684181456"><a href="#local-6989586621684181456"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1352"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#TyDecl"><span class="hs-identifier hs-var">TyDecl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181455"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1353"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#UnresolvedScope"><span class="hs-identifier hs-var">UnresolvedScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621684181455"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181456"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1354"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1355"></a><span>      </span><span class="hs-identifier hs-var">ClassOpSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181457"><a href="#local-6989586621684181457"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621684181458"><a href="#local-6989586621684181458"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1356"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181449"><span class="hs-identifier hs-var">styp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1357"></a><span>            </span><a href="HieAst.html#ClassSig"><span class="hs-identifier hs-var">ClassSig</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#ClassTyDecl"><span class="hs-identifier hs-var">ClassTyDecl</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181451"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181457"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1358"></a><span>            </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#TyDecl"><span class="hs-identifier hs-var">TyDecl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181457"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1359"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#UnresolvedScope"><span class="hs-identifier hs-var">UnresolvedScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">unLoc</span><span> </span><a href="#local-6989586621684181457"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181450"><span class="hs-identifier hs-var">msp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181458"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1360"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1361"></a><span>      </span><span class="hs-identifier hs-var">IdSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1362"></a><span>      </span><span class="hs-identifier hs-var">FixSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181459"><a href="#local-6989586621684181459"><span class="hs-identifier">fsig</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1363"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181451"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-6989586621684181459"><span class="hs-identifier hs-var">fsig</span></a><span>
</span><a name="line-1364"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1365"></a><span>      </span><span class="hs-identifier hs-var">InlineSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181460"><a href="#local-6989586621684181460"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1366"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181460"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1367"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1368"></a><span>      </span><span class="hs-identifier hs-var">SpecSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181461"><a href="#local-6989586621684181461"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621684181462"><a href="#local-6989586621684181462"><span class="hs-identifier">typs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1369"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181461"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1370"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181462"><span class="hs-identifier hs-var">typs</span></a><span>
</span><a name="line-1371"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1372"></a><span>      </span><span class="hs-identifier hs-var">SpecInstSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181463"><a href="#local-6989586621684181463"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1373"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181463"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1374"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1375"></a><span>      </span><span class="hs-identifier hs-var">MinimalSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181464"><a href="#local-6989586621684181464"><span class="hs-identifier">form</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1376"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181464"><span class="hs-identifier hs-var">form</span></a><span>
</span><a name="line-1377"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1378"></a><span>      </span><span class="hs-identifier hs-var">SCCFunSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181465"><a href="#local-6989586621684181465"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621684181466"><a href="#local-6989586621684181466"><span class="hs-identifier">mtxt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1379"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181465"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1380"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181466"><span class="hs-identifier hs-var">mtxt</span></a><span>
</span><a name="line-1381"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1382"></a><span>      </span><span class="hs-identifier hs-var">CompleteMatchSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181467"><a href="#local-6989586621684181467"><span class="hs-identifier">ispan</span></a></a><span> </span><a name="local-6989586621684181468"><a href="#local-6989586621684181468"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684181469"><a href="#local-6989586621684181469"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1383"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181467"><span class="hs-identifier hs-var">ispan</span></a><span>
</span><a name="line-1384"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181468"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1385"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181469"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1386"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1387"></a><span>      </span><span class="hs-identifier hs-var">XSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1388"></a><span>
</span><a name="line-1389"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1390"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><a name="local-6989586621684181448"><a href="#local-6989586621684181448"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181448"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1391"></a><span>
</span><a name="line-1392"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsType</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1393"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a name="local-6989586621684181417"><a href="#local-6989586621684181417"><span class="hs-identifier">tsc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181418"><a href="#local-6989586621684181418"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181419"><a href="#local-6989586621684181419"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181419"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621684181418"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181419"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1394"></a><span>      </span><span class="hs-identifier hs-var">HsForAllTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181420"><a href="#local-6989586621684181420"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621684181421"><a href="#local-6989586621684181421"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1395"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#tvScopes"><span class="hs-identifier hs-var">tvScopes</span></a><span> </span><a href="#local-6989586621684181417"><span class="hs-identifier hs-var">tsc</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684181421"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181420"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1396"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181421"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1397"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1398"></a><span>      </span><span class="hs-identifier hs-var">HsQualTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181422"><a href="#local-6989586621684181422"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621684181423"><a href="#local-6989586621684181423"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1399"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181422"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-1400"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181423"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-1401"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1402"></a><span>      </span><span class="hs-identifier hs-var">HsTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181424"><a href="#local-6989586621684181424"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1403"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181424"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1404"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1405"></a><span>      </span><span class="hs-identifier hs-var">HsAppTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181425"><a href="#local-6989586621684181425"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181426"><a href="#local-6989586621684181426"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1406"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181425"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1407"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181426"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1408"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1409"></a><span>      </span><span class="hs-identifier hs-var">HsAppKindTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181427"><a href="#local-6989586621684181427"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621684181428"><a href="#local-6989586621684181428"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1410"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181427"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1411"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181428"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1412"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1413"></a><span>      </span><span class="hs-identifier hs-var">HsFunTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181429"><a href="#local-6989586621684181429"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181430"><a href="#local-6989586621684181430"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1414"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181429"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1415"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181430"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1416"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1417"></a><span>      </span><span class="hs-identifier hs-var">HsListTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181431"><a href="#local-6989586621684181431"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1418"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181431"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1419"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1420"></a><span>      </span><span class="hs-identifier hs-var">HsTupleTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181432"><a href="#local-6989586621684181432"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1421"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181432"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1422"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1423"></a><span>      </span><span class="hs-identifier hs-var">HsSumTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181433"><a href="#local-6989586621684181433"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1424"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181433"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1425"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1426"></a><span>      </span><span class="hs-identifier hs-var">HsOpTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181434"><a href="#local-6989586621684181434"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181435"><a href="#local-6989586621684181435"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621684181436"><a href="#local-6989586621684181436"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1427"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181434"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1428"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181435"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1429"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181436"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1430"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1431"></a><span>      </span><span class="hs-identifier hs-var">HsParTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181437"><a href="#local-6989586621684181437"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1432"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181437"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1433"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1434"></a><span>      </span><span class="hs-identifier hs-var">HsIParamTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181438"><a href="#local-6989586621684181438"><span class="hs-identifier">ip</span></a></a><span> </span><a name="local-6989586621684181439"><a href="#local-6989586621684181439"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1435"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181438"><span class="hs-identifier hs-var">ip</span></a><span>
</span><a name="line-1436"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181439"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1437"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1438"></a><span>      </span><span class="hs-identifier hs-var">HsKindSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181440"><a href="#local-6989586621684181440"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181441"><a href="#local-6989586621684181441"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1439"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181440"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1440"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181441"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1441"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1442"></a><span>      </span><span class="hs-identifier hs-var">HsSpliceTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181442"><a href="#local-6989586621684181442"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1443"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181418"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181442"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1444"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1445"></a><span>      </span><span class="hs-identifier hs-var">HsDocTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181443"><a href="#local-6989586621684181443"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1446"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181443"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1447"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1448"></a><span>      </span><span class="hs-identifier hs-var">HsBangTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181444"><a href="#local-6989586621684181444"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1449"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181444"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1450"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1451"></a><span>      </span><span class="hs-identifier hs-var">HsRecTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181445"><a href="#local-6989586621684181445"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1452"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181445"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1453"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1454"></a><span>      </span><span class="hs-identifier hs-var">HsExplicitListTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181446"><a href="#local-6989586621684181446"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1455"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181446"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1456"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1457"></a><span>      </span><span class="hs-identifier hs-var">HsExplicitTupleTy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181447"><a href="#local-6989586621684181447"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1458"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181447"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1459"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1460"></a><span>      </span><span class="hs-identifier hs-var">HsTyLit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1461"></a><span>      </span><span class="hs-identifier hs-var">HsWildCardTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1462"></a><span>      </span><span class="hs-identifier hs-var">HsStarTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1463"></a><span>      </span><span class="hs-identifier hs-var">XHsType</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1464"></a><span>
</span><a name="line-1465"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181412"><span class="hs-identifier hs-type">tm</span></a><span class="hs-special">,</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><a href="#local-6989586621684181413"><span class="hs-identifier hs-type">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsArg</span><span> </span><a href="#local-6989586621684181412"><span class="hs-identifier hs-type">tm</span></a><span> </span><a href="#local-6989586621684181413"><span class="hs-identifier hs-type">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1466"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsValArg</span><span> </span><a name="local-6989586621684181414"><a href="#local-6989586621684181414"><span class="hs-identifier">tm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181414"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-1467"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsTypeArg</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181415"><a href="#local-6989586621684181415"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181415"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1468"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsArgPar</span><span> </span><a name="local-6989586621684181416"><a href="#local-6989586621684181416"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181416"><span class="hs-identifier hs-var">sp</span></a><span>
</span><a name="line-1469"></a><span>
</span><a name="line-1470"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TVScoped"><span class="hs-identifier hs-type">TVScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsTyVarBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1471"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TVS"><span class="hs-identifier hs-var">TVS</span></a><span> </span><a name="local-6989586621684181405"><a href="#local-6989586621684181405"><span class="hs-identifier">tsc</span></a></a><span> </span><a name="local-6989586621684181406"><a href="#local-6989586621684181406"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181407"><a href="#local-6989586621684181407"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181408"><a href="#local-6989586621684181408"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181408"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="#local-6989586621684181407"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181408"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1472"></a><span>      </span><span class="hs-identifier hs-var">UserTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181409"><a href="#local-6989586621684181409"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1473"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#TyVarBind"><span class="hs-identifier hs-var">TyVarBind</span></a><span> </span><a href="#local-6989586621684181406"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181405"><span class="hs-identifier hs-var">tsc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181409"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1474"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1475"></a><span>      </span><span class="hs-identifier hs-var">KindedTyVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181410"><a href="#local-6989586621684181410"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621684181411"><a href="#local-6989586621684181411"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1476"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#TyVarBind"><span class="hs-identifier hs-var">TyVarBind</span></a><span> </span><a href="#local-6989586621684181406"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-6989586621684181405"><span class="hs-identifier hs-var">tsc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181410"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1477"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181411"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1478"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1479"></a><span>      </span><span class="hs-identifier hs-var">XTyVarBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TScoped"><span class="hs-identifier hs-type">TScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsQTyVars</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1482"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><a name="local-6989586621684181400"><a href="#local-6989586621684181400"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQTvs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsQTvsRn</span><span> </span><a name="local-6989586621684181401"><a href="#local-6989586621684181401"><span class="hs-identifier">implicits</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621684181402"><a href="#local-6989586621684181402"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1483"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#bindingsOnly"><span class="hs-identifier hs-var">bindingsOnly</span></a><span> </span><a href="#local-6989586621684181404"><span class="hs-identifier hs-var">bindings</span></a><span>
</span><a name="line-1484"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#tvScopes"><span class="hs-identifier hs-var">tvScopes</span></a><span> </span><a href="#local-6989586621684181400"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="#local-6989586621684181402"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1485"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1486"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1487"></a><span>      </span><a name="local-6989586621684181403"><a href="#local-6989586621684181403"><span class="hs-identifier">varLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181402"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1488"></a><span>      </span><a name="local-6989586621684181404"><a href="#local-6989586621684181404"><span class="hs-identifier">bindings</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieTypes.html#TyVarBind"><span class="hs-identifier hs-var">TyVarBind</span></a><span> </span><span class="hs-special">(</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181403"><span class="hs-identifier hs-var">varLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181400"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181401"><span class="hs-identifier hs-var">implicits</span></a><span>
</span><a name="line-1489"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XLHsQTyVars</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1490"></a><span>
</span><a name="line-1491"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsContext</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1492"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181398"><a href="#local-6989586621684181398"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181399"><a href="#local-6989586621684181399"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1493"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181398"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1494"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181399"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1495"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1496"></a><span>
</span><a name="line-1497"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LConDeclField</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1498"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181394"><a href="#local-6989586621684181394"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181395"><a href="#local-6989586621684181395"><span class="hs-identifier">field</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181395"><span class="hs-identifier hs-var">field</span></a><span> </span><a href="#local-6989586621684181394"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181395"><span class="hs-identifier hs-var">field</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1499"></a><span>      </span><span class="hs-identifier hs-var">ConDeclField</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181396"><a href="#local-6989586621684181396"><span class="hs-identifier">fields</span></a></a><span> </span><a name="local-6989586621684181397"><a href="#local-6989586621684181397"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1500"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RFC"><span class="hs-identifier hs-var">RFC</span></a><span> </span><a href="HieTypes.html#RecFieldDecl"><span class="hs-identifier hs-var">RecFieldDecl</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#loc"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621684181397"><span class="hs-identifier hs-var">typ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181396"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1501"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181397"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1502"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1503"></a><span>      </span><span class="hs-identifier hs-var">XConDeclField</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1504"></a><span>
</span><a name="line-1505"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181385"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ArithSeqInfo</span><span> </span><a href="#local-6989586621684181385"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1506"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">From</span><span> </span><a name="local-6989586621684181386"><a href="#local-6989586621684181386"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181386"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1507"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromThen</span><span> </span><a name="local-6989586621684181387"><a href="#local-6989586621684181387"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181388"><a href="#local-6989586621684181388"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1508"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181387"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1509"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181388"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1510"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1511"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromTo</span><span> </span><a name="local-6989586621684181389"><a href="#local-6989586621684181389"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181390"><a href="#local-6989586621684181390"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1512"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181389"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1513"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181390"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1514"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1515"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FromThenTo</span><span> </span><a name="local-6989586621684181391"><a href="#local-6989586621684181391"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181392"><a href="#local-6989586621684181392"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621684181393"><a href="#local-6989586621684181393"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1516"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181391"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1517"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181392"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1518"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181393"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1519"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1520"></a><span>
</span><a name="line-1521"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LSpliceDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1522"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181382"><a href="#local-6989586621684181382"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181383"><a href="#local-6989586621684181383"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181383"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181382"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181383"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1523"></a><span>      </span><span class="hs-identifier hs-var">SpliceDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181384"><a href="#local-6989586621684181384"><span class="hs-identifier">splice</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1524"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181384"><span class="hs-identifier hs-var">splice</span></a><span>
</span><a name="line-1525"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1526"></a><span>      </span><span class="hs-identifier hs-var">XSpliceDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1527"></a><span>
</span><a name="line-1528"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsBracket</span><span> </span><a href="#local-6989586621684181381"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1529"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1530"></a><span>
</span><a name="line-1531"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-identifier hs-type">PendingRnSplice</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1532"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1533"></a><span>
</span><a name="line-1534"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-identifier hs-type">PendingTcSplice</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1535"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1536"></a><span>
</span><a name="line-1537"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LBooleanFormula</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1538"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181375"><a href="#local-6989586621684181375"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181376"><a href="#local-6989586621684181376"><span class="hs-identifier">form</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181376"><span class="hs-identifier hs-var">form</span></a><span> </span><a href="#local-6989586621684181375"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181376"><span class="hs-identifier hs-var">form</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1539"></a><span>      </span><span class="hs-identifier hs-var">Var</span><span> </span><a name="local-6989586621684181377"><a href="#local-6989586621684181377"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1540"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181377"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1541"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1542"></a><span>      </span><span class="hs-identifier hs-var">And</span><span> </span><a name="local-6989586621684181378"><a href="#local-6989586621684181378"><span class="hs-identifier">forms</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1543"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181378"><span class="hs-identifier hs-var">forms</span></a><span>
</span><a name="line-1544"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1545"></a><span>      </span><span class="hs-identifier hs-var">Or</span><span> </span><a name="local-6989586621684181379"><a href="#local-6989586621684181379"><span class="hs-identifier">forms</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1546"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181379"><span class="hs-identifier hs-var">forms</span></a><span>
</span><a name="line-1547"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1548"></a><span>      </span><span class="hs-identifier hs-var">Parens</span><span> </span><a name="local-6989586621684181380"><a href="#local-6989586621684181380"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1549"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181380"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1550"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1551"></a><span>
</span><a name="line-1552"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-identifier hs-type">HsIPName</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1553"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181373"><a href="#local-6989586621684181373"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181374"><a href="#local-6989586621684181374"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181374"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621684181373"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1554"></a><span>
</span><a name="line-1555"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LHsExpr</span><span> </span><a href="#local-6989586621684181367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1556"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsSplice</span><span> </span><a href="#local-6989586621684181367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1557"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HsSplice</span><span> </span><a href="#local-6989586621684181367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1558"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181368"><a href="#local-6989586621684181368"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181369"><a href="#local-6989586621684181369"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181369"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-6989586621684181368"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181369"><span class="hs-identifier hs-var">sp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1559"></a><span>      </span><span class="hs-identifier hs-var">HsTypedSplice</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181370"><a href="#local-6989586621684181370"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1560"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181370"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1561"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1562"></a><span>      </span><span class="hs-identifier hs-var">HsUntypedSplice</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181371"><a href="#local-6989586621684181371"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1563"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181371"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1564"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1565"></a><span>      </span><span class="hs-identifier hs-var">HsQuasiQuote</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181372"><a href="#local-6989586621684181372"><span class="hs-identifier">ispan</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1566"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181372"><span class="hs-identifier hs-var">ispan</span></a><span>
</span><a name="line-1567"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1568"></a><span>      </span><span class="hs-identifier hs-var">HsSpliced</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1569"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1570"></a><span>      </span><span class="hs-identifier hs-var">HsSplicedT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1571"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1572"></a><span>      </span><span class="hs-identifier hs-var">XSplice</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1573"></a><span>
</span><a name="line-1574"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LRoleAnnotDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1575"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181363"><a href="#local-6989586621684181363"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181364"><a href="#local-6989586621684181364"><span class="hs-identifier">annot</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181364"><span class="hs-identifier hs-var">annot</span></a><span> </span><a href="#local-6989586621684181363"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181364"><span class="hs-identifier hs-var">annot</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1576"></a><span>      </span><span class="hs-identifier hs-var">RoleAnnotDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181365"><a href="#local-6989586621684181365"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621684181366"><a href="#local-6989586621684181366"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1577"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181365"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1578"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concatMapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181366"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-1579"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1580"></a><span>      </span><span class="hs-identifier hs-var">XRoleAnnotDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1583"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181358"><a href="#local-6989586621684181358"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181359"><a href="#local-6989586621684181359"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181359"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181358"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181359"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1584"></a><span>      </span><span class="hs-identifier hs-var">ClsInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181360"><a href="#local-6989586621684181360"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1585"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181358"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181360"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1586"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1587"></a><span>      </span><span class="hs-identifier hs-var">DataFamInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181361"><a href="#local-6989586621684181361"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1588"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181358"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181361"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1589"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1590"></a><span>      </span><span class="hs-identifier hs-var">TyFamInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181362"><a href="#local-6989586621684181362"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1591"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181358"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181362"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1592"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1593"></a><span>      </span><span class="hs-identifier hs-var">XInstDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1594"></a><span>
</span><a name="line-1595"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LClsInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1596"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181356"><a href="#local-6989586621684181356"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181357"><a href="#local-6989586621684181357"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1597"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181356"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_poly_ty</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1598"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#BC"><span class="hs-identifier hs-var">BC</span></a><span> </span><a href="HieTypes.html#InstanceBind"><span class="hs-identifier hs-var">InstanceBind</span></a><span> </span><a href="HieTypes.html#ModuleScope"><span class="hs-identifier hs-var">ModuleScope</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_binds</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1599"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#SC"><span class="hs-identifier hs-var">SC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#SI"><span class="hs-identifier hs-var">SI</span></a><span> </span><a href="HieAst.html#InstSig"><span class="hs-identifier hs-var">InstSig</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181356"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_sigs</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1600"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_tyfam_insts</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1601"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_tyfam_insts</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1602"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1603"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1604"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cid_overlap_mode</span><span> </span><a href="#local-6989586621684181357"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-1605"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1606"></a><span>
</span><a name="line-1607"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LDataFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1608"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181354"><a href="#local-6989586621684181354"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataFamInstDecl</span><span> </span><a name="local-6989586621684181355"><a href="#local-6989586621684181355"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181354"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181355"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1609"></a><span>
</span><a name="line-1610"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LTyFamInstDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1611"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181352"><a href="#local-6989586621684181352"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyFamInstDecl</span><span> </span><a name="local-6989586621684181353"><a href="#local-6989586621684181353"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181352"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181353"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1612"></a><span>
</span><a name="line-1613"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621684181348"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1614"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PatSynFieldContext"><span class="hs-identifier hs-type">PatSynFieldContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RecordPatSynField</span><span> </span><a href="#local-6989586621684181348"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1615"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#PSC"><span class="hs-identifier hs-var">PSC</span></a><span> </span><a name="local-6989586621684181349"><a href="#local-6989586621684181349"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecordPatSynField</span><span> </span><a name="local-6989586621684181350"><a href="#local-6989586621684181350"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621684181351"><a href="#local-6989586621684181351"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1616"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#RecField"><span class="hs-identifier hs-var">RecField</span></a><span> </span><a href="HieTypes.html#RecFieldDecl"><span class="hs-identifier hs-var">RecFieldDecl</span></a><span> </span><a href="#local-6989586621684181349"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181350"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1617"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181351"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1618"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1619"></a><span>
</span><a name="line-1620"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LDerivDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1621"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181343"><a href="#local-6989586621684181343"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181344"><a href="#local-6989586621684181344"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181344"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181343"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181344"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1622"></a><span>      </span><span class="hs-identifier hs-var">DerivDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181345"><a href="#local-6989586621684181345"><span class="hs-identifier">typ</span></a></a><span> </span><a name="local-6989586621684181346"><a href="#local-6989586621684181346"><span class="hs-identifier">strat</span></a></a><span> </span><a name="local-6989586621684181347"><a href="#local-6989586621684181347"><span class="hs-identifier">overlap</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1623"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181345"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1624"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181346"><span class="hs-identifier hs-var">strat</span></a><span>
</span><a name="line-1625"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181347"><span class="hs-identifier hs-var">overlap</span></a><span>
</span><a name="line-1626"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1627"></a><span>      </span><span class="hs-identifier hs-var">XDerivDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1628"></a><span>
</span><a name="line-1629"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LFixitySig</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1630"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181340"><a href="#local-6989586621684181340"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181341"><a href="#local-6989586621684181341"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181341"><span class="hs-identifier hs-var">sig</span></a><span> </span><a href="#local-6989586621684181340"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181341"><span class="hs-identifier hs-var">sig</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1631"></a><span>      </span><span class="hs-identifier hs-var">FixitySig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181342"><a href="#local-6989586621684181342"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1632"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181342"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1633"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1634"></a><span>      </span><span class="hs-identifier hs-var">XFixitySig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1635"></a><span>
</span><a name="line-1636"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LDefaultDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1637"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181337"><a href="#local-6989586621684181337"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181338"><a href="#local-6989586621684181338"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181338"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181337"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181338"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1638"></a><span>      </span><span class="hs-identifier hs-var">DefaultDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181339"><a href="#local-6989586621684181339"><span class="hs-identifier">typs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1639"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181339"><span class="hs-identifier hs-var">typs</span></a><span>
</span><a name="line-1640"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1641"></a><span>      </span><span class="hs-identifier hs-var">XDefaultDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1642"></a><span>
</span><a name="line-1643"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LForeignDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1644"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181329"><a href="#local-6989586621684181329"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181330"><a href="#local-6989586621684181330"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181330"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181329"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181330"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1645"></a><span>      </span><span class="hs-identifier hs-var">ForeignImport</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181331"><a href="#local-6989586621684181331"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181332"><a href="#local-6989586621684181332"><span class="hs-identifier">sig</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fi</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181333"><a href="#local-6989586621684181333"><span class="hs-identifier">fi</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1646"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ValBind"><span class="hs-identifier hs-var">ValBind</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="HieTypes.html#ModuleScope"><span class="hs-identifier hs-var">ModuleScope</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#getRealSpan"><span class="hs-identifier hs-var">getRealSpan</span></a><span> </span><a href="#local-6989586621684181329"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181331"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1647"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181332"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1648"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181333"><span class="hs-identifier hs-var">fi</span></a><span>
</span><a name="line-1649"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1650"></a><span>      </span><span class="hs-identifier hs-var">ForeignExport</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181334"><a href="#local-6989586621684181334"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181335"><a href="#local-6989586621684181335"><span class="hs-identifier">sig</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181336"><a href="#local-6989586621684181336"><span class="hs-identifier">fe</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1651"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181334"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1652"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181335"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-1653"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181336"><span class="hs-identifier hs-var">fe</span></a><span>
</span><a name="line-1654"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1655"></a><span>      </span><span class="hs-identifier hs-var">XForeignDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1656"></a><span>
</span><a name="line-1657"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-identifier hs-type">ForeignImport</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1658"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CImport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181326"><a href="#local-6989586621684181326"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181327"><a href="#local-6989586621684181327"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181328"><a href="#local-6989586621684181328"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1659"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181326"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1660"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181327"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1661"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181328"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1662"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1663"></a><span>
</span><a name="line-1664"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-identifier hs-type">ForeignExport</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1665"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CExport</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181324"><a href="#local-6989586621684181324"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181325"><a href="#local-6989586621684181325"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1666"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181324"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1667"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181325"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1668"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1669"></a><span>
</span><a name="line-1670"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LWarnDecls</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1671"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181321"><a href="#local-6989586621684181321"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181322"><a href="#local-6989586621684181322"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181322"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181321"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181322"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1672"></a><span>      </span><span class="hs-identifier hs-var">Warnings</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181323"><a href="#local-6989586621684181323"><span class="hs-identifier">warnings</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1673"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181323"><span class="hs-identifier hs-var">warnings</span></a><span>
</span><a name="line-1674"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1675"></a><span>      </span><span class="hs-identifier hs-var">XWarnDecls</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1676"></a><span>
</span><a name="line-1677"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LWarnDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1678"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181318"><a href="#local-6989586621684181318"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181319"><a href="#local-6989586621684181319"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181319"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181318"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181319"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1679"></a><span>      </span><span class="hs-identifier hs-var">Warning</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181320"><a href="#local-6989586621684181320"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1680"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181320"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1681"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1682"></a><span>      </span><span class="hs-identifier hs-var">XWarnDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1683"></a><span>
</span><a name="line-1684"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LAnnDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1685"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181314"><a href="#local-6989586621684181314"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181315"><a href="#local-6989586621684181315"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181315"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181314"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181315"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1686"></a><span>      </span><span class="hs-identifier hs-var">HsAnnotation</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181316"><a href="#local-6989586621684181316"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621684181317"><a href="#local-6989586621684181317"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1687"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181316"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-1688"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181317"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1689"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1690"></a><span>      </span><span class="hs-identifier hs-var">XAnnDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1691"></a><span>
</span><a name="line-1692"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><a href="#local-6989586621684181311"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">AnnProvenance</span><span> </span><a href="#local-6989586621684181311"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1693"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ValueAnnProvenance</span><span> </span><a name="local-6989586621684181312"><a href="#local-6989586621684181312"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181312"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1694"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeAnnProvenance</span><span> </span><a name="local-6989586621684181313"><a href="#local-6989586621684181313"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="HieTypes.html#Use"><span class="hs-identifier hs-var">Use</span></a><span> </span><a href="#local-6989586621684181313"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1695"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-identifier hs-var">ModuleAnnProvenance</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1696"></a><span>
</span><a name="line-1697"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LRuleDecls</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1698"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181308"><a href="#local-6989586621684181308"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181309"><a href="#local-6989586621684181309"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181309"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181308"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181309"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1699"></a><span>      </span><span class="hs-identifier hs-var">HsRules</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181310"><a href="#local-6989586621684181310"><span class="hs-identifier">rules</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1700"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181310"><span class="hs-identifier hs-var">rules</span></a><span>
</span><a name="line-1701"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1702"></a><span>      </span><span class="hs-identifier hs-var">XRuleDecls</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1703"></a><span>
</span><a name="line-1704"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LRuleDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1705"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">XRuleDecl</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1706"></a><span>  </span><span class="hs-identifier">toHie</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181297"><a href="#local-6989586621684181297"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181298"><a href="#local-6989586621684181298"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">HsRule</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181299"><a href="#local-6989586621684181299"><span class="hs-identifier">rname</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181300"><a href="#local-6989586621684181300"><span class="hs-identifier">tybndrs</span></a></a><span> </span><a name="local-6989586621684181301"><a href="#local-6989586621684181301"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621684181302"><a href="#local-6989586621684181302"><span class="hs-identifier">exprA</span></a></a><span> </span><a name="local-6989586621684181303"><a href="#local-6989586621684181303"><span class="hs-identifier">exprB</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span>
</span><a name="line-1707"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181298"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621684181297"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-1708"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">getLoc</span><span> </span><a href="#local-6989586621684181299"><span class="hs-identifier hs-var">rname</span></a><span>
</span><a name="line-1709"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#tvScopes"><span class="hs-identifier hs-var">tvScopes</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181304"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181300"><span class="hs-identifier hs-var">tybndrs</span></a><span>
</span><a name="line-1710"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#mkScope"><span class="hs-identifier hs-var">mkScope</span></a><span> </span><a href="#local-6989586621684181297"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181301"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1711"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181302"><span class="hs-identifier hs-var">exprA</span></a><span>
</span><a name="line-1712"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><a href="#local-6989586621684181303"><span class="hs-identifier hs-var">exprB</span></a><span>
</span><a name="line-1713"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1714"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684181304"><a href="#local-6989586621684181304"><span class="hs-identifier">scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684181305"><span class="hs-identifier hs-var">bndrs_sc</span></a><span> </span><span class="hs-special">`</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684181306"><span class="hs-identifier hs-var">exprA_sc</span></a><span> </span><span class="hs-special">`</span><a href="HieUtils.html#combineScopes"><span class="hs-identifier hs-var">combineScopes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621684181307"><span class="hs-identifier hs-var">exprB_sc</span></a><span>
</span><a name="line-1715"></a><span>          </span><a name="local-6989586621684181305"><a href="#local-6989586621684181305"><span class="hs-identifier">bndrs_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HieTypes.html#NoScope"><span class="hs-identifier hs-var">NoScope</span></a><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><a href="#local-6989586621684181301"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1716"></a><span>          </span><a name="local-6989586621684181306"><a href="#local-6989586621684181306"><span class="hs-identifier">exprA_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181302"><span class="hs-identifier hs-var">exprA</span></a><span>
</span><a name="line-1717"></a><span>          </span><a name="local-6989586621684181307"><a href="#local-6989586621684181307"><span class="hs-identifier">exprB_sc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieUtils.html#mkLScope"><span class="hs-identifier hs-var">mkLScope</span></a><span> </span><a href="#local-6989586621684181303"><span class="hs-identifier hs-var">exprB</span></a><span>
</span><a name="line-1718"></a><span>
</span><a name="line-1719"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RScoped"><span class="hs-identifier hs-type">RScoped</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LRuleBndr</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1720"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#RS"><span class="hs-identifier hs-var">RS</span></a><span> </span><a name="local-6989586621684181291"><a href="#local-6989586621684181291"><span class="hs-identifier">sc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181292"><a href="#local-6989586621684181292"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181293"><a href="#local-6989586621684181293"><span class="hs-identifier">bndr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181293"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="#local-6989586621684181292"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181293"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1721"></a><span>      </span><span class="hs-identifier hs-var">RuleBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181294"><a href="#local-6989586621684181294"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1722"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ValBind"><span class="hs-identifier hs-var">ValBind</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="#local-6989586621684181291"><span class="hs-identifier hs-var">sc</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181294"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1723"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1724"></a><span>      </span><span class="hs-identifier hs-var">RuleBndrSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181295"><a href="#local-6989586621684181295"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621684181296"><a href="#local-6989586621684181296"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1725"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ValBind"><span class="hs-identifier hs-var">ValBind</span></a><span> </span><a href="HieTypes.html#RegularBind"><span class="hs-identifier hs-var">RegularBind</span></a><span> </span><a href="#local-6989586621684181291"><span class="hs-identifier hs-var">sc</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181295"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-1726"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#TS"><span class="hs-identifier hs-var">TS</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#ResolvedScopes"><span class="hs-identifier hs-var">ResolvedScopes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684181291"><span class="hs-identifier hs-var">sc</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181296"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-1727"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1728"></a><span>      </span><span class="hs-identifier hs-var">XRuleBndr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1729"></a><span>
</span><a name="line-1730"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LImportDecl</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1731"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181281"><a href="#local-6989586621684181281"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181282"><a href="#local-6989586621684181282"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181282"><span class="hs-identifier hs-var">decl</span></a><span> </span><a href="#local-6989586621684181281"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181282"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1732"></a><span>      </span><span class="hs-identifier hs-var">ImportDecl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ideclName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181288"><a href="#local-6989586621684181288"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclAs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclHiding</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621684181290"><a href="#local-6989586621684181290"><span class="hs-identifier">hidden</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1733"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="HieTypes.html#Import"><span class="hs-identifier hs-var">Import</span></a><span> </span><a href="#local-6989586621684181288"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1734"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="HieTypes.html#ImportAs"><span class="hs-identifier hs-var">ImportAs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-1735"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181283"><span class="hs-identifier hs-var">goIE</span></a><span> </span><a href="#local-6989586621684181290"><span class="hs-identifier hs-var">hidden</span></a><span>
</span><a name="line-1736"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1737"></a><span>      </span><span class="hs-identifier hs-var">XImportDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1738"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1739"></a><span>      </span><a name="local-6989586621684181283"><a href="#local-6989586621684181283"><span class="hs-identifier">goIE</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">hiding</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181285"><a href="#local-6989586621684181285"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621684181286"><a href="#local-6989586621684181286"><span class="hs-identifier">liens</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1740"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#locOnly"><span class="hs-identifier hs-var">locOnly</span></a><span> </span><a href="#local-6989586621684181285"><span class="hs-identifier hs-var">sp</span></a><span>
</span><a name="line-1741"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181287"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181286"><span class="hs-identifier hs-var">liens</span></a><span>
</span><a name="line-1742"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1743"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1744"></a><span>         </span><a name="local-6989586621684181287"><a href="#local-6989586621684181287"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="HieTypes.html#ImportHiding"><span class="hs-identifier hs-var">ImportHiding</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="HieTypes.html#Import"><span class="hs-identifier hs-var">Import</span></a><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEContext"><span class="hs-identifier hs-type">IEContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LIE</span><span> </span><span class="hs-identifier hs-type">GhcRn</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1747"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a name="local-6989586621684181271"><a href="#local-6989586621684181271"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181272"><a href="#local-6989586621684181272"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181273"><a href="#local-6989586621684181273"><span class="hs-identifier">ie</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181273"><span class="hs-identifier hs-var">ie</span></a><span> </span><a href="#local-6989586621684181272"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181273"><span class="hs-identifier hs-var">ie</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1748"></a><span>      </span><span class="hs-identifier hs-var">IEVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181274"><a href="#local-6989586621684181274"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1749"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181274"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1750"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1751"></a><span>      </span><span class="hs-identifier hs-var">IEThingAbs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181275"><a href="#local-6989586621684181275"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1752"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181275"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1753"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1754"></a><span>      </span><span class="hs-identifier hs-var">IEThingAll</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181276"><a href="#local-6989586621684181276"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1755"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181276"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1756"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1757"></a><span>      </span><span class="hs-identifier hs-var">IEThingWith</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181277"><a href="#local-6989586621684181277"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181278"><a href="#local-6989586621684181278"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621684181279"><a href="#local-6989586621684181279"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1758"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181277"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1759"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181278"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-1760"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181279"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1761"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1762"></a><span>      </span><span class="hs-identifier hs-var">IEModuleContents</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181280"><a href="#local-6989586621684181280"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1763"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a href="#local-6989586621684181271"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621684181280"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1764"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1765"></a><span>      </span><span class="hs-identifier hs-var">IEGroup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1766"></a><span>      </span><span class="hs-identifier hs-var">IEDoc</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1767"></a><span>      </span><span class="hs-identifier hs-var">IEDocNamed</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1768"></a><span>      </span><span class="hs-identifier hs-var">XIE</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1769"></a><span>
</span><a name="line-1770"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEContext"><span class="hs-identifier hs-type">IEContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LIEWrappedName</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1771"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a name="local-6989586621684181265"><a href="#local-6989586621684181265"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181266"><a href="#local-6989586621684181266"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181267"><a href="#local-6989586621684181267"><span class="hs-identifier">iewn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181267"><span class="hs-identifier hs-var">iewn</span></a><span> </span><a href="#local-6989586621684181266"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181267"><span class="hs-identifier hs-var">iewn</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1772"></a><span>      </span><span class="hs-identifier hs-var">IEName</span><span> </span><a name="local-6989586621684181268"><a href="#local-6989586621684181268"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1773"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#IEThing"><span class="hs-identifier hs-var">IEThing</span></a><span> </span><a href="#local-6989586621684181265"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181268"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1774"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1775"></a><span>      </span><span class="hs-identifier hs-var">IEPattern</span><span> </span><a name="local-6989586621684181269"><a href="#local-6989586621684181269"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1776"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#IEThing"><span class="hs-identifier hs-var">IEThing</span></a><span> </span><a href="#local-6989586621684181265"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181269"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1777"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1778"></a><span>      </span><span class="hs-identifier hs-var">IEType</span><span> </span><a name="local-6989586621684181270"><a href="#local-6989586621684181270"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1779"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#IEThing"><span class="hs-identifier hs-var">IEThing</span></a><span> </span><a href="#local-6989586621684181265"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684181270"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1780"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1781"></a><span>
</span><a name="line-1782"></a><span class="hs-keyword">instance</span><span> </span><a href="HieAst.html#ToHie"><span class="hs-identifier hs-type">ToHie</span></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEContext"><span class="hs-identifier hs-type">IEContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Located</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FieldLbl</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1783"></a><span>  </span><a name="local-8214565720328956097"><a href="HieAst.html#toHie"><span class="hs-identifier">toHie</span></a></a><span> </span><span class="hs-special">(</span><a href="HieAst.html#IEC"><span class="hs-identifier hs-var">IEC</span></a><span> </span><a name="local-6989586621684181261"><a href="#local-6989586621684181261"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L</span><span> </span><a name="local-6989586621684181262"><a href="#local-6989586621684181262"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621684181263"><a href="#local-6989586621684181263"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HieAst.html#concatM"><span class="hs-identifier hs-var">concatM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieUtils.html#makeNode"><span class="hs-identifier hs-var">makeNode</span></a><span> </span><a href="#local-6989586621684181263"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-6989586621684181262"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684181263"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1784"></a><span>      </span><span class="hs-identifier hs-var">FieldLabel</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684181264"><a href="#local-6989586621684181264"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1785"></a><span>        </span><span class="hs-special">[</span><span> </span><a href="HieAst.html#toHie"><span class="hs-identifier hs-var">toHie</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HieAst.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="HieTypes.html#IEThing"><span class="hs-identifier hs-var">IEThing</span></a><span> </span><a href="#local-6989586621684181261"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span> </span><a href="#local-6989586621684181262"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621684181264"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1786"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-1787"></a></pre></body></html>