<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">--</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Compiler information functions</span><span>
</span><a name="line-5"></a><span class="hs-comment">--</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- (c) The GHC Team 2017</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">SysTools.Info</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Exception</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ErrUtils</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Util</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Platform</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="SysTools.Process.html"><span class="hs-identifier">SysTools.Process</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">{- Note [Run-time linker info]

See also: Trac #5240, Trac #6063, Trac #10110

Before 'runLink', we need to be sure to get the relevant information
about the linker we're using at runtime to see if we need any extra
options. For example, GNU ld requires '--reduce-memory-overheads' and
'--hash-size=31' in order to use reasonable amounts of memory (see
trac #5240.) But this isn't supported in GNU gold.

Generally, the linker changing from what was detected at ./configure
time has always been possible using -pgml, but on Linux it can happen
'transparently' by installing packages like binutils-gold, which
change what /usr/bin/ld actually points to.

Clang vs GCC notes:

For gcc, 'gcc -Wl,--version' gives a bunch of output about how to
invoke the linker before the version information string. For 'clang',
the version information for 'ld' is all that's output. For this
reason, we typically need to slurp up all of the standard error output
and look through it.

Other notes:

We cache the LinkerInfo inside DynFlags, since clients may link
multiple times. The definition of LinkerInfo is there to avoid a
circular dependency.

-}</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">{- Note [ELF needed shared libs]

Some distributions change the link editor's default handling of
ELF DT_NEEDED tags to include only those shared objects that are
needed to resolve undefined symbols. For Template Haskell we need
the last temporary shared library also if it is not needed for the
currently linked temporary shared library. We specify --no-as-needed
to override the default. This flag exists in GNU ld and GNU gold.

The flag is only needed on ELF systems. On Windows (PE) and Mac OS X
(Mach-O) the flag is not needed.

-}</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">{- Note [Windows static libGCC]

The GCC versions being upgraded to in #10726 are configured with
dynamic linking of libgcc supported. This results in libgcc being
linked dynamically when a shared library is created.

This introduces thus an extra dependency on GCC dll that was not
needed before by shared libraries created with GHC. This is a particular
issue on Windows because you get a non-obvious error due to this missing
dependency. This dependent dll is also not commonly on your path.

For this reason using the static libgcc is preferred as it preserves
the same behaviour that existed before. There are however some very good
reasons to have the shared version as well as described on page 181 of
https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gcc.pdf :

&quot;There are several situations in which an application should use the
 shared &#8216;libgcc&#8217; instead of the static version. The most common of these
 is when the application wishes to throw and catch exceptions across different
 shared libraries. In that case, each of the libraries as well as the application
 itself should use the shared &#8216;libgcc&#8217;. &quot;

-}</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LinkerInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Option</span><span class="hs-special">]</span><span>
</span><a name="line-97"></a><a name="neededLinkArgs"><a href="SysTools.Info.html#neededLinkArgs"><span class="hs-identifier">neededLinkArgs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GnuLD</span><span> </span><a name="local-6989586621681232870"><a href="#local-6989586621681232870"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232870"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-98"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GnuGold</span><span> </span><a name="local-6989586621681232871"><a href="#local-6989586621681232871"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232871"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-99"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LlvmLLD</span><span> </span><a name="local-6989586621681232872"><a href="#local-6989586621681232872"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232872"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-100"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DarwinLD</span><span> </span><a name="local-6989586621681232873"><a href="#local-6989586621681232873"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232873"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-101"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SolarisLD</span><span> </span><a name="local-6989586621681232874"><a href="#local-6989586621681232874"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232874"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-102"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AixLD</span><span> </span><a name="local-6989586621681232875"><a href="#local-6989586621681232875"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232875"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-103"></a><span class="hs-identifier">neededLinkArgs</span><span> </span><span class="hs-identifier hs-var">UnknownLD</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- Grab linker info and cache it in DynFlags.</span><span>
</span><a name="line-106"></a><span class="hs-identifier">getLinkerInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">LinkerInfo</span><span>
</span><a name="line-107"></a><a name="getLinkerInfo"><a href="SysTools.Info.html#getLinkerInfo"><span class="hs-identifier">getLinkerInfo</span></a></a><span> </span><a name="local-6989586621681232876"><a href="#local-6989586621681232876"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621681232877"><a href="#local-6989586621681232877"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtldInfo</span><span> </span><a href="#local-6989586621681232876"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681232877"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681232878"><a href="#local-6989586621681232878"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232878"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-112"></a><span>      </span><a name="local-6989586621681232879"><a href="#local-6989586621681232879"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SysTools.Info.html#getLinkerInfo%27"><span class="hs-identifier hs-var">getLinkerInfo'</span></a><span> </span><a href="#local-6989586621681232876"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-113"></a><span>      </span><span class="hs-identifier hs-var">writeIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtldInfo</span><span> </span><a href="#local-6989586621681232876"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681232879"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232879"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- See Note [Run-time linker info].</span><span>
</span><a name="line-117"></a><span class="hs-identifier">getLinkerInfo'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">LinkerInfo</span><span>
</span><a name="line-118"></a><a name="getLinkerInfo%27"><a href="SysTools.Info.html#getLinkerInfo%27"><span class="hs-identifier">getLinkerInfo'</span></a></a><span> </span><a name="local-6989586621681232880"><a href="#local-6989586621681232880"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621681232881"><a href="#local-6989586621681232881"><span class="hs-identifier">platform</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621681232880"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-120"></a><span>      </span><a name="local-6989586621681232882"><a href="#local-6989586621681232882"><span class="hs-identifier">os</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">platformOS</span><span> </span><a href="#local-6989586621681232881"><span class="hs-identifier hs-var">platform</span></a><span>
</span><a name="line-121"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621681232883"><a href="#local-6989586621681232883"><span class="hs-identifier">pgm</span></a></a><span class="hs-special">,</span><a name="local-6989586621681232884"><a href="#local-6989586621681232884"><span class="hs-identifier">args0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pgm_l</span><span> </span><a href="#local-6989586621681232880"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-122"></a><span>      </span><a name="local-6989586621681232885"><a href="#local-6989586621681232885"><span class="hs-identifier">args1</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getOpts</span><span> </span><a href="#local-6989586621681232880"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-identifier hs-var">opt_l</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>      </span><a name="local-6989586621681232886"><a href="#local-6989586621681232886"><span class="hs-identifier">args2</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681232884"><span class="hs-identifier hs-var">args0</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681232885"><span class="hs-identifier hs-var">args1</span></a><span>
</span><a name="line-124"></a><span>      </span><a name="local-6989586621681232887"><a href="#local-6989586621681232887"><span class="hs-identifier">args3</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-identifier hs-var">notNull</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">showOpt</span><span> </span><a href="#local-6989586621681232886"><span class="hs-identifier hs-var">args2</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span>      </span><span class="hs-comment">-- Try to grab the info from the process output.</span><span>
</span><a name="line-127"></a><span>      </span><a name="local-6989586621681232888"><a href="#local-6989586621681232888"><span class="hs-identifier">parseLinkerInfo</span></a></a><span> </span><a name="local-6989586621681232889"><a href="#local-6989586621681232889"><span class="hs-identifier">stdo</span></a></a><span> </span><a name="local-6989586621681232890"><a href="#local-6989586621681232890"><span class="hs-identifier">_stde</span></a></a><span> </span><a name="local-6989586621681232891"><a href="#local-6989586621681232891"><span class="hs-identifier">_exitc</span></a></a><span>
</span><a name="line-128"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;GNU ld&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232889"><span class="hs-identifier hs-var">stdo</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-129"></a><span>          </span><span class="hs-comment">-- GNU ld specifically needs to use less memory. This especially</span><span>
</span><a name="line-130"></a><span>          </span><span class="hs-comment">-- hurts on small object files. Trac #5240.</span><span>
</span><a name="line-131"></a><span>          </span><span class="hs-comment">-- Set DT_NEEDED for all shared libraries. Trac #10110.</span><span>
</span><a name="line-132"></a><span>          </span><span class="hs-comment">-- TODO: Investigate if these help or hurt when using split sections.</span><span>
</span><a name="line-133"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GnuLD</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-Wl,--hash-size=31&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-134"></a><span>                                      </span><span class="hs-string">&quot;-Wl,--reduce-memory-overheads&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-135"></a><span>                                      </span><span class="hs-comment">-- ELF specific flag</span><span>
</span><a name="line-136"></a><span>                                      </span><span class="hs-comment">-- see Note [ELF needed shared libs]</span><span>
</span><a name="line-137"></a><span>                                      </span><span class="hs-string">&quot;-Wl,--no-as-needed&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;GNU gold&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232889"><span class="hs-identifier hs-var">stdo</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-140"></a><span>          </span><span class="hs-comment">-- GNU gold only needs --no-as-needed. Trac #10110.</span><span>
</span><a name="line-141"></a><span>          </span><span class="hs-comment">-- ELF specific flag, see Note [ELF needed shared libs]</span><span>
</span><a name="line-142"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GnuGold</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-string">&quot;-Wl,--no-as-needed&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;LLD&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232889"><span class="hs-identifier hs-var">stdo</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-145"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LlvmLLD</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Option</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-146"></a><span>                                      </span><span class="hs-comment">-- see Note [ELF needed shared libs]</span><span>
</span><a name="line-147"></a><span>                                      </span><span class="hs-string">&quot;-Wl,--no-as-needed&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>         </span><span class="hs-comment">-- Unknown linker.</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;invalid --version output, or linker is unsupported&quot;</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-comment">-- Process the executable call</span><span>
</span><a name="line-153"></a><span>  </span><a name="local-6989586621681232896"><a href="#local-6989586621681232896"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">catchIO</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-154"></a><span>             </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681232882"><span class="hs-identifier hs-var">os</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-155"></a><span>               </span><span class="hs-identifier hs-var">OSSolaris2</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-156"></a><span>                 </span><span class="hs-comment">-- Solaris uses its own Solaris linker. Even all</span><span>
</span><a name="line-157"></a><span>                 </span><span class="hs-comment">-- GNU C are recommended to configure with Solaris</span><span>
</span><a name="line-158"></a><span>                 </span><span class="hs-comment">-- linker instead of using GNU binutils linker. Also</span><span>
</span><a name="line-159"></a><span>                 </span><span class="hs-comment">-- all GCC distributed with Solaris follows this rule</span><span>
</span><a name="line-160"></a><span>                 </span><span class="hs-comment">-- precisely so we assume here, the Solaris linker is</span><span>
</span><a name="line-161"></a><span>                 </span><span class="hs-comment">-- used.</span><span>
</span><a name="line-162"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SolarisLD</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>               </span><span class="hs-identifier hs-var">OSAIX</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-164"></a><span>                 </span><span class="hs-comment">-- IBM AIX uses its own non-binutils linker as well</span><span>
</span><a name="line-165"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">AixLD</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>               </span><span class="hs-identifier hs-var">OSDarwin</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-167"></a><span>                 </span><span class="hs-comment">-- Darwin has neither GNU Gold or GNU LD, but a strange linker</span><span>
</span><a name="line-168"></a><span>                 </span><span class="hs-comment">-- that doesn't support --version. We can just assume that's</span><span>
</span><a name="line-169"></a><span>                 </span><span class="hs-comment">-- what we're using.</span><span>
</span><a name="line-170"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DarwinLD</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-171"></a><span>               </span><span class="hs-identifier hs-var">OSMinGW32</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-172"></a><span>                 </span><span class="hs-comment">-- GHC doesn't support anything but GNU ld on Windows anyway.</span><span>
</span><a name="line-173"></a><span>                 </span><span class="hs-comment">-- Process creation is also fairly expensive on win32, so</span><span>
</span><a name="line-174"></a><span>                 </span><span class="hs-comment">-- we short-circuit here.</span><span>
</span><a name="line-175"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">GnuLD</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Option</span><span>
</span><a name="line-176"></a><span>                   </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- Reduce ld memory usage</span><span>
</span><a name="line-177"></a><span>                     </span><span class="hs-string">&quot;-Wl,--hash-size=31&quot;</span><span>
</span><a name="line-178"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;-Wl,--reduce-memory-overheads&quot;</span><span>
</span><a name="line-179"></a><span>                     </span><span class="hs-comment">-- Emit gcc stack checks</span><span>
</span><a name="line-180"></a><span>                     </span><span class="hs-comment">-- Note [Windows stack usage]</span><span>
</span><a name="line-181"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;-fstack-check&quot;</span><span>
</span><a name="line-182"></a><span>                     </span><span class="hs-comment">-- Force static linking of libGCC</span><span>
</span><a name="line-183"></a><span>                     </span><span class="hs-comment">-- Note [Windows static libGCC]</span><span>
</span><a name="line-184"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;-static-libgcc&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><span>               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-186"></a><span>                 </span><span class="hs-comment">-- In practice, we use the compiler as the linker here. Pass</span><span>
</span><a name="line-187"></a><span>                 </span><span class="hs-comment">-- -Wl,--version to get linker version info.</span><span>
</span><a name="line-188"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621681232892"><a href="#local-6989586621681232892"><span class="hs-identifier">exitc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681232893"><a href="#local-6989586621681232893"><span class="hs-identifier">stdo</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681232894"><a href="#local-6989586621681232894"><span class="hs-identifier">stde</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SysTools.Process.html#readProcessEnvWithExitCode"><span class="hs-identifier hs-var">readProcessEnvWithExitCode</span></a><span> </span><a href="#local-6989586621681232883"><span class="hs-identifier hs-var">pgm</span></a><span>
</span><a name="line-189"></a><span>                                        </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-string">&quot;-Wl,--version&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621681232887"><span class="hs-identifier hs-var">args3</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>                                        </span><a href="SysTools.Process.html#c_locale_env"><span class="hs-identifier hs-var">c_locale_env</span></a><span>
</span><a name="line-191"></a><span>                 </span><span class="hs-comment">-- Split the output by lines to make certain kinds</span><span>
</span><a name="line-192"></a><span>                 </span><span class="hs-comment">-- of processing easier. In particular, 'clang' and 'gcc'</span><span>
</span><a name="line-193"></a><span>                 </span><span class="hs-comment">-- have slightly different outputs for '-Wl,--version', but</span><span>
</span><a name="line-194"></a><span>                 </span><span class="hs-comment">-- it's still easy to figure out.</span><span>
</span><a name="line-195"></a><span>                 </span><a href="#local-6989586621681232888"><span class="hs-identifier hs-var">parseLinkerInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621681232893"><span class="hs-identifier hs-var">stdo</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621681232894"><span class="hs-identifier hs-var">stde</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232892"><span class="hs-identifier hs-var">exitc</span></a><span>
</span><a name="line-196"></a><span>            </span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621681232895"><a href="#local-6989586621681232895"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-198"></a><span>                </span><span class="hs-identifier hs-var">debugTraceMsg</span><span> </span><a href="#local-6989586621681232880"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-199"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Error (figuring out linker information):&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span>
</span><a name="line-200"></a><span>                     </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621681232895"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>                </span><span class="hs-identifier hs-var">errorMsg</span><span> </span><a href="#local-6989586621681232880"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">hang</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Warning:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-202"></a><span>                  </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Couldn't figure out linker information!&quot;</span><span> </span><span class="hs-operator hs-var">$$</span><span>
</span><a name="line-203"></a><span>                  </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Make sure you're using GNU ld, GNU gold&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span>
</span><a name="line-204"></a><span>                  </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;or the built in OS X linker, etc.&quot;</span><span>
</span><a name="line-205"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">UnknownLD</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232896"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- Grab compiler info and cache it in DynFlags.</span><span>
</span><a name="line-209"></a><span class="hs-identifier">getCompilerInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CompilerInfo</span><span>
</span><a name="line-210"></a><a name="getCompilerInfo"><a href="SysTools.Info.html#getCompilerInfo"><span class="hs-identifier">getCompilerInfo</span></a></a><span> </span><a name="local-6989586621681232897"><a href="#local-6989586621681232897"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-211"></a><span>  </span><a name="local-6989586621681232898"><a href="#local-6989586621681232898"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtccInfo</span><span> </span><a href="#local-6989586621681232897"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681232898"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681232899"><a href="#local-6989586621681232899"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232899"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-215"></a><span>      </span><a name="local-6989586621681232900"><a href="#local-6989586621681232900"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SysTools.Info.html#getCompilerInfo%27"><span class="hs-identifier hs-var">getCompilerInfo'</span></a><span> </span><a href="#local-6989586621681232897"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-216"></a><span>      </span><span class="hs-identifier hs-var">writeIORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtccInfo</span><span> </span><a href="#local-6989586621681232897"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681232900"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232900"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- See Note [Run-time linker info].</span><span>
</span><a name="line-220"></a><span class="hs-identifier">getCompilerInfo'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">CompilerInfo</span><span>
</span><a name="line-221"></a><a name="getCompilerInfo%27"><a href="SysTools.Info.html#getCompilerInfo%27"><span class="hs-identifier">getCompilerInfo'</span></a></a><span> </span><a name="local-6989586621681232901"><a href="#local-6989586621681232901"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681232902"><a href="#local-6989586621681232902"><span class="hs-identifier">pgm</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pgm_c</span><span> </span><a href="#local-6989586621681232901"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-223"></a><span>      </span><span class="hs-comment">-- Try to grab the info from the process output.</span><span>
</span><a name="line-224"></a><span>      </span><a name="local-6989586621681232903"><a href="#local-6989586621681232903"><span class="hs-identifier">parseCompilerInfo</span></a></a><span> </span><a name="local-6989586621681232904"><a href="#local-6989586621681232904"><span class="hs-identifier">_stdo</span></a></a><span> </span><a name="local-6989586621681232905"><a href="#local-6989586621681232905"><span class="hs-identifier">stde</span></a></a><span> </span><a name="local-6989586621681232906"><a href="#local-6989586621681232906"><span class="hs-identifier">_exitc</span></a></a><span>
</span><a name="line-225"></a><span>        </span><span class="hs-comment">-- Regular GCC</span><span>
</span><a name="line-226"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;gcc version&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isInfixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-227"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">GCC</span><span>
</span><a name="line-228"></a><span>        </span><span class="hs-comment">-- Regular clang</span><span>
</span><a name="line-229"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;clang version&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isInfixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-230"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Clang</span><span>
</span><a name="line-231"></a><span>        </span><span class="hs-comment">-- FreeBSD clang</span><span>
</span><a name="line-232"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;FreeBSD clang version&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isInfixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-233"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Clang</span><span>
</span><a name="line-234"></a><span>        </span><span class="hs-comment">-- XCode 5.1 clang</span><span>
</span><a name="line-235"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Apple LLVM version 5.1&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-236"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">AppleClang51</span><span>
</span><a name="line-237"></a><span>        </span><span class="hs-comment">-- XCode 5 clang</span><span>
</span><a name="line-238"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Apple LLVM version&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-239"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">AppleClang</span><span>
</span><a name="line-240"></a><span>        </span><span class="hs-comment">-- XCode 4.1 clang</span><span>
</span><a name="line-241"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Apple clang version&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232905"><span class="hs-identifier hs-var">stde</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-242"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">AppleClang</span><span>
</span><a name="line-243"></a><span>         </span><span class="hs-comment">-- Unknown linker.</span><span>
</span><a name="line-244"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;invalid -v output, or compiler is unsupported&quot;</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span>  </span><span class="hs-comment">-- Process the executable call</span><span>
</span><a name="line-247"></a><span>  </span><a name="local-6989586621681232911"><a href="#local-6989586621681232911"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">catchIO</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-248"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621681232907"><a href="#local-6989586621681232907"><span class="hs-identifier">exitc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681232908"><a href="#local-6989586621681232908"><span class="hs-identifier">stdo</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681232909"><a href="#local-6989586621681232909"><span class="hs-identifier">stde</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-249"></a><span>                    </span><a href="SysTools.Process.html#readProcessEnvWithExitCode"><span class="hs-identifier hs-var">readProcessEnvWithExitCode</span></a><span> </span><a href="#local-6989586621681232902"><span class="hs-identifier hs-var">pgm</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-v&quot;</span><span class="hs-special">]</span><span> </span><a href="SysTools.Process.html#c_locale_env"><span class="hs-identifier hs-var">c_locale_env</span></a><span>
</span><a name="line-250"></a><span>                </span><span class="hs-comment">-- Split the output by lines to make certain kinds</span><span>
</span><a name="line-251"></a><span>                </span><span class="hs-comment">-- of processing easier.</span><span>
</span><a name="line-252"></a><span>                </span><a href="#local-6989586621681232903"><span class="hs-identifier hs-var">parseCompilerInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621681232908"><span class="hs-identifier hs-var">stdo</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621681232909"><span class="hs-identifier hs-var">stde</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681232907"><span class="hs-identifier hs-var">exitc</span></a><span>
</span><a name="line-253"></a><span>            </span><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621681232910"><a href="#local-6989586621681232910"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-255"></a><span>                </span><span class="hs-identifier hs-var">debugTraceMsg</span><span> </span><a href="#local-6989586621681232901"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-256"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Error (figuring out C compiler information):&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span>
</span><a name="line-257"></a><span>                     </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621681232910"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>                </span><span class="hs-identifier hs-var">errorMsg</span><span> </span><a href="#local-6989586621681232901"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">hang</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Warning:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-259"></a><span>                  </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Couldn't figure out C compiler information!&quot;</span><span> </span><span class="hs-operator hs-var">$$</span><span>
</span><a name="line-260"></a><span>                  </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Make sure you're using GNU gcc, or clang&quot;</span><span>
</span><a name="line-261"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">UnknownCC</span><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621681232911"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-263"></a></pre></body></html>