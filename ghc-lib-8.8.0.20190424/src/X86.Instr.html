<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">--</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Machine-dependent assembly language</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- (c) The University of Glasgow 1993-2004</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">X86.Instr</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#PrefetchVariant"><span class="hs-identifier hs-type">PrefetchVariant</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>                  </span><a href="X86.Instr.html#getJumpDestBlockId"><span class="hs-identifier hs-var">getJumpDestBlockId</span></a><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#canShortcut"><span class="hs-identifier hs-var">canShortcut</span></a><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#shortcutStatics"><span class="hs-identifier hs-var">shortcutStatics</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>                  </span><a href="X86.Instr.html#shortcutJump"><span class="hs-identifier hs-var">shortcutJump</span></a><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#i386_insert_ffrees"><span class="hs-identifier hs-var">i386_insert_ffrees</span></a><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#allocMoreStack"><span class="hs-identifier hs-var">allocMoreStack</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>                  </span><a href="X86.Instr.html#maxSpillSlots"><span class="hs-identifier hs-var">maxSpillSlots</span></a><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
#include &quot;nativeGen/NCG.h&quot;
</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPrelude</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="X86.Cond.html"><span class="hs-identifier">X86.Cond</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="X86.Regs.html"><span class="hs-identifier">X86.Regs</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Instruction.html"><span class="hs-identifier">Instruction</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Format.html"><span class="hs-identifier">Format</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="RegClass.html"><span class="hs-identifier">RegClass</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Reg.html"><span class="hs-identifier">Reg</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="TargetReg.html"><span class="hs-identifier">TargetReg</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="BlockId.html"><span class="hs-identifier">BlockId</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Hoopl.Collections.html"><span class="hs-identifier">Hoopl.Collections</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Hoopl.Label.html"><span class="hs-identifier">Hoopl.Label</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="CodeGen.Platform.html"><span class="hs-identifier">CodeGen.Platform</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Cmm.html"><span class="hs-identifier">Cmm</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">FastString</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Platform</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">BasicTypes</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Alignment</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="CLabel.html"><span class="hs-identifier">CLabel</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">DynFlags</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UniqSet</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">UniqSupply</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="Debug.html"><span class="hs-identifier">Debug</span></a><span> </span><span class="hs-special">(</span><a href="Debug.html#UnwindTable"><span class="hs-identifier hs-type">UnwindTable</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- Format of an x86/x86_64 memory address, in bytes.</span><span>
</span><a name="line-51"></a><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span class="hs-identifier">archWordFormat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span>
</span><a name="line-53"></a><a name="archWordFormat"><a href="X86.Instr.html#archWordFormat"><span class="hs-identifier">archWordFormat</span></a></a><span> </span><a name="local-6989586621684412828"><a href="#local-6989586621684412828"><span class="hs-identifier">is32Bit</span></a></a><span>
</span><a name="line-54"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621684412828"><span class="hs-identifier hs-var">is32Bit</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span>
</span><a name="line-55"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | Instruction instance for x86 instruction set.</span><span>
</span><a name="line-58"></a><span class="hs-keyword">instance</span><span> </span><a href="Instruction.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-59"></a><span>        </span><a name="local-8214565720324910504"><a href="Instruction.html#regUsageOfInstr"><span class="hs-identifier">regUsageOfInstr</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_regUsageOfInstr"><span class="hs-identifier hs-var">x86_regUsageOfInstr</span></a><span>
</span><a name="line-60"></a><span>        </span><a name="local-8214565720324910505"><a href="Instruction.html#patchRegsOfInstr"><span class="hs-identifier">patchRegsOfInstr</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_patchRegsOfInstr"><span class="hs-identifier hs-var">x86_patchRegsOfInstr</span></a><span>
</span><a name="line-61"></a><span>        </span><a name="local-8214565720324910506"><a href="Instruction.html#isJumpishInstr"><span class="hs-identifier">isJumpishInstr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_isJumpishInstr"><span class="hs-identifier hs-var">x86_isJumpishInstr</span></a><span>
</span><a name="line-62"></a><span>        </span><a name="local-8214565720324910507"><a href="Instruction.html#jumpDestsOfInstr"><span class="hs-identifier">jumpDestsOfInstr</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_jumpDestsOfInstr"><span class="hs-identifier hs-var">x86_jumpDestsOfInstr</span></a><span>
</span><a name="line-63"></a><span>        </span><a name="local-8214565720324910508"><a href="Instruction.html#patchJumpInstr"><span class="hs-identifier">patchJumpInstr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_patchJumpInstr"><span class="hs-identifier hs-var">x86_patchJumpInstr</span></a><span>
</span><a name="line-64"></a><span>        </span><a name="local-8214565720324910509"><a href="Instruction.html#mkSpillInstr"><span class="hs-identifier">mkSpillInstr</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkSpillInstr"><span class="hs-identifier hs-var">x86_mkSpillInstr</span></a><span>
</span><a name="line-65"></a><span>        </span><a name="local-8214565720324910510"><a href="Instruction.html#mkLoadInstr"><span class="hs-identifier">mkLoadInstr</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkLoadInstr"><span class="hs-identifier hs-var">x86_mkLoadInstr</span></a><span>
</span><a name="line-66"></a><span>        </span><a name="local-8214565720324910511"><a href="Instruction.html#takeDeltaInstr"><span class="hs-identifier">takeDeltaInstr</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_takeDeltaInstr"><span class="hs-identifier hs-var">x86_takeDeltaInstr</span></a><span>
</span><a name="line-67"></a><span>        </span><a name="local-8214565720324910512"><a href="Instruction.html#isMetaInstr"><span class="hs-identifier">isMetaInstr</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_isMetaInstr"><span class="hs-identifier hs-var">x86_isMetaInstr</span></a><span>
</span><a name="line-68"></a><span>        </span><a name="local-8214565720324910513"><a href="Instruction.html#mkRegRegMoveInstr"><span class="hs-identifier">mkRegRegMoveInstr</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkRegRegMoveInstr"><span class="hs-identifier hs-var">x86_mkRegRegMoveInstr</span></a><span>
</span><a name="line-69"></a><span>        </span><a name="local-8214565720324910514"><a href="Instruction.html#takeRegRegMoveInstr"><span class="hs-identifier">takeRegRegMoveInstr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_takeRegRegMoveInstr"><span class="hs-identifier hs-var">x86_takeRegRegMoveInstr</span></a><span>
</span><a name="line-70"></a><span>        </span><a name="local-8214565720324910515"><a href="Instruction.html#mkJumpInstr"><span class="hs-identifier">mkJumpInstr</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkJumpInstr"><span class="hs-identifier hs-var">x86_mkJumpInstr</span></a><span>
</span><a name="line-71"></a><span>        </span><a name="local-8214565720324910516"><a href="Instruction.html#mkStackAllocInstr"><span class="hs-identifier">mkStackAllocInstr</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkStackAllocInstr"><span class="hs-identifier hs-var">x86_mkStackAllocInstr</span></a><span>
</span><a name="line-72"></a><span>        </span><a name="local-8214565720324910517"><a href="Instruction.html#mkStackDeallocInstr"><span class="hs-identifier">mkStackDeallocInstr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#x86_mkStackDeallocInstr"><span class="hs-identifier hs-var">x86_mkStackDeallocInstr</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- Intel x86 instructions</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">{-
Intel, in their infinite wisdom, selected a stack model for floating
point registers on x86.  That might have made sense back in 1979 --
nowadays we can see it for the nonsense it really is.  A stack model
fits poorly with the existing nativeGen infrastructure, which assumes
flat integer and FP register sets.  Prior to this commit, nativeGen
could not generate correct x86 FP code -- to do so would have meant
somehow working the register-stack paradigm into the register
allocator and spiller, which sounds very difficult.

We have decided to cheat, and go for a simple fix which requires no
infrastructure modifications, at the expense of generating ropey but
correct FP code.  All notions of the x86 FP stack and its insns have
been removed.  Instead, we pretend (to the instruction selector and
register allocator) that x86 has six floating point registers, %fake0
.. %fake5, which can be used in the usual flat manner.  We further
claim that x86 has floating point instructions very similar to SPARC
and Alpha, that is, a simple 3-operand register-register arrangement.
Code generation and register allocation proceed on this basis.

When we come to print out the final assembly, our convenient fiction
is converted to dismal reality.  Each fake instruction is
independently converted to a series of real x86 instructions.
%fake0 .. %fake5 are mapped to %st(0) .. %st(5).  To do reg-reg
arithmetic operations, the two operands are pushed onto the top of the
FP stack, the operation done, and the result copied back into the
relevant register.  There are only six %fake registers because 2 are
needed for the translation, and x86 has 8 in total.

The translation is inefficient but is simple and it works.  A cleverer
translation would handle a sequence of insns, simulating the FP stack
contents, would not impose a fixed mapping from %fake to %st regs, and
hopefully could avoid most of the redundant reg-reg moves of the
current translation.

We might as well make use of whatever unique FP facilities Intel have
chosen to bless us with (let's not be churlish, after all).
Hence GLDZ and GLD1.  Bwahahahahahahaha!
-}</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-
Note [x86 Floating point precision]

Intel's internal floating point registers are by default 80 bit
extended precision.  This means that all operations done on values in
registers are done at 80 bits, and unless the intermediate values are
truncated to the appropriate size (32 or 64 bits) by storing in
memory, calculations in registers will give different results from
calculations which pass intermediate values in memory (eg. via
function calls).

One solution is to set the FPU into 64 bit precision mode.  Some OSs
do this (eg. FreeBSD) and some don't (eg. Linux).  The problem here is
that this will only affect 64-bit precision arithmetic; 32-bit
calculations will still be done at 64-bit precision in registers.  So
it doesn't solve the whole problem.

There's also the issue of what the C library is expecting in terms of
precision.  It seems to be the case that glibc on Linux expects the
FPU to be set to 80 bit precision, so setting it to 64 bit could have
unexpected effects.  Changing the default could have undesirable
effects on other 3rd-party library code too, so the right thing would
be to save/restore the FPU control word across Haskell code if we were
to do this.

gcc's -ffloat-store gives consistent results by always storing the
results of floating-point calculations in memory, which works for both
32 and 64-bit precision.  However, it only affects the values of
user-declared floating point variables in C, not intermediate results.
GHC in -fvia-C mode uses -ffloat-store (see the -fexcess-precision
flag).

Another problem is how to spill floating point registers in the
register allocator.  Should we spill the whole 80 bits, or just 64?
On an OS which is set to 64 bit precision, spilling 64 is fine.  On
Linux, spilling 64 bits will round the results of some operations.
This is what gcc does.  Spilling at 80 bits requires taking up a full
128 bit slot (so we get alignment).  We spill at 80-bits and ignore
the alignment problems.

In the future [edit: now available in GHC 7.0.1, with the -msse2
flag], we'll use the SSE registers for floating point.  This requires
a CPU that supports SSE2 (ordinary SSE only supports 32 bit precision
float ops), which means P4 or Xeon and above.  Using SSE will solve
all these problems, because the SSE registers use fixed 32 bit or 64
bit precision.

--SDM 1/2003
-}</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-keyword">data</span><span> </span><a name="Instr"><a href="X86.Instr.html#Instr"><span class="hs-identifier">Instr</span></a></a><span>
</span><a name="line-169"></a><span>        </span><span class="hs-comment">-- comment pseudo-op</span><span>
</span><a name="line-170"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="COMMENT"><a href="X86.Instr.html#COMMENT"><span class="hs-identifier">COMMENT</span></a></a><span> </span><span class="hs-identifier hs-type">FastString</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>        </span><span class="hs-comment">-- location pseudo-op (file, line, col, name)</span><span>
</span><a name="line-173"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="LOCATION"><a href="X86.Instr.html#LOCATION"><span class="hs-identifier">LOCATION</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>        </span><span class="hs-comment">-- some static data spat out during code</span><span>
</span><a name="line-176"></a><span>        </span><span class="hs-comment">-- generation.  Will be extracted before</span><span>
</span><a name="line-177"></a><span>        </span><span class="hs-comment">-- pretty-printing.</span><span>
</span><a name="line-178"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="LDATA"><a href="X86.Instr.html#LDATA"><span class="hs-identifier">LDATA</span></a></a><span>   </span><a href="Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Alignment</span><span class="hs-special">,</span><span> </span><a href="Cmm.html#CmmStatics"><span class="hs-identifier hs-type">CmmStatics</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>        </span><span class="hs-comment">-- start a new basic block.  Useful during</span><span>
</span><a name="line-181"></a><span>        </span><span class="hs-comment">-- codegen, removed later.  Preceding</span><span>
</span><a name="line-182"></a><span>        </span><span class="hs-comment">-- instruction should be a jump, as per the</span><span>
</span><a name="line-183"></a><span>        </span><span class="hs-comment">-- invariants for a BasicBlock (see Cmm).</span><span>
</span><a name="line-184"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="NEWBLOCK"><a href="X86.Instr.html#NEWBLOCK"><span class="hs-identifier">NEWBLOCK</span></a></a><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span>        </span><span class="hs-comment">-- unwinding information</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- See Note [Unwinding information in the NCG].</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="UNWIND"><a href="X86.Instr.html#UNWIND"><span class="hs-identifier">UNWIND</span></a></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="Debug.html#UnwindTable"><span class="hs-identifier hs-type">UnwindTable</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span>        </span><span class="hs-comment">-- specify current stack offset for benefit of subsequent passes.</span><span>
</span><a name="line-191"></a><span>        </span><span class="hs-comment">-- This carries a BlockId so it can be used in unwinding information.</span><span>
</span><a name="line-192"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="DELTA"><a href="X86.Instr.html#DELTA"><span class="hs-identifier">DELTA</span></a></a><span>  </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>        </span><span class="hs-comment">-- Moves.</span><span>
</span><a name="line-195"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MOV"><a href="X86.Instr.html#MOV"><span class="hs-identifier">MOV</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-196"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CMOV"><a href="X86.Instr.html#CMOV"><span class="hs-identifier">CMOV</span></a></a><span>   </span><a href="X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a><span> </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>
</span><a name="line-197"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MOVZxL"><a href="X86.Instr.html#MOVZxL"><span class="hs-identifier">MOVZxL</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- format is the size of operand 1</span><span>
</span><a name="line-198"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MOVSxL"><a href="X86.Instr.html#MOVSxL"><span class="hs-identifier">MOVSxL</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- format is the size of operand 1</span><span>
</span><a name="line-199"></a><span>        </span><span class="hs-comment">-- x86_64 note: plain mov into a 32-bit register always zero-extends</span><span>
</span><a name="line-200"></a><span>        </span><span class="hs-comment">-- into the 64-bit reg, in contrast to the 8 and 16-bit movs which</span><span>
</span><a name="line-201"></a><span>        </span><span class="hs-comment">-- don't affect the high bits of the register.</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>        </span><span class="hs-comment">-- Load effective address (also a very useful three-operand add instruction :-)</span><span>
</span><a name="line-204"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="LEA"><a href="X86.Instr.html#LEA"><span class="hs-identifier">LEA</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>        </span><span class="hs-comment">-- Int Arithmetic.</span><span>
</span><a name="line-207"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="ADD"><a href="X86.Instr.html#ADD"><span class="hs-identifier">ADD</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-208"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="ADC"><a href="X86.Instr.html#ADC"><span class="hs-identifier">ADC</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-209"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SUB"><a href="X86.Instr.html#SUB"><span class="hs-identifier">SUB</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-210"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SBB"><a href="X86.Instr.html#SBB"><span class="hs-identifier">SBB</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MUL"><a href="X86.Instr.html#MUL"><span class="hs-identifier">MUL</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-213"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MUL2"><a href="X86.Instr.html#MUL2"><span class="hs-identifier">MUL2</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>         </span><span class="hs-comment">-- %edx:%eax = operand * %rax</span><span>
</span><a name="line-214"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="IMUL"><a href="X86.Instr.html#IMUL"><span class="hs-identifier">IMUL</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- signed int mul</span><span>
</span><a name="line-215"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="IMUL2"><a href="X86.Instr.html#IMUL2"><span class="hs-identifier">IMUL2</span></a></a><span>       </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>         </span><span class="hs-comment">-- %edx:%eax = operand * %eax</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="DIV"><a href="X86.Instr.html#DIV"><span class="hs-identifier">DIV</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>         </span><span class="hs-comment">-- eax := eax:edx/op, edx := eax:edx%op</span><span>
</span><a name="line-218"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="IDIV"><a href="X86.Instr.html#IDIV"><span class="hs-identifier">IDIV</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>         </span><span class="hs-comment">-- ditto, but signed</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span>        </span><span class="hs-comment">-- Int Arithmetic, where the effects on the condition register</span><span>
</span><a name="line-221"></a><span>        </span><span class="hs-comment">-- are important. Used in specialized sequences such as MO_Add2.</span><span>
</span><a name="line-222"></a><span>        </span><span class="hs-comment">-- Do not rewrite these instructions to &quot;equivalent&quot; ones that</span><span>
</span><a name="line-223"></a><span>        </span><span class="hs-comment">-- have different effect on the condition register! (See #9013.)</span><span>
</span><a name="line-224"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="ADD_CC"><a href="X86.Instr.html#ADD_CC"><span class="hs-identifier">ADD_CC</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-225"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SUB_CC"><a href="X86.Instr.html#SUB_CC"><span class="hs-identifier">SUB_CC</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span>        </span><span class="hs-comment">-- Simple bit-twiddling.</span><span>
</span><a name="line-228"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="AND"><a href="X86.Instr.html#AND"><span class="hs-identifier">AND</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-229"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="OR"><a href="X86.Instr.html#OR"><span class="hs-identifier">OR</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-230"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="XOR"><a href="X86.Instr.html#XOR"><span class="hs-identifier">XOR</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-231"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="NOT"><a href="X86.Instr.html#NOT"><span class="hs-identifier">NOT</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-232"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="NEGI"><a href="X86.Instr.html#NEGI"><span class="hs-identifier">NEGI</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>         </span><span class="hs-comment">-- NEG instruction (name clash with Cond)</span><span>
</span><a name="line-233"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="BSWAP"><a href="X86.Instr.html#BSWAP"><span class="hs-identifier">BSWAP</span></a></a><span>       </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span>        </span><span class="hs-comment">-- Shifts (amount may be immediate or %cl only)</span><span>
</span><a name="line-236"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SHL"><a href="X86.Instr.html#SHL"><span class="hs-identifier">SHL</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span class="hs-comment">{-amount-}</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-237"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SAR"><a href="X86.Instr.html#SAR"><span class="hs-identifier">SAR</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span class="hs-comment">{-amount-}</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-238"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SHR"><a href="X86.Instr.html#SHR"><span class="hs-identifier">SHR</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span class="hs-comment">{-amount-}</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="BT"><a href="X86.Instr.html#BT"><span class="hs-identifier">BT</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Regs.html#Imm"><span class="hs-identifier hs-type">Imm</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-241"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="NOP"><a href="X86.Instr.html#NOP"><span class="hs-identifier">NOP</span></a></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>        </span><span class="hs-comment">-- x86 Float Arithmetic.</span><span>
</span><a name="line-244"></a><span>        </span><span class="hs-comment">-- Note that we cheat by treating G{ABS,MOV,NEG} of doubles</span><span>
</span><a name="line-245"></a><span>        </span><span class="hs-comment">-- as single instructions right up until we spit them out.</span><span>
</span><a name="line-246"></a><span>        </span><span class="hs-comment">-- all the 3-operand fake fp insns are src1 src2 dst</span><span>
</span><a name="line-247"></a><span>        </span><span class="hs-comment">-- and furthermore are constrained to be fp regs only.</span><span>
</span><a name="line-248"></a><span>        </span><span class="hs-comment">-- IMPORTANT: keep is_G_insn up to date with any changes here</span><span>
</span><a name="line-249"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GMOV"><a href="X86.Instr.html#GMOV"><span class="hs-identifier">GMOV</span></a></a><span>        </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(fpreg), dst(fpreg)</span><span>
</span><a name="line-250"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GLD"><a href="X86.Instr.html#GLD"><span class="hs-identifier">GLD</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst(fpreg)</span><span>
</span><a name="line-251"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GST"><a href="X86.Instr.html#GST"><span class="hs-identifier">GST</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a><span> </span><span class="hs-comment">-- src(fpreg), dst</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GLDZ"><a href="X86.Instr.html#GLDZ"><span class="hs-identifier">GLDZ</span></a></a><span>        </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- dst(fpreg)</span><span>
</span><a name="line-254"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GLD1"><a href="X86.Instr.html#GLD1"><span class="hs-identifier">GLD1</span></a></a><span>        </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- dst(fpreg)</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GFTOI"><a href="X86.Instr.html#GFTOI"><span class="hs-identifier">GFTOI</span></a></a><span>       </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(fpreg), dst(intreg)</span><span>
</span><a name="line-257"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GDTOI"><a href="X86.Instr.html#GDTOI"><span class="hs-identifier">GDTOI</span></a></a><span>       </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(fpreg), dst(intreg)</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GITOF"><a href="X86.Instr.html#GITOF"><span class="hs-identifier">GITOF</span></a></a><span>       </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(intreg), dst(fpreg)</span><span>
</span><a name="line-260"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GITOD"><a href="X86.Instr.html#GITOD"><span class="hs-identifier">GITOD</span></a></a><span>       </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(intreg), dst(fpreg)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GDTOF"><a href="X86.Instr.html#GDTOF"><span class="hs-identifier">GDTOF</span></a></a><span>       </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src(fpreg), dst(fpreg)</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GADD"><a href="X86.Instr.html#GADD"><span class="hs-identifier">GADD</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src1, src2, dst</span><span>
</span><a name="line-265"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GDIV"><a href="X86.Instr.html#GDIV"><span class="hs-identifier">GDIV</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src1, src2, dst</span><span>
</span><a name="line-266"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GSUB"><a href="X86.Instr.html#GSUB"><span class="hs-identifier">GSUB</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src1, src2, dst</span><span>
</span><a name="line-267"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GMUL"><a href="X86.Instr.html#GMUL"><span class="hs-identifier">GMUL</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src1, src2, dst</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span>                </span><span class="hs-comment">-- FP compare.  Cond must be `elem` [EQQ, NE, LE, LTT, GE, GTT]</span><span>
</span><a name="line-270"></a><span>                </span><span class="hs-comment">-- Compare src1 with src2; set the Zero flag iff the numbers are</span><span>
</span><a name="line-271"></a><span>                </span><span class="hs-comment">-- comparable and the comparison is True.  Subsequent code must</span><span>
</span><a name="line-272"></a><span>                </span><span class="hs-comment">-- test the %eflags zero flag regardless of the supplied Cond.</span><span>
</span><a name="line-273"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GCMP"><a href="X86.Instr.html#GCMP"><span class="hs-identifier">GCMP</span></a></a><span>        </span><a href="X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src1, src2</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GABS"><a href="X86.Instr.html#GABS"><span class="hs-identifier">GABS</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-276"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GNEG"><a href="X86.Instr.html#GNEG"><span class="hs-identifier">GNEG</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-277"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GSQRT"><a href="X86.Instr.html#GSQRT"><span class="hs-identifier">GSQRT</span></a></a><span>       </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-278"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GSIN"><a href="X86.Instr.html#GSIN"><span class="hs-identifier">GSIN</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-279"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GCOS"><a href="X86.Instr.html#GCOS"><span class="hs-identifier">GCOS</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-280"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GTAN"><a href="X86.Instr.html#GTAN"><span class="hs-identifier">GTAN</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="GFREE"><a href="X86.Instr.html#GFREE"><span class="hs-identifier">GFREE</span></a></a><span>         </span><span class="hs-comment">-- do ffree on all x86 regs; an ugly hack</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span>        </span><span class="hs-comment">-- SSE2 floating point: we use a restricted set of the available SSE2</span><span>
</span><a name="line-286"></a><span>        </span><span class="hs-comment">-- instructions for floating-point.</span><span>
</span><a name="line-287"></a><span>        </span><span class="hs-comment">-- use MOV for moving (either movss or movsd (movlpd better?))</span><span>
</span><a name="line-288"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTSS2SD"><a href="X86.Instr.html#CVTSS2SD"><span class="hs-identifier">CVTSS2SD</span></a></a><span>      </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>            </span><span class="hs-comment">-- F32 to F64</span><span>
</span><a name="line-289"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTSD2SS"><a href="X86.Instr.html#CVTSD2SS"><span class="hs-identifier">CVTSD2SS</span></a></a><span>      </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>            </span><span class="hs-comment">-- F64 to F32</span><span>
</span><a name="line-290"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTTSS2SIQ"><a href="X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier">CVTTSS2SIQ</span></a></a><span>    </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- F32 to I32/I64 (with truncation)</span><span>
</span><a name="line-291"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTTSD2SIQ"><a href="X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier">CVTTSD2SIQ</span></a></a><span>    </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- F64 to I32/I64 (with truncation)</span><span>
</span><a name="line-292"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTSI2SS"><a href="X86.Instr.html#CVTSI2SS"><span class="hs-identifier">CVTSI2SS</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- I32/I64 to F32</span><span>
</span><a name="line-293"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CVTSI2SD"><a href="X86.Instr.html#CVTSI2SD"><span class="hs-identifier">CVTSI2SD</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- I32/I64 to F64</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span>        </span><span class="hs-comment">-- use ADD, SUB, and SQRT for arithmetic.  In both cases, operands</span><span>
</span><a name="line-296"></a><span>        </span><span class="hs-comment">-- are  Operand Reg.</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span>        </span><span class="hs-comment">-- SSE2 floating-point division:</span><span>
</span><a name="line-299"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="FDIV"><a href="X86.Instr.html#FDIV"><span class="hs-identifier">FDIV</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>   </span><span class="hs-comment">-- divisor, dividend(dst)</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span>        </span><span class="hs-comment">-- use CMP for comparisons.  ucomiss and ucomisd instructions</span><span>
</span><a name="line-302"></a><span>        </span><span class="hs-comment">-- compare single/double prec floating point respectively.</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SQRT"><a href="X86.Instr.html#SQRT"><span class="hs-identifier">SQRT</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>      </span><span class="hs-comment">-- src, dst</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span>        </span><span class="hs-comment">-- Comparison</span><span>
</span><a name="line-308"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="TEST"><a href="X86.Instr.html#TEST"><span class="hs-identifier">TEST</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-309"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CMP"><a href="X86.Instr.html#CMP"><span class="hs-identifier">CMP</span></a></a><span>           </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-310"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SETCC"><a href="X86.Instr.html#SETCC"><span class="hs-identifier">SETCC</span></a></a><span>         </span><a href="X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span>        </span><span class="hs-comment">-- Stack Operations.</span><span>
</span><a name="line-313"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="PUSH"><a href="X86.Instr.html#PUSH"><span class="hs-identifier">PUSH</span></a></a><span>          </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-314"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="POP"><a href="X86.Instr.html#POP"><span class="hs-identifier">POP</span></a></a><span>           </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>
</span><a name="line-315"></a><span>        </span><span class="hs-comment">-- both unused (SDM):</span><span>
</span><a name="line-316"></a><span>        </span><span class="hs-comment">--  | PUSHA</span><span>
</span><a name="line-317"></a><span>        </span><span class="hs-comment">--  | POPA</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span>        </span><span class="hs-comment">-- Jumping around.</span><span>
</span><a name="line-320"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="JMP"><a href="X86.Instr.html#JMP"><span class="hs-identifier">JMP</span></a></a><span>         </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-special">[</span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- including live Regs at the call</span><span>
</span><a name="line-321"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="JXX"><a href="X86.Instr.html#JXX"><span class="hs-identifier">JXX</span></a></a><span>         </span><a href="X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>  </span><span class="hs-comment">-- includes unconditional branches</span><span>
</span><a name="line-322"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="JXX_GBL"><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier">JXX_GBL</span></a></a><span>     </span><a href="X86.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a><span> </span><a href="X86.Regs.html#Imm"><span class="hs-identifier hs-type">Imm</span></a><span>      </span><span class="hs-comment">-- non-local version of JXX</span><span>
</span><a name="line-323"></a><span>        </span><span class="hs-comment">-- Table jump</span><span>
</span><a name="line-324"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="JMP_TBL"><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier">JMP_TBL</span></a></a><span>     </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span>   </span><span class="hs-comment">-- Address to jump to</span><span>
</span><a name="line-325"></a><span>                      </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Targets of the jump table</span><span>
</span><a name="line-326"></a><span>                      </span><a href="Cmm.html#Section"><span class="hs-identifier hs-type">Section</span></a><span>   </span><span class="hs-comment">-- Data section jump table should be put in</span><span>
</span><a name="line-327"></a><span>                      </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span>    </span><span class="hs-comment">-- Label of jump table</span><span>
</span><a name="line-328"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CALL"><a href="X86.Instr.html#CALL"><span class="hs-identifier">CALL</span></a></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="X86.Regs.html#Imm"><span class="hs-identifier hs-type">Imm</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span>        </span><span class="hs-comment">-- Other things.</span><span>
</span><a name="line-331"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CLTD"><a href="X86.Instr.html#CLTD"><span class="hs-identifier">CLTD</span></a></a><span> </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span>            </span><span class="hs-comment">-- sign extend %eax into %edx:%eax</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="FETCHGOT"><a href="X86.Instr.html#FETCHGOT"><span class="hs-identifier">FETCHGOT</span></a></a><span>    </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>        </span><span class="hs-comment">-- pseudo-insn for ELF position-independent code</span><span>
</span><a name="line-334"></a><span>                                 </span><span class="hs-comment">-- pretty-prints as</span><span>
</span><a name="line-335"></a><span>                                 </span><span class="hs-comment">--       call 1f</span><span>
</span><a name="line-336"></a><span>                                 </span><span class="hs-comment">-- 1:    popl %reg</span><span>
</span><a name="line-337"></a><span>                                 </span><span class="hs-comment">--       addl __GLOBAL_OFFSET_TABLE__+.-1b, %reg</span><span>
</span><a name="line-338"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="FETCHPC"><a href="X86.Instr.html#FETCHPC"><span class="hs-identifier">FETCHPC</span></a></a><span>     </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>        </span><span class="hs-comment">-- pseudo-insn for Darwin position-independent code</span><span>
</span><a name="line-339"></a><span>                                 </span><span class="hs-comment">-- pretty-prints as</span><span>
</span><a name="line-340"></a><span>                                 </span><span class="hs-comment">--       call 1f</span><span>
</span><a name="line-341"></a><span>                                 </span><span class="hs-comment">-- 1:    popl %reg</span><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span>    </span><span class="hs-comment">-- bit counting instructions</span><span>
</span><a name="line-344"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="POPCNT"><a href="X86.Instr.html#POPCNT"><span class="hs-identifier">POPCNT</span></a></a><span>      </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- [SSE4.2] count number of bits set to 1</span><span>
</span><a name="line-345"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="BSF"><a href="X86.Instr.html#BSF"><span class="hs-identifier">BSF</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- bit scan forward</span><span>
</span><a name="line-346"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="BSR"><a href="X86.Instr.html#BSR"><span class="hs-identifier">BSR</span></a></a><span>         </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- bit scan reverse</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-comment">-- bit manipulation instructions</span><span>
</span><a name="line-349"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="PDEP"><a href="X86.Instr.html#PDEP"><span class="hs-identifier">PDEP</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- [BMI2] deposit bits to   the specified mask</span><span>
</span><a name="line-350"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="PEXT"><a href="X86.Instr.html#PEXT"><span class="hs-identifier">PEXT</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-comment">-- [BMI2] extract bits from the specified mask</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span>    </span><span class="hs-comment">-- prefetch</span><span>
</span><a name="line-353"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="PREFETCH"><a href="X86.Instr.html#PREFETCH"><span class="hs-identifier">PREFETCH</span></a></a><span>  </span><a href="X86.Instr.html#PrefetchVariant"><span class="hs-identifier hs-type">PrefetchVariant</span></a><span> </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- prefetch Variant, addr size, address to prefetch</span><span>
</span><a name="line-354"></a><span>                                        </span><span class="hs-comment">-- variant can be NTA, Lvl0, Lvl1, or Lvl2</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="LOCK"><a href="X86.Instr.html#LOCK"><span class="hs-identifier">LOCK</span></a></a><span>        </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-comment">-- lock prefix</span><span>
</span><a name="line-357"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="XADD"><a href="X86.Instr.html#XADD"><span class="hs-identifier">XADD</span></a></a><span>        </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- src (r), dst (r/m)</span><span>
</span><a name="line-358"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CMPXCHG"><a href="X86.Instr.html#CMPXCHG"><span class="hs-identifier">CMPXCHG</span></a></a><span>     </span><a href="Format.html#Format"><span class="hs-identifier hs-type">Format</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-comment">-- src (r), dst (r/m), eax implicit</span><span>
</span><a name="line-359"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="MFENCE"><a href="X86.Instr.html#MFENCE"><span class="hs-identifier">MFENCE</span></a></a><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span class="hs-keyword">data</span><span> </span><a name="PrefetchVariant"><a href="X86.Instr.html#PrefetchVariant"><span class="hs-identifier">PrefetchVariant</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NTA"><a href="X86.Instr.html#NTA"><span class="hs-identifier">NTA</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lvl0"><a href="X86.Instr.html#Lvl0"><span class="hs-identifier">Lvl0</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lvl1"><a href="X86.Instr.html#Lvl1"><span class="hs-identifier">Lvl1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lvl2"><a href="X86.Instr.html#Lvl2"><span class="hs-identifier">Lvl2</span></a></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-keyword">data</span><span> </span><a name="Operand"><a href="X86.Instr.html#Operand"><span class="hs-identifier">Operand</span></a></a><span>
</span><a name="line-365"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="OpReg"><a href="X86.Instr.html#OpReg"><span class="hs-identifier">OpReg</span></a></a><span>  </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>            </span><span class="hs-comment">-- register</span><span>
</span><a name="line-366"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="OpImm"><a href="X86.Instr.html#OpImm"><span class="hs-identifier">OpImm</span></a></a><span>  </span><a href="X86.Regs.html#Imm"><span class="hs-identifier hs-type">Imm</span></a><span>            </span><span class="hs-comment">-- immediate value</span><span>
</span><a name="line-367"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="OpAddr"><a href="X86.Instr.html#OpAddr"><span class="hs-identifier">OpAddr</span></a></a><span> </span><a href="X86.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a><span>       </span><span class="hs-comment">-- memory reference</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-comment">-- | Returns which registers are read and written as a (read, written)</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- pair.</span><span>
</span><a name="line-373"></a><span class="hs-identifier">x86_regUsageOfInstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-374"></a><a name="x86_regUsageOfInstr"><a href="X86.Instr.html#x86_regUsageOfInstr"><span class="hs-identifier">x86_regUsageOfInstr</span></a></a><span> </span><a name="local-6989586621684412829"><a href="#local-6989586621684412829"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684412830"><a href="#local-6989586621684412830"><span class="hs-identifier">instr</span></a></a><span>
</span><a name="line-375"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684412830"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-376"></a><span>    </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412885"><a href="#local-6989586621684412885"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412886"><a href="#local-6989586621684412886"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412831"><span class="hs-identifier hs-var">usageRW</span></a><span> </span><a href="#local-6989586621684412885"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412886"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-377"></a><span>    </span><a href="X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412887"><a href="#local-6989586621684412887"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412888"><a href="#local-6989586621684412888"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412887"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412888"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412888"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-378"></a><span>    </span><a href="X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412889"><a href="#local-6989586621684412889"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412890"><a href="#local-6989586621684412890"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412831"><span class="hs-identifier hs-var">usageRW</span></a><span> </span><a href="#local-6989586621684412889"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412890"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-379"></a><span>    </span><a href="X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412891"><a href="#local-6989586621684412891"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412892"><a href="#local-6989586621684412892"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412831"><span class="hs-identifier hs-var">usageRW</span></a><span> </span><a href="#local-6989586621684412891"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412892"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-380"></a><span>    </span><a href="X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412893"><a href="#local-6989586621684412893"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412894"><a href="#local-6989586621684412894"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412831"><span class="hs-identifier hs-var">usageRW</span></a><span> </span><a href="#local-6989586621684412893"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412894"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-381"></a><span>    </span><a href="X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412895"><a href="#local-6989586621684412895"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412896"><a href="#local-6989586621684412896"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412895"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412896"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-382"></a><span>    </span><a href="X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412897"><a href="#local-6989586621684412897"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412898"><a href="#local-6989586621684412898"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412897"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412898"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-383"></a><span>    </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412899"><a href="#local-6989586621684412899"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412900"><a href="#local-6989586621684412900"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412899"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412900"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-384"></a><span>    </span><a href="X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412901"><a href="#local-6989586621684412901"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412902"><a href="#local-6989586621684412902"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412901"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412902"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-385"></a><span>    </span><a href="X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412903"><a href="#local-6989586621684412903"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412904"><a href="#local-6989586621684412904"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412903"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412904"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span>    </span><span class="hs-comment">-- Result of IMULB will be in just in %ax</span><span>
</span><a name="line-388"></a><span>    </span><a href="X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a><span>  </span><a href="Format.html#II8"><span class="hs-identifier hs-var">II8</span></a><span> </span><a name="local-6989586621684412905"><a href="#local-6989586621684412905"><span class="hs-identifier">src</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412905"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">]</span><span>
</span><a name="line-389"></a><span>    </span><span class="hs-comment">-- Result of IMUL for wider values, will be split between %dx/%edx/%rdx and</span><span>
</span><a name="line-390"></a><span>    </span><span class="hs-comment">-- %ax/%eax/%rax.</span><span>
</span><a name="line-391"></a><span>    </span><a href="X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412906"><a href="#local-6989586621684412906"><span class="hs-identifier">src</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412906"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">,</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-special">]</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span>    </span><a href="X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412907"><a href="#local-6989586621684412907"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412908"><a href="#local-6989586621684412908"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412907"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412908"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-394"></a><span>    </span><a href="X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412909"><a href="#local-6989586621684412909"><span class="hs-identifier">src</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412909"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">,</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-special">]</span><span>
</span><a name="line-395"></a><span>    </span><a href="X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412910"><a href="#local-6989586621684412910"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-glyph">:</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412910"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">,</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-special">]</span><span>
</span><a name="line-396"></a><span>    </span><a href="X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412911"><a href="#local-6989586621684412911"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-glyph">:</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412911"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">,</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-special">]</span><span>
</span><a name="line-397"></a><span>    </span><a href="X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412912"><a href="#local-6989586621684412912"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412913"><a href="#local-6989586621684412913"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412912"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412913"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-398"></a><span>    </span><a href="X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412914"><a href="#local-6989586621684412914"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412915"><a href="#local-6989586621684412915"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412914"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412915"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-399"></a><span>    </span><a href="X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412916"><a href="#local-6989586621684412916"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412917"><a href="#local-6989586621684412917"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412916"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412917"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-400"></a><span>    </span><a href="X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a><span>     </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412918"><a href="#local-6989586621684412918"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412919"><a href="#local-6989586621684412919"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412918"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412919"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span>    </span><a href="X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412920"><a href="#local-6989586621684412920"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412921"><a href="#local-6989586621684412921"><span class="hs-identifier">dst</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621684412920"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621684412921"><span class="hs-identifier hs-var">dst</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412921"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span>    </span><a href="X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412922"><a href="#local-6989586621684412922"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412923"><a href="#local-6989586621684412923"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412922"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684412923"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-406"></a><span>    </span><a href="X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412924"><a href="#local-6989586621684412924"><span class="hs-identifier">op</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412835"><span class="hs-identifier hs-var">usageM</span></a><span> </span><a href="#local-6989586621684412924"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-407"></a><span>    </span><a href="X86.Instr.html#BSWAP"><span class="hs-identifier hs-var">BSWAP</span></a><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412925"><a href="#local-6989586621684412925"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412925"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412925"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-408"></a><span>    </span><a href="X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412926"><a href="#local-6989586621684412926"><span class="hs-identifier">op</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412835"><span class="hs-identifier hs-var">usageM</span></a><span> </span><a href="#local-6989586621684412926"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-409"></a><span>    </span><a href="X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412927"><a href="#local-6989586621684412927"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684412928"><a href="#local-6989586621684412928"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412927"><span class="hs-identifier hs-var">imm</span></a><span> </span><a href="#local-6989586621684412928"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-410"></a><span>    </span><a href="X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412929"><a href="#local-6989586621684412929"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684412930"><a href="#local-6989586621684412930"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412929"><span class="hs-identifier hs-var">imm</span></a><span> </span><a href="#local-6989586621684412930"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-411"></a><span>    </span><a href="X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412931"><a href="#local-6989586621684412931"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684412932"><a href="#local-6989586621684412932"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684412931"><span class="hs-identifier hs-var">imm</span></a><span> </span><a href="#local-6989586621684412932"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-412"></a><span>    </span><a href="X86.Instr.html#BT"><span class="hs-identifier hs-var">BT</span></a><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>   </span><a name="local-6989586621684412933"><a href="#local-6989586621684412933"><span class="hs-identifier">src</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412933"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span>    </span><a href="X86.Instr.html#PUSH"><span class="hs-identifier hs-var">PUSH</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412934"><a href="#local-6989586621684412934"><span class="hs-identifier">op</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412934"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>    </span><a href="X86.Instr.html#POP"><span class="hs-identifier hs-var">POP</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412935"><a href="#local-6989586621684412935"><span class="hs-identifier">op</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412836"><span class="hs-identifier hs-var">def_W</span></a><span> </span><a href="#local-6989586621684412935"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>    </span><a href="X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412936"><a href="#local-6989586621684412936"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412937"><a href="#local-6989586621684412937"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412936"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412937"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><a href="X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412938"><a href="#local-6989586621684412938"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412939"><a href="#local-6989586621684412939"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412938"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412939"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>    </span><a href="X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412940"><a href="#local-6989586621684412940"><span class="hs-identifier">op</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412836"><span class="hs-identifier hs-var">def_W</span></a><span> </span><a href="#local-6989586621684412940"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>    </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-420"></a><span>    </span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-421"></a><span>    </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span>     </span><a name="local-6989586621684412941"><a href="#local-6989586621684412941"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621684412942"><a href="#local-6989586621684412942"><span class="hs-identifier">regs</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412941"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621684412942"><span class="hs-identifier hs-var">regs</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>    </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a name="local-6989586621684412943"><a href="#local-6989586621684412943"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412943"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>    </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621684412944"><a href="#local-6989586621684412944"><span class="hs-identifier">params</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><a href="#local-6989586621684412944"><span class="hs-identifier hs-var">params</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#callClobberedRegs"><span class="hs-identifier hs-var">callClobberedRegs</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>    </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621684412945"><a href="#local-6989586621684412945"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684412946"><a href="#local-6989586621684412946"><span class="hs-identifier">params</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412945"><span class="hs-identifier hs-var">reg</span></a><span class="hs-glyph">:</span><a href="#local-6989586621684412946"><span class="hs-identifier hs-var">params</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#callClobberedRegs"><span class="hs-identifier hs-var">callClobberedRegs</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>    </span><a href="X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a><span>   </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#edx"><span class="hs-identifier hs-var">edx</span></a><span class="hs-special">]</span><span>
</span><a name="line-426"></a><span>    </span><a href="X86.Instr.html#NOP"><span class="hs-identifier hs-var">NOP</span></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span>    </span><a href="X86.Instr.html#GMOV"><span class="hs-identifier hs-var">GMOV</span></a><span>   </span><a name="local-6989586621684412947"><a href="#local-6989586621684412947"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412948"><a href="#local-6989586621684412948"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412947"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412948"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-429"></a><span>    </span><a href="X86.Instr.html#GLD"><span class="hs-identifier hs-var">GLD</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412949"><a href="#local-6989586621684412949"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412950"><a href="#local-6989586621684412950"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412949"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412950"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-430"></a><span>    </span><a href="X86.Instr.html#GST"><span class="hs-identifier hs-var">GST</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412951"><a href="#local-6989586621684412951"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412952"><a href="#local-6989586621684412952"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412951"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412952"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>    </span><a href="X86.Instr.html#GLDZ"><span class="hs-identifier hs-var">GLDZ</span></a><span>   </span><a name="local-6989586621684412953"><a href="#local-6989586621684412953"><span class="hs-identifier">dst</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412953"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-433"></a><span>    </span><a href="X86.Instr.html#GLD1"><span class="hs-identifier hs-var">GLD1</span></a><span>   </span><a name="local-6989586621684412954"><a href="#local-6989586621684412954"><span class="hs-identifier">dst</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412954"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span>    </span><a href="X86.Instr.html#GFTOI"><span class="hs-identifier hs-var">GFTOI</span></a><span>  </span><a name="local-6989586621684412955"><a href="#local-6989586621684412955"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412956"><a href="#local-6989586621684412956"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412955"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412956"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-436"></a><span>    </span><a href="X86.Instr.html#GDTOI"><span class="hs-identifier hs-var">GDTOI</span></a><span>  </span><a name="local-6989586621684412957"><a href="#local-6989586621684412957"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412958"><a href="#local-6989586621684412958"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412957"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412958"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span>    </span><a href="X86.Instr.html#GITOF"><span class="hs-identifier hs-var">GITOF</span></a><span>  </span><a name="local-6989586621684412959"><a href="#local-6989586621684412959"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412960"><a href="#local-6989586621684412960"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412959"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412960"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-439"></a><span>    </span><a href="X86.Instr.html#GITOD"><span class="hs-identifier hs-var">GITOD</span></a><span>  </span><a name="local-6989586621684412961"><a href="#local-6989586621684412961"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412962"><a href="#local-6989586621684412962"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412961"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412962"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span>    </span><a href="X86.Instr.html#GDTOF"><span class="hs-identifier hs-var">GDTOF</span></a><span>  </span><a name="local-6989586621684412963"><a href="#local-6989586621684412963"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412964"><a href="#local-6989586621684412964"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412963"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412964"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span>    </span><a href="X86.Instr.html#GADD"><span class="hs-identifier hs-var">GADD</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412965"><a href="#local-6989586621684412965"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684412966"><a href="#local-6989586621684412966"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684412967"><a href="#local-6989586621684412967"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412965"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621684412966"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412967"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-444"></a><span>    </span><a href="X86.Instr.html#GSUB"><span class="hs-identifier hs-var">GSUB</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412968"><a href="#local-6989586621684412968"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684412969"><a href="#local-6989586621684412969"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684412970"><a href="#local-6989586621684412970"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412968"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621684412969"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412970"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-445"></a><span>    </span><a href="X86.Instr.html#GMUL"><span class="hs-identifier hs-var">GMUL</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412971"><a href="#local-6989586621684412971"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684412972"><a href="#local-6989586621684412972"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684412973"><a href="#local-6989586621684412973"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412971"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621684412972"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412973"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-446"></a><span>    </span><a href="X86.Instr.html#GDIV"><span class="hs-identifier hs-var">GDIV</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412974"><a href="#local-6989586621684412974"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684412975"><a href="#local-6989586621684412975"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684412976"><a href="#local-6989586621684412976"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412974"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621684412975"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412976"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span>    </span><a href="X86.Instr.html#GCMP"><span class="hs-identifier hs-var">GCMP</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412977"><a href="#local-6989586621684412977"><span class="hs-identifier">src1</span></a></a><span> </span><a name="local-6989586621684412978"><a href="#local-6989586621684412978"><span class="hs-identifier">src2</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412977"><span class="hs-identifier hs-var">src1</span></a><span class="hs-special">,</span><a href="#local-6989586621684412978"><span class="hs-identifier hs-var">src2</span></a><span class="hs-special">]</span><span>
</span><a name="line-449"></a><span>    </span><a href="X86.Instr.html#GABS"><span class="hs-identifier hs-var">GABS</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412979"><a href="#local-6989586621684412979"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412980"><a href="#local-6989586621684412980"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412979"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412980"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-450"></a><span>    </span><a href="X86.Instr.html#GNEG"><span class="hs-identifier hs-var">GNEG</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412981"><a href="#local-6989586621684412981"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412982"><a href="#local-6989586621684412982"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412981"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412982"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-451"></a><span>    </span><a href="X86.Instr.html#GSQRT"><span class="hs-identifier hs-var">GSQRT</span></a><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412983"><a href="#local-6989586621684412983"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412984"><a href="#local-6989586621684412984"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412983"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412984"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-452"></a><span>    </span><a href="X86.Instr.html#GSIN"><span class="hs-identifier hs-var">GSIN</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412985"><a href="#local-6989586621684412985"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412986"><a href="#local-6989586621684412986"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412985"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412986"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-453"></a><span>    </span><a href="X86.Instr.html#GCOS"><span class="hs-identifier hs-var">GCOS</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412987"><a href="#local-6989586621684412987"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412988"><a href="#local-6989586621684412988"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412987"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412988"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-454"></a><span>    </span><a href="X86.Instr.html#GTAN"><span class="hs-identifier hs-var">GTAN</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412989"><a href="#local-6989586621684412989"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412990"><a href="#local-6989586621684412990"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412989"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412990"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span>    </span><a href="X86.Instr.html#CVTSS2SD"><span class="hs-identifier hs-var">CVTSS2SD</span></a><span>   </span><a name="local-6989586621684412991"><a href="#local-6989586621684412991"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412992"><a href="#local-6989586621684412992"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412991"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412992"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-457"></a><span>    </span><a href="X86.Instr.html#CVTSD2SS"><span class="hs-identifier hs-var">CVTSD2SS</span></a><span>   </span><a name="local-6989586621684412993"><a href="#local-6989586621684412993"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412994"><a href="#local-6989586621684412994"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412993"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412994"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-458"></a><span>    </span><a href="X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier hs-var">CVTTSS2SIQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412995"><a href="#local-6989586621684412995"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412996"><a href="#local-6989586621684412996"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412995"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412996"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-459"></a><span>    </span><a href="X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier hs-var">CVTTSD2SIQ</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412997"><a href="#local-6989586621684412997"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412998"><a href="#local-6989586621684412998"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412997"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412998"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-460"></a><span>    </span><a href="X86.Instr.html#CVTSI2SS"><span class="hs-identifier hs-var">CVTSI2SS</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684412999"><a href="#local-6989586621684412999"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413000"><a href="#local-6989586621684413000"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412999"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413000"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-461"></a><span>    </span><a href="X86.Instr.html#CVTSI2SD"><span class="hs-identifier hs-var">CVTSI2SD</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413001"><a href="#local-6989586621684413001"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413002"><a href="#local-6989586621684413002"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413001"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413002"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-462"></a><span>    </span><a href="X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><a name="local-6989586621684413003"><a href="#local-6989586621684413003"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413004"><a href="#local-6989586621684413004"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412832"><span class="hs-identifier hs-var">usageRM</span></a><span> </span><a href="#local-6989586621684413003"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413004"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-463"></a><span>    </span><a href="X86.Instr.html#SQRT"><span class="hs-identifier hs-var">SQRT</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413005"><a href="#local-6989586621684413005"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413006"><a href="#local-6989586621684413006"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413005"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413006"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span>    </span><a href="X86.Instr.html#FETCHGOT"><span class="hs-identifier hs-var">FETCHGOT</span></a><span> </span><a name="local-6989586621684413007"><a href="#local-6989586621684413007"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413007"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-466"></a><span>    </span><a href="X86.Instr.html#FETCHPC"><span class="hs-identifier hs-var">FETCHPC</span></a><span>  </span><a name="local-6989586621684413008"><a href="#local-6989586621684413008"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413008"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span>    </span><a href="X86.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#noUsage"><span class="hs-identifier hs-var">noUsage</span></a><span>
</span><a name="line-469"></a><span>    </span><a href="X86.Instr.html#LOCATION"><span class="hs-identifier hs-var">LOCATION</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#noUsage"><span class="hs-identifier hs-var">noUsage</span></a><span>
</span><a name="line-470"></a><span>    </span><a href="X86.Instr.html#UNWIND"><span class="hs-identifier hs-var">UNWIND</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#noUsage"><span class="hs-identifier hs-var">noUsage</span></a><span>
</span><a name="line-471"></a><span>    </span><a href="X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a><span>   </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#noUsage"><span class="hs-identifier hs-var">noUsage</span></a><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span>    </span><a href="X86.Instr.html#POPCNT"><span class="hs-identifier hs-var">POPCNT</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413009"><a href="#local-6989586621684413009"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413010"><a href="#local-6989586621684413010"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413009"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413010"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-474"></a><span>    </span><a href="X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413011"><a href="#local-6989586621684413011"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413012"><a href="#local-6989586621684413012"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413011"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413012"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-475"></a><span>    </span><a href="X86.Instr.html#BSR"><span class="hs-identifier hs-var">BSR</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413013"><a href="#local-6989586621684413013"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413014"><a href="#local-6989586621684413014"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413013"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413014"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span>    </span><a href="X86.Instr.html#PDEP"><span class="hs-identifier hs-var">PDEP</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413015"><a href="#local-6989586621684413015"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413016"><a href="#local-6989586621684413016"><span class="hs-identifier">mask</span></a></a><span> </span><a name="local-6989586621684413017"><a href="#local-6989586621684413017"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413015"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413016"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413017"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-478"></a><span>    </span><a href="X86.Instr.html#PEXT"><span class="hs-identifier hs-var">PEXT</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413018"><a href="#local-6989586621684413018"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413019"><a href="#local-6989586621684413019"><span class="hs-identifier">mask</span></a></a><span> </span><a name="local-6989586621684413020"><a href="#local-6989586621684413020"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413018"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413019"><span class="hs-identifier hs-var">mask</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413020"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span>    </span><span class="hs-comment">-- note: might be a better way to do this</span><span>
</span><a name="line-481"></a><span>    </span><a href="X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413021"><a href="#local-6989586621684413021"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684413021"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-482"></a><span>    </span><a href="X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a><span> </span><a name="local-6989586621684413022"><a href="#local-6989586621684413022"><span class="hs-identifier">i</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#x86_regUsageOfInstr"><span class="hs-identifier hs-var">x86_regUsageOfInstr</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413022"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-483"></a><span>    </span><a href="X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413023"><a href="#local-6989586621684413023"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413024"><a href="#local-6989586621684413024"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412833"><span class="hs-identifier hs-var">usageMM</span></a><span> </span><a href="#local-6989586621684413023"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413024"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-484"></a><span>    </span><a href="X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-var">CMPXCHG</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413025"><a href="#local-6989586621684413025"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413026"><a href="#local-6989586621684413026"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684412834"><span class="hs-identifier hs-var">usageRMM</span></a><span> </span><a href="#local-6989586621684413025"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413026"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><span>    </span><a href="X86.Instr.html#MFENCE"><span class="hs-identifier hs-var">MFENCE</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#noUsage"><span class="hs-identifier hs-var">noUsage</span></a><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span>    </span><a name="local-6989586621684413027"><a href="#local-6989586621684413027"><span class="hs-identifier">_other</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;regUsage: unrecognised instr&quot;</span><span>
</span><a name="line-488"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-489"></a><span>    </span><span class="hs-comment">-- # Definitions</span><span>
</span><a name="line-490"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-491"></a><span>    </span><span class="hs-comment">-- Written: If the operand is a register, it's written. If it's an</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-comment">-- address, registers mentioned in the address are read.</span><span>
</span><a name="line-493"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-494"></a><span>    </span><span class="hs-comment">-- Modified: If the operand is a register, it's both read and</span><span>
</span><a name="line-495"></a><span>    </span><span class="hs-comment">-- written. If it's an address, registers mentioned in the address</span><span>
</span><a name="line-496"></a><span>    </span><span class="hs-comment">-- are read.</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span>    </span><span class="hs-comment">-- 2 operand form; first operand Read; second Written</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-identifier">usageRW</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-500"></a><span>    </span><a name="local-6989586621684412831"><a href="#local-6989586621684412831"><span class="hs-identifier">usageRW</span></a></a><span> </span><a name="local-6989586621684412841"><a href="#local-6989586621684412841"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412842"><a href="#local-6989586621684412842"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412841"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412842"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-501"></a><span>    </span><span class="hs-identifier">usageRW</span><span> </span><a name="local-6989586621684412843"><a href="#local-6989586621684412843"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412844"><a href="#local-6989586621684412844"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412843"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412844"><span class="hs-identifier hs-var">ea</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>    </span><span class="hs-identifier">usageRW</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.usageRW: no match&quot;</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span>    </span><span class="hs-comment">-- 2 operand form; first operand Read; second Modified</span><span>
</span><a name="line-505"></a><span>    </span><span class="hs-identifier">usageRM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-506"></a><span>    </span><a name="local-6989586621684412832"><a href="#local-6989586621684412832"><span class="hs-identifier">usageRM</span></a></a><span> </span><a name="local-6989586621684412845"><a href="#local-6989586621684412845"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412846"><a href="#local-6989586621684412846"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412845"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412846"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412846"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-507"></a><span>    </span><span class="hs-identifier">usageRM</span><span> </span><a name="local-6989586621684412847"><a href="#local-6989586621684412847"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412848"><a href="#local-6989586621684412848"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412837"><span class="hs-identifier hs-var">use_R</span></a><span> </span><a href="#local-6989586621684412847"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412848"><span class="hs-identifier hs-var">ea</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span>    </span><span class="hs-identifier">usageRM</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.usageRM: no match&quot;</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>    </span><span class="hs-comment">-- 2 operand form; first operand Modified; second Modified</span><span>
</span><a name="line-511"></a><span>    </span><span class="hs-identifier">usageMM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-512"></a><span>    </span><a name="local-6989586621684412833"><a href="#local-6989586621684412833"><span class="hs-identifier">usageMM</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412849"><a href="#local-6989586621684412849"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412850"><a href="#local-6989586621684412850"><span class="hs-identifier">dst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412849"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412850"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412849"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412850"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">]</span><span>
</span><a name="line-513"></a><span>    </span><span class="hs-identifier">usageMM</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412851"><a href="#local-6989586621684412851"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412852"><a href="#local-6989586621684412852"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412852"><span class="hs-identifier hs-var">ea</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412851"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412851"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">]</span><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier">usageMM</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.usageMM: no match&quot;</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span>    </span><span class="hs-comment">-- 3 operand form; first operand Read; second Modified; third Modified</span><span>
</span><a name="line-517"></a><span>    </span><span class="hs-identifier">usageRMM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-518"></a><span>    </span><a name="local-6989586621684412834"><a href="#local-6989586621684412834"><span class="hs-identifier">usageRMM</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412853"><a href="#local-6989586621684412853"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412854"><a href="#local-6989586621684412854"><span class="hs-identifier">dst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412855"><a href="#local-6989586621684412855"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412853"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412854"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412855"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412854"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412855"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-519"></a><span>    </span><span class="hs-identifier">usageRMM</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412856"><a href="#local-6989586621684412856"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412857"><a href="#local-6989586621684412857"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412858"><a href="#local-6989586621684412858"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412857"><span class="hs-identifier hs-var">ea</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412856"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684412858"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412858"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-520"></a><span>    </span><span class="hs-identifier">usageRMM</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.usageRMM: no match&quot;</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span>    </span><span class="hs-comment">-- 1 operand form; operand Modified</span><span>
</span><a name="line-523"></a><span>    </span><span class="hs-identifier">usageM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#RegUsage"><span class="hs-identifier hs-type">RegUsage</span></a><span>
</span><a name="line-524"></a><span>    </span><a name="local-6989586621684412835"><a href="#local-6989586621684412835"><span class="hs-identifier">usageM</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412859"><a href="#local-6989586621684412859"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412840"><span class="hs-identifier hs-var">mkRU</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412859"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412859"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-525"></a><span>    </span><span class="hs-identifier">usageM</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412860"><a href="#local-6989586621684412860"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412839"><span class="hs-identifier hs-var">mkRUR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412860"><span class="hs-identifier hs-var">ea</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span>    </span><span class="hs-identifier">usageM</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.usageM: no match&quot;</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span>    </span><span class="hs-comment">-- Registers defd when an operand is written.</span><span>
</span><a name="line-529"></a><span>    </span><a name="local-6989586621684412836"><a href="#local-6989586621684412836"><span class="hs-identifier">def_W</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412861"><a href="#local-6989586621684412861"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684412861"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">]</span><span>
</span><a name="line-530"></a><span>    </span><span class="hs-identifier">def_W</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-531"></a><span>    </span><span class="hs-identifier">def_W</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.def_W: no match&quot;</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span>    </span><span class="hs-comment">-- Registers used when an operand is read.</span><span>
</span><a name="line-534"></a><span>    </span><a name="local-6989586621684412837"><a href="#local-6989586621684412837"><span class="hs-identifier">use_R</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684412862"><a href="#local-6989586621684412862"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621684412863"><a href="#local-6989586621684412863"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412862"><span class="hs-identifier hs-var">reg</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684412863"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-535"></a><span>    </span><span class="hs-identifier">use_R</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><a name="local-6989586621684412864"><a href="#local-6989586621684412864"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412864"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-536"></a><span>    </span><span class="hs-identifier">use_R</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684412865"><a href="#local-6989586621684412865"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621684412866"><a href="#local-6989586621684412866"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412838"><span class="hs-identifier hs-var">use_EA</span></a><span> </span><a href="#local-6989586621684412865"><span class="hs-identifier hs-var">ea</span></a><span> </span><a href="#local-6989586621684412866"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span>    </span><span class="hs-comment">-- Registers used to compute an effective address.</span><span>
</span><a name="line-539"></a><span>    </span><a name="local-6989586621684412838"><a href="#local-6989586621684412838"><span class="hs-identifier">use_EA</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmAddr"><span class="hs-identifier hs-var">ImmAddr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621684412867"><a href="#local-6989586621684412867"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412867"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-540"></a><span>    </span><span class="hs-identifier">use_EA</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a><span> </span><a name="local-6989586621684412868"><a href="#local-6989586621684412868"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621684412869"><a href="#local-6989586621684412869"><span class="hs-identifier">index</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621684412870"><a href="#local-6989586621684412870"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-541"></a><span>        </span><a href="#local-6989586621684412871"><span class="hs-identifier hs-var">use_base</span></a><span> </span><a href="#local-6989586621684412868"><span class="hs-identifier hs-var">base</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684412872"><span class="hs-identifier hs-var">use_index</span></a><span> </span><a href="#local-6989586621684412869"><span class="hs-identifier hs-var">index</span></a><span> </span><a href="#local-6989586621684412870"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-542"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684412871"><a href="#local-6989586621684412871"><span class="hs-identifier">use_base</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a><span> </span><a name="local-6989586621684412873"><a href="#local-6989586621684412873"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621684412874"><a href="#local-6989586621684412874"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412873"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684412874"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-543"></a><span>              </span><span class="hs-identifier">use_base</span><span> </span><span class="hs-identifier">_</span><span>              </span><a name="local-6989586621684412875"><a href="#local-6989586621684412875"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412875"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-544"></a><span>              </span><a name="local-6989586621684412872"><a href="#local-6989586621684412872"><span class="hs-identifier">use_index</span></a></a><span> </span><a href="X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a><span>   </span><a name="local-6989586621684412876"><a href="#local-6989586621684412876"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412876"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-545"></a><span>              </span><span class="hs-identifier">use_index</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a><span> </span><a name="local-6989586621684412877"><a href="#local-6989586621684412877"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621684412878"><a href="#local-6989586621684412878"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412877"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684412878"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span>    </span><a name="local-6989586621684412839"><a href="#local-6989586621684412839"><span class="hs-identifier">mkRUR</span></a></a><span> </span><a name="local-6989586621684412879"><a href="#local-6989586621684412879"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412880"><span class="hs-identifier hs-var">src'</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Instruction.html#RU"><span class="hs-identifier hs-var">RU</span></a><span> </span><a href="#local-6989586621684412880"><span class="hs-identifier hs-var">src'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-548"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684412880"><a href="#local-6989586621684412880"><span class="hs-identifier">src'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#interesting"><span class="hs-identifier hs-var">interesting</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684412879"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-549"></a><span>
</span><a name="line-550"></a><span>    </span><a name="local-6989586621684412840"><a href="#local-6989586621684412840"><span class="hs-identifier">mkRU</span></a></a><span> </span><a name="local-6989586621684412881"><a href="#local-6989586621684412881"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684412882"><a href="#local-6989586621684412882"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684412883"><span class="hs-identifier hs-var">src'</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621684412884"><span class="hs-identifier hs-var">dst'</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Instruction.html#RU"><span class="hs-identifier hs-var">RU</span></a><span> </span><a href="#local-6989586621684412883"><span class="hs-identifier hs-var">src'</span></a><span> </span><a href="#local-6989586621684412884"><span class="hs-identifier hs-var">dst'</span></a><span>
</span><a name="line-551"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684412883"><a href="#local-6989586621684412883"><span class="hs-identifier">src'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#interesting"><span class="hs-identifier hs-var">interesting</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684412881"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-552"></a><span>              </span><a name="local-6989586621684412884"><a href="#local-6989586621684412884"><span class="hs-identifier">dst'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#interesting"><span class="hs-identifier hs-var">interesting</span></a><span> </span><a href="#local-6989586621684412829"><span class="hs-identifier hs-var">platform</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684412882"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-comment">-- | Is this register interesting for the register allocator?</span><span>
</span><a name="line-555"></a><span class="hs-identifier">interesting</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-556"></a><a name="interesting"><a href="X86.Instr.html#interesting"><span class="hs-identifier">interesting</span></a></a><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-special">(</span><a href="Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-557"></a><span class="hs-identifier">interesting</span><span> </span><a name="local-6989586621684413028"><a href="#local-6989586621684413028"><span class="hs-identifier">platform</span></a></a><span> </span><span class="hs-special">(</span><a href="Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a><span> </span><span class="hs-special">(</span><a href="Reg.html#RealRegSingle"><span class="hs-identifier hs-var">RealRegSingle</span></a><span> </span><a name="local-6989586621684413029"><a href="#local-6989586621684413029"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CodeGen.Platform.html#freeReg"><span class="hs-identifier hs-var">freeReg</span></a><span> </span><a href="#local-6989586621684413028"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413029"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-558"></a><span class="hs-identifier">interesting</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-special">(</span><a href="Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a><span> </span><span class="hs-special">(</span><a href="Reg.html#RealRegPair"><span class="hs-identifier hs-var">RealRegPair</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.interesting: no reg pairs on this arch&quot;</span><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">-- | Applies the supplied function to all registers in instructions.</span><span>
</span><a name="line-563"></a><span class="hs-comment">-- Typically used to change virtual registers to real registers.</span><span>
</span><a name="line-564"></a><span class="hs-identifier">x86_patchRegsOfInstr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-565"></a><a name="x86_patchRegsOfInstr"><a href="X86.Instr.html#x86_patchRegsOfInstr"><span class="hs-identifier">x86_patchRegsOfInstr</span></a></a><span> </span><a name="local-6989586621684413030"><a href="#local-6989586621684413030"><span class="hs-identifier">instr</span></a></a><span> </span><a name="local-6989586621684413031"><a href="#local-6989586621684413031"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-566"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-567"></a><span>    </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span>  </span><a name="local-6989586621684413056"><a href="#local-6989586621684413056"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413057"><a href="#local-6989586621684413057"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413058"><a href="#local-6989586621684413058"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span>  </span><a href="#local-6989586621684413056"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413057"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413058"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-568"></a><span>    </span><a href="X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a><span> </span><a name="local-6989586621684413059"><a href="#local-6989586621684413059"><span class="hs-identifier">cc</span></a></a><span> </span><a name="local-6989586621684413060"><a href="#local-6989586621684413060"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413061"><a href="#local-6989586621684413061"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413062"><a href="#local-6989586621684413062"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CMOV"><span class="hs-identifier hs-var">CMOV</span></a><span> </span><a href="#local-6989586621684413059"><span class="hs-identifier hs-var">cc</span></a><span> </span><a href="#local-6989586621684413060"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413061"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413062"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-569"></a><span>    </span><a href="X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a><span> </span><a name="local-6989586621684413063"><a href="#local-6989586621684413063"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413064"><a href="#local-6989586621684413064"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413065"><a href="#local-6989586621684413065"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MOVZxL"><span class="hs-identifier hs-var">MOVZxL</span></a><span> </span><a href="#local-6989586621684413063"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413064"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413065"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-570"></a><span>    </span><a href="X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a><span> </span><a name="local-6989586621684413066"><a href="#local-6989586621684413066"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413067"><a href="#local-6989586621684413067"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413068"><a href="#local-6989586621684413068"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MOVSxL"><span class="hs-identifier hs-var">MOVSxL</span></a><span> </span><a href="#local-6989586621684413066"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413067"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413068"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-571"></a><span>    </span><a href="X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a><span>  </span><a name="local-6989586621684413069"><a href="#local-6989586621684413069"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413070"><a href="#local-6989586621684413070"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413071"><a href="#local-6989586621684413071"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#LEA"><span class="hs-identifier hs-var">LEA</span></a><span>  </span><a href="#local-6989586621684413069"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413070"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413071"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-572"></a><span>    </span><a href="X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a><span>  </span><a name="local-6989586621684413072"><a href="#local-6989586621684413072"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413073"><a href="#local-6989586621684413073"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413074"><a href="#local-6989586621684413074"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a><span>  </span><a href="#local-6989586621684413072"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413073"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413074"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-573"></a><span>    </span><a href="X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a><span>  </span><a name="local-6989586621684413075"><a href="#local-6989586621684413075"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413076"><a href="#local-6989586621684413076"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413077"><a href="#local-6989586621684413077"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#ADC"><span class="hs-identifier hs-var">ADC</span></a><span>  </span><a href="#local-6989586621684413075"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413076"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413077"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-574"></a><span>    </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span>  </span><a name="local-6989586621684413078"><a href="#local-6989586621684413078"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413079"><a href="#local-6989586621684413079"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413080"><a href="#local-6989586621684413080"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span>  </span><a href="#local-6989586621684413078"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413079"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413080"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-575"></a><span>    </span><a href="X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a><span>  </span><a name="local-6989586621684413081"><a href="#local-6989586621684413081"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413082"><a href="#local-6989586621684413082"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413083"><a href="#local-6989586621684413083"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SBB"><span class="hs-identifier hs-var">SBB</span></a><span>  </span><a href="#local-6989586621684413081"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413082"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413083"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-576"></a><span>    </span><a href="X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a><span> </span><a name="local-6989586621684413084"><a href="#local-6989586621684413084"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413085"><a href="#local-6989586621684413085"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413086"><a href="#local-6989586621684413086"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#IMUL"><span class="hs-identifier hs-var">IMUL</span></a><span> </span><a href="#local-6989586621684413084"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413085"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413086"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-577"></a><span>    </span><a href="X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a><span> </span><a name="local-6989586621684413087"><a href="#local-6989586621684413087"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413088"><a href="#local-6989586621684413088"><span class="hs-identifier">src</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#IMUL2"><span class="hs-identifier hs-var">IMUL2</span></a><span> </span><a href="#local-6989586621684413087"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413088"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-578"></a><span>    </span><a href="X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a><span> </span><a name="local-6989586621684413089"><a href="#local-6989586621684413089"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413090"><a href="#local-6989586621684413090"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413091"><a href="#local-6989586621684413091"><span class="hs-identifier">dst</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a><span> </span><a href="#local-6989586621684413089"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413090"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413091"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-579"></a><span>    </span><a href="X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a><span> </span><a name="local-6989586621684413092"><a href="#local-6989586621684413092"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413093"><a href="#local-6989586621684413093"><span class="hs-identifier">src</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MUL2"><span class="hs-identifier hs-var">MUL2</span></a><span> </span><a href="#local-6989586621684413092"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413093"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-580"></a><span>    </span><a href="X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a><span> </span><a name="local-6989586621684413094"><a href="#local-6989586621684413094"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413095"><a href="#local-6989586621684413095"><span class="hs-identifier">op</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#IDIV"><span class="hs-identifier hs-var">IDIV</span></a><span> </span><a href="#local-6989586621684413094"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413095"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-581"></a><span>    </span><a href="X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a><span> </span><a name="local-6989586621684413096"><a href="#local-6989586621684413096"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413097"><a href="#local-6989586621684413097"><span class="hs-identifier">op</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a><span> </span><a href="#local-6989586621684413096"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413097"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-582"></a><span>    </span><a href="X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a><span> </span><a name="local-6989586621684413098"><a href="#local-6989586621684413098"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413099"><a href="#local-6989586621684413099"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413100"><a href="#local-6989586621684413100"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#ADD_CC"><span class="hs-identifier hs-var">ADD_CC</span></a><span> </span><a href="#local-6989586621684413098"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413099"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413100"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-583"></a><span>    </span><a href="X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a><span> </span><a name="local-6989586621684413101"><a href="#local-6989586621684413101"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413102"><a href="#local-6989586621684413102"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413103"><a href="#local-6989586621684413103"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SUB_CC"><span class="hs-identifier hs-var">SUB_CC</span></a><span> </span><a href="#local-6989586621684413101"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413102"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413103"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-584"></a><span>    </span><a href="X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a><span>  </span><a name="local-6989586621684413104"><a href="#local-6989586621684413104"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413105"><a href="#local-6989586621684413105"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413106"><a href="#local-6989586621684413106"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a><span>  </span><a href="#local-6989586621684413104"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413105"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413106"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-585"></a><span>    </span><a href="X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a><span>   </span><a name="local-6989586621684413107"><a href="#local-6989586621684413107"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413108"><a href="#local-6989586621684413108"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413109"><a href="#local-6989586621684413109"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a><span>   </span><a href="#local-6989586621684413107"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413108"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413109"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-586"></a><span>    </span><a href="X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a><span>  </span><a name="local-6989586621684413110"><a href="#local-6989586621684413110"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413111"><a href="#local-6989586621684413111"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413112"><a href="#local-6989586621684413112"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a><span>  </span><a href="#local-6989586621684413110"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413111"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413112"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-587"></a><span>    </span><a href="X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a><span>  </span><a name="local-6989586621684413113"><a href="#local-6989586621684413113"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413114"><a href="#local-6989586621684413114"><span class="hs-identifier">op</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#NOT"><span class="hs-identifier hs-var">NOT</span></a><span>  </span><a href="#local-6989586621684413113"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413114"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-588"></a><span>    </span><a href="X86.Instr.html#BSWAP"><span class="hs-identifier hs-var">BSWAP</span></a><span> </span><a name="local-6989586621684413115"><a href="#local-6989586621684413115"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413116"><a href="#local-6989586621684413116"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#BSWAP"><span class="hs-identifier hs-var">BSWAP</span></a><span> </span><a href="#local-6989586621684413115"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413116"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>    </span><a href="X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a><span> </span><a name="local-6989586621684413117"><a href="#local-6989586621684413117"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413118"><a href="#local-6989586621684413118"><span class="hs-identifier">op</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#NEGI"><span class="hs-identifier hs-var">NEGI</span></a><span> </span><a href="#local-6989586621684413117"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413118"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-590"></a><span>    </span><a href="X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a><span>  </span><a name="local-6989586621684413119"><a href="#local-6989586621684413119"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413120"><a href="#local-6989586621684413120"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684413121"><a href="#local-6989586621684413121"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SHL"><span class="hs-identifier hs-var">SHL</span></a><span> </span><a href="#local-6989586621684413119"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413120"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413121"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-591"></a><span>    </span><a href="X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a><span>  </span><a name="local-6989586621684413122"><a href="#local-6989586621684413122"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413123"><a href="#local-6989586621684413123"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684413124"><a href="#local-6989586621684413124"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SAR"><span class="hs-identifier hs-var">SAR</span></a><span> </span><a href="#local-6989586621684413122"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413123"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413124"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-592"></a><span>    </span><a href="X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a><span>  </span><a name="local-6989586621684413125"><a href="#local-6989586621684413125"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413126"><a href="#local-6989586621684413126"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684413127"><a href="#local-6989586621684413127"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SHR"><span class="hs-identifier hs-var">SHR</span></a><span> </span><a href="#local-6989586621684413125"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413126"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413127"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-593"></a><span>    </span><a href="X86.Instr.html#BT"><span class="hs-identifier hs-var">BT</span></a><span>   </span><a name="local-6989586621684413128"><a href="#local-6989586621684413128"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413129"><a href="#local-6989586621684413129"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684413130"><a href="#local-6989586621684413130"><span class="hs-identifier">src</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#BT"><span class="hs-identifier hs-var">BT</span></a><span>  </span><a href="#local-6989586621684413128"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413129"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413130"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-594"></a><span>    </span><a href="X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a><span> </span><a name="local-6989586621684413131"><a href="#local-6989586621684413131"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413132"><a href="#local-6989586621684413132"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413133"><a href="#local-6989586621684413133"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a><span> </span><a href="#local-6989586621684413131"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413132"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413133"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-595"></a><span>    </span><a href="X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a><span>  </span><a name="local-6989586621684413134"><a href="#local-6989586621684413134"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413135"><a href="#local-6989586621684413135"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413136"><a href="#local-6989586621684413136"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#CMP"><span class="hs-identifier hs-var">CMP</span></a><span>  </span><a href="#local-6989586621684413134"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413135"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413136"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-596"></a><span>    </span><a href="X86.Instr.html#PUSH"><span class="hs-identifier hs-var">PUSH</span></a><span> </span><a name="local-6989586621684413137"><a href="#local-6989586621684413137"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413138"><a href="#local-6989586621684413138"><span class="hs-identifier">op</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#PUSH"><span class="hs-identifier hs-var">PUSH</span></a><span> </span><a href="#local-6989586621684413137"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413138"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-597"></a><span>    </span><a href="X86.Instr.html#POP"><span class="hs-identifier hs-var">POP</span></a><span>  </span><a name="local-6989586621684413139"><a href="#local-6989586621684413139"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413140"><a href="#local-6989586621684413140"><span class="hs-identifier">op</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#POP"><span class="hs-identifier hs-var">POP</span></a><span>  </span><a href="#local-6989586621684413139"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413140"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-598"></a><span>    </span><a href="X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a><span> </span><a name="local-6989586621684413141"><a href="#local-6989586621684413141"><span class="hs-identifier">cond</span></a></a><span> </span><a name="local-6989586621684413142"><a href="#local-6989586621684413142"><span class="hs-identifier">op</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413032"><span class="hs-identifier hs-var">patch1</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#SETCC"><span class="hs-identifier hs-var">SETCC</span></a><span> </span><a href="#local-6989586621684413141"><span class="hs-identifier hs-var">cond</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413142"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-599"></a><span>    </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span> </span><a name="local-6989586621684413143"><a href="#local-6989586621684413143"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621684413144"><a href="#local-6989586621684413144"><span class="hs-identifier">regs</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413143"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413144"><span class="hs-identifier hs-var">regs</span></a><span>
</span><a name="line-600"></a><span>    </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a name="local-6989586621684413145"><a href="#local-6989586621684413145"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621684413146"><a href="#local-6989586621684413146"><span class="hs-identifier">ids</span></a></a><span> </span><a name="local-6989586621684413147"><a href="#local-6989586621684413147"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621684413148"><a href="#local-6989586621684413148"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413145"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413146"><span class="hs-identifier hs-var">ids</span></a><span> </span><a href="#local-6989586621684413147"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621684413148"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span>    </span><a href="X86.Instr.html#GMOV"><span class="hs-identifier hs-var">GMOV</span></a><span> </span><a name="local-6989586621684413149"><a href="#local-6989586621684413149"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413150"><a href="#local-6989586621684413150"><span class="hs-identifier">dst</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GMOV"><span class="hs-identifier hs-var">GMOV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413149"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413150"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>    </span><a href="X86.Instr.html#GLD"><span class="hs-identifier hs-var">GLD</span></a><span>  </span><a name="local-6989586621684413151"><a href="#local-6989586621684413151"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413152"><a href="#local-6989586621684413152"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413153"><a href="#local-6989586621684413153"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GLD"><span class="hs-identifier hs-var">GLD</span></a><span> </span><a href="#local-6989586621684413151"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413035"><span class="hs-identifier hs-var">lookupAddr</span></a><span> </span><a href="#local-6989586621684413152"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413153"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-604"></a><span>    </span><a href="X86.Instr.html#GST"><span class="hs-identifier hs-var">GST</span></a><span>  </span><a name="local-6989586621684413154"><a href="#local-6989586621684413154"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413155"><a href="#local-6989586621684413155"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413156"><a href="#local-6989586621684413156"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a href="#local-6989586621684413154"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413155"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413035"><span class="hs-identifier hs-var">lookupAddr</span></a><span> </span><a href="#local-6989586621684413156"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span>    </span><a href="X86.Instr.html#GLDZ"><span class="hs-identifier hs-var">GLDZ</span></a><span> </span><a name="local-6989586621684413157"><a href="#local-6989586621684413157"><span class="hs-identifier">dst</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GLDZ"><span class="hs-identifier hs-var">GLDZ</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413157"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-607"></a><span>    </span><a href="X86.Instr.html#GLD1"><span class="hs-identifier hs-var">GLD1</span></a><span> </span><a name="local-6989586621684413158"><a href="#local-6989586621684413158"><span class="hs-identifier">dst</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GLD1"><span class="hs-identifier hs-var">GLD1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413158"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span>    </span><a href="X86.Instr.html#GFTOI"><span class="hs-identifier hs-var">GFTOI</span></a><span> </span><a name="local-6989586621684413159"><a href="#local-6989586621684413159"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413160"><a href="#local-6989586621684413160"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GFTOI"><span class="hs-identifier hs-var">GFTOI</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413159"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413160"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>    </span><a href="X86.Instr.html#GDTOI"><span class="hs-identifier hs-var">GDTOI</span></a><span> </span><a name="local-6989586621684413161"><a href="#local-6989586621684413161"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413162"><a href="#local-6989586621684413162"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GDTOI"><span class="hs-identifier hs-var">GDTOI</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413161"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413162"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span>    </span><a href="X86.Instr.html#GITOF"><span class="hs-identifier hs-var">GITOF</span></a><span> </span><a name="local-6989586621684413163"><a href="#local-6989586621684413163"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413164"><a href="#local-6989586621684413164"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GITOF"><span class="hs-identifier hs-var">GITOF</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413163"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413164"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span>    </span><a href="X86.Instr.html#GITOD"><span class="hs-identifier hs-var">GITOD</span></a><span> </span><a name="local-6989586621684413165"><a href="#local-6989586621684413165"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413166"><a href="#local-6989586621684413166"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GITOD"><span class="hs-identifier hs-var">GITOD</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413165"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413166"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span>    </span><a href="X86.Instr.html#GDTOF"><span class="hs-identifier hs-var">GDTOF</span></a><span> </span><a name="local-6989586621684413167"><a href="#local-6989586621684413167"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413168"><a href="#local-6989586621684413168"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GDTOF"><span class="hs-identifier hs-var">GDTOF</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413167"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413168"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span>    </span><a href="X86.Instr.html#GADD"><span class="hs-identifier hs-var">GADD</span></a><span> </span><a name="local-6989586621684413169"><a href="#local-6989586621684413169"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413170"><a href="#local-6989586621684413170"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684413171"><a href="#local-6989586621684413171"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684413172"><a href="#local-6989586621684413172"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GADD"><span class="hs-identifier hs-var">GADD</span></a><span> </span><a href="#local-6989586621684413169"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413170"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413171"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413172"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>    </span><a href="X86.Instr.html#GSUB"><span class="hs-identifier hs-var">GSUB</span></a><span> </span><a name="local-6989586621684413173"><a href="#local-6989586621684413173"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413174"><a href="#local-6989586621684413174"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684413175"><a href="#local-6989586621684413175"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684413176"><a href="#local-6989586621684413176"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GSUB"><span class="hs-identifier hs-var">GSUB</span></a><span> </span><a href="#local-6989586621684413173"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413174"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413175"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413176"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span>    </span><a href="X86.Instr.html#GMUL"><span class="hs-identifier hs-var">GMUL</span></a><span> </span><a name="local-6989586621684413177"><a href="#local-6989586621684413177"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413178"><a href="#local-6989586621684413178"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684413179"><a href="#local-6989586621684413179"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684413180"><a href="#local-6989586621684413180"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GMUL"><span class="hs-identifier hs-var">GMUL</span></a><span> </span><a href="#local-6989586621684413177"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413178"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413179"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413180"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>    </span><a href="X86.Instr.html#GDIV"><span class="hs-identifier hs-var">GDIV</span></a><span> </span><a name="local-6989586621684413181"><a href="#local-6989586621684413181"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413182"><a href="#local-6989586621684413182"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621684413183"><a href="#local-6989586621684413183"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621684413184"><a href="#local-6989586621684413184"><span class="hs-identifier">dst</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GDIV"><span class="hs-identifier hs-var">GDIV</span></a><span> </span><a href="#local-6989586621684413181"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413182"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413183"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413184"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span>    </span><a href="X86.Instr.html#GCMP"><span class="hs-identifier hs-var">GCMP</span></a><span> </span><a name="local-6989586621684413185"><a href="#local-6989586621684413185"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413186"><a href="#local-6989586621684413186"><span class="hs-identifier">src1</span></a></a><span> </span><a name="local-6989586621684413187"><a href="#local-6989586621684413187"><span class="hs-identifier">src2</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GCMP"><span class="hs-identifier hs-var">GCMP</span></a><span> </span><a href="#local-6989586621684413185"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413186"><span class="hs-identifier hs-var">src1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413187"><span class="hs-identifier hs-var">src2</span></a><span class="hs-special">)</span><span>
</span><a name="line-623"></a><span>    </span><a href="X86.Instr.html#GABS"><span class="hs-identifier hs-var">GABS</span></a><span> </span><a name="local-6989586621684413188"><a href="#local-6989586621684413188"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413189"><a href="#local-6989586621684413189"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413190"><a href="#local-6989586621684413190"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GABS"><span class="hs-identifier hs-var">GABS</span></a><span> </span><a href="#local-6989586621684413188"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413189"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413190"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>    </span><a href="X86.Instr.html#GNEG"><span class="hs-identifier hs-var">GNEG</span></a><span> </span><a name="local-6989586621684413191"><a href="#local-6989586621684413191"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413192"><a href="#local-6989586621684413192"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413193"><a href="#local-6989586621684413193"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GNEG"><span class="hs-identifier hs-var">GNEG</span></a><span> </span><a href="#local-6989586621684413191"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413192"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413193"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>    </span><a href="X86.Instr.html#GSQRT"><span class="hs-identifier hs-var">GSQRT</span></a><span> </span><a name="local-6989586621684413194"><a href="#local-6989586621684413194"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413195"><a href="#local-6989586621684413195"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413196"><a href="#local-6989586621684413196"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GSQRT"><span class="hs-identifier hs-var">GSQRT</span></a><span> </span><a href="#local-6989586621684413194"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413195"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413196"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>    </span><a href="X86.Instr.html#GSIN"><span class="hs-identifier hs-var">GSIN</span></a><span> </span><a name="local-6989586621684413197"><a href="#local-6989586621684413197"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413198"><a href="#local-6989586621684413198"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621684413199"><a href="#local-6989586621684413199"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621684413200"><a href="#local-6989586621684413200"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413201"><a href="#local-6989586621684413201"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GSIN"><span class="hs-identifier hs-var">GSIN</span></a><span> </span><a href="#local-6989586621684413197"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413198"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621684413199"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413200"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413201"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span>    </span><a href="X86.Instr.html#GCOS"><span class="hs-identifier hs-var">GCOS</span></a><span> </span><a name="local-6989586621684413202"><a href="#local-6989586621684413202"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413203"><a href="#local-6989586621684413203"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621684413204"><a href="#local-6989586621684413204"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621684413205"><a href="#local-6989586621684413205"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413206"><a href="#local-6989586621684413206"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GCOS"><span class="hs-identifier hs-var">GCOS</span></a><span> </span><a href="#local-6989586621684413202"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413203"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621684413204"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413205"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413206"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-628"></a><span>    </span><a href="X86.Instr.html#GTAN"><span class="hs-identifier hs-var">GTAN</span></a><span> </span><a name="local-6989586621684413207"><a href="#local-6989586621684413207"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413208"><a href="#local-6989586621684413208"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621684413209"><a href="#local-6989586621684413209"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621684413210"><a href="#local-6989586621684413210"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413211"><a href="#local-6989586621684413211"><span class="hs-identifier">dst</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GTAN"><span class="hs-identifier hs-var">GTAN</span></a><span> </span><a href="#local-6989586621684413207"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621684413208"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621684413209"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413210"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413211"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span>    </span><a href="X86.Instr.html#CVTSS2SD"><span class="hs-identifier hs-var">CVTSS2SD</span></a><span> </span><a name="local-6989586621684413212"><a href="#local-6989586621684413212"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413213"><a href="#local-6989586621684413213"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTSS2SD"><span class="hs-identifier hs-var">CVTSS2SD</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413212"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413213"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-631"></a><span>    </span><a href="X86.Instr.html#CVTSD2SS"><span class="hs-identifier hs-var">CVTSD2SS</span></a><span> </span><a name="local-6989586621684413214"><a href="#local-6989586621684413214"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413215"><a href="#local-6989586621684413215"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTSD2SS"><span class="hs-identifier hs-var">CVTSD2SS</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413214"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413215"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-632"></a><span>    </span><a href="X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier hs-var">CVTTSS2SIQ</span></a><span> </span><a name="local-6989586621684413216"><a href="#local-6989586621684413216"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413217"><a href="#local-6989586621684413217"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413218"><a href="#local-6989586621684413218"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTTSS2SIQ"><span class="hs-identifier hs-var">CVTTSS2SIQ</span></a><span> </span><a href="#local-6989586621684413216"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413217"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413218"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>    </span><a href="X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier hs-var">CVTTSD2SIQ</span></a><span> </span><a name="local-6989586621684413219"><a href="#local-6989586621684413219"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413220"><a href="#local-6989586621684413220"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413221"><a href="#local-6989586621684413221"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTTSD2SIQ"><span class="hs-identifier hs-var">CVTTSD2SIQ</span></a><span> </span><a href="#local-6989586621684413219"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413220"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413221"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>    </span><a href="X86.Instr.html#CVTSI2SS"><span class="hs-identifier hs-var">CVTSI2SS</span></a><span> </span><a name="local-6989586621684413222"><a href="#local-6989586621684413222"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413223"><a href="#local-6989586621684413223"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413224"><a href="#local-6989586621684413224"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTSI2SS"><span class="hs-identifier hs-var">CVTSI2SS</span></a><span> </span><a href="#local-6989586621684413222"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413223"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413224"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>    </span><a href="X86.Instr.html#CVTSI2SD"><span class="hs-identifier hs-var">CVTSI2SD</span></a><span> </span><a name="local-6989586621684413225"><a href="#local-6989586621684413225"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413226"><a href="#local-6989586621684413226"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413227"><a href="#local-6989586621684413227"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CVTSI2SD"><span class="hs-identifier hs-var">CVTSI2SD</span></a><span> </span><a href="#local-6989586621684413225"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413226"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413227"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>    </span><a href="X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a><span> </span><a name="local-6989586621684413228"><a href="#local-6989586621684413228"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413229"><a href="#local-6989586621684413229"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413230"><a href="#local-6989586621684413230"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#FDIV"><span class="hs-identifier hs-var">FDIV</span></a><span> </span><a href="#local-6989586621684413228"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413229"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413230"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span>    </span><a href="X86.Instr.html#SQRT"><span class="hs-identifier hs-var">SQRT</span></a><span> </span><a name="local-6989586621684413231"><a href="#local-6989586621684413231"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413232"><a href="#local-6989586621684413232"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413233"><a href="#local-6989586621684413233"><span class="hs-identifier">dst</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#SQRT"><span class="hs-identifier hs-var">SQRT</span></a><span> </span><a href="#local-6989586621684413231"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413232"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413233"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span>    </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-640"></a><span>    </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621684413234"><a href="#local-6989586621684413234"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621684413235"><a href="#local-6989586621684413235"><span class="hs-identifier">p</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413234"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413235"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span>    </span><a href="X86.Instr.html#FETCHGOT"><span class="hs-identifier hs-var">FETCHGOT</span></a><span> </span><a name="local-6989586621684413236"><a href="#local-6989586621684413236"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#FETCHGOT"><span class="hs-identifier hs-var">FETCHGOT</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413236"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>    </span><a href="X86.Instr.html#FETCHPC"><span class="hs-identifier hs-var">FETCHPC</span></a><span>  </span><a name="local-6989586621684413237"><a href="#local-6989586621684413237"><span class="hs-identifier">reg</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#FETCHPC"><span class="hs-identifier hs-var">FETCHPC</span></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413237"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span>    </span><a href="X86.Instr.html#NOP"><span class="hs-identifier hs-var">NOP</span></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-646"></a><span>    </span><a href="X86.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-647"></a><span>    </span><a href="X86.Instr.html#LOCATION"><span class="hs-identifier hs-var">LOCATION</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-648"></a><span>    </span><a href="X86.Instr.html#UNWIND"><span class="hs-identifier hs-var">UNWIND</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-649"></a><span>    </span><a href="X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span>    </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-652"></a><span>    </span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-653"></a><span>    </span><a href="X86.Instr.html#CLTD"><span class="hs-identifier hs-var">CLTD</span></a><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span>    </span><a href="X86.Instr.html#POPCNT"><span class="hs-identifier hs-var">POPCNT</span></a><span> </span><a name="local-6989586621684413238"><a href="#local-6989586621684413238"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413239"><a href="#local-6989586621684413239"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413240"><a href="#local-6989586621684413240"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#POPCNT"><span class="hs-identifier hs-var">POPCNT</span></a><span> </span><a href="#local-6989586621684413238"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413239"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413240"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>    </span><a href="X86.Instr.html#PDEP"><span class="hs-identifier hs-var">PDEP</span></a><span>   </span><a name="local-6989586621684413241"><a href="#local-6989586621684413241"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413242"><a href="#local-6989586621684413242"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413243"><a href="#local-6989586621684413243"><span class="hs-identifier">mask</span></a></a><span> </span><a name="local-6989586621684413244"><a href="#local-6989586621684413244"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#PDEP"><span class="hs-identifier hs-var">PDEP</span></a><span>   </span><a href="#local-6989586621684413241"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413242"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413243"><span class="hs-identifier hs-var">mask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413244"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>    </span><a href="X86.Instr.html#PEXT"><span class="hs-identifier hs-var">PEXT</span></a><span>   </span><a name="local-6989586621684413245"><a href="#local-6989586621684413245"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413246"><a href="#local-6989586621684413246"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413247"><a href="#local-6989586621684413247"><span class="hs-identifier">mask</span></a></a><span> </span><a name="local-6989586621684413248"><a href="#local-6989586621684413248"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#PEXT"><span class="hs-identifier hs-var">PEXT</span></a><span>   </span><a href="#local-6989586621684413245"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413246"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413247"><span class="hs-identifier hs-var">mask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413248"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>    </span><a href="X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a><span>    </span><a name="local-6989586621684413249"><a href="#local-6989586621684413249"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413250"><a href="#local-6989586621684413250"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413251"><a href="#local-6989586621684413251"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#BSF"><span class="hs-identifier hs-var">BSF</span></a><span>    </span><a href="#local-6989586621684413249"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413250"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413251"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>    </span><a href="X86.Instr.html#BSR"><span class="hs-identifier hs-var">BSR</span></a><span>    </span><a name="local-6989586621684413252"><a href="#local-6989586621684413252"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413253"><a href="#local-6989586621684413253"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413254"><a href="#local-6989586621684413254"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#BSR"><span class="hs-identifier hs-var">BSR</span></a><span>    </span><a href="#local-6989586621684413252"><span class="hs-identifier hs-var">fmt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413253"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413254"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>
</span><a name="line-661"></a><span>    </span><a href="X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a><span> </span><a name="local-6989586621684413255"><a href="#local-6989586621684413255"><span class="hs-identifier">lvl</span></a></a><span> </span><a name="local-6989586621684413256"><a href="#local-6989586621684413256"><span class="hs-identifier">format</span></a></a><span> </span><a name="local-6989586621684413257"><a href="#local-6989586621684413257"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#PREFETCH"><span class="hs-identifier hs-var">PREFETCH</span></a><span> </span><a href="#local-6989586621684413255"><span class="hs-identifier hs-var">lvl</span></a><span> </span><a href="#local-6989586621684413256"><span class="hs-identifier hs-var">format</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413257"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>
</span><a name="line-663"></a><span>    </span><a href="X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a><span> </span><a name="local-6989586621684413258"><a href="#local-6989586621684413258"><span class="hs-identifier">i</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#LOCK"><span class="hs-identifier hs-var">LOCK</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#x86_patchRegsOfInstr"><span class="hs-identifier hs-var">x86_patchRegsOfInstr</span></a><span> </span><a href="#local-6989586621684413258"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>    </span><a href="X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a><span> </span><a name="local-6989586621684413259"><a href="#local-6989586621684413259"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413260"><a href="#local-6989586621684413260"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413261"><a href="#local-6989586621684413261"><span class="hs-identifier">dst</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#XADD"><span class="hs-identifier hs-var">XADD</span></a><span> </span><a href="#local-6989586621684413259"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413260"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413261"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-665"></a><span>    </span><a href="X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-var">CMPXCHG</span></a><span> </span><a name="local-6989586621684413262"><a href="#local-6989586621684413262"><span class="hs-identifier">fmt</span></a></a><span> </span><a name="local-6989586621684413263"><a href="#local-6989586621684413263"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413264"><a href="#local-6989586621684413264"><span class="hs-identifier">dst</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413033"><span class="hs-identifier hs-var">patch2</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#CMPXCHG"><span class="hs-identifier hs-var">CMPXCHG</span></a><span> </span><a href="#local-6989586621684413262"><span class="hs-identifier hs-var">fmt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413263"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413264"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-666"></a><span>    </span><a href="X86.Instr.html#MFENCE"><span class="hs-identifier hs-var">MFENCE</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413030"><span class="hs-identifier hs-var">instr</span></a><span>
</span><a name="line-667"></a><span>
</span><a name="line-668"></a><span>    </span><a name="local-6989586621684413265"><a href="#local-6989586621684413265"><span class="hs-identifier">_other</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;patchRegs: unrecognised instr&quot;</span><span>
</span><a name="line-669"></a><span>
</span><a name="line-670"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-671"></a><span>    </span><span class="hs-identifier">patch1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413036"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413036"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-672"></a><span>    </span><a name="local-6989586621684413032"><a href="#local-6989586621684413032"><span class="hs-identifier">patch1</span></a></a><span> </span><a name="local-6989586621684413038"><a href="#local-6989586621684413038"><span class="hs-identifier">insn</span></a></a><span> </span><a name="local-6989586621684413039"><a href="#local-6989586621684413039"><span class="hs-identifier">op</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413038"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413039"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-673"></a><span>    </span><span class="hs-identifier">patch2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413037"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413037"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-674"></a><span>    </span><a name="local-6989586621684413033"><a href="#local-6989586621684413033"><span class="hs-identifier">patch2</span></a></a><span> </span><a name="local-6989586621684413040"><a href="#local-6989586621684413040"><span class="hs-identifier">insn</span></a></a><span> </span><a name="local-6989586621684413041"><a href="#local-6989586621684413041"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413042"><a href="#local-6989586621684413042"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413040"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413041"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413034"><span class="hs-identifier hs-var">patchOp</span></a><span> </span><a href="#local-6989586621684413042"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span>    </span><a name="local-6989586621684413034"><a href="#local-6989586621684413034"><span class="hs-identifier">patchOp</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span>  </span><a name="local-6989586621684413043"><a href="#local-6989586621684413043"><span class="hs-identifier">reg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413043"><span class="hs-identifier hs-var">reg</span></a><span>
</span><a name="line-677"></a><span>    </span><span class="hs-identifier">patchOp</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span>  </span><a name="local-6989586621684413044"><a href="#local-6989586621684413044"><span class="hs-identifier">imm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><a href="#local-6989586621684413044"><span class="hs-identifier hs-var">imm</span></a><span>
</span><a name="line-678"></a><span>    </span><span class="hs-identifier">patchOp</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><a name="local-6989586621684413045"><a href="#local-6989586621684413045"><span class="hs-identifier">ea</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413035"><span class="hs-identifier hs-var">lookupAddr</span></a><span> </span><a href="#local-6989586621684413045"><span class="hs-identifier hs-var">ea</span></a><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span>    </span><a name="local-6989586621684413035"><a href="#local-6989586621684413035"><span class="hs-identifier">lookupAddr</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmAddr"><span class="hs-identifier hs-var">ImmAddr</span></a><span> </span><a name="local-6989586621684413046"><a href="#local-6989586621684413046"><span class="hs-identifier">imm</span></a></a><span> </span><a name="local-6989586621684413047"><a href="#local-6989586621684413047"><span class="hs-identifier">off</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="X86.Regs.html#ImmAddr"><span class="hs-identifier hs-var">ImmAddr</span></a><span> </span><a href="#local-6989586621684413046"><span class="hs-identifier hs-var">imm</span></a><span> </span><a href="#local-6989586621684413047"><span class="hs-identifier hs-var">off</span></a><span>
</span><a name="line-681"></a><span>    </span><span class="hs-identifier">lookupAddr</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a><span> </span><a name="local-6989586621684413048"><a href="#local-6989586621684413048"><span class="hs-identifier">base</span></a></a><span> </span><a name="local-6989586621684413049"><a href="#local-6989586621684413049"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-6989586621684413050"><a href="#local-6989586621684413050"><span class="hs-identifier">disp</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="X86.Regs.html#AddrBaseIndex"><span class="hs-identifier hs-var">AddrBaseIndex</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413051"><span class="hs-identifier hs-var">lookupBase</span></a><span> </span><a href="#local-6989586621684413048"><span class="hs-identifier hs-var">base</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413052"><span class="hs-identifier hs-var">lookupIndex</span></a><span> </span><a href="#local-6989586621684413049"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413050"><span class="hs-identifier hs-var">disp</span></a><span>
</span><a name="line-683"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-684"></a><span>        </span><a name="local-6989586621684413051"><a href="#local-6989586621684413051"><span class="hs-identifier">lookupBase</span></a></a><span> </span><a href="X86.Regs.html#EABaseNone"><span class="hs-identifier hs-var">EABaseNone</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="X86.Regs.html#EABaseNone"><span class="hs-identifier hs-var">EABaseNone</span></a><span>
</span><a name="line-685"></a><span>        </span><span class="hs-identifier">lookupBase</span><span> </span><a href="X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="X86.Regs.html#EABaseRip"><span class="hs-identifier hs-var">EABaseRip</span></a><span>
</span><a name="line-686"></a><span>        </span><span class="hs-identifier">lookupBase</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a><span> </span><a name="local-6989586621684413053"><a href="#local-6989586621684413053"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="X86.Regs.html#EABaseReg"><span class="hs-identifier hs-var">EABaseReg</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413053"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span>        </span><a name="local-6989586621684413052"><a href="#local-6989586621684413052"><span class="hs-identifier">lookupIndex</span></a></a><span> </span><a href="X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="X86.Regs.html#EAIndexNone"><span class="hs-identifier hs-var">EAIndexNone</span></a><span>
</span><a name="line-689"></a><span>        </span><span class="hs-identifier">lookupIndex</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a><span> </span><a name="local-6989586621684413054"><a href="#local-6989586621684413054"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621684413055"><a href="#local-6989586621684413055"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#EAIndex"><span class="hs-identifier hs-var">EAIndex</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621684413031"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621684413054"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413055"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-693"></a><span class="hs-identifier">x86_isJumpishInstr</span><span>
</span><a name="line-694"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><a name="x86_isJumpishInstr"><a href="X86.Instr.html#x86_isJumpishInstr"><span class="hs-identifier">x86_isJumpishInstr</span></a></a><span> </span><a name="local-6989586621684413266"><a href="#local-6989586621684413266"><span class="hs-identifier">instr</span></a></a><span>
</span><a name="line-697"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413266"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-698"></a><span>        </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-699"></a><span>        </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-700"></a><span>        </span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-701"></a><span>        </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-702"></a><span>        </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-703"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-identifier">x86_jumpDestsOfInstr</span><span>
</span><a name="line-707"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-708"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span class="hs-special">]</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><a name="x86_jumpDestsOfInstr"><a href="X86.Instr.html#x86_jumpDestsOfInstr"><span class="hs-identifier">x86_jumpDestsOfInstr</span></a></a><span> </span><a name="local-6989586621684413267"><a href="#local-6989586621684413267"><span class="hs-identifier">insn</span></a></a><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413267"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-712"></a><span>        </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413268"><a href="#local-6989586621684413268"><span class="hs-identifier">id</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413268"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-713"></a><span>        </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413269"><a href="#local-6989586621684413269"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621684413270"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413270"><a href="#local-6989586621684413270"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621684413269"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">]</span><span>
</span><a name="line-714"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span class="hs-identifier">x86_patchJumpInstr</span><span>
</span><a name="line-718"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-719"></a><span>
</span><a name="line-720"></a><a name="x86_patchJumpInstr"><a href="X86.Instr.html#x86_patchJumpInstr"><span class="hs-identifier">x86_patchJumpInstr</span></a></a><span> </span><a name="local-6989586621684413271"><a href="#local-6989586621684413271"><span class="hs-identifier">insn</span></a></a><span> </span><a name="local-6989586621684413272"><a href="#local-6989586621684413272"><span class="hs-identifier">patchF</span></a></a><span>
</span><a name="line-721"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413271"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-722"></a><span>        </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a name="local-6989586621684413277"><a href="#local-6989586621684413277"><span class="hs-identifier">cc</span></a></a><span> </span><a name="local-6989586621684413278"><a href="#local-6989586621684413278"><span class="hs-identifier">id</span></a></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a href="#local-6989586621684413277"><span class="hs-identifier hs-var">cc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413272"><span class="hs-identifier hs-var">patchF</span></a><span> </span><a href="#local-6989586621684413278"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-723"></a><span>        </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a name="local-6989586621684413279"><a href="#local-6989586621684413279"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621684413280"><a href="#local-6989586621684413280"><span class="hs-identifier">ids</span></a></a><span> </span><a name="local-6989586621684413281"><a href="#local-6989586621684413281"><span class="hs-identifier">section</span></a></a><span> </span><a name="local-6989586621684413282"><a href="#local-6989586621684413282"><span class="hs-identifier">lbl</span></a></a><span>
</span><a name="line-724"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a href="#local-6989586621684413279"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413273"><span class="hs-identifier hs-var">patchJumpDest</span></a><span> </span><a href="#local-6989586621684413272"><span class="hs-identifier hs-var">patchF</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413280"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413281"><span class="hs-identifier hs-var">section</span></a><span> </span><a href="#local-6989586621684413282"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-725"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413271"><span class="hs-identifier hs-var">insn</span></a><span>
</span><a name="line-726"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-727"></a><span>        </span><a name="local-6989586621684413273"><a href="#local-6989586621684413273"><span class="hs-identifier">patchJumpDest</span></a></a><span> </span><a name="local-6989586621684413274"><a href="#local-6989586621684413274"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413275"><a href="#local-6989586621684413275"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413274"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621684413275"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span>        </span><span class="hs-identifier">patchJumpDest</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413276"><a href="#local-6989586621684413276"><span class="hs-identifier">dest</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413276"><span class="hs-identifier hs-var">dest</span></a><span>
</span><a name="line-729"></a><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span>
</span><a name="line-734"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-735"></a><span class="hs-comment">-- | Make a spill instruction.</span><span>
</span><a name="line-736"></a><span class="hs-identifier">x86_mkSpillInstr</span><span>
</span><a name="line-737"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-738"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>      </span><span class="hs-comment">-- register to spill</span><span>
</span><a name="line-739"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- current stack delta</span><span>
</span><a name="line-740"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- spill slot to use</span><span>
</span><a name="line-741"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><a name="x86_mkSpillInstr"><a href="X86.Instr.html#x86_mkSpillInstr"><span class="hs-identifier">x86_mkSpillInstr</span></a></a><span> </span><a name="local-6989586621684413283"><a href="#local-6989586621684413283"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621684413284"><a href="#local-6989586621684413284"><span class="hs-identifier">reg</span></a></a><span> </span><a name="local-6989586621684413285"><a href="#local-6989586621684413285"><span class="hs-identifier">delta</span></a></a><span> </span><a name="local-6989586621684413286"><a href="#local-6989586621684413286"><span class="hs-identifier">slot</span></a></a><span>
</span><a name="line-744"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684413289"><a href="#local-6989586621684413289"><span class="hs-identifier">off</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#spillSlotToOffset"><span class="hs-identifier hs-var">spillSlotToOffset</span></a><span> </span><a href="#local-6989586621684413287"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413286"><span class="hs-identifier hs-var">slot</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621684413285"><span class="hs-identifier hs-var">delta</span></a><span>
</span><a name="line-745"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-746"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="TargetReg.html#targetClassOfReg"><span class="hs-identifier hs-var">targetClassOfReg</span></a><span> </span><a href="#local-6989586621684413287"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413284"><span class="hs-identifier hs-var">reg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-747"></a><span>           </span><a href="RegClass.html#RcInteger"><span class="hs-identifier hs-var">RcInteger</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a><span> </span><a href="#local-6989586621684413288"><span class="hs-identifier hs-var">is32Bit</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>                              </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413284"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413283"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413289"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>           </span><a href="RegClass.html#RcDouble"><span class="hs-identifier hs-var">RcDouble</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GST"><span class="hs-identifier hs-var">GST</span></a><span> </span><a href="Format.html#FF80"><span class="hs-identifier hs-var">FF80</span></a><span> </span><a href="#local-6989586621684413284"><span class="hs-identifier hs-var">reg</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413283"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413289"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{- RcFloat/RcDouble -}</span><span>
</span><a name="line-750"></a><span>           </span><a href="RegClass.html#RcDoubleSSE"><span class="hs-identifier hs-var">RcDoubleSSE</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413284"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413283"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413289"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>           </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.mkSpillInstr: no match&quot;</span><span>
</span><a name="line-752"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413287"><a href="#local-6989586621684413287"><span class="hs-identifier">platform</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621684413283"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-753"></a><span>          </span><a name="local-6989586621684413288"><a href="#local-6989586621684413288"><span class="hs-identifier">is32Bit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">target32Bit</span><span> </span><a href="#local-6989586621684413287"><span class="hs-identifier hs-var">platform</span></a><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span class="hs-comment">-- | Make a spill reload instruction.</span><span>
</span><a name="line-756"></a><span class="hs-identifier">x86_mkLoadInstr</span><span>
</span><a name="line-757"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span>
</span><a name="line-758"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>      </span><span class="hs-comment">-- register to load</span><span>
</span><a name="line-759"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- current stack delta</span><span>
</span><a name="line-760"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>      </span><span class="hs-comment">-- spill slot to use</span><span>
</span><a name="line-761"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-762"></a><span>
</span><a name="line-763"></a><a name="x86_mkLoadInstr"><a href="X86.Instr.html#x86_mkLoadInstr"><span class="hs-identifier">x86_mkLoadInstr</span></a></a><span> </span><a name="local-6989586621684413290"><a href="#local-6989586621684413290"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621684413291"><a href="#local-6989586621684413291"><span class="hs-identifier">reg</span></a></a><span> </span><a name="local-6989586621684413292"><a href="#local-6989586621684413292"><span class="hs-identifier">delta</span></a></a><span> </span><a name="local-6989586621684413293"><a href="#local-6989586621684413293"><span class="hs-identifier">slot</span></a></a><span>
</span><a name="line-764"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684413296"><a href="#local-6989586621684413296"><span class="hs-identifier">off</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#spillSlotToOffset"><span class="hs-identifier hs-var">spillSlotToOffset</span></a><span> </span><a href="#local-6989586621684413294"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413293"><span class="hs-identifier hs-var">slot</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621684413292"><span class="hs-identifier hs-var">delta</span></a><span>
</span><a name="line-765"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-766"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="TargetReg.html#targetClassOfReg"><span class="hs-identifier hs-var">targetClassOfReg</span></a><span> </span><a href="#local-6989586621684413294"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413291"><span class="hs-identifier hs-var">reg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-767"></a><span>              </span><a href="RegClass.html#RcInteger"><span class="hs-identifier hs-var">RcInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#archWordFormat"><span class="hs-identifier hs-var">archWordFormat</span></a><span> </span><a href="#local-6989586621684413295"><span class="hs-identifier hs-var">is32Bit</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span>                               </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413290"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413296"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413291"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>              </span><a href="RegClass.html#RcDouble"><span class="hs-identifier hs-var">RcDouble</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GLD"><span class="hs-identifier hs-var">GLD</span></a><span> </span><a href="Format.html#FF80"><span class="hs-identifier hs-var">FF80</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413290"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413296"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413291"><span class="hs-identifier hs-var">reg</span></a><span> </span><span class="hs-comment">{- RcFloat/RcDouble -}</span><span>
</span><a name="line-770"></a><span>              </span><a href="RegClass.html#RcDoubleSSE"><span class="hs-identifier hs-var">RcDoubleSSE</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#spRel"><span class="hs-identifier hs-var">spRel</span></a><span> </span><a href="#local-6989586621684413290"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621684413296"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413291"><span class="hs-identifier hs-var">reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span>              </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.x86_mkLoadInstr&quot;</span><span>
</span><a name="line-772"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413294"><a href="#local-6989586621684413294"><span class="hs-identifier">platform</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621684413290"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-773"></a><span>          </span><a name="local-6989586621684413295"><a href="#local-6989586621684413295"><span class="hs-identifier">is32Bit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">target32Bit</span><span> </span><a href="#local-6989586621684413294"><span class="hs-identifier hs-var">platform</span></a><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span class="hs-identifier">spillSlotSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-776"></a><a name="spillSlotSize"><a href="X86.Instr.html#spillSlotSize"><span class="hs-identifier">spillSlotSize</span></a></a><span> </span><a name="local-6989586621684413297"><a href="#local-6989586621684413297"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621684413298"><span class="hs-identifier hs-var">is32Bit</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-777"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413298"><a href="#local-6989586621684413298"><span class="hs-identifier">is32Bit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">target32Bit</span><span> </span><a href="#local-6989586621684413297"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span class="hs-identifier">maxSpillSlots</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DynFlags</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-780"></a><a name="maxSpillSlots"><a href="X86.Instr.html#maxSpillSlots"><span class="hs-identifier">maxSpillSlots</span></a></a><span> </span><a name="local-6989586621684413299"><a href="#local-6989586621684413299"><span class="hs-identifier">dflags</span></a></a><span>
</span><a name="line-781"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">rESERVED_C_STACK_BYTES</span><span> </span><a href="#local-6989586621684413299"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">64</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><a href="X86.Instr.html#spillSlotSize"><span class="hs-identifier hs-var">spillSlotSize</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">targetPlatform</span><span> </span><a href="#local-6989586621684413299"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-782"></a><span class="hs-comment">--     = 0 -- useful for testing allocMoreStack</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-comment">-- number of bytes that the stack pointer should be aligned to</span><span>
</span><a name="line-785"></a><span class="hs-identifier">stackAlign</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-786"></a><a name="stackAlign"><a href="X86.Instr.html#stackAlign"><span class="hs-identifier">stackAlign</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span class="hs-comment">-- convert a spill slot number to a *byte* offset, with no sign:</span><span>
</span><a name="line-789"></a><span class="hs-comment">-- decide on a per arch basis whether you are spilling above or below</span><span>
</span><a name="line-790"></a><span class="hs-comment">-- the C stack pointer.</span><span>
</span><a name="line-791"></a><span class="hs-identifier">spillSlotToOffset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-792"></a><a name="spillSlotToOffset"><a href="X86.Instr.html#spillSlotToOffset"><span class="hs-identifier">spillSlotToOffset</span></a></a><span> </span><a name="local-6989586621684413300"><a href="#local-6989586621684413300"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413301"><a href="#local-6989586621684413301"><span class="hs-identifier">slot</span></a></a><span>
</span><a name="line-793"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="X86.Instr.html#spillSlotSize"><span class="hs-identifier hs-var">spillSlotSize</span></a><span> </span><a href="#local-6989586621684413300"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621684413301"><span class="hs-identifier hs-var">slot</span></a><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span class="hs-comment">-- | See if this instruction is telling us the current C stack delta</span><span>
</span><a name="line-798"></a><span class="hs-identifier">x86_takeDeltaInstr</span><span>
</span><a name="line-799"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-800"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-801"></a><span>
</span><a name="line-802"></a><a name="x86_takeDeltaInstr"><a href="X86.Instr.html#x86_takeDeltaInstr"><span class="hs-identifier">x86_takeDeltaInstr</span></a></a><span> </span><a name="local-6989586621684413302"><a href="#local-6989586621684413302"><span class="hs-identifier">instr</span></a></a><span>
</span><a name="line-803"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413302"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-804"></a><span>        </span><a href="X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a><span> </span><a name="local-6989586621684413303"><a href="#local-6989586621684413303"><span class="hs-identifier">i</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684413303"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-805"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-identifier">x86_isMetaInstr</span><span>
</span><a name="line-809"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-810"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><a name="x86_isMetaInstr"><a href="X86.Instr.html#x86_isMetaInstr"><span class="hs-identifier">x86_isMetaInstr</span></a></a><span> </span><a name="local-6989586621684413304"><a href="#local-6989586621684413304"><span class="hs-identifier">instr</span></a></a><span>
</span><a name="line-813"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413304"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-814"></a><span>        </span><a href="X86.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-815"></a><span>        </span><a href="X86.Instr.html#LOCATION"><span class="hs-identifier hs-var">LOCATION</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-816"></a><span>        </span><a href="X86.Instr.html#LDATA"><span class="hs-identifier hs-var">LDATA</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-817"></a><span>        </span><a href="X86.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-818"></a><span>        </span><a href="X86.Instr.html#UNWIND"><span class="hs-identifier hs-var">UNWIND</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-819"></a><span>        </span><a href="X86.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-820"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span>
</span><a name="line-824"></a><span class="hs-comment">-- | Make a reg-reg move instruction.</span><span>
</span><a name="line-825"></a><span class="hs-comment">--      On SPARC v8 there are no instructions to move directly between</span><span>
</span><a name="line-826"></a><span class="hs-comment">--      floating point and integer regs. If we need to do that then we</span><span>
</span><a name="line-827"></a><span class="hs-comment">--      have to go via memory.</span><span>
</span><a name="line-828"></a><span class="hs-comment">--</span><span>
</span><a name="line-829"></a><span class="hs-identifier">x86_mkRegRegMoveInstr</span><span>
</span><a name="line-830"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span>
</span><a name="line-831"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>
</span><a name="line-832"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span>
</span><a name="line-833"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><a name="x86_mkRegRegMoveInstr"><a href="X86.Instr.html#x86_mkRegRegMoveInstr"><span class="hs-identifier">x86_mkRegRegMoveInstr</span></a></a><span> </span><a name="local-6989586621684413305"><a href="#local-6989586621684413305"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413306"><a href="#local-6989586621684413306"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621684413307"><a href="#local-6989586621684413307"><span class="hs-identifier">dst</span></a></a><span>
</span><a name="line-836"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TargetReg.html#targetClassOfReg"><span class="hs-identifier hs-var">targetClassOfReg</span></a><span> </span><a href="#local-6989586621684413305"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413306"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-837"></a><span>        </span><a href="RegClass.html#RcInteger"><span class="hs-identifier hs-var">RcInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><a href="#local-6989586621684413305"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-838"></a><span>                     </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413306"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413307"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span>                     </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413306"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413307"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>                     </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;x86_mkRegRegMoveInstr: Bad arch&quot;</span><span>
</span><a name="line-841"></a><span>        </span><a href="RegClass.html#RcDouble"><span class="hs-identifier hs-var">RcDouble</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#GMOV"><span class="hs-identifier hs-var">GMOV</span></a><span> </span><a href="#local-6989586621684413306"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621684413307"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-842"></a><span>        </span><a href="RegClass.html#RcDoubleSSE"><span class="hs-identifier hs-var">RcDoubleSSE</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413306"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="#local-6989586621684413307"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-843"></a><span>        </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;X86.RegInfo.mkRegRegMoveInstr: no match&quot;</span><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span class="hs-comment">-- | Check whether an instruction represents a reg-reg move.</span><span>
</span><a name="line-846"></a><span class="hs-comment">--      The register allocator attempts to eliminate reg-&gt;reg moves whenever it can,</span><span>
</span><a name="line-847"></a><span class="hs-comment">--      by assigning the src and dest temporaries to the same real register.</span><span>
</span><a name="line-848"></a><span class="hs-comment">--</span><span>
</span><a name="line-849"></a><span class="hs-identifier">x86_takeRegRegMoveInstr</span><span>
</span><a name="line-850"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-851"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">,</span><a href="Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><a name="x86_takeRegRegMoveInstr"><a href="X86.Instr.html#x86_takeRegRegMoveInstr"><span class="hs-identifier">x86_takeRegRegMoveInstr</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684413308"><a href="#local-6989586621684413308"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a name="local-6989586621684413309"><a href="#local-6989586621684413309"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413308"><span class="hs-identifier hs-var">r1</span></a><span class="hs-special">,</span><a href="#local-6989586621684413309"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-identifier">x86_takeRegRegMoveInstr</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span>
</span><a name="line-859"></a><span class="hs-comment">-- | Make an unconditional branch instruction.</span><span>
</span><a name="line-860"></a><span class="hs-identifier">x86_mkJumpInstr</span><span>
</span><a name="line-861"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>
</span><a name="line-862"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-863"></a><span>
</span><a name="line-864"></a><a name="x86_mkJumpInstr"><a href="X86.Instr.html#x86_mkJumpInstr"><span class="hs-identifier">x86_mkJumpInstr</span></a></a><span> </span><a name="local-6989586621684413310"><a href="#local-6989586621684413310"><span class="hs-identifier">id</span></a></a><span>
</span><a name="line-865"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a href="X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a><span> </span><a href="#local-6989586621684413310"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">-- Note [Windows stack layout]</span><span>
</span><a name="line-868"></a><span class="hs-comment">-- | On most OSes the kernel will place a guard page after the current stack</span><span>
</span><a name="line-869"></a><span class="hs-comment">--   page.  If you allocate larger than a page worth you may jump over this</span><span>
</span><a name="line-870"></a><span class="hs-comment">--   guard page.  Not only is this a security issue, but on certain OSes such</span><span>
</span><a name="line-871"></a><span class="hs-comment">--   as Windows a new page won't be allocated if you don't hit the guard.  This</span><span>
</span><a name="line-872"></a><span class="hs-comment">--   will cause a segfault or access fault.</span><span>
</span><a name="line-873"></a><span class="hs-comment">--</span><span>
</span><a name="line-874"></a><span class="hs-comment">--   This function defines if the current allocation amount requires a probe.</span><span>
</span><a name="line-875"></a><span class="hs-comment">--   On Windows (for now) we emit a call to _chkstk for this.  For other OSes</span><span>
</span><a name="line-876"></a><span class="hs-comment">--   this is not yet implemented.</span><span>
</span><a name="line-877"></a><span class="hs-comment">--   See https://docs.microsoft.com/en-us/windows/desktop/DevNotes/-win32-chkstk</span><span>
</span><a name="line-878"></a><span class="hs-comment">--   The Windows stack looks like this:</span><span>
</span><a name="line-879"></a><span class="hs-comment">--</span><span>
</span><a name="line-880"></a><span class="hs-comment">--                         +-------------------+</span><span>
</span><a name="line-881"></a><span class="hs-comment">--                         |        SP         |</span><span>
</span><a name="line-882"></a><span class="hs-comment">--                         +-------------------+</span><span>
</span><a name="line-883"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-884"></a><span class="hs-comment">--                         |    GUARD PAGE     |</span><span>
</span><a name="line-885"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-886"></a><span class="hs-comment">--                         +-------------------+</span><span>
</span><a name="line-887"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-888"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-889"></a><span class="hs-comment">--                         |     UNMAPPED      |</span><span>
</span><a name="line-890"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-891"></a><span class="hs-comment">--                         |                   |</span><span>
</span><a name="line-892"></a><span class="hs-comment">--                         +-------------------+</span><span>
</span><a name="line-893"></a><span class="hs-comment">--</span><span>
</span><a name="line-894"></a><span class="hs-comment">--   In essense each allocation larger than a page size needs to be chunked and</span><span>
</span><a name="line-895"></a><span class="hs-comment">--   a probe emitted after each page allocation.  You have to hit the guard</span><span>
</span><a name="line-896"></a><span class="hs-comment">--   page so the kernel can map in the next page, otherwise you'll segfault.</span><span>
</span><a name="line-897"></a><span class="hs-comment">--</span><span>
</span><a name="line-898"></a><span class="hs-identifier">needs_probe_call</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-899"></a><a name="needs_probe_call"><a href="X86.Instr.html#needs_probe_call"><span class="hs-identifier">needs_probe_call</span></a></a><span> </span><a name="local-6989586621684413311"><a href="#local-6989586621684413311"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413312"><a href="#local-6989586621684413312"><span class="hs-identifier">amount</span></a></a><span>
</span><a name="line-900"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformOS</span><span> </span><a href="#local-6989586621684413311"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-901"></a><span>     </span><span class="hs-identifier hs-var">OSMinGW32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><a href="#local-6989586621684413311"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-902"></a><span>                    </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413312"><span class="hs-identifier hs-var">amount</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">1024</span><span class="hs-special">)</span><span>
</span><a name="line-903"></a><span>                    </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413312"><span class="hs-identifier hs-var">amount</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">1024</span><span class="hs-special">)</span><span>
</span><a name="line-904"></a><span>                    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-905"></a><span>     </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-906"></a><span>
</span><a name="line-907"></a><span class="hs-identifier">x86_mkStackAllocInstr</span><span>
</span><a name="line-908"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span>
</span><a name="line-909"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-910"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-911"></a><a name="x86_mkStackAllocInstr"><a href="X86.Instr.html#x86_mkStackAllocInstr"><span class="hs-identifier">x86_mkStackAllocInstr</span></a></a><span> </span><a name="local-6989586621684413313"><a href="#local-6989586621684413313"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413314"><a href="#local-6989586621684413314"><span class="hs-identifier">amount</span></a></a><span>
</span><a name="line-912"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformOS</span><span> </span><a href="#local-6989586621684413313"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-913"></a><span>      </span><span class="hs-identifier hs-var">OSMinGW32</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-914"></a><span>        </span><span class="hs-comment">-- These will clobber AX but this should be ok because</span><span>
</span><a name="line-915"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-916"></a><span>        </span><span class="hs-comment">-- 1. It is the first thing we do when entering the closure and AX is</span><span>
</span><a name="line-917"></a><span>        </span><span class="hs-comment">--    a caller saved registers on Windows both on x86_64 and x86.</span><span>
</span><a name="line-918"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-919"></a><span>        </span><span class="hs-comment">-- 2. The closures are only entered via a call or longjmp in which case</span><span>
</span><a name="line-920"></a><span>        </span><span class="hs-comment">--    there are no expectations for volatile registers.</span><span>
</span><a name="line-921"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-922"></a><span>        </span><span class="hs-comment">-- 3. When the target is a local branch point it is re-targeted</span><span>
</span><a name="line-923"></a><span>        </span><span class="hs-comment">--    after the dealloc, preserving #2.  See note [extra spill slots].</span><span>
</span><a name="line-924"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-925"></a><span>        </span><span class="hs-comment">-- We emit a call because the stack probes are quite involved and</span><span>
</span><a name="line-926"></a><span>        </span><span class="hs-comment">-- would bloat code size a lot.  GHC doesn't really have an -Os.</span><span>
</span><a name="line-927"></a><span>        </span><span class="hs-comment">-- __chkstk is guaranteed to leave all nonvolatile registers and AX</span><span>
</span><a name="line-928"></a><span>        </span><span class="hs-comment">-- untouched.  It's part of the standard prologue code for any Windows</span><span>
</span><a name="line-929"></a><span>        </span><span class="hs-comment">-- function dropping the stack more than a page.</span><span>
</span><a name="line-930"></a><span>        </span><span class="hs-comment">-- See Note [Windows stack layout]</span><span>
</span><a name="line-931"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><a href="#local-6989586621684413313"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-932"></a><span>            </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="X86.Instr.html#needs_probe_call"><span class="hs-identifier hs-var">needs_probe_call</span></a><span> </span><a href="#local-6989586621684413313"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-933"></a><span>                           </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">)</span><span>
</span><a name="line-934"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="X86.Regs.html#strImmLit"><span class="hs-identifier hs-var">strImmLit</span></a><span> </span><span class="hs-string">&quot;___chkstk_ms&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">]</span><span>
</span><a name="line-935"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#eax"><span class="hs-identifier hs-var">eax</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-937"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-938"></a><span>                           </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-941"></a><span>            </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="X86.Instr.html#needs_probe_call"><span class="hs-identifier hs-var">needs_probe_call</span></a><span> </span><a href="#local-6989586621684413313"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-942"></a><span>                           </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="X86.Regs.html#strImmLit"><span class="hs-identifier hs-var">strImmLit</span></a><span> </span><span class="hs-string">&quot;__chkstk_ms&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a><span class="hs-special">]</span><span>
</span><a name="line-944"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rax"><span class="hs-identifier hs-var">rax</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-946"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-947"></a><span>                           </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span>
</span><a name="line-948"></a><span>                           </span><span class="hs-special">,</span><span> </span><a href="X86.Instr.html#TEST"><span class="hs-identifier hs-var">TEST</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-950"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;x86_mkStackAllocInstr&quot;</span><span>
</span><a name="line-951"></a><span>      </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-952"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><a href="#local-6989586621684413313"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-953"></a><span>          </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-954"></a><span>          </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><a href="X86.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413314"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-955"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;x86_mkStackAllocInstr&quot;</span><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-identifier">x86_mkStackDeallocInstr</span><span>
</span><a name="line-958"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span>
</span><a name="line-959"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-960"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-961"></a><a name="x86_mkStackDeallocInstr"><a href="X86.Instr.html#x86_mkStackDeallocInstr"><span class="hs-identifier">x86_mkStackDeallocInstr</span></a></a><span> </span><a name="local-6989586621684413315"><a href="#local-6989586621684413315"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413316"><a href="#local-6989586621684413316"><span class="hs-identifier">amount</span></a></a><span>
</span><a name="line-962"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformArch</span><span> </span><a href="#local-6989586621684413315"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-963"></a><span>      </span><span class="hs-identifier hs-var">ArchX86</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a><span> </span><a href="Format.html#II32"><span class="hs-identifier hs-var">II32</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413316"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#esp"><span class="hs-identifier hs-var">esp</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-964"></a><span>      </span><span class="hs-identifier hs-var">ArchX86_64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a><span> </span><a href="Format.html#II64"><span class="hs-identifier hs-var">II64</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a><span> </span><a href="#local-6989586621684413316"><span class="hs-identifier hs-var">amount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a><span> </span><a href="X86.Regs.html#rsp"><span class="hs-identifier hs-var">rsp</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-965"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;x86_mkStackDeallocInstr&quot;</span><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-identifier">i386_insert_ffrees</span><span>
</span><a name="line-968"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-969"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-970"></a><span>
</span><a name="line-971"></a><a name="i386_insert_ffrees"><a href="X86.Instr.html#i386_insert_ffrees"><span class="hs-identifier">i386_insert_ffrees</span></a></a><span> </span><a name="local-6989586621684413317"><a href="#local-6989586621684413317"><span class="hs-identifier">blocks</span></a></a><span>
</span><a name="line-972"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><a href="X86.Instr.html#is_G_instr"><span class="hs-identifier hs-var">is_G_instr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621684413321"><span class="hs-identifier hs-var">instrs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413321"><a href="#local-6989586621684413321"><span class="hs-identifier">instrs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621684413317"><span class="hs-identifier hs-var">blocks</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-973"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621684413318"><span class="hs-identifier hs-var">insertGFREEs</span></a><span> </span><a href="#local-6989586621684413317"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-974"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-975"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413317"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-976"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-977"></a><span>   </span><a name="local-6989586621684413318"><a href="#local-6989586621684413318"><span class="hs-identifier">insertGFREEs</span></a></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a name="local-6989586621684413319"><a href="#local-6989586621684413319"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621684413320"><a href="#local-6989586621684413320"><span class="hs-identifier">insns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a href="#local-6989586621684413319"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#insertBeforeNonlocalTransfers"><span class="hs-identifier hs-var">insertBeforeNonlocalTransfers</span></a><span> </span><a href="X86.Instr.html#GFREE"><span class="hs-identifier hs-var">GFREE</span></a><span> </span><a href="#local-6989586621684413320"><span class="hs-identifier hs-var">insns</span></a><span class="hs-special">)</span><span>
</span><a name="line-979"></a><span>
</span><a name="line-980"></a><span class="hs-identifier">insertBeforeNonlocalTransfers</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span class="hs-special">]</span><span>
</span><a name="line-981"></a><a name="insertBeforeNonlocalTransfers"><a href="X86.Instr.html#insertBeforeNonlocalTransfers"><span class="hs-identifier">insertBeforeNonlocalTransfers</span></a></a><span> </span><a name="local-6989586621684413322"><a href="#local-6989586621684413322"><span class="hs-identifier">insert</span></a></a><span> </span><a name="local-6989586621684413323"><a href="#local-6989586621684413323"><span class="hs-identifier">insns</span></a></a><span>
</span><a name="line-982"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621684413324"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621684413323"><span class="hs-identifier hs-var">insns</span></a><span>
</span><a name="line-983"></a><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413324"><a href="#local-6989586621684413324"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621684413325"><a href="#local-6989586621684413325"><span class="hs-identifier">insn</span></a></a><span> </span><a name="local-6989586621684413326"><a href="#local-6989586621684413326"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413325"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-984"></a><span>                        </span><a href="X86.Instr.html#CALL"><span class="hs-identifier hs-var">CALL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413322"><span class="hs-identifier hs-var">insert</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413325"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413326"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-985"></a><span>                        </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413322"><span class="hs-identifier hs-var">insert</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413325"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413326"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-986"></a><span>                        </span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;insertBeforeNonlocalTransfers: cannot handle JXX_GBL&quot;</span><span>
</span><a name="line-987"></a><span>                        </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413325"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413326"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-988"></a><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span class="hs-comment">-- if you ever add a new FP insn to the fake x86 FP insn set,</span><span>
</span><a name="line-991"></a><span class="hs-comment">-- you must update this too</span><span>
</span><a name="line-992"></a><span class="hs-identifier">is_G_instr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-993"></a><a name="is_G_instr"><a href="X86.Instr.html#is_G_instr"><span class="hs-identifier">is_G_instr</span></a></a><span> </span><a name="local-6989586621684413327"><a href="#local-6989586621684413327"><span class="hs-identifier">instr</span></a></a><span>
</span><a name="line-994"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413327"><span class="hs-identifier hs-var">instr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-995"></a><span>        </span><a href="X86.Instr.html#GMOV"><span class="hs-identifier hs-var">GMOV</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-996"></a><span>        </span><a href="X86.Instr.html#GLD"><span class="hs-identifier hs-var">GLD</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-997"></a><span>        </span><a href="X86.Instr.html#GST"><span class="hs-identifier hs-var">GST</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-998"></a><span>        </span><a href="X86.Instr.html#GLDZ"><span class="hs-identifier hs-var">GLDZ</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-999"></a><span>        </span><a href="X86.Instr.html#GLD1"><span class="hs-identifier hs-var">GLD1</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1000"></a><span>        </span><a href="X86.Instr.html#GFTOI"><span class="hs-identifier hs-var">GFTOI</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1001"></a><span>        </span><a href="X86.Instr.html#GDTOI"><span class="hs-identifier hs-var">GDTOI</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1002"></a><span>        </span><a href="X86.Instr.html#GITOF"><span class="hs-identifier hs-var">GITOF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1003"></a><span>        </span><a href="X86.Instr.html#GITOD"><span class="hs-identifier hs-var">GITOD</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1004"></a><span>        </span><a href="X86.Instr.html#GDTOF"><span class="hs-identifier hs-var">GDTOF</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1005"></a><span>        </span><a href="X86.Instr.html#GADD"><span class="hs-identifier hs-var">GADD</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1006"></a><span>        </span><a href="X86.Instr.html#GDIV"><span class="hs-identifier hs-var">GDIV</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1007"></a><span>        </span><a href="X86.Instr.html#GSUB"><span class="hs-identifier hs-var">GSUB</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1008"></a><span>        </span><a href="X86.Instr.html#GMUL"><span class="hs-identifier hs-var">GMUL</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1009"></a><span>        </span><a href="X86.Instr.html#GCMP"><span class="hs-identifier hs-var">GCMP</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1010"></a><span>        </span><a href="X86.Instr.html#GABS"><span class="hs-identifier hs-var">GABS</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1011"></a><span>        </span><a href="X86.Instr.html#GNEG"><span class="hs-identifier hs-var">GNEG</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1012"></a><span>        </span><a href="X86.Instr.html#GSQRT"><span class="hs-identifier hs-var">GSQRT</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1013"></a><span>        </span><a href="X86.Instr.html#GSIN"><span class="hs-identifier hs-var">GSIN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1014"></a><span>        </span><a href="X86.Instr.html#GCOS"><span class="hs-identifier hs-var">GCOS</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1015"></a><span>        </span><a href="X86.Instr.html#GTAN"><span class="hs-identifier hs-var">GTAN</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1016"></a><span>        </span><a href="X86.Instr.html#GFREE"><span class="hs-identifier hs-var">GFREE</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;is_G_instr: GFREE (!)&quot;</span><span>
</span><a name="line-1017"></a><span>        </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1018"></a><span>
</span><a name="line-1019"></a><span>
</span><a name="line-1020"></a><span class="hs-comment">--</span><span>
</span><a name="line-1021"></a><span class="hs-comment">-- Note [extra spill slots]</span><span>
</span><a name="line-1022"></a><span class="hs-comment">--</span><span>
</span><a name="line-1023"></a><span class="hs-comment">-- If the register allocator used more spill slots than we have</span><span>
</span><a name="line-1024"></a><span class="hs-comment">-- pre-allocated (rESERVED_C_STACK_BYTES), then we must allocate more</span><span>
</span><a name="line-1025"></a><span class="hs-comment">-- C stack space on entry and exit from this proc.  Therefore we</span><span>
</span><a name="line-1026"></a><span class="hs-comment">-- insert a &quot;sub $N, %rsp&quot; at every entry point, and an &quot;add $N, %rsp&quot;</span><span>
</span><a name="line-1027"></a><span class="hs-comment">-- before every non-local jump.</span><span>
</span><a name="line-1028"></a><span class="hs-comment">--</span><span>
</span><a name="line-1029"></a><span class="hs-comment">-- This became necessary when the new codegen started bundling entire</span><span>
</span><a name="line-1030"></a><span class="hs-comment">-- functions together into one proc, because the register allocator</span><span>
</span><a name="line-1031"></a><span class="hs-comment">-- assigns a different stack slot to each virtual reg within a proc.</span><span>
</span><a name="line-1032"></a><span class="hs-comment">-- To avoid using so many slots we could also:</span><span>
</span><a name="line-1033"></a><span class="hs-comment">--</span><span>
</span><a name="line-1034"></a><span class="hs-comment">--   - split up the proc into connected components before code generator</span><span>
</span><a name="line-1035"></a><span class="hs-comment">--</span><span>
</span><a name="line-1036"></a><span class="hs-comment">--   - rename the virtual regs, so that we re-use vreg names and hence</span><span>
</span><a name="line-1037"></a><span class="hs-comment">--     stack slots for non-overlapping vregs.</span><span>
</span><a name="line-1038"></a><span class="hs-comment">--</span><span>
</span><a name="line-1039"></a><span class="hs-comment">-- Note that when a block is both a non-local entry point (with an</span><span>
</span><a name="line-1040"></a><span class="hs-comment">-- info table) and a local branch target, we have to split it into</span><span>
</span><a name="line-1041"></a><span class="hs-comment">-- two, like so:</span><span>
</span><a name="line-1042"></a><span class="hs-comment">--</span><span>
</span><a name="line-1043"></a><span class="hs-comment">--    &lt;info table&gt;</span><span>
</span><a name="line-1044"></a><span class="hs-comment">--    L:</span><span>
</span><a name="line-1045"></a><span class="hs-comment">--       &lt;code&gt;</span><span>
</span><a name="line-1046"></a><span class="hs-comment">--</span><span>
</span><a name="line-1047"></a><span class="hs-comment">-- becomes</span><span>
</span><a name="line-1048"></a><span class="hs-comment">--</span><span>
</span><a name="line-1049"></a><span class="hs-comment">--    &lt;info table&gt;</span><span>
</span><a name="line-1050"></a><span class="hs-comment">--    L:</span><span>
</span><a name="line-1051"></a><span class="hs-comment">--       subl $rsp, N</span><span>
</span><a name="line-1052"></a><span class="hs-comment">--       jmp Lnew</span><span>
</span><a name="line-1053"></a><span class="hs-comment">--    Lnew:</span><span>
</span><a name="line-1054"></a><span class="hs-comment">--       &lt;code&gt;</span><span>
</span><a name="line-1055"></a><span class="hs-comment">--</span><span>
</span><a name="line-1056"></a><span class="hs-comment">-- and all branches pointing to L are retargetted to point to Lnew.</span><span>
</span><a name="line-1057"></a><span class="hs-comment">-- Otherwise, we would repeat the $rsp adjustment for each branch to</span><span>
</span><a name="line-1058"></a><span class="hs-comment">-- L.</span><span>
</span><a name="line-1059"></a><span class="hs-comment">--</span><span>
</span><a name="line-1060"></a><span class="hs-comment">-- Returns a list of (L,Lnew) pairs.</span><span>
</span><a name="line-1061"></a><span class="hs-comment">--</span><span>
</span><a name="line-1062"></a><span class="hs-identifier">allocMoreStack</span><span>
</span><a name="line-1063"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Platform</span><span>
</span><a name="line-1064"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1065"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Instruction.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a><span> </span><a href="#local-6989586621684412827"><span class="hs-identifier hs-type">statics</span></a><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">X86.Instr.Instr</span></a><span>
</span><a name="line-1066"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">UniqSM</span><span> </span><span class="hs-special">(</span><a href="Instruction.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a><span> </span><a href="#local-6989586621684412827"><span class="hs-identifier hs-type">statics</span></a><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">X86.Instr.Instr</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span class="hs-special">,</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1067"></a><span>
</span><a name="line-1068"></a><a name="allocMoreStack"><a href="X86.Instr.html#allocMoreStack"><span class="hs-identifier">allocMoreStack</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413328"><a href="#local-6989586621684413328"><span class="hs-identifier">top</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413328"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1069"></a><span class="hs-identifier">allocMoreStack</span><span> </span><a name="local-6989586621684413329"><a href="#local-6989586621684413329"><span class="hs-identifier">platform</span></a></a><span> </span><a name="local-6989586621684413330"><a href="#local-6989586621684413330"><span class="hs-identifier">slots</span></a></a><span> </span><a name="local-6989586621684413331"><a href="#local-6989586621684413331"><span class="hs-identifier">proc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Cmm.html#CmmProc"><span class="hs-identifier hs-var">CmmProc</span></a><span> </span><a name="local-6989586621684413332"><a href="#local-6989586621684413332"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621684413333"><a href="#local-6989586621684413333"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621684413334"><a href="#local-6989586621684413334"><span class="hs-identifier">live</span></a></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#ListGraph"><span class="hs-identifier hs-var">ListGraph</span></a><span> </span><a name="local-6989586621684413335"><a href="#local-6989586621684413335"><span class="hs-identifier">code</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1070"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684413336"><a href="#local-6989586621684413336"><span class="hs-identifier">entries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Instruction.html#entryBlocks"><span class="hs-identifier hs-var">entryBlocks</span></a><span> </span><a href="#local-6989586621684413331"><span class="hs-identifier hs-var">proc</span></a><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span>    </span><a name="local-6989586621684413337"><a href="#local-6989586621684413337"><span class="hs-identifier">uniqs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621684413336"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">getUniqueM</span><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-1075"></a><span>      </span><a name="local-6989586621684413338"><a href="#local-6989586621684413338"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621684413346"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="X86.Instr.html#stackAlign"><span class="hs-identifier hs-var">stackAlign</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><a href="X86.Instr.html#stackAlign"><span class="hs-identifier hs-var">stackAlign</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="X86.Instr.html#stackAlign"><span class="hs-identifier hs-var">stackAlign</span></a><span> </span><span class="hs-comment">-- round up</span><span>
</span><a name="line-1076"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413346"><a href="#local-6989586621684413346"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413330"><span class="hs-identifier hs-var">slots</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="X86.Instr.html#spillSlotSize"><span class="hs-identifier hs-var">spillSlotSize</span></a><span> </span><a href="#local-6989586621684413329"><span class="hs-identifier hs-var">platform</span></a><span> </span><span class="hs-comment">-- sp delta</span><span>
</span><a name="line-1077"></a><span>
</span><a name="line-1078"></a><span>      </span><a name="local-6989586621684413339"><a href="#local-6989586621684413339"><span class="hs-identifier">alloc</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Instruction.html#mkStackAllocInstr"><span class="hs-identifier hs-var">mkStackAllocInstr</span></a><span>   </span><a href="#local-6989586621684413329"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413338"><span class="hs-identifier hs-var">delta</span></a><span>
</span><a name="line-1079"></a><span>      </span><a name="local-6989586621684413340"><a href="#local-6989586621684413340"><span class="hs-identifier">dealloc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Instruction.html#mkStackDeallocInstr"><span class="hs-identifier hs-var">mkStackDeallocInstr</span></a><span> </span><a href="#local-6989586621684413329"><span class="hs-identifier hs-var">platform</span></a><span> </span><a href="#local-6989586621684413338"><span class="hs-identifier hs-var">delta</span></a><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>      </span><a name="local-6989586621684413341"><a href="#local-6989586621684413341"><span class="hs-identifier">retargetList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621684413336"><span class="hs-identifier hs-var">entries</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="BlockId.html#mkBlockId"><span class="hs-identifier hs-var">mkBlockId</span></a><span> </span><a href="#local-6989586621684413337"><span class="hs-identifier hs-var">uniqs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1082"></a><span>
</span><a name="line-1083"></a><span>      </span><span class="hs-identifier">new_blockmap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>
</span><a name="line-1084"></a><span>      </span><a name="local-6989586621684413342"><a href="#local-6989586621684413342"><span class="hs-identifier">new_blockmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Collections.html#mapFromList"><span class="hs-identifier hs-var">mapFromList</span></a><span> </span><a href="#local-6989586621684413341"><span class="hs-identifier hs-var">retargetList</span></a><span>
</span><a name="line-1085"></a><span>
</span><a name="line-1086"></a><span>      </span><a name="local-6989586621684413343"><a href="#local-6989586621684413343"><span class="hs-identifier">insert_stack_insns</span></a></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a name="local-6989586621684413347"><a href="#local-6989586621684413347"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621684413348"><a href="#local-6989586621684413348"><span class="hs-identifier">insns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684413350"><a href="#local-6989586621684413350"><span class="hs-identifier">new_blockid</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Collections.html#mapLookup"><span class="hs-identifier hs-var">mapLookup</span></a><span> </span><a href="#local-6989586621684413347"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621684413342"><span class="hs-identifier hs-var">new_blockmap</span></a><span>
</span><a name="line-1088"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a href="#local-6989586621684413347"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621684413339"><span class="hs-identifier hs-var">alloc</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a href="X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a><span> </span><a href="#local-6989586621684413350"><span class="hs-identifier hs-var">new_blockid</span></a><span class="hs-special">]</span><span>
</span><a name="line-1089"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a href="#local-6989586621684413350"><span class="hs-identifier hs-var">new_blockid</span></a><span> </span><a href="#local-6989586621684413349"><span class="hs-identifier hs-var">block'</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1090"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1091"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a><span> </span><a href="#local-6989586621684413347"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621684413349"><span class="hs-identifier hs-var">block'</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1092"></a><span>         </span><span class="hs-keyword">where</span><span>
</span><a name="line-1093"></a><span>           </span><a name="local-6989586621684413349"><a href="#local-6989586621684413349"><span class="hs-identifier">block'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621684413344"><span class="hs-identifier hs-var">insert_dealloc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621684413348"><span class="hs-identifier hs-var">insns</span></a><span>
</span><a name="line-1094"></a><span>
</span><a name="line-1095"></a><span>      </span><a name="local-6989586621684413344"><a href="#local-6989586621684413344"><span class="hs-identifier">insert_dealloc</span></a></a><span> </span><a name="local-6989586621684413351"><a href="#local-6989586621684413351"><span class="hs-identifier">insn</span></a></a><span> </span><a name="local-6989586621684413352"><a href="#local-6989586621684413352"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413351"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1096"></a><span>         </span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413340"><span class="hs-identifier hs-var">dealloc</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413351"><span class="hs-identifier hs-var">insn</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413352"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1097"></a><span>         </span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;insert_dealloc: cannot handle JXX_GBL&quot;</span><span>
</span><a name="line-1098"></a><span>         </span><a name="local-6989586621684413353"><a href="#local-6989586621684413353"><span class="hs-identifier">_other</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#x86_patchJumpInstr"><span class="hs-identifier hs-var">x86_patchJumpInstr</span></a><span> </span><a href="#local-6989586621684413351"><span class="hs-identifier hs-var">insn</span></a><span> </span><a href="#local-6989586621684413354"><span class="hs-identifier hs-var">retarget</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621684413352"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1099"></a><span>           </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413354"><a href="#local-6989586621684413354"><span class="hs-identifier">retarget</span></a></a><span> </span><a name="local-6989586621684413355"><a href="#local-6989586621684413355"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-6989586621684413355"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Collections.html#mapLookup"><span class="hs-identifier hs-var">mapLookup</span></a><span> </span><a href="#local-6989586621684413355"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621684413342"><span class="hs-identifier hs-var">new_blockmap</span></a><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>
</span><a name="line-1101"></a><span>      </span><a name="local-6989586621684413345"><a href="#local-6989586621684413345"><span class="hs-identifier">new_code</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621684413343"><span class="hs-identifier hs-var">insert_stack_insns</span></a><span> </span><a href="#local-6989586621684413335"><span class="hs-identifier hs-var">code</span></a><span>
</span><a name="line-1102"></a><span>    </span><span class="hs-comment">-- in</span><span>
</span><a name="line-1103"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Cmm.html#CmmProc"><span class="hs-identifier hs-var">CmmProc</span></a><span> </span><a href="#local-6989586621684413332"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621684413333"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-6989586621684413334"><span class="hs-identifier hs-var">live</span></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#ListGraph"><span class="hs-identifier hs-var">ListGraph</span></a><span> </span><a href="#local-6989586621684413345"><span class="hs-identifier hs-var">new_code</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621684413341"><span class="hs-identifier hs-var">retargetList</span></a><span class="hs-special">)</span><span>
</span><a name="line-1104"></a><span>
</span><a name="line-1105"></a><span class="hs-keyword">data</span><span> </span><a name="JumpDest"><a href="X86.Instr.html#JumpDest"><span class="hs-identifier">JumpDest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DestBlockId"><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier">DestBlockId</span></a></a><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="DestImm"><a href="X86.Instr.html#DestImm"><span class="hs-identifier">DestImm</span></a></a><span> </span><a href="X86.Regs.html#Imm"><span class="hs-identifier hs-type">Imm</span></a><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span class="hs-comment">-- Debug Instance</span><span>
</span><a name="line-1108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1109"></a><span>  </span><a name="local-8214565720323806217"><span class="hs-identifier">ppr</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684412825"><a href="#local-6989586621684412825"><span class="hs-identifier">bid</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;jd&lt;blk&gt;:&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621684412825"><span class="hs-identifier hs-var">bid</span></a><span>
</span><a name="line-1110"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestImm"><span class="hs-identifier hs-var">DestImm</span></a><span> </span><a name="local-6989586621684412826"><a href="#local-6989586621684412826"><span class="hs-identifier">_imm</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;jd&lt;imm&gt;:noShow&quot;</span><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span>
</span><a name="line-1113"></a><span class="hs-identifier">getJumpDestBlockId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>
</span><a name="line-1114"></a><a name="getJumpDestBlockId"><a href="X86.Instr.html#getJumpDestBlockId"><span class="hs-identifier">getJumpDestBlockId</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413356"><a href="#local-6989586621684413356"><span class="hs-identifier">bid</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684413356"><span class="hs-identifier hs-var">bid</span></a><span>
</span><a name="line-1115"></a><span class="hs-identifier">getJumpDestBlockId</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1116"></a><span>
</span><a name="line-1117"></a><span class="hs-identifier">canShortcut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span>
</span><a name="line-1118"></a><a name="canShortcut"><a href="X86.Instr.html#canShortcut"><span class="hs-identifier">canShortcut</span></a></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a href="X86.Cond.html#ALWAYS"><span class="hs-identifier hs-var">ALWAYS</span></a><span> </span><a name="local-6989586621684413357"><a href="#local-6989586621684413357"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a href="#local-6989586621684413357"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1119"></a><span class="hs-identifier">canShortcut</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#JMP"><span class="hs-identifier hs-var">JMP</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a><span> </span><a name="local-6989586621684413358"><a href="#local-6989586621684413358"><span class="hs-identifier">imm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestImm"><span class="hs-identifier hs-var">DestImm</span></a><span> </span><a href="#local-6989586621684413358"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span class="hs-identifier">canShortcut</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1121"></a><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span class="hs-comment">-- This helper shortcuts a sequence of branches.</span><span>
</span><a name="line-1124"></a><span class="hs-comment">-- The blockset helps avoid following cycles.</span><span>
</span><a name="line-1125"></a><span class="hs-identifier">shortcutJump</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-1126"></a><a name="shortcutJump"><a href="X86.Instr.html#shortcutJump"><span class="hs-identifier">shortcutJump</span></a></a><span> </span><a name="local-6989586621684413359"><a href="#local-6989586621684413359"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621684413360"><a href="#local-6989586621684413360"><span class="hs-identifier">insn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413361"><span class="hs-identifier hs-var">shortcutJump'</span></a><span> </span><a href="#local-6989586621684413359"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Collections.html#setEmpty"><span class="hs-identifier hs-var">setEmpty</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Label.html#LabelSet"><span class="hs-identifier hs-type">LabelSet</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413360"><span class="hs-identifier hs-var">insn</span></a><span>
</span><a name="line-1127"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1128"></a><span>    </span><span class="hs-identifier">shortcutJump'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Label.html#LabelSet"><span class="hs-identifier hs-type">LabelSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a><span>
</span><a name="line-1129"></a><span>    </span><a name="local-6989586621684413361"><a href="#local-6989586621684413361"><span class="hs-identifier">shortcutJump'</span></a></a><span> </span><a name="local-6989586621684413362"><a href="#local-6989586621684413362"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621684413363"><a href="#local-6989586621684413363"><span class="hs-identifier">seen</span></a></a><span> </span><a name="local-6989586621684413364"><a href="#local-6989586621684413364"><span class="hs-identifier">insn</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a name="local-6989586621684413365"><a href="#local-6989586621684413365"><span class="hs-identifier">cc</span></a></a><span> </span><a name="local-6989586621684413366"><a href="#local-6989586621684413366"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1130"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Hoopl.Collections.html#setMember"><span class="hs-identifier hs-var">setMember</span></a><span> </span><a href="#local-6989586621684413366"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621684413363"><span class="hs-identifier hs-var">seen</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621684413364"><span class="hs-identifier hs-var">insn</span></a><span>
</span><a name="line-1131"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413362"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413366"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1132"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413364"><span class="hs-identifier hs-var">insn</span></a><span>
</span><a name="line-1133"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413368"><a href="#local-6989586621684413368"><span class="hs-identifier">id'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413361"><span class="hs-identifier hs-var">shortcutJump'</span></a><span> </span><a href="#local-6989586621684413362"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413367"><span class="hs-identifier hs-var">seen'</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#JXX"><span class="hs-identifier hs-var">JXX</span></a><span> </span><a href="#local-6989586621684413365"><span class="hs-identifier hs-var">cc</span></a><span> </span><a href="#local-6989586621684413368"><span class="hs-identifier hs-var">id'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1134"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestImm"><span class="hs-identifier hs-var">DestImm</span></a><span> </span><a name="local-6989586621684413369"><a href="#local-6989586621684413369"><span class="hs-identifier">imm</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413361"><span class="hs-identifier hs-var">shortcutJump'</span></a><span> </span><a href="#local-6989586621684413362"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413367"><span class="hs-identifier hs-var">seen'</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#JXX_GBL"><span class="hs-identifier hs-var">JXX_GBL</span></a><span> </span><a href="#local-6989586621684413365"><span class="hs-identifier hs-var">cc</span></a><span> </span><a href="#local-6989586621684413369"><span class="hs-identifier hs-var">imm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413367"><a href="#local-6989586621684413367"><span class="hs-identifier">seen'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Collections.html#setInsert"><span class="hs-identifier hs-var">setInsert</span></a><span> </span><a href="#local-6989586621684413366"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621684413363"><span class="hs-identifier hs-var">seen</span></a><span>
</span><a name="line-1136"></a><span>    </span><span class="hs-identifier">shortcutJump'</span><span> </span><a name="local-6989586621684413370"><a href="#local-6989586621684413370"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a name="local-6989586621684413371"><a href="#local-6989586621684413371"><span class="hs-identifier">addr</span></a></a><span> </span><a name="local-6989586621684413372"><a href="#local-6989586621684413372"><span class="hs-identifier">blocks</span></a></a><span> </span><a name="local-6989586621684413373"><a href="#local-6989586621684413373"><span class="hs-identifier">section</span></a></a><span> </span><a name="local-6989586621684413374"><a href="#local-6989586621684413374"><span class="hs-identifier">tblId</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1137"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621684413375"><a href="#local-6989586621684413375"><span class="hs-identifier">updateBlock</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413377"><a href="#local-6989586621684413377"><span class="hs-identifier">bid</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-1138"></a><span>                </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621684413370"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413377"><span class="hs-identifier hs-var">bid</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1139"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a href="#local-6989586621684413377"><span class="hs-identifier hs-var">bid</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1140"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684413378"><a href="#local-6989586621684413378"><span class="hs-identifier">dest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621684413378"><span class="hs-identifier hs-var">dest</span></a><span>
</span><a name="line-1141"></a><span>            </span><span class="hs-identifier">updateBlock</span><span> </span><a name="local-6989586621684413379"><a href="#local-6989586621684413379"><span class="hs-identifier">dest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413379"><span class="hs-identifier hs-var">dest</span></a><span>
</span><a name="line-1142"></a><span>            </span><a name="local-6989586621684413376"><a href="#local-6989586621684413376"><span class="hs-identifier">blocks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621684413375"><span class="hs-identifier hs-var">updateBlock</span></a><span> </span><a href="#local-6989586621684413372"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-1143"></a><span>        </span><span class="hs-keyword">in</span><span>  </span><a href="X86.Instr.html#JMP_TBL"><span class="hs-identifier hs-var">JMP_TBL</span></a><span> </span><a href="#local-6989586621684413371"><span class="hs-identifier hs-var">addr</span></a><span> </span><a href="#local-6989586621684413376"><span class="hs-identifier hs-var">blocks'</span></a><span> </span><a href="#local-6989586621684413373"><span class="hs-identifier hs-var">section</span></a><span> </span><a href="#local-6989586621684413374"><span class="hs-identifier hs-var">tblId</span></a><span>
</span><a name="line-1144"></a><span>    </span><span class="hs-identifier">shortcutJump'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413380"><a href="#local-6989586621684413380"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413380"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1145"></a><span>
</span><a name="line-1146"></a><span class="hs-comment">-- Here because it knows about JumpDest</span><span>
</span><a name="line-1147"></a><span class="hs-identifier">shortcutStatics</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Alignment</span><span class="hs-special">,</span><span> </span><a href="Cmm.html#CmmStatics"><span class="hs-identifier hs-type">CmmStatics</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Alignment</span><span class="hs-special">,</span><span> </span><a href="Cmm.html#CmmStatics"><span class="hs-identifier hs-type">CmmStatics</span></a><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><a name="shortcutStatics"><a href="X86.Instr.html#shortcutStatics"><span class="hs-identifier">shortcutStatics</span></a></a><span> </span><a name="local-6989586621684413381"><a href="#local-6989586621684413381"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621684413382"><a href="#local-6989586621684413382"><span class="hs-identifier">align</span></a></a><span class="hs-special">,</span><span> </span><a href="Cmm.html#Statics"><span class="hs-identifier hs-var">Statics</span></a><span> </span><a name="local-6989586621684413383"><a href="#local-6989586621684413383"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621684413384"><a href="#local-6989586621684413384"><span class="hs-identifier">statics</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1149"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621684413382"><span class="hs-identifier hs-var">align</span></a><span class="hs-special">,</span><span> </span><a href="Cmm.html#Statics"><span class="hs-identifier hs-var">Statics</span></a><span> </span><a href="#local-6989586621684413383"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#shortcutStatic"><span class="hs-identifier hs-var">shortcutStatic</span></a><span> </span><a href="#local-6989586621684413381"><span class="hs-identifier hs-var">fn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413384"><span class="hs-identifier hs-var">statics</span></a><span class="hs-special">)</span><span>
</span><a name="line-1150"></a><span>  </span><span class="hs-comment">-- we need to get the jump tables, so apply the mapping to the entries</span><span>
</span><a name="line-1151"></a><span>  </span><span class="hs-comment">-- of a CmmData too.</span><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span class="hs-identifier">shortcutLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span>
</span><a name="line-1154"></a><a name="shortcutLabel"><a href="X86.Instr.html#shortcutLabel"><span class="hs-identifier">shortcutLabel</span></a></a><span> </span><a name="local-6989586621684413385"><a href="#local-6989586621684413385"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621684413386"><a href="#local-6989586621684413386"><span class="hs-identifier">lab</span></a></a><span>
</span><a name="line-1155"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621684413387"><a href="#local-6989586621684413387"><span class="hs-identifier">blkId</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CLabel.html#maybeLocalBlockLabel"><span class="hs-identifier hs-var">maybeLocalBlockLabel</span></a><span> </span><a href="#local-6989586621684413386"><span class="hs-identifier hs-var">lab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="X86.Instr.html#shortBlockId"><span class="hs-identifier hs-var">shortBlockId</span></a><span> </span><a href="#local-6989586621684413385"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-identifier hs-var">emptyUniqSet</span><span> </span><a href="#local-6989586621684413387"><span class="hs-identifier hs-var">blkId</span></a><span>
</span><a name="line-1156"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413386"><span class="hs-identifier hs-var">lab</span></a><span>
</span><a name="line-1157"></a><span>
</span><a name="line-1158"></a><span class="hs-identifier">shortcutStatic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cmm.html#CmmStatic"><span class="hs-identifier hs-type">CmmStatic</span></a><span>
</span><a name="line-1159"></a><a name="shortcutStatic"><a href="X86.Instr.html#shortcutStatic"><span class="hs-identifier">shortcutStatic</span></a></a><span> </span><a name="local-6989586621684413388"><a href="#local-6989586621684413388"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><a name="local-6989586621684413389"><a href="#local-6989586621684413389"><span class="hs-identifier">lab</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1160"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#shortcutLabel"><span class="hs-identifier hs-var">shortcutLabel</span></a><span> </span><a href="#local-6989586621684413388"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413389"><span class="hs-identifier hs-var">lab</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span class="hs-identifier">shortcutStatic</span><span> </span><a name="local-6989586621684413390"><a href="#local-6989586621684413390"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-special">(</span><a href="Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a><span> </span><a name="local-6989586621684413391"><a href="#local-6989586621684413391"><span class="hs-identifier">lbl1</span></a></a><span> </span><a name="local-6989586621684413392"><a href="#local-6989586621684413392"><span class="hs-identifier">lbl2</span></a></a><span> </span><a name="local-6989586621684413393"><a href="#local-6989586621684413393"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621684413394"><a href="#local-6989586621684413394"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1162"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a><span> </span><span class="hs-special">(</span><a href="CmmExpr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#shortcutLabel"><span class="hs-identifier hs-var">shortcutLabel</span></a><span> </span><a href="#local-6989586621684413390"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413391"><span class="hs-identifier hs-var">lbl1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413392"><span class="hs-identifier hs-var">lbl2</span></a><span> </span><a href="#local-6989586621684413393"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="#local-6989586621684413394"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-1163"></a><span>        </span><span class="hs-comment">-- slightly dodgy, we're ignoring the second label, but this</span><span>
</span><a name="line-1164"></a><span>        </span><span class="hs-comment">-- works with the way we use CmmLabelDiffOff for jump tables now.</span><span>
</span><a name="line-1165"></a><span class="hs-identifier">shortcutStatic</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621684413395"><a href="#local-6989586621684413395"><span class="hs-identifier">other_static</span></a></a><span>
</span><a name="line-1166"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621684413395"><span class="hs-identifier hs-var">other_static</span></a><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span class="hs-identifier">shortBlockId</span><span>
</span><a name="line-1169"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="X86.Instr.html#JumpDest"><span class="hs-identifier hs-type">JumpDest</span></a><span class="hs-special">)</span><span>
</span><a name="line-1170"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">UniqSet</span><span> </span><span class="hs-identifier hs-type">Unique</span><span>
</span><a name="line-1171"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a><span>
</span><a name="line-1172"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CLabel.html#CLabel"><span class="hs-identifier hs-type">CLabel</span></a><span>
</span><a name="line-1173"></a><span>
</span><a name="line-1174"></a><a name="shortBlockId"><a href="X86.Instr.html#shortBlockId"><span class="hs-identifier">shortBlockId</span></a></a><span> </span><a name="local-6989586621684413396"><a href="#local-6989586621684413396"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621684413397"><a href="#local-6989586621684413397"><span class="hs-identifier">seen</span></a></a><span> </span><a name="local-6989586621684413398"><a href="#local-6989586621684413398"><span class="hs-identifier">blockid</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1175"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elementOfUniqSet</span><span> </span><a href="#local-6989586621684413399"><span class="hs-identifier hs-var">uq</span></a><span> </span><a href="#local-6989586621684413397"><span class="hs-identifier hs-var">seen</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621684413396"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621684413398"><span class="hs-identifier hs-var">blockid</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1176"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a><span> </span><a href="#local-6989586621684413398"><span class="hs-identifier hs-var">blockid</span></a><span>
</span><a name="line-1177"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a><span> </span><a href="#local-6989586621684413398"><span class="hs-identifier hs-var">blockid</span></a><span>
</span><a name="line-1178"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestBlockId"><span class="hs-identifier hs-var">DestBlockId</span></a><span> </span><a name="local-6989586621684413400"><a href="#local-6989586621684413400"><span class="hs-identifier">blockid'</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="X86.Instr.html#shortBlockId"><span class="hs-identifier hs-var">shortBlockId</span></a><span> </span><a href="#local-6989586621684413396"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">addOneToUniqSet</span><span> </span><a href="#local-6989586621684413397"><span class="hs-identifier hs-var">seen</span></a><span> </span><a href="#local-6989586621684413399"><span class="hs-identifier hs-var">uq</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621684413400"><span class="hs-identifier hs-var">blockid'</span></a><span>
</span><a name="line-1179"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="X86.Instr.html#DestImm"><span class="hs-identifier hs-var">DestImm</span></a><span> </span><span class="hs-special">(</span><a href="X86.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a><span> </span><a name="local-6989586621684413401"><a href="#local-6989586621684413401"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621684413401"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-1180"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621684413402"><a href="#local-6989586621684413402"><span class="hs-identifier">_other</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">panic</span><span> </span><span class="hs-string">&quot;shortBlockId&quot;</span><span>
</span><a name="line-1181"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621684413399"><a href="#local-6989586621684413399"><span class="hs-identifier">uq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">getUnique</span><span> </span><a href="#local-6989586621684413398"><span class="hs-identifier hs-var">blockid</span></a><span>
</span><a name="line-1182"></a></pre></body></html>