<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- vim:fdm=marker:foldtext=foldtext()</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Module    : Test.SmallCheck.Series</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Copyright : (c) Colin Runciman et al.</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License   : BSD3</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer: Roman Cheplyaka &lt;roma@ro-che.info&gt;</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- You need this module if you want to generate test values of your own</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- types.</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- You'll typically need the following extensions:</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- &gt;{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- SmallCheck itself defines data generators for all the data types used</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- by the &quot;Prelude&quot;.</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- In order to generate values and functions of your own types, you need</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- to make them instances of 'Serial' (for values) and 'CoSerial' (for</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- functions). There are two main ways to do so: using Generics or writing</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- the instances by hand.</span><span>
</span><a name="line-24"></a><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-pragma">{-# LANGUAGE CPP, RankNTypes, MultiParamTypeClasses, FlexibleInstances,
             GeneralizedNewtypeDeriving, FlexibleContexts, ScopedTypeVariables #-}</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- The following is needed for generic instances</span><span>
</span><a name="line-29"></a><span class="hs-pragma">{-# LANGUAGE DefaultSignatures, FlexibleContexts, TypeOperators,
             TypeSynonymInstances, FlexibleInstances, OverlappingInstances #-}</span><span>
</span><a name="line-31"></a><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.SmallCheck.Series</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-comment">-- {{{</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-comment">-- * Generic instances</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-comment">-- | The easiest way to create the necessary instances is to use GHC</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-comment">-- generics (available starting with GHC 7.2.1).</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-comment">-- Here's a complete example:</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-comment">-- &gt;{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- &gt;{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-comment">-- &gt;import Test.SmallCheck.Series</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-comment">-- &gt;import GHC.Generics</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-comment">-- &gt;data Tree a = Null | Fork (Tree a) a (Tree a)</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-comment">-- &gt;    deriving Generic</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-comment">-- &gt;instance Serial m a =&gt; Serial m (Tree a)</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-comment">-- Here we enable the @DeriveGeneric@ extension which allows to derive 'Generic'</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-comment">-- instance for our data type. Then we declare that @Tree a@ is an instance of</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-comment">-- 'Serial', but do not provide any definitions. This causes GHC to use the</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-comment">-- default definitions that use the 'Generic' instance.</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">-- One minor limitation of generic instances is that there's currently no</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-comment">-- way to distinguish newtypes and datatypes. Thus, newtype constructors</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-comment">-- will also count as one level of depth.</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-comment">-- * Data Generators</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-comment">-- | Writing 'Serial' instances for application-specific types is</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-comment">-- straightforward. You need to define a 'series' generator, typically using</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-comment">-- @consN@ family of generic combinators where N is constructor arity.</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-comment">-- For example:</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-comment">-- &gt;data Tree a = Null | Fork (Tree a) a (Tree a)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-comment">-- &gt;instance Serial m a =&gt; Serial m (Tree a) where</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-comment">-- &gt;  series = cons0 Null \/ cons3 Fork</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-comment">-- For newtypes use 'newtypeCons' instead of 'cons1'.</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-comment">-- The difference is that 'cons1' is counts as one level of depth, while</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-comment">-- 'newtypeCons' doesn't affect the depth.</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-77"></a><span>  </span><span class="hs-comment">-- &gt;newtype Light a = Light a</span><span>
</span><a name="line-78"></a><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-comment">-- &gt;instance Serial m a =&gt; Serial m (Light a) where</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-comment">-- &gt;  series = newtypeCons Light</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- For data types with more than 4 fields define @consN@ as</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-comment">-- &gt;consN f = decDepth $</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-comment">-- &gt;  f &lt;$&gt; series</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-comment">-- &gt;    &lt;~&gt; series</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-comment">-- &gt;    &lt;~&gt; series</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-comment">-- &gt;    &lt;~&gt; ...    {- series repeated N times in total -}</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-comment">-- ** What does consN do, exactly?</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- | @consN@ has type</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- @(Serial t_1, ..., Serial t_N) =&gt; (t_1 -&gt; ... -&gt; t_N -&gt; t) -&gt; Series t@.</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-comment">-- @consN f@ is a series which, for a given depth @d &gt; 0@, produces values of the</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-comment">-- form</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-comment">-- &gt;f x_1 ... x_N</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-comment">-- where @x_i@ ranges over all values of type @t_i@ of depth up to @d-1@</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-comment">-- (as defined by the 'series' functions for @t_i@).</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-comment">-- @consN@ functions also ensure that x_i are enumerated in the</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-comment">-- breadth-first order. Thus, combinations of smaller depth come first</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-comment">-- (assuming the same is true for @t_i@).</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-comment">-- If @d &lt;= 0@, no values are produced.</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>  </span><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier hs-var">cons0</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#cons1"><span class="hs-identifier hs-var">cons1</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#cons2"><span class="hs-identifier hs-var">cons2</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#cons3"><span class="hs-identifier hs-var">cons3</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#cons4"><span class="hs-identifier hs-var">cons4</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#newtypeCons"><span class="hs-identifier hs-var">newtypeCons</span></a><span class="hs-special">,</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-comment">-- * Function Generators</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-comment">-- | To generate functions of an application-specific argument type,</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-comment">-- make the type an instance of 'CoSerial'.</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-comment">-- Again there is a standard pattern, this time using the altsN</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-comment">-- combinators where again N is constructor arity.  Here are @Tree@ and</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-comment">-- @Light@ instances:</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-comment">-- &gt;instance CoSerial m a =&gt; CoSerial m (Tree a) where</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-comment">-- &gt;  coseries rs =</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-comment">-- &gt;    alts0 rs &gt;&gt;- \z -&gt;</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-comment">-- &gt;    alts3 rs &gt;&gt;- \f -&gt;</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-comment">-- &gt;    return $ \t -&gt;</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-comment">-- &gt;      case t of</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-comment">-- &gt;        Null -&gt; z</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-comment">-- &gt;        Fork t1 x t2 -&gt; f t1 x t2</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-comment">-- &gt;instance CoSerial m a =&gt; CoSerial m (Light a) where</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-comment">-- &gt;  coseries rs =</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-comment">-- &gt;    newtypeAlts rs &gt;&gt;- \f -&gt;</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-comment">-- &gt;    return $ \l -&gt;</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-comment">-- &gt;      case l of</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-comment">-- &gt;        Light x -&gt; f x</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-comment">-- For data types with more than 4 fields define @altsN@ as</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-comment">-- &gt;altsN rs = do</span><span>
</span><a name="line-139"></a><span>  </span><span class="hs-comment">-- &gt;  rs &lt;- fixDepth rs</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-comment">-- &gt;  decDepthChecked</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-comment">-- &gt;    (constM $ constM $ ... $ constM rs)</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-comment">-- &gt;    (coseries $ coseries $ ... $ coseries rs)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-comment">-- &gt;    {- constM and coseries are repeated N times each -}</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-comment">-- ** What does altsN do, exactly?</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>  </span><span class="hs-comment">-- | @altsN@ has type</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-comment">-- @(Serial t_1, ..., Serial t_N) =&gt; Series t -&gt; Series (t_1 -&gt; ... -&gt; t_N -&gt; t)@.</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-comment">-- @altsN s@ is a series which, for a given depth @d@, produces functions of</span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-comment">-- type</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-comment">-- &gt;t_1 -&gt; ... -&gt; t_N -&gt; t</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-comment">-- If @d &lt;= 0@, these are constant functions, one for each value produced</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-comment">-- by @s@.</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-comment">-- If @d &gt; 0@, these functions inspect each of their arguments up to the depth</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-comment">-- @d-1@ (as defined by the 'coseries' functions for the corresponding</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-comment">-- types) and return values produced by @s@. The depth to which the</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-comment">-- values are enumerated does not depend on the depth of inspection.</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>  </span><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier hs-var">alts0</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#alts2"><span class="hs-identifier hs-var">alts2</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#alts3"><span class="hs-identifier hs-var">alts3</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#alts4"><span class="hs-identifier hs-var">alts4</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#newtypeAlts"><span class="hs-identifier hs-var">newtypeAlts</span></a><span class="hs-special">,</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span>  </span><span class="hs-comment">-- * Basic definitions</span><span>
</span><a name="line-166"></a><span>  </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-comment">-- * Generic implementations</span><span>
</span><a name="line-169"></a><span>  </span><a href="Test.SmallCheck.Series.html#genericSeries"><span class="hs-identifier hs-var">genericSeries</span></a><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>  </span><a href="Test.SmallCheck.Series.html#genericCoseries"><span class="hs-identifier hs-var">genericCoseries</span></a><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-comment">-- * Convenient wrappers</span><span>
</span><a name="line-173"></a><span>  </span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier hs-type">NonNegative</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>  </span><span class="hs-comment">-- * Other useful definitions</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#%3E%3C"><span class="hs-operator hs-var">&gt;&lt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;-</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>  </span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>  </span><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-180"></a><span>  </span><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier hs-var">generate</span></a><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>  </span><a href="Test.SmallCheck.Series.html#limit"><span class="hs-identifier hs-var">limit</span></a><span class="hs-special">,</span><span>
</span><a name="line-182"></a><span>  </span><a href="Test.SmallCheck.Series.html#listSeries"><span class="hs-identifier hs-var">listSeries</span></a><span class="hs-special">,</span><span>
</span><a name="line-183"></a><span>  </span><a href="Test.SmallCheck.Series.html#list"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">,</span><span>
</span><a name="line-184"></a><span>  </span><a href="Test.SmallCheck.Series.html#listM"><span class="hs-identifier hs-var">listM</span></a><span class="hs-special">,</span><span>
</span><a name="line-185"></a><span>  </span><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier hs-var">fixDepth</span></a><span class="hs-special">,</span><span>
</span><a name="line-186"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier hs-var">decDepthChecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>  </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span>
</span><a name="line-188"></a><span>  </span><span class="hs-comment">-- }}}</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Logic</span><span>
</span><a name="line-192"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-193"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><a name="line-194"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Identity</span><span>
</span><a name="line-195"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Int</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int16</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-197"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ratio</span><span>
</span><a name="line-198"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Word</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word16</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word32</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric.Natural</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Natural</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span class="hs-keyword">import</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html"><span class="hs-identifier">Test.SmallCheck.SeriesMonad</span></a><span>
</span><a name="line-201"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- Main types and classes</span><span>
</span><a name="line-205"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-206"></a><span class="hs-comment">--{{{</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679035460"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Serial"><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier">Serial</span></a></a><span> </span><a name="local-6989586621679035460"><a href="#local-6989586621679035460"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679035461"><a href="#local-6989586621679035461"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>  </span><a name="series"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035460"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035461"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-keyword">default</span><span> </span><a name="series"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679035461"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679035460"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679035461"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035460"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035461"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-212"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#genericSeries"><span class="hs-identifier hs-var">genericSeries</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-identifier">genericSeries</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039353"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679039354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039353"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679039354"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039353"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039354"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-217"></a><a name="genericSeries"><a href="Test.SmallCheck.Series.html#genericSeries"><span class="hs-identifier">genericSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">to</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="CoSerial"><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier">CoSerial</span></a></a><span> </span><a name="local-6989586621679035456"><a href="#local-6989586621679035456"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679035457"><a href="#local-6989586621679035457"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-comment">-- | A proper 'coseries' implementation should pass the depth unchanged to</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-comment">-- its first argument. Doing otherwise will make enumeration of curried</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-comment">-- functions non-uniform in their arguments.</span><span>
</span><a name="line-223"></a><span>  </span><a name="coseries"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035458"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679035458"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span>  </span><span class="hs-keyword">default</span><span> </span><a name="coseries"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#genericCoseries"><span class="hs-identifier hs-var">genericCoseries</span></a><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">genericCoseries</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039350"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679039351"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039350"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679039351"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039350"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039352"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039350"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039351"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039352"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="genericCoseries"><a href="Test.SmallCheck.Series.html#genericCoseries"><span class="hs-identifier">genericCoseries</span></a></a><span> </span><a name="local-6989586621679039355"><a href="#local-6989586621679039355"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">from</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><a href="#local-6989586621679039355"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- Helper functions</span><span>
</span><a name="line-236"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- {{{</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | A simple series specified by a function from depth to the list of</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- values up to that depth.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">generate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039348"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039349"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039348"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-242"></a><a name="generate"><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier">generate</span></a></a><span> </span><a name="local-6989586621679039356"><a href="#local-6989586621679039356"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-243"></a><span>  </span><a name="local-6989586621679039357"><a href="#local-6989586621679039357"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier hs-var">msum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679039356"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039357"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">-- | Limit a 'Series' to its first @n@ elements</span><span>
</span><a name="line-247"></a><span class="hs-identifier">limit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679039346"><a href="#local-6989586621679039346"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679039347"><a href="#local-6989586621679039347"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039346"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039346"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039347"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039346"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039347"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-248"></a><a name="limit"><a href="Test.SmallCheck.Series.html#limit"><span class="hs-identifier">limit</span></a></a><span> </span><a name="local-6989586621679039358"><a href="#local-6989586621679039358"><span class="hs-identifier">n0</span></a></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-var">Series</span></a><span> </span><a name="local-6989586621679039359"><a href="#local-6989586621679039359"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-var">Series</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679039360"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679039358"><span class="hs-identifier hs-var">n0</span></a><span> </span><a href="#local-6989586621679039359"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadLogic</span><span> </span><a href="#local-6989586621679039361"><span class="hs-identifier hs-type">ml</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039361"><span class="hs-identifier hs-type">ml</span></a><span> </span><a href="#local-6989586621679039362"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039361"><span class="hs-identifier hs-type">ml</span></a><span> </span><a href="#local-6989586621679039362"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-251"></a><span>    </span><a name="local-6989586621679039360"><a href="#local-6989586621679039360"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mzero</span><span>
</span><a name="line-252"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679039363"><a href="#local-6989586621679039363"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679039364"><a href="#local-6989586621679039364"><span class="hs-identifier">mb1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-253"></a><span>      </span><a name="local-6989586621679039367"><a href="#local-6989586621679039367"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039365"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039366"><span class="hs-identifier hs-type">ml</span></a><span> </span><a href="#local-6989586621679039365"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">msplit</span><span> </span><a href="#local-6989586621679039364"><span class="hs-identifier hs-var">mb1</span></a><span>
</span><a name="line-254"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679039367"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-255"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mzero</span><span>
</span><a name="line-256"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679039368"><a href="#local-6989586621679039368"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679039369"><a href="#local-6989586621679039369"><span class="hs-identifier">mb2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679039368"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679039360"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039363"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039369"><span class="hs-identifier hs-var">mb2</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-identifier">suchThat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039344"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039345"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039345"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039344"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039345"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-259"></a><a name="suchThat"><a href="Test.SmallCheck.Series.html#suchThat"><span class="hs-identifier">suchThat</span></a></a><span> </span><a name="local-6989586621679039370"><a href="#local-6989586621679039370"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679039371"><a href="#local-6989586621679039371"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039370"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679039372"><a href="#local-6989586621679039372"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679039371"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679039372"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679039372"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- | Given a depth, return the list of values generated by a Serial instance.</span><span>
</span><a name="line-262"></a><span class="hs-comment">--</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- Example, list all integers up to depth 1:</span><span>
</span><a name="line-264"></a><span class="hs-comment">--</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- * @listSeries 1 :: [Int]   -- returns [0,1,-1]@</span><span>
</span><a name="line-266"></a><span class="hs-identifier">listSeries</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679039343"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039343"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-267"></a><a name="listSeries"><a href="Test.SmallCheck.Series.html#listSeries"><span class="hs-identifier">listSeries</span></a></a><span> </span><a name="local-6989586621679039373"><a href="#local-6989586621679039373"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#list"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679039373"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">-- | Return the list of values generated by a 'Series'. Useful for</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- debugging 'Serial' instances.</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- Examples:</span><span>
</span><a name="line-273"></a><span class="hs-comment">--</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- * @list 3 'series' :: [Int]                  -- returns [0,1,-1,2,-2,3,-3]@</span><span>
</span><a name="line-275"></a><span class="hs-comment">--</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- * @list 3 ('series' :: 'Series' 'Identity' Int)  -- returns [0,1,-1,2,-2,3,-3]@</span><span>
</span><a name="line-277"></a><span class="hs-comment">--</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- * @list 2 'series' :: [[Bool]]               -- returns [[],[True],[False]]@</span><span>
</span><a name="line-279"></a><span class="hs-comment">--</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- The first two are equivalent. The second has a more explicit type binding.</span><span>
</span><a name="line-281"></a><span class="hs-identifier">list</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679039342"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039342"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-282"></a><a name="list"><a href="Test.SmallCheck.Series.html#list"><span class="hs-identifier">list</span></a></a><span> </span><a name="local-6989586621679039374"><a href="#local-6989586621679039374"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679039375"><a href="#local-6989586621679039375"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">observeAllT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#runSeries"><span class="hs-identifier hs-var">runSeries</span></a><span> </span><a href="#local-6989586621679039374"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679039375"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-comment">-- | Monadic version of 'list'</span><span>
</span><a name="line-285"></a><span class="hs-identifier">listM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039340"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039340"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039341"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039340"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039341"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-286"></a><a name="listM"><a href="Test.SmallCheck.Series.html#listM"><span class="hs-identifier">listM</span></a></a><span> </span><a name="local-6989586621679039376"><a href="#local-6989586621679039376"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679039377"><a href="#local-6989586621679039377"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">observeAllT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#runSeries"><span class="hs-identifier hs-var">runSeries</span></a><span> </span><a href="#local-6989586621679039376"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679039377"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- | Sum (union) of series</span><span>
</span><a name="line-289"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span> </span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span>
</span><a name="line-290"></a><span class="hs-special">(</span><span class="hs-operator">\/</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039338"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039338"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039338"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039338"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039339"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-291"></a><span class="hs-special">(</span><a name="%5C%2F"><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator">\/</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">interleave</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- | Product of series</span><span>
</span><a name="line-294"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">8</span><span> </span><a href="Test.SmallCheck.Series.html#%3E%3C"><span class="hs-operator hs-var">&gt;&lt;</span></a><span>
</span><a name="line-295"></a><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039335"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039335"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039336"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039335"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039337"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039335"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039336"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679039337"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><a name="local-6989586621679039378"><a href="#local-6989586621679039378"><span class="hs-identifier">a</span></a></a><span> </span><a name="%3E%3C"><a href="Test.SmallCheck.Series.html#%3E%3C"><span class="hs-operator">&gt;&lt;</span></a></a><span> </span><a name="local-6989586621679039379"><a href="#local-6989586621679039379"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679039378"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="#local-6989586621679039379"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- | Fair version of 'ap' and '&lt;*&gt;'</span><span>
</span><a name="line-299"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span>
</span><a name="line-300"></a><span class="hs-special">(</span><span class="hs-operator">&lt;~&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039332"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039332"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039333"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039334"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039332"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039333"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039332"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039334"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-301"></a><a name="local-6989586621679039380"><a href="#local-6989586621679039380"><span class="hs-identifier">a</span></a></a><span> </span><a name="%3C~%3E"><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator">&lt;~&gt;</span></a></a><span> </span><a name="local-6989586621679039381"><a href="#local-6989586621679039381"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039380"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679039381"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">uncurry3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039328"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039329"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039330"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039331"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679039328"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679039329"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679039330"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039331"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><a name="uncurry3"><a href="Test.SmallCheck.Series.html#uncurry3"><span class="hs-identifier">uncurry3</span></a></a><span> </span><a name="local-6989586621679039382"><a href="#local-6989586621679039382"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039383"><a href="#local-6989586621679039383"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039384"><a href="#local-6989586621679039384"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039385"><a href="#local-6989586621679039385"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039382"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039383"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679039384"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679039385"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">uncurry4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039323"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039324"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039325"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039326"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039327"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679039323"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679039324"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679039325"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679039326"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039327"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><a name="uncurry4"><a href="Test.SmallCheck.Series.html#uncurry4"><span class="hs-identifier">uncurry4</span></a></a><span> </span><a name="local-6989586621679039386"><a href="#local-6989586621679039386"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039387"><a href="#local-6989586621679039387"><span class="hs-identifier">w</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039388"><a href="#local-6989586621679039388"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039389"><a href="#local-6989586621679039389"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039390"><a href="#local-6989586621679039390"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039386"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039387"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679039388"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679039389"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679039390"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-comment">-- | Query the current depth</span><span>
</span><a name="line-310"></a><span class="hs-identifier">getDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039322"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span>
</span><a name="line-311"></a><a name="getDepth"><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier">getDepth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-var">Series</span></a><span> </span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-comment">-- | Run a series with a modified depth</span><span>
</span><a name="line-314"></a><span class="hs-identifier">localDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039320"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039321"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039320"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039321"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-315"></a><a name="localDepth"><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier">localDepth</span></a></a><span> </span><a name="local-6989586621679039554"><a href="#local-6989586621679039554"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-var">Series</span></a><span> </span><a name="local-6989586621679039555"><a href="#local-6989586621679039555"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-var">Series</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">local</span><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039555"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">-- | Run a 'Series' with the depth decreased by 1.</span><span>
</span><a name="line-318"></a><span class="hs-comment">--</span><span>
</span><a name="line-319"></a><span class="hs-comment">-- If the current depth is less or equal to 0, the result is 'mzero'.</span><span>
</span><a name="line-320"></a><span class="hs-identifier">decDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039318"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039319"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039318"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039319"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-321"></a><a name="decDepth"><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier">decDepth</span></a></a><span> </span><a name="local-6989586621679039556"><a href="#local-6989586621679039556"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-322"></a><span>  </span><a href="Test.SmallCheck.Series.html#checkDepth"><span class="hs-identifier hs-var">checkDepth</span></a><span>
</span><a name="line-323"></a><span>  </span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">subtract</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039556"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">checkDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039317"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><a name="checkDepth"><a href="Test.SmallCheck.Series.html#checkDepth"><span class="hs-identifier">checkDepth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-327"></a><span>  </span><a name="local-6989586621679039557"><a href="#local-6989586621679039557"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a><span>
</span><a name="line-328"></a><span>  </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679039557"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">-- | @'constM' = 'liftM' 'const'@</span><span>
</span><a name="line-331"></a><span class="hs-identifier">constM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039314"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679039314"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039315"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039314"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039316"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039315"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><a name="constM"><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier">constM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-comment">-- | Fix the depth of a series at the current level. The resulting series</span><span>
</span><a name="line-335"></a><span class="hs-comment">-- will no longer depend on the \&quot;ambient\&quot; depth.</span><span>
</span><a name="line-336"></a><span class="hs-identifier">fixDepth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039312"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039313"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039312"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039312"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-337"></a><a name="fixDepth"><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier">fixDepth</span></a></a><span> </span><a name="local-6989586621679039558"><a href="#local-6989586621679039558"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679039559"><a href="#local-6989586621679039559"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- | If the current depth is 0, evaluate the first argument. Otherwise,</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- evaluate the second argument with decremented depth.</span><span>
</span><a name="line-341"></a><span class="hs-identifier">decDepthChecked</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039310"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039311"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039310"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039311"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039310"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039311"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-342"></a><a name="decDepthChecked"><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier">decDepthChecked</span></a></a><span> </span><a name="local-6989586621679039560"><a href="#local-6989586621679039560"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679039561"><a href="#local-6989586621679039561"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-343"></a><span>  </span><a name="local-6989586621679039562"><a href="#local-6989586621679039562"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a><span>
</span><a name="line-344"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679039562"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-345"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-346"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-identifier">unwind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadLogic</span><span> </span><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-349"></a><a name="unwind"><a href="Test.SmallCheck.Series.html#unwind"><span class="hs-identifier">unwind</span></a></a><span> </span><a name="local-6989586621679039563"><a href="#local-6989586621679039563"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-350"></a><span>  </span><span class="hs-identifier hs-var">msplit</span><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span>
</span><a name="line-351"></a><span>  </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679039564"><a href="#local-6989586621679039564"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679039565"><a href="#local-6989586621679039565"><span class="hs-identifier">a'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039564"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">`</span><span> </span><a href="Test.SmallCheck.Series.html#unwind"><span class="hs-identifier hs-var">unwind</span></a><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-356"></a><span class="hs-comment">-- cons* and alts* functions</span><span>
</span><a name="line-357"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- {{{</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">cons0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039307"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-361"></a><a name="cons0"><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier">cons0</span></a></a><span> </span><a name="local-6989586621679039566"><a href="#local-6989586621679039566"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">cons1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039303"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039304"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039304"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039305"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039303"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039305"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-364"></a><a name="cons1"><a href="Test.SmallCheck.Series.html#cons1"><span class="hs-identifier">cons1</span></a></a><span> </span><a name="local-6989586621679039567"><a href="#local-6989586621679039567"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Same as 'cons1', but preserves the depth.</span><span>
</span><a name="line-367"></a><span class="hs-identifier">newtypeCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039300"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039301"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039301"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039302"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039300"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039302"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-368"></a><a name="newtypeCons"><a href="Test.SmallCheck.Series.html#newtypeCons"><span class="hs-identifier">newtypeCons</span></a></a><span> </span><a name="local-6989586621679039568"><a href="#local-6989586621679039568"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039568"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">cons2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039297"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039298"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039297"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039298"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039299"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039299"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-371"></a><a name="cons2"><a href="Test.SmallCheck.Series.html#cons2"><span class="hs-identifier">cons2</span></a></a><span> </span><a name="local-6989586621679039569"><a href="#local-6989586621679039569"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-identifier">cons3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039293"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-374"></a><span>         </span><span class="hs-special">(</span><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039293"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039295"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039295"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-375"></a><a name="cons3"><a href="Test.SmallCheck.Series.html#cons3"><span class="hs-identifier">cons3</span></a></a><span> </span><a name="local-6989586621679039570"><a href="#local-6989586621679039570"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-376"></a><span>  </span><a href="#local-6989586621679039570"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-377"></a><span>    </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-378"></a><span>    </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">cons4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039285"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039285"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039287"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039285"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039288"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039285"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039289"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-381"></a><span>         </span><span class="hs-special">(</span><a href="#local-6989586621679039286"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039287"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039288"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039289"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039285"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-382"></a><a name="cons4"><a href="Test.SmallCheck.Series.html#cons4"><span class="hs-identifier">cons4</span></a></a><span> </span><a name="local-6989586621679039571"><a href="#local-6989586621679039571"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-383"></a><span>  </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-384"></a><span>    </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-385"></a><span>    </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-386"></a><span>    </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-identifier">alts0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039283"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039284"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039283"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039284"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-389"></a><a name="alts0"><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier">alts0</span></a></a><span> </span><a name="local-6989586621679039572"><a href="#local-6989586621679039572"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039572"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-identifier">alts1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039281"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039281"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><a name="alts1"><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier">alts1</span></a></a><span> </span><a name="local-6989586621679039573"><a href="#local-6989586621679039573"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-393"></a><span>  </span><a name="local-6989586621679039574"><a href="#local-6989586621679039574"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier hs-var">fixDepth</span></a><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-394"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier hs-var">decDepthChecked</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-identifier">alts2</span><span>
</span><a name="line-397"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039276"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039277"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039276"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039278"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039276"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039279"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039276"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039277"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039278"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039279"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><a name="alts2"><a href="Test.SmallCheck.Series.html#alts2"><span class="hs-identifier">alts2</span></a></a><span> </span><a name="local-6989586621679039575"><a href="#local-6989586621679039575"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-400"></a><span>  </span><a name="local-6989586621679039576"><a href="#local-6989586621679039576"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier hs-var">fixDepth</span></a><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-401"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier hs-var">decDepthChecked</span></a><span>
</span><a name="line-402"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-identifier">alts3</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039271"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039272"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039271"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039273"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039271"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039274"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-406"></a><span>            </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039271"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039275"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039271"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039272"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039273"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039274"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039275"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><a name="alts3"><a href="Test.SmallCheck.Series.html#alts3"><span class="hs-identifier">alts3</span></a></a><span> </span><a name="local-6989586621679039577"><a href="#local-6989586621679039577"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-408"></a><span>  </span><a name="local-6989586621679039578"><a href="#local-6989586621679039578"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier hs-var">fixDepth</span></a><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-409"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier hs-var">decDepthChecked</span></a><span>
</span><a name="line-410"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-identifier">alts4</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039266"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039267"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039268"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039269"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-414"></a><span>            </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039270"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039265"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039266"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039267"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039268"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039269"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039270"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><a name="alts4"><a href="Test.SmallCheck.Series.html#alts4"><span class="hs-identifier">alts4</span></a></a><span> </span><a name="local-6989586621679039579"><a href="#local-6989586621679039579"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-416"></a><span>  </span><a name="local-6989586621679039580"><a href="#local-6989586621679039580"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#fixDepth"><span class="hs-identifier hs-var">fixDepth</span></a><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-417"></a><span>  </span><a href="Test.SmallCheck.Series.html#decDepthChecked"><span class="hs-identifier hs-var">decDepthChecked</span></a><span>
</span><a name="line-418"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>    </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- | Same as 'alts1', but preserves the depth.</span><span>
</span><a name="line-422"></a><span class="hs-identifier">newtypeAlts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039262"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039263"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039262"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039264"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679039262"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039263"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679039264"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><a name="newtypeAlts"><a href="Test.SmallCheck.Series.html#newtypeAlts"><span class="hs-identifier">newtypeAlts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- Generic instances</span><span>
</span><a name="line-429"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- {{{</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-keyword">class</span><span> </span><a name="GSerial"><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier">GSerial</span></a></a><span> </span><a name="local-6989586621679035453"><a href="#local-6989586621679035453"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679035454"><a href="#local-6989586621679035454"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-433"></a><span>  </span><a name="gSeries"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035453"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035454"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679035455"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span class="hs-keyword">class</span><span> </span><a name="GCoSerial"><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier">GCoSerial</span></a></a><span> </span><a name="local-6989586621679035449"><a href="#local-6989586621679035449"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679035450"><a href="#local-6989586621679035450"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-435"></a><span>  </span><a name="gCoseries"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035449"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035451"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679035449"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035450"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679035452"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679035451"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039258"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039258"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M1</span><span> </span><a href="#local-6989586621679039260"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679039261"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-438"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span>
</span><a name="line-439"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-440"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039254"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M1</span><span> </span><a href="#local-6989586621679039255"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679039254"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-441"></a><span>  </span><a name="local-8214565720323809163"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><a name="local-6989586621679039257"><a href="#local-6989586621679039257"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unM1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><a href="#local-6989586621679039257"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-442"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gCoseries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039250"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039251"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039250"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">K1</span><span> </span><a href="#local-6989586621679039252"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679039251"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-445"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">K1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-446"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-447"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039246"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039247"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039246"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">K1</span><span> </span><a href="#local-6989586621679039248"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679039247"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-448"></a><span>  </span><a name="local-8214565720323809163"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><a name="local-6989586621679039249"><a href="#local-6989586621679039249"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unK1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679039249"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-449"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gCoseries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039245"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-452"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">U1</span><span>
</span><a name="line-453"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-454"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039243"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-455"></a><span>  </span><a name="local-8214565720323809163"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><a name="local-6989586621679039244"><a href="#local-6989586621679039244"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039244"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-456"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gCoseries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039240"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039240"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039241"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039240"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039242"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039240"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-operator hs-type">:*:</span><span> </span><a href="#local-6989586621679039242"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-459"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">:*:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span>
</span><a name="line-460"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-461"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039232"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039232"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039233"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039232"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039234"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039232"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-operator hs-type">:*:</span><span> </span><a href="#local-6989586621679039234"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-462"></a><span>  </span><a name="local-8214565720323809163"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><a name="local-6989586621679039235"><a href="#local-6989586621679039235"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039236"><span class="hs-identifier hs-var">uncur</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><a href="#local-6989586621679039235"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-464"></a><span>        </span><a name="local-6989586621679039236"><a href="#local-6989586621679039236"><span class="hs-identifier">uncur</span></a></a><span> </span><a name="local-6989586621679039237"><a href="#local-6989586621679039237"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679039238"><a href="#local-6989586621679039238"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator hs-var">:*:</span><span> </span><a name="local-6989586621679039239"><a href="#local-6989586621679039239"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039237"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039238"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679039239"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gCoseries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039229"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039229"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039230"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039229"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039231"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039229"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-operator hs-type">:+:</span><span> </span><a href="#local-6989586621679039231"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-468"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">interleave</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">R1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-470"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039220"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039220"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039221"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039220"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039222"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GCoSerial"><span class="hs-identifier hs-type">GCoSerial</span></a><span> </span><a href="#local-6989586621679039220"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-operator hs-type">:+:</span><span> </span><a href="#local-6989586621679039222"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-471"></a><span>  </span><a name="local-8214565720323809163"><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier">gCoseries</span></a></a><span> </span><a name="local-6989586621679039223"><a href="#local-6989586621679039223"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-472"></a><span>    </span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><a href="#local-6989586621679039223"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679039224"><a href="#local-6989586621679039224"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-473"></a><span>    </span><a href="Test.SmallCheck.Series.html#gCoseries"><span class="hs-identifier hs-var">gCoseries</span></a><span> </span><a href="#local-6989586621679039223"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679039225"><a href="#local-6989586621679039225"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-474"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-475"></a><span>    </span><span class="hs-glyph">\</span><a name="local-6989586621679039226"><a href="#local-6989586621679039226"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679039226"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-476"></a><span>      </span><span class="hs-identifier hs-var">L1</span><span> </span><a name="local-6989586621679039227"><a href="#local-6989586621679039227"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039224"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039227"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-477"></a><span>      </span><span class="hs-identifier hs-var">R1</span><span> </span><a name="local-6989586621679039228"><a href="#local-6989586621679039228"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039225"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679039228"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-478"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gCoseries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039217"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039218"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#GSerial"><span class="hs-identifier hs-type">GSerial</span></a><span> </span><a href="#local-6989586621679039217"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">C1</span><span> </span><a href="#local-6989586621679039219"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679039218"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-481"></a><span>  </span><a name="local-8214565720323809165"><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier">gSeries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#decDepth"><span class="hs-identifier hs-var">decDepth</span></a><span> </span><a href="Test.SmallCheck.Series.html#gSeries"><span class="hs-identifier hs-var">gSeries</span></a><span>
</span><a name="line-482"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">gSeries</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-483"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- Instances for basic types</span><span>
</span><a name="line-487"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-488"></a><span class="hs-comment">-- {{{</span><span>
</span><a name="line-489"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039216"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039216"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-490"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-491"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039214"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039214"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-492"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679039215"><a href="#local-6989586621679039215"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#constM"><span class="hs-identifier hs-var">constM</span></a><span> </span><a href="#local-6989586621679039215"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039213"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039213"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-495"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039212"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039212"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-496"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039211"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039211"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Natural</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-497"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039105"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039105"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Natural</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-498"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039104"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039104"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-499"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039103"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039103"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-500"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039102"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039102"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-501"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039101"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039101"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-502"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039100"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039100"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int8</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-503"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039099"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039099"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int8</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-504"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039098"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039098"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-505"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039097"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039097"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039096"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039096"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int16</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-507"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039095"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039095"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int16</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-508"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039094"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039094"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word16</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-509"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039093"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039093"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word16</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-510"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039092"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039092"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int32</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-511"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039091"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039091"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int32</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-512"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039090"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039090"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-513"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039089"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679039089"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-514"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679039088"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679039088"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int64</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unM</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-515"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679038237"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679038237"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int64</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-516"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679038236"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679038236"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unN</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-517"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037484"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037484"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Word64</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span class="hs-comment">-- | 'N' is a wrapper for 'Integral' types that causes only non-negative values</span><span>
</span><a name="line-520"></a><span class="hs-comment">-- to be generated. Generated functions of type @N a -&gt; b@ do not distinguish</span><span>
</span><a name="line-521"></a><span class="hs-comment">-- different negative values of @a@.</span><span>
</span><a name="line-522"></a><span class="hs-keyword">newtype</span><span> </span><a name="N"><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier">N</span></a></a><span> </span><a name="local-6989586621679035448"><a href="#local-6989586621679035448"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="N"><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier">N</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unN"><a href="Test.SmallCheck.Series.html#unN"><span class="hs-identifier">unN</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679035448"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679037481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679037481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037482"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037482"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-type">N</span></a><span> </span><a href="#local-6989586621679037481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-525"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier hs-var">generate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037483"><a href="#local-6989586621679037483"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037483"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679037475"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037476"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037476"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-type">N</span></a><span> </span><a href="#local-6989586621679037475"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-528"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037477"><a href="#local-6989586621679037477"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-529"></a><span>    </span><span class="hs-comment">-- This is a recursive function, because @alts1 rs@ typically calls</span><span>
</span><a name="line-530"></a><span>    </span><span class="hs-comment">-- back to 'coseries' (but with lower depth).</span><span>
</span><a name="line-531"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-532"></a><span>    </span><span class="hs-comment">-- The recursion stops when depth == 0. Then alts1 produces a constant</span><span>
</span><a name="line-533"></a><span>    </span><span class="hs-comment">-- function, and doesn't call back to 'coseries'.</span><span>
</span><a name="line-534"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier hs-var">alts0</span></a><span> </span><a href="#local-6989586621679037477"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037478"><a href="#local-6989586621679037478"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-535"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037477"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037479"><a href="#local-6989586621679037479"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><a name="local-6989586621679037480"><a href="#local-6989586621679037480"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-537"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679037480"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-538"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679037479"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679037480"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679037478"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">-- | 'M' is a helper type to generate values of a signed type of increasing magnitude.</span><span>
</span><a name="line-542"></a><span class="hs-keyword">newtype</span><span> </span><a name="M"><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier">M</span></a></a><span> </span><a name="local-6989586621679035447"><a href="#local-6989586621679035447"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="M"><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier">M</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unM"><a href="Test.SmallCheck.Series.html#unM"><span class="hs-identifier">unM</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679035447"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679037469"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679037469"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037470"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037470"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="#local-6989586621679037469"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-545"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679037472"><span class="hs-identifier hs-var">others</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">interleave</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679037471"><span class="hs-identifier hs-var">positives</span></a><span>
</span><a name="line-546"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679037471"><a href="#local-6989586621679037471"><span class="hs-identifier">positives</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier hs-var">generate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037473"><a href="#local-6989586621679037473"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679037473"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-547"></a><span>          </span><a name="local-6989586621679037472"><a href="#local-6989586621679037472"><span class="hs-identifier">others</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier hs-var">generate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037474"><a href="#local-6989586621679037474"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037474"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679037462"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679037462"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037463"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037463"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="#local-6989586621679037462"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-550"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037464"><a href="#local-6989586621679037464"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-551"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier hs-var">alts0</span></a><span> </span><a href="#local-6989586621679037464"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037465"><a href="#local-6989586621679037465"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-552"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037464"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037466"><a href="#local-6989586621679037466"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-553"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037464"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037467"><a href="#local-6989586621679037467"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-554"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679037468"><a href="#local-6989586621679037468"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679037468"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-555"></a><span>        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037466"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037468"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-556"></a><span>        </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037467"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679037468"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>        </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037465"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037459"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037459"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-560"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-561"></a><span>    </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679037460"><a href="#local-6989586621679037460"><span class="hs-identifier">sig</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679037461"><a href="#local-6989586621679037461"><span class="hs-identifier">exp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-562"></a><span>    </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">odd</span><span> </span><a href="#local-6989586621679037460"><span class="hs-identifier hs-var">sig</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679037460"><span class="hs-identifier hs-var">sig</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679037461"><span class="hs-identifier hs-var">exp</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span>
</span><a name="line-563"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">encodeFloat</span><span> </span><a href="#local-6989586621679037460"><span class="hs-identifier hs-var">sig</span></a><span> </span><a href="#local-6989586621679037461"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037456"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-565"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037457"><a href="#local-6989586621679037457"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-566"></a><span>    </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679037457"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037458"><a href="#local-6989586621679037458"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-567"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679037458"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">decodeFloat</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037455"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037455"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-570"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-571"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037453"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037453"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-572"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037454"><a href="#local-6989586621679037454"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-573"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679037454"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679037448"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037449"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037448"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037449"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ratio</span><span> </span><a href="#local-6989586621679037448"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-576"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679037450"><span class="hs-identifier hs-var">pairToRatio</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-577"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-578"></a><span>      </span><a name="local-6989586621679037450"><a href="#local-6989586621679037450"><span class="hs-identifier">pairToRatio</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679037451"><a href="#local-6989586621679037451"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679037452"><a href="#local-6989586621679037452"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679037451"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">%</span><span> </span><a href="#local-6989586621679037452"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-579"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679037443"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037444"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037443"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037444"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ratio</span><span> </span><a href="#local-6989586621679037443"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-580"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037445"><a href="#local-6989586621679037445"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679037446"><span class="hs-identifier hs-var">ratioToPair</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679037445"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-581"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-582"></a><span>      </span><a name="local-6989586621679037446"><a href="#local-6989586621679037446"><span class="hs-identifier">ratioToPair</span></a></a><span> </span><a name="local-6989586621679037447"><a href="#local-6989586621679037447"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">numerator</span><span> </span><a href="#local-6989586621679037447"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><a href="#local-6989586621679037447"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037441"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037441"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-585"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#generate"><span class="hs-identifier hs-var">generate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037442"><a href="#local-6989586621679037442"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037442"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span>
</span><a name="line-586"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037437"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037437"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-587"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037438"><a href="#local-6989586621679037438"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-588"></a><span>    </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="#local-6989586621679037438"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037439"><a href="#local-6989586621679037439"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-589"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037440"><a href="#local-6989586621679037440"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037439"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679037440"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-char">'a'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037434"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037435"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037434"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037436"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037434"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037435"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037436"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-592"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons2"><span class="hs-identifier hs-var">cons2</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-593"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037415"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037416"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037415"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037417"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037415"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037416"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037417"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-594"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037418"><a href="#local-6989586621679037418"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#alts2"><span class="hs-identifier hs-var">alts2</span></a><span> </span><a href="#local-6989586621679037418"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037411"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037412"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037411"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037413"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037411"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037414"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037411"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037412"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037413"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679037414"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-597"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons3"><span class="hs-identifier hs-var">cons3</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037406"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037407"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037406"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037408"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037406"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037409"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037406"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037407"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037408"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679037409"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-599"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037410"><a href="#local-6989586621679037410"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#uncurry3"><span class="hs-identifier hs-var">uncurry3</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#alts3"><span class="hs-identifier hs-var">alts3</span></a><span> </span><a href="#local-6989586621679037410"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037402"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037403"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037404"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037401"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037405"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037401"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037402"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037403"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679037404"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679037405"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-602"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons4"><span class="hs-identifier hs-var">cons4</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037395"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037396"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037395"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037397"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037395"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037398"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037395"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037399"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037395"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037396"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679037397"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679037398"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679037399"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-604"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037400"><a href="#local-6989586621679037400"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#uncurry4"><span class="hs-identifier hs-var">uncurry4</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#alts4"><span class="hs-identifier hs-var">alts4</span></a><span> </span><a href="#local-6989586621679037400"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037394"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037394"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-607"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier hs-var">cons0</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier hs-var">cons0</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-608"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679037389"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037389"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-609"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037390"><a href="#local-6989586621679037390"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-610"></a><span>    </span><a href="#local-6989586621679037390"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037391"><a href="#local-6989586621679037391"><span class="hs-identifier">r1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-611"></a><span>    </span><a href="#local-6989586621679037390"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037392"><a href="#local-6989586621679037392"><span class="hs-identifier">r2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-612"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037393"><a href="#local-6989586621679037393"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679037393"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679037391"><span class="hs-identifier hs-var">r1</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679037392"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037387"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037388"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037387"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679037388"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-615"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier hs-var">cons0</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Test.SmallCheck.Series.html#cons1"><span class="hs-identifier hs-var">cons1</span></a><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-616"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037359"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037359"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679037360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-617"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037361"><a href="#local-6989586621679037361"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-618"></a><span>    </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier hs-var">alts0</span></a><span> </span><a href="#local-6989586621679037361"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037361"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037356"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037357"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037356"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037358"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037356"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679037357"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679037358"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-621"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons1"><span class="hs-identifier hs-var">cons1</span></a><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Test.SmallCheck.Series.html#cons1"><span class="hs-identifier hs-var">cons1</span></a><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-622"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037210"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037211"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037210"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037212"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037210"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679037211"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679037212"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-623"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037355"><a href="#local-6989586621679037355"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-624"></a><span>    </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037355"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="Test.SmallCheck.Series.html#%3C~%3E"><span class="hs-operator hs-var">&lt;~&gt;</span></a><span> </span><a href="Test.SmallCheck.Series.html#alts1"><span class="hs-identifier hs-var">alts1</span></a><span> </span><a href="#local-6989586621679037355"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-625"></a><span>
</span><a name="line-626"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037208"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037209"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037208"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679037209"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-627"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#cons0"><span class="hs-identifier hs-var">cons0</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="Test.SmallCheck.Series.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Test.SmallCheck.Series.html#cons2"><span class="hs-identifier hs-var">cons2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-628"></a><span class="hs-keyword">instance</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037201"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037200"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679037201"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-629"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037202"><a href="#local-6989586621679037202"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-630"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts0"><span class="hs-identifier hs-var">alts0</span></a><span> </span><a href="#local-6989586621679037202"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037203"><a href="#local-6989586621679037203"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-631"></a><span>    </span><a href="Test.SmallCheck.Series.html#alts2"><span class="hs-identifier hs-var">alts2</span></a><span> </span><a href="#local-6989586621679037202"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;-</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037204"><a href="#local-6989586621679037204"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-632"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037205"><a href="#local-6989586621679037205"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679037205"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037203"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679037206"><a href="#local-6989586621679037206"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679037207"><a href="#local-6989586621679037207"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037204"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679037206"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679037207"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-633"></a><span>
</span><a name="line-634"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037197"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037198"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037197"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037199"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037197"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037198"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679037199"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-635"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- Thanks to Ralf Hinze for the definition of coseries</span><span>
</span><a name="line-637"></a><span class="hs-comment">-- using the nest auxiliary.</span><span>
</span><a name="line-638"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037178"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037178"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037178"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037180"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037178"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037180"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037178"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679037179"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679037180"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-639"></a><span>  </span><a name="local-8214565720323809167"><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier">coseries</span></a></a><span> </span><a name="local-6989586621679037181"><a href="#local-6989586621679037181"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-640"></a><span>    </span><a name="local-6989586621679037194"><a href="#local-6989586621679037194"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#unwind"><span class="hs-identifier hs-var">unwind</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span>    </span><a name="local-6989586621679037195"><a href="#local-6989586621679037195"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679037182"><span class="hs-identifier hs-var">nest</span></a><span> </span><a href="#local-6989586621679037181"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679037194"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-643"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679037196"><a href="#local-6989586621679037196"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037195"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679037196"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679037194"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-644"></a><span>
</span><a name="line-645"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span>    </span><span class="hs-identifier">nest</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679037183"><a href="#local-6989586621679037183"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679037184"><a href="#local-6989586621679037184"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679037185"><a href="#local-6989586621679037185"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679037186"><a href="#local-6989586621679037186"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679037185"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037184"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#CoSerial"><span class="hs-identifier hs-type">CoSerial</span></a><span> </span><a href="#local-6989586621679037185"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037184"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679037185"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679037186"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679037183"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a><span> </span><a href="#local-6989586621679037185"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679037184"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037186"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>    </span><a name="local-6989586621679037182"><a href="#local-6989586621679037182"><span class="hs-identifier">nest</span></a></a><span> </span><a name="local-6989586621679037187"><a href="#local-6989586621679037187"><span class="hs-identifier">rs</span></a></a><span> </span><a name="local-6989586621679037188"><a href="#local-6989586621679037188"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-649"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679037188"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-650"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679037187"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-651"></a><span>        </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679037189"><a href="#local-6989586621679037189"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-652"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679037190"><a href="#local-6989586621679037190"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#coseries"><span class="hs-identifier hs-var">coseries</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679037182"><span class="hs-identifier hs-var">nest</span></a><span> </span><a href="#local-6989586621679037187"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="#local-6989586621679037189"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-653"></a><span>          </span><a name="local-6989586621679037191"><a href="#local-6989586621679037191"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679037190"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-654"></a><span>          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679037192"><a href="#local-6989586621679037192"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679037193"><a href="#local-6989586621679037193"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679037191"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679037192"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679037193"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span class="hs-comment">-- show the extension of a function (in part, bounded both by</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- the number and depth of arguments)</span><span>
</span><a name="line-658"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679035491"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035491"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035492"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035491"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679035492"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-659"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679035688"><a href="#local-6989586621679035688"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-660"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679035690"><span class="hs-identifier hs-var">maxarheight</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-661"></a><span>    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679035691"><span class="hs-identifier hs-var">sumarwidth</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679035689"><span class="hs-identifier hs-var">ars</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-string">&quot;-&gt;;&quot;</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679035694"><span class="hs-identifier hs-var">widthLimit</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-662"></a><span>      </span><span class="hs-string">&quot;{&quot;</span><span class="hs-operator hs-var">++</span><span class="hs-special">(</span><span>
</span><a name="line-663"></a><span>      </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">intersperse</span><span> </span><span class="hs-string">&quot;;&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679037174"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;-&gt;&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679037175"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037174"><a href="#local-6989586621679037174"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679037175"><a href="#local-6989586621679037175"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679035689"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">]</span><span>
</span><a name="line-664"></a><span>      </span><span class="hs-special">)</span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-665"></a><span>    </span><span class="hs-keyword">else</span><span>
</span><a name="line-666"></a><span>      </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679037176"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;-&gt;\n&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679035692"><span class="hs-identifier hs-var">indent</span></a><span> </span><a href="#local-6989586621679037177"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037176"><a href="#local-6989586621679037176"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679037177"><a href="#local-6989586621679037177"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679035689"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">]</span><span>
</span><a name="line-667"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-668"></a><span>    </span><a name="local-6989586621679035689"><a href="#local-6989586621679035689"><span class="hs-identifier">ars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679035695"><span class="hs-identifier hs-var">lengthLimit</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679035886"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035688"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679035886"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679035886"><a href="#local-6989586621679035886"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Test.SmallCheck.Series.html#list"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679035696"><span class="hs-identifier hs-var">depthLimit</span></a><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-670"></a><span>    </span><a name="local-6989586621679035690"><a href="#local-6989586621679035690"><span class="hs-identifier">maxarheight</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximum</span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035693"><span class="hs-identifier hs-var">height</span></a><span> </span><a href="#local-6989586621679037014"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035693"><span class="hs-identifier hs-var">height</span></a><span> </span><a href="#local-6989586621679037015"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037014"><a href="#local-6989586621679037014"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679037015"><a href="#local-6989586621679037015"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679035689"><span class="hs-identifier hs-var">ars</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span>    </span><a name="local-6989586621679035691"><a href="#local-6989586621679035691"><span class="hs-identifier">sumarwidth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span>       </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679037016"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679037017"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-673"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679037016"><a href="#local-6989586621679037016"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679037017"><a href="#local-6989586621679037017"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679035689"><span class="hs-identifier hs-var">ars</span></a><span class="hs-special">]</span><span>
</span><a name="line-674"></a><span>    </span><a name="local-6989586621679035692"><a href="#local-6989586621679035692"><span class="hs-identifier">indent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;  &quot;</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lines</span><span>
</span><a name="line-675"></a><span>    </span><a name="local-6989586621679035693"><a href="#local-6989586621679035693"><span class="hs-identifier">height</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lines</span><span>
</span><a name="line-676"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679035694"><a href="#local-6989586621679035694"><span class="hs-identifier">widthLimit</span></a></a><span class="hs-special">,</span><a name="local-6989586621679035695"><a href="#local-6989586621679035695"><span class="hs-identifier">lengthLimit</span></a></a><span class="hs-special">,</span><a name="local-6989586621679035696"><a href="#local-6989586621679035696"><span class="hs-identifier">depthLimit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">80</span><span class="hs-special">,</span><span class="hs-number">20</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-681"></a><span class="hs-comment">-- Convenient wrappers</span><span>
</span><a name="line-682"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-683"></a><span class="hs-comment">-- {{{</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><a name="line-686"></a><span class="hs-comment">-- | @Positive x@: guarantees that @x \&gt; 0@.</span><span>
</span><a name="line-687"></a><span class="hs-keyword">newtype</span><span> </span><a name="Positive"><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier">Positive</span></a></a><span> </span><a name="local-6989586621679035446"><a href="#local-6989586621679035446"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Positive"><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier">Positive</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="getPositive"><a href="Test.SmallCheck.Series.html#getPositive"><span class="hs-identifier">getPositive</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679035446"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-688"></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679035489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679035489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035490"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035490"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><a href="#local-6989586621679035489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-691"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span> </span><span class="hs-special">`</span><a href="Test.SmallCheck.Series.html#suchThat"><span class="hs-identifier hs-var">suchThat</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>
</span><a name="line-693"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035486"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><a href="#local-6989586621679035486"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-694"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679035487"><a href="#local-6989586621679035487"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679035488"><a href="#local-6989586621679035488"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679035487"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679035488"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-comment">-- | @NonNegative x@: guarantees that @x \&gt;= 0@.</span><span>
</span><a name="line-697"></a><span class="hs-keyword">newtype</span><span> </span><a name="NonNegative"><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier">NonNegative</span></a></a><span> </span><a name="local-6989586621679034293"><a href="#local-6989586621679034293"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NonNegative"><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier">NonNegative</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="getNonNegative"><a href="Test.SmallCheck.Series.html#getNonNegative"><span class="hs-identifier">getNonNegative</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679034293"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-698"></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>
</span><a name="line-700"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679035484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679035484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035485"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035485"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier hs-type">NonNegative</span></a><span> </span><a href="#local-6989586621679035484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-701"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier hs-var">NonNegative</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a><span> </span><span class="hs-special">`</span><a href="Test.SmallCheck.Series.html#suchThat"><span class="hs-identifier hs-var">suchThat</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035481"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier hs-type">NonNegative</span></a><span> </span><a href="#local-6989586621679035481"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-704"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679035482"><a href="#local-6989586621679035482"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonNegative"><span class="hs-identifier hs-var">NonNegative</span></a><span> </span><a name="local-6989586621679035483"><a href="#local-6989586621679035483"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679035482"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679035483"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-comment">-- | @NonEmpty xs@: guarantees that @xs@ is not null</span><span>
</span><a name="line-707"></a><span class="hs-keyword">newtype</span><span> </span><a name="NonEmpty"><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier">NonEmpty</span></a></a><span> </span><a name="local-6989586621679034292"><a href="#local-6989586621679034292"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NonEmpty"><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier">NonEmpty</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="getNonEmpty"><a href="Test.SmallCheck.Series.html#getNonEmpty"><span class="hs-identifier">getNonEmpty</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034292"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035465"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679035466"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a><span> </span><a href="#local-6989586621679035465"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span> </span><a href="#local-6989586621679035466"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-710"></a><span>  </span><a name="local-8214565720323809169"><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier">series</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier hs-var">NonEmpty</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Test.SmallCheck.Series.html#cons2"><span class="hs-identifier hs-var">cons2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span>
</span><a name="line-712"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679035462"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span> </span><a href="#local-6989586621679035462"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-713"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679035463"><a href="#local-6989586621679035463"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Test.SmallCheck.Series.html#NonEmpty"><span class="hs-identifier hs-var">NonEmpty</span></a><span> </span><a name="local-6989586621679035464"><a href="#local-6989586621679035464"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679035463"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679035464"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-714"></a><span>
</span><a name="line-715"></a><span class="hs-comment">-- }}}</span><span>
</span><a name="line-716"></a></pre></body></html>