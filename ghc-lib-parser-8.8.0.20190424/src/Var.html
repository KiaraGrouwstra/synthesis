<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

\section{@Vars@: Variables}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleContexts, MultiWayIf, FlexibleInstances, DeriveDataTypeable #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- #name_types#</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- GHC uses several kinds of name internally:</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- * 'OccName.OccName': see &quot;OccName#name_types&quot;</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- * 'RdrName.RdrName': see &quot;RdrName#name_types&quot;</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- * 'Name.Name': see &quot;Name#name_types&quot;</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- * 'Id.Id': see &quot;Id#name_types&quot;</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- * 'Var.Var' is a synonym for the 'Id.Id' type but it may additionally</span><span>
</span><a name="line-23"></a><span class="hs-comment">--   potentially contain type variables, which have a 'TyCoRep.Kind'</span><span>
</span><a name="line-24"></a><span class="hs-comment">--   rather than a 'TyCoRep.Type' and only contain some extra</span><span>
</span><a name="line-25"></a><span class="hs-comment">--   details during typechecking.</span><span>
</span><a name="line-26"></a><span class="hs-comment">--</span><span>
</span><a name="line-27"></a><span class="hs-comment">--   These 'Var.Var' names may either be global or local, see &quot;Var#globalvslocal&quot;</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- #globalvslocal#</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- Global 'Id's and 'Var's are those that are imported or correspond</span><span>
</span><a name="line-31"></a><span class="hs-comment">--    to a data constructor, primitive operation, or record selectors.</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- Local 'Id's and 'Var's are those bound within an expression</span><span>
</span><a name="line-33"></a><span class="hs-comment">--    (e.g. by a lambda) or at the top level of the module being compiled.</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Var</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-36"></a><span>        </span><span class="hs-comment">-- * The main data type and synonyms</span><span>
</span><a name="line-37"></a><span>        </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#NcId"><span class="hs-identifier hs-type">NcId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#DictId"><span class="hs-identifier hs-type">DictId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#DFunId"><span class="hs-identifier hs-type">DFunId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#EqVar"><span class="hs-identifier hs-type">EqVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#IpId"><span class="hs-identifier hs-type">IpId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#JoinId"><span class="hs-identifier hs-type">JoinId</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TKVar"><span class="hs-identifier hs-type">TKVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>        </span><span class="hs-comment">-- * In and Out variants</span><span>
</span><a name="line-41"></a><span>        </span><a href="Var.html#InVar"><span class="hs-identifier hs-type">InVar</span></a><span class="hs-special">,</span><span>  </span><a href="Var.html#InCoVar"><span class="hs-identifier hs-type">InCoVar</span></a><span class="hs-special">,</span><span>  </span><a href="Var.html#InId"><span class="hs-identifier hs-type">InId</span></a><span class="hs-special">,</span><span>  </span><a href="Var.html#InTyVar"><span class="hs-identifier hs-type">InTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="Var.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#OutCoVar"><span class="hs-identifier hs-type">OutCoVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#OutId"><span class="hs-identifier hs-type">OutId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#OutTyVar"><span class="hs-identifier hs-type">OutTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span>        </span><span class="hs-comment">-- ** Taking 'Var's apart</span><span>
</span><a name="line-45"></a><span>        </span><a href="Var.html#varName"><span class="hs-identifier hs-var">varName</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#varUnique"><span class="hs-identifier hs-var">varUnique</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#varType"><span class="hs-identifier hs-var">varType</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>        </span><span class="hs-comment">-- ** Modifying 'Var's</span><span>
</span><a name="line-48"></a><span>        </span><a href="Var.html#setVarName"><span class="hs-identifier hs-var">setVarName</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setVarUnique"><span class="hs-identifier hs-var">setVarUnique</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#updateVarType"><span class="hs-identifier hs-var">updateVarType</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="Var.html#updateVarTypeM"><span class="hs-identifier hs-var">updateVarTypeM</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>        </span><span class="hs-comment">-- ** Constructing, taking apart, modifying 'Id's</span><span>
</span><a name="line-52"></a><span>        </span><a href="Var.html#mkGlobalVar"><span class="hs-identifier hs-var">mkGlobalVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkLocalVar"><span class="hs-identifier hs-var">mkLocalVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkExportedLocalVar"><span class="hs-identifier hs-var">mkExportedLocalVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkCoVar"><span class="hs-identifier hs-var">mkCoVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>        </span><a href="Var.html#idInfo"><span class="hs-identifier hs-var">idInfo</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#idDetails"><span class="hs-identifier hs-var">idDetails</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>        </span><a href="Var.html#lazySetIdInfo"><span class="hs-identifier hs-var">lazySetIdInfo</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setIdDetails"><span class="hs-identifier hs-var">setIdDetails</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#globaliseId"><span class="hs-identifier hs-var">globaliseId</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>        </span><a href="Var.html#setIdExported"><span class="hs-identifier hs-var">setIdExported</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setIdNotExported"><span class="hs-identifier hs-var">setIdNotExported</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>        </span><span class="hs-comment">-- ** Predicates</span><span>
</span><a name="line-58"></a><span>        </span><a href="Var.html#isId"><span class="hs-identifier hs-var">isId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isTcTyVar"><span class="hs-identifier hs-var">isTcTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="Var.html#isLocalVar"><span class="hs-identifier hs-var">isLocalVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isLocalId"><span class="hs-identifier hs-var">isLocalId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isNonCoVarId"><span class="hs-identifier hs-var">isNonCoVarId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="Var.html#isGlobalId"><span class="hs-identifier hs-var">isGlobalId</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isExportedId"><span class="hs-identifier hs-var">isExportedId</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="Var.html#mustHaveLocalBinding"><span class="hs-identifier hs-var">mustHaveLocalBinding</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>        </span><span class="hs-comment">-- * TyVar's</span><span>
</span><a name="line-64"></a><span>        </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Var.html#TyCoVarBinder"><span class="hs-identifier hs-type">TyCoVarBinder</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>        </span><a href="Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderArgFlag"><span class="hs-identifier hs-var">binderArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>        </span><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier hs-var">isVisibleArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#sameVis"><span class="hs-identifier hs-var">sameVis</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>        </span><a href="Var.html#mkTyCoVarBinder"><span class="hs-identifier hs-var">mkTyCoVarBinder</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkTyCoVarBinders"><span class="hs-identifier hs-var">mkTyCoVarBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>        </span><a href="Var.html#mkTyVarBinder"><span class="hs-identifier hs-var">mkTyVarBinder</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkTyVarBinders"><span class="hs-identifier hs-var">mkTyVarBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="Var.html#isTyVarBinder"><span class="hs-identifier hs-var">isTyVarBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>        </span><span class="hs-comment">-- ** Constructing TyVar's</span><span>
</span><a name="line-72"></a><span>        </span><a href="Var.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkTcTyVar"><span class="hs-identifier hs-var">mkTcTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>        </span><span class="hs-comment">-- ** Taking 'TyVar's apart</span><span>
</span><a name="line-75"></a><span>        </span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#tcTyVarDetails"><span class="hs-identifier hs-var">tcTyVarDetails</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setTcTyVarDetails"><span class="hs-identifier hs-var">setTcTyVarDetails</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>        </span><span class="hs-comment">-- ** Modifying 'TyVar's</span><span>
</span><a name="line-78"></a><span>        </span><a href="Var.html#setTyVarName"><span class="hs-identifier hs-var">setTyVarName</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setTyVarUnique"><span class="hs-identifier hs-var">setTyVarUnique</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#updateTyVarKind"><span class="hs-identifier hs-var">updateTyVarKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>        </span><a href="Var.html#updateTyVarKindM"><span class="hs-identifier hs-var">updateTyVarKindM</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>        </span><a href="Var.html#nonDetCmpVar"><span class="hs-identifier hs-var">nonDetCmpVar</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span>   </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span>   </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span class="hs-special">(</span><span> </span><a href="TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#vanillaSkolemTv"><span class="hs-identifier hs-var">vanillaSkolemTv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span>   </span><a href="IdInfo.html"><span class="hs-identifier">IdInfo</span></a><span class="hs-special">(</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span class="hs-special">,</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span class="hs-special">,</span><span> </span><a href="IdInfo.html#coVarDetails"><span class="hs-identifier hs-var">coVarDetails</span></a><span class="hs-special">,</span><span> </span><a href="IdInfo.html#isCoVarDetails"><span class="hs-identifier hs-var">isCoVarDetails</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>                                </span><a href="IdInfo.html#vanillaIdInfo"><span class="hs-identifier hs-var">vanillaIdInfo</span></a><span class="hs-special">,</span><span> </span><a href="IdInfo.html#pprIdDetails"><span class="hs-identifier hs-var">pprIdDetails</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span>
</span><a name="line-96"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-var">mkUniqueGrimily</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                     Synonyms
*                                                                      *
************************************************************************
-- These synonyms are here and not in Id because otherwise we need a very
-- large number of SOURCE imports of Id.hs :-(
-}</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Identifier</span><span>
</span><a name="line-115"></a><span class="hs-keyword">type</span><span> </span><a name="Id"><a href="Var.html#Id"><span class="hs-identifier">Id</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>       </span><span class="hs-comment">-- A term-level identifier</span><span>
</span><a name="line-116"></a><span>                       </span><span class="hs-comment">--  predicate: isId</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | Coercion Variable</span><span>
</span><a name="line-119"></a><span class="hs-keyword">type</span><span> </span><a name="CoVar"><a href="Var.html#CoVar"><span class="hs-identifier">CoVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>        </span><span class="hs-comment">-- See Note [Evidence: EvIds and CoVars]</span><span>
</span><a name="line-120"></a><span>                       </span><span class="hs-comment">--   predicate: isCoVar</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-123"></a><span class="hs-keyword">type</span><span> </span><a name="NcId"><a href="Var.html#NcId"><span class="hs-identifier">NcId</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>        </span><span class="hs-comment">-- A term-level (value) variable that is</span><span>
</span><a name="line-124"></a><span>                       </span><span class="hs-comment">-- /not/ an (unlifted) coercion</span><span>
</span><a name="line-125"></a><span>                       </span><span class="hs-comment">--    predicate: isNonCoVarId</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | Type or kind Variable</span><span>
</span><a name="line-128"></a><span class="hs-keyword">type</span><span> </span><a name="TyVar"><a href="Var.html#TyVar"><span class="hs-identifier">TyVar</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- Type *or* kind variable (historical)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | Type or Kind Variable</span><span>
</span><a name="line-131"></a><span class="hs-keyword">type</span><span> </span><a name="TKVar"><a href="Var.html#TKVar"><span class="hs-identifier">TKVar</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- Type *or* kind variable (historical)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Type variable that might be a metavariable</span><span>
</span><a name="line-134"></a><span class="hs-keyword">type</span><span> </span><a name="TcTyVar"><a href="Var.html#TcTyVar"><span class="hs-identifier">TcTyVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Type Variable</span><span>
</span><a name="line-137"></a><span class="hs-keyword">type</span><span> </span><a name="TypeVar"><a href="Var.html#TypeVar"><span class="hs-identifier">TypeVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- Definitely a type variable</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Kind Variable</span><span>
</span><a name="line-140"></a><span class="hs-keyword">type</span><span> </span><a name="KindVar"><a href="Var.html#KindVar"><span class="hs-identifier">KindVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>     </span><span class="hs-comment">-- Definitely a kind variable</span><span>
</span><a name="line-141"></a><span>                       </span><span class="hs-comment">-- See Note [Kind and type variables]</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- See Note [Evidence: EvIds and CoVars]</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- | Evidence Identifier</span><span>
</span><a name="line-145"></a><span class="hs-keyword">type</span><span> </span><a name="EvId"><a href="Var.html#EvId"><span class="hs-identifier">EvId</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>        </span><span class="hs-comment">-- Term-level evidence: DictId, IpId, or EqVar</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-comment">-- | Evidence Variable</span><span>
</span><a name="line-148"></a><span class="hs-keyword">type</span><span> </span><a name="EvVar"><a href="Var.html#EvVar"><span class="hs-identifier">EvVar</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span>      </span><span class="hs-comment">-- ...historical name for EvId</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Dictionary Function Identifier</span><span>
</span><a name="line-151"></a><span class="hs-keyword">type</span><span> </span><a name="DFunId"><a href="Var.html#DFunId"><span class="hs-identifier">DFunId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>        </span><span class="hs-comment">-- A dictionary function</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Dictionary Identifier</span><span>
</span><a name="line-154"></a><span class="hs-keyword">type</span><span> </span><a name="DictId"><a href="Var.html#DictId"><span class="hs-identifier">DictId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span>      </span><span class="hs-comment">-- A dictionary variable</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Implicit parameter Identifier</span><span>
</span><a name="line-157"></a><span class="hs-keyword">type</span><span> </span><a name="IpId"><a href="Var.html#IpId"><span class="hs-identifier">IpId</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span>      </span><span class="hs-comment">-- A term-level implicit parameter</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | Equality Variable</span><span>
</span><a name="line-160"></a><span class="hs-keyword">type</span><span> </span><a name="EqVar"><a href="Var.html#EqVar"><span class="hs-identifier">EqVar</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span>      </span><span class="hs-comment">-- Boxed equality evidence</span><span>
</span><a name="line-161"></a><span class="hs-keyword">type</span><span> </span><a name="JoinId"><a href="Var.html#JoinId"><span class="hs-identifier">JoinId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>        </span><span class="hs-comment">-- A join variable</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | Type or Coercion Variable</span><span>
</span><a name="line-164"></a><span class="hs-keyword">type</span><span> </span><a name="TyCoVar"><a href="Var.html#TyCoVar"><span class="hs-identifier">TyCoVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>       </span><span class="hs-comment">-- Type, *or* coercion variable</span><span>
</span><a name="line-165"></a><span>                        </span><span class="hs-comment">--   predicate: isTyCoVar</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">{- Many passes apply a substitution, and it's very handy to have type
   synonyms to remind us whether or not the substitution has been applied -}</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-keyword">type</span><span> </span><a name="InVar"><a href="Var.html#InVar"><span class="hs-identifier">InVar</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-172"></a><span class="hs-keyword">type</span><span> </span><a name="InTyVar"><a href="Var.html#InTyVar"><span class="hs-identifier">InTyVar</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-173"></a><span class="hs-keyword">type</span><span> </span><a name="InCoVar"><a href="Var.html#InCoVar"><span class="hs-identifier">InCoVar</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span>
</span><a name="line-174"></a><span class="hs-keyword">type</span><span> </span><a name="InId"><a href="Var.html#InId"><span class="hs-identifier">InId</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-175"></a><span class="hs-keyword">type</span><span> </span><a name="OutVar"><a href="Var.html#OutVar"><span class="hs-identifier">OutVar</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-176"></a><span class="hs-keyword">type</span><span> </span><a name="OutTyVar"><a href="Var.html#OutTyVar"><span class="hs-identifier">OutTyVar</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-177"></a><span class="hs-keyword">type</span><span> </span><a name="OutCoVar"><a href="Var.html#OutCoVar"><span class="hs-identifier">OutCoVar</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span>
</span><a name="line-178"></a><span class="hs-keyword">type</span><span> </span><a name="OutId"><a href="Var.html#OutId"><span class="hs-identifier">OutId</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">{- Note [Evidence: EvIds and CoVars]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* An EvId (evidence Id) is a term-level evidence variable
  (dictionary, implicit parameter, or equality). Could be boxed or unboxed.

* DictId, IpId, and EqVar are synonyms when we know what kind of
  evidence we are talking about.  For example, an EqVar has type (t1 ~ t2).

* A CoVar is always an un-lifted coercion, of type (t1 ~# t2) or (t1 ~R# t2)

Note [Kind and type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Before kind polymorphism, TyVar were used to mean type variables. Now
they are used to mean kind *or* type variables. KindVar is used when we
know for sure that it is a kind variable. In future, we might want to
go over the whole compiler code to use:
   - TKVar   to mean kind or type variables
   - TypeVar to mean         type variables only
   - KindVar to mean kind         variables


************************************************************************
*                                                                      *
\subsection{The main data type declarations}
*                                                                      *
************************************************************************


Every @Var@ has a @Unique@, to uniquify it and for fast comparison, a
@Type@, and an @IdInfo@ (non-essential info about it, e.g.,
strictness).  The essential info about different kinds of @Vars@ is
in its @VarDetails@.
-}</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- | Variable</span><span>
</span><a name="line-217"></a><span class="hs-comment">--</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- Essentially a typed 'Name', that may also contain some additional information</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- about the 'Var' and its use sites.</span><span>
</span><a name="line-220"></a><span class="hs-keyword">data</span><span> </span><a name="Var"><a href="Var.html#Var"><span class="hs-identifier">Var</span></a></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TyVar"><a href="Var.html#TyVar"><span class="hs-identifier">TyVar</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- Type and kind variables</span><span>
</span><a name="line-222"></a><span>             </span><span class="hs-comment">-- see Note [Kind and type variables]</span><span>
</span><a name="line-223"></a><span>        </span><a name="varName"><a href="Var.html#varName"><span class="hs-identifier">varName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-224"></a><span>        </span><a name="realUnique"><a href="Var.html#realUnique"><span class="hs-identifier">realUnique</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-225"></a><span>                                     </span><span class="hs-comment">-- ^ Key for fast comparison</span><span>
</span><a name="line-226"></a><span>                                     </span><span class="hs-comment">-- Identical to the Unique in the name,</span><span>
</span><a name="line-227"></a><span>                                     </span><span class="hs-comment">-- cached here for speed</span><span>
</span><a name="line-228"></a><span>        </span><a name="varType"><a href="Var.html#varType"><span class="hs-identifier">varType</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>           </span><span class="hs-comment">-- ^ The type or kind of the 'Var' in question</span><span>
</span><a name="line-229"></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TcTyVar"><a href="Var.html#TcTyVar"><span class="hs-identifier">TcTyVar</span></a></a><span> </span><span class="hs-special">{</span><span>                           </span><span class="hs-comment">-- Used only during type inference</span><span>
</span><a name="line-232"></a><span>                                        </span><span class="hs-comment">-- Used for kind variables during</span><span>
</span><a name="line-233"></a><span>                                        </span><span class="hs-comment">-- inference, as well</span><span>
</span><a name="line-234"></a><span>        </span><a name="varName"><a href="Var.html#varName"><span class="hs-identifier">varName</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-235"></a><span>        </span><a name="realUnique"><a href="Var.html#realUnique"><span class="hs-identifier">realUnique</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-236"></a><span>        </span><a name="varType"><a href="Var.html#varType"><span class="hs-identifier">varType</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-237"></a><span>        </span><a name="tc_tv_details"><a href="Var.html#tc_tv_details"><span class="hs-identifier">tc_tv_details</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a><span>
</span><a name="line-238"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Id"><a href="Var.html#Id"><span class="hs-identifier">Id</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-241"></a><span>        </span><a name="varName"><a href="Var.html#varName"><span class="hs-identifier">varName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-242"></a><span>        </span><a name="realUnique"><a href="Var.html#realUnique"><span class="hs-identifier">realUnique</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-243"></a><span>        </span><a name="varType"><a href="Var.html#varType"><span class="hs-identifier">varType</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>
</span><a name="line-244"></a><span>        </span><a name="idScope"><a href="Var.html#idScope"><span class="hs-identifier">idScope</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#IdScope"><span class="hs-identifier hs-type">IdScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-245"></a><span>        </span><a name="id_details"><a href="Var.html#id_details"><span class="hs-identifier">id_details</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- Stable, doesn't change</span><span>
</span><a name="line-246"></a><span>        </span><a name="id_info"><a href="Var.html#id_info"><span class="hs-identifier">id_info</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-special">}</span><span>          </span><span class="hs-comment">-- Unstable, updated by simplifier</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">-- | Identifier Scope</span><span>
</span><a name="line-249"></a><span class="hs-keyword">data</span><span> </span><a name="IdScope"><a href="Var.html#IdScope"><span class="hs-identifier">IdScope</span></a></a><span>    </span><span class="hs-comment">-- See Note [GlobalId/LocalId]</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="GlobalId"><a href="Var.html#GlobalId"><span class="hs-identifier">GlobalId</span></a></a><span>
</span><a name="line-251"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LocalId"><a href="Var.html#LocalId"><span class="hs-identifier">LocalId</span></a></a><span> </span><a href="Var.html#ExportFlag"><span class="hs-identifier hs-type">ExportFlag</span></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-keyword">data</span><span> </span><a name="ExportFlag"><a href="Var.html#ExportFlag"><span class="hs-identifier">ExportFlag</span></a></a><span>   </span><span class="hs-comment">-- See Note [ExportFlag on binders]</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NotExported"><a href="Var.html#NotExported"><span class="hs-identifier">NotExported</span></a></a><span>   </span><span class="hs-comment">-- ^ Not exported: may be discarded as dead code.</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Exported"><a href="Var.html#Exported"><span class="hs-identifier">Exported</span></a></a><span>      </span><span class="hs-comment">-- ^ Exported: kept alive</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-comment">{- Note [ExportFlag on binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
An ExportFlag of &quot;Exported&quot; on a top-level binder says &quot;keep this
binding alive; do not drop it as dead code&quot;.  This transitively
keeps alive all the other top-level bindings that this binding refers
to.  This property is persisted all the way down the pipeline, so that
the binding will be compiled all the way to object code, and its
symbols will appear in the linker symbol table.

However, note that this use of &quot;exported&quot; is quite different to the
export list on a Haskell module.  Setting the ExportFlag on an Id does
/not/ mean that if you import the module (in Haskell source code) you
will see this Id.  Of course, things that appear in the export list
of the source Haskell module do indeed have their ExportFlag set.
But many other things, such as dictionary functions, are kept alive
by having their ExportFlag set, even though they are not exported
in the source-code sense.

We should probably use a different term for ExportFlag, like
KeepAlive.

Note [GlobalId/LocalId]
~~~~~~~~~~~~~~~~~~~~~~~
A GlobalId is
  * always a constant (top-level)
  * imported, or data constructor, or primop, or record selector
  * has a Unique that is globally unique across the whole
    GHC invocation (a single invocation may compile multiple modules)
  * never treated as a candidate by the free-variable finder;
        it's a constant!

A LocalId is
  * bound within an expression (lambda, case, local let(rec))
  * or defined at top level in the module being compiled
  * always treated as a candidate by the free-variable finder

After CoreTidy, top-level LocalIds are turned into GlobalIds
-}</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-297"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621681624686"><a href="#local-6989586621681624686"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681624687"><a href="#local-6989586621681624687"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-298"></a><span>            </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681624688"><a href="#local-6989586621681624688"><span class="hs-identifier">ppr_style</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-299"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span>  </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681624688"><span class="hs-identifier hs-var">ppr_style</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressVarKinds"><span class="hs-identifier hs-var">Opt_SuppressVarKinds</span></a><span> </span><a href="#local-6989586621681624687"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621681624686"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Var.html#ppr_debug"><span class="hs-identifier hs-var">ppr_debug</span></a><span> </span><a href="#local-6989586621681624686"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621681624688"><span class="hs-identifier hs-var">ppr_style</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-301"></a><span>                          </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621681624686"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>               </span><span class="hs-glyph">|</span><span>  </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-303"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621681624686"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Var.html#ppr_debug"><span class="hs-identifier hs-var">ppr_debug</span></a><span> </span><a href="#local-6989586621681624686"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621681624688"><span class="hs-identifier hs-var">ppr_style</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">ppr_debug</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-306"></a><a name="ppr_debug"><a href="Var.html#ppr_debug"><span class="hs-identifier">ppr_debug</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681624698"><a href="#local-6989586621681624698"><span class="hs-identifier">sty</span></a></a><span>
</span><a name="line-307"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681624698"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;tv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span class="hs-identifier">ppr_debug</span><span> </span><span class="hs-special">(</span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-var">TcTyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">tc_tv_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624699"><a href="#local-6989586621681624699"><span class="hs-identifier">d</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681624700"><a href="#local-6989586621681624700"><span class="hs-identifier">sty</span></a></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#dumpStyle"><span class="hs-identifier hs-var">dumpStyle</span></a><span> </span><a href="#local-6989586621681624700"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681624700"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#pprTcTyVarDetails"><span class="hs-identifier hs-var">pprTcTyVarDetails</span></a><span> </span><a href="#local-6989586621681624699"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span class="hs-identifier">ppr_debug</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624701"><a href="#local-6989586621681624701"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624702"><a href="#local-6989586621681624702"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681624703"><a href="#local-6989586621681624703"><span class="hs-identifier">sty</span></a></a><span>
</span><a name="line-311"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681624703"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#ppr_id_scope"><span class="hs-identifier hs-var">ppr_id_scope</span></a><span> </span><a href="#local-6989586621681624701"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="IdInfo.html#pprIdDetails"><span class="hs-identifier hs-var">pprIdDetails</span></a><span> </span><a href="#local-6989586621681624702"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span class="hs-identifier">ppr_debug</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-identifier">ppr_id_scope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#IdScope"><span class="hs-identifier hs-type">IdScope</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-315"></a><a name="ppr_id_scope"><a href="Var.html#ppr_id_scope"><span class="hs-identifier">ppr_id_scope</span></a></a><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;gid&quot;</span><span>
</span><a name="line-316"></a><span class="hs-identifier">ppr_id_scope</span><span> </span><span class="hs-special">(</span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#Exported"><span class="hs-identifier hs-var">Exported</span></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lidx&quot;</span><span>
</span><a name="line-317"></a><span class="hs-identifier">ppr_id_scope</span><span> </span><span class="hs-special">(</span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#NotExported"><span class="hs-identifier hs-var">NotExported</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;lid&quot;</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-320"></a><span>  </span><a name="local-8214565720325933137"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varName</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-323"></a><span>  </span><a name="local-8214565720325051039"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#varUnique"><span class="hs-identifier hs-var">varUnique</span></a><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-326"></a><span>    </span><a name="local-6989586621681624684"><a href="#local-6989586621681624684"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621681624685"><a href="#local-6989586621681624685"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624684"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624685"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span>    </span><a name="local-6989586621681624674"><a href="#local-6989586621681624674"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790495"><span class="hs-operator">&lt;=</span></a><span> </span><a name="local-6989586621681624675"><a href="#local-6989586621681624675"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624674"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624675"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-330"></a><span>    </span><a name="local-6989586621681624676"><a href="#local-6989586621681624676"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790500"><span class="hs-operator">&lt;</span></a><span>  </span><a name="local-6989586621681624677"><a href="#local-6989586621681624677"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624676"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span>  </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624677"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-331"></a><span>    </span><a name="local-6989586621681624678"><a href="#local-6989586621681624678"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541096"><span class="hs-operator">&gt;=</span></a><span> </span><a name="local-6989586621681624679"><a href="#local-6989586621681624679"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624678"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624679"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-332"></a><span>    </span><a name="local-6989586621681624680"><a href="#local-6989586621681624680"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790501"><span class="hs-operator">&gt;</span></a><span>  </span><a name="local-6989586621681624681"><a href="#local-6989586621681624681"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624680"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span>  </span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624681"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-333"></a><span>    </span><a name="local-6989586621681624682"><a href="#local-6989586621681624682"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">`</span><a name="local-8214565720323790496"><span class="hs-identifier">compare</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621681624683"><a href="#local-6989586621681624683"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624682"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Var.html#nonDetCmpVar"><span class="hs-identifier hs-var">nonDetCmpVar</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681624683"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | Compare Vars by their Uniques.</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- This is what Ord Var does, provided here to make it explicit at the</span><span>
</span><a name="line-337"></a><span class="hs-comment">-- call-site that it can introduce non-determinism.</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- See Note [Unique Determinism]</span><span>
</span><a name="line-339"></a><span class="hs-identifier">nonDetCmpVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-340"></a><a name="nonDetCmpVar"><a href="Var.html#nonDetCmpVar"><span class="hs-identifier">nonDetCmpVar</span></a></a><span> </span><a name="local-6989586621681624704"><a href="#local-6989586621681624704"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621681624705"><a href="#local-6989586621681624705"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#varUnique"><span class="hs-identifier hs-var">varUnique</span></a><span> </span><a href="#local-6989586621681624704"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a><span class="hs-special">`</span><span> </span><a href="Var.html#varUnique"><span class="hs-identifier hs-var">varUnique</span></a><span> </span><a href="#local-6989586621681624705"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-343"></a><span>  </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-344"></a><span>  </span><a name="local-8214565720323786785"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;Var&quot;</span><span>
</span><a name="line-345"></a><span>  </span><a name="local-8214565720323786786"><span class="hs-identifier">gunfold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-346"></a><span>  </span><a name="local-8214565720323786784"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNoRepType</span><span> </span><span class="hs-string">&quot;Var&quot;</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-keyword">instance</span><span> </span><a href="OccName.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-349"></a><span>  </span><a name="local-8214565720325908782"><a href="OccName.html#occName"><span class="hs-identifier">occName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">varName</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">varUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-352"></a><a name="varUnique"><a href="Var.html#varUnique"><span class="hs-identifier">varUnique</span></a></a><span> </span><a name="local-6989586621681624706"><a href="#local-6989586621681624706"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-var">mkUniqueGrimily</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">realUnique</span><span> </span><a href="#local-6989586621681624706"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-identifier">setVarUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-355"></a><a name="setVarUnique"><a href="Var.html#setVarUnique"><span class="hs-identifier">setVarUnique</span></a></a><span> </span><a name="local-6989586621681624707"><a href="#local-6989586621681624707"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621681624708"><a href="#local-6989586621681624708"><span class="hs-identifier">uniq</span></a></a><span>
</span><a name="line-356"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624707"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span> </span><a href="#local-6989586621681624708"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span>
</span><a name="line-357"></a><span>          </span><span class="hs-identifier">varName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#setNameUnique"><span class="hs-identifier hs-var">setNameUnique</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varName</span><span> </span><a href="#local-6989586621681624707"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681624708"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-identifier">setVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-360"></a><a name="setVarName"><a href="Var.html#setVarName"><span class="hs-identifier">setVarName</span></a></a><span> </span><a name="local-6989586621681624709"><a href="#local-6989586621681624709"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621681624710"><a href="#local-6989586621681624710"><span class="hs-identifier">new_name</span></a></a><span>
</span><a name="line-361"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624709"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span> </span><span class="hs-special">(</span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681624710"><span class="hs-identifier hs-var">new_name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-362"></a><span>          </span><span class="hs-identifier">varName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624710"><span class="hs-identifier hs-var">new_name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-identifier">setVarType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-365"></a><a name="setVarType"><a href="Var.html#setVarType"><span class="hs-identifier">setVarType</span></a></a><span> </span><a name="local-6989586621681624711"><a href="#local-6989586621681624711"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621681624712"><a href="#local-6989586621681624712"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624711"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624712"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-identifier">updateVarType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-368"></a><a name="updateVarType"><a href="Var.html#updateVarType"><span class="hs-identifier">updateVarType</span></a></a><span> </span><a name="local-6989586621681624713"><a href="#local-6989586621681624713"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681624714"><a href="#local-6989586621681624714"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624714"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624713"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621681624714"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">updateVarTypeM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621681624697"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624697"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624697"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-371"></a><a name="updateVarTypeM"><a href="Var.html#updateVarTypeM"><span class="hs-identifier">updateVarTypeM</span></a></a><span> </span><a name="local-6989586621681624715"><a href="#local-6989586621681624715"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681624716"><a href="#local-6989586621681624716"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681624717"><a href="#local-6989586621681624717"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681624715"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621681624716"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681624716"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624717"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
*                   ArgFlag
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-comment">-- | Argument Flag</span><span>
</span><a name="line-381"></a><span class="hs-comment">--</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- Is something required to appear in source Haskell ('Required'),</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- permitted by request ('Specified') (visible type application), or</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- prohibited entirely from appearing in source Haskell ('Inferred')?</span><span>
</span><a name="line-385"></a><span class="hs-comment">-- See Note [VarBndrs, TyCoVarBinders, TyConBinders, and visibility] in TyCoRep</span><span>
</span><a name="line-386"></a><span class="hs-keyword">data</span><span> </span><a name="ArgFlag"><a href="Var.html#ArgFlag"><span class="hs-identifier">ArgFlag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Inferred"><a href="Var.html#Inferred"><span class="hs-identifier">Inferred</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Specified"><a href="Var.html#Specified"><span class="hs-identifier">Specified</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Required"><a href="Var.html#Required"><span class="hs-identifier">Required</span></a></a><span>
</span><a name="line-387"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>  </span><span class="hs-comment">-- (&lt;) on ArgFlag means &quot;is less visible than&quot;</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span class="hs-comment">-- | Does this 'ArgFlag' classify an argument that is written in Haskell?</span><span>
</span><a name="line-391"></a><span class="hs-identifier">isVisibleArgFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-392"></a><a name="isVisibleArgFlag"><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier">isVisibleArgFlag</span></a></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-393"></a><span class="hs-identifier">isVisibleArgFlag</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- | Does this 'ArgFlag' classify an argument that is not written in Haskell?</span><span>
</span><a name="line-396"></a><span class="hs-identifier">isInvisibleArgFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-397"></a><a name="isInvisibleArgFlag"><a href="Var.html#isInvisibleArgFlag"><span class="hs-identifier">isInvisibleArgFlag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier hs-var">isVisibleArgFlag</span></a><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-comment">-- | Do these denote the same level of visibility? 'Required'</span><span>
</span><a name="line-400"></a><span class="hs-comment">-- arguments are visible, others are not. So this function</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- equates 'Specified' and 'Inferred'. Used for printing.</span><span>
</span><a name="line-402"></a><span class="hs-identifier">sameVis</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-403"></a><a name="sameVis"><a href="Var.html#sameVis"><span class="hs-identifier">sameVis</span></a></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-404"></a><span class="hs-identifier">sameVis</span><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-405"></a><span class="hs-identifier">sameVis</span><span> </span><span class="hs-identifier">_</span><span>        </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-406"></a><span class="hs-identifier">sameVis</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-409"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[req]&quot;</span><span>
</span><a name="line-410"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[spec]&quot;</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[infrd]&quot;</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-414"></a><span>  </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621681624669"><a href="#local-6989586621681624669"><span class="hs-identifier">bh</span></a></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681624669"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-415"></a><span>  </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621681624670"><a href="#local-6989586621681624670"><span class="hs-identifier">bh</span></a></a><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681624670"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-416"></a><span>  </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621681624671"><a href="#local-6989586621681624671"><span class="hs-identifier">bh</span></a></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681624671"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span>  </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621681624672"><a href="#local-6989586621681624672"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-419"></a><span>    </span><a name="local-6989586621681624673"><a href="#local-6989586621681624673"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-6989586621681624672"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-420"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681624673"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-421"></a><span>      </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span>
</span><a name="line-422"></a><span>      </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span>
</span><a name="line-423"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
*                   VarBndr, TyCoVarBinder
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">-- Variable Binder</span><span>
</span><a name="line-432"></a><span class="hs-comment">--</span><span>
</span><a name="line-433"></a><span class="hs-comment">-- VarBndr is polymorphic in both var and visibility fields.</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- Currently there are six different uses of 'VarBndr':</span><span>
</span><a name="line-435"></a><span class="hs-comment">--   * Var.TyVarBinder   = VarBndr TyVar ArgFlag</span><span>
</span><a name="line-436"></a><span class="hs-comment">--   * Var.TyCoVarBinder = VarBndr TyCoVar ArgFlag</span><span>
</span><a name="line-437"></a><span class="hs-comment">--   * TyCon.TyConBinder     = VarBndr TyVar TyConBndrVis</span><span>
</span><a name="line-438"></a><span class="hs-comment">--   * TyCon.TyConTyCoBinder = VarBndr TyCoVar TyConBndrVis</span><span>
</span><a name="line-439"></a><span class="hs-comment">--   * IfaceType.IfaceForAllBndr  = VarBndr IfaceBndr ArgFlag</span><span>
</span><a name="line-440"></a><span class="hs-comment">--   * IfaceType.IfaceTyConBinder = VarBndr IfaceBndr TyConBndrVis</span><span>
</span><a name="line-441"></a><span class="hs-keyword">data</span><span> </span><a name="VarBndr"><a href="Var.html#VarBndr"><span class="hs-identifier">VarBndr</span></a></a><span> </span><a name="local-6989586621681624652"><a href="#local-6989586621681624652"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621681624653"><a href="#local-6989586621681624653"><span class="hs-identifier">argf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Bndr"><a href="Var.html#Bndr"><span class="hs-identifier">Bndr</span></a></a><span> </span><a href="#local-6989586621681624652"><span class="hs-identifier hs-type">var</span></a><span> </span><a href="#local-6989586621681624653"><span class="hs-identifier hs-type">argf</span></a><span>
</span><a name="line-442"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-comment">-- | Variable Binder</span><span>
</span><a name="line-445"></a><span class="hs-comment">--</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- A 'TyCoVarBinder' is the binder of a ForAllTy</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- It's convenient to define this synonym here rather its natural</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- home in TyCoRep, because it's used in DataCon.hs-boot</span><span>
</span><a name="line-449"></a><span class="hs-comment">--</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- A 'TyVarBinder' is a binder with only TyVar</span><span>
</span><a name="line-451"></a><span class="hs-keyword">type</span><span> </span><a name="TyCoVarBinder"><a href="Var.html#TyCoVarBinder"><span class="hs-identifier">TyCoVarBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span>
</span><a name="line-452"></a><span class="hs-keyword">type</span><span> </span><a name="TyVarBinder"><a href="Var.html#TyVarBinder"><span class="hs-identifier">TyVarBinder</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-identifier">binderVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624695"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="#local-6989586621681624696"><span class="hs-identifier hs-type">argf</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624695"><span class="hs-identifier hs-type">tv</span></a><span>
</span><a name="line-455"></a><a name="binderVar"><a href="Var.html#binderVar"><span class="hs-identifier">binderVar</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624718"><a href="#local-6989586621681624718"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624718"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-identifier">binderVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624693"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="#local-6989586621681624694"><span class="hs-identifier hs-type">argf</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681624693"><span class="hs-identifier hs-type">tv</span></a><span class="hs-special">]</span><span>
</span><a name="line-458"></a><a name="binderVars"><a href="Var.html#binderVars"><span class="hs-identifier">binderVars</span></a></a><span> </span><a name="local-6989586621681624719"><a href="#local-6989586621681624719"><span class="hs-identifier">tvbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a><span> </span><a href="#local-6989586621681624719"><span class="hs-identifier hs-var">tvbs</span></a><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-identifier">binderArgFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624691"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="#local-6989586621681624692"><span class="hs-identifier hs-type">argf</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624692"><span class="hs-identifier hs-type">argf</span></a><span>
</span><a name="line-461"></a><a name="binderArgFlag"><a href="Var.html#binderArgFlag"><span class="hs-identifier">binderArgFlag</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681624720"><a href="#local-6989586621681624720"><span class="hs-identifier">argf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624720"><span class="hs-identifier hs-var">argf</span></a><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span class="hs-identifier">binderType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span> </span><a href="#local-6989586621681624690"><span class="hs-identifier hs-type">argf</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-464"></a><a name="binderType"><a href="Var.html#binderType"><span class="hs-identifier">binderType</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624721"><a href="#local-6989586621681624721"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621681624721"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | Make a named binder</span><span>
</span><a name="line-467"></a><span class="hs-identifier">mkTyCoVarBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyCoVarBinder"><span class="hs-identifier hs-type">TyCoVarBinder</span></a><span>
</span><a name="line-468"></a><a name="mkTyCoVarBinder"><a href="Var.html#mkTyCoVarBinder"><span class="hs-identifier">mkTyCoVarBinder</span></a></a><span> </span><a name="local-6989586621681624722"><a href="#local-6989586621681624722"><span class="hs-identifier">vis</span></a></a><span> </span><a name="local-6989586621681624723"><a href="#local-6989586621681624723"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a href="#local-6989586621681624723"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621681624722"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-comment">-- | Make a named binder</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- 'var' should be a type variable</span><span>
</span><a name="line-472"></a><span class="hs-identifier">mkTyVarBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span>
</span><a name="line-473"></a><a name="mkTyVarBinder"><a href="Var.html#mkTyVarBinder"><span class="hs-identifier">mkTyVarBinder</span></a></a><span> </span><a name="local-6989586621681624724"><a href="#local-6989586621681624724"><span class="hs-identifier">vis</span></a></a><span> </span><a name="local-6989586621681624725"><a href="#local-6989586621681624725"><span class="hs-identifier">var</span></a></a><span>
</span><a name="line-474"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier hs-var">var</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>    </span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a href="#local-6989586621681624725"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621681624724"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-comment">-- | Make many named binders</span><span>
</span><a name="line-478"></a><span class="hs-identifier">mkTyCoVarBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyCoVarBinder"><span class="hs-identifier hs-type">TyCoVarBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-479"></a><a name="mkTyCoVarBinders"><a href="Var.html#mkTyCoVarBinders"><span class="hs-identifier">mkTyCoVarBinders</span></a></a><span> </span><a name="local-6989586621681624726"><a href="#local-6989586621681624726"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Var.html#mkTyCoVarBinder"><span class="hs-identifier hs-var">mkTyCoVarBinder</span></a><span> </span><a href="#local-6989586621681624726"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-comment">-- | Make many named binders</span><span>
</span><a name="line-482"></a><span class="hs-comment">-- Input vars should be type variables</span><span>
</span><a name="line-483"></a><span class="hs-identifier">mkTyVarBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-484"></a><a name="mkTyVarBinders"><a href="Var.html#mkTyVarBinders"><span class="hs-identifier">mkTyVarBinders</span></a></a><span> </span><a name="local-6989586621681624727"><a href="#local-6989586621681624727"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Var.html#mkTyVarBinder"><span class="hs-identifier hs-var">mkTyVarBinder</span></a><span> </span><a href="#local-6989586621681624727"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-identifier">isTyVarBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyCoVarBinder"><span class="hs-identifier hs-type">TyCoVarBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-487"></a><a name="isTyVarBinder"><a href="Var.html#isTyVarBinder"><span class="hs-identifier">isTyVarBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624728"><a href="#local-6989586621681624728"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621681624728"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621681624665"><span class="hs-identifier hs-type">tv</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624665"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-490"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624666"><a href="#local-6989586621681624666"><span class="hs-identifier">v</span></a></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624666"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-491"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624667"><a href="#local-6989586621681624667"><span class="hs-identifier">v</span></a></a><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'@'</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624667"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-492"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624668"><a href="#local-6989586621681624668"><span class="hs-identifier">v</span></a></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624668"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="#local-6989586621681624657"><span class="hs-identifier hs-type">tv</span></a><span class="hs-special">,</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="#local-6989586621681624658"><span class="hs-identifier hs-type">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624657"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="#local-6989586621681624658"><span class="hs-identifier hs-type">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-495"></a><span>  </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621681624659"><a href="#local-6989586621681624659"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624660"><a href="#local-6989586621681624660"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621681624661"><a href="#local-6989586621681624661"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621681624659"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621681624660"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621681624659"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621681624661"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span>  </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621681624662"><a href="#local-6989586621681624662"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681624663"><a href="#local-6989586621681624663"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621681624662"><span class="hs-identifier hs-var">bh</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621681624664"><a href="#local-6989586621681624664"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621681624662"><span class="hs-identifier hs-var">bh</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a href="#local-6989586621681624663"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621681624664"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-498"></a><span>
</span><a name="line-499"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681624654"><span class="hs-identifier hs-type">tv</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681624654"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="#local-6989586621681624655"><span class="hs-identifier hs-type">flag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-500"></a><span>  </span><a name="local-8214565720325933137"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681624656"><a href="#local-6989586621681624656"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621681624656"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
*                 Type and kind variables                              *
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">tyVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-511"></a><a name="tyVarName"><a href="Var.html#tyVarName"><span class="hs-identifier">tyVarName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varName</span><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-identifier">tyVarKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-514"></a><a name="tyVarKind"><a href="Var.html#tyVarKind"><span class="hs-identifier">tyVarKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varType</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">setTyVarUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-517"></a><a name="setTyVarUnique"><a href="Var.html#setTyVarUnique"><span class="hs-identifier">setTyVarUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#setVarUnique"><span class="hs-identifier hs-var">setVarUnique</span></a><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span class="hs-identifier">setTyVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-520"></a><a name="setTyVarName"><a href="Var.html#setTyVarName"><span class="hs-identifier">setTyVarName</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#setVarName"><span class="hs-identifier hs-var">setVarName</span></a><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-identifier">setTyVarKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-523"></a><a name="setTyVarKind"><a href="Var.html#setTyVarKind"><span class="hs-identifier">setTyVarKind</span></a></a><span> </span><a name="local-6989586621681624729"><a href="#local-6989586621681624729"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621681624730"><a href="#local-6989586621681624730"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624729"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624730"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">}</span><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span class="hs-identifier">updateTyVarKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-526"></a><a name="updateTyVarKind"><a href="Var.html#updateTyVarKind"><span class="hs-identifier">updateTyVarKind</span></a></a><span> </span><a name="local-6989586621681624731"><a href="#local-6989586621681624731"><span class="hs-identifier">update</span></a></a><span> </span><a name="local-6989586621681624732"><a href="#local-6989586621681624732"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624732"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624731"><span class="hs-identifier hs-var">update</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621681624732"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-identifier">updateTyVarKindM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621681624689"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624689"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681624689"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-529"></a><a name="updateTyVarKindM"><a href="Var.html#updateTyVarKindM"><span class="hs-identifier">updateTyVarKindM</span></a></a><span> </span><a name="local-6989586621681624733"><a href="#local-6989586621681624733"><span class="hs-identifier">update</span></a></a><span> </span><a name="local-6989586621681624734"><a href="#local-6989586621681624734"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-530"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681624735"><a href="#local-6989586621681624735"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681624733"><span class="hs-identifier hs-var">update</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621681624734"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621681624734"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">varType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624735"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">mkTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-534"></a><a name="mkTyVar"><a href="Var.html#mkTyVar"><span class="hs-identifier">mkTyVar</span></a></a><span> </span><a name="local-6989586621681624736"><a href="#local-6989586621681624736"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624737"><a href="#local-6989586621681624737"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">varName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624736"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-535"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">realUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681624736"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-536"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">varType</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624737"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-537"></a><span>                          </span><span class="hs-special">}</span><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-identifier">mkTcTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-540"></a><a name="mkTcTyVar"><a href="Var.html#mkTcTyVar"><span class="hs-identifier">mkTcTyVar</span></a></a><span> </span><a name="local-6989586621681624738"><a href="#local-6989586621681624738"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624739"><a href="#local-6989586621681624739"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621681624740"><a href="#local-6989586621681624740"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-541"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- NB: 'kind' may be a coercion kind; cf, 'TcMType.newMetaCoVar'</span><span>
</span><a name="line-542"></a><span>    </span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-var">TcTyVar</span></a><span> </span><span class="hs-special">{</span><span>   </span><span class="hs-identifier">varName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624738"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-543"></a><span>                </span><span class="hs-identifier">realUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681624738"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-544"></a><span>                </span><span class="hs-identifier">varType</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624739"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-545"></a><span>                </span><span class="hs-identifier">tc_tv_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624740"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-546"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-identifier">tcTyVarDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a><span>
</span><a name="line-549"></a><span class="hs-comment">-- See Note [TcTyVars in the typechecker] in TcType</span><span>
</span><a name="line-550"></a><a name="tcTyVarDetails"><a href="Var.html#tcTyVarDetails"><span class="hs-identifier">tcTyVarDetails</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-var">TcTyVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tc_tv_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624741"><a href="#local-6989586621681624741"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624741"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-551"></a><span class="hs-identifier">tcTyVarDetails</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#vanillaSkolemTv"><span class="hs-identifier hs-var">vanillaSkolemTv</span></a><span>
</span><a name="line-552"></a><span class="hs-identifier">tcTyVarDetails</span><span> </span><a name="local-6989586621681624742"><a href="#local-6989586621681624742"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tcTyVarDetails&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624742"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621681624742"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-identifier">setTcTyVarDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyVarDetails"><span class="hs-identifier hs-type">TcTyVarDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-555"></a><a name="setTcTyVarDetails"><a href="Var.html#setTcTyVarDetails"><span class="hs-identifier">setTcTyVarDetails</span></a></a><span> </span><a name="local-6989586621681624743"><a href="#local-6989586621681624743"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621681624744"><a href="#local-6989586621681624744"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624743"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tc_tv_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624744"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
\subsection{Ids}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-identifier">idInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span>
</span><a name="line-566"></a><a name="idInfo"><a href="Var.html#idInfo"><span class="hs-identifier">idInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624745"><a href="#local-6989586621681624745"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624745"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-567"></a><span class="hs-identifier">idInfo</span><span> </span><a name="local-6989586621681624746"><a href="#local-6989586621681624746"><span class="hs-identifier">other</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;idInfo&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624746"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">idDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span>
</span><a name="line-570"></a><a name="idDetails"><a href="Var.html#idDetails"><span class="hs-identifier">idDetails</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624747"><a href="#local-6989586621681624747"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624747"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-571"></a><span class="hs-identifier">idDetails</span><span> </span><a name="local-6989586621681624748"><a href="#local-6989586621681624748"><span class="hs-identifier">other</span></a></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;idDetails&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624748"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span class="hs-comment">-- The next three have a 'Var' suffix even though they always build</span><span>
</span><a name="line-574"></a><span class="hs-comment">-- Ids, because Id.hs uses 'mkGlobalId' etc with different types</span><span>
</span><a name="line-575"></a><span class="hs-identifier">mkGlobalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-576"></a><a name="mkGlobalVar"><a href="Var.html#mkGlobalVar"><span class="hs-identifier">mkGlobalVar</span></a></a><span> </span><a name="local-6989586621681624749"><a href="#local-6989586621681624749"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621681624750"><a href="#local-6989586621681624750"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624751"><a href="#local-6989586621681624751"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681624752"><a href="#local-6989586621681624752"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-577"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mk_id"><span class="hs-identifier hs-var">mk_id</span></a><span> </span><a href="#local-6989586621681624750"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681624751"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span> </span><a href="#local-6989586621681624749"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621681624752"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-identifier">mkLocalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-580"></a><a name="mkLocalVar"><a href="Var.html#mkLocalVar"><span class="hs-identifier">mkLocalVar</span></a></a><span> </span><a name="local-6989586621681624753"><a href="#local-6989586621681624753"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621681624754"><a href="#local-6989586621681624754"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624755"><a href="#local-6989586621681624755"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681624756"><a href="#local-6989586621681624756"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-581"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mk_id"><span class="hs-identifier hs-var">mk_id</span></a><span> </span><a href="#local-6989586621681624754"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681624755"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#NotExported"><span class="hs-identifier hs-var">NotExported</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681624753"><span class="hs-identifier hs-var">details</span></a><span>  </span><a href="#local-6989586621681624756"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span class="hs-identifier">mkCoVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span>
</span><a name="line-584"></a><span class="hs-comment">-- Coercion variables have no IdInfo</span><span>
</span><a name="line-585"></a><a name="mkCoVar"><a href="Var.html#mkCoVar"><span class="hs-identifier">mkCoVar</span></a></a><span> </span><a name="local-6989586621681624757"><a href="#local-6989586621681624757"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624758"><a href="#local-6989586621681624758"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mk_id"><span class="hs-identifier hs-var">mk_id</span></a><span> </span><a href="#local-6989586621681624757"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681624758"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#NotExported"><span class="hs-identifier hs-var">NotExported</span></a><span class="hs-special">)</span><span> </span><a href="IdInfo.html#coVarDetails"><span class="hs-identifier hs-var">coVarDetails</span></a><span> </span><a href="IdInfo.html#vanillaIdInfo"><span class="hs-identifier hs-var">vanillaIdInfo</span></a><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-comment">-- | Exported 'Var's will not be removed as dead code</span><span>
</span><a name="line-588"></a><span class="hs-identifier">mkExportedLocalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-589"></a><a name="mkExportedLocalVar"><a href="Var.html#mkExportedLocalVar"><span class="hs-identifier">mkExportedLocalVar</span></a></a><span> </span><a name="local-6989586621681624759"><a href="#local-6989586621681624759"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621681624760"><a href="#local-6989586621681624760"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624761"><a href="#local-6989586621681624761"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681624762"><a href="#local-6989586621681624762"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-590"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mk_id"><span class="hs-identifier hs-var">mk_id</span></a><span> </span><a href="#local-6989586621681624760"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681624761"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#Exported"><span class="hs-identifier hs-var">Exported</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681624759"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621681624762"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span class="hs-identifier">mk_id</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#IdScope"><span class="hs-identifier hs-type">IdScope</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-593"></a><a name="mk_id"><a href="Var.html#mk_id"><span class="hs-identifier">mk_id</span></a></a><span> </span><a name="local-6989586621681624763"><a href="#local-6989586621681624763"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681624764"><a href="#local-6989586621681624764"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621681624765"><a href="#local-6989586621681624765"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621681624766"><a href="#local-6989586621681624766"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621681624767"><a href="#local-6989586621681624767"><span class="hs-identifier">info</span></a></a><span>
</span><a name="line-594"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">varName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624763"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-595"></a><span>         </span><span class="hs-identifier">realUnique</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681624763"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-596"></a><span>         </span><span class="hs-identifier">varType</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624764"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span>
</span><a name="line-597"></a><span>         </span><span class="hs-identifier">idScope</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624765"><span class="hs-identifier hs-var">scope</span></a><span class="hs-special">,</span><span>
</span><a name="line-598"></a><span>         </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624766"><span class="hs-identifier hs-var">details</span></a><span class="hs-special">,</span><span>
</span><a name="line-599"></a><span>         </span><span class="hs-identifier">id_info</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624767"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-602"></a><span class="hs-identifier">lazySetIdInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdInfo"><span class="hs-identifier hs-type">IdInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-603"></a><a name="lazySetIdInfo"><a href="Var.html#lazySetIdInfo"><span class="hs-identifier">lazySetIdInfo</span></a></a><span> </span><a name="local-6989586621681624768"><a href="#local-6989586621681624768"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621681624769"><a href="#local-6989586621681624769"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624768"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_info</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624769"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-identifier">setIdDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IdInfo.html#IdDetails"><span class="hs-identifier hs-type">IdDetails</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-606"></a><a name="setIdDetails"><a href="Var.html#setIdDetails"><span class="hs-identifier">setIdDetails</span></a></a><span> </span><a name="local-6989586621681624770"><a href="#local-6989586621681624770"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621681624771"><a href="#local-6989586621681624771"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624770"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624771"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-identifier">globaliseId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-609"></a><span class="hs-comment">-- ^ If it's a local, make it global</span><span>
</span><a name="line-610"></a><a name="globaliseId"><a href="Var.html#globaliseId"><span class="hs-identifier">globaliseId</span></a></a><span> </span><a name="local-6989586621681624772"><a href="#local-6989586621681624772"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624772"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">setIdExported</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-613"></a><span class="hs-comment">-- ^ Exports the given local 'Id'. Can also be called on global 'Id's, such as data constructors</span><span>
</span><a name="line-614"></a><span class="hs-comment">-- and class operations, which are born as global 'Id's and automatically exported</span><span>
</span><a name="line-615"></a><a name="setIdExported"><a href="Var.html#setIdExported"><span class="hs-identifier">setIdExported</span></a></a><span> </span><a name="local-6989586621681624773"><a href="#local-6989586621681624773"><span class="hs-identifier">id</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624773"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#Exported"><span class="hs-identifier hs-var">Exported</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-616"></a><span class="hs-identifier">setIdExported</span><span> </span><a name="local-6989586621681624774"><a href="#local-6989586621681624774"><span class="hs-identifier">id</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681624774"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-617"></a><span class="hs-identifier">setIdExported</span><span> </span><a name="local-6989586621681624775"><a href="#local-6989586621681624775"><span class="hs-identifier">tv</span></a></a><span>                               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;setIdExported&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681624775"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-identifier">setIdNotExported</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-620"></a><span class="hs-comment">-- ^ We can only do this to LocalIds</span><span>
</span><a name="line-621"></a><a name="setIdNotExported"><a href="Var.html#setIdNotExported"><span class="hs-identifier">setIdNotExported</span></a></a><span> </span><a name="local-6989586621681624776"><a href="#local-6989586621681624776"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isLocalId</span><span> </span><span class="hs-identifier">id</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span>                      </span><a href="#local-6989586621681624776"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#NotExported"><span class="hs-identifier hs-var">NotExported</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Predicates over variables}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>        </span><span class="hs-comment">-- True of both TyVar and TcTyVar</span><span>
</span><a name="line-633"></a><a name="isTyVar"><a href="Var.html#isTyVar"><span class="hs-identifier">isTyVar</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-634"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-special">(</span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-var">TcTyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-635"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-636"></a><span>
</span><a name="line-637"></a><span class="hs-identifier">isTcTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>      </span><span class="hs-comment">-- True of TcTyVar only</span><span>
</span><a name="line-638"></a><a name="isTcTyVar"><a href="Var.html#isTcTyVar"><span class="hs-identifier">isTcTyVar</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-var">TcTyVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-639"></a><span class="hs-identifier">isTcTyVar</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-identifier">isTyCoVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-642"></a><a name="isTyCoVar"><a href="Var.html#isTyCoVar"><span class="hs-identifier">isTyCoVar</span></a></a><span> </span><a name="local-6989586621681624777"><a href="#local-6989586621681624777"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621681624777"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a><span> </span><a href="#local-6989586621681624777"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">isId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-645"></a><a name="isId"><a href="Var.html#isId"><span class="hs-identifier">isId</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-646"></a><span class="hs-identifier">isId</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-identifier">isCoVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-649"></a><span class="hs-comment">-- A coercion variable</span><span>
</span><a name="line-650"></a><a name="isCoVar"><a href="Var.html#isCoVar"><span class="hs-identifier">isCoVar</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624778"><a href="#local-6989586621681624778"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IdInfo.html#isCoVarDetails"><span class="hs-identifier hs-var">isCoVarDetails</span></a><span> </span><a href="#local-6989586621681624778"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-651"></a><span class="hs-identifier">isCoVar</span><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-652"></a><span>
</span><a name="line-653"></a><span class="hs-identifier">isNonCoVarId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-654"></a><span class="hs-comment">-- A term variable (Id) that is /not/ a coercion variable</span><span>
</span><a name="line-655"></a><a name="isNonCoVarId"><a href="Var.html#isNonCoVarId"><span class="hs-identifier">isNonCoVarId</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">id_details</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681624779"><a href="#local-6989586621681624779"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="IdInfo.html#isCoVarDetails"><span class="hs-identifier hs-var">isCoVarDetails</span></a><span> </span><a href="#local-6989586621681624779"><span class="hs-identifier hs-var">details</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span class="hs-identifier">isNonCoVarId</span><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-657"></a><span>
</span><a name="line-658"></a><span class="hs-identifier">isLocalId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-659"></a><a name="isLocalId"><a href="Var.html#isLocalId"><span class="hs-identifier">isLocalId</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-660"></a><span class="hs-identifier">isLocalId</span><span> </span><span class="hs-identifier">_</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-comment">-- | 'isLocalVar' returns @True@ for type variables as well as local 'Id's</span><span>
</span><a name="line-663"></a><span class="hs-comment">-- These are the variables that we need to pay attention to when finding free</span><span>
</span><a name="line-664"></a><span class="hs-comment">-- variables, or doing dependency analysis.</span><span>
</span><a name="line-665"></a><span class="hs-identifier">isLocalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-666"></a><a name="isLocalVar"><a href="Var.html#isLocalVar"><span class="hs-identifier">isLocalVar</span></a></a><span> </span><a name="local-6989586621681624780"><a href="#local-6989586621681624780"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Var.html#isGlobalId"><span class="hs-identifier hs-var">isGlobalId</span></a><span> </span><a href="#local-6989586621681624780"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>
</span><a name="line-668"></a><span class="hs-identifier">isGlobalId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-669"></a><a name="isGlobalId"><a href="Var.html#isGlobalId"><span class="hs-identifier">isGlobalId</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-670"></a><span class="hs-identifier">isGlobalId</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-comment">-- | 'mustHaveLocalBinding' returns @True@ of 'Id's and 'TyVar's</span><span>
</span><a name="line-673"></a><span class="hs-comment">-- that must have a binding in this module.  The converse</span><span>
</span><a name="line-674"></a><span class="hs-comment">-- is not quite right: there are some global 'Id's that must have</span><span>
</span><a name="line-675"></a><span class="hs-comment">-- bindings, such as record selectors.  But that doesn't matter,</span><span>
</span><a name="line-676"></a><span class="hs-comment">-- because it's only used for assertions</span><span>
</span><a name="line-677"></a><span class="hs-identifier">mustHaveLocalBinding</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-678"></a><a name="mustHaveLocalBinding"><a href="Var.html#mustHaveLocalBinding"><span class="hs-identifier">mustHaveLocalBinding</span></a></a><span> </span><a name="local-6989586621681624781"><a href="#local-6989586621681624781"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#isLocalVar"><span class="hs-identifier hs-var">isLocalVar</span></a><span> </span><a href="#local-6989586621681624781"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">-- | 'isExportedIdVar' means \&quot;don't throw this away\&quot;</span><span>
</span><a name="line-681"></a><span class="hs-identifier">isExportedId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-682"></a><a name="isExportedId"><a href="Var.html#isExportedId"><span class="hs-identifier">isExportedId</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#GlobalId"><span class="hs-identifier hs-var">GlobalId</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-683"></a><span class="hs-identifier">isExportedId</span><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">idScope</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#LocalId"><span class="hs-identifier hs-var">LocalId</span></a><span> </span><a href="Var.html#Exported"><span class="hs-identifier hs-var">Exported</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-684"></a><span class="hs-identifier">isExportedId</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-685"></a></pre></body></html>