<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--</span><span>
</span><a name="line-2"></a><span class="hs-comment">--  (c) The University of Glasgow 2002-2006</span><span>
</span><a name="line-3"></a><span class="hs-comment">--</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- Functions over HsSyn specialised to RdrName.</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span>   </span><span class="hs-identifier">RdrHsSyn</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>        </span><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier hs-var">mkHsOpApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="HsUtils.html#mkHsIntegral"><span class="hs-identifier hs-var">mkHsIntegral</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsFractional"><span class="hs-identifier hs-var">mkHsFractional</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsIsString"><span class="hs-identifier hs-var">mkHsIsString</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkSpliceDecl"><span class="hs-identifier hs-var">mkSpliceDecl</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="RdrHsSyn.html#mkRoleAnnotDecl"><span class="hs-identifier hs-var">mkRoleAnnotDecl</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="RdrHsSyn.html#mkClassDecl"><span class="hs-identifier hs-var">mkClassDecl</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="RdrHsSyn.html#mkTyData"><span class="hs-identifier hs-var">mkTyData</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkDataFamInst"><span class="hs-identifier hs-var">mkDataFamInst</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>        </span><a href="RdrHsSyn.html#mkTySynonym"><span class="hs-identifier hs-var">mkTySynonym</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkTyFamInstEqn"><span class="hs-identifier hs-var">mkTyFamInstEqn</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>        </span><a href="RdrHsSyn.html#mkTyFamInst"><span class="hs-identifier hs-var">mkTyFamInst</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="RdrHsSyn.html#mkFamDecl"><span class="hs-identifier hs-var">mkFamDecl</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsSigType"><span class="hs-identifier hs-var">mkLHsSigType</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="RdrHsSyn.html#mkInlinePragma"><span class="hs-identifier hs-var">mkInlinePragma</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>        </span><a href="RdrHsSyn.html#mkPatSynMatchGroup"><span class="hs-identifier hs-var">mkPatSynMatchGroup</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="RdrHsSyn.html#mkRecConstrOrUpdate"><span class="hs-identifier hs-var">mkRecConstrOrUpdate</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- HsExp -&gt; [HsFieldUpdate] -&gt; P HsExp</span><span>
</span><a name="line-26"></a><span>        </span><a href="RdrHsSyn.html#mkTyClD"><span class="hs-identifier hs-var">mkTyClD</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkInstD"><span class="hs-identifier hs-var">mkInstD</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="RdrHsSyn.html#mkRdrRecordCon"><span class="hs-identifier hs-var">mkRdrRecordCon</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkRdrRecordUpd"><span class="hs-identifier hs-var">mkRdrRecordUpd</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="RdrHsSyn.html#filterCTuple"><span class="hs-identifier hs-var">filterCTuple</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>        </span><a href="RdrHsSyn.html#cvBindGroup"><span class="hs-identifier hs-var">cvBindGroup</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="RdrHsSyn.html#cvBindsAndSigs"><span class="hs-identifier hs-var">cvBindsAndSigs</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="RdrHsSyn.html#cvTopDecls"><span class="hs-identifier hs-var">cvTopDecls</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="RdrHsSyn.html#placeHolderPunRhs"><span class="hs-identifier hs-var">placeHolderPunRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>        </span><span class="hs-comment">-- Stuff to do with Foreign declarations</span><span>
</span><a name="line-37"></a><span>        </span><a href="RdrHsSyn.html#mkImport"><span class="hs-identifier hs-var">mkImport</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="RdrHsSyn.html#parseCImport"><span class="hs-identifier hs-var">parseCImport</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="RdrHsSyn.html#mkExport"><span class="hs-identifier hs-var">mkExport</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><a href="RdrHsSyn.html#mkExtName"><span class="hs-identifier hs-var">mkExtName</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- RdrName -&gt; CLabelString</span><span>
</span><a name="line-41"></a><span>        </span><a href="RdrHsSyn.html#mkGadtDecl"><span class="hs-identifier hs-var">mkGadtDecl</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- [Located RdrName] -&gt; LHsType RdrName -&gt; ConDecl RdrName</span><span>
</span><a name="line-42"></a><span>        </span><a href="RdrHsSyn.html#mkConDeclH98"><span class="hs-identifier hs-var">mkConDeclH98</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="RdrHsSyn.html#mkATDefault"><span class="hs-identifier hs-var">mkATDefault</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-comment">-- Bunch of functions in the parser monad for</span><span>
</span><a name="line-46"></a><span>        </span><span class="hs-comment">-- checking and constructing values</span><span>
</span><a name="line-47"></a><span>        </span><a href="RdrHsSyn.html#checkBlockArguments"><span class="hs-identifier hs-var">checkBlockArguments</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="RdrHsSyn.html#checkPrecP"><span class="hs-identifier hs-var">checkPrecP</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- Int -&gt; P Int</span><span>
</span><a name="line-49"></a><span>        </span><a href="RdrHsSyn.html#checkContext"><span class="hs-identifier hs-var">checkContext</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- HsType -&gt; P HsContext</span><span>
</span><a name="line-50"></a><span>        </span><a href="RdrHsSyn.html#checkPattern"><span class="hs-identifier hs-var">checkPattern</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- HsExp -&gt; P HsPat</span><span>
</span><a name="line-51"></a><span>        </span><a href="RdrHsSyn.html#bang_RDR"><span class="hs-identifier hs-var">bang_RDR</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>        </span><a href="RdrHsSyn.html#isBangRdr"><span class="hs-identifier hs-var">isBangRdr</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>        </span><a href="RdrHsSyn.html#checkPatterns"><span class="hs-identifier hs-var">checkPatterns</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- SrcLoc -&gt; [HsExp] -&gt; P [HsPat]</span><span>
</span><a name="line-54"></a><span>        </span><a href="RdrHsSyn.html#checkMonadComp"><span class="hs-identifier hs-var">checkMonadComp</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- P (HsStmtContext RdrName)</span><span>
</span><a name="line-55"></a><span>        </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- LHsExpr RdrName -&gt; P (LHsCmd RdrName)</span><span>
</span><a name="line-56"></a><span>        </span><a href="RdrHsSyn.html#checkValDef"><span class="hs-identifier hs-var">checkValDef</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- (SrcLoc, HsExp, HsRhs, [HsDecl]) -&gt; P HsDecl</span><span>
</span><a name="line-57"></a><span>        </span><a href="RdrHsSyn.html#checkValSigLhs"><span class="hs-identifier hs-var">checkValSigLhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>        </span><a href="RdrHsSyn.html#checkDoAndIfThenElse"><span class="hs-identifier hs-var">checkDoAndIfThenElse</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="RdrHsSyn.html#LRuleTyTmVar"><span class="hs-identifier hs-type">LRuleTyTmVar</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-type">RuleTyTmVar</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="RdrHsSyn.html#mkRuleBndrs"><span class="hs-identifier hs-var">mkRuleBndrs</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkRuleTyVarBndrs"><span class="hs-identifier hs-var">mkRuleTyVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="RdrHsSyn.html#checkRuleTyVarBndrNames"><span class="hs-identifier hs-var">checkRuleTyVarBndrNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="RdrHsSyn.html#checkRecordSyntax"><span class="hs-identifier hs-var">checkRecordSyntax</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>        </span><a href="RdrHsSyn.html#checkEmptyGADTs"><span class="hs-identifier hs-var">checkEmptyGADTs</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>        </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#hintBangPat"><span class="hs-identifier hs-var">hintBangPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>        </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mergeOps"><span class="hs-identifier hs-var">mergeOps</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mergeDataCon"><span class="hs-identifier hs-var">mergeDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>        </span><span class="hs-comment">-- Help with processing exports</span><span>
</span><a name="line-68"></a><span>        </span><a href="RdrHsSyn.html#ImpExpSubSpec"><span class="hs-identifier hs-type">ImpExpSubSpec</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>        </span><a href="RdrHsSyn.html#mkModuleImpExp"><span class="hs-identifier hs-var">mkModuleImpExp</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>        </span><a href="RdrHsSyn.html#mkTypeImpExp"><span class="hs-identifier hs-var">mkTypeImpExp</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>        </span><a href="RdrHsSyn.html#mkImpExpSubSpec"><span class="hs-identifier hs-var">mkImpExpSubSpec</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>        </span><a href="RdrHsSyn.html#checkImportSpec"><span class="hs-identifier hs-var">checkImportSpec</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>        </span><span class="hs-comment">-- Token symbols</span><span>
</span><a name="line-76"></a><span>        </span><a href="RdrHsSyn.html#forallSym"><span class="hs-identifier hs-var">forallSym</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>        </span><a href="RdrHsSyn.html#starSym"><span class="hs-identifier hs-var">starSym</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>        </span><span class="hs-comment">-- Warnings and errors</span><span>
</span><a name="line-80"></a><span>        </span><a href="RdrHsSyn.html#warnStarIsType"><span class="hs-identifier hs-var">warnStarIsType</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>        </span><a href="RdrHsSyn.html#failOpFewArgs"><span class="hs-identifier hs-var">failOpFewArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>        </span><a href="RdrHsSyn.html#SumOrTuple"><span class="hs-identifier hs-type">SumOrTuple</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#mkSumOrTuple"><span class="hs-identifier hs-var">mkSumOrTuple</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>            </span><span class="hs-comment">-- Lots of it</span><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>            </span><span class="hs-special">(</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleDataCon_maybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#fsFromRole"><span class="hs-identifier hs-var">fsFromRole</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="Lexer.html"><span class="hs-identifier">Lexer</span></a><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><a href="Lexeme.html"><span class="hs-identifier">Lexeme</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="Lexeme.html#isLexCon"><span class="hs-identifier hs-var">isLexCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>             </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#cTupleTyConName"><span class="hs-identifier hs-var">cTupleTyConName</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#tupleTyCon"><span class="hs-identifier hs-var">tupleTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>                          </span><a href="TysWiredIn.html#nilDataConName"><span class="hs-identifier hs-var">nilDataConName</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#nilDataConKey"><span class="hs-identifier hs-var">nilDataConKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>                          </span><a href="TysWiredIn.html#listTyConName"><span class="hs-identifier hs-var">listTyConName</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#listTyConKey"><span class="hs-identifier hs-var">listTyConKey</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#eqTyCon_RDR"><span class="hs-identifier hs-var">eqTyCon_RDR</span></a><span class="hs-special">,</span><span>
</span><a name="line-103"></a><span>                          </span><a href="TysWiredIn.html#tupleTyConName"><span class="hs-identifier hs-var">tupleTyConName</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#cTupleTyConNameArity_maybe"><span class="hs-identifier hs-var">cTupleTyConNameArity_maybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><a href="ForeignCall.html"><span class="hs-identifier">ForeignCall</span></a><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="PrelNames.html#allNameStrings"><span class="hs-identifier hs-var">allNameStrings</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="OrdList.html"><span class="hs-identifier">OrdList</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span class="hs-special">,</span><span> </span><a href="OrdList.html#fromOL"><span class="hs-identifier hs-var">fromOL</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>              </span><span class="hs-special">(</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span> </span><a href="ApiAnnotation.html"><span class="hs-identifier">ApiAnnotation</span></a><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.ParserCombinators.ReadP</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">ReadP</span><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">dataTypeOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromConstr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dataTypeConstrs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">{- **********************************************************************

  Construction functions for Rdr stuff

  ********************************************************************* -}</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | mkClassDecl builds a RdrClassDecl, filling in the names for tycon and</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- datacon by deriving them from the name of the class.  We fill in the names</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- for the tycon and datacon corresponding to the class, by deriving them</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- from the name of the class itself.  This saves recording the names in the</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- interface file (which would be equally good).</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- Similarly for mkConDecl, mkClassOpSig and default-method names.</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">--         *** See Note [The Naming story] in HsDecls ****</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">mkTyClD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683974407"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683974407"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><a name="mkTyClD"><a href="RdrHsSyn.html#mkTyClD"><span class="hs-identifier">mkTyClD</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974408"><a href="#local-6989586621683974408"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974409"><a href="#local-6989586621683974409"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974408"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyClD"><span class="hs-identifier hs-var">TyClD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974409"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-identifier">mkInstD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683974406"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683974406"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><a name="mkInstD"><a href="RdrHsSyn.html#mkInstD"><span class="hs-identifier">mkInstD</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974410"><a href="#local-6989586621683974410"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974411"><a href="#local-6989586621683974411"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974410"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#InstD"><span class="hs-identifier hs-var">InstD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974411"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">mkClassDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-150"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974405"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="HsDecls.html#LHsFunDep"><span class="hs-identifier hs-type">LHsFunDep</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><a name="mkClassDecl"><a href="RdrHsSyn.html#mkClassDecl"><span class="hs-identifier">mkClassDecl</span></a></a><span> </span><a name="local-6989586621683974412"><a href="#local-6989586621683974412"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974413"><a href="#local-6989586621683974413"><span class="hs-identifier">mcxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974414"><a href="#local-6989586621683974414"><span class="hs-identifier">tycl_hdr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974415"><a href="#local-6989586621683974415"><span class="hs-identifier">fds</span></a></a><span> </span><a name="local-6989586621683974416"><a href="#local-6989586621683974416"><span class="hs-identifier">where_cls</span></a></a><span>
</span><a name="line-156"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974417"><a href="#local-6989586621683974417"><span class="hs-identifier">binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974418"><a href="#local-6989586621683974418"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974419"><a href="#local-6989586621683974419"><span class="hs-identifier">ats</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974420"><a href="#local-6989586621683974420"><span class="hs-identifier">at_insts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683974421"><a href="#local-6989586621683974421"><span class="hs-identifier">docs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#cvBindsAndSigs"><span class="hs-identifier hs-var">cvBindsAndSigs</span></a><span> </span><a href="#local-6989586621683974416"><span class="hs-identifier hs-var">where_cls</span></a><span>
</span><a name="line-157"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974422"><a href="#local-6989586621683974422"><span class="hs-identifier">cxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974413"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-158"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974423"><a href="#local-6989586621683974423"><span class="hs-identifier">cls</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974424"><a href="#local-6989586621683974424"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974425"><a href="#local-6989586621683974425"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974426"><a href="#local-6989586621683974426"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621683974414"><span class="hs-identifier hs-var">tycl_hdr</span></a><span>
</span><a name="line-159"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974412"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974426"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-160"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974427"><a href="#local-6989586621683974427"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><a name="local-6989586621683974428"><a href="#local-6989586621683974428"><span class="hs-identifier">annst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyVarsP"><span class="hs-identifier hs-var">checkTyVarsP</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;class&quot;</span><span class="hs-special">)</span><span> </span><a href="RdrHsSyn.html#whereDots"><span class="hs-identifier hs-var">whereDots</span></a><span> </span><a href="#local-6989586621683974423"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-6989586621683974424"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-161"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974412"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974428"><span class="hs-identifier hs-var">annst</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-162"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974429"><a href="#local-6989586621683974429"><span class="hs-identifier">at_defs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974430"><a href="#local-6989586621683974430"><span class="hs-identifier">annsi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapAndUnzipM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="RdrHsSyn.html#mkATDefault"><span class="hs-identifier hs-var">mkATDefault</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974420"><span class="hs-identifier hs-var">at_insts</span></a><span>
</span><a name="line-163"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">sequence_</span><span> </span><a href="#local-6989586621683974430"><span class="hs-identifier hs-var">annsi</span></a><span>
</span><a name="line-164"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974412"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClassDecl"><span class="hs-identifier hs-var">ClassDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdCExt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdCtxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974422"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-165"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974423"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974427"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-166"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974425"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-167"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFDs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683974415"><span class="hs-identifier hs-var">fds</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdSigs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkClassOpSigs"><span class="hs-identifier hs-var">mkClassOpSigs</span></a><span> </span><a href="#local-6989586621683974418"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-169"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdMeths</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974417"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-170"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974419"><span class="hs-identifier hs-var">ats</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATDefs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974429"><span class="hs-identifier hs-var">at_defs</span></a><span>
</span><a name="line-171"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDocs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974421"><span class="hs-identifier hs-var">docs</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">mkATDefault</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LTyFamInstDecl"><span class="hs-identifier hs-type">LTyFamInstDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-174"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LTyFamDefltEqn"><span class="hs-identifier hs-type">LTyFamDefltEqn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- ^ Take a type-family instance declaration and turn it into</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- a type-family default equation for a class declaration.</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- We parse things as the former and use this function to convert to the latter</span><span>
</span><a name="line-178"></a><span class="hs-comment">--</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- We use the Either monad because this also called from &quot;Convert&quot;.</span><span>
</span><a name="line-180"></a><span class="hs-comment">--</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- The @P ()@ we return corresponds represents an action which will add</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- some necessary paren annotations to the parsing context. Naturally, this</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- is not something that the &quot;Convert&quot; use cares about.</span><span>
</span><a name="line-184"></a><a name="mkATDefault"><a href="RdrHsSyn.html#mkATDefault"><span class="hs-identifier">mkATDefault</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974431"><a href="#local-6989586621683974431"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstDecl"><span class="hs-identifier hs-var">TyFamInstDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974432"><a href="#local-6989586621683974432"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="HsDecls.html#FamEqn"><span class="hs-identifier hs-var">FamEqn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_tycon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974433"><a href="#local-6989586621683974433"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974434"><a href="#local-6989586621683974434"><span class="hs-identifier">bndrs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974435"><a href="#local-6989586621683974435"><span class="hs-identifier">pats</span></a></a><span>
</span><a name="line-186"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974436"><a href="#local-6989586621683974436"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974437"><a href="#local-6989586621683974437"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974432"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-187"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974438"><a href="#local-6989586621683974438"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974439"><a href="#local-6989586621683974439"><span class="hs-identifier">anns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyVars"><span class="hs-identifier hs-var">checkTyVars</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;default&quot;</span><span class="hs-special">)</span><span> </span><a href="RdrHsSyn.html#equalsDots"><span class="hs-identifier hs-var">equalsDots</span></a><span> </span><a href="#local-6989586621683974433"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683974435"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-188"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974440"><a href="#local-6989586621683974440"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974431"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamEqn"><span class="hs-identifier hs-var">FamEqn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-189"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974433"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-190"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">bndrs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-192"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974438"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-193"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974436"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-194"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974437"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974440"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974431"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974439"><span class="hs-identifier hs-var">anns</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-196"></a><span class="hs-identifier">mkATDefault</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstDecl"><span class="hs-identifier hs-var">TyFamInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XFamEqn"><span class="hs-identifier hs-var">XFamEqn</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkATDefault&quot;</span><span>
</span><a name="line-197"></a><span class="hs-identifier">mkATDefault</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstDecl"><span class="hs-identifier hs-var">TyFamInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#XHsImplicitBndrs"><span class="hs-identifier hs-var">XHsImplicitBndrs</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkATDefault&quot;</span><span>
</span><a name="line-198"></a><span class="hs-identifier">mkATDefault</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkATDefault: Impossible Match&quot;</span><span>
</span><a name="line-199"></a><span>                                </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-identifier">mkTyData</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-202"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a><span>
</span><a name="line-203"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsDeriving"><span class="hs-identifier hs-type">HsDeriving</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-208"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><a name="mkTyData"><a href="RdrHsSyn.html#mkTyData"><span class="hs-identifier">mkTyData</span></a></a><span> </span><a name="local-6989586621683974441"><a href="#local-6989586621683974441"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974442"><a href="#local-6989586621683974442"><span class="hs-identifier">new_or_data</span></a></a><span> </span><a name="local-6989586621683974443"><a href="#local-6989586621683974443"><span class="hs-identifier">cType</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974444"><a href="#local-6989586621683974444"><span class="hs-identifier">mcxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974445"><a href="#local-6989586621683974445"><span class="hs-identifier">tycl_hdr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>         </span><a name="local-6989586621683974446"><a href="#local-6989586621683974446"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621683974447"><a href="#local-6989586621683974447"><span class="hs-identifier">data_cons</span></a></a><span> </span><a name="local-6989586621683974448"><a href="#local-6989586621683974448"><span class="hs-identifier">maybe_deriv</span></a></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974449"><a href="#local-6989586621683974449"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974450"><a href="#local-6989586621683974450"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974451"><a href="#local-6989586621683974451"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974452"><a href="#local-6989586621683974452"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683974445"><span class="hs-identifier hs-var">tycl_hdr</span></a><span>
</span><a name="line-212"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974441"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974452"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-213"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974453"><a href="#local-6989586621683974453"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974454"><a href="#local-6989586621683974454"><span class="hs-identifier">anns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyVarsP"><span class="hs-identifier hs-var">checkTyVarsP</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974442"><span class="hs-identifier hs-var">new_or_data</span></a><span class="hs-special">)</span><span> </span><a href="RdrHsSyn.html#equalsDots"><span class="hs-identifier hs-var">equalsDots</span></a><span> </span><a href="#local-6989586621683974449"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683974450"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-214"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974441"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974454"><span class="hs-identifier hs-var">anns</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-215"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621683974455"><a href="#local-6989586621683974455"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#mkDataDefn"><span class="hs-identifier hs-var">mkDataDefn</span></a><span> </span><a href="#local-6989586621683974442"><span class="hs-identifier hs-var">new_or_data</span></a><span> </span><a href="#local-6989586621683974443"><span class="hs-identifier hs-var">cType</span></a><span> </span><a href="#local-6989586621683974444"><span class="hs-identifier hs-var">mcxt</span></a><span> </span><a href="#local-6989586621683974446"><span class="hs-identifier hs-var">ksig</span></a><span> </span><a href="#local-6989586621683974447"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><a href="#local-6989586621683974448"><span class="hs-identifier hs-var">maybe_deriv</span></a><span>
</span><a name="line-216"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974441"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataDecl"><span class="hs-identifier hs-var">DataDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdDExt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span>
</span><a name="line-217"></a><span>                                    </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974449"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974453"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">,</span><span>
</span><a name="line-218"></a><span>                                    </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974451"><span class="hs-identifier hs-var">fixity</span></a><span class="hs-special">,</span><span>
</span><a name="line-219"></a><span>                                    </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974455"><span class="hs-identifier hs-var">defn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-identifier">mkDataDefn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a><span>
</span><a name="line-222"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-226"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsDeriving"><span class="hs-identifier hs-type">HsDeriving</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-227"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><a name="mkDataDefn"><a href="RdrHsSyn.html#mkDataDefn"><span class="hs-identifier">mkDataDefn</span></a></a><span> </span><a name="local-6989586621683974456"><a href="#local-6989586621683974456"><span class="hs-identifier">new_or_data</span></a></a><span> </span><a name="local-6989586621683974457"><a href="#local-6989586621683974457"><span class="hs-identifier">cType</span></a></a><span> </span><a name="local-6989586621683974458"><a href="#local-6989586621683974458"><span class="hs-identifier">mcxt</span></a></a><span> </span><a name="local-6989586621683974459"><a href="#local-6989586621683974459"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621683974460"><a href="#local-6989586621683974460"><span class="hs-identifier">data_cons</span></a></a><span> </span><a name="local-6989586621683974461"><a href="#local-6989586621683974461"><span class="hs-identifier">maybe_deriv</span></a></a><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RdrHsSyn.html#checkDatatypeContext"><span class="hs-identifier hs-var">checkDatatypeContext</span></a><span> </span><a href="#local-6989586621683974458"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-230"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974462"><a href="#local-6989586621683974462"><span class="hs-identifier">cxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974458"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-231"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-var">HsDataDefn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-232"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ND</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974456"><span class="hs-identifier hs-var">new_or_data</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974457"><span class="hs-identifier hs-var">cType</span></a><span>
</span><a name="line-233"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974462"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-234"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974460"><span class="hs-identifier hs-var">data_cons</span></a><span>
</span><a name="line-235"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974459"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-236"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_derivs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974461"><span class="hs-identifier hs-var">maybe_deriv</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">mkTySynonym</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-240"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">-- LHS</span><span>
</span><a name="line-241"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">-- RHS</span><span>
</span><a name="line-242"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-243"></a><a name="mkTySynonym"><a href="RdrHsSyn.html#mkTySynonym"><span class="hs-identifier">mkTySynonym</span></a></a><span> </span><a name="local-6989586621683974463"><a href="#local-6989586621683974463"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974464"><a href="#local-6989586621683974464"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621683974465"><a href="#local-6989586621683974465"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974466"><a href="#local-6989586621683974466"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974467"><a href="#local-6989586621683974467"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974468"><a href="#local-6989586621683974468"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974469"><a href="#local-6989586621683974469"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683974464"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-245"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974463"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974469"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-246"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974470"><a href="#local-6989586621683974470"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974471"><a href="#local-6989586621683974471"><span class="hs-identifier">anns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyVarsP"><span class="hs-identifier hs-var">checkTyVarsP</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">)</span><span> </span><a href="RdrHsSyn.html#equalsDots"><span class="hs-identifier hs-var">equalsDots</span></a><span> </span><a href="#local-6989586621683974466"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683974467"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-247"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974463"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974471"><span class="hs-identifier hs-var">anns</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-248"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974463"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SynDecl"><span class="hs-identifier hs-var">SynDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdSExt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-249"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974466"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974470"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-250"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974468"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-251"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974465"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-identifier">mkTyFamInstEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-254"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-255"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-256"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstEqn"><span class="hs-identifier hs-type">TyFamInstEqn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><a name="mkTyFamInstEqn"><a href="RdrHsSyn.html#mkTyFamInstEqn"><span class="hs-identifier">mkTyFamInstEqn</span></a></a><span> </span><a name="local-6989586621683974472"><a href="#local-6989586621683974472"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621683974473"><a href="#local-6989586621683974473"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621683974474"><a href="#local-6989586621683974474"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-258"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974475"><a href="#local-6989586621683974475"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974476"><a href="#local-6989586621683974476"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974477"><a href="#local-6989586621683974477"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974478"><a href="#local-6989586621683974478"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683974473"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-259"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span>
</span><a name="line-260"></a><span>                  </span><span class="hs-special">(</span><a href="HsDecls.html#FamEqn"><span class="hs-identifier hs-var">FamEqn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-261"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974475"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-262"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974472"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-263"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974476"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-264"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974477"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-265"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974474"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-266"></a><span>                 </span><a href="#local-6989586621683974478"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-identifier">mkDataFamInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-269"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a><span>
</span><a name="line-270"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsDeriving"><span class="hs-identifier hs-type">HsDeriving</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-276"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><a name="mkDataFamInst"><a href="RdrHsSyn.html#mkDataFamInst"><span class="hs-identifier">mkDataFamInst</span></a></a><span> </span><a name="local-6989586621683974479"><a href="#local-6989586621683974479"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974480"><a href="#local-6989586621683974480"><span class="hs-identifier">new_or_data</span></a></a><span> </span><a name="local-6989586621683974481"><a href="#local-6989586621683974481"><span class="hs-identifier">cType</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683974482"><a href="#local-6989586621683974482"><span class="hs-identifier">mcxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974483"><a href="#local-6989586621683974483"><span class="hs-identifier">bndrs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974484"><a href="#local-6989586621683974484"><span class="hs-identifier">tycl_hdr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>              </span><a name="local-6989586621683974485"><a href="#local-6989586621683974485"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621683974486"><a href="#local-6989586621683974486"><span class="hs-identifier">data_cons</span></a></a><span> </span><a name="local-6989586621683974487"><a href="#local-6989586621683974487"><span class="hs-identifier">maybe_deriv</span></a></a><span>
</span><a name="line-279"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974488"><a href="#local-6989586621683974488"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974489"><a href="#local-6989586621683974489"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974490"><a href="#local-6989586621683974490"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974491"><a href="#local-6989586621683974491"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683974484"><span class="hs-identifier hs-var">tycl_hdr</span></a><span>
</span><a name="line-280"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683974492"><a href="#local-6989586621683974492"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974492"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621683974479"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974491"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-281"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621683974493"><a href="#local-6989586621683974493"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#mkDataDefn"><span class="hs-identifier hs-var">mkDataDefn</span></a><span> </span><a href="#local-6989586621683974480"><span class="hs-identifier hs-var">new_or_data</span></a><span> </span><a href="#local-6989586621683974481"><span class="hs-identifier hs-var">cType</span></a><span> </span><a href="#local-6989586621683974482"><span class="hs-identifier hs-var">mcxt</span></a><span> </span><a href="#local-6989586621683974485"><span class="hs-identifier hs-var">ksig</span></a><span> </span><a href="#local-6989586621683974486"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><a href="#local-6989586621683974487"><span class="hs-identifier hs-var">maybe_deriv</span></a><span>
</span><a name="line-282"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974479"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstD"><span class="hs-identifier hs-var">DataFamInstD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-var">DataFamInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span>
</span><a name="line-283"></a><span>                  </span><span class="hs-special">(</span><a href="HsDecls.html#FamEqn"><span class="hs-identifier hs-var">FamEqn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-284"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_tycon</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974488"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-285"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_bndrs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974483"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-286"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_pats</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974489"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-287"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974490"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-288"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">feqn_rhs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974493"><span class="hs-identifier hs-var">defn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-identifier">mkTyFamInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-291"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#TyFamInstEqn"><span class="hs-identifier hs-type">TyFamInstEqn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-292"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><a name="mkTyFamInst"><a href="RdrHsSyn.html#mkTyFamInst"><span class="hs-identifier">mkTyFamInst</span></a></a><span> </span><a name="local-6989586621683974494"><a href="#local-6989586621683974494"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974495"><a href="#local-6989586621683974495"><span class="hs-identifier">eqn</span></a></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974494"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstD"><span class="hs-identifier hs-var">TyFamInstD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstDecl"><span class="hs-identifier hs-var">TyFamInstDecl</span></a><span> </span><a href="#local-6989586621683974495"><span class="hs-identifier hs-var">eqn</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-identifier">mkFamDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-297"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#FamilyInfo"><span class="hs-identifier hs-type">FamilyInfo</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-298"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>                   </span><span class="hs-comment">-- LHS</span><span>
</span><a name="line-299"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamilyResultSig"><span class="hs-identifier hs-type">FamilyResultSig</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Optional result signature</span><span>
</span><a name="line-300"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LInjectivityAnn"><span class="hs-identifier hs-type">LInjectivityAnn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Injectivity annotation</span><span>
</span><a name="line-301"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-302"></a><a name="mkFamDecl"><a href="RdrHsSyn.html#mkFamDecl"><span class="hs-identifier">mkFamDecl</span></a></a><span> </span><a name="local-6989586621683974496"><a href="#local-6989586621683974496"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974497"><a href="#local-6989586621683974497"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621683974498"><a href="#local-6989586621683974498"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621683974499"><a href="#local-6989586621683974499"><span class="hs-identifier">ksig</span></a></a><span> </span><a name="local-6989586621683974500"><a href="#local-6989586621683974500"><span class="hs-identifier">injAnn</span></a></a><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974502"><a href="#local-6989586621683974502"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974503"><a href="#local-6989586621683974503"><span class="hs-identifier">tparams</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974504"><a href="#local-6989586621683974504"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974505"><a href="#local-6989586621683974505"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier hs-var">checkTyClHdr</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683974498"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-304"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974496"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974505"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-305"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974506"><a href="#local-6989586621683974506"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974507"><a href="#local-6989586621683974507"><span class="hs-identifier">anns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkTyVarsP"><span class="hs-identifier hs-var">checkTyVarsP</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974497"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974501"><span class="hs-identifier hs-var">equals_or_where</span></a><span> </span><a href="#local-6989586621683974502"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683974503"><span class="hs-identifier hs-var">tparams</span></a><span>
</span><a name="line-306"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683974496"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974507"><span class="hs-identifier hs-var">anns</span></a><span> </span><span class="hs-comment">-- Add any API Annotations to the top SrcSpan</span><span>
</span><a name="line-307"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974496"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamDecl"><span class="hs-identifier hs-var">FamDecl</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamilyDecl"><span class="hs-identifier hs-var">FamilyDecl</span></a><span>
</span><a name="line-308"></a><span>                                           </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdExt</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-309"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdInfo</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974497"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974502"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-310"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdTyVars</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974506"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-311"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdFixity</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974504"><span class="hs-identifier hs-var">fixity</span></a><span>
</span><a name="line-312"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdResultSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974499"><span class="hs-identifier hs-var">ksig</span></a><span>
</span><a name="line-313"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fdInjectivityAnn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974500"><span class="hs-identifier hs-var">injAnn</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-315"></a><span>    </span><a name="local-6989586621683974501"><a href="#local-6989586621683974501"><span class="hs-identifier">equals_or_where</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974497"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-316"></a><span>                        </span><a href="HsDecls.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-317"></a><span>                        </span><a href="HsDecls.html#OpenTypeFamily"><span class="hs-identifier hs-var">OpenTypeFamily</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-318"></a><span>                        </span><a href="HsDecls.html#ClosedTypeFamily"><span class="hs-identifier hs-var">ClosedTypeFamily</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#whereDots"><span class="hs-identifier hs-var">whereDots</span></a><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-identifier">mkSpliceDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsDecl"><span class="hs-identifier hs-type">HsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- If the user wrote</span><span>
</span><a name="line-322"></a><span class="hs-comment">--      [pads| ... ]   then return a QuasiQuoteD</span><span>
</span><a name="line-323"></a><span class="hs-comment">--      $(e)           then return a SpliceD</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- but if she wrote, say,</span><span>
</span><a name="line-325"></a><span class="hs-comment">--      f x            then behave as if she'd written $(f x)</span><span>
</span><a name="line-326"></a><span class="hs-comment">--                     ie a SpliceD</span><span>
</span><a name="line-327"></a><span class="hs-comment">--</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- Typed splices are not allowed at the top level, thus we do not represent them</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- as spliced declaration.  See #10945</span><span>
</span><a name="line-330"></a><a name="mkSpliceDecl"><a href="RdrHsSyn.html#mkSpliceDecl"><span class="hs-identifier">mkSpliceDecl</span></a></a><span> </span><a name="local-6989586621683974508"><a href="#local-6989586621683974508"><span class="hs-identifier">lexpr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974509"><a href="#local-6989586621683974509"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974510"><a href="#local-6989586621683974510"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974511"><a href="#local-6989586621683974511"><span class="hs-identifier">splice</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsUntypedSplice"><span class="hs-identifier hs-var">HsUntypedSplice</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974510"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#SpliceD"><span class="hs-identifier hs-var">SpliceD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SpliceDecl"><span class="hs-identifier hs-var">SpliceDecl</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974509"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974511"><span class="hs-identifier hs-var">splice</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#ExplicitSplice"><span class="hs-identifier hs-var">ExplicitSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974512"><a href="#local-6989586621683974512"><span class="hs-identifier">splice</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsQuasiQuote"><span class="hs-identifier hs-var">HsQuasiQuote</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974510"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-335"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#SpliceD"><span class="hs-identifier hs-var">SpliceD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SpliceDecl"><span class="hs-identifier hs-var">SpliceDecl</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974509"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974512"><span class="hs-identifier hs-var">splice</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#ExplicitSplice"><span class="hs-identifier hs-var">ExplicitSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-338"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#SpliceD"><span class="hs-identifier hs-var">SpliceD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SpliceDecl"><span class="hs-identifier hs-var">SpliceDecl</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974509"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier hs-var">mkUntypedSplice</span></a><span> </span><a href="HsExpr.html#NoParens"><span class="hs-identifier hs-var">NoParens</span></a><span> </span><a href="#local-6989586621683974508"><span class="hs-identifier hs-var">lexpr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>                              </span><a href="BasicTypes.html#ImplicitSplice"><span class="hs-identifier hs-var">ImplicitSplice</span></a><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-identifier">mkRoleAnnotDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-342"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>                </span><span class="hs-comment">-- type being annotated</span><span>
</span><a name="line-343"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- roles</span><span>
</span><a name="line-344"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LRoleAnnotDecl"><span class="hs-identifier hs-type">LRoleAnnotDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><a name="mkRoleAnnotDecl"><a href="RdrHsSyn.html#mkRoleAnnotDecl"><span class="hs-identifier">mkRoleAnnotDecl</span></a></a><span> </span><a name="local-6989586621683974513"><a href="#local-6989586621683974513"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974514"><a href="#local-6989586621683974514"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621683974515"><a href="#local-6989586621683974515"><span class="hs-identifier">roles</span></a></a><span>
</span><a name="line-346"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683974529"><a href="#local-6989586621683974529"><span class="hs-identifier">roles'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621683974519"><span class="hs-identifier hs-var">parse_role</span></a><span> </span><a href="#local-6989586621683974515"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-347"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974513"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsDecls.html#RoleAnnotDecl"><span class="hs-identifier hs-var">RoleAnnotDecl</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974514"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-6989586621683974529"><span class="hs-identifier hs-var">roles'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-349"></a><span>    </span><a name="local-6989586621683974516"><a href="#local-6989586621683974516"><span class="hs-identifier">role_data_type</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dataTypeOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>    </span><a name="local-6989586621683974517"><a href="#local-6989586621683974517"><span class="hs-identifier">all_roles</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fromConstr</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">dataTypeConstrs</span><span> </span><a href="#local-6989586621683974516"><span class="hs-identifier hs-var">role_data_type</span></a><span>
</span><a name="line-351"></a><span>    </span><a name="local-6989586621683974518"><a href="#local-6989586621683974518"><span class="hs-identifier">possible_roles</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoAxiom.html#fsFromRole"><span class="hs-identifier hs-var">fsFromRole</span></a><span> </span><span class="hs-keyword">role</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">role</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974517"><span class="hs-identifier hs-var">all_roles</span></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span>    </span><a name="local-6989586621683974519"><a href="#local-6989586621683974519"><span class="hs-identifier">parse_role</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974522"><a href="#local-6989586621683974522"><span class="hs-identifier">loc_role</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974522"><span class="hs-identifier hs-var">loc_role</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-354"></a><span>    </span><span class="hs-identifier">parse_role</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974523"><a href="#local-6989586621683974523"><span class="hs-identifier">loc_role</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-keyword">role</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-keyword">role</span><span> </span><a href="#local-6989586621683974518"><span class="hs-identifier hs-var">possible_roles</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-356"></a><span>          </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974525"><a href="#local-6989586621683974525"><span class="hs-identifier">found_role</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974523"><span class="hs-identifier hs-var">loc_role</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621683974525"><span class="hs-identifier hs-var">found_role</span></a><span>
</span><a name="line-357"></a><span>          </span><span class="hs-identifier hs-var">Nothing</span><span>         </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-358"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974526"><a href="#local-6989586621683974526"><span class="hs-identifier">nearby</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#fuzzyLookup"><span class="hs-identifier hs-var">fuzzyLookup</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><span class="hs-keyword">role</span><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>                  </span><span class="hs-special">(</span><a href="Util.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-6989586621683974518"><span class="hs-identifier hs-var">possible_roles</span></a><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>            </span><span class="hs-keyword">in</span><span>
</span><a name="line-361"></a><span>            </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974523"><span class="hs-identifier hs-var">loc_role</span></a><span>
</span><a name="line-362"></a><span>              </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal role name&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-keyword">role</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-363"></a><span>               </span><a href="#local-6989586621683974520"><span class="hs-identifier hs-var">suggestions</span></a><span> </span><a href="#local-6989586621683974526"><span class="hs-identifier hs-var">nearby</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>    </span><span class="hs-identifier">parse_role</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;parse_role: Impossible Match&quot;</span><span>
</span><a name="line-365"></a><span>                                </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span>    </span><a name="local-6989586621683974520"><a href="#local-6989586621683974520"><span class="hs-identifier">suggestions</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-368"></a><span>    </span><span class="hs-identifier">suggestions</span><span> </span><span class="hs-special">[</span><a name="local-6989586621683974527"><a href="#local-6989586621683974527"><span class="hs-identifier">r</span></a></a><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you meant&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974527"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>      </span><span class="hs-comment">-- will this last case ever happen??</span><span>
</span><a name="line-370"></a><span>    </span><span class="hs-identifier">suggestions</span><span> </span><a name="local-6989586621683974528"><a href="#local-6989586621683974528"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you meant one of these:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>                       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974528"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span class="hs-comment">{- **********************************************************************

  #cvBinds-etc# Converting to @HsBinds@, etc.

  ********************************************************************* -}</span><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-comment">-- | Function definitions are restructured here. Each is assumed to be recursive</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- initially, and non recursive definitions are discovered by the dependency</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- analyser.</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span class="hs-comment">--  | Groups together bindings for a single function</span><span>
</span><a name="line-385"></a><span class="hs-identifier">cvTopDecls</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-386"></a><a name="cvTopDecls"><a href="RdrHsSyn.html#cvTopDecls"><span class="hs-identifier">cvTopDecls</span></a></a><span> </span><a name="local-6989586621683974530"><a href="#local-6989586621683974530"><span class="hs-identifier">decls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974531"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="OrdList.html#fromOL"><span class="hs-identifier hs-var">fromOL</span></a><span> </span><a href="#local-6989586621683974530"><span class="hs-identifier hs-var">decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-389"></a><span>    </span><a name="local-6989586621683974531"><a href="#local-6989586621683974531"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-390"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974532"><a href="#local-6989586621683974532"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ValD"><span class="hs-identifier hs-var">ValD</span></a><span> </span><a name="local-6989586621683974533"><a href="#local-6989586621683974533"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683974534"><a href="#local-6989586621683974534"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974535"><a href="#local-6989586621683974535"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974536"><span class="hs-identifier hs-var">l'</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ValD"><span class="hs-identifier hs-var">ValD</span></a><span> </span><a href="#local-6989586621683974533"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683974537"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974531"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974538"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-392"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974536"><a href="#local-6989586621683974536"><span class="hs-identifier">l'</span></a></a><span> </span><a name="local-6989586621683974537"><a href="#local-6989586621683974537"><span class="hs-identifier">b'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974538"><a href="#local-6989586621683974538"><span class="hs-identifier">ds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#getMonoBind"><span class="hs-identifier hs-var">getMonoBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974532"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974534"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974535"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-393"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974539"><a href="#local-6989586621683974539"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974540"><a href="#local-6989586621683974540"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974539"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974531"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974540"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- Declaration list may only contain value bindings and signatures.</span><span>
</span><a name="line-396"></a><span class="hs-identifier">cvBindGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><a name="cvBindGroup"><a href="RdrHsSyn.html#cvBindGroup"><span class="hs-identifier">cvBindGroup</span></a></a><span> </span><a name="local-6989586621683974541"><a href="#local-6989586621683974541"><span class="hs-identifier">binding</span></a></a><span>
</span><a name="line-398"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974542"><a href="#local-6989586621683974542"><span class="hs-identifier">mbs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974543"><a href="#local-6989586621683974543"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974544"><a href="#local-6989586621683974544"><span class="hs-identifier">fam_ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974545"><a href="#local-6989586621683974545"><span class="hs-identifier">tfam_insts</span></a></a><span>
</span><a name="line-399"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="local-6989586621683974546"><a href="#local-6989586621683974546"><span class="hs-identifier">dfam_insts</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#cvBindsAndSigs"><span class="hs-identifier hs-var">cvBindsAndSigs</span></a><span> </span><a href="#local-6989586621683974541"><span class="hs-identifier hs-var">binding</span></a><span>
</span><a name="line-400"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">fam_ds</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">tfam_insts</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621683974545"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">dfam_insts</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsBinds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974542"><span class="hs-identifier hs-var">mbs</span></a><span> </span><a href="#local-6989586621683974543"><span class="hs-identifier hs-var">sigs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-identifier">cvBindsAndSigs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LFamilyDecl"><span class="hs-identifier hs-type">LFamilyDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-405"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LTyFamInstDecl"><span class="hs-identifier hs-type">LTyFamInstDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LDataFamInstDecl"><span class="hs-identifier hs-type">LDataFamInstDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LDocDecl"><span class="hs-identifier hs-type">LDocDecl</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span class="hs-comment">-- Input decls contain just value bindings and signatures</span><span>
</span><a name="line-407"></a><span class="hs-comment">-- and in case of class or instance declarations also</span><span>
</span><a name="line-408"></a><span class="hs-comment">-- associated type declarations. They might also contain Haddock comments.</span><span>
</span><a name="line-409"></a><a name="cvBindsAndSigs"><a href="RdrHsSyn.html#cvBindsAndSigs"><span class="hs-identifier">cvBindsAndSigs</span></a></a><span> </span><a name="local-6989586621683974547"><a href="#local-6989586621683974547"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974548"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="OrdList.html#fromOL"><span class="hs-identifier hs-var">fromOL</span></a><span> </span><a href="#local-6989586621683974547"><span class="hs-identifier hs-var">fb</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-411"></a><span>    </span><a name="local-6989586621683974548"><a href="#local-6989586621683974548"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974549"><a href="#local-6989586621683974549"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ValD"><span class="hs-identifier hs-var">ValD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974550"><a href="#local-6989586621683974550"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974551"><a href="#local-6989586621683974551"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974554"><a href="#local-6989586621683974554"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974555"><a href="#local-6989586621683974555"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974556"><a href="#local-6989586621683974556"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974557"><a href="#local-6989586621683974557"><span class="hs-identifier">tfis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974558"><a href="#local-6989586621683974558"><span class="hs-identifier">dfis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974559"><a href="#local-6989586621683974559"><span class="hs-identifier">docs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974548"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974553"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-414"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974552"><span class="hs-identifier hs-var">b'</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683974554"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974555"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974556"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974557"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974558"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974559"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-415"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-416"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621683974552"><a href="#local-6989586621683974552"><span class="hs-identifier">b'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974553"><a href="#local-6989586621683974553"><span class="hs-identifier">ds'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#getMonoBind"><span class="hs-identifier hs-var">getMonoBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974549"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974550"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974551"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-417"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974560"><a href="#local-6989586621683974560"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974561"><a href="#local-6989586621683974561"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974562"><a href="#local-6989586621683974562"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974563"><a href="#local-6989586621683974563"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974564"><a href="#local-6989586621683974564"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974565"><a href="#local-6989586621683974565"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974566"><a href="#local-6989586621683974566"><span class="hs-identifier">tfis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974567"><a href="#local-6989586621683974567"><span class="hs-identifier">dfis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974568"><a href="#local-6989586621683974568"><span class="hs-identifier">docs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974548"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974562"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-419"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974561"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-420"></a><span>               </span><a href="HsDecls.html#SigD"><span class="hs-identifier hs-var">SigD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974569"><a href="#local-6989586621683974569"><span class="hs-identifier">s</span></a></a><span>
</span><a name="line-421"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974563"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974569"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974564"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974565"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974566"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974567"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974568"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>               </span><a href="HsDecls.html#TyClD"><span class="hs-identifier hs-var">TyClD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamDecl"><span class="hs-identifier hs-var">FamDecl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974570"><a href="#local-6989586621683974570"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974563"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974564"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974570"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974565"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974566"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974567"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974568"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>               </span><a href="HsDecls.html#InstD"><span class="hs-identifier hs-var">InstD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstD"><span class="hs-identifier hs-var">TyFamInstD</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974571"><a href="#local-6989586621683974571"><span class="hs-identifier">tfi</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974563"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974564"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974565"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974571"><span class="hs-identifier hs-var">tfi</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974566"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974567"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974568"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>               </span><a href="HsDecls.html#InstD"><span class="hs-identifier hs-var">InstD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstD"><span class="hs-identifier hs-var">DataFamInstD</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974572"><a href="#local-6989586621683974572"><span class="hs-identifier">dfi</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974563"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974564"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974565"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974566"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974572"><span class="hs-identifier hs-var">dfi</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974567"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974568"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>               </span><a href="HsDecls.html#DocD"><span class="hs-identifier hs-var">DocD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974573"><a href="#local-6989586621683974573"><span class="hs-identifier">d</span></a></a><span>
</span><a name="line-429"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974563"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974564"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974565"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974566"><span class="hs-identifier hs-var">tfis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974567"><span class="hs-identifier hs-var">dfis</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974573"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974568"><span class="hs-identifier hs-var">docs</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>               </span><a href="HsDecls.html#SpliceD"><span class="hs-identifier hs-var">SpliceD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974574"><a href="#local-6989586621683974574"><span class="hs-identifier">d</span></a></a><span>
</span><a name="line-431"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974560"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-432"></a><span>                    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Declaration splices are allowed only&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-433"></a><span>                          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at the top level:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>                       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974574"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;cvBindsAndSigs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974561"><span class="hs-identifier hs-var">decl</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-438"></a><span class="hs-comment">-- Group function bindings into equation groups</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-identifier">getMonoBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- Suppose      (b',ds') = getMonoBind b ds</span><span>
</span><a name="line-443"></a><span class="hs-comment">--      ds is a list of parsed bindings</span><span>
</span><a name="line-444"></a><span class="hs-comment">--      b is a MonoBinds that has just been read off the front</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- Then b' is the result of grouping more equations from ds that</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- belong with b into a single MonoBinds, and ds' is the depleted</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- list of parsed bindings.</span><span>
</span><a name="line-449"></a><span class="hs-comment">--</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- All Haddock comments between equations inside the group are</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- discarded.</span><span>
</span><a name="line-452"></a><span class="hs-comment">--</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- No AndMonoBinds or EmptyMonoBinds here; just single equations</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><a name="getMonoBind"><a href="RdrHsSyn.html#getMonoBind"><span class="hs-identifier">getMonoBind</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974575"><a href="#local-6989586621683974575"><span class="hs-identifier">loc1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974576"><a href="#local-6989586621683974576"><span class="hs-identifier">fun_id1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974577"><a href="#local-6989586621683974577"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-456"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-457"></a><span>                                   </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974578"><a href="#local-6989586621683974578"><span class="hs-identifier">mtchs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>            </span><a name="local-6989586621683974579"><a href="#local-6989586621683974579"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrHsSyn.html#has_args"><span class="hs-identifier hs-var">has_args</span></a><span> </span><a href="#local-6989586621683974578"><span class="hs-identifier hs-var">mtchs1</span></a><span>
</span><a name="line-460"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974580"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974578"><span class="hs-identifier hs-var">mtchs1</span></a><span> </span><a href="#local-6989586621683974575"><span class="hs-identifier hs-var">loc1</span></a><span> </span><a href="#local-6989586621683974579"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-461"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-462"></a><span>    </span><a name="local-6989586621683974580"><a href="#local-6989586621683974580"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683974581"><a href="#local-6989586621683974581"><span class="hs-identifier">mtchs</span></a></a><span> </span><a name="local-6989586621683974582"><a href="#local-6989586621683974582"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-463"></a><span>       </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974583"><a href="#local-6989586621683974583"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ValD"><span class="hs-identifier hs-var">ValD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974584"><a href="#local-6989586621683974584"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-465"></a><span>                                        </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974585"><a href="#local-6989586621683974585"><span class="hs-identifier">mtchs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>         </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974586"><a href="#local-6989586621683974586"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-467"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974577"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621683974584"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974580"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974585"><span class="hs-identifier hs-var">mtchs2</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683974581"><span class="hs-identifier hs-var">mtchs</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>                        </span><span class="hs-special">(</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683974582"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974583"><span class="hs-identifier hs-var">loc2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974586"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-469"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974587"><a href="#local-6989586621683974587"><span class="hs-identifier">mtchs</span></a></a><span> </span><a name="local-6989586621683974588"><a href="#local-6989586621683974588"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683974589"><a href="#local-6989586621683974589"><span class="hs-identifier">doc_decl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974590"><a href="#local-6989586621683974590"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DocD"><span class="hs-identifier hs-var">DocD</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683974591"><a href="#local-6989586621683974591"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974592"><a href="#local-6989586621683974592"><span class="hs-identifier">doc_decls</span></a></a><span>
</span><a name="line-470"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974593"><a href="#local-6989586621683974593"><span class="hs-identifier">doc_decls'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974589"><span class="hs-identifier hs-var">doc_decl</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974592"><span class="hs-identifier hs-var">doc_decls</span></a><span>
</span><a name="line-471"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621683974580"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974587"><span class="hs-identifier hs-var">mtchs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683974588"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974590"><span class="hs-identifier hs-var">loc2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974591"><span class="hs-identifier hs-var">binds</span></a><span> </span><a href="#local-6989586621683974593"><span class="hs-identifier hs-var">doc_decls'</span></a><span>
</span><a name="line-472"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974594"><a href="#local-6989586621683974594"><span class="hs-identifier">mtchs</span></a></a><span> </span><a name="local-6989586621683974595"><a href="#local-6989586621683974595"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974596"><a href="#local-6989586621683974596"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621683974597"><a href="#local-6989586621683974597"><span class="hs-identifier">doc_decls</span></a></a><span>
</span><a name="line-473"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974595"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#makeFunBind"><span class="hs-identifier hs-var">makeFunBind</span></a><span> </span><a href="#local-6989586621683974576"><span class="hs-identifier hs-var">fun_id1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621683974594"><span class="hs-identifier hs-var">mtchs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621683974597"><span class="hs-identifier hs-var">doc_decls</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683974596"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-comment">-- Reverse the final matches, to get it back in the right order</span><span>
</span><a name="line-476"></a><span>        </span><span class="hs-comment">-- Do the same thing with the trailing doc comments</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span class="hs-identifier">getMonoBind</span><span> </span><a name="local-6989586621683974598"><a href="#local-6989586621683974598"><span class="hs-identifier">bind</span></a></a><span> </span><a name="local-6989586621683974599"><a href="#local-6989586621683974599"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974598"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974599"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-identifier">has_args</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-481"></a><a name="has_args"><a href="RdrHsSyn.html#has_args"><span class="hs-identifier">has_args</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                                    </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;RdrHsSyn:has_args&quot;</span><span>
</span><a name="line-482"></a><span class="hs-identifier">has_args</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974600"><a href="#local-6989586621683974600"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683974600"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>        </span><span class="hs-comment">-- Don't group together FunBinds if they have</span><span>
</span><a name="line-484"></a><span>        </span><span class="hs-comment">-- no arguments.  This is necessary now that variable bindings</span><span>
</span><a name="line-485"></a><span>        </span><span class="hs-comment">-- with no arguments are now treated as FunBinds rather</span><span>
</span><a name="line-486"></a><span>        </span><span class="hs-comment">-- than pattern bindings (tests/rename/should_fail/rnfail002).</span><span>
</span><a name="line-487"></a><span class="hs-identifier">has_args</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XMatch"><span class="hs-identifier hs-var">XMatch</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;has_args&quot;</span><span>
</span><a name="line-488"></a><span class="hs-identifier">has_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;has_args:Impossible Match&quot;</span><span> </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-comment">{- **********************************************************************

  #PrefixToHS-utils# Utilities for conversion

  ********************************************************************* -}</span><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-comment">{- Note [Parsing data constructors is hard]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The problem with parsing data constructors is that they look a lot like types.
Compare:

  (s1)   data T = C t1 t2
  (s2)   type T = C t1 t2

Syntactically, there's little difference between these declarations, except in
(s1) 'C' is a data constructor, but in (s2) 'C' is a type constructor.

This similarity would pose no problem if we knew ahead of time if we are
parsing a type or a constructor declaration. Looking at (s1) and (s2), a simple
(but wrong!) rule comes to mind: in 'data' declarations assume we are parsing
data constructors, and in other contexts (e.g. 'type' declarations) assume we
are parsing type constructors.

This simple rule does not work because of two problematic cases:

  (p1)   data T = C t1 t2 :+ t3
  (p2)   data T = C t1 t2 =&gt; t3

In (p1) we encounter (:+) and it turns out we are parsing an infix data
declaration, so (C t1 t2) is a type and 'C' is a type constructor.
In (p2) we encounter (=&gt;) and it turns out we are parsing an existential
context, so (C t1 t2) is a constraint and 'C' is a type constructor.

As the result, in order to determine whether (C t1 t2) declares a data
constructor, a type, or a context, we would need unlimited lookahead which
'happy' is not so happy with.

To further complicate matters, the interpretation of (!) and (~) is different
in constructors and types:

  (b1)   type T = C ! D
  (b2)   data T = C ! D
  (b3)   data T = C ! D =&gt; E

In (b1) and (b3), (!) is a type operator with two arguments: 'C' and 'D'. At
the same time, in (b2) it is a strictness annotation: 'C' is a data constructor
with a single strict argument 'D'. For the programmer, these cases are usually
easy to tell apart due to whitespace conventions:

  (b2)   data T = C !D         -- no space after the bang hints that
                               -- it is a strictness annotation

For the parser, on the other hand, this whitespace does not matter. We cannot
tell apart (b2) from (b3) until we encounter (=&gt;), so it requires unlimited
lookahead.

The solution that accounts for all of these issues is to initially parse data
declarations and types as a reversed list of TyEl:

  data TyEl = TyElOpr RdrName
            | TyElOpd (HsType GhcPs)
            | TyElBang | TyElTilde
            | ...

For example, both occurences of (C ! D) in the following example are parsed
into equal lists of TyEl:

  data T = C ! D =&gt; C ! D   results in   [ TyElOpd (HsTyVar &quot;D&quot;)
                                         , TyElBang
                                         , TyElOpd (HsTyVar &quot;C&quot;) ]

Note that elements are in reverse order. Also, 'C' is parsed as a type
constructor (HsTyVar) even when it is a data constructor. We fix this in
`tyConToDataCon`.

By the time the list of TyEl is assembled, we have looked ahead enough to
decide whether to reduce using `mergeOps` (for types) or `mergeDataCon` (for
data constructors). These functions are where the actual job of parsing is
done.

-}</span><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span class="hs-comment">-- | Reinterpret a type constructor, including type operators, as a data</span><span>
</span><a name="line-574"></a><span class="hs-comment">--   constructor.</span><span>
</span><a name="line-575"></a><span class="hs-comment">-- See Note [Parsing data constructors is hard]</span><span>
</span><a name="line-576"></a><span class="hs-identifier">tyConToDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-577"></a><a name="tyConToDataCon"><a href="RdrHsSyn.html#tyConToDataCon"><span class="hs-identifier">tyConToDataCon</span></a></a><span> </span><a name="local-6989586621683974601"><a href="#local-6989586621683974601"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974602"><a href="#local-6989586621683974602"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-578"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span> </span><a href="#local-6989586621683974603"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><a href="#local-6989586621683974603"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-579"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lexeme.html#isLexCon"><span class="hs-identifier hs-var">isLexCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-6989586621683974603"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974601"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a><span> </span><a href="#local-6989586621683974602"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="OccName.html#srcDataName"><span class="hs-identifier hs-var">srcDataName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974601"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974604"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-584"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-585"></a><span>    </span><a name="local-6989586621683974603"><a href="#local-6989586621683974603"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621683974602"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-586"></a><span>    </span><a name="local-6989586621683974604"><a href="#local-6989586621683974604"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Not a data constructor:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974602"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>
</span><a name="line-588"></a><span class="hs-identifier">mkPatSynMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-589"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-591"></a><a name="mkPatSynMatchGroup"><a href="RdrHsSyn.html#mkPatSynMatchGroup"><span class="hs-identifier">mkPatSynMatchGroup</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974605"><a href="#local-6989586621683974605"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974606"><a href="#local-6989586621683974606"><span class="hs-identifier">patsyn_name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974607"><a href="#local-6989586621683974607"><span class="hs-identifier">decls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-592"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683974632"><a href="#local-6989586621683974632"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621683974608"><span class="hs-identifier hs-var">fromDecl</span></a><span> </span><span class="hs-special">(</span><a href="OrdList.html#fromOL"><span class="hs-identifier hs-var">fromOL</span></a><span> </span><a href="#local-6989586621683974607"><span class="hs-identifier hs-var">decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-593"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683974632"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974611"><span class="hs-identifier hs-var">wrongNumberErr</span></a><span> </span><a href="#local-6989586621683974605"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#FromSource"><span class="hs-identifier hs-var">FromSource</span></a><span> </span><a href="#local-6989586621683974632"><span class="hs-identifier hs-var">matches</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-595"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-596"></a><span>    </span><a name="local-6989586621683974608"><a href="#local-6989586621683974608"><span class="hs-identifier">fromDecl</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974612"><a href="#local-6989586621683974612"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974613"><a href="#local-6989586621683974613"><span class="hs-identifier">decl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsDecls.html#ValD"><span class="hs-identifier hs-var">ValD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-597"></a><span>                             </span><a name="local-6989586621683974614"><a href="#local-6989586621683974614"><span class="hs-identifier">pat</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-6989586621683974615"><a href="#local-6989586621683974615"><span class="hs-identifier">ln</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974616"><a href="#local-6989586621683974616"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974617"><a href="#local-6989586621683974617"><span class="hs-identifier">details</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>                                   </span><a name="local-6989586621683974618"><a href="#local-6989586621683974618"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-599"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974616"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621683974606"><span class="hs-identifier hs-var">patsyn_name</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-600"></a><span>               </span><a href="#local-6989586621683974610"><span class="hs-identifier hs-var">wrongNameBindingErr</span></a><span> </span><a href="#local-6989586621683974612"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974613"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-601"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621683974624"><a href="#local-6989586621683974624"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974617"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-602"></a><span>               </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-6989586621683974619"><a href="#local-6989586621683974619"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-603"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974620"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974619"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-604"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974618"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-605"></a><span>                   </span><span class="hs-keyword">where</span><span>
</span><a name="line-606"></a><span>                     </span><a name="local-6989586621683974620"><a href="#local-6989586621683974620"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mc_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974615"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-607"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span>
</span><a name="line-608"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_strictness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span>               </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621683974621"><a href="#local-6989586621683974621"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621683974622"><a href="#local-6989586621683974622"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-611"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974623"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-612"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683974621"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974622"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">]</span><span>
</span><a name="line-613"></a><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974618"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-614"></a><span>                   </span><span class="hs-keyword">where</span><span>
</span><a name="line-615"></a><span>                     </span><a name="local-6989586621683974623"><a href="#local-6989586621683974623"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mc_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974615"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-616"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span>
</span><a name="line-617"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_strictness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span>               </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#recordPatSynErr"><span class="hs-identifier hs-var">recordPatSynErr</span></a><span> </span><a href="#local-6989586621683974612"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974614"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-620"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974612"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974624"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-621"></a><span>    </span><span class="hs-identifier">fromDecl</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974625"><a href="#local-6989586621683974625"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974626"><a href="#local-6989586621683974626"><span class="hs-identifier">decl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974609"><span class="hs-identifier hs-var">extraDeclErr</span></a><span> </span><a href="#local-6989586621683974625"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974626"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span>    </span><a name="local-6989586621683974609"><a href="#local-6989586621683974609"><span class="hs-identifier">extraDeclErr</span></a></a><span> </span><a name="local-6989586621683974627"><a href="#local-6989586621683974627"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974628"><a href="#local-6989586621683974628"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-624"></a><span>        </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974627"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-625"></a><span>        </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;pattern synonym 'where' clause must contain a single binding:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-626"></a><span>        </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974628"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span>    </span><a name="local-6989586621683974610"><a href="#local-6989586621683974610"><span class="hs-identifier">wrongNameBindingErr</span></a></a><span> </span><a name="local-6989586621683974629"><a href="#local-6989586621683974629"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974630"><a href="#local-6989586621683974630"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-629"></a><span>      </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974629"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-630"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;pattern synonym 'where' clause must bind the pattern synonym's name&quot;</span><span>
</span><a name="line-631"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974606"><span class="hs-identifier hs-var">patsyn_name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974630"><span class="hs-identifier hs-var">decl</span></a><span>
</span><a name="line-632"></a><span>
</span><a name="line-633"></a><span>    </span><a name="local-6989586621683974611"><a href="#local-6989586621683974611"><span class="hs-identifier">wrongNumberErr</span></a></a><span> </span><a name="local-6989586621683974631"><a href="#local-6989586621683974631"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-634"></a><span>      </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974631"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-635"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;pattern synonym 'where' clause cannot be empty&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-636"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the pattern synonym declaration for: &quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974606"><span class="hs-identifier hs-var">patsyn_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-identifier">recordPatSynErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974404"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-639"></a><a name="recordPatSynErr"><a href="RdrHsSyn.html#recordPatSynErr"><span class="hs-identifier">recordPatSynErr</span></a></a><span> </span><a name="local-6989586621683974633"><a href="#local-6989586621683974633"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974634"><a href="#local-6989586621683974634"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-640"></a><span>    </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974633"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-641"></a><span>    </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;record syntax not supported for pattern synonym declarations:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-642"></a><span>    </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974634"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">mkConDeclH98</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-645"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsConDeclDetails"><span class="hs-identifier hs-type">HsConDeclDetails</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-646"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#ConDecl"><span class="hs-identifier hs-type">ConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><a name="mkConDeclH98"><a href="RdrHsSyn.html#mkConDeclH98"><span class="hs-identifier">mkConDeclH98</span></a></a><span> </span><a name="local-6989586621683974635"><a href="#local-6989586621683974635"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621683974636"><a href="#local-6989586621683974636"><span class="hs-identifier">mb_forall</span></a></a><span> </span><a name="local-6989586621683974637"><a href="#local-6989586621683974637"><span class="hs-identifier">mb_cxt</span></a></a><span> </span><a name="local-6989586621683974638"><a href="#local-6989586621683974638"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-649"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_ext</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-650"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_name</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974635"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-651"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621683974636"><span class="hs-identifier hs-var">mb_forall</span></a><span>
</span><a name="line-652"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974636"><span class="hs-identifier hs-var">mb_forall</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-653"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974637"><span class="hs-identifier hs-var">mb_cxt</span></a><span>
</span><a name="line-654"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974639"><span class="hs-identifier hs-var">args'</span></a><span>
</span><a name="line-655"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_doc</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-656"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-657"></a><span>    </span><a name="local-6989586621683974639"><a href="#local-6989586621683974639"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#nudgeHsSrcBangs"><span class="hs-identifier hs-var">nudgeHsSrcBangs</span></a><span> </span><a href="#local-6989586621683974638"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-identifier">mkGadtDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-660"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>     </span><span class="hs-comment">-- Always a HsForAllTy</span><span>
</span><a name="line-661"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDecl"><span class="hs-identifier hs-type">ConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-662"></a><a name="mkGadtDecl"><a href="RdrHsSyn.html#mkGadtDecl"><span class="hs-identifier">mkGadtDecl</span></a></a><span> </span><a name="local-6989586621683974640"><a href="#local-6989586621683974640"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621683974641"><a href="#local-6989586621683974641"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-663"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclGADT"><span class="hs-identifier hs-var">ConDeclGADT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_g_ext</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-664"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_names</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974640"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-665"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_forall</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974643"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsTypes.html#isLHsForAllTy"><span class="hs-identifier hs-var">isLHsForAllTy</span></a><span> </span><a href="#local-6989586621683974642"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-666"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_qvars</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsQTvs"><span class="hs-identifier hs-var">mkHsQTvs</span></a><span> </span><a href="#local-6989586621683974645"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-667"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974647"><span class="hs-identifier hs-var">mcxt</span></a><span>
</span><a name="line-668"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974653"><span class="hs-identifier hs-var">args'</span></a><span>
</span><a name="line-669"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974652"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-670"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_doc</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-671"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974644"><span class="hs-identifier hs-var">anns1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683974649"><span class="hs-identifier hs-var">anns2</span></a><span class="hs-special">)</span><span>
</span><a name="line-672"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-673"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683974642"><a href="#local-6989586621683974642"><span class="hs-identifier">ty'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974643"><a href="#local-6989586621683974643"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621683974644"><a href="#local-6989586621683974644"><span class="hs-identifier">anns1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974655"><span class="hs-identifier hs-var">peel_parens</span></a><span> </span><a href="#local-6989586621683974641"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-674"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683974645"><a href="#local-6989586621683974645"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974646"><a href="#local-6989586621683974646"><span class="hs-identifier">rho</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#splitLHsForAllTy"><span class="hs-identifier hs-var">splitLHsForAllTy</span></a><span> </span><a href="#local-6989586621683974642"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-675"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683974647"><a href="#local-6989586621683974647"><span class="hs-identifier">mcxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974648"><a href="#local-6989586621683974648"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974649"><a href="#local-6989586621683974649"><span class="hs-identifier">anns2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974650"><span class="hs-identifier hs-var">split_rho</span></a><span> </span><a href="#local-6989586621683974646"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span>    </span><a name="local-6989586621683974650"><a href="#local-6989586621683974650"><span class="hs-identifier">split_rho</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974656"><a href="#local-6989586621683974656"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974657"><a href="#local-6989586621683974657"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974658"><a href="#local-6989586621683974658"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-678"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621683974656"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974657"><span class="hs-identifier hs-var">tau</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974658"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span>    </span><span class="hs-identifier">split_rho</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974659"><a href="#local-6989586621683974659"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974660"><a href="#local-6989586621683974660"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974661"><a href="#local-6989586621683974661"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-680"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974650"><span class="hs-identifier hs-var">split_rho</span></a><span> </span><a href="#local-6989586621683974660"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974661"><span class="hs-identifier hs-var">ann</span></a><span class="hs-operator hs-var">++</span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974659"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-681"></a><span>    </span><span class="hs-identifier">split_rho</span><span> </span><a name="local-6989586621683974662"><a href="#local-6989586621683974662"><span class="hs-identifier">tau</span></a></a><span>                  </span><a name="local-6989586621683974663"><a href="#local-6989586621683974663"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-682"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974662"><span class="hs-identifier hs-var">tau</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974663"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>
</span><a name="line-684"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683974651"><a href="#local-6989586621683974651"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974652"><a href="#local-6989586621683974652"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974654"><span class="hs-identifier hs-var">split_tau</span></a><span> </span><a href="#local-6989586621683974648"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-685"></a><span>    </span><a name="local-6989586621683974653"><a href="#local-6989586621683974653"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#nudgeHsSrcBangs"><span class="hs-identifier hs-var">nudgeHsSrcBangs</span></a><span> </span><a href="#local-6989586621683974651"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span>    </span><span class="hs-comment">-- See Note [GADT abstract syntax] in HsDecls</span><span>
</span><a name="line-688"></a><span>    </span><a name="local-6989586621683974654"><a href="#local-6989586621683974654"><span class="hs-identifier">split_tau</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974664"><a href="#local-6989586621683974664"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974665"><a href="#local-6989586621683974665"><span class="hs-identifier">rf</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974666"><a href="#local-6989586621683974666"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974664"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974665"><span class="hs-identifier hs-var">rf</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974666"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>    </span><span class="hs-identifier">split_tau</span><span> </span><a name="local-6989586621683974667"><a href="#local-6989586621683974667"><span class="hs-identifier">tau</span></a></a><span>
</span><a name="line-691"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974667"><span class="hs-identifier hs-var">tau</span></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>
</span><a name="line-693"></a><span>    </span><a name="local-6989586621683974655"><a href="#local-6989586621683974655"><span class="hs-identifier">peel_parens</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974668"><a href="#local-6989586621683974668"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974669"><a href="#local-6989586621683974669"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974670"><a href="#local-6989586621683974670"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974655"><span class="hs-identifier hs-var">peel_parens</span></a><span> </span><a href="#local-6989586621683974669"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-694"></a><span>                                                       </span><span class="hs-special">(</span><a href="#local-6989586621683974670"><span class="hs-identifier hs-var">ann</span></a><span class="hs-operator hs-var">++</span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974668"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>    </span><span class="hs-identifier">peel_parens</span><span> </span><a name="local-6989586621683974671"><a href="#local-6989586621683974671"><span class="hs-identifier">ty</span></a></a><span>                   </span><a name="local-6989586621683974672"><a href="#local-6989586621683974672"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974671"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974672"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-identifier">nudgeHsSrcBangs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsConDeclDetails"><span class="hs-identifier hs-type">HsConDeclDetails</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsConDeclDetails"><span class="hs-identifier hs-type">HsConDeclDetails</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-698"></a><span class="hs-comment">-- ^ This function ensures that fields with strictness or packedness</span><span>
</span><a name="line-699"></a><span class="hs-comment">-- annotations put these annotations on an outer 'HsBangTy'.</span><span>
</span><a name="line-700"></a><span class="hs-comment">--</span><span>
</span><a name="line-701"></a><span class="hs-comment">-- The problem is that in the parser, strictness and packedness annotations</span><span>
</span><a name="line-702"></a><span class="hs-comment">-- bind more tightly that docstrings. However, the expectation downstream of</span><span>
</span><a name="line-703"></a><span class="hs-comment">-- the parser (by functions such as 'getBangType' and 'getBangStrictness')</span><span>
</span><a name="line-704"></a><span class="hs-comment">-- is that docstrings bind more tightly so that 'HsBangTy' may end up as the</span><span>
</span><a name="line-705"></a><span class="hs-comment">-- top-level type.</span><span>
</span><a name="line-706"></a><span class="hs-comment">--</span><span>
</span><a name="line-707"></a><span class="hs-comment">-- See #15206</span><span>
</span><a name="line-708"></a><a name="nudgeHsSrcBangs"><a href="RdrHsSyn.html#nudgeHsSrcBangs"><span class="hs-identifier">nudgeHsSrcBangs</span></a></a><span> </span><a name="local-6989586621683974673"><a href="#local-6989586621683974673"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-709"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974673"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-710"></a><span>      </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683974674"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span>      </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-6989586621683974681"><a href="#local-6989586621683974681"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a href="#local-6989586621683974681"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-712"></a><span>      </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621683974682"><a href="#local-6989586621683974682"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621683974683"><a href="#local-6989586621683974683"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974674"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974682"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974674"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974683"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span>
</span><a name="line-713"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-714"></a><span>    </span><a name="local-6989586621683974674"><a href="#local-6989586621683974674"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974675"><a href="#local-6989586621683974675"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974676"><a href="#local-6989586621683974676"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621683974677"><a href="#local-6989586621683974677"><span class="hs-identifier">lty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974678"><a href="#local-6989586621683974678"><span class="hs-identifier">lds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-715"></a><span>      </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974675"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974676"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621683974677"><span class="hs-identifier hs-var">lty</span></a><span> </span><a href="#local-6989586621683974678"><span class="hs-identifier hs-var">lds</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974677"><span class="hs-identifier hs-var">lty</span></a><span> </span><a href="#local-6989586621683974678"><span class="hs-identifier hs-var">lds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974679"><a href="#local-6989586621683974679"><span class="hs-identifier">lty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974679"><span class="hs-identifier hs-var">lty</span></a><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span>
</span><a name="line-719"></a><span class="hs-identifier">setRdrNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-720"></a><span class="hs-comment">-- ^ This rather gruesome function is used mainly by the parser.</span><span>
</span><a name="line-721"></a><span class="hs-comment">-- When parsing:</span><span>
</span><a name="line-722"></a><span class="hs-comment">--</span><span>
</span><a name="line-723"></a><span class="hs-comment">-- &gt; data T a = T | T1 Int</span><span>
</span><a name="line-724"></a><span class="hs-comment">--</span><span>
</span><a name="line-725"></a><span class="hs-comment">-- we parse the data constructors as /types/ because of parser ambiguities,</span><span>
</span><a name="line-726"></a><span class="hs-comment">-- so then we need to change the /type constr/ to a /data constr/</span><span>
</span><a name="line-727"></a><span class="hs-comment">--</span><span>
</span><a name="line-728"></a><span class="hs-comment">-- The exact-name case /can/ occur when parsing:</span><span>
</span><a name="line-729"></a><span class="hs-comment">--</span><span>
</span><a name="line-730"></a><span class="hs-comment">-- &gt; data [] a = [] | a : [a]</span><span>
</span><a name="line-731"></a><span class="hs-comment">--</span><span>
</span><a name="line-732"></a><span class="hs-comment">-- For the exact-name case we return an original name.</span><span>
</span><a name="line-733"></a><a name="setRdrNameSpace"><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier">setRdrNameSpace</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a name="local-6989586621683974684"><a href="#local-6989586621683974684"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974685"><a href="#local-6989586621683974685"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="#local-6989586621683974685"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621683974684"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-734"></a><span class="hs-identifier">setRdrNameSpace</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#Qual"><span class="hs-identifier hs-var">Qual</span></a><span> </span><a name="local-6989586621683974686"><a href="#local-6989586621683974686"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621683974687"><a href="#local-6989586621683974687"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974688"><a href="#local-6989586621683974688"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Qual"><span class="hs-identifier hs-var">Qual</span></a><span> </span><a href="#local-6989586621683974686"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="#local-6989586621683974688"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621683974687"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-735"></a><span class="hs-identifier">setRdrNameSpace</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#Orig"><span class="hs-identifier hs-var">Orig</span></a><span> </span><a name="local-6989586621683974689"><a href="#local-6989586621683974689"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621683974690"><a href="#local-6989586621683974690"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974691"><a href="#local-6989586621683974691"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Orig"><span class="hs-identifier hs-var">Orig</span></a><span> </span><a href="#local-6989586621683974689"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="#local-6989586621683974691"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621683974690"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span class="hs-identifier">setRdrNameSpace</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><a name="local-6989586621683974692"><a href="#local-6989586621683974692"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-6989586621683974693"><a href="#local-6989586621683974693"><span class="hs-identifier">ns</span></a></a><span>
</span><a name="line-737"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974695"><a href="#local-6989586621683974695"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#wiredInNameTyThing_maybe"><span class="hs-identifier hs-var">wiredInNameTyThing_maybe</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-738"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#setWiredInNameSpace"><span class="hs-identifier hs-var">setWiredInNameSpace</span></a><span> </span><a href="#local-6989586621683974695"><span class="hs-identifier hs-var">thing</span></a><span> </span><a href="#local-6989586621683974693"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-739"></a><span>    </span><span class="hs-comment">-- Preserve Exact Names for wired-in things,</span><span>
</span><a name="line-740"></a><span>    </span><span class="hs-comment">-- notably tuples and lists</span><span>
</span><a name="line-741"></a><span>
</span><a name="line-742"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-743"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Orig"><span class="hs-identifier hs-var">Orig</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974694"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-744"></a><span>
</span><a name="line-745"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-comment">-- This can happen when quoting and then</span><span>
</span><a name="line-746"></a><span>                </span><span class="hs-comment">-- splicing a fixity declaration for a type</span><span>
</span><a name="line-747"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#mkSystemNameAt"><span class="hs-identifier hs-var">mkSystemNameAt</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974694"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-749"></a><span>    </span><a name="local-6989586621683974694"><a href="#local-6989586621683974694"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="#local-6989586621683974693"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621683974692"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><span class="hs-identifier">setWiredInNameSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#NameSpace"><span class="hs-identifier hs-type">NameSpace</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-752"></a><a name="setWiredInNameSpace"><a href="RdrHsSyn.html#setWiredInNameSpace"><span class="hs-identifier">setWiredInNameSpace</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ATyCon"><span class="hs-identifier hs-var">ATyCon</span></a><span> </span><a name="local-6989586621683974696"><a href="#local-6989586621683974696"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974697"><a href="#local-6989586621683974697"><span class="hs-identifier">ns</span></a></a><span>
</span><a name="line-753"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataConNameSpace"><span class="hs-identifier hs-var">isDataConNameSpace</span></a><span> </span><a href="#local-6989586621683974697"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-754"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#ty_con_data_con"><span class="hs-identifier hs-var">ty_con_data_con</span></a><span> </span><a href="#local-6989586621683974696"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-755"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isTcClsNameSpace"><span class="hs-identifier hs-var">isTcClsNameSpace</span></a><span> </span><a href="#local-6989586621683974697"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-756"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621683974696"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- No-op</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-identifier">setWiredInNameSpace</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AConLike"><span class="hs-identifier hs-var">AConLike</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-6989586621683974698"><a href="#local-6989586621683974698"><span class="hs-identifier">dc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974699"><a href="#local-6989586621683974699"><span class="hs-identifier">ns</span></a></a><span>
</span><a name="line-759"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isTcClsNameSpace"><span class="hs-identifier hs-var">isTcClsNameSpace</span></a><span> </span><a href="#local-6989586621683974699"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-760"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#data_con_ty_con"><span class="hs-identifier hs-var">data_con_ty_con</span></a><span> </span><a href="#local-6989586621683974698"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-761"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataConNameSpace"><span class="hs-identifier hs-var">isDataConNameSpace</span></a><span> </span><a href="#local-6989586621683974699"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-762"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621683974698"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- No-op</span><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span class="hs-identifier">setWiredInNameSpace</span><span> </span><a name="local-6989586621683974700"><a href="#local-6989586621683974700"><span class="hs-identifier">thing</span></a></a><span> </span><a name="local-6989586621683974701"><a href="#local-6989586621683974701"><span class="hs-identifier">ns</span></a></a><span>
</span><a name="line-765"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;setWiredinNameSpace&quot;</span><span> </span><span class="hs-special">(</span><a href="OccName.html#pprNameSpace"><span class="hs-identifier hs-var">pprNameSpace</span></a><span> </span><a href="#local-6989586621683974701"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974700"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span class="hs-identifier">ty_con_data_con</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-768"></a><a name="ty_con_data_con"><a href="RdrHsSyn.html#ty_con_data_con"><span class="hs-identifier">ty_con_data_con</span></a></a><span> </span><a name="local-6989586621683974702"><a href="#local-6989586621683974702"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-769"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-6989586621683974702"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-770"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974703"><a href="#local-6989586621683974703"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleDataCon_maybe</span></a><span> </span><a href="#local-6989586621683974702"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-771"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621683974703"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974702"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#listTyConKey"><span class="hs-identifier hs-var">listTyConKey</span></a><span>
</span><a name="line-774"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><a href="TysWiredIn.html#nilDataConName"><span class="hs-identifier hs-var">nilDataConName</span></a><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-comment">-- See Note [setRdrNameSpace for wired-in names]</span><span>
</span><a name="line-777"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="OccName.html#srcDataName"><span class="hs-identifier hs-var">srcDataName</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-6989586621683974702"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span class="hs-identifier">data_con_ty_con</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-780"></a><a name="data_con_ty_con"><a href="RdrHsSyn.html#data_con_ty_con"><span class="hs-identifier">data_con_ty_con</span></a></a><span> </span><a name="local-6989586621683974704"><a href="#local-6989586621683974704"><span class="hs-identifier">dc</span></a></a><span>
</span><a name="line-781"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974705"><a href="#local-6989586621683974705"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-6989586621683974704"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-782"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-6989586621683974705"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-783"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621683974705"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>
</span><a name="line-785"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974704"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#nilDataConKey"><span class="hs-identifier hs-var">nilDataConKey</span></a><span>
</span><a name="line-786"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><a href="TysWiredIn.html#listTyConName"><span class="hs-identifier hs-var">listTyConName</span></a><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-comment">-- See Note [setRdrNameSpace for wired-in names]</span><span>
</span><a name="line-789"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-6989586621683974704"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-790"></a><span>
</span><a name="line-791"></a><span class="hs-comment">-- | Replaces constraint tuple names with corresponding boxed ones.</span><span>
</span><a name="line-792"></a><span class="hs-identifier">filterCTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-793"></a><a name="filterCTuple"><a href="RdrHsSyn.html#filterCTuple"><span class="hs-identifier">filterCTuple</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><a name="local-6989586621683974706"><a href="#local-6989586621683974706"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-794"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974707"><a href="#local-6989586621683974707"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TysWiredIn.html#cTupleTyConNameArity_maybe"><span class="hs-identifier hs-var">cTupleTyConNameArity_maybe</span></a><span> </span><a href="#local-6989586621683974706"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-795"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Exact"><span class="hs-identifier hs-var">Exact</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TysWiredIn.html#tupleTyConName"><span class="hs-identifier hs-var">tupleTyConName</span></a><span> </span><a href="BasicTypes.html#BoxedTuple"><span class="hs-identifier hs-var">BoxedTuple</span></a><span> </span><a href="#local-6989586621683974707"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-796"></a><span class="hs-identifier">filterCTuple</span><span> </span><a name="local-6989586621683974708"><a href="#local-6989586621683974708"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974708"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span>
</span><a name="line-799"></a><span class="hs-comment">{- Note [setRdrNameSpace for wired-in names]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In GHC.Types, which declares (:), we have
  infixr 5 :
The ambiguity about which &quot;:&quot; is meant is resolved by parsing it as a
data constructor, but then using dataTcOccs to try the type constructor too;
and that in turn calls setRdrNameSpace to change the name-space of &quot;:&quot; to
tcClsName.  There isn't a corresponding &quot;:&quot; type constructor, but it's painful
to make setRdrNameSpace partial, so we just make an Unqual name instead. It
really doesn't matter!
-}</span><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-identifier">checkTyVarsP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTypeArg"><span class="hs-identifier hs-type">LHsTypeArg</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-812"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-813"></a><span class="hs-comment">-- Same as checkTyVars, but in the P monad</span><span>
</span><a name="line-814"></a><a name="checkTyVarsP"><a href="RdrHsSyn.html#checkTyVarsP"><span class="hs-identifier">checkTyVarsP</span></a></a><span> </span><a name="local-6989586621683974709"><a href="#local-6989586621683974709"><span class="hs-identifier">pp_what</span></a></a><span> </span><a name="local-6989586621683974710"><a href="#local-6989586621683974710"><span class="hs-identifier">equals_or_where</span></a></a><span> </span><a name="local-6989586621683974711"><a href="#local-6989586621683974711"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621683974712"><a href="#local-6989586621683974712"><span class="hs-identifier">tparms</span></a></a><span>
</span><a name="line-815"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974713"><a href="#local-6989586621683974713"><span class="hs-identifier">checkedTvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#checkTyVars"><span class="hs-identifier hs-var">checkTyVars</span></a><span> </span><a href="#local-6989586621683974709"><span class="hs-identifier hs-var">pp_what</span></a><span> </span><a href="#local-6989586621683974710"><span class="hs-identifier hs-var">equals_or_where</span></a><span> </span><a href="#local-6989586621683974711"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683974712"><span class="hs-identifier hs-var">tparms</span></a><span>
</span><a name="line-816"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><a href="#local-6989586621683974713"><span class="hs-identifier hs-var">checkedTvs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-identifier">eitherToP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974403"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974403"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-819"></a><span class="hs-comment">-- Adapts the Either monad to the P monad</span><span>
</span><a name="line-820"></a><a name="eitherToP"><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier">eitherToP</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974714"><a href="#local-6989586621683974714"><span class="hs-identifier">loc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974715"><a href="#local-6989586621683974715"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974714"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974715"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-821"></a><span class="hs-identifier">eitherToP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621683974716"><a href="#local-6989586621683974716"><span class="hs-identifier">thing</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683974716"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span class="hs-identifier">checkTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTypeArg"><span class="hs-identifier hs-type">LHsTypeArg</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-824"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>                      </span><span class="hs-special">(</span><span> </span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">-- the synthesized type variables</span><span>
</span><a name="line-826"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- action which adds annotations</span><span>
</span><a name="line-827"></a><span class="hs-comment">-- ^ Check whether the given list of type parameters are all type variables</span><span>
</span><a name="line-828"></a><span class="hs-comment">-- (possibly with a kind signature).</span><span>
</span><a name="line-829"></a><span class="hs-comment">-- We use the Either monad because it's also called (via 'mkATDefault') from</span><span>
</span><a name="line-830"></a><span class="hs-comment">-- &quot;Convert&quot;.</span><span>
</span><a name="line-831"></a><a name="checkTyVars"><a href="RdrHsSyn.html#checkTyVars"><span class="hs-identifier">checkTyVars</span></a></a><span> </span><a name="local-6989586621683974717"><a href="#local-6989586621683974717"><span class="hs-identifier">pp_what</span></a></a><span> </span><a name="local-6989586621683974718"><a href="#local-6989586621683974718"><span class="hs-identifier">equals_or_where</span></a></a><span> </span><a name="local-6989586621683974719"><a href="#local-6989586621683974719"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621683974720"><a href="#local-6989586621683974720"><span class="hs-identifier">tparms</span></a></a><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974745"><a href="#local-6989586621683974745"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974746"><a href="#local-6989586621683974746"><span class="hs-identifier">anns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621683974721"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621683974720"><span class="hs-identifier hs-var">tparms</span></a><span>
</span><a name="line-833"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsQTvs"><span class="hs-identifier hs-var">mkHsQTvs</span></a><span> </span><a href="#local-6989586621683974745"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621683974746"><span class="hs-identifier hs-var">anns</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-834"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-835"></a><span>    </span><a name="local-6989586621683974721"><a href="#local-6989586621683974721"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974725"><a href="#local-6989586621683974725"><span class="hs-identifier">ki</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974726"><a href="#local-6989586621683974726"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974726"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span>
</span><a name="line-837"></a><span>                                      </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected type application&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-838"></a><span>                                            </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974725"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-839"></a><span>                                          </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974717"><span class="hs-identifier hs-var">pp_what</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-840"></a><span>                                            </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;declaration for&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974719"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a name="local-6989586621683974727"><a href="#local-6989586621683974727"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974722"><span class="hs-identifier hs-var">chkParens</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683974727"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-842"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsArgPar"><span class="hs-identifier hs-var">HsArgPar</span></a><span> </span><a name="local-6989586621683974728"><a href="#local-6989586621683974728"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974728"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Malformed&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974717"><span class="hs-identifier hs-var">pp_what</span></a><span>
</span><a name="line-843"></a><span>                           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;declaration for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974719"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-844"></a><span>        </span><span class="hs-comment">-- Keep around an action for adjusting the annotations of extra parens</span><span>
</span><a name="line-845"></a><span>    </span><span class="hs-identifier">chkParens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-846"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-847"></a><span>    </span><a name="local-6989586621683974722"><a href="#local-6989586621683974722"><span class="hs-identifier">chkParens</span></a></a><span> </span><a name="local-6989586621683974729"><a href="#local-6989586621683974729"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974730"><a href="#local-6989586621683974730"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974731"><a href="#local-6989586621683974731"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974722"><span class="hs-identifier hs-var">chkParens</span></a><span> </span><span class="hs-special">(</span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974730"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-848"></a><span>                                                        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683974729"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974731"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-849"></a><span>    </span><span class="hs-identifier">chkParens</span><span> </span><a name="local-6989586621683974732"><a href="#local-6989586621683974732"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974733"><a href="#local-6989586621683974733"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974723"><span class="hs-identifier hs-var">chk</span></a><span> </span><a href="#local-6989586621683974733"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-850"></a><span>      </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621683974734"><a href="#local-6989586621683974734"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683974734"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-851"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621683974735"><a href="#local-6989586621683974735"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974735"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621683974732"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span>        </span><span class="hs-comment">-- Check that the name space is correct!</span><span>
</span><a name="line-854"></a><span>    </span><span class="hs-identifier">chk</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>    </span><a name="local-6989586621683974723"><a href="#local-6989586621683974723"><span class="hs-identifier">chk</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974736"><a href="#local-6989586621683974736"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974737"><a href="#local-6989586621683974737"><span class="hs-identifier">lv</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974738"><a href="#local-6989586621683974738"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974739"><a href="#local-6989586621683974739"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrTyVar"><span class="hs-identifier hs-var">isRdrTyVar</span></a><span> </span><a href="#local-6989586621683974738"><span class="hs-identifier hs-var">tv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974736"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974737"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621683974738"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974739"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>    </span><span class="hs-identifier">chk</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974740"><a href="#local-6989586621683974740"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974741"><a href="#local-6989586621683974741"><span class="hs-identifier">ltv</span></a></a><span> </span><a name="local-6989586621683974742"><a href="#local-6989586621683974742"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-858"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrTyVar"><span class="hs-identifier hs-var">isRdrTyVar</span></a><span> </span><a href="#local-6989586621683974742"><span class="hs-identifier hs-var">tv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974740"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974741"><span class="hs-identifier hs-var">ltv</span></a><span> </span><a href="#local-6989586621683974742"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-859"></a><span>    </span><span class="hs-identifier">chk</span><span> </span><a name="local-6989586621683974743"><a href="#local-6989586621683974743"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974744"><a href="#local-6989586621683974744"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-860"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974744"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span>
</span><a name="line-861"></a><span>                </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974743"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974717"><span class="hs-identifier hs-var">pp_what</span></a><span>
</span><a name="line-863"></a><span>                       </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;declaration for&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><a href="#local-6989586621683974724"><span class="hs-identifier hs-var">tc'</span></a><span>
</span><a name="line-864"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;A&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974717"><span class="hs-identifier hs-var">pp_what</span></a><span>
</span><a name="line-865"></a><span>                              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;declaration should have form&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-867"></a><span>                       </span><span class="hs-special">(</span><a href="#local-6989586621683974717"><span class="hs-identifier hs-var">pp_what</span></a><span>
</span><a name="line-868"></a><span>                        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974724"><span class="hs-identifier hs-var">tc'</span></a><span>
</span><a name="line-869"></a><span>                        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#takeList"><span class="hs-identifier hs-var">takeList</span></a><span> </span><a href="#local-6989586621683974720"><span class="hs-identifier hs-var">tparms</span></a><span> </span><a href="PrelNames.html#allNameStrings"><span class="hs-identifier hs-var">allNameStrings</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-870"></a><span>                        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683974718"><span class="hs-identifier hs-var">equals_or_where</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span>    </span><span class="hs-comment">-- Avoid printing a constraint tuple in the error message. Print</span><span>
</span><a name="line-873"></a><span>    </span><span class="hs-comment">-- a plain old tuple instead (since that's what the user probably</span><span>
</span><a name="line-874"></a><span>    </span><span class="hs-comment">-- wrote). See #14907</span><span>
</span><a name="line-875"></a><span>    </span><a name="local-6989586621683974724"><a href="#local-6989586621683974724"><span class="hs-identifier">tc'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="RdrHsSyn.html#filterCTuple"><span class="hs-identifier hs-var">filterCTuple</span></a><span> </span><a href="#local-6989586621683974719"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-876"></a><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-identifier">whereDots</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">equalsDots</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-880"></a><span class="hs-comment">-- Second argument to checkTyVars</span><span>
</span><a name="line-881"></a><a name="whereDots"><a href="RdrHsSyn.html#whereDots"><span class="hs-identifier">whereDots</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;where ...&quot;</span><span>
</span><a name="line-882"></a><a name="equalsDots"><a href="RdrHsSyn.html#equalsDots"><span class="hs-identifier">equalsDots</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;= ...&quot;</span><span>
</span><a name="line-883"></a><span>
</span><a name="line-884"></a><span class="hs-identifier">checkDatatypeContext</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-885"></a><a name="checkDatatypeContext"><a href="RdrHsSyn.html#checkDatatypeContext"><span class="hs-identifier">checkDatatypeContext</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span class="hs-identifier">checkDatatypeContext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974747"><a href="#local-6989586621683974747"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-887"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974748"><a href="#local-6989586621683974748"><span class="hs-identifier">allowed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#DatatypeContextsBit"><span class="hs-identifier hs-var">DatatypeContextsBit</span></a><span>
</span><a name="line-888"></a><span>         </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621683974748"><span class="hs-identifier hs-var">allowed</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-889"></a><span>             </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683974747"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>                 </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal datatype context (use DatatypeContexts):&quot;</span><span>
</span><a name="line-891"></a><span>                  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="HsTypes.html#pprLHsContext"><span class="hs-identifier hs-var">pprLHsContext</span></a><span> </span><a href="#local-6989586621683974747"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>
</span><a name="line-893"></a><span class="hs-keyword">type</span><span> </span><a name="LRuleTyTmVar"><a href="RdrHsSyn.html#LRuleTyTmVar"><span class="hs-identifier">LRuleTyTmVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-type">RuleTyTmVar</span></a><span>
</span><a name="line-894"></a><span class="hs-keyword">data</span><span> </span><a name="RuleTyTmVar"><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier">RuleTyTmVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RuleTyTmVar"><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier">RuleTyTmVar</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span class="hs-comment">-- ^ Essentially a wrapper for a @RuleBndr GhcPs@</span><span>
</span><a name="line-896"></a><span>
</span><a name="line-897"></a><span class="hs-comment">-- turns RuleTyTmVars into RuleBnrs - this is straightforward</span><span>
</span><a name="line-898"></a><span class="hs-identifier">mkRuleBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrHsSyn.html#LRuleTyTmVar"><span class="hs-identifier hs-type">LRuleTyTmVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LRuleBndr"><span class="hs-identifier hs-type">LRuleBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-899"></a><a name="mkRuleBndrs"><a href="RdrHsSyn.html#mkRuleBndrs"><span class="hs-identifier">mkRuleBndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621683974749"><span class="hs-identifier hs-var">cvt_one</span></a><span class="hs-special">)</span><span>
</span><a name="line-900"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974749"><a href="#local-6989586621683974749"><span class="hs-identifier">cvt_one</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-var">RuleTyTmVar</span></a><span> </span><a name="local-6989586621683974750"><a href="#local-6989586621683974750"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a><span>    </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974750"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-901"></a><span>        </span><span class="hs-identifier">cvt_one</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-var">RuleTyTmVar</span></a><span> </span><a name="local-6989586621683974751"><a href="#local-6989586621683974751"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974752"><a href="#local-6989586621683974752"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-902"></a><span>          </span><a href="HsDecls.html#RuleBndrSig"><span class="hs-identifier hs-var">RuleBndrSig</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974751"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><a href="#local-6989586621683974752"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-903"></a><span>
</span><a name="line-904"></a><span class="hs-comment">-- turns RuleTyTmVars into HsTyVarBndrs - this is more interesting</span><span>
</span><a name="line-905"></a><span class="hs-identifier">mkRuleTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="RdrHsSyn.html#LRuleTyTmVar"><span class="hs-identifier hs-type">LRuleTyTmVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-906"></a><a name="mkRuleTyVarBndrs"><a href="RdrHsSyn.html#mkRuleTyVarBndrs"><span class="hs-identifier">mkRuleTyVarBndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621683974753"><span class="hs-identifier hs-var">cvt_one</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974753"><a href="#local-6989586621683974753"><span class="hs-identifier">cvt_one</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-var">RuleTyTmVar</span></a><span> </span><a name="local-6989586621683974755"><a href="#local-6989586621683974755"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span>   </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621683974754"><span class="hs-identifier hs-var">tm_to_ty</span></a><span> </span><a href="#local-6989586621683974755"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>        </span><span class="hs-identifier">cvt_one</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#RuleTyTmVar"><span class="hs-identifier hs-var">RuleTyTmVar</span></a><span> </span><a name="local-6989586621683974756"><a href="#local-6989586621683974756"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974757"><a href="#local-6989586621683974757"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-909"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621683974754"><span class="hs-identifier hs-var">tm_to_ty</span></a><span> </span><a href="#local-6989586621683974756"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974757"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-910"></a><span>    </span><span class="hs-comment">-- takes something in namespace 'varName' to something in namespace 'tvName'</span><span>
</span><a name="line-911"></a><span>        </span><a name="local-6989586621683974754"><a href="#local-6989586621683974754"><span class="hs-identifier">tm_to_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a name="local-6989586621683974758"><a href="#local-6989586621683974758"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#setOccNameSpace"><span class="hs-identifier hs-var">setOccNameSpace</span></a><span> </span><a href="OccName.html#tvName"><span class="hs-identifier hs-var">tvName</span></a><span> </span><a href="#local-6989586621683974758"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-912"></a><span>        </span><span class="hs-identifier">tm_to_ty</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkRuleTyVarBndrs&quot;</span><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span class="hs-comment">-- See note [Parsing explicit foralls in Rules] in Parser.y</span><span>
</span><a name="line-915"></a><span class="hs-identifier">checkRuleTyVarBndrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-916"></a><a name="checkRuleTyVarBndrNames"><a href="RdrHsSyn.html#checkRuleTyVarBndrNames"><span class="hs-identifier">checkRuleTyVarBndrNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974759"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="HsTypes.html#hsTyVarName"><span class="hs-identifier hs-var">hsTyVarName</span></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974759"><a href="#local-6989586621683974759"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974760"><a href="#local-6989586621683974760"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a name="local-6989586621683974761"><a href="#local-6989586621683974761"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-918"></a><span>          </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-6989586621683974761"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">any</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;forall&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;family&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;role&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-919"></a><span>               </span><span class="hs-special">(</span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974760"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;parse error on input &quot;</span><span>
</span><a name="line-920"></a><span>                                    </span><span class="hs-operator hs-var">++</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-6989586621683974761"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-921"></a><span>        </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkRuleTyVarBndrNames&quot;</span><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-identifier">checkRecordSyntax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621683974402"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683974402"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683974402"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-924"></a><a name="checkRecordSyntax"><a href="RdrHsSyn.html#checkRecordSyntax"><span class="hs-identifier">checkRecordSyntax</span></a></a><span> </span><a name="local-6989586621683974762"><a href="#local-6989586621683974762"><span class="hs-identifier">lr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974763"><a href="#local-6989586621683974763"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974764"><a href="#local-6989586621683974764"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-925"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974765"><a href="#local-6989586621683974765"><span class="hs-identifier">allowed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#TraditionalRecordSyntaxBit"><span class="hs-identifier hs-var">TraditionalRecordSyntaxBit</span></a><span>
</span><a name="line-926"></a><span>         </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683974765"><span class="hs-identifier hs-var">allowed</span></a><span>
</span><a name="line-927"></a><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683974762"><span class="hs-identifier hs-var">lr</span></a><span>
</span><a name="line-928"></a><span>             </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974763"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-929"></a><span>                   </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal record syntax (use TraditionalRecordSyntax):&quot;</span><span>
</span><a name="line-930"></a><span>                    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974764"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-comment">-- | Check if the gadt_constrlist is empty. Only raise parse error for</span><span>
</span><a name="line-933"></a><span class="hs-comment">-- `data T where` to avoid affecting existing error message, see #8258.</span><span>
</span><a name="line-934"></a><span class="hs-identifier">checkEmptyGADTs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-936"></a><a name="checkEmptyGADTs"><a href="RdrHsSyn.html#checkEmptyGADTs"><span class="hs-identifier">checkEmptyGADTs</span></a></a><span> </span><a name="local-6989586621683974766"><a href="#local-6989586621683974766"><span class="hs-identifier">gadts</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974767"><a href="#local-6989586621683974767"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- Empty GADT declaration.</span><span>
</span><a name="line-937"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974768"><a href="#local-6989586621683974768"><span class="hs-identifier">gadtSyntax</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#GadtSyntaxBit"><span class="hs-identifier hs-var">GadtSyntaxBit</span></a><span>   </span><span class="hs-comment">-- GADTs implies GADTSyntax</span><span>
</span><a name="line-938"></a><span>         </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683974768"><span class="hs-identifier hs-var">gadtSyntax</span></a><span>
</span><a name="line-939"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683974766"><span class="hs-identifier hs-var">gadts</span></a><span>
</span><a name="line-940"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974767"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-941"></a><span>              </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal keyword 'where' in data declaration&quot;</span><span>
</span><a name="line-942"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use GADTs or a similar language&quot;</span><span>
</span><a name="line-943"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;extension to enable syntax: data T where&quot;</span><span>
</span><a name="line-944"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-945"></a><span class="hs-identifier">checkEmptyGADTs</span><span> </span><a name="local-6989586621683974769"><a href="#local-6989586621683974769"><span class="hs-identifier">gadts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683974769"><span class="hs-identifier hs-var">gadts</span></a><span>              </span><span class="hs-comment">-- Ordinary GADT declaration.</span><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span class="hs-identifier">checkTyClHdr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>               </span><span class="hs-comment">-- True  &lt;=&gt; class header</span><span>
</span><a name="line-948"></a><span>                                   </span><span class="hs-comment">-- False &lt;=&gt; type header</span><span>
</span><a name="line-949"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-950"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- the head symbol (type or class name)</span><span>
</span><a name="line-951"></a><span>                   </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTypeArg"><span class="hs-identifier hs-type">LHsTypeArg</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- parameters of head symbol</span><span>
</span><a name="line-952"></a><span>                   </span><a href="BasicTypes.html#LexicalFixity"><span class="hs-identifier hs-type">LexicalFixity</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- the declaration is in infix format</span><span>
</span><a name="line-953"></a><span>                   </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- API Annotation for HsParTy when stripping parens</span><span>
</span><a name="line-954"></a><span class="hs-comment">-- Well-formedness check and decomposition of type and class heads.</span><span>
</span><a name="line-955"></a><span class="hs-comment">-- Decomposes   T ty1 .. tyn   into    (T, [ty1, ..., tyn])</span><span>
</span><a name="line-956"></a><span class="hs-comment">--              Int :*: Bool   into    (:*:, [Int, Bool])</span><span>
</span><a name="line-957"></a><span class="hs-comment">-- returning the pieces</span><span>
</span><a name="line-958"></a><a name="checkTyClHdr"><a href="RdrHsSyn.html#checkTyClHdr"><span class="hs-identifier">checkTyClHdr</span></a></a><span> </span><a name="local-6989586621683974770"><a href="#local-6989586621683974770"><span class="hs-identifier">is_cls</span></a></a><span> </span><a name="local-6989586621683974771"><a href="#local-6989586621683974771"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-959"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974772"><span class="hs-identifier hs-var">goL</span></a><span> </span><a href="#local-6989586621683974771"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span>
</span><a name="line-960"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-961"></a><span>    </span><a name="local-6989586621683974772"><a href="#local-6989586621683974772"><span class="hs-identifier">goL</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974774"><a href="#local-6989586621683974774"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974775"><a href="#local-6989586621683974775"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974776"><a href="#local-6989586621683974776"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974777"><a href="#local-6989586621683974777"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974778"><a href="#local-6989586621683974778"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974773"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974774"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974775"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621683974776"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621683974777"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621683974778"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-962"></a><span>
</span><a name="line-963"></a><span>    </span><span class="hs-comment">-- workaround to define '*' despite StarIsType</span><span>
</span><a name="line-964"></a><span>    </span><a name="local-6989586621683974773"><a href="#local-6989586621683974773"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683974779"><a href="#local-6989586621683974779"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974780"><a href="#local-6989586621683974780"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsStarTy"><span class="hs-identifier hs-var">HsStarTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974781"><a href="#local-6989586621683974781"><span class="hs-identifier">isUni</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974782"><a href="#local-6989586621683974782"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974783"><a href="#local-6989586621683974783"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974784"><a href="#local-6989586621683974784"><span class="hs-identifier">fix</span></a></a><span>
</span><a name="line-965"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RdrHsSyn.html#warnStarBndr"><span class="hs-identifier hs-var">warnStarBndr</span></a><span> </span><a href="#local-6989586621683974780"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-966"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974785"><a href="#local-6989586621683974785"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkOccName"><span class="hs-identifier hs-var">mkOccName</span></a><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#starSym"><span class="hs-identifier hs-var">starSym</span></a><span> </span><a href="#local-6989586621683974781"><span class="hs-identifier hs-var">isUni</span></a><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974780"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a href="#local-6989586621683974785"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974782"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974784"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974783"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974779"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-968"></a><span>
</span><a name="line-969"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974786"><a href="#local-6989586621683974786"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974787"><a href="#local-6989586621683974787"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974788"><a href="#local-6989586621683974788"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974789"><a href="#local-6989586621683974789"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974790"><a href="#local-6989586621683974790"><span class="hs-identifier">fix</span></a></a><span>
</span><a name="line-970"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrTc"><span class="hs-identifier hs-var">isRdrTc</span></a><span> </span><a href="#local-6989586621683974787"><span class="hs-identifier hs-var">tc</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974786"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974787"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974788"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974790"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974789"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-971"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974791"><a href="#local-6989586621683974791"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683974792"><a href="#local-6989586621683974792"><span class="hs-identifier">ltc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974793"><a href="#local-6989586621683974793"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974794"><a href="#local-6989586621683974794"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974795"><a href="#local-6989586621683974795"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974796"><a href="#local-6989586621683974796"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974797"><a href="#local-6989586621683974797"><span class="hs-identifier">_fix</span></a></a><span>
</span><a name="line-972"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrTc"><span class="hs-identifier hs-var">isRdrTc</span></a><span> </span><a href="#local-6989586621683974793"><span class="hs-identifier hs-var">tc</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974792"><span class="hs-identifier hs-var">ltc</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a href="#local-6989586621683974791"><span class="hs-identifier hs-var">t1</span></a><span class="hs-glyph">:</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a href="#local-6989586621683974794"><span class="hs-identifier hs-var">t2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683974795"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974796"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-973"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974798"><a href="#local-6989586621683974798"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974799"><a href="#local-6989586621683974799"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-6989586621683974800"><a href="#local-6989586621683974800"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974801"><a href="#local-6989586621683974801"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974802"><a href="#local-6989586621683974802"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974772"><span class="hs-identifier hs-var">goL</span></a><span> </span><a href="#local-6989586621683974799"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621683974800"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974801"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">++</span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974798"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974802"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-974"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974803"><a href="#local-6989586621683974803"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683974804"><a href="#local-6989586621683974804"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974805"><a href="#local-6989586621683974805"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974806"><a href="#local-6989586621683974806"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974807"><a href="#local-6989586621683974807"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974772"><span class="hs-identifier hs-var">goL</span></a><span> </span><a href="#local-6989586621683974803"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a href="#local-6989586621683974804"><span class="hs-identifier hs-var">t2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683974805"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974806"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621683974807"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-975"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppKindTy"><span class="hs-identifier hs-var">HsAppKindTy</span></a><span> </span><a name="local-6989586621683974808"><a href="#local-6989586621683974808"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974809"><a href="#local-6989586621683974809"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621683974810"><a href="#local-6989586621683974810"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974811"><a href="#local-6989586621683974811"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683974812"><a href="#local-6989586621683974812"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974813"><a href="#local-6989586621683974813"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974772"><span class="hs-identifier hs-var">goL</span></a><span> </span><a href="#local-6989586621683974809"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><a href="#local-6989586621683974808"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974810"><span class="hs-identifier hs-var">ki</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683974811"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974812"><span class="hs-identifier hs-var">ann</span></a><span> </span><a href="#local-6989586621683974813"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-976"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974814"><a href="#local-6989586621683974814"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsTypes.html#HsBoxedOrConstraintTuple"><span class="hs-identifier hs-var">HsBoxedOrConstraintTuple</span></a><span> </span><a name="local-6989586621683974815"><a href="#local-6989586621683974815"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621683974816"><a href="#local-6989586621683974816"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974817"><a href="#local-6989586621683974817"><span class="hs-identifier">fix</span></a></a><span>
</span><a name="line-977"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974814"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#nameRdrName"><span class="hs-identifier hs-var">nameRdrName</span></a><span> </span><a href="#local-6989586621683974819"><span class="hs-identifier hs-var">tup_name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a href="#local-6989586621683974815"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974817"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974816"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-979"></a><span>        </span><a name="local-6989586621683974818"><a href="#local-6989586621683974818"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621683974815"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-980"></a><span>        </span><a name="local-6989586621683974819"><a href="#local-6989586621683974819"><span class="hs-identifier">tup_name</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974770"><span class="hs-identifier hs-var">is_cls</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#cTupleTyConName"><span class="hs-identifier hs-var">cTupleTyConName</span></a><span> </span><a href="#local-6989586621683974818"><span class="hs-identifier hs-var">arity</span></a><span>
</span><a name="line-981"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleTyCon"><span class="hs-identifier hs-var">tupleTyCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><a href="#local-6989586621683974818"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-982"></a><span>          </span><span class="hs-comment">-- See Note [Unit tuples] in HsTypes  (TODO: is this still relevant?)</span><span>
</span><a name="line-983"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683974820"><a href="#local-6989586621683974820"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-984"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974820"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Malformed head of type or class declaration:&quot;</span><span>
</span><a name="line-985"></a><span>                          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974771"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>
</span><a name="line-987"></a><span class="hs-comment">-- | Yield a parse error if we have a function applied directly to a do block</span><span>
</span><a name="line-988"></a><span class="hs-comment">-- etc. and BlockArguments is not enabled.</span><span>
</span><a name="line-989"></a><span class="hs-identifier">checkBlockArguments</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-990"></a><a name="checkBlockArguments"><a href="RdrHsSyn.html#checkBlockArguments"><span class="hs-identifier">checkBlockArguments</span></a></a><span> </span><a name="local-6989586621683974821"><a href="#local-6989586621683974821"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683974821"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-991"></a><span>    </span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsExpr.html#DoExpr"><span class="hs-identifier hs-var">DoExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;do block&quot;</span><span>
</span><a name="line-992"></a><span>    </span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsExpr.html#MDoExpr"><span class="hs-identifier hs-var">MDoExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;mdo block&quot;</span><span>
</span><a name="line-993"></a><span>    </span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;lambda expression&quot;</span><span>
</span><a name="line-994"></a><span>    </span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;case expression&quot;</span><span>
</span><a name="line-995"></a><span>    </span><a href="HsExpr.html#HsLamCase"><span class="hs-identifier hs-var">HsLamCase</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;lambda-case expression&quot;</span><span>
</span><a name="line-996"></a><span>    </span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;let expression&quot;</span><span>
</span><a name="line-997"></a><span>    </span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;if expression&quot;</span><span>
</span><a name="line-998"></a><span>    </span><a href="HsExpr.html#HsProc"><span class="hs-identifier hs-var">HsProc</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974822"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-string">&quot;proc expression&quot;</span><span>
</span><a name="line-999"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1000"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1001"></a><span>    </span><a name="local-6989586621683974822"><a href="#local-6989586621683974822"><span class="hs-identifier">check</span></a></a><span> </span><a name="local-6989586621683974823"><a href="#local-6989586621683974823"><span class="hs-identifier">element</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1002"></a><span>      </span><a name="local-6989586621683974824"><a href="#local-6989586621683974824"><span class="hs-identifier">blockArguments</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#BlockArgumentsBit"><span class="hs-identifier hs-var">BlockArgumentsBit</span></a><span>
</span><a name="line-1003"></a><span>      </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621683974824"><span class="hs-identifier hs-var">blockArguments</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1004"></a><span>        </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683974821"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1005"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621683974823"><span class="hs-identifier hs-var">element</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot; in function application:&quot;</span><span>
</span><a name="line-1006"></a><span>           </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974821"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1007"></a><span>           </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;You could write it with parentheses&quot;</span><span>
</span><a name="line-1008"></a><span>           </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Or perhaps you meant to enable BlockArguments?&quot;</span><span>
</span><a name="line-1009"></a><span>
</span><a name="line-1010"></a><span class="hs-comment">-- | Validate the context constraints and break up a context into a list</span><span>
</span><a name="line-1011"></a><span class="hs-comment">-- of predicates.</span><span>
</span><a name="line-1012"></a><span class="hs-comment">--</span><span>
</span><a name="line-1013"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1014"></a><span class="hs-comment">--     (Eq a, Ord b)        --&gt;  [Eq a, Ord b]</span><span>
</span><a name="line-1015"></a><span class="hs-comment">--     Eq a                 --&gt;  [Eq a]</span><span>
</span><a name="line-1016"></a><span class="hs-comment">--     (Eq a)               --&gt;  [Eq a]</span><span>
</span><a name="line-1017"></a><span class="hs-comment">--     (((Eq a)))           --&gt;  [Eq a]</span><span>
</span><a name="line-1018"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1019"></a><span class="hs-identifier">checkContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1020"></a><a name="checkContext"><a href="RdrHsSyn.html#checkContext"><span class="hs-identifier">checkContext</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974825"><a href="#local-6989586621683974825"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974826"><a href="#local-6989586621683974826"><span class="hs-identifier">orig_t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1021"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974827"><span class="hs-identifier hs-var">check</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974825"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974826"><span class="hs-identifier hs-var">orig_t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1022"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1023"></a><span>  </span><a name="local-6989586621683974827"><a href="#local-6989586621683974827"><span class="hs-identifier">check</span></a></a><span> </span><a name="local-6989586621683974829"><a href="#local-6989586621683974829"><span class="hs-identifier">anns</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974830"><a href="#local-6989586621683974830"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsTypes.html#HsBoxedOrConstraintTuple"><span class="hs-identifier hs-var">HsBoxedOrConstraintTuple</span></a><span> </span><a name="local-6989586621683974831"><a href="#local-6989586621683974831"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1024"></a><span>    </span><span class="hs-comment">-- (Eq a, Ord b) shows up as a tuple type. Only boxed tuples can</span><span>
</span><a name="line-1025"></a><span>    </span><span class="hs-comment">-- be used as context constraints.</span><span>
</span><a name="line-1026"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974829"><span class="hs-identifier hs-var">anns</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974830"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">,</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974825"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974831"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- Ditto ()</span><span>
</span><a name="line-1027"></a><span>
</span><a name="line-1028"></a><span>  </span><span class="hs-identifier">check</span><span> </span><a name="local-6989586621683974832"><a href="#local-6989586621683974832"><span class="hs-identifier">anns</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974833"><a href="#local-6989586621683974833"><span class="hs-identifier">lp1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974834"><a href="#local-6989586621683974834"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1029"></a><span>                                  </span><span class="hs-comment">-- to be sure HsParTy doesn't get into the way</span><span>
</span><a name="line-1030"></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974827"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621683974835"><span class="hs-identifier hs-var">anns'</span></a><span> </span><a href="#local-6989586621683974834"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1031"></a><span>         </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974835"><a href="#local-6989586621683974835"><span class="hs-identifier">anns'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683974825"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621683974833"><span class="hs-identifier hs-var">lp1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621683974832"><span class="hs-identifier hs-var">anns</span></a><span>
</span><a name="line-1032"></a><span>                                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974832"><span class="hs-identifier hs-var">anns</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683974833"><span class="hs-identifier hs-var">lp1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1033"></a><span>
</span><a name="line-1034"></a><span>  </span><span class="hs-comment">-- no need for anns, returning original</span><span>
</span><a name="line-1035"></a><span>  </span><span class="hs-identifier">check</span><span> </span><a name="local-6989586621683974836"><a href="#local-6989586621683974836"><span class="hs-identifier">_anns</span></a></a><span> </span><a name="local-6989586621683974837"><a href="#local-6989586621683974837"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#checkNoDocs"><span class="hs-identifier hs-var">checkNoDocs</span></a><span> </span><a href="#local-6989586621683974828"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974837"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974825"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974825"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974826"><span class="hs-identifier hs-var">orig_t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1036"></a><span>
</span><a name="line-1037"></a><span>  </span><a name="local-6989586621683974828"><a href="#local-6989586621683974828"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;data constructor context&quot;</span><span>
</span><a name="line-1038"></a><span>
</span><a name="line-1039"></a><span class="hs-comment">-- | Check recursively if there are any 'HsDocTy's in the given type.</span><span>
</span><a name="line-1040"></a><span class="hs-comment">-- This only works on a subset of types produced by 'btype_no_ops'</span><span>
</span><a name="line-1041"></a><span class="hs-identifier">checkNoDocs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1042"></a><a name="checkNoDocs"><a href="RdrHsSyn.html#checkNoDocs"><span class="hs-identifier">checkNoDocs</span></a></a><span> </span><a name="local-6989586621683974838"><a href="#local-6989586621683974838"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974839"><a href="#local-6989586621683974839"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974840"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974839"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1043"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1044"></a><span>    </span><a name="local-6989586621683974840"><a href="#local-6989586621683974840"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppKindTy"><span class="hs-identifier hs-var">HsAppKindTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974841"><a href="#local-6989586621683974841"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621683974842"><a href="#local-6989586621683974842"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974840"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974841"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="#local-6989586621683974840"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974842"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1045"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974843"><a href="#local-6989586621683974843"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683974844"><a href="#local-6989586621683974844"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974840"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974843"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="#local-6989586621683974840"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683974844"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1046"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974845"><a href="#local-6989586621683974845"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974846"><a href="#local-6989586621683974846"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621683974847"><a href="#local-6989586621683974847"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974845"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span>
</span><a name="line-1047"></a><span>                                  </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected haddock&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974847"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1048"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;on&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683974838"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974846"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1049"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span class="hs-comment">-- -------------------------------------------------------------------------</span><span>
</span><a name="line-1052"></a><span class="hs-comment">-- Checking Patterns.</span><span>
</span><a name="line-1053"></a><span>
</span><a name="line-1054"></a><span class="hs-comment">-- We parse patterns as expressions and check for valid patterns below,</span><span>
</span><a name="line-1055"></a><span class="hs-comment">-- converting the expression into a pattern at the same time.</span><span>
</span><a name="line-1056"></a><span>
</span><a name="line-1057"></a><span class="hs-identifier">checkPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1058"></a><a name="checkPattern"><a href="RdrHsSyn.html#checkPattern"><span class="hs-identifier">checkPattern</span></a></a><span> </span><a name="local-6989586621683974848"><a href="#local-6989586621683974848"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974849"><a href="#local-6989586621683974849"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974848"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974849"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-identifier">checkPatterns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1061"></a><a name="checkPatterns"><a href="RdrHsSyn.html#checkPatterns"><span class="hs-identifier">checkPatterns</span></a></a><span> </span><a name="local-6989586621683974850"><a href="#local-6989586621683974850"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974851"><a href="#local-6989586621683974851"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#checkPattern"><span class="hs-identifier hs-var">checkPattern</span></a><span> </span><a href="#local-6989586621683974850"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974851"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-1062"></a><span>
</span><a name="line-1063"></a><span class="hs-identifier">checkLPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><a name="checkLPat"><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier">checkLPat</span></a></a><span> </span><a name="local-6989586621683974852"><a href="#local-6989586621683974852"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974853"><a href="#local-6989586621683974853"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974854"><a href="#local-6989586621683974854"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#checkPat"><span class="hs-identifier hs-var">checkPat</span></a><span> </span><a href="#local-6989586621683974852"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974854"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974853"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1065"></a><span>
</span><a name="line-1066"></a><span class="hs-identifier">checkPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1067"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1068"></a><a name="checkPat"><a href="RdrHsSyn.html#checkPat"><span class="hs-identifier">checkPat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974855"><a href="#local-6989586621683974855"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974856"><a href="#local-6989586621683974856"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974857"><a href="#local-6989586621683974857"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974858"><a href="#local-6989586621683974858"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974859"><a href="#local-6989586621683974859"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1069"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a><span> </span><a href="#local-6989586621683974858"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974855"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974856"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974858"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621683974859"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1070"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683974859"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RdrHsSyn.html#patIsRec"><span class="hs-identifier hs-var">patIsRec</span></a><span> </span><a href="#local-6989586621683974858"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1071"></a><span>      </span><a href="RdrHsSyn.html#patFail"><span class="hs-identifier hs-var">patFail</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use RecursiveDo&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974856"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974857"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1072"></a><span class="hs-identifier">checkPat</span><span> </span><a name="local-6989586621683974860"><a href="#local-6989586621683974860"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974861"><a href="#local-6989586621683974861"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974862"><a href="#local-6989586621683974862"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683974863"><a href="#local-6989586621683974863"><span class="hs-identifier">args</span></a></a><span>     </span><span class="hs-comment">-- OK to let this happen even if bang-patterns</span><span>
</span><a name="line-1073"></a><span>                        </span><span class="hs-comment">-- are not enabled, because there is no valid</span><span>
</span><a name="line-1074"></a><span>                        </span><span class="hs-comment">-- non-bang-pattern parse of (C ! e)</span><span>
</span><a name="line-1075"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974864"><a href="#local-6989586621683974864"><span class="hs-identifier">e'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974865"><a href="#local-6989586621683974865"><span class="hs-identifier">args'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#splitBang"><span class="hs-identifier hs-var">splitBang</span></a><span> </span><a href="#local-6989586621683974862"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1076"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683974866"><a href="#local-6989586621683974866"><span class="hs-identifier">args''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkPatterns"><span class="hs-identifier hs-var">checkPatterns</span></a><span> </span><a href="#local-6989586621683974860"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974865"><span class="hs-identifier hs-var">args'</span></a><span>
</span><a name="line-1077"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="RdrHsSyn.html#checkPat"><span class="hs-identifier hs-var">checkPat</span></a><span> </span><a href="#local-6989586621683974860"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974861"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974864"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974866"><span class="hs-identifier hs-var">args''</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683974863"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1078"></a><span class="hs-identifier">checkPat</span><span> </span><a name="local-6989586621683974867"><a href="#local-6989586621683974867"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974868"><a href="#local-6989586621683974868"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974869"><a href="#local-6989586621683974869"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683974870"><a href="#local-6989586621683974870"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974871"><a href="#local-6989586621683974871"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1079"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974872"><a href="#local-6989586621683974872"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974867"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974870"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1080"></a><span>       </span><a href="RdrHsSyn.html#checkPat"><span class="hs-identifier hs-var">checkPat</span></a><span> </span><a href="#local-6989586621683974867"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974868"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974869"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974872"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974871"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1081"></a><span class="hs-identifier">checkPat</span><span> </span><a name="local-6989586621683974873"><a href="#local-6989586621683974873"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974874"><a href="#local-6989586621683974874"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974875"><a href="#local-6989586621683974875"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1082"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974876"><a href="#local-6989586621683974876"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkAPat"><span class="hs-identifier hs-var">checkAPat</span></a><span> </span><a href="#local-6989586621683974873"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974874"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974875"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1083"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974874"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974876"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1084"></a><span class="hs-identifier">checkPat</span><span> </span><a name="local-6989586621683974877"><a href="#local-6989586621683974877"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974878"><a href="#local-6989586621683974878"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974879"><a href="#local-6989586621683974879"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1085"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#patFail"><span class="hs-identifier hs-var">patFail</span></a><span> </span><a href="#local-6989586621683974877"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974878"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683974879"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span class="hs-identifier">checkAPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1088"></a><a name="checkAPat"><a href="RdrHsSyn.html#checkAPat"><span class="hs-identifier">checkAPat</span></a></a><span> </span><a name="local-6989586621683974880"><a href="#local-6989586621683974880"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974881"><a href="#local-6989586621683974881"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974882"><a href="#local-6989586621683974882"><span class="hs-identifier">e0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1089"></a><span> </span><a name="local-6989586621683974883"><a href="#local-6989586621683974883"><span class="hs-identifier">nPlusKPatterns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#NPlusKPatternsBit"><span class="hs-identifier hs-var">NPlusKPatternsBit</span></a><span>
</span><a name="line-1090"></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1091"></a><span>   </span><a href="HsExpr.html#EWildPat"><span class="hs-identifier hs-var">EWildPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1092"></a><span>   </span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974884"><a href="#local-6989586621683974884"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974884"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1093"></a><span>   </span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsStringPrim"><span class="hs-identifier hs-var">HsStringPrim</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (#13260)</span><span>
</span><a name="line-1094"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal unboxed string literal in pattern:&quot;</span><span>
</span><a name="line-1095"></a><span>                              </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span class="hs-special">)</span><span>
</span><a name="line-1096"></a><span>
</span><a name="line-1097"></a><span>   </span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974885"><a href="#local-6989586621683974885"><span class="hs-identifier">l</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974885"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span>   </span><span class="hs-comment">-- Overloaded numeric patterns (e.g. f 0 x = x)</span><span>
</span><a name="line-1100"></a><span>   </span><span class="hs-comment">-- Negation is recorded separately, so that the literal is zero or +ve</span><span>
</span><a name="line-1101"></a><span>   </span><span class="hs-comment">-- NB. Negative *primitive* literals are already handled by the lexer</span><span>
</span><a name="line-1102"></a><span>   </span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974886"><a href="#local-6989586621683974886"><span class="hs-identifier">pos_lit</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkNPat"><span class="hs-identifier hs-var">mkNPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974886"><span class="hs-identifier hs-var">pos_lit</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>   </span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974887"><a href="#local-6989586621683974887"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974888"><a href="#local-6989586621683974888"><span class="hs-identifier">pos_lit</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1104"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkNPat"><span class="hs-identifier hs-var">mkNPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974887"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974888"><span class="hs-identifier hs-var">pos_lit</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1105"></a><span>
</span><a name="line-1106"></a><span>   </span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974889"><a href="#local-6989586621683974889"><span class="hs-identifier">lb</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974890"><a href="#local-6989586621683974890"><span class="hs-identifier">bang</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974891"><a href="#local-6989586621683974891"><span class="hs-identifier">e</span></a></a><span>    </span><span class="hs-comment">-- (! x)</span><span>
</span><a name="line-1107"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974890"><span class="hs-identifier hs-var">bang</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="RdrHsSyn.html#bang_RDR"><span class="hs-identifier hs-var">bang_RDR</span></a><span>
</span><a name="line-1108"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RdrHsSyn.html#hintBangPat"><span class="hs-identifier hs-var">hintBangPat</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span>
</span><a name="line-1109"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-6989586621683974892"><a href="#local-6989586621683974892"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974891"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1110"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnotation"><span class="hs-identifier hs-var">addAnnotation</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="ApiAnnotation.html#AnnBang"><span class="hs-identifier hs-var">AnnBang</span></a><span> </span><a href="#local-6989586621683974889"><span class="hs-identifier hs-var">lb</span></a><span>
</span><a name="line-1111"></a><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span>  </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974892"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1112"></a><span>
</span><a name="line-1113"></a><span>   </span><a href="HsExpr.html#ELazyPat"><span class="hs-identifier hs-var">ELazyPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974893"><a href="#local-6989586621683974893"><span class="hs-identifier">e</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974893"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><span>   </span><a href="HsExpr.html#EAsPat"><span class="hs-identifier hs-var">EAsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974894"><a href="#local-6989586621683974894"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621683974895"><a href="#local-6989586621683974895"><span class="hs-identifier">e</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974895"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974894"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>   </span><span class="hs-comment">-- view pattern is well-formed if the pattern is</span><span>
</span><a name="line-1116"></a><span>   </span><a href="HsExpr.html#EViewPat"><span class="hs-identifier hs-var">EViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974896"><a href="#local-6989586621683974896"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621683974897"><a href="#local-6989586621683974897"><span class="hs-identifier">patE</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974897"><span class="hs-identifier hs-var">patE</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span>
</span><a name="line-1117"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683974898"><a href="#local-6989586621683974898"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974896"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621683974898"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1118"></a><span>   </span><a href="HsExpr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974899"><a href="#local-6989586621683974899"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683974900"><a href="#local-6989586621683974900"><span class="hs-identifier">t</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974901"><a href="#local-6989586621683974901"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974899"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1119"></a><span>                              </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPat"><span class="hs-identifier hs-var">SigPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974901"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621683974900"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>
</span><a name="line-1121"></a><span>   </span><span class="hs-comment">-- n+k patterns</span><span>
</span><a name="line-1122"></a><span>   </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974902"><a href="#local-6989586621683974902"><span class="hs-identifier">nloc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974903"><a href="#local-6989586621683974903"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>           </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974904"><a href="#local-6989586621683974904"><span class="hs-identifier">plus</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1124"></a><span>           </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974905"><a href="#local-6989586621683974905"><span class="hs-identifier">lloc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974906"><a href="#local-6989586621683974906"><span class="hs-identifier">lit</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">ol_val</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1125"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974883"><span class="hs-identifier hs-var">nPlusKPatterns</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974904"><span class="hs-identifier hs-var">plus</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="RdrHsSyn.html#plus_RDR"><span class="hs-identifier hs-var">plus_RDR</span></a><span class="hs-special">)</span><span>
</span><a name="line-1126"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkNPlusKPat"><span class="hs-identifier hs-var">mkNPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974902"><span class="hs-identifier hs-var">nloc</span></a><span> </span><a href="#local-6989586621683974903"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974905"><span class="hs-identifier hs-var">lloc</span></a><span> </span><a href="#local-6989586621683974906"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1127"></a><span>   </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974907"><a href="#local-6989586621683974907"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974908"><a href="#local-6989586621683974908"><span class="hs-identifier">cl</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974909"><a href="#local-6989586621683974909"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974910"><a href="#local-6989586621683974910"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-1128"></a><span>     </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621683974909"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1129"></a><span>         </span><a name="local-6989586621683974911"><a href="#local-6989586621683974911"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974907"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1130"></a><span>         </span><a name="local-6989586621683974912"><a href="#local-6989586621683974912"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974910"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1131"></a><span>         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974908"><span class="hs-identifier hs-var">cl</span></a><span> </span><a href="#local-6989586621683974909"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621683974911"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974912"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span>
</span><a name="line-1133"></a><span>   </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#patFail"><span class="hs-identifier hs-var">patFail</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span>
</span><a name="line-1134"></a><span>
</span><a name="line-1135"></a><span>   </span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974913"><a href="#local-6989586621683974913"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974914"><a href="#local-6989586621683974914"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974913"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-1136"></a><span>                             </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974914"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span>
</span><a name="line-1138"></a><span>   </span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974915"><a href="#local-6989586621683974915"><span class="hs-identifier">e</span></a></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974915"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span>   </span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974916"><a href="#local-6989586621683974916"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621683974917"><a href="#local-6989586621683974917"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-1141"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="HsExpr.html#tupArgPresent"><span class="hs-identifier hs-var">tupArgPresent</span></a><span> </span><a href="#local-6989586621683974916"><span class="hs-identifier hs-var">es</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974919"><a href="#local-6989586621683974919"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-1142"></a><span>                                           </span><span class="hs-special">[</span><a href="#local-6989586621683974918"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974918"><a href="#local-6989586621683974918"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683974916"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">]</span><span>
</span><a name="line-1143"></a><span>                                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974919"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621683974917"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1144"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal tuple section in pattern:&quot;</span><span>
</span><a name="line-1145"></a><span>                                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span class="hs-special">)</span><span>
</span><a name="line-1146"></a><span>
</span><a name="line-1147"></a><span>   </span><a href="HsExpr.html#ExplicitSum"><span class="hs-identifier hs-var">ExplicitSum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974920"><a href="#local-6989586621683974920"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621683974921"><a href="#local-6989586621683974921"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621683974922"><a href="#local-6989586621683974922"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1148"></a><span>     </span><a name="local-6989586621683974923"><a href="#local-6989586621683974923"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974922"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1149"></a><span>     </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974923"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621683974920"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621683974921"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1150"></a><span>
</span><a name="line-1151"></a><span>   </span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683974924"><a href="#local-6989586621683974924"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-6989586621683974925"><a href="#local-6989586621683974925"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621683974926"><a href="#local-6989586621683974926"><span class="hs-identifier">dd</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1152"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974927"><a href="#local-6989586621683974927"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#checkPatField"><span class="hs-identifier hs-var">checkPatField</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974925"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1153"></a><span>                              </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621683974924"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a href="#local-6989586621683974927"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621683974926"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1154"></a><span>   </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974928"><a href="#local-6989586621683974928"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#isTypedSplice"><span class="hs-identifier hs-var">isTypedSplice</span></a><span> </span><a href="#local-6989586621683974928"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-1155"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974928"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-1156"></a><span>   </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#patFail"><span class="hs-identifier hs-var">patFail</span></a><span> </span><a href="#local-6989586621683974880"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974881"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974882"><span class="hs-identifier hs-var">e0</span></a><span>
</span><a name="line-1157"></a><span>
</span><a name="line-1158"></a><span class="hs-identifier">placeHolderPunRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1159"></a><span class="hs-comment">-- The RHS of a punned record field will be filled in by the renamer</span><span>
</span><a name="line-1160"></a><span class="hs-comment">-- It's better not to make it an error, in case we want to print it when</span><span>
</span><a name="line-1161"></a><span class="hs-comment">-- debugging</span><span>
</span><a name="line-1162"></a><a name="placeHolderPunRhs"><a href="RdrHsSyn.html#placeHolderPunRhs"><span class="hs-identifier">placeHolderPunRhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="RdrHsSyn.html#pun_RDR"><span class="hs-identifier hs-var">pun_RDR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1163"></a><span>
</span><a name="line-1164"></a><span class="hs-identifier">plus_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bang_RDR</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pun_RDR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1165"></a><a name="plus_RDR"><a href="RdrHsSyn.html#plus_RDR"><span class="hs-identifier">plus_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Hack</span><span>
</span><a name="line-1166"></a><a name="bang_RDR"><a href="RdrHsSyn.html#bang_RDR"><span class="hs-identifier">bang_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Hack</span><span>
</span><a name="line-1167"></a><a name="pun_RDR"><a href="RdrHsSyn.html#pun_RDR"><span class="hs-identifier">pun_RDR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;pun-right-hand-side&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1168"></a><span>
</span><a name="line-1169"></a><span class="hs-identifier">isBangRdr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1170"></a><a name="isBangRdr"><a href="RdrHsSyn.html#isBangRdr"><span class="hs-identifier">isBangRdr</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#Unqual"><span class="hs-identifier hs-var">Unqual</span></a><span> </span><a name="local-6989586621683974929"><a href="#local-6989586621683974929"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-6989586621683974929"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-1171"></a><span class="hs-identifier">isBangRdr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1172"></a><span>
</span><a name="line-1173"></a><span class="hs-identifier">checkPatField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1175"></a><a name="checkPatField"><a href="RdrHsSyn.html#checkPatField"><span class="hs-identifier">checkPatField</span></a></a><span> </span><a name="local-6989586621683974930"><a href="#local-6989586621683974930"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974931"><a href="#local-6989586621683974931"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683974932"><a href="#local-6989586621683974932"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974933"><a href="#local-6989586621683974933"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkLPat"><span class="hs-identifier hs-var">checkLPat</span></a><span> </span><a href="#local-6989586621683974930"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621683974932"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1176"></a><span>                                     </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974931"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974932"><span class="hs-identifier hs-var">fld</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974933"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span class="hs-identifier">patFail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974401"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1179"></a><a name="patFail"><a href="RdrHsSyn.html#patFail"><span class="hs-identifier">patFail</span></a></a><span> </span><a name="local-6989586621683974934"><a href="#local-6989586621683974934"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974935"><a href="#local-6989586621683974935"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683974936"><a href="#local-6989586621683974936"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974935"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683974937"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-1180"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974937"><a href="#local-6989586621683974937"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Parse error in pattern:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974936"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1181"></a><span>             </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="#local-6989586621683974934"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-1182"></a><span>
</span><a name="line-1183"></a><span class="hs-identifier">patIsRec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1184"></a><a name="patIsRec"><a href="RdrHsSyn.html#patIsRec"><span class="hs-identifier">patIsRec</span></a></a><span> </span><a name="local-6989586621683974938"><a href="#local-6989586621683974938"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974938"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;rec&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1185"></a><span>
</span><a name="line-1186"></a><span>
</span><a name="line-1187"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-1188"></a><span class="hs-comment">-- Check Equation Syntax</span><span>
</span><a name="line-1189"></a><span>
</span><a name="line-1190"></a><span class="hs-identifier">checkValDef</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1191"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span>
</span><a name="line-1192"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1193"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1194"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974400"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1195"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><a name="checkValDef"><a href="RdrHsSyn.html#checkValDef"><span class="hs-identifier">checkValDef</span></a></a><span> </span><a name="local-6989586621683974939"><a href="#local-6989586621683974939"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974940"><a href="#local-6989586621683974940"><span class="hs-identifier">_strictness</span></a></a><span> </span><a name="local-6989586621683974941"><a href="#local-6989586621683974941"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683974942"><a href="#local-6989586621683974942"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683974943"><a href="#local-6989586621683974943"><span class="hs-identifier">grhss</span></a></a><span>
</span><a name="line-1198"></a><span>        </span><span class="hs-comment">-- x :: ty = rhs  parses as a *pattern* binding</span><span>
</span><a name="line-1199"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#checkPatBind"><span class="hs-identifier hs-var">checkPatBind</span></a><span> </span><a href="#local-6989586621683974939"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621683974941"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683974942"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span>
</span><a name="line-1200"></a><span>                        </span><span class="hs-special">(</span><a href="HsExpr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974941"><span class="hs-identifier hs-var">lhs</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span> </span><a href="#local-6989586621683974942"><span class="hs-identifier hs-var">sig</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683974943"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-identifier">checkValDef</span><span> </span><a name="local-6989586621683974944"><a href="#local-6989586621683974944"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974945"><a href="#local-6989586621683974945"><span class="hs-identifier">strictness</span></a></a><span> </span><a name="local-6989586621683974946"><a href="#local-6989586621683974946"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621683974947"><a href="#local-6989586621683974947"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974948"><a href="#local-6989586621683974948"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621683974949"><a href="#local-6989586621683974949"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683974950"><a href="#local-6989586621683974950"><span class="hs-identifier">mb_fun</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#isFunLhs"><span class="hs-identifier hs-var">isFunLhs</span></a><span> </span><a href="#local-6989586621683974946"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1204"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683974950"><span class="hs-identifier hs-var">mb_fun</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1205"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683974951"><a href="#local-6989586621683974951"><span class="hs-identifier">fun</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974952"><a href="#local-6989586621683974952"><span class="hs-identifier">is_infix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974953"><a href="#local-6989586621683974953"><span class="hs-identifier">pats</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683974954"><a href="#local-6989586621683974954"><span class="hs-identifier">ann</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1206"></a><span>              </span><a href="RdrHsSyn.html#checkFunBind"><span class="hs-identifier hs-var">checkFunBind</span></a><span> </span><a href="#local-6989586621683974944"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974945"><span class="hs-identifier hs-var">strictness</span></a><span> </span><a href="#local-6989586621683974954"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683974946"><span class="hs-identifier hs-var">lhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>                           </span><a href="#local-6989586621683974951"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621683974952"><span class="hs-identifier hs-var">is_infix</span></a><span> </span><a href="#local-6989586621683974953"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974948"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683974949"><span class="hs-identifier hs-var">grhss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#checkPatBind"><span class="hs-identifier hs-var">checkPatBind</span></a><span> </span><a href="#local-6989586621683974944"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974946"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683974947"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1209"></a><span>
</span><a name="line-1210"></a><span class="hs-identifier">checkFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1211"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span>
</span><a name="line-1212"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-1213"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-1214"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1215"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#LexicalFixity"><span class="hs-identifier hs-type">LexicalFixity</span></a><span>
</span><a name="line-1216"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1217"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1218"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1219"></a><a name="checkFunBind"><a href="RdrHsSyn.html#checkFunBind"><span class="hs-identifier">checkFunBind</span></a></a><span> </span><a name="local-6989586621683974955"><a href="#local-6989586621683974955"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974956"><a href="#local-6989586621683974956"><span class="hs-identifier">strictness</span></a></a><span> </span><a name="local-6989586621683974957"><a href="#local-6989586621683974957"><span class="hs-identifier">ann</span></a></a><span> </span><a name="local-6989586621683974958"><a href="#local-6989586621683974958"><span class="hs-identifier">lhs_loc</span></a></a><span> </span><a name="local-6989586621683974959"><a href="#local-6989586621683974959"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621683974960"><a href="#local-6989586621683974960"><span class="hs-identifier">is_infix</span></a></a><span> </span><a name="local-6989586621683974961"><a href="#local-6989586621683974961"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974962"><a href="#local-6989586621683974962"><span class="hs-identifier">rhs_span</span></a></a><span> </span><a name="local-6989586621683974963"><a href="#local-6989586621683974963"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1220"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><a name="local-6989586621683974964"><a href="#local-6989586621683974964"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkPatterns"><span class="hs-identifier hs-var">checkPatterns</span></a><span> </span><a href="#local-6989586621683974955"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974961"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1221"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683974965"><a href="#local-6989586621683974965"><span class="hs-identifier">match_span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683974958"><span class="hs-identifier hs-var">lhs_loc</span></a><span> </span><a href="#local-6989586621683974962"><span class="hs-identifier hs-var">rhs_span</span></a><span>
</span><a name="line-1222"></a><span>        </span><span class="hs-comment">-- Add back the annotations stripped from any HsPar values in the lhs</span><span>
</span><a name="line-1223"></a><span>        </span><span class="hs-comment">-- mapM_ (\a -&gt; a match_span) ann</span><span>
</span><a name="line-1224"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974957"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#makeFunBind"><span class="hs-identifier hs-var">makeFunBind</span></a><span> </span><a href="#local-6989586621683974959"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-1225"></a><span>                  </span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974965"><span class="hs-identifier hs-var">match_span</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-1226"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span>
</span><a name="line-1227"></a><span>                                            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mc_fun</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974959"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-1228"></a><span>                                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974960"><span class="hs-identifier hs-var">is_infix</span></a><span>
</span><a name="line-1229"></a><span>                                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_strictness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974956"><span class="hs-identifier hs-var">strictness</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1230"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974964"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1231"></a><span>                                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974963"><span class="hs-identifier hs-var">grhss</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1232"></a><span>        </span><span class="hs-comment">-- The span of the match covers the entire equation.</span><span>
</span><a name="line-1233"></a><span>        </span><span class="hs-comment">-- That isn't quite right, but it'll do for now.</span><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-identifier">makeFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1236"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1237"></a><span class="hs-comment">-- Like HsUtils.mkFunBind, but we need to be able to set the fixity too</span><span>
</span><a name="line-1238"></a><a name="makeFunBind"><a href="RdrHsSyn.html#makeFunBind"><span class="hs-identifier">makeFunBind</span></a></a><span> </span><a name="local-6989586621683974966"><a href="#local-6989586621683974966"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621683974967"><a href="#local-6989586621683974967"><span class="hs-identifier">ms</span></a></a><span>
</span><a name="line-1239"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span>
</span><a name="line-1240"></a><span>              </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974966"><span class="hs-identifier hs-var">fn</span></a><span class="hs-special">,</span><span>
</span><a name="line-1241"></a><span>              </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#FromSource"><span class="hs-identifier hs-var">FromSource</span></a><span> </span><a href="#local-6989586621683974967"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">,</span><span>
</span><a name="line-1242"></a><span>              </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span class="hs-special">,</span><span>
</span><a name="line-1243"></a><span>              </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1244"></a><span>
</span><a name="line-1245"></a><span class="hs-identifier">checkPatBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1246"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1247"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974399"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1249"></a><a name="checkPatBind"><a href="RdrHsSyn.html#checkPatBind"><span class="hs-identifier">checkPatBind</span></a></a><span> </span><a name="local-6989586621683974968"><a href="#local-6989586621683974968"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621683974969"><a href="#local-6989586621683974969"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621683974970"><a href="#local-6989586621683974970"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683974971"><a href="#local-6989586621683974971"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkPattern"><span class="hs-identifier hs-var">checkPattern</span></a><span> </span><a href="#local-6989586621683974968"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621683974969"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1251"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974971"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683974970"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-1252"></a><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1253"></a><span>
</span><a name="line-1254"></a><span class="hs-identifier">checkValSigLhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1255"></a><a name="checkValSigLhs"><a href="RdrHsSyn.html#checkValSigLhs"><span class="hs-identifier">checkValSigLhs</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974972"><a href="#local-6989586621683974972"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974973"><a href="#local-6989586621683974973"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isUnqual"><span class="hs-identifier hs-var">isUnqual</span></a><span> </span><a href="#local-6989586621683974973"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1257"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621683974973"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1258"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683974972"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-1259"></a><span>
</span><a name="line-1260"></a><span class="hs-identifier">checkValSigLhs</span><span> </span><a name="local-6989586621683974974"><a href="#local-6989586621683974974"><span class="hs-identifier">lhs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683974975"><a href="#local-6989586621683974975"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683974975"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Invalid type signature:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1262"></a><span>                       </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974974"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;:: ...&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>                      </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621683974976"><span class="hs-identifier hs-var">hint</span></a><span class="hs-special">)</span><span>
</span><a name="line-1264"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1265"></a><span>    </span><a name="local-6989586621683974976"><a href="#local-6989586621683974976"><span class="hs-identifier">hint</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974978"><span class="hs-identifier hs-var">foreign_RDR</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683974977"><span class="hs-identifier hs-var">looks_like</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683974974"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1266"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Perhaps you meant to use ForeignFunctionInterface?&quot;</span><span>
</span><a name="line-1267"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974979"><span class="hs-identifier hs-var">default_RDR</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683974977"><span class="hs-identifier hs-var">looks_like</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683974974"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1268"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Perhaps you meant to use DefaultSignatures?&quot;</span><span>
</span><a name="line-1269"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974980"><span class="hs-identifier hs-var">pattern_RDR</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683974977"><span class="hs-identifier hs-var">looks_like</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683974974"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1270"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Perhaps you meant to use PatternSynonyms?&quot;</span><span>
</span><a name="line-1271"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1272"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Should be of form &lt;variable&gt; :: &lt;type&gt;&quot;</span><span>
</span><a name="line-1273"></a><span>
</span><a name="line-1274"></a><span>    </span><span class="hs-comment">-- A common error is to forget the ForeignFunctionInterface flag</span><span>
</span><a name="line-1275"></a><span>    </span><span class="hs-comment">-- so check for that, and suggest.  cf Trac #3805</span><span>
</span><a name="line-1276"></a><span>    </span><span class="hs-comment">-- Sadly 'foreign import' still barfs 'parse error' because</span><span>
</span><a name="line-1277"></a><span>    </span><span class="hs-comment">--  'import' is a keyword</span><span>
</span><a name="line-1278"></a><span>    </span><a name="local-6989586621683974977"><a href="#local-6989586621683974977"><span class="hs-identifier">looks_like</span></a></a><span> </span><a name="local-6989586621683974981"><a href="#local-6989586621683974981"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974982"><a href="#local-6989586621683974982"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974982"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621683974981"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1279"></a><span>    </span><span class="hs-identifier">looks_like</span><span> </span><a name="local-6989586621683974983"><a href="#local-6989586621683974983"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974984"><a href="#local-6989586621683974984"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683974977"><span class="hs-identifier hs-var">looks_like</span></a><span> </span><a href="#local-6989586621683974983"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621683974984"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1280"></a><span>    </span><span class="hs-identifier">looks_like</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1281"></a><span>
</span><a name="line-1282"></a><span>    </span><a name="local-6989586621683974978"><a href="#local-6989586621683974978"><span class="hs-identifier">foreign_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;foreign&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>    </span><a name="local-6989586621683974979"><a href="#local-6989586621683974979"><span class="hs-identifier">default_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;default&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>    </span><a name="local-6989586621683974980"><a href="#local-6989586621683974980"><span class="hs-identifier">pattern_RDR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#varName"><span class="hs-identifier hs-var">varName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;pattern&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1285"></a><span>
</span><a name="line-1286"></a><span>
</span><a name="line-1287"></a><span class="hs-identifier">checkDoAndIfThenElse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1288"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1289"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1290"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1291"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1292"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1293"></a><a name="checkDoAndIfThenElse"><a href="RdrHsSyn.html#checkDoAndIfThenElse"><span class="hs-identifier">checkDoAndIfThenElse</span></a></a><span> </span><a name="local-6989586621683974985"><a href="#local-6989586621683974985"><span class="hs-identifier">guardExpr</span></a></a><span> </span><a name="local-6989586621683974986"><a href="#local-6989586621683974986"><span class="hs-identifier">semiThen</span></a></a><span> </span><a name="local-6989586621683974987"><a href="#local-6989586621683974987"><span class="hs-identifier">thenExpr</span></a></a><span> </span><a name="local-6989586621683974988"><a href="#local-6989586621683974988"><span class="hs-identifier">semiElse</span></a></a><span> </span><a name="local-6989586621683974989"><a href="#local-6989586621683974989"><span class="hs-identifier">elseExpr</span></a></a><span>
</span><a name="line-1294"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974986"><span class="hs-identifier hs-var">semiThen</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621683974988"><span class="hs-identifier hs-var">semiElse</span></a><span>
</span><a name="line-1295"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683974992"><a href="#local-6989586621683974992"><span class="hs-identifier">doAndIfThenElse</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#DoAndIfThenElseBit"><span class="hs-identifier hs-var">DoAndIfThenElseBit</span></a><span>
</span><a name="line-1296"></a><span>         </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621683974992"><span class="hs-identifier hs-var">doAndIfThenElse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1297"></a><span>             </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621683974985"><span class="hs-identifier hs-var">guardExpr</span></a><span> </span><a href="#local-6989586621683974989"><span class="hs-identifier hs-var">elseExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>                            </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected semi-colons in conditional:&quot;</span><span>
</span><a name="line-1299"></a><span>                          </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><a href="#local-6989586621683974991"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1300"></a><span>                          </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you meant to use DoAndIfThenElse?&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1301"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1302"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683974990"><a href="#local-6989586621683974990"><span class="hs-identifier">pprOptSemi</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#semi"><span class="hs-identifier hs-var">semi</span></a><span>
</span><a name="line-1303"></a><span>          </span><span class="hs-identifier">pprOptSemi</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1304"></a><span>          </span><a name="local-6989586621683974991"><a href="#local-6989586621683974991"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;if&quot;</span><span>   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974985"><span class="hs-identifier hs-var">guardExpr</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621683974990"><span class="hs-identifier hs-var">pprOptSemi</span></a><span> </span><a href="#local-6989586621683974986"><span class="hs-identifier hs-var">semiThen</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1305"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;then&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974987"><span class="hs-identifier hs-var">thenExpr</span></a><span>  </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621683974990"><span class="hs-identifier hs-var">pprOptSemi</span></a><span> </span><a href="#local-6989586621683974988"><span class="hs-identifier hs-var">semiElse</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1306"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;else&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974989"><span class="hs-identifier hs-var">elseExpr</span></a><span>
</span><a name="line-1307"></a><span>
</span><a name="line-1308"></a><span>
</span><a name="line-1309"></a><span>        </span><span class="hs-comment">-- The parser left-associates, so there should</span><span>
</span><a name="line-1310"></a><span>        </span><span class="hs-comment">-- not be any OpApps inside the e's</span><span>
</span><a name="line-1311"></a><span class="hs-identifier">splitBang</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1312"></a><span class="hs-comment">-- Splits (f ! g a b) into (f, [(! g), a, b])</span><span>
</span><a name="line-1313"></a><a name="splitBang"><a href="RdrHsSyn.html#splitBang"><span class="hs-identifier">splitBang</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974993"><a href="#local-6989586621683974993"><span class="hs-identifier">l_arg</span></a></a><span> </span><a name="local-6989586621683974994"><a href="#local-6989586621683974994"><span class="hs-identifier">bang</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974995"><a href="#local-6989586621683974995"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683974996"><a href="#local-6989586621683974996"><span class="hs-identifier">r_arg</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1314"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683974995"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="RdrHsSyn.html#bang_RDR"><span class="hs-identifier hs-var">bang_RDR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683974993"><span class="hs-identifier hs-var">l_arg</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683974997"><span class="hs-identifier hs-var">l'</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683974994"><span class="hs-identifier hs-var">bang</span></a><span> </span><a href="#local-6989586621683974998"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683974999"><span class="hs-identifier hs-var">argns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1315"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1316"></a><span>    </span><a name="local-6989586621683974997"><a href="#local-6989586621683974997"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621683974994"><span class="hs-identifier hs-var">bang</span></a><span> </span><a href="#local-6989586621683974998"><span class="hs-identifier hs-var">arg1</span></a><span>
</span><a name="line-1317"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683974998"><a href="#local-6989586621683974998"><span class="hs-identifier">arg1</span></a></a><span class="hs-special">,</span><a name="local-6989586621683974999"><a href="#local-6989586621683974999"><span class="hs-identifier">argns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975000"><span class="hs-identifier hs-var">split_bang</span></a><span> </span><a href="#local-6989586621683974996"><span class="hs-identifier hs-var">r_arg</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1318"></a><span>    </span><a name="local-6989586621683975000"><a href="#local-6989586621683975000"><span class="hs-identifier">split_bang</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975001"><a href="#local-6989586621683975001"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683975002"><a href="#local-6989586621683975002"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975003"><a href="#local-6989586621683975003"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975000"><span class="hs-identifier hs-var">split_bang</span></a><span> </span><a href="#local-6989586621683975001"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975002"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975003"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>    </span><span class="hs-identifier">split_bang</span><span> </span><a name="local-6989586621683975004"><a href="#local-6989586621683975004"><span class="hs-identifier">e</span></a></a><span>                       </span><a name="local-6989586621683975005"><a href="#local-6989586621683975005"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975004"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><a href="#local-6989586621683975005"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-1320"></a><span class="hs-identifier">splitBang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1321"></a><span>
</span><a name="line-1322"></a><span class="hs-comment">-- See Note [isFunLhs vs mergeDataCon]</span><span>
</span><a name="line-1323"></a><span class="hs-identifier">isFunLhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1324"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#LexicalFixity"><span class="hs-identifier hs-type">LexicalFixity</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span class="hs-comment">-- A variable binding is parsed as a FunBind.</span><span>
</span><a name="line-1326"></a><span class="hs-comment">-- Just (fun, is_infix, arg_pats) if e is a function LHS</span><span>
</span><a name="line-1327"></a><span class="hs-comment">--</span><span>
</span><a name="line-1328"></a><span class="hs-comment">-- The whole LHS is parsed as a single expression.</span><span>
</span><a name="line-1329"></a><span class="hs-comment">-- Any infix operators on the LHS will parse left-associatively</span><span>
</span><a name="line-1330"></a><span class="hs-comment">-- E.g.         f !x y !z</span><span>
</span><a name="line-1331"></a><span class="hs-comment">--      will parse (rather strangely) as</span><span>
</span><a name="line-1332"></a><span class="hs-comment">--              (f ! x y) ! z</span><span>
</span><a name="line-1333"></a><span class="hs-comment">--      It's up to isFunLhs to sort out the mess</span><span>
</span><a name="line-1334"></a><span class="hs-comment">--</span><span>
</span><a name="line-1335"></a><span class="hs-comment">-- a .!. !b</span><span>
</span><a name="line-1336"></a><span>
</span><a name="line-1337"></a><a name="isFunLhs"><a href="RdrHsSyn.html#isFunLhs"><span class="hs-identifier">isFunLhs</span></a></a><span> </span><a name="local-6989586621683975006"><a href="#local-6989586621683975006"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975007"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975006"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1338"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1339"></a><span>   </span><a name="local-6989586621683975007"><a href="#local-6989586621683975007"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975008"><a href="#local-6989586621683975008"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975009"><a href="#local-6989586621683975009"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975010"><a href="#local-6989586621683975010"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621683975011"><a href="#local-6989586621683975011"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-1340"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a><span> </span><a href="#local-6989586621683975009"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975008"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975009"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975010"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975011"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1341"></a><span>   </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975012"><a href="#local-6989586621683975012"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683975013"><a href="#local-6989586621683975013"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975014"><a href="#local-6989586621683975014"><span class="hs-identifier">es</span></a></a><span>       </span><a name="local-6989586621683975015"><a href="#local-6989586621683975015"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975007"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975012"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975013"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975014"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975015"><span class="hs-identifier hs-var">ann</span></a><span>
</span><a name="line-1342"></a><span>   </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975016"><a href="#local-6989586621683975016"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975017"><a href="#local-6989586621683975017"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><a name="local-6989586621683975018"><a href="#local-6989586621683975018"><span class="hs-identifier">es</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975019"><a href="#local-6989586621683975019"><span class="hs-identifier">ann</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975007"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975017"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621683975018"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975019"><span class="hs-identifier hs-var">ann</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lexer.html#mkParensApiAnn"><span class="hs-identifier hs-var">mkParensApiAnn</span></a><span> </span><a href="#local-6989586621683975016"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1343"></a><span>
</span><a name="line-1344"></a><span>        </span><span class="hs-comment">-- Things of the form `!x` are also FunBinds</span><span>
</span><a name="line-1345"></a><span>        </span><span class="hs-comment">-- See Note [FunBind vs PatBind]</span><span>
</span><a name="line-1346"></a><span>   </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SectionR"><span class="hs-identifier hs-var">SectionR</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975020"><a href="#local-6989586621683975020"><span class="hs-identifier">bang</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><span>                </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975021"><a href="#local-6989586621683975021"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975022"><a href="#local-6989586621683975022"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621683975023"><a href="#local-6989586621683975023"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-1348"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683975020"><span class="hs-identifier hs-var">bang</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="RdrHsSyn.html#bang_RDR"><span class="hs-identifier hs-var">bang_RDR</span></a><span>
</span><a name="line-1349"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a><span> </span><a href="#local-6989586621683975022"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975021"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975022"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975023"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1350"></a><span>
</span><a name="line-1351"></a><span>      </span><span class="hs-comment">-- For infix function defns, there should be only one infix *function*</span><span>
</span><a name="line-1352"></a><span>      </span><span class="hs-comment">-- (though there may be infix *datacons* involved too).  So we don't</span><span>
</span><a name="line-1353"></a><span>      </span><span class="hs-comment">-- need fixity info to figure out which function is being defined.</span><span>
</span><a name="line-1354"></a><span>      </span><span class="hs-comment">--      a `K1` b `op` c `K2` d</span><span>
</span><a name="line-1355"></a><span>      </span><span class="hs-comment">-- must parse as</span><span>
</span><a name="line-1356"></a><span>      </span><span class="hs-comment">--      (a `K1` b) `op` (c `K2` d)</span><span>
</span><a name="line-1357"></a><span>      </span><span class="hs-comment">-- The renamer checks later that the precedences would yield such a parse.</span><span>
</span><a name="line-1358"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-1359"></a><span>      </span><span class="hs-comment">-- There is a complication to deal with bang patterns.</span><span>
</span><a name="line-1360"></a><span>      </span><span class="hs-comment">--</span><span>
</span><a name="line-1361"></a><span>      </span><span class="hs-comment">-- ToDo: what about this?</span><span>
</span><a name="line-1362"></a><span>      </span><span class="hs-comment">--              x + 1 `op` y = ...</span><span>
</span><a name="line-1363"></a><span>
</span><a name="line-1364"></a><span>   </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975024"><a href="#local-6989586621683975024"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975025"><a href="#local-6989586621683975025"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975026"><a href="#local-6989586621683975026"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975027"><a href="#local-6989586621683975027"><span class="hs-identifier">loc'</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975028"><a href="#local-6989586621683975028"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975029"><a href="#local-6989586621683975029"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975030"><a href="#local-6989586621683975030"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621683975031"><a href="#local-6989586621683975031"><span class="hs-identifier">ann</span></a></a><span>
</span><a name="line-1365"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975032"><a href="#local-6989586621683975032"><span class="hs-identifier">e'</span></a></a><span class="hs-special">,</span><a name="local-6989586621683975033"><a href="#local-6989586621683975033"><span class="hs-identifier">es'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#splitBang"><span class="hs-identifier hs-var">splitBang</span></a><span> </span><a href="#local-6989586621683975024"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1366"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975034"><a href="#local-6989586621683975034"><span class="hs-identifier">bang_on</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#BangPatBit"><span class="hs-identifier hs-var">BangPatBit</span></a><span>
</span><a name="line-1367"></a><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683975034"><span class="hs-identifier hs-var">bang_on</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621683975007"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975032"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975033"><span class="hs-identifier hs-var">es'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683975030"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975031"><span class="hs-identifier hs-var">ann</span></a><span>
</span><a name="line-1368"></a><span>               </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975027"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621683975028"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975026"><span class="hs-identifier hs-var">l</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975029"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975030"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975031"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1369"></a><span>                </span><span class="hs-comment">-- No bangs; behave just like the next case</span><span>
</span><a name="line-1370"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a><span> </span><a href="#local-6989586621683975028"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- We have found the function!</span><span>
</span><a name="line-1371"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975027"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621683975028"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975026"><span class="hs-identifier hs-var">l</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975029"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975030"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975031"><span class="hs-identifier hs-var">ann</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1372"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-comment">-- Infix data con; keep going</span><span>
</span><a name="line-1373"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975035"><a href="#local-6989586621683975035"><span class="hs-identifier">mb_l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975007"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975026"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975030"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621683975031"><span class="hs-identifier hs-var">ann</span></a><span>
</span><a name="line-1374"></a><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975035"><span class="hs-identifier hs-var">mb_l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1375"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975036"><a href="#local-6989586621683975036"><span class="hs-identifier">op'</span></a></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975037"><a href="#local-6989586621683975037"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975038"><a href="#local-6989586621683975038"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975039"><a href="#local-6989586621683975039"><span class="hs-identifier">es'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975040"><a href="#local-6989586621683975040"><span class="hs-identifier">ann'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1376"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975036"><span class="hs-identifier hs-var">op'</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975037"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683975041"><span class="hs-identifier hs-var">op_app</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683975039"><span class="hs-identifier hs-var">es'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975040"><span class="hs-identifier hs-var">ann'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1377"></a><span>                   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1378"></a><span>                     </span><a name="local-6989586621683975041"><a href="#local-6989586621683975041"><span class="hs-identifier">op_app</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975025"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975038"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1379"></a><span>                               </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975027"><span class="hs-identifier hs-var">loc'</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975027"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621683975028"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975029"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1380"></a><span>                 </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1381"></a><span>   </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1382"></a><span>
</span><a name="line-1383"></a><span class="hs-comment">-- | Either an operator or an operand.</span><span>
</span><a name="line-1384"></a><span class="hs-keyword">data</span><span> </span><a name="TyEl"><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier">TyEl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TyElOpr"><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier">TyElOpr</span></a></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TyElOpd"><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier">TyElOpd</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1385"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="TyElKindApp"><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier">TyElKindApp</span></a></a><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1386"></a><span>          </span><span class="hs-comment">-- See Note [TyElKindApp SrcSpan interpretation]</span><span>
</span><a name="line-1387"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="TyElTilde"><a href="RdrHsSyn.html#TyElTilde"><span class="hs-identifier">TyElTilde</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TyElBang"><a href="RdrHsSyn.html#TyElBang"><span class="hs-identifier">TyElBang</span></a></a><span>
</span><a name="line-1388"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="TyElUnpackedness"><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier">TyElUnpackedness</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#SrcUnpackedness"><span class="hs-identifier hs-type">SrcUnpackedness</span></a><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="TyElDocPrev"><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier">TyElDocPrev</span></a></a><span> </span><a href="HsDoc.html#HsDocString"><span class="hs-identifier hs-type">HsDocString</span></a><span>
</span><a name="line-1390"></a><span>
</span><a name="line-1391"></a><span>
</span><a name="line-1392"></a><span class="hs-comment">{- Note [TyElKindApp SrcSpan interpretation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A TyElKindApp captures type application written in haskell as

    @ Foo

where Foo is some type.

The SrcSpan reflects both elements, and there are AnnAt and AnnVal API
Annotations attached to this SrcSpan for the specific locations of
each within it.
-}</span><span>
</span><a name="line-1405"></a><span>
</span><a name="line-1406"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1407"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><a name="local-6989586621683974381"><a href="#local-6989586621683974381"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974381"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1408"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683974382"><a href="#local-6989586621683974382"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974382"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1409"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683974383"><a href="#local-6989586621683974383"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974383"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1410"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RdrHsSyn.html#TyElTilde"><span class="hs-identifier hs-var">TyElTilde</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;~&quot;</span><span>
</span><a name="line-1411"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RdrHsSyn.html#TyElBang"><span class="hs-identifier hs-var">TyElBang</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-1412"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier hs-var">TyElUnpackedness</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683974384"><a href="#local-6989586621683974384"><span class="hs-identifier">unpk</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974384"><span class="hs-identifier hs-var">unpk</span></a><span>
</span><a name="line-1413"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><a name="local-6989586621683974385"><a href="#local-6989586621683974385"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683974385"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-1414"></a><span>
</span><a name="line-1415"></a><span class="hs-identifier">tyElStrictness</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="ApiAnnotation.html#AnnKeywordId"><span class="hs-identifier hs-type">AnnKeywordId</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span class="hs-special">)</span><span>
</span><a name="line-1416"></a><a name="tyElStrictness"><a href="RdrHsSyn.html#tyElStrictness"><span class="hs-identifier">tyElStrictness</span></a></a><span> </span><a href="RdrHsSyn.html#TyElTilde"><span class="hs-identifier hs-var">TyElTilde</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="ApiAnnotation.html#AnnTilde"><span class="hs-identifier hs-var">AnnTilde</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#SrcLazy"><span class="hs-identifier hs-var">SrcLazy</span></a><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">tyElStrictness</span><span> </span><a href="RdrHsSyn.html#TyElBang"><span class="hs-identifier hs-var">TyElBang</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="ApiAnnotation.html#AnnBang"><span class="hs-identifier hs-var">AnnBang</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><span class="hs-identifier">tyElStrictness</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1419"></a><span>
</span><a name="line-1420"></a><span class="hs-comment">-- | Extract a strictness/unpackedness annotation from the front of a reversed</span><span>
</span><a name="line-1421"></a><span class="hs-comment">-- 'TyEl' list.</span><span>
</span><a name="line-1422"></a><span class="hs-identifier">pStrictMark</span><span>
</span><a name="line-1423"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- reversed TyEl</span><span>
</span><a name="line-1424"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a><span> </span><span class="hs-comment">{- a strictness/upnackedness marker -}</span><span>
</span><a name="line-1425"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span>
</span><a name="line-1426"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">{- remaining TyEl -}</span><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><a name="pStrictMark"><a href="RdrHsSyn.html#pStrictMark"><span class="hs-identifier">pStrictMark</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975042"><a href="#local-6989586621683975042"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621683975043"><a href="#local-6989586621683975043"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975044"><a href="#local-6989586621683975044"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621683975045"><a href="#local-6989586621683975045"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975046"><a href="#local-6989586621683975046"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1428"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975047"><a href="#local-6989586621683975047"><span class="hs-identifier">strAnnId</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975048"><a href="#local-6989586621683975048"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyElStrictness"><span class="hs-identifier hs-var">tyElStrictness</span></a><span> </span><a href="#local-6989586621683975043"><span class="hs-identifier hs-var">x1</span></a><span>
</span><a name="line-1429"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier hs-var">TyElUnpackedness</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975049"><a href="#local-6989586621683975049"><span class="hs-identifier">unpkAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975050"><a href="#local-6989586621683975050"><span class="hs-identifier">prag</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975051"><a href="#local-6989586621683975051"><span class="hs-identifier">unpk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975045"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-1430"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683975042"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621683975044"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-var">HsSrcBang</span></a><span> </span><a href="#local-6989586621683975050"><span class="hs-identifier hs-var">prag</span></a><span> </span><a href="#local-6989586621683975051"><span class="hs-identifier hs-var">unpk</span></a><span> </span><a href="#local-6989586621683975048"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1431"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975049"><span class="hs-identifier hs-var">unpkAnns</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">\</span><a name="local-6989586621683975052"><a href="#local-6989586621683975052"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#addAnnotation"><span class="hs-identifier hs-var">addAnnotation</span></a><span> </span><a href="#local-6989586621683975052"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621683975047"><span class="hs-identifier hs-var">strAnnId</span></a><span> </span><a href="#local-6989586621683975042"><span class="hs-identifier hs-var">l1</span></a><span class="hs-special">]</span><span>
</span><a name="line-1432"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975046"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1433"></a><span class="hs-identifier">pStrictMark</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975053"><a href="#local-6989586621683975053"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975054"><a href="#local-6989586621683975054"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975055"><a href="#local-6989586621683975055"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1434"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975056"><a href="#local-6989586621683975056"><span class="hs-identifier">strAnnId</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975057"><a href="#local-6989586621683975057"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyElStrictness"><span class="hs-identifier hs-var">tyElStrictness</span></a><span> </span><a href="#local-6989586621683975054"><span class="hs-identifier hs-var">x1</span></a><span>
</span><a name="line-1435"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975053"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-var">HsSrcBang</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="DataCon.html#NoSrcUnpack"><span class="hs-identifier hs-var">NoSrcUnpack</span></a><span> </span><a href="#local-6989586621683975057"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1436"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">\</span><a name="local-6989586621683975058"><a href="#local-6989586621683975058"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#addAnnotation"><span class="hs-identifier hs-var">addAnnotation</span></a><span> </span><a href="#local-6989586621683975058"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621683975056"><span class="hs-identifier hs-var">strAnnId</span></a><span> </span><a href="#local-6989586621683975053"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-1437"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975055"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1438"></a><span class="hs-identifier">pStrictMark</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975059"><a href="#local-6989586621683975059"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975060"><a href="#local-6989586621683975060"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975061"><a href="#local-6989586621683975061"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier hs-var">TyElUnpackedness</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975062"><a href="#local-6989586621683975062"><span class="hs-identifier">anns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975063"><a href="#local-6989586621683975063"><span class="hs-identifier">prag</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975064"><a href="#local-6989586621683975064"><span class="hs-identifier">unpk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975060"><span class="hs-identifier hs-var">x1</span></a><span>
</span><a name="line-1440"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975059"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-var">HsSrcBang</span></a><span> </span><a href="#local-6989586621683975063"><span class="hs-identifier hs-var">prag</span></a><span> </span><a href="#local-6989586621683975064"><span class="hs-identifier hs-var">unpk</span></a><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975062"><span class="hs-identifier hs-var">anns</span></a><span>
</span><a name="line-1442"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975061"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1443"></a><span class="hs-identifier">pStrictMark</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1444"></a><span>
</span><a name="line-1445"></a><span class="hs-identifier">pBangTy</span><span>
</span><a name="line-1446"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">-- a type to be wrapped inside HsBangTy</span><span>
</span><a name="line-1447"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- reversed TyEl</span><span>
</span><a name="line-1448"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>           </span><span class="hs-comment">{- has a strict mark been consumed? -}</span><span>
</span><a name="line-1449"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">{- the resulting BangTy -}</span><span>
</span><a name="line-1450"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">{- add annotations -}</span><span>
</span><a name="line-1451"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">{- remaining TyEl -}</span><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><a name="pBangTy"><a href="RdrHsSyn.html#pBangTy"><span class="hs-identifier">pBangTy</span></a></a><span> </span><a name="local-6989586621683975065"><a href="#local-6989586621683975065"><span class="hs-identifier">lt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975066"><a href="#local-6989586621683975066"><span class="hs-identifier">l1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975067"><a href="#local-6989586621683975067"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1453"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="RdrHsSyn.html#pStrictMark"><span class="hs-identifier hs-var">pStrictMark</span></a><span> </span><a href="#local-6989586621683975067"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1454"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975065"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975067"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1455"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975068"><a href="#local-6989586621683975068"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621683975069"><a href="#local-6989586621683975069"><span class="hs-identifier">strictMark</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975070"><a href="#local-6989586621683975070"><span class="hs-identifier">anns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975071"><a href="#local-6989586621683975071"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1456"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975072"><a href="#local-6989586621683975072"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683975066"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621683975068"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-1457"></a><span>          </span><a name="local-6989586621683975073"><a href="#local-6989586621683975073"><span class="hs-identifier">bt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975069"><span class="hs-identifier hs-var">strictMark</span></a><span> </span><a href="#local-6989586621683975065"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-1458"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975072"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621683975073"><span class="hs-identifier hs-var">bt</span></a><span class="hs-special">,</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683975072"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621683975070"><span class="hs-identifier hs-var">anns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975071"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>
</span><a name="line-1460"></a><span class="hs-comment">-- | Merge a /reversed/ and /non-empty/ soup of operators and operands</span><span>
</span><a name="line-1461"></a><span class="hs-comment">--   into a type.</span><span>
</span><a name="line-1462"></a><span class="hs-comment">--</span><span>
</span><a name="line-1463"></a><span class="hs-comment">-- User input: @F x y + G a b * X@</span><span>
</span><a name="line-1464"></a><span class="hs-comment">-- Input to 'mergeOps': [X, *, b, a, G, +, y, x, F]</span><span>
</span><a name="line-1465"></a><span class="hs-comment">-- Output corresponds to what the user wrote assuming all operators are of the</span><span>
</span><a name="line-1466"></a><span class="hs-comment">-- same fixity and right-associative.</span><span>
</span><a name="line-1467"></a><span class="hs-comment">--</span><span>
</span><a name="line-1468"></a><span class="hs-comment">-- It's a bit silly that we're doing it at all, as the renamer will have to</span><span>
</span><a name="line-1469"></a><span class="hs-comment">-- rearrange this, and it'd be easier to keep things separate.</span><span>
</span><a name="line-1470"></a><span class="hs-comment">--</span><span>
</span><a name="line-1471"></a><span class="hs-comment">-- See Note [Parsing data constructors is hard]</span><span>
</span><a name="line-1472"></a><span class="hs-identifier">mergeOps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><a name="mergeOps"><a href="RdrHsSyn.html#mergeOps"><span class="hs-identifier">mergeOps</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975074"><a href="#local-6989586621683975074"><span class="hs-identifier">l1</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975075"><a href="#local-6989586621683975075"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975076"><a href="#local-6989586621683975076"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975077"><a href="#local-6989586621683975077"><span class="hs-identifier">t'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975078"><a href="#local-6989586621683975078"><span class="hs-identifier">addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975079"><a href="#local-6989586621683975079"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pBangTy"><span class="hs-identifier hs-var">pBangTy</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975074"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621683975075"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975076"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1475"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975079"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-comment">-- We accept a BangTy only when there are no preceding TyEl.</span><span>
</span><a name="line-1476"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975078"><span class="hs-identifier hs-var">addAnns</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683975077"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-1477"></a><span class="hs-identifier">mergeOps</span><span> </span><a name="local-6989586621683975080"><a href="#local-6989586621683975080"><span class="hs-identifier">all_xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621683975080"><span class="hs-identifier hs-var">all_xs</span></a><span>
</span><a name="line-1478"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1479"></a><span>    </span><span class="hs-comment">-- NB. When modifying clauses in 'go', make sure that the reasoning in</span><span>
</span><a name="line-1480"></a><span>    </span><span class="hs-comment">-- Note [Non-empty 'acc' in mergeOps clause [end]] is still correct.</span><span>
</span><a name="line-1481"></a><span>
</span><a name="line-1482"></a><span>    </span><span class="hs-comment">-- clause [unpk]:</span><span>
</span><a name="line-1483"></a><span>    </span><span class="hs-comment">-- handle (NO)UNPACK pragmas</span><span>
</span><a name="line-1484"></a><span>    </span><a name="local-6989586621683975081"><a href="#local-6989586621683975081"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683975082"><a href="#local-6989586621683975082"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975083"><a href="#local-6989586621683975083"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975084"><a href="#local-6989586621683975084"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975085"><a href="#local-6989586621683975085"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier hs-var">TyElUnpackedness</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975086"><a href="#local-6989586621683975086"><span class="hs-identifier">anns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975087"><a href="#local-6989586621683975087"><span class="hs-identifier">unpkSrc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975088"><a href="#local-6989586621683975088"><span class="hs-identifier">unpk</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975089"><a href="#local-6989586621683975089"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1485"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975083"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975089"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1486"></a><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975093"><a href="#local-6989586621683975093"><span class="hs-identifier">acc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975083"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1487"></a><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975094"><a href="#local-6989586621683975094"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975084"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975093"><span class="hs-identifier hs-var">acc'</span></a><span>
</span><a name="line-1488"></a><span>                    </span><a name="local-6989586621683975095"><a href="#local-6989586621683975095"><span class="hs-identifier">strictMark</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#HsSrcBang"><span class="hs-identifier hs-var">HsSrcBang</span></a><span> </span><a href="#local-6989586621683975087"><span class="hs-identifier hs-var">unpkSrc</span></a><span> </span><a href="#local-6989586621683975088"><span class="hs-identifier hs-var">unpk</span></a><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span>
</span><a name="line-1489"></a><span>                    </span><a name="local-6989586621683975096"><a href="#local-6989586621683975096"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621683975085"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975094"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1490"></a><span>                    </span><a name="local-6989586621683975097"><a href="#local-6989586621683975097"><span class="hs-identifier">bt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975095"><span class="hs-identifier hs-var">strictMark</span></a><span> </span><a href="#local-6989586621683975094"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1491"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="Lexer.html#addAnnsAt"><span class="hs-identifier hs-var">addAnnsAt</span></a><span> </span><a href="#local-6989586621683975096"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621683975086"><span class="hs-identifier hs-var">anns</span></a><span>
</span><a name="line-1492"></a><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975096"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621683975097"><span class="hs-identifier hs-var">bt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1493"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975085"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975091"><span class="hs-identifier hs-var">unpkError</span></a><span>
</span><a name="line-1494"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1495"></a><span>        </span><a name="local-6989586621683975090"><a href="#local-6989586621683975090"><span class="hs-identifier">unpkSDoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975087"><span class="hs-identifier hs-var">unpkSrc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1496"></a><span>          </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975088"><span class="hs-identifier hs-var">unpk</span></a><span>
</span><a name="line-1497"></a><span>          </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-var">SourceText</span></a><span> </span><a name="local-6989586621683975092"><a href="#local-6989586621683975092"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621683975092"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot; #-}&quot;</span><span>
</span><a name="line-1498"></a><span>        </span><a name="local-6989586621683975091"><a href="#local-6989586621683975091"><span class="hs-identifier">unpkError</span></a></a><span>
</span><a name="line-1499"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975089"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975090"><span class="hs-identifier hs-var">unpkSDoc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;cannot appear inside a type.&quot;</span><span>
</span><a name="line-1500"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975083"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621683975082"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975090"><span class="hs-identifier hs-var">unpkSDoc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;must be applied to a type.&quot;</span><span>
</span><a name="line-1501"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1502"></a><span>              </span><span class="hs-comment">-- See Note [Impossible case in mergeOps clause [unpk]]</span><span>
</span><a name="line-1503"></a><span>              </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mergeOps.UNPACK: impossible position&quot;</span><span>
</span><a name="line-1504"></a><span>
</span><a name="line-1505"></a><span>    </span><span class="hs-comment">-- clause [doc]:</span><span>
</span><a name="line-1506"></a><span>    </span><span class="hs-comment">-- we do not expect to encounter any docs</span><span>
</span><a name="line-1507"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975098"><a href="#local-6989586621683975098"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1508"></a><span>      </span><a href="RdrHsSyn.html#failOpDocPrev"><span class="hs-identifier hs-var">failOpDocPrev</span></a><span> </span><a href="#local-6989586621683975098"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1509"></a><span>
</span><a name="line-1510"></a><span>    </span><span class="hs-comment">-- to improve error messages, we do a bit of guesswork to determine if the</span><span>
</span><a name="line-1511"></a><span>    </span><span class="hs-comment">-- user intended a '!' or a '~' as a strictness annotation</span><span>
</span><a name="line-1512"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975099"><a href="#local-6989586621683975099"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975100"><a href="#local-6989586621683975100"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975101"><a href="#local-6989586621683975101"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975102"><a href="#local-6989586621683975102"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975103"><a href="#local-6989586621683975103"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975104"><a href="#local-6989586621683975104"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1513"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975105"><a href="#local-6989586621683975105"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyElStrictness"><span class="hs-identifier hs-var">tyElStrictness</span></a><span> </span><a href="#local-6989586621683975103"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1514"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975106"><a href="#local-6989586621683975106"><span class="hs-identifier">guess</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1515"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1516"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1517"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1518"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElTilde"><span class="hs-identifier hs-var">TyElTilde</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1519"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElBang"><span class="hs-identifier hs-var">TyElBang</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1520"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElUnpackedness"><span class="hs-identifier hs-var">TyElUnpackedness</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1521"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975107"><a href="#local-6989586621683975107"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975106"><span class="hs-identifier hs-var">guess</span></a><span> </span><a href="#local-6989586621683975107"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1522"></a><span>            </span><span class="hs-identifier">guess</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mergeOps.go.guess: Impossible Match&quot;</span><span>
</span><a name="line-1523"></a><span>                      </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1524"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621683975106"><span class="hs-identifier hs-var">guess</span></a><span> </span><a href="#local-6989586621683975104"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1525"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975100"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975099"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621683975100"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1526"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975108"><a href="#local-6989586621683975108"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975100"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1527"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="RdrHsSyn.html#failOpStrictnessCompound"><span class="hs-identifier hs-var">failOpStrictnessCompound</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975102"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975105"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975101"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975108"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1528"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#failOpStrictnessPosition"><span class="hs-identifier hs-var">failOpStrictnessPosition</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975102"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975105"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1529"></a><span>
</span><a name="line-1530"></a><span>    </span><span class="hs-comment">-- clause [opr]:</span><span>
</span><a name="line-1531"></a><span>    </span><span class="hs-comment">-- when we encounter an operator, we must have accumulated</span><span>
</span><a name="line-1532"></a><span>    </span><span class="hs-comment">-- something for its rhs, and there must be something left</span><span>
</span><a name="line-1533"></a><span>    </span><span class="hs-comment">-- to build its lhs.</span><span>
</span><a name="line-1534"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975109"><a href="#local-6989586621683975109"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975110"><a href="#local-6989586621683975110"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975111"><a href="#local-6989586621683975111"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975112"><a href="#local-6989586621683975112"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><a name="local-6989586621683975113"><a href="#local-6989586621683975113"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975114"><a href="#local-6989586621683975114"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1535"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975110"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621683975115"><span class="hs-identifier hs-var">isTyElOpd</span></a><span> </span><a href="#local-6989586621683975114"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1536"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="RdrHsSyn.html#failOpFewArgs"><span class="hs-identifier hs-var">failOpFewArgs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975112"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975113"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-1537"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975116"><a href="#local-6989586621683975116"><span class="hs-identifier">acc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975110"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1538"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975109"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975117"><a href="#local-6989586621683975117"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#mkLHsOpTy"><span class="hs-identifier hs-var">mkLHsOpTy</span></a><span> </span><a href="#local-6989586621683975117"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975112"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975113"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975111"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975116"><span class="hs-identifier hs-var">acc'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975114"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1539"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1540"></a><span>        </span><a name="local-6989586621683975115"><a href="#local-6989586621683975115"><span class="hs-identifier">isTyElOpd</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1541"></a><span>        </span><span class="hs-identifier">isTyElOpd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1542"></a><span>
</span><a name="line-1543"></a><span>    </span><span class="hs-comment">-- clause [opr.1]: interpret 'TyElTilde' as an operator</span><span>
</span><a name="line-1544"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975118"><a href="#local-6989586621683975118"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975119"><a href="#local-6989586621683975119"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975120"><a href="#local-6989586621683975120"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975121"><a href="#local-6989586621683975121"><span class="hs-identifier">l</span></a></a><span> </span><a href="RdrHsSyn.html#TyElTilde"><span class="hs-identifier hs-var">TyElTilde</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975122"><a href="#local-6989586621683975122"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1545"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975123"><a href="#local-6989586621683975123"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#eqTyCon_RDR"><span class="hs-identifier hs-var">eqTyCon_RDR</span></a><span>
</span><a name="line-1546"></a><span>      </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975118"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621683975119"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621683975120"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975121"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><a href="#local-6989586621683975123"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621683975122"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1547"></a><span>
</span><a name="line-1548"></a><span>    </span><span class="hs-comment">-- clause [opr.2]: interpret 'TyElBang' as an operator</span><span>
</span><a name="line-1549"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975124"><a href="#local-6989586621683975124"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975125"><a href="#local-6989586621683975125"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975126"><a href="#local-6989586621683975126"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975127"><a href="#local-6989586621683975127"><span class="hs-identifier">l</span></a></a><span> </span><a href="RdrHsSyn.html#TyElBang"><span class="hs-identifier hs-var">TyElBang</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975128"><a href="#local-6989586621683975128"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1550"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975129"><a href="#local-6989586621683975129"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;!&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1551"></a><span>      </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975124"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621683975125"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621683975126"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975127"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><a href="#local-6989586621683975129"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621683975128"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1552"></a><span>
</span><a name="line-1553"></a><span>    </span><span class="hs-comment">-- clause [opd]:</span><span>
</span><a name="line-1554"></a><span>    </span><span class="hs-comment">-- whenever an operand is encountered, it is added to the accumulator</span><span>
</span><a name="line-1555"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975130"><a href="#local-6989586621683975130"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975131"><a href="#local-6989586621683975131"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975132"><a href="#local-6989586621683975132"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975133"><a href="#local-6989586621683975133"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975134"><a href="#local-6989586621683975134"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975135"><a href="#local-6989586621683975135"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975130"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975133"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975134"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621683975131"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975132"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975135"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1556"></a><span>
</span><a name="line-1557"></a><span>    </span><span class="hs-comment">-- clause [tyapp]:</span><span>
</span><a name="line-1558"></a><span>    </span><span class="hs-comment">-- whenever a type application is encountered, it is added to the accumulator</span><span>
</span><a name="line-1559"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975136"><a href="#local-6989586621683975136"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683975137"><a href="#local-6989586621683975137"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975138"><a href="#local-6989586621683975138"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><a name="local-6989586621683975139"><a href="#local-6989586621683975139"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975140"><a href="#local-6989586621683975140"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975141"><a href="#local-6989586621683975141"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975081"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975136"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><a href="#local-6989586621683975139"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975140"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975137"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975138"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975141"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1560"></a><span>
</span><a name="line-1561"></a><span>    </span><span class="hs-comment">-- clause [end]</span><span>
</span><a name="line-1562"></a><span>    </span><span class="hs-comment">-- See Note [Non-empty 'acc' in mergeOps clause [end]]</span><span>
</span><a name="line-1563"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975142"><a href="#local-6989586621683975142"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975143"><a href="#local-6989586621683975143"><span class="hs-identifier">ops_acc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975144"><a href="#local-6989586621683975144"><span class="hs-identifier">acc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975142"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975143"><span class="hs-identifier hs-var">ops_acc</span></a><span> </span><a href="#local-6989586621683975144"><span class="hs-identifier hs-var">acc'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1565"></a><span>
</span><a name="line-1566"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mergeOps.go: Impossible Match&quot;</span><span>
</span><a name="line-1567"></a><span>                        </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1568"></a><span>
</span><a name="line-1569"></a><span class="hs-identifier">mergeOpsAcc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#HsArg"><span class="hs-identifier hs-type">HsArg</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1570"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1571"></a><a name="mergeOpsAcc"><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier">mergeOpsAcc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mergeOpsAcc: empty input&quot;</span><span>
</span><a name="line-1572"></a><span class="hs-identifier">mergeOpsAcc</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975145"><a href="#local-6989586621683975145"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975146"><a href="#local-6989586621683975146"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1573"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975145"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected type application:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975146"><span class="hs-identifier hs-var">ki</span></a><span class="hs-special">)</span><span>
</span><a name="line-1574"></a><span class="hs-identifier">mergeOpsAcc</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a name="local-6989586621683975147"><a href="#local-6989586621683975147"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975148"><a href="#local-6989586621683975148"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975149"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="#local-6989586621683975147"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621683975148"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1575"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1576"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1577"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#HsArg"><span class="hs-identifier hs-type">HsArg</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1578"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1579"></a><span>    </span><a name="local-6989586621683975149"><a href="#local-6989586621683975149"><span class="hs-identifier">go1</span></a></a><span> </span><a name="local-6989586621683975150"><a href="#local-6989586621683975150"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621683975150"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-1580"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><a name="local-6989586621683975151"><a href="#local-6989586621683975151"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975152"><a href="#local-6989586621683975152"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621683975153"><a href="#local-6989586621683975153"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975152"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1581"></a><span>        </span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><a name="local-6989586621683975154"><a href="#local-6989586621683975154"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975149"><span class="hs-identifier hs-var">go1</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsAppTy"><span class="hs-identifier hs-var">mkHsAppTy</span></a><span> </span><a href="#local-6989586621683975151"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683975154"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975153"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1582"></a><span>        </span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><a name="local-6989586621683975155"><a href="#local-6989586621683975155"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975156"><a href="#local-6989586621683975156"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975157"><a href="#local-6989586621683975157"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsAppKindTy"><span class="hs-identifier hs-var">mkHsAppKindTy</span></a><span> </span><a href="#local-6989586621683975155"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975151"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683975156"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1583"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621683975149"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="#local-6989586621683975157"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621683975153"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1584"></a><span>        </span><a href="HsTypes.html#HsArgPar"><span class="hs-identifier hs-var">HsArgPar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975149"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="#local-6989586621683975151"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683975153"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1585"></a><span class="hs-identifier">mergeOpsAcc</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsArgPar"><span class="hs-identifier hs-var">HsArgPar</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975158"><a href="#local-6989586621683975158"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975158"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1586"></a><span>
</span><a name="line-1587"></a><span class="hs-comment">{- Note [Impossible case in mergeOps clause [unpk]]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This case should never occur. Let us consider all possible
variations of 'acc', 'xs', and 'k':

  acc          xs        k
==============================
  null   |    null       0      -- &quot;must be applied to a type&quot;
  null   |  not null     0      -- &quot;must be applied to a type&quot;
not null |    null       0      -- successful parse
not null |  not null     0      -- &quot;cannot appear inside a type&quot;
  null   |    null      &gt;0      -- handled in clause [opr]
  null   |  not null    &gt;0      -- &quot;cannot appear inside a type&quot;
not null |    null      &gt;0      -- successful parse
not null |  not null    &gt;0      -- &quot;cannot appear inside a type&quot;

The (null acc &amp;&amp; null xs &amp;&amp; k&gt;0) case is handled in clause [opr]
by the following check:

    if ... || null (filter isTyElOpd xs)
     then failOpFewArgs (L l op)

We know that this check has been performed because k&gt;0, and by
the time we reach the end of the list (null xs), the only way
for (null acc) to hold is that there was not a single TyElOpd
between the operator and the end of the list. But this case is
caught by the check and reported as 'failOpFewArgs'.
-}</span><span>
</span><a name="line-1615"></a><span>
</span><a name="line-1616"></a><span class="hs-comment">{- Note [Non-empty 'acc' in mergeOps clause [end]]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In clause [end] we need to know that 'acc' is non-empty to call 'mergeAcc'
without a check.

Running 'mergeOps' with an empty input list is forbidden, so we do not consider
this possibility. This means we'll hit at least one other clause before we
reach clause [end].

* Clauses [unpk] and [doc] do not call 'go' recursively, so we cannot hit
  clause [end] from there.
* Clause [opd] makes 'acc' non-empty, so if we hit clause [end] after it, 'acc'
  will be non-empty.
* Clause [opr] checks that (filter isTyElOpd xs) is not null - so we are going
  to hit clause [opd] at least once before we reach clause [end], making 'acc'
  non-empty.
* There are no other clauses.

Therefore, it is safe to omit a check for non-emptiness of 'acc' in clause
[end].

-}</span><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span class="hs-identifier">pInfixSide</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><a name="pInfixSide"><a href="RdrHsSyn.html#pInfixSide"><span class="hs-identifier">pInfixSide</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975159"><a href="#local-6989586621683975159"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975160"><a href="#local-6989586621683975160"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975161"><a href="#local-6989586621683975161"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1641"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975162"><a href="#local-6989586621683975162"><span class="hs-identifier">t'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975163"><a href="#local-6989586621683975163"><span class="hs-identifier">addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975164"><a href="#local-6989586621683975164"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pBangTy"><span class="hs-identifier hs-var">pBangTy</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975159"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975160"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975161"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975162"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975163"><span class="hs-identifier hs-var">addAnns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975164"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1643"></a><span class="hs-identifier">pInfixSide</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975165"><a href="#local-6989586621683975165"><span class="hs-identifier">el</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621683975166"><a href="#local-6989586621683975166"><span class="hs-identifier">xs1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1644"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683975175"><a href="#local-6989586621683975175"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pLHsTypeArg"><span class="hs-identifier hs-var">pLHsTypeArg</span></a><span> </span><a href="#local-6989586621683975165"><span class="hs-identifier hs-var">el</span></a><span>
</span><a name="line-1645"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975167"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683975175"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621683975166"><span class="hs-identifier hs-var">xs1</span></a><span>
</span><a name="line-1646"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1647"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#HsArg"><span class="hs-identifier hs-type">HsArg</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1648"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">,</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1649"></a><span>     </span><a name="local-6989586621683975167"><a href="#local-6989586621683975167"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683975168"><a href="#local-6989586621683975168"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975169"><a href="#local-6989586621683975169"><span class="hs-identifier">el</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621683975170"><a href="#local-6989586621683975170"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1650"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683975171"><a href="#local-6989586621683975171"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pLHsTypeArg"><span class="hs-identifier hs-var">pLHsTypeArg</span></a><span> </span><a href="#local-6989586621683975169"><span class="hs-identifier hs-var">el</span></a><span>
</span><a name="line-1651"></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975167"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975171"><span class="hs-identifier hs-var">t</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975168"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975170"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1652"></a><span>     </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975172"><a href="#local-6989586621683975172"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621683975173"><a href="#local-6989586621683975173"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="RdrHsSyn.html#mergeOpsAcc"><span class="hs-identifier hs-var">mergeOpsAcc</span></a><span> </span><a href="#local-6989586621683975172"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1653"></a><span>       </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1654"></a><span>       </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621683975174"><a href="#local-6989586621683975174"><span class="hs-identifier">acc'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975174"><span class="hs-identifier hs-var">acc'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975173"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1655"></a><span class="hs-identifier">pInfixSide</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1656"></a><span>
</span><a name="line-1657"></a><span class="hs-identifier">pLHsTypeArg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsArg"><span class="hs-identifier hs-type">HsArg</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1658"></a><a name="pLHsTypeArg"><a href="RdrHsSyn.html#pLHsTypeArg"><span class="hs-identifier">pLHsTypeArg</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975176"><a href="#local-6989586621683975176"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975177"><a href="#local-6989586621683975177"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsValArg"><span class="hs-identifier hs-var">HsValArg</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621683975176"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975177"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1659"></a><span class="hs-identifier">pLHsTypeArg</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><a name="local-6989586621683975178"><a href="#local-6989586621683975178"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975179"><a href="#local-6989586621683975179"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTypeArg"><span class="hs-identifier hs-var">HsTypeArg</span></a><span> </span><a href="#local-6989586621683975178"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975179"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1660"></a><span class="hs-identifier">pLHsTypeArg</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1661"></a><span>
</span><a name="line-1662"></a><span class="hs-identifier">pDocPrev</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HsDoc.html#LHsDocString"><span class="hs-identifier hs-type">LHsDocString</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1663"></a><a name="pDocPrev"><a href="RdrHsSyn.html#pDocPrev"><span class="hs-identifier">pDocPrev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975180"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1664"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1665"></a><span>    </span><a name="local-6989586621683975180"><a href="#local-6989586621683975180"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683975181"><a href="#local-6989586621683975181"><span class="hs-identifier">mTrailingDoc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975182"><a href="#local-6989586621683975182"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><a name="local-6989586621683975183"><a href="#local-6989586621683975183"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975184"><a href="#local-6989586621683975184"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1666"></a><span>      </span><a href="#local-6989586621683975180"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975181"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975182"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975183"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975184"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1667"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975185"><a href="#local-6989586621683975185"><span class="hs-identifier">mTrailingDoc</span></a></a><span> </span><a name="local-6989586621683975186"><a href="#local-6989586621683975186"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975185"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975186"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1668"></a><span>
</span><a name="line-1669"></a><span class="hs-identifier">orErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621683974397"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974398"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621683974398"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621683974397"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1670"></a><a name="orErr"><a href="RdrHsSyn.html#orErr"><span class="hs-identifier">orErr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683975187"><a href="#local-6989586621683975187"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621683975187"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1671"></a><span class="hs-identifier">orErr</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a name="local-6989586621683975188"><a href="#local-6989586621683975188"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683975188"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1672"></a><span>
</span><a name="line-1673"></a><span class="hs-comment">{- Note [isFunLhs vs mergeDataCon]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When parsing a function LHS, we do not know whether to treat (!) as
a strictness annotation or an infix operator:

  f ! a = ...

Without -XBangPatterns, this parses as   (!) f a = ...
   with -XBangPatterns, this parses as   f (!a) = ...

So in function declarations we opted to always parse as if -XBangPatterns
were off, and then rejig in 'isFunLhs'.

There are two downsides to this approach:

1. It is not particularly elegant, as there's a point in our pipeline where
   the representation is awfully incorrect. For instance,
      f !a b !c = ...
   will be first parsed as
      (f ! a b) ! c = ...

2. There are cases that it fails to cover, for instance infix declarations:
      !a + !b = ...
   will trigger an error.

Unfortunately, we cannot define different productions in the 'happy' grammar
depending on whether -XBangPatterns are enabled.

When parsing data constructors, we face a similar issue:
  (a) data T1 = C ! D
  (b) data T2 = C ! D =&gt; ...

In (a) the first bang is a strictness annotation, but in (b) it is a type
operator. A 'happy'-based parser does not have unlimited lookahead to check for
=&gt;, so we must first parse (C ! D) into a common representation.

If we tried to mirror the approach used in functions, we would parse both sides
of =&gt; as types, and then rejig. However, we take a different route and use an
intermediate data structure, a reversed list of 'TyEl'.
See Note [Parsing data constructors is hard] for details.

This approach does not suffer from the issues of 'isFunLhs':

1. A sequence of 'TyEl' is a dedicated intermediate representation, not an
   incorrectly parsed type. Therefore, we do not have confusing states in our
   pipeline. (Except for representing data constructors as type variables).

2. We can handle infix data constructors with strictness annotations:
    data T a b = !a :+ !b

-}</span><span>
</span><a name="line-1725"></a><span>
</span><a name="line-1726"></a><span>
</span><a name="line-1727"></a><span class="hs-comment">-- | Merge a /reversed/ and /non-empty/ soup of operators and operands</span><span>
</span><a name="line-1728"></a><span class="hs-comment">--   into a data constructor.</span><span>
</span><a name="line-1729"></a><span class="hs-comment">--</span><span>
</span><a name="line-1730"></a><span class="hs-comment">-- User input: @C !A B -- ^ doc@</span><span>
</span><a name="line-1731"></a><span class="hs-comment">-- Input to 'mergeDataCon': [&quot;doc&quot;, B, !, A, C]</span><span>
</span><a name="line-1732"></a><span class="hs-comment">-- Output: (C, PrefixCon [!A, B], &quot;doc&quot;)</span><span>
</span><a name="line-1733"></a><span class="hs-comment">--</span><span>
</span><a name="line-1734"></a><span class="hs-comment">-- See Note [Parsing data constructors is hard]</span><span>
</span><a name="line-1735"></a><span class="hs-comment">-- See Note [isFunLhs vs mergeDataCon]</span><span>
</span><a name="line-1736"></a><span class="hs-identifier">mergeDataCon</span><span>
</span><a name="line-1737"></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#TyEl"><span class="hs-identifier hs-type">TyEl</span></a><span class="hs-special">]</span><span>
</span><a name="line-1738"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>         </span><span class="hs-comment">-- constructor name</span><span>
</span><a name="line-1739"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="HsDecls.html#HsConDeclDetails"><span class="hs-identifier hs-type">HsConDeclDetails</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>  </span><span class="hs-comment">-- constructor field information</span><span>
</span><a name="line-1740"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HsDoc.html#LHsDocString"><span class="hs-identifier hs-type">LHsDocString</span></a><span>      </span><span class="hs-comment">-- docstring to go on the constructor</span><span>
</span><a name="line-1741"></a><span>           </span><span class="hs-special">)</span><span>
</span><a name="line-1742"></a><a name="mergeDataCon"><a href="RdrHsSyn.html#mergeDataCon"><span class="hs-identifier">mergeDataCon</span></a></a><span> </span><a name="local-6989586621683975189"><a href="#local-6989586621683975189"><span class="hs-identifier">all_xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1743"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975268"><a href="#local-6989586621683975268"><span class="hs-identifier">addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975269"><a href="#local-6989586621683975269"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#eitherToP"><span class="hs-identifier hs-var">eitherToP</span></a><span> </span><a href="#local-6989586621683975193"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1744"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621683975268"><span class="hs-identifier hs-var">addAnns</span></a><span>
</span><a name="line-1745"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683975269"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1746"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1747"></a><span>    </span><span class="hs-comment">-- We start by splitting off the trailing documentation comment,</span><span>
</span><a name="line-1748"></a><span>    </span><span class="hs-comment">-- if any exists.</span><span>
</span><a name="line-1749"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683975190"><a href="#local-6989586621683975190"><span class="hs-identifier">mTrailingDoc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975191"><a href="#local-6989586621683975191"><span class="hs-identifier">all_xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#pDocPrev"><span class="hs-identifier hs-var">pDocPrev</span></a><span> </span><a href="#local-6989586621683975189"><span class="hs-identifier hs-var">all_xs</span></a><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span>    </span><span class="hs-comment">-- Determine whether the trailing documentation comment exists and is the</span><span>
</span><a name="line-1752"></a><span>    </span><span class="hs-comment">-- only docstring in this constructor declaration.</span><span>
</span><a name="line-1753"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1754"></a><span>    </span><span class="hs-comment">-- When true, it means that it applies to the constructor itself:</span><span>
</span><a name="line-1755"></a><span>    </span><span class="hs-comment">--    data T = C</span><span>
</span><a name="line-1756"></a><span>    </span><span class="hs-comment">--             A</span><span>
</span><a name="line-1757"></a><span>    </span><span class="hs-comment">--             B -- ^ Comment on C (singleDoc == True)</span><span>
</span><a name="line-1758"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1759"></a><span>    </span><span class="hs-comment">-- When false, it means that it applies to the last field:</span><span>
</span><a name="line-1760"></a><span>    </span><span class="hs-comment">--    data T = C -- ^ Comment on C</span><span>
</span><a name="line-1761"></a><span>    </span><span class="hs-comment">--             A -- ^ Comment on A</span><span>
</span><a name="line-1762"></a><span>    </span><span class="hs-comment">--             B -- ^ Comment on B (singleDoc == False)</span><span>
</span><a name="line-1763"></a><span>    </span><a name="local-6989586621683975192"><a href="#local-6989586621683975192"><span class="hs-identifier">singleDoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1764"></a><span>                </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1765"></a><span>
</span><a name="line-1766"></a><span>    </span><span class="hs-comment">-- The result of merging the list of reversed TyEl into a</span><span>
</span><a name="line-1767"></a><span>    </span><span class="hs-comment">-- data constructor, along with [AddAnn].</span><span>
</span><a name="line-1768"></a><span>    </span><a name="local-6989586621683975193"><a href="#local-6989586621683975193"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975196"><span class="hs-identifier hs-var">goFirst</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span>
</span><a name="line-1769"></a><span>
</span><a name="line-1770"></a><span>    </span><span class="hs-comment">-- Take the trailing docstring into account when interpreting</span><span>
</span><a name="line-1771"></a><span>    </span><span class="hs-comment">-- the docstring near the constructor.</span><span>
</span><a name="line-1772"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1773"></a><span>    </span><span class="hs-comment">--    data T = C -- ^ docstring right after C</span><span>
</span><a name="line-1774"></a><span>    </span><span class="hs-comment">--             A</span><span>
</span><a name="line-1775"></a><span>    </span><span class="hs-comment">--             B -- ^ trailing docstring</span><span>
</span><a name="line-1776"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1777"></a><span>    </span><span class="hs-comment">-- 'mkConDoc' must be applied to the docstring right after C, so that it</span><span>
</span><a name="line-1778"></a><span>    </span><span class="hs-comment">-- falls back to the trailing docstring when appropriate (see singleDoc).</span><span>
</span><a name="line-1779"></a><span>    </span><a name="local-6989586621683975194"><a href="#local-6989586621683975194"><span class="hs-identifier">mkConDoc</span></a></a><span> </span><a name="local-6989586621683975200"><a href="#local-6989586621683975200"><span class="hs-identifier">mDoc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683975192"><span class="hs-identifier hs-var">singleDoc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975200"><span class="hs-identifier hs-var">mDoc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span>
</span><a name="line-1780"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975200"><span class="hs-identifier hs-var">mDoc</span></a><span>
</span><a name="line-1781"></a><span>
</span><a name="line-1782"></a><span>    </span><span class="hs-comment">-- The docstring for the last field of a data constructor.</span><span>
</span><a name="line-1783"></a><span>    </span><a name="local-6989586621683975195"><a href="#local-6989586621683975195"><span class="hs-identifier">trailingFieldDoc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683975192"><span class="hs-identifier hs-var">singleDoc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1784"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span>
</span><a name="line-1785"></a><span>
</span><a name="line-1786"></a><span>    </span><a name="local-6989586621683975196"><a href="#local-6989586621683975196"><span class="hs-identifier">goFirst</span></a></a><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975201"><a href="#local-6989586621683975201"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975202"><a href="#local-6989586621683975202"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1787"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975203"><a href="#local-6989586621683975203"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyConToDataCon"><span class="hs-identifier hs-var">tyConToDataCon</span></a><span> </span><a href="#local-6989586621683975201"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975202"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1788"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975203"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1789"></a><span>    </span><span class="hs-identifier">goFirst</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975204"><a href="#local-6989586621683975204"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975205"><a href="#local-6989586621683975205"><span class="hs-identifier">fields</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975206"><a href="#local-6989586621683975206"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1790"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975207"><a href="#local-6989586621683975207"><span class="hs-identifier">mConDoc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975208"><a href="#local-6989586621683975208"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pDocPrev"><span class="hs-identifier hs-var">pDocPrev</span></a><span> </span><a href="#local-6989586621683975206"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1791"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975209"><a href="#local-6989586621683975209"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975210"><a href="#local-6989586621683975210"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975208"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1792"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975211"><a href="#local-6989586621683975211"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyConToDataCon"><span class="hs-identifier hs-var">tyConToDataCon</span></a><span> </span><a href="#local-6989586621683975209"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-6989586621683975210"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1793"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975212"><a href="#local-6989586621683975212"><span class="hs-identifier">mDoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621683975207"><span class="hs-identifier hs-var">mConDoc</span></a><span>
</span><a name="line-1794"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975211"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975204"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975205"><span class="hs-identifier hs-var">fields</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975212"><span class="hs-identifier hs-var">mDoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1795"></a><span>    </span><span class="hs-identifier">goFirst</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975213"><a href="#local-6989586621683975213"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsTypes.html#HsBoxedOrConstraintTuple"><span class="hs-identifier hs-var">HsBoxedOrConstraintTuple</span></a><span> </span><a name="local-6989586621683975214"><a href="#local-6989586621683975214"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1796"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1797"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975213"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621683975214"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1798"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621683975214"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-1799"></a><span>                 </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1800"></a><span>    </span><span class="hs-identifier">goFirst</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975215"><a href="#local-6989586621683975215"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975216"><a href="#local-6989586621683975216"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975217"><a href="#local-6989586621683975217"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1801"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975218"><a href="#local-6989586621683975218"><span class="hs-identifier">t'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975219"><a href="#local-6989586621683975219"><span class="hs-identifier">addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975220"><a href="#local-6989586621683975220"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pBangTy"><span class="hs-identifier hs-var">pBangTy</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975215"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975216"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975217"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1802"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975219"><span class="hs-identifier hs-var">addAnns</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><a href="RdrHsSyn.html#mkLHsDocTyMaybe"><span class="hs-identifier hs-var">mkLHsDocTyMaybe</span></a><span> </span><a href="#local-6989586621683975218"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="#local-6989586621683975195"><span class="hs-identifier hs-var">trailingFieldDoc</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621683975220"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1803"></a><span>    </span><span class="hs-identifier">goFirst</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975221"><a href="#local-6989586621683975221"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1804"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975198"><span class="hs-identifier hs-var">goInfix</span></a><span> </span><span class="hs-operator hs-var">Monoid.&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975221"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975199"><span class="hs-identifier hs-var">kindAppErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1805"></a><span>    </span><span class="hs-identifier">goFirst</span><span> </span><a name="local-6989586621683975222"><a href="#local-6989586621683975222"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-1806"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975197"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975190"><span class="hs-identifier hs-var">mTrailingDoc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683975222"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1807"></a><span>
</span><a name="line-1808"></a><span>    </span><a name="local-6989586621683975197"><a href="#local-6989586621683975197"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683975223"><a href="#local-6989586621683975223"><span class="hs-identifier">addAnns</span></a></a><span> </span><a name="local-6989586621683975224"><a href="#local-6989586621683975224"><span class="hs-identifier">mLastDoc</span></a></a><span> </span><a name="local-6989586621683975225"><a href="#local-6989586621683975225"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975226"><a href="#local-6989586621683975226"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975227"><a href="#local-6989586621683975227"><span class="hs-identifier">tc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1809"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975228"><a href="#local-6989586621683975228"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyConToDataCon"><span class="hs-identifier hs-var">tyConToDataCon</span></a><span> </span><a href="#local-6989586621683975226"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975227"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1810"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975223"><span class="hs-identifier hs-var">addAnns</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975228"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a href="#local-6989586621683975225"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975194"><span class="hs-identifier hs-var">mkConDoc</span></a><span> </span><a href="#local-6989586621683975224"><span class="hs-identifier hs-var">mLastDoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1811"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975229"><a href="#local-6989586621683975229"><span class="hs-identifier">addAnns</span></a></a><span> </span><a name="local-6989586621683975230"><a href="#local-6989586621683975230"><span class="hs-identifier">mLastDoc</span></a></a><span> </span><a name="local-6989586621683975231"><a href="#local-6989586621683975231"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975232"><a href="#local-6989586621683975232"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElDocPrev"><span class="hs-identifier hs-var">TyElDocPrev</span></a><span> </span><a name="local-6989586621683975233"><a href="#local-6989586621683975233"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975234"><a href="#local-6989586621683975234"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1812"></a><span>      </span><a href="#local-6989586621683975197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683975229"><span class="hs-identifier hs-var">addAnns</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975230"><span class="hs-identifier hs-var">mLastDoc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975232"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975233"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975231"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621683975234"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1813"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683975235"><a href="#local-6989586621683975235"><span class="hs-identifier">addAnns</span></a></a><span> </span><a name="local-6989586621683975236"><a href="#local-6989586621683975236"><span class="hs-identifier">mLastDoc</span></a></a><span> </span><a name="local-6989586621683975237"><a href="#local-6989586621683975237"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975238"><a href="#local-6989586621683975238"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpd"><span class="hs-identifier hs-var">TyElOpd</span></a><span> </span><a name="local-6989586621683975239"><a href="#local-6989586621683975239"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621683975240"><a href="#local-6989586621683975240"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1814"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975241"><a href="#local-6989586621683975241"><span class="hs-identifier">t'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975242"><a href="#local-6989586621683975242"><span class="hs-identifier">addAnns'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975243"><a href="#local-6989586621683975243"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pBangTy"><span class="hs-identifier hs-var">pBangTy</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975238"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975239"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975240"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1815"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975244"><a href="#local-6989586621683975244"><span class="hs-identifier">t''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#mkLHsDocTyMaybe"><span class="hs-identifier hs-var">mkLHsDocTyMaybe</span></a><span> </span><a href="#local-6989586621683975241"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="#local-6989586621683975236"><span class="hs-identifier hs-var">mLastDoc</span></a><span>
</span><a name="line-1816"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975197"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975235"><span class="hs-identifier hs-var">addAnns</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621683975242"><span class="hs-identifier hs-var">addAnns'</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975244"><span class="hs-identifier hs-var">t''</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975237"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975243"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1817"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1818"></a><span>      </span><span class="hs-comment">-- Encountered an operator: backtrack to the beginning and attempt</span><span>
</span><a name="line-1819"></a><span>      </span><span class="hs-comment">-- to parse as an infix definition.</span><span>
</span><a name="line-1820"></a><span>      </span><a href="#local-6989586621683975198"><span class="hs-identifier hs-var">goInfix</span></a><span>
</span><a name="line-1821"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975245"><a href="#local-6989586621683975245"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElKindApp"><span class="hs-identifier hs-var">TyElKindApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621683975198"><span class="hs-identifier hs-var">goInfix</span></a><span> </span><span class="hs-operator hs-var">Monoid.&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975245"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975199"><span class="hs-identifier hs-var">kindAppErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1822"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683975246"><span class="hs-identifier hs-var">malformedErr</span></a><span>
</span><a name="line-1823"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1824"></a><span>        </span><a name="local-6989586621683975246"><a href="#local-6989586621683975246"><span class="hs-identifier">malformedErr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1825"></a><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1826"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Cannot parse data constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1827"></a><span>            </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a data/newtype declaration:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1828"></a><span>            </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1829"></a><span>
</span><a name="line-1830"></a><span>    </span><a name="local-6989586621683975198"><a href="#local-6989586621683975198"><span class="hs-identifier">goInfix</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1831"></a><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975248"><a href="#local-6989586621683975248"><span class="hs-identifier">xs0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span>
</span><a name="line-1832"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975249"><a href="#local-6989586621683975249"><span class="hs-identifier">rhs_t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975250"><a href="#local-6989586621683975250"><span class="hs-identifier">rhs_addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975251"><a href="#local-6989586621683975251"><span class="hs-identifier">xs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pInfixSide"><span class="hs-identifier hs-var">pInfixSide</span></a><span> </span><a href="#local-6989586621683975248"><span class="hs-identifier hs-var">xs0</span></a><span> </span><span class="hs-special">`</span><a href="RdrHsSyn.html#orErr"><span class="hs-identifier hs-var">orErr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683975247"><span class="hs-identifier hs-var">malformedErr</span></a><span>
</span><a name="line-1833"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975252"><a href="#local-6989586621683975252"><span class="hs-identifier">mOpDoc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975253"><a href="#local-6989586621683975253"><span class="hs-identifier">xs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#pDocPrev"><span class="hs-identifier hs-var">pDocPrev</span></a><span> </span><a href="#local-6989586621683975251"><span class="hs-identifier hs-var">xs1</span></a><span>
</span><a name="line-1834"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975258"><a href="#local-6989586621683975258"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975259"><a href="#local-6989586621683975259"><span class="hs-identifier">xs3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975253"><span class="hs-identifier hs-var">xs2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1835"></a><span>              </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975254"><a href="#local-6989586621683975254"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#TyElOpr"><span class="hs-identifier hs-var">TyElOpr</span></a><span> </span><a name="local-6989586621683975255"><a href="#local-6989586621683975255"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683975256"><a href="#local-6989586621683975256"><span class="hs-identifier">xs3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1836"></a><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975257"><a href="#local-6989586621683975257"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#tyConToDataCon"><span class="hs-identifier hs-var">tyConToDataCon</span></a><span> </span><a href="#local-6989586621683975254"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975255"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1837"></a><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975257"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975256"><span class="hs-identifier hs-var">xs3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1838"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683975247"><span class="hs-identifier hs-var">malformedErr</span></a><span>
</span><a name="line-1839"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975260"><a href="#local-6989586621683975260"><span class="hs-identifier">mLhsDoc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975261"><a href="#local-6989586621683975261"><span class="hs-identifier">xs4</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#pDocPrev"><span class="hs-identifier hs-var">pDocPrev</span></a><span> </span><a href="#local-6989586621683975259"><span class="hs-identifier hs-var">xs3</span></a><span>
</span><a name="line-1840"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975262"><a href="#local-6989586621683975262"><span class="hs-identifier">lhs_t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975263"><a href="#local-6989586621683975263"><span class="hs-identifier">lhs_addAnns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975264"><a href="#local-6989586621683975264"><span class="hs-identifier">xs5</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#pInfixSide"><span class="hs-identifier hs-var">pInfixSide</span></a><span> </span><a href="#local-6989586621683975261"><span class="hs-identifier hs-var">xs4</span></a><span> </span><span class="hs-special">`</span><a href="RdrHsSyn.html#orErr"><span class="hs-identifier hs-var">orErr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683975247"><span class="hs-identifier hs-var">malformedErr</span></a><span>
</span><a name="line-1841"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621683975264"><span class="hs-identifier hs-var">xs5</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683975247"><span class="hs-identifier hs-var">malformedErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1842"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975265"><a href="#local-6989586621683975265"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#mkLHsDocTyMaybe"><span class="hs-identifier hs-var">mkLHsDocTyMaybe</span></a><span> </span><a href="#local-6989586621683975249"><span class="hs-identifier hs-var">rhs_t</span></a><span> </span><a href="#local-6989586621683975195"><span class="hs-identifier hs-var">trailingFieldDoc</span></a><span>
</span><a name="line-1843"></a><span>               </span><a name="local-6989586621683975266"><a href="#local-6989586621683975266"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#mkLHsDocTyMaybe"><span class="hs-identifier hs-var">mkLHsDocTyMaybe</span></a><span> </span><a href="#local-6989586621683975262"><span class="hs-identifier hs-var">lhs_t</span></a><span> </span><a href="#local-6989586621683975260"><span class="hs-identifier hs-var">mLhsDoc</span></a><span>
</span><a name="line-1844"></a><span>               </span><a name="local-6989586621683975267"><a href="#local-6989586621683975267"><span class="hs-identifier">addAnns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975263"><span class="hs-identifier hs-var">lhs_addAnns</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621683975250"><span class="hs-identifier hs-var">rhs_addAnns</span></a><span>
</span><a name="line-1845"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975267"><span class="hs-identifier hs-var">addAnns</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975258"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621683975266"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621683975265"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975194"><span class="hs-identifier hs-var">mkConDoc</span></a><span> </span><a href="#local-6989586621683975252"><span class="hs-identifier hs-var">mOpDoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1846"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1847"></a><span>        </span><a name="local-6989586621683975247"><a href="#local-6989586621683975247"><span class="hs-identifier">malformedErr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1848"></a><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1849"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Cannot parse an infix data constructor&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1850"></a><span>            </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a data/newtype declaration:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1851"></a><span>            </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1852"></a><span>
</span><a name="line-1853"></a><span>    </span><a name="local-6989586621683975199"><a href="#local-6989586621683975199"><span class="hs-identifier">kindAppErr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1854"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected kind application&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-1855"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a data/newtype declaration:&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1856"></a><span>      </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975191"><span class="hs-identifier hs-var">all_xs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-1859"></a><span class="hs-comment">-- | Check for monad comprehensions</span><span>
</span><a name="line-1860"></a><span class="hs-comment">--</span><span>
</span><a name="line-1861"></a><span class="hs-comment">-- If the flag MonadComprehensions is set, return a 'MonadComp' context,</span><span>
</span><a name="line-1862"></a><span class="hs-comment">-- otherwise use the usual 'ListComp' context</span><span>
</span><a name="line-1863"></a><span>
</span><a name="line-1864"></a><span class="hs-identifier">checkMonadComp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1865"></a><a name="checkMonadComp"><a href="RdrHsSyn.html#checkMonadComp"><span class="hs-identifier">checkMonadComp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1866"></a><span>    </span><a name="local-6989586621683975270"><a href="#local-6989586621683975270"><span class="hs-identifier">monadComprehensions</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#MonadComprehensionsBit"><span class="hs-identifier hs-var">MonadComprehensionsBit</span></a><span>
</span><a name="line-1867"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683975270"><span class="hs-identifier hs-var">monadComprehensions</span></a><span>
</span><a name="line-1868"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="HsExpr.html#MonadComp"><span class="hs-identifier hs-var">MonadComp</span></a><span>
</span><a name="line-1869"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="HsExpr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a><span>
</span><a name="line-1870"></a><span>
</span><a name="line-1871"></a><span class="hs-comment">-- -------------------------------------------------------------------------</span><span>
</span><a name="line-1872"></a><span class="hs-comment">-- Checking arrow syntax.</span><span>
</span><a name="line-1873"></a><span>
</span><a name="line-1874"></a><span class="hs-comment">-- We parse arrow syntax as expressions and check for valid syntax below,</span><span>
</span><a name="line-1875"></a><span class="hs-comment">-- converting the expression into a pattern at the same time.</span><span>
</span><a name="line-1876"></a><span>
</span><a name="line-1877"></a><span class="hs-identifier">checkCommand</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1878"></a><a name="checkCommand"><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier">checkCommand</span></a></a><span> </span><a name="local-6989586621683975271"><a href="#local-6989586621683975271"><span class="hs-identifier">lc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#locMap"><span class="hs-identifier hs-var">locMap</span></a><span> </span><a href="RdrHsSyn.html#checkCmd"><span class="hs-identifier hs-var">checkCmd</span></a><span> </span><a href="#local-6989586621683975271"><span class="hs-identifier hs-var">lc</span></a><span>
</span><a name="line-1879"></a><span>
</span><a name="line-1880"></a><span class="hs-identifier">locMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683974395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974396"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683974395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683974396"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1881"></a><a name="locMap"><a href="RdrHsSyn.html#locMap"><span class="hs-identifier">locMap</span></a></a><span> </span><a name="local-6989586621683975272"><a href="#local-6989586621683975272"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975273"><a href="#local-6989586621683975273"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975274"><a href="#local-6989586621683975274"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975272"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621683975273"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975274"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975275"><a href="#local-6989586621683975275"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975273"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975275"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1882"></a><span>
</span><a name="line-1883"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1884"></a><a name="checkCmd"><a href="RdrHsSyn.html#checkCmd"><span class="hs-identifier">checkCmd</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsArrApp"><span class="hs-identifier hs-var">HsArrApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975276"><a href="#local-6989586621683975276"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683975277"><a href="#local-6989586621683975277"><span class="hs-identifier">e2</span></a></a><span> </span><a name="local-6989586621683975278"><a href="#local-6989586621683975278"><span class="hs-identifier">haat</span></a></a><span> </span><a name="local-6989586621683975279"><a href="#local-6989586621683975279"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1885"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdArrApp"><span class="hs-identifier hs-var">HsCmdArrApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975276"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621683975277"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621683975278"><span class="hs-identifier hs-var">haat</span></a><span> </span><a href="#local-6989586621683975279"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1886"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsArrForm"><span class="hs-identifier hs-var">HsArrForm</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975280"><a href="#local-6989586621683975280"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683975281"><a href="#local-6989586621683975281"><span class="hs-identifier">mf</span></a></a><span> </span><a name="local-6989586621683975282"><a href="#local-6989586621683975282"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1887"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975280"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span> </span><a href="#local-6989586621683975281"><span class="hs-identifier hs-var">mf</span></a><span> </span><a href="#local-6989586621683975282"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1888"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975283"><a href="#local-6989586621683975283"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683975284"><a href="#local-6989586621683975284"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1889"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975283"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975285"><a href="#local-6989586621683975285"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdApp"><span class="hs-identifier hs-var">HsCmdApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975285"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621683975284"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1890"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975286"><a href="#local-6989586621683975286"><span class="hs-identifier">mg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1891"></a><span>    </span><a href="RdrHsSyn.html#checkCmdMatchGroup"><span class="hs-identifier hs-var">checkCmdMatchGroup</span></a><span> </span><a href="#local-6989586621683975286"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975287"><a href="#local-6989586621683975287"><span class="hs-identifier">mg'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdLam"><span class="hs-identifier hs-var">HsCmdLam</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975287"><span class="hs-identifier hs-var">mg'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1892"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975288"><a href="#local-6989586621683975288"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1893"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975288"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975289"><a href="#local-6989586621683975289"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdPar"><span class="hs-identifier hs-var">HsCmdPar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975289"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1894"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975290"><a href="#local-6989586621683975290"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683975291"><a href="#local-6989586621683975291"><span class="hs-identifier">mg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1895"></a><span>    </span><a href="RdrHsSyn.html#checkCmdMatchGroup"><span class="hs-identifier hs-var">checkCmdMatchGroup</span></a><span> </span><a href="#local-6989586621683975291"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975292"><a href="#local-6989586621683975292"><span class="hs-identifier">mg'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdCase"><span class="hs-identifier hs-var">HsCmdCase</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975290"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621683975292"><span class="hs-identifier hs-var">mg'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1896"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975293"><a href="#local-6989586621683975293"><span class="hs-identifier">cf</span></a></a><span> </span><a name="local-6989586621683975294"><a href="#local-6989586621683975294"><span class="hs-identifier">ep</span></a></a><span> </span><a name="local-6989586621683975295"><a href="#local-6989586621683975295"><span class="hs-identifier">et</span></a></a><span> </span><a name="local-6989586621683975296"><a href="#local-6989586621683975296"><span class="hs-identifier">ee</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1897"></a><span>    </span><a name="local-6989586621683975297"><a href="#local-6989586621683975297"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975295"><span class="hs-identifier hs-var">et</span></a><span>
</span><a name="line-1898"></a><span>    </span><a name="local-6989586621683975298"><a href="#local-6989586621683975298"><span class="hs-identifier">pe</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975296"><span class="hs-identifier hs-var">ee</span></a><span>
</span><a name="line-1899"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdIf"><span class="hs-identifier hs-var">HsCmdIf</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975293"><span class="hs-identifier hs-var">cf</span></a><span> </span><a href="#local-6989586621683975294"><span class="hs-identifier hs-var">ep</span></a><span> </span><a href="#local-6989586621683975297"><span class="hs-identifier hs-var">pt</span></a><span> </span><a href="#local-6989586621683975298"><span class="hs-identifier hs-var">pe</span></a><span>
</span><a name="line-1900"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLet"><span class="hs-identifier hs-var">HsLet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975299"><a href="#local-6989586621683975299"><span class="hs-identifier">lb</span></a></a><span> </span><a name="local-6989586621683975300"><a href="#local-6989586621683975300"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1901"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975300"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975301"><a href="#local-6989586621683975301"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdLet"><span class="hs-identifier hs-var">HsCmdLet</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975299"><span class="hs-identifier hs-var">lb</span></a><span> </span><a href="#local-6989586621683975301"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1902"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsExpr.html#DoExpr"><span class="hs-identifier hs-var">DoExpr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975302"><a href="#local-6989586621683975302"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975303"><a href="#local-6989586621683975303"><span class="hs-identifier">stmts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1903"></a><span>    </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="RdrHsSyn.html#checkCmdLStmt"><span class="hs-identifier hs-var">checkCmdLStmt</span></a><span> </span><a href="#local-6989586621683975303"><span class="hs-identifier hs-var">stmts</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span>
</span><a name="line-1904"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975304"><a href="#local-6989586621683975304"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdDo"><span class="hs-identifier hs-var">HsCmdDo</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975302"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975304"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1905"></a><span>
</span><a name="line-1906"></a><span class="hs-identifier">checkCmd</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975305"><a href="#local-6989586621683975305"><span class="hs-identifier">eLeft</span></a></a><span> </span><a name="local-6989586621683975306"><a href="#local-6989586621683975306"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621683975307"><a href="#local-6989586621683975307"><span class="hs-identifier">eRight</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1907"></a><span>    </span><span class="hs-comment">-- OpApp becomes a HsCmdArrForm with a (Just fixity) in it</span><span>
</span><a name="line-1908"></a><span>    </span><a name="local-6989586621683975308"><a href="#local-6989586621683975308"><span class="hs-identifier">c1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975305"><span class="hs-identifier hs-var">eLeft</span></a><span>
</span><a name="line-1909"></a><span>    </span><a name="local-6989586621683975309"><a href="#local-6989586621683975309"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975307"><span class="hs-identifier hs-var">eRight</span></a><span>
</span><a name="line-1910"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975310"><a href="#local-6989586621683975310"><span class="hs-identifier">arg1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975308"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975308"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-1911"></a><span>        </span><a name="local-6989586621683975311"><a href="#local-6989586621683975311"><span class="hs-identifier">arg2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975309"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975309"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-1912"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975306"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683975310"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975311"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1913"></a><span>
</span><a name="line-1914"></a><span class="hs-identifier">checkCmd</span><span> </span><a name="local-6989586621683975312"><a href="#local-6989586621683975312"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975313"><a href="#local-6989586621683975313"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#cmdFail"><span class="hs-identifier hs-var">cmdFail</span></a><span> </span><a href="#local-6989586621683975312"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975313"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1915"></a><span>
</span><a name="line-1916"></a><span class="hs-identifier">checkCmdLStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#CmdLStmt"><span class="hs-identifier hs-type">CmdLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1917"></a><a name="checkCmdLStmt"><a href="RdrHsSyn.html#checkCmdLStmt"><span class="hs-identifier">checkCmdLStmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#locMap"><span class="hs-identifier hs-var">locMap</span></a><span> </span><a href="RdrHsSyn.html#checkCmdStmt"><span class="hs-identifier hs-var">checkCmdStmt</span></a><span>
</span><a name="line-1918"></a><span>
</span><a name="line-1919"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#ExprStmt"><span class="hs-identifier hs-type">ExprStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#CmdStmt"><span class="hs-identifier hs-type">CmdStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1920"></a><a name="checkCmdStmt"><a href="RdrHsSyn.html#checkCmdStmt"><span class="hs-identifier">checkCmdStmt</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a name="local-6989586621683975314"><a href="#local-6989586621683975314"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975315"><a href="#local-6989586621683975315"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683975316"><a href="#local-6989586621683975316"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621683975317"><a href="#local-6989586621683975317"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1921"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975315"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975318"><a href="#local-6989586621683975318"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a href="#local-6989586621683975314"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975318"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621683975316"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621683975317"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1922"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-6989586621683975319"><a href="#local-6989586621683975319"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975320"><a href="#local-6989586621683975320"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683975321"><a href="#local-6989586621683975321"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683975322"><a href="#local-6989586621683975322"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621683975323"><a href="#local-6989586621683975323"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1923"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975321"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975324"><a href="#local-6989586621683975324"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="#local-6989586621683975319"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975320"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683975324"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621683975322"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621683975323"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-1924"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a name="local-6989586621683975325"><a href="#local-6989586621683975325"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975326"><a href="#local-6989586621683975326"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683975327"><a href="#local-6989586621683975327"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621683975328"><a href="#local-6989586621683975328"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1925"></a><span>    </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975326"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975329"><a href="#local-6989586621683975329"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a href="#local-6989586621683975325"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975329"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621683975327"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621683975328"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-1926"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><a name="local-6989586621683975330"><a href="#local-6989586621683975330"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975331"><a href="#local-6989586621683975331"><span class="hs-identifier">bnds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><a href="#local-6989586621683975330"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975331"><span class="hs-identifier hs-var">bnds</span></a><span>
</span><a name="line-1927"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975332"><a href="#local-6989586621683975332"><span class="hs-identifier">stmt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683975333"><a href="#local-6989586621683975333"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1928"></a><span>    </span><a name="local-6989586621683975334"><a href="#local-6989586621683975334"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="RdrHsSyn.html#checkCmdLStmt"><span class="hs-identifier hs-var">checkCmdLStmt</span></a><span> </span><a href="#local-6989586621683975333"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1929"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621683975332"><span class="hs-identifier hs-var">stmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975334"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1930"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XStmtLR"><span class="hs-identifier hs-var">XStmtLR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkCmdStmt&quot;</span><span>
</span><a name="line-1931"></a><span class="hs-identifier">checkCmdStmt</span><span> </span><a name="local-6989586621683975335"><a href="#local-6989586621683975335"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975336"><a href="#local-6989586621683975336"><span class="hs-identifier">stmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#cmdStmtFail"><span class="hs-identifier hs-var">cmdStmtFail</span></a><span> </span><a href="#local-6989586621683975335"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975336"><span class="hs-identifier hs-var">stmt</span></a><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span class="hs-identifier">checkCmdMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1934"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1935"></a><a name="checkCmdMatchGroup"><a href="RdrHsSyn.html#checkCmdMatchGroup"><span class="hs-identifier">checkCmdMatchGroup</span></a></a><span> </span><a name="local-6989586621683975337"><a href="#local-6989586621683975337"><span class="hs-identifier">mg</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975338"><a href="#local-6989586621683975338"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975339"><a href="#local-6989586621683975339"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1936"></a><span>    </span><a name="local-6989586621683975344"><a href="#local-6989586621683975344"><span class="hs-identifier">ms'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#locMap"><span class="hs-identifier hs-var">locMap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621683975340"><span class="hs-identifier hs-var">convert</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975339"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1937"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621683975337"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-1938"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975338"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975344"><span class="hs-identifier hs-var">ms'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1939"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683975340"><a href="#local-6989586621683975340"><span class="hs-identifier">convert</span></a></a><span> </span><a name="local-6989586621683975341"><a href="#local-6989586621683975341"><span class="hs-identifier">match</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683975342"><a href="#local-6989586621683975342"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1940"></a><span>            </span><a name="local-6989586621683975343"><a href="#local-6989586621683975343"><span class="hs-identifier">grhss'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCmdGRHSs"><span class="hs-identifier hs-var">checkCmdGRHSs</span></a><span> </span><a href="#local-6989586621683975342"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-1941"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621683975341"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975343"><span class="hs-identifier hs-var">grhss'</span></a><span class="hs-special">}</span><span>
</span><a name="line-1942"></a><span>          </span><span class="hs-identifier">convert</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XMatch"><span class="hs-identifier hs-var">XMatch</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkCmdMatchGroup.XMatch&quot;</span><span>
</span><a name="line-1943"></a><span class="hs-identifier">checkCmdMatchGroup</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XMatchGroup"><span class="hs-identifier hs-var">XMatchGroup</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkCmdMatchGroup&quot;</span><span>
</span><a name="line-1944"></a><span>
</span><a name="line-1945"></a><span class="hs-identifier">checkCmdGRHSs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1946"></a><a name="checkCmdGRHSs"><a href="RdrHsSyn.html#checkCmdGRHSs"><span class="hs-identifier">checkCmdGRHSs</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a name="local-6989586621683975345"><a href="#local-6989586621683975345"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975346"><a href="#local-6989586621683975346"><span class="hs-identifier">grhss</span></a></a><span> </span><a name="local-6989586621683975347"><a href="#local-6989586621683975347"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1947"></a><span>    </span><a name="local-6989586621683975348"><a href="#local-6989586621683975348"><span class="hs-identifier">grhss'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="RdrHsSyn.html#checkCmdGRHS"><span class="hs-identifier hs-var">checkCmdGRHS</span></a><span> </span><a href="#local-6989586621683975346"><span class="hs-identifier hs-var">grhss</span></a><span>
</span><a name="line-1948"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a href="#local-6989586621683975345"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975348"><span class="hs-identifier hs-var">grhss'</span></a><span> </span><a href="#local-6989586621683975347"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1949"></a><span class="hs-identifier">checkCmdGRHSs</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XGRHSs"><span class="hs-identifier hs-var">XGRHSs</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkCmdGRHSs&quot;</span><span>
</span><a name="line-1950"></a><span>
</span><a name="line-1951"></a><span class="hs-identifier">checkCmdGRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1952"></a><a name="checkCmdGRHS"><a href="RdrHsSyn.html#checkCmdGRHS"><span class="hs-identifier">checkCmdGRHS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#locMap"><span class="hs-identifier hs-var">locMap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621683975349"><span class="hs-identifier hs-var">convert</span></a><span>
</span><a name="line-1953"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1954"></a><span>    </span><a name="local-6989586621683975349"><a href="#local-6989586621683975349"><span class="hs-identifier">convert</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-6989586621683975350"><a href="#local-6989586621683975350"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975351"><a href="#local-6989586621683975351"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-6989586621683975352"><a href="#local-6989586621683975352"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1955"></a><span>        </span><a name="local-6989586621683975353"><a href="#local-6989586621683975353"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RdrHsSyn.html#checkCommand"><span class="hs-identifier hs-var">checkCommand</span></a><span> </span><a href="#local-6989586621683975352"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1956"></a><span class="hs-comment">--        cmdStmts &lt;- mapM checkCmdLStmt stmts</span><span>
</span><a name="line-1957"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="#local-6989586621683975350"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-comment">{- cmdStmts -}</span><span> </span><a href="#local-6989586621683975351"><span class="hs-identifier hs-var">stmts</span></a><span> </span><a href="#local-6989586621683975353"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1958"></a><span>    </span><span class="hs-identifier">convert</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XGRHS"><span class="hs-identifier hs-var">XGRHS</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkCmdGRHS&quot;</span><span>
</span><a name="line-1959"></a><span>
</span><a name="line-1960"></a><span>
</span><a name="line-1961"></a><span class="hs-identifier">cmdFail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974394"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1962"></a><a name="cmdFail"><a href="RdrHsSyn.html#cmdFail"><span class="hs-identifier">cmdFail</span></a></a><span> </span><a name="local-6989586621683975354"><a href="#local-6989586621683975354"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975355"><a href="#local-6989586621683975355"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975354"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Parse error in command:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975355"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1963"></a><span class="hs-identifier">cmdStmtFail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#Stmt"><span class="hs-identifier hs-type">Stmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974393"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1964"></a><a name="cmdStmtFail"><a href="RdrHsSyn.html#cmdStmtFail"><span class="hs-identifier">cmdStmtFail</span></a></a><span> </span><a name="local-6989586621683975356"><a href="#local-6989586621683975356"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975357"><a href="#local-6989586621683975357"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975356"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-1965"></a><span>                    </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Parse error in command statement:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975357"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1966"></a><span>
</span><a name="line-1967"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-1968"></a><span class="hs-comment">-- Miscellaneous utilities</span><span>
</span><a name="line-1969"></a><span>
</span><a name="line-1970"></a><span class="hs-comment">-- | Check if a fixity is valid. We support bypassing the usual bound checks</span><span>
</span><a name="line-1971"></a><span class="hs-comment">-- for some special operators.</span><span>
</span><a name="line-1972"></a><span class="hs-identifier">checkPrecP</span><span>
</span><a name="line-1973"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- ^ precedence</span><span>
</span><a name="line-1974"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ operators</span><span>
</span><a name="line-1975"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1976"></a><a name="checkPrecP"><a href="RdrHsSyn.html#checkPrecP"><span class="hs-identifier">checkPrecP</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975358"><a href="#local-6989586621683975358"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621683975359"><a href="#local-6989586621683975359"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975360"><a href="#local-6989586621683975360"><span class="hs-identifier">ol</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1977"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621683975359"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683975359"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="BasicTypes.html#maxPrecedence"><span class="hs-identifier hs-var">maxPrecedence</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1978"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="#local-6989586621683975361"><span class="hs-identifier hs-var">specialOp</span></a><span> </span><a href="#local-6989586621683975360"><span class="hs-identifier hs-var">ol</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1979"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975358"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Precedence out of range: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621683975359"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1980"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1981"></a><span>    </span><a name="local-6989586621683975361"><a href="#local-6989586621683975361"><span class="hs-identifier">specialOp</span></a></a><span> </span><a name="local-6989586621683975362"><a href="#local-6989586621683975362"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975362"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span> </span><a href="TysWiredIn.html#eqTyCon_RDR"><span class="hs-identifier hs-var">eqTyCon_RDR</span></a><span>
</span><a name="line-1982"></a><span>                                   </span><span class="hs-special">,</span><span> </span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1983"></a><span>
</span><a name="line-1984"></a><span class="hs-identifier">mkRecConstrOrUpdate</span><span>
</span><a name="line-1985"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1986"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-1987"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsPat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-1988"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1989"></a><span>
</span><a name="line-1990"></a><a name="mkRecConstrOrUpdate"><a href="RdrHsSyn.html#mkRecConstrOrUpdate"><span class="hs-identifier">mkRecConstrOrUpdate</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975363"><a href="#local-6989586621683975363"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975364"><a href="#local-6989586621683975364"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975365"><a href="#local-6989586621683975365"><span class="hs-identifier">fs</span></a></a><span class="hs-special">,</span><a name="local-6989586621683975366"><a href="#local-6989586621683975366"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1991"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RdrName.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a><span> </span><a href="#local-6989586621683975364"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1992"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mkRdrRecordCon"><span class="hs-identifier hs-var">mkRdrRecordCon</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975363"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975364"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mk_rec_fields"><span class="hs-identifier hs-var">mk_rec_fields</span></a><span> </span><a href="#local-6989586621683975365"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621683975366"><span class="hs-identifier hs-var">dd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1993"></a><span class="hs-identifier">mkRecConstrOrUpdate</span><span> </span><a name="local-6989586621683975367"><a href="#local-6989586621683975367"><span class="hs-identifier">exp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975368"><a href="#local-6989586621683975368"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683975369"><a href="#local-6989586621683975369"><span class="hs-identifier">fs</span></a></a><span class="hs-special">,</span><a name="local-6989586621683975370"><a href="#local-6989586621683975370"><span class="hs-identifier">dd</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1994"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683975370"><span class="hs-identifier hs-var">dd</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975368"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;You cannot use `..' in a record update&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1995"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mkRdrRecordUpd"><span class="hs-identifier hs-var">mkRdrRecordUpd</span></a><span> </span><a href="#local-6989586621683975367"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="RdrHsSyn.html#mk_rec_upd_field"><span class="hs-identifier hs-var">mk_rec_upd_field</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975369"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1996"></a><span>
</span><a name="line-1997"></a><span class="hs-identifier">mkRdrRecordUpd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecUpdField"><span class="hs-identifier hs-type">LHsRecUpdField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1998"></a><a name="mkRdrRecordUpd"><a href="RdrHsSyn.html#mkRdrRecordUpd"><span class="hs-identifier">mkRdrRecordUpd</span></a></a><span> </span><a name="local-6989586621683975371"><a href="#local-6989586621683975371"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621683975372"><a href="#local-6989586621683975372"><span class="hs-identifier">flds</span></a></a><span>
</span><a name="line-1999"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#RecordUpd"><span class="hs-identifier hs-var">RecordUpd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rupd_ext</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-2000"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975371"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-2001"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rupd_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975372"><span class="hs-identifier hs-var">flds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2002"></a><span>
</span><a name="line-2003"></a><span class="hs-identifier">mkRdrRecordCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsRecordBinds"><span class="hs-identifier hs-type">HsRecordBinds</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-2004"></a><a name="mkRdrRecordCon"><a href="RdrHsSyn.html#mkRdrRecordCon"><span class="hs-identifier">mkRdrRecordCon</span></a></a><span> </span><a name="local-6989586621683975373"><a href="#local-6989586621683975373"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683975374"><a href="#local-6989586621683975374"><span class="hs-identifier">flds</span></a></a><span>
</span><a name="line-2005"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rcon_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975373"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rcon_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975374"><span class="hs-identifier hs-var">flds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2006"></a><span>
</span><a name="line-2007"></a><span class="hs-identifier">mk_rec_fields</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a><span> </span><a href="#local-6989586621683974391"><span class="hs-identifier hs-type">id</span></a><span> </span><a href="#local-6989586621683974392"><span class="hs-identifier hs-type">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="#local-6989586621683974391"><span class="hs-identifier hs-type">id</span></a><span> </span><a href="#local-6989586621683974392"><span class="hs-identifier hs-type">arg</span></a><span>
</span><a name="line-2008"></a><a name="mk_rec_fields"><a href="RdrHsSyn.html#mk_rec_fields"><span class="hs-identifier">mk_rec_fields</span></a></a><span> </span><a name="local-6989586621683975375"><a href="#local-6989586621683975375"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975375"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rec_dotdot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2009"></a><span class="hs-identifier">mk_rec_fields</span><span> </span><a name="local-6989586621683975376"><a href="#local-6989586621683975376"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975376"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-2010"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rec_dotdot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621683975376"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2011"></a><span>
</span><a name="line-2012"></a><span class="hs-identifier">mk_rec_upd_field</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-type">HsRecField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#HsRecUpdField"><span class="hs-identifier hs-type">HsRecUpdField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-2013"></a><a name="mk_rec_upd_field"><a href="RdrHsSyn.html#mk_rec_upd_field"><span class="hs-identifier">mk_rec_upd_field</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-var">HsRecField</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975377"><a href="#local-6989586621683975377"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975378"><a href="#local-6989586621683975378"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683975379"><a href="#local-6989586621683975379"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621683975380"><a href="#local-6989586621683975380"><span class="hs-identifier">pun</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2014"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-var">HsRecField</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621683975377"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#Unambiguous"><span class="hs-identifier hs-var">Unambiguous</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975378"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975379"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="#local-6989586621683975380"><span class="hs-identifier hs-var">pun</span></a><span>
</span><a name="line-2015"></a><span class="hs-identifier">mk_rec_upd_field</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-var">HsRecField</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#XFieldOcc"><span class="hs-identifier hs-var">XFieldOcc</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2016"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mk_rec_upd_field&quot;</span><span>
</span><a name="line-2017"></a><span class="hs-identifier">mk_rec_upd_field</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-var">HsRecField</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2018"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mk_rec_upd_field: Impossible Match&quot;</span><span> </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-2019"></a><span>
</span><a name="line-2020"></a><span class="hs-identifier">mkInlinePragma</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#InlineSpec"><span class="hs-identifier hs-type">InlineSpec</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#RuleMatchInfo"><span class="hs-identifier hs-type">RuleMatchInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="BasicTypes.html#Activation"><span class="hs-identifier hs-type">Activation</span></a><span>
</span><a name="line-2021"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#InlinePragma"><span class="hs-identifier hs-type">InlinePragma</span></a><span>
</span><a name="line-2022"></a><span class="hs-comment">-- The (Maybe Activation) is because the user can omit</span><span>
</span><a name="line-2023"></a><span class="hs-comment">-- the activation spec (and usually does)</span><span>
</span><a name="line-2024"></a><a name="mkInlinePragma"><a href="RdrHsSyn.html#mkInlinePragma"><span class="hs-identifier">mkInlinePragma</span></a></a><span> </span><a name="local-6989586621683975381"><a href="#local-6989586621683975381"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683975382"><a href="#local-6989586621683975382"><span class="hs-identifier">inl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975383"><a href="#local-6989586621683975383"><span class="hs-identifier">match_info</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683975384"><a href="#local-6989586621683975384"><span class="hs-identifier">mb_act</span></a></a><span>
</span><a name="line-2025"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#InlinePragma"><span class="hs-identifier hs-var">InlinePragma</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">inl_src</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975381"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-comment">-- Note [Pragma source text] in BasicTypes</span><span>
</span><a name="line-2026"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975382"><span class="hs-identifier hs-var">inl</span></a><span>
</span><a name="line-2027"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_sat</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2028"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_act</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975385"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-2029"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inl_rule</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975383"><span class="hs-identifier hs-var">match_info</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2030"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2031"></a><span>    </span><a name="local-6989586621683975385"><a href="#local-6989586621683975385"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975384"><span class="hs-identifier hs-var">mb_act</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2032"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683975386"><a href="#local-6989586621683975386"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975386"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-2033"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- No phase specified</span><span>
</span><a name="line-2034"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975382"><span class="hs-identifier hs-var">inl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2035"></a><span>                          </span><a href="BasicTypes.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#NeverActive"><span class="hs-identifier hs-var">NeverActive</span></a><span>
</span><a name="line-2036"></a><span>                          </span><a name="local-6989586621683975387"><a href="#local-6989586621683975387"><span class="hs-identifier">_other</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#AlwaysActive"><span class="hs-identifier hs-var">AlwaysActive</span></a><span>
</span><a name="line-2037"></a><span>
</span><a name="line-2038"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2039"></a><span class="hs-comment">-- utilities for foreign declarations</span><span>
</span><a name="line-2040"></a><span>
</span><a name="line-2041"></a><span class="hs-comment">-- construct a foreign import declaration</span><span>
</span><a name="line-2042"></a><span class="hs-comment">--</span><span>
</span><a name="line-2043"></a><span class="hs-identifier">mkImport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CCallConv"><span class="hs-identifier hs-type">CCallConv</span></a><span>
</span><a name="line-2044"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#Safety"><span class="hs-identifier hs-type">Safety</span></a><span>
</span><a name="line-2045"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="BasicTypes.html#StringLiteral"><span class="hs-identifier hs-type">StringLiteral</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2046"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDecl"><span class="hs-identifier hs-type">HsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2047"></a><a name="mkImport"><a href="RdrHsSyn.html#mkImport"><span class="hs-identifier">mkImport</span></a></a><span> </span><a name="local-6989586621683975388"><a href="#local-6989586621683975388"><span class="hs-identifier">cconv</span></a></a><span> </span><a name="local-6989586621683975389"><a href="#local-6989586621683975389"><span class="hs-identifier">safety</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975390"><a href="#local-6989586621683975390"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#StringLiteral"><span class="hs-identifier hs-var">StringLiteral</span></a><span> </span><a name="local-6989586621683975391"><a href="#local-6989586621683975391"><span class="hs-identifier">esrc</span></a></a><span> </span><a name="local-6989586621683975392"><a href="#local-6989586621683975392"><span class="hs-identifier">entity</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975393"><a href="#local-6989586621683975393"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975394"><a href="#local-6989586621683975394"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2048"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975388"><span class="hs-identifier hs-var">cconv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2049"></a><span>      </span><a href="ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975395"><span class="hs-identifier hs-var">mkCImport</span></a><span>
</span><a name="line-2050"></a><span>      </span><a href="ForeignCall.html#CApiConv"><span class="hs-identifier hs-var">CApiConv</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975395"><span class="hs-identifier hs-var">mkCImport</span></a><span>
</span><a name="line-2051"></a><span>      </span><a href="ForeignCall.html#StdCallConv"><span class="hs-identifier hs-var">StdCallConv</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975395"><span class="hs-identifier hs-var">mkCImport</span></a><span>
</span><a name="line-2052"></a><span>      </span><a href="ForeignCall.html#PrimCallConv"><span class="hs-identifier hs-var">PrimCallConv</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975396"><span class="hs-identifier hs-var">mkOtherImport</span></a><span>
</span><a name="line-2053"></a><span>      </span><a href="ForeignCall.html#JavaScriptCallConv"><span class="hs-identifier hs-var">JavaScriptCallConv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975396"><span class="hs-identifier hs-var">mkOtherImport</span></a><span>
</span><a name="line-2054"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2055"></a><span>    </span><span class="hs-comment">-- Parse a C-like entity string of the following form:</span><span>
</span><a name="line-2056"></a><span>    </span><span class="hs-comment">--   &quot;[static] [chname] [&amp;] [cid]&quot; | &quot;dynamic&quot; | &quot;wrapper&quot;</span><span>
</span><a name="line-2057"></a><span>    </span><span class="hs-comment">-- If 'cid' is missing, the function name 'v' is used instead as symbol</span><span>
</span><a name="line-2058"></a><span>    </span><span class="hs-comment">-- name (cf section 8.5.1 in Haskell 2010 report).</span><span>
</span><a name="line-2059"></a><span>    </span><a name="local-6989586621683975395"><a href="#local-6989586621683975395"><span class="hs-identifier">mkCImport</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2060"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975398"><a href="#local-6989586621683975398"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-6989586621683975392"><span class="hs-identifier hs-var">entity</span></a><span>
</span><a name="line-2061"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="RdrHsSyn.html#parseCImport"><span class="hs-identifier hs-var">parseCImport</span></a><span> </span><a href="#local-6989586621683975388"><span class="hs-identifier hs-var">cconv</span></a><span> </span><a href="#local-6989586621683975389"><span class="hs-identifier hs-var">safety</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mkExtName"><span class="hs-identifier hs-var">mkExtName</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975393"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975398"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975390"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975391"><span class="hs-identifier hs-var">esrc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2062"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975390"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Malformed entity string&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2063"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683975399"><a href="#local-6989586621683975399"><span class="hs-identifier">importSpec</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975397"><span class="hs-identifier hs-var">returnSpec</span></a><span> </span><a href="#local-6989586621683975399"><span class="hs-identifier hs-var">importSpec</span></a><span>
</span><a name="line-2064"></a><span>
</span><a name="line-2065"></a><span>    </span><span class="hs-comment">-- currently, all the other import conventions only support a symbol name in</span><span>
</span><a name="line-2066"></a><span>    </span><span class="hs-comment">-- the entity string. If it is missing, we use the function name instead.</span><span>
</span><a name="line-2067"></a><span>    </span><a name="local-6989586621683975396"><a href="#local-6989586621683975396"><span class="hs-identifier">mkOtherImport</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975397"><span class="hs-identifier hs-var">returnSpec</span></a><span> </span><a href="#local-6989586621683975402"><span class="hs-identifier hs-var">importSpec</span></a><span>
</span><a name="line-2068"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-2069"></a><span>        </span><a name="local-6989586621683975400"><a href="#local-6989586621683975400"><span class="hs-identifier">entity'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="FastString.html#nullFS"><span class="hs-identifier hs-var">nullFS</span></a><span> </span><a href="#local-6989586621683975392"><span class="hs-identifier hs-var">entity</span></a><span>
</span><a name="line-2070"></a><span>                        </span><span class="hs-keyword">then</span><span> </span><a href="RdrHsSyn.html#mkExtName"><span class="hs-identifier hs-var">mkExtName</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975393"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2071"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621683975392"><span class="hs-identifier hs-var">entity</span></a><span>
</span><a name="line-2072"></a><span>        </span><a name="local-6989586621683975401"><a href="#local-6989586621683975401"><span class="hs-identifier">funcTarget</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#CFunction"><span class="hs-identifier hs-var">CFunction</span></a><span> </span><span class="hs-special">(</span><a href="ForeignCall.html#StaticTarget"><span class="hs-identifier hs-var">StaticTarget</span></a><span> </span><a href="#local-6989586621683975391"><span class="hs-identifier hs-var">esrc</span></a><span> </span><a href="#local-6989586621683975400"><span class="hs-identifier hs-var">entity'</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-2073"></a><span>        </span><a name="local-6989586621683975402"><a href="#local-6989586621683975402"><span class="hs-identifier">importSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#CImport"><span class="hs-identifier hs-var">CImport</span></a><span> </span><a href="#local-6989586621683975388"><span class="hs-identifier hs-var">cconv</span></a><span> </span><a href="#local-6989586621683975389"><span class="hs-identifier hs-var">safety</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621683975401"><span class="hs-identifier hs-var">funcTarget</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975390"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975391"><span class="hs-identifier hs-var">esrc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span>    </span><a name="local-6989586621683975397"><a href="#local-6989586621683975397"><span class="hs-identifier">returnSpec</span></a></a><span> </span><a name="local-6989586621683975403"><a href="#local-6989586621683975403"><span class="hs-identifier">spec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsDecls.html#ForD"><span class="hs-identifier hs-var">ForD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsDecls.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a><span>
</span><a name="line-2076"></a><span>          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_i_ext</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-2077"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_name</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975393"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2078"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975394"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2079"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fi</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975403"><span class="hs-identifier hs-var">spec</span></a><span>
</span><a name="line-2080"></a><span>          </span><span class="hs-special">}</span><span>
</span><a name="line-2081"></a><span>
</span><a name="line-2082"></a><span>
</span><a name="line-2083"></a><span>
</span><a name="line-2084"></a><span class="hs-comment">-- the string &quot;foo&quot; is ambiguous: either a header or a C identifier.  The</span><span>
</span><a name="line-2085"></a><span class="hs-comment">-- C identifier case comes first in the alternatives below, so we pick</span><span>
</span><a name="line-2086"></a><span class="hs-comment">-- that one.</span><span>
</span><a name="line-2087"></a><span class="hs-identifier">parseCImport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CCallConv"><span class="hs-identifier hs-type">CCallConv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#Safety"><span class="hs-identifier hs-type">Safety</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-2088"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span>
</span><a name="line-2089"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HsDecls.html#ForeignImport"><span class="hs-identifier hs-type">ForeignImport</span></a><span>
</span><a name="line-2090"></a><a name="parseCImport"><a href="RdrHsSyn.html#parseCImport"><span class="hs-identifier">parseCImport</span></a></a><span> </span><a name="local-6989586621683975404"><a href="#local-6989586621683975404"><span class="hs-identifier">cconv</span></a></a><span> </span><a name="local-6989586621683975405"><a href="#local-6989586621683975405"><span class="hs-identifier">safety</span></a></a><span> </span><a name="local-6989586621683975406"><a href="#local-6989586621683975406"><span class="hs-identifier">nm</span></a></a><span> </span><a name="local-6989586621683975407"><a href="#local-6989586621683975407"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621683975408"><a href="#local-6989586621683975408"><span class="hs-identifier">sourceText</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2091"></a><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-2092"></a><span>     </span><span class="hs-identifier hs-var">readP_to_S</span><span> </span><a href="#local-6989586621683975409"><span class="hs-identifier hs-var">parse</span></a><span> </span><a href="#local-6989586621683975407"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-2093"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2094"></a><span>   </span><a name="local-6989586621683975409"><a href="#local-6989586621683975409"><span class="hs-identifier">parse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2095"></a><span>       </span><span class="hs-identifier hs-var">skipSpaces</span><span>
</span><a name="line-2096"></a><span>       </span><a name="local-6989586621683975417"><a href="#local-6989586621683975417"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">choice</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-2097"></a><span>          </span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;dynamic&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975411"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#CFunction"><span class="hs-identifier hs-var">CFunction</span></a><span> </span><a href="ForeignCall.html#DynamicTarget"><span class="hs-identifier hs-var">DynamicTarget</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2098"></a><span>          </span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;wrapper&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975411"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="HsDecls.html#CWrapper"><span class="hs-identifier hs-var">CWrapper</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-2099"></a><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">optional</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975410"><span class="hs-identifier hs-var">token</span></a><span> </span><span class="hs-string">&quot;static&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">skipSpaces</span><span class="hs-special">)</span><span>
</span><a name="line-2100"></a><span>             </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621683975411"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975415"><span class="hs-identifier hs-var">cimp</span></a><span> </span><a href="#local-6989586621683975406"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+++</span><span>
</span><a name="line-2101"></a><span>              </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683975416"><a href="#local-6989586621683975416"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">munch1</span><span> </span><a href="#local-6989586621683975412"><span class="hs-identifier hs-var">hdr_char</span></a><span>
</span><a name="line-2102"></a><span>                  </span><span class="hs-identifier hs-var">skipSpaces</span><span>
</span><a name="line-2103"></a><span>                  </span><a href="#local-6989586621683975411"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="ForeignCall.html#Header"><span class="hs-identifier hs-var">Header</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-var">SourceText</span></a><span> </span><a href="#local-6989586621683975416"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-6989586621683975416"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2104"></a><span>                      </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975415"><span class="hs-identifier hs-var">cimp</span></a><span> </span><a href="#local-6989586621683975406"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2105"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-2106"></a><span>       </span><span class="hs-identifier hs-var">skipSpaces</span><span>
</span><a name="line-2107"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683975417"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-2108"></a><span>
</span><a name="line-2109"></a><span>   </span><a name="local-6989586621683975410"><a href="#local-6989586621683975410"><span class="hs-identifier">token</span></a></a><span> </span><a name="local-6989586621683975418"><a href="#local-6989586621683975418"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">string</span><span> </span><a href="#local-6989586621683975418"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-2110"></a><span>                  </span><a name="local-6989586621683975419"><a href="#local-6989586621683975419"><span class="hs-identifier">toks</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">look</span><span>
</span><a name="line-2111"></a><span>                  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975419"><span class="hs-identifier hs-var">toks</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2112"></a><span>                      </span><a name="local-6989586621683975420"><a href="#local-6989586621683975420"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-2113"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683975414"><span class="hs-identifier hs-var">id_char</span></a><span> </span><a href="#local-6989586621683975420"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pfail</span><span>
</span><a name="line-2114"></a><span>                      </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><span>
</span><a name="line-2116"></a><span>   </span><a name="local-6989586621683975411"><a href="#local-6989586621683975411"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621683975421"><a href="#local-6989586621683975421"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621683975422"><a href="#local-6989586621683975422"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#CImport"><span class="hs-identifier hs-var">CImport</span></a><span> </span><a href="#local-6989586621683975404"><span class="hs-identifier hs-var">cconv</span></a><span> </span><a href="#local-6989586621683975405"><span class="hs-identifier hs-var">safety</span></a><span> </span><a href="#local-6989586621683975421"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621683975422"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621683975408"><span class="hs-identifier hs-var">sourceText</span></a><span>
</span><a name="line-2117"></a><span>
</span><a name="line-2118"></a><span>   </span><a name="local-6989586621683975412"><a href="#local-6989586621683975412"><span class="hs-identifier">hdr_char</span></a></a><span> </span><a name="local-6989586621683975423"><a href="#local-6989586621683975423"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621683975423"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2119"></a><span>   </span><span class="hs-comment">-- header files are filenames, which can contain</span><span>
</span><a name="line-2120"></a><span>   </span><span class="hs-comment">-- pretty much any char (depending on the platform),</span><span>
</span><a name="line-2121"></a><span>   </span><span class="hs-comment">-- so just accept any non-space character</span><span>
</span><a name="line-2122"></a><span>   </span><a name="local-6989586621683975413"><a href="#local-6989586621683975413"><span class="hs-identifier">id_first_char</span></a></a><span> </span><a name="local-6989586621683975424"><a href="#local-6989586621683975424"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isAlpha</span><span>    </span><a href="#local-6989586621683975424"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621683975424"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'_'</span><span>
</span><a name="line-2123"></a><span>   </span><a name="local-6989586621683975414"><a href="#local-6989586621683975414"><span class="hs-identifier">id_char</span></a></a><span>       </span><a name="local-6989586621683975425"><a href="#local-6989586621683975425"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isAlphaNum</span><span> </span><a href="#local-6989586621683975425"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621683975425"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'_'</span><span>
</span><a name="line-2124"></a><span>
</span><a name="line-2125"></a><span>   </span><a name="local-6989586621683975415"><a href="#local-6989586621683975415"><span class="hs-identifier">cimp</span></a></a><span> </span><a name="local-6989586621683975426"><a href="#local-6989586621683975426"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ReadP.char</span><span> </span><span class="hs-char">'&amp;'</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">skipSpaces</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="HsDecls.html#CLabel"><span class="hs-identifier hs-var">CLabel</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975427"><span class="hs-identifier hs-var">cid</span></a><span class="hs-special">)</span><span>
</span><a name="line-2126"></a><span>             </span><span class="hs-operator hs-var">+++</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683975430"><a href="#local-6989586621683975430"><span class="hs-identifier">isFun</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975404"><span class="hs-identifier hs-var">cconv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2127"></a><span>                               </span><a href="ForeignCall.html#CApiConv"><span class="hs-identifier hs-var">CApiConv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2128"></a><span>                                  </span><span class="hs-identifier hs-var">option</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2129"></a><span>                                         </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a href="#local-6989586621683975410"><span class="hs-identifier hs-var">token</span></a><span> </span><span class="hs-string">&quot;value&quot;</span><span>
</span><a name="line-2130"></a><span>                                             </span><span class="hs-identifier hs-var">skipSpaces</span><span>
</span><a name="line-2131"></a><span>                                             </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-2132"></a><span>                               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2133"></a><span>                     </span><a name="local-6989586621683975431"><a href="#local-6989586621683975431"><span class="hs-identifier">cid'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975427"><span class="hs-identifier hs-var">cid</span></a><span>
</span><a name="line-2134"></a><span>                     </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#CFunction"><span class="hs-identifier hs-var">CFunction</span></a><span> </span><span class="hs-special">(</span><a href="ForeignCall.html#StaticTarget"><span class="hs-identifier hs-var">StaticTarget</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621683975431"><span class="hs-identifier hs-var">cid'</span></a><span>
</span><a name="line-2135"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621683975430"><span class="hs-identifier hs-var">isFun</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2136"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-2137"></a><span>            </span><a name="local-6989586621683975427"><a href="#local-6989586621683975427"><span class="hs-identifier">cid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683975426"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-operator hs-var">+++</span><span>
</span><a name="line-2138"></a><span>                  </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683975428"><a href="#local-6989586621683975428"><span class="hs-identifier">c</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">satisfy</span><span> </span><a href="#local-6989586621683975413"><span class="hs-identifier hs-var">id_first_char</span></a><span>
</span><a name="line-2139"></a><span>                      </span><a name="local-6989586621683975429"><a href="#local-6989586621683975429"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="hs-identifier hs-var">many</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">satisfy</span><span> </span><a href="#local-6989586621683975414"><span class="hs-identifier hs-var">id_char</span></a><span class="hs-special">)</span><span>
</span><a name="line-2140"></a><span>                      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975428"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683975429"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2141"></a><span>
</span><a name="line-2142"></a><span>
</span><a name="line-2143"></a><span class="hs-comment">-- construct a foreign export declaration</span><span>
</span><a name="line-2144"></a><span class="hs-comment">--</span><span>
</span><a name="line-2145"></a><span class="hs-identifier">mkExport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="ForeignCall.html#CCallConv"><span class="hs-identifier hs-type">CCallConv</span></a><span>
</span><a name="line-2146"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="BasicTypes.html#StringLiteral"><span class="hs-identifier hs-type">StringLiteral</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2147"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDecl"><span class="hs-identifier hs-type">HsDecl</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2148"></a><a name="mkExport"><a href="RdrHsSyn.html#mkExport"><span class="hs-identifier">mkExport</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975432"><a href="#local-6989586621683975432"><span class="hs-identifier">lc</span></a></a><span> </span><a name="local-6989586621683975433"><a href="#local-6989586621683975433"><span class="hs-identifier">cconv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975434"><a href="#local-6989586621683975434"><span class="hs-identifier">le</span></a></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#StringLiteral"><span class="hs-identifier hs-var">StringLiteral</span></a><span> </span><a name="local-6989586621683975435"><a href="#local-6989586621683975435"><span class="hs-identifier">esrc</span></a></a><span> </span><a name="local-6989586621683975436"><a href="#local-6989586621683975436"><span class="hs-identifier">entity</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683975437"><a href="#local-6989586621683975437"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683975438"><a href="#local-6989586621683975438"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2149"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsDecls.html#ForD"><span class="hs-identifier hs-var">ForD</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-2150"></a><span>   </span><a href="HsDecls.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_e_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975437"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_sig_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975438"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2151"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fd_fe</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#CExport"><span class="hs-identifier hs-var">CExport</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975432"><span class="hs-identifier hs-var">lc</span></a><span> </span><span class="hs-special">(</span><a href="ForeignCall.html#CExportStatic"><span class="hs-identifier hs-var">CExportStatic</span></a><span> </span><a href="#local-6989586621683975435"><span class="hs-identifier hs-var">esrc</span></a><span> </span><a href="#local-6989586621683975439"><span class="hs-identifier hs-var">entity'</span></a><span> </span><a href="#local-6989586621683975433"><span class="hs-identifier hs-var">cconv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2152"></a><span>                                   </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975434"><span class="hs-identifier hs-var">le</span></a><span> </span><a href="#local-6989586621683975435"><span class="hs-identifier hs-var">esrc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2153"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2154"></a><span>    </span><a name="local-6989586621683975439"><a href="#local-6989586621683975439"><span class="hs-identifier">entity'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="FastString.html#nullFS"><span class="hs-identifier hs-var">nullFS</span></a><span> </span><a href="#local-6989586621683975436"><span class="hs-identifier hs-var">entity</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#mkExtName"><span class="hs-identifier hs-var">mkExtName</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975437"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2155"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975436"><span class="hs-identifier hs-var">entity</span></a><span>
</span><a name="line-2156"></a><span>
</span><a name="line-2157"></a><span class="hs-comment">-- Supplying the ext_name in a foreign decl is optional; if it</span><span>
</span><a name="line-2158"></a><span class="hs-comment">-- isn't there, the Haskell name is assumed. Note that no transformation</span><span>
</span><a name="line-2159"></a><span class="hs-comment">-- of the Haskell name is then performed, so if you foreign export (++),</span><span>
</span><a name="line-2160"></a><span class="hs-comment">-- it's external name will be &quot;++&quot;. Too bad; it's important because we don't</span><span>
</span><a name="line-2161"></a><span class="hs-comment">-- want z-encoding (e.g. names with z's in them shouldn't be doubled)</span><span>
</span><a name="line-2162"></a><span class="hs-comment">--</span><span>
</span><a name="line-2163"></a><span class="hs-identifier">mkExtName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForeignCall.html#CLabelString"><span class="hs-identifier hs-type">CLabelString</span></a><span>
</span><a name="line-2164"></a><a name="mkExtName"><a href="RdrHsSyn.html#mkExtName"><span class="hs-identifier">mkExtName</span></a></a><span> </span><a name="local-6989586621683975440"><a href="#local-6989586621683975440"><span class="hs-identifier">rdrNm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621683975440"><span class="hs-identifier hs-var">rdrNm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2165"></a><span>
</span><a name="line-2166"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-2167"></a><span class="hs-comment">-- Help with module system imports/exports</span><span>
</span><a name="line-2168"></a><span>
</span><a name="line-2169"></a><span class="hs-keyword">data</span><span> </span><a name="ImpExpSubSpec"><a href="RdrHsSyn.html#ImpExpSubSpec"><span class="hs-identifier">ImpExpSubSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ImpExpAbs"><a href="RdrHsSyn.html#ImpExpAbs"><span class="hs-identifier">ImpExpAbs</span></a></a><span>
</span><a name="line-2170"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="ImpExpAll"><a href="RdrHsSyn.html#ImpExpAll"><span class="hs-identifier">ImpExpAll</span></a></a><span>
</span><a name="line-2171"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="ImpExpList"><a href="RdrHsSyn.html#ImpExpList"><span class="hs-identifier">ImpExpList</span></a></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span class="hs-special">]</span><span>
</span><a name="line-2172"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="ImpExpAllWith"><a href="RdrHsSyn.html#ImpExpAllWith"><span class="hs-identifier">ImpExpAllWith</span></a></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span class="hs-special">]</span><span>
</span><a name="line-2173"></a><span>
</span><a name="line-2174"></a><span class="hs-keyword">data</span><span> </span><a name="ImpExpQcSpec"><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier">ImpExpQcSpec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ImpExpQcName"><a href="RdrHsSyn.html#ImpExpQcName"><span class="hs-identifier">ImpExpQcName</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2175"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="ImpExpQcType"><a href="RdrHsSyn.html#ImpExpQcType"><span class="hs-identifier">ImpExpQcType</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2176"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="ImpExpQcWildcard"><a href="RdrHsSyn.html#ImpExpQcWildcard"><span class="hs-identifier">ImpExpQcWildcard</span></a></a><span>
</span><a name="line-2177"></a><span>
</span><a name="line-2178"></a><span class="hs-identifier">mkModuleImpExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#ImpExpSubSpec"><span class="hs-identifier hs-type">ImpExpSubSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2179"></a><a name="mkModuleImpExp"><a href="RdrHsSyn.html#mkModuleImpExp"><span class="hs-identifier">mkModuleImpExp</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975441"><a href="#local-6989586621683975441"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683975442"><a href="#local-6989586621683975442"><span class="hs-identifier">specname</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683975443"><a href="#local-6989586621683975443"><span class="hs-identifier">subs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2180"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683975443"><span class="hs-identifier hs-var">subs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2181"></a><span>    </span><a href="RdrHsSyn.html#ImpExpAbs"><span class="hs-identifier hs-var">ImpExpAbs</span></a><span>
</span><a name="line-2182"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isVarNameSpace"><span class="hs-identifier hs-var">isVarNameSpace</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameSpace"><span class="hs-identifier hs-var">rdrNameSpace</span></a><span> </span><a href="#local-6989586621683975444"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2183"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsImpExp.html#IEVar"><span class="hs-identifier hs-var">IEVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975447"><span class="hs-identifier hs-var">ieNameFromSpec</span></a><span> </span><a href="#local-6989586621683975442"><span class="hs-identifier hs-var">specname</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2184"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsImpExp.html#IEThingAbs"><span class="hs-identifier hs-var">IEThingAbs</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975445"><span class="hs-identifier hs-var">nameT</span></a><span>
</span><a name="line-2185"></a><span>    </span><a href="RdrHsSyn.html#ImpExpAll"><span class="hs-identifier hs-var">ImpExpAll</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsImpExp.html#IEThingAll"><span class="hs-identifier hs-var">IEThingAll</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975445"><span class="hs-identifier hs-var">nameT</span></a><span>
</span><a name="line-2186"></a><span>    </span><a href="RdrHsSyn.html#ImpExpList"><span class="hs-identifier hs-var">ImpExpList</span></a><span> </span><a name="local-6989586621683975453"><a href="#local-6989586621683975453"><span class="hs-identifier">xs</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2187"></a><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975454"><a href="#local-6989586621683975454"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975454"><span class="hs-identifier hs-var">newName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2188"></a><span>        </span><a href="HsImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975448"><span class="hs-identifier hs-var">wrapped</span></a><span> </span><a href="#local-6989586621683975453"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975445"><span class="hs-identifier hs-var">nameT</span></a><span>
</span><a name="line-2189"></a><span>    </span><a href="RdrHsSyn.html#ImpExpAllWith"><span class="hs-identifier hs-var">ImpExpAllWith</span></a><span> </span><a name="local-6989586621683975455"><a href="#local-6989586621683975455"><span class="hs-identifier">xs</span></a></a><span>                       </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2190"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683975456"><a href="#local-6989586621683975456"><span class="hs-identifier">allowed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#PatternSynonymsBit"><span class="hs-identifier hs-var">PatternSynonymsBit</span></a><span>
</span><a name="line-2191"></a><span>         </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683975456"><span class="hs-identifier hs-var">allowed</span></a><span>
</span><a name="line-2192"></a><span>          </span><span class="hs-keyword">then</span><span>
</span><a name="line-2193"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975457"><a href="#local-6989586621683975457"><span class="hs-identifier">withs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975455"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2194"></a><span>                </span><a name="local-6989586621683975458"><a href="#local-6989586621683975458"><span class="hs-identifier">pos</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="HsImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a><span> </span><a href="HsImpExp.html#IEWildcard"><span class="hs-identifier hs-var">IEWildcard</span></a><span>
</span><a name="line-2195"></a><span>                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">findIndex</span><span> </span><a href="RdrHsSyn.html#isImpExpQcWildcard"><span class="hs-identifier hs-var">isImpExpQcWildcard</span></a><span> </span><a href="#local-6989586621683975457"><span class="hs-identifier hs-var">withs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2196"></a><span>                </span><a name="local-6989586621683975459"><a href="#local-6989586621683975459"><span class="hs-identifier">ies</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975448"><span class="hs-identifier hs-var">wrapped</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="RdrHsSyn.html#isImpExpQcWildcard"><span class="hs-identifier hs-var">isImpExpQcWildcard</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975455"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2197"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683975460"><a href="#local-6989586621683975460"><span class="hs-identifier">newName</span></a></a><span>
</span><a name="line-2198"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621683975460"><span class="hs-identifier hs-var">newName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975458"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621683975459"><span class="hs-identifier hs-var">ies</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2199"></a><span>               </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621683975445"><span class="hs-identifier hs-var">nameT</span></a><span>
</span><a name="line-2200"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2201"></a><span>            </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal export form (use PatternSynonyms to enable)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2202"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2203"></a><span>    </span><a name="local-6989586621683975444"><a href="#local-6989586621683975444"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975446"><span class="hs-identifier hs-var">ieNameVal</span></a><span> </span><a href="#local-6989586621683975442"><span class="hs-identifier hs-var">specname</span></a><span>
</span><a name="line-2204"></a><span>    </span><a name="local-6989586621683975445"><a href="#local-6989586621683975445"><span class="hs-identifier">nameT</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2205"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="OccName.html#isVarNameSpace"><span class="hs-identifier hs-var">isVarNameSpace</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameSpace"><span class="hs-identifier hs-var">rdrNameSpace</span></a><span> </span><a href="#local-6989586621683975444"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2206"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975441"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2207"></a><span>              </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Expecting a type constructor but found a variable,&quot;</span><span>
</span><a name="line-2208"></a><span>               </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975444"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-2209"></a><span>              </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621683975444"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2210"></a><span>                   </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;If&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975444"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2211"></a><span>                        </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is a type constructor&quot;</span><span>
</span><a name="line-2212"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;then enable ExplicitNamespaces and use the 'type' keyword.&quot;</span><span>
</span><a name="line-2213"></a><span>                   </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2214"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621683975447"><span class="hs-identifier hs-var">ieNameFromSpec</span></a><span> </span><a href="#local-6989586621683975442"><span class="hs-identifier hs-var">specname</span></a><span>
</span><a name="line-2215"></a><span>
</span><a name="line-2216"></a><span>    </span><a name="local-6989586621683975446"><a href="#local-6989586621683975446"><span class="hs-identifier">ieNameVal</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcName"><span class="hs-identifier hs-var">ImpExpQcName</span></a><span> </span><a name="local-6989586621683975449"><a href="#local-6989586621683975449"><span class="hs-identifier">ln</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975449"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-2217"></a><span>    </span><span class="hs-identifier">ieNameVal</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcType"><span class="hs-identifier hs-var">ImpExpQcType</span></a><span> </span><a name="local-6989586621683975450"><a href="#local-6989586621683975450"><span class="hs-identifier">ln</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683975450"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-2218"></a><span>    </span><span class="hs-identifier">ieNameVal</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcWildcard"><span class="hs-identifier hs-var">ImpExpQcWildcard</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;ieNameVal got wildcard&quot;</span><span>
</span><a name="line-2219"></a><span>
</span><a name="line-2220"></a><span>    </span><a name="local-6989586621683975447"><a href="#local-6989586621683975447"><span class="hs-identifier">ieNameFromSpec</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcName"><span class="hs-identifier hs-var">ImpExpQcName</span></a><span> </span><a name="local-6989586621683975451"><a href="#local-6989586621683975451"><span class="hs-identifier">ln</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsImpExp.html#IEName"><span class="hs-identifier hs-var">IEName</span></a><span> </span><a href="#local-6989586621683975451"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-2221"></a><span>    </span><span class="hs-identifier">ieNameFromSpec</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcType"><span class="hs-identifier hs-var">ImpExpQcType</span></a><span> </span><a name="local-6989586621683975452"><a href="#local-6989586621683975452"><span class="hs-identifier">ln</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsImpExp.html#IEType"><span class="hs-identifier hs-var">IEType</span></a><span> </span><a href="#local-6989586621683975452"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-2222"></a><span>    </span><span class="hs-identifier">ieNameFromSpec</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#ImpExpQcWildcard"><span class="hs-identifier hs-var">ImpExpQcWildcard</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;ieName got wildcard&quot;</span><span>
</span><a name="line-2223"></a><span>
</span><a name="line-2224"></a><span>    </span><a name="local-6989586621683975448"><a href="#local-6989586621683975448"><span class="hs-identifier">wrapped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#onHasSrcSpan"><span class="hs-identifier hs-var">onHasSrcSpan</span></a><span> </span><a href="#local-6989586621683975447"><span class="hs-identifier hs-var">ieNameFromSpec</span></a><span class="hs-special">)</span><span>
</span><a name="line-2225"></a><span>
</span><a name="line-2226"></a><span class="hs-identifier">mkTypeImpExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>   </span><span class="hs-comment">-- TcCls or Var name space</span><span>
</span><a name="line-2227"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-2228"></a><a name="mkTypeImpExp"><a href="RdrHsSyn.html#mkTypeImpExp"><span class="hs-identifier">mkTypeImpExp</span></a></a><span> </span><a name="local-6989586621683975461"><a href="#local-6989586621683975461"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2229"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621683975462"><a href="#local-6989586621683975462"><span class="hs-identifier">allowed</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#ExplicitNamespacesBit"><span class="hs-identifier hs-var">ExplicitNamespacesBit</span></a><span>
</span><a name="line-2230"></a><span>     </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683975462"><span class="hs-identifier hs-var">allowed</span></a><span>
</span><a name="line-2231"></a><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="RdrHsSyn.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a><span class="hs-special">`</span><span> </span><a href="OccName.html#tcClsName"><span class="hs-identifier hs-var">tcClsName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975461"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2232"></a><span>       </span><span class="hs-keyword">else</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975461"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-2233"></a><span>              </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal keyword 'type' (use ExplicitNamespaces to enable)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2234"></a><span>
</span><a name="line-2235"></a><span class="hs-identifier">checkImportSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="HsImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="HsImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2236"></a><a name="checkImportSpec"><a href="RdrHsSyn.html#checkImportSpec"><span class="hs-identifier">checkImportSpec</span></a></a><span> </span><a name="local-6989586621683975463"><a href="#local-6989586621683975463"><span class="hs-identifier">ie</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975464"><a href="#local-6989586621683975464"><span class="hs-identifier">specs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2237"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683975467"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975467"><a href="#local-6989586621683975467"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsImpExp.html#IEWildcard"><span class="hs-identifier hs-var">IEWildcard</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683975464"><span class="hs-identifier hs-var">specs</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2238"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683975463"><span class="hs-identifier hs-var">ie</span></a><span>
</span><a name="line-2239"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621683975468"><a href="#local-6989586621683975468"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683975465"><span class="hs-identifier hs-var">importSpecError</span></a><span> </span><a href="#local-6989586621683975468"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2240"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2241"></a><span>    </span><a name="local-6989586621683975465"><a href="#local-6989586621683975465"><span class="hs-identifier">importSpecError</span></a></a><span> </span><a name="local-6989586621683975466"><a href="#local-6989586621683975466"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2242"></a><span>      </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975466"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2243"></a><span>        </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal import form, this syntax can only be used to bundle&quot;</span><span>
</span><a name="line-2244"></a><span>        </span><a href="Outputable.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;pattern synonyms with types in module exports.&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2245"></a><span>
</span><a name="line-2246"></a><span class="hs-comment">-- In the correct order</span><span>
</span><a name="line-2247"></a><span class="hs-identifier">mkImpExpSubSpec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Lexer.html#AddAnn"><span class="hs-identifier hs-type">AddAnn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#ImpExpSubSpec"><span class="hs-identifier hs-type">ImpExpSubSpec</span></a><span class="hs-special">)</span><span>
</span><a name="line-2248"></a><a name="mkImpExpSubSpec"><a href="RdrHsSyn.html#mkImpExpSubSpec"><span class="hs-identifier">mkImpExpSubSpec</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#ImpExpList"><span class="hs-identifier hs-var">ImpExpList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2249"></a><span class="hs-identifier">mkImpExpSubSpec</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="RdrHsSyn.html#ImpExpQcWildcard"><span class="hs-identifier hs-var">ImpExpQcWildcard</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2250"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#ImpExpAll"><span class="hs-identifier hs-var">ImpExpAll</span></a><span class="hs-special">)</span><span>
</span><a name="line-2251"></a><span class="hs-identifier">mkImpExpSubSpec</span><span> </span><a name="local-6989586621683975469"><a href="#local-6989586621683975469"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2252"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#isImpExpQcWildcard"><span class="hs-identifier hs-var">isImpExpQcWildcard</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683975469"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2253"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#ImpExpAllWith"><span class="hs-identifier hs-var">ImpExpAllWith</span></a><span> </span><a href="#local-6989586621683975469"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2254"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="RdrHsSyn.html#ImpExpList"><span class="hs-identifier hs-var">ImpExpList</span></a><span> </span><a href="#local-6989586621683975469"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2255"></a><span>
</span><a name="line-2256"></a><span class="hs-identifier">isImpExpQcWildcard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrHsSyn.html#ImpExpQcSpec"><span class="hs-identifier hs-type">ImpExpQcSpec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2257"></a><a name="isImpExpQcWildcard"><a href="RdrHsSyn.html#isImpExpQcWildcard"><span class="hs-identifier">isImpExpQcWildcard</span></a></a><span> </span><a href="RdrHsSyn.html#ImpExpQcWildcard"><span class="hs-identifier hs-var">ImpExpQcWildcard</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2258"></a><span class="hs-identifier">isImpExpQcWildcard</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2259"></a><span>
</span><a name="line-2260"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2261"></a><span class="hs-comment">-- Warnings and failures</span><span>
</span><a name="line-2262"></a><span>
</span><a name="line-2263"></a><span class="hs-identifier">warnStarIsType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2264"></a><a name="warnStarIsType"><a href="RdrHsSyn.html#warnStarIsType"><span class="hs-identifier">warnStarIsType</span></a></a><span> </span><a name="local-6989586621683975470"><a href="#local-6989586621683975470"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lexer.html#addWarning"><span class="hs-identifier hs-var">addWarning</span></a><span> </span><a href="DynFlags.html#Opt_WarnStarIsType"><span class="hs-identifier hs-var">Opt_WarnStarIsType</span></a><span> </span><a href="#local-6989586621683975470"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621683975471"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2265"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2266"></a><span>    </span><a name="local-6989586621683975471"><a href="#local-6989586621683975471"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Using&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2267"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(or its Unicode variant) to mean&quot;</span><span>
</span><a name="line-2268"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data.Kind.Type&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2269"></a><span>        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;relies on the StarIsType extension, which will become&quot;</span><span>
</span><a name="line-2270"></a><span>        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;deprecated in the future.&quot;</span><span>
</span><a name="line-2271"></a><span>        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Suggested fix: use&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2272"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;from&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Data.Kind&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;instead.&quot;</span><span>
</span><a name="line-2273"></a><span>
</span><a name="line-2274"></a><span class="hs-identifier">warnStarBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2275"></a><a name="warnStarBndr"><a href="RdrHsSyn.html#warnStarBndr"><span class="hs-identifier">warnStarBndr</span></a></a><span> </span><a name="local-6989586621683975472"><a href="#local-6989586621683975472"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lexer.html#addWarning"><span class="hs-identifier hs-var">addWarning</span></a><span> </span><a href="DynFlags.html#Opt_WarnStarBinder"><span class="hs-identifier hs-var">Opt_WarnStarBinder</span></a><span> </span><a href="#local-6989586621683975472"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621683975473"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2276"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2277"></a><span>    </span><a name="local-6989586621683975473"><a href="#local-6989586621683975473"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Found binding occurrence of&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2278"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;yet StarIsType is enabled.&quot;</span><span>
</span><a name="line-2279"></a><span>        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NB. To use (or export) this operator in&quot;</span><span>
</span><a name="line-2280"></a><span>           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;modules with StarIsType,&quot;</span><span>
</span><a name="line-2281"></a><span>        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;    including the definition module, you must qualify it.&quot;</span><span>
</span><a name="line-2282"></a><span>
</span><a name="line-2283"></a><span class="hs-identifier">failOpFewArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974390"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2284"></a><a name="failOpFewArgs"><a href="RdrHsSyn.html#failOpFewArgs"><span class="hs-identifier">failOpFewArgs</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975474"><a href="#local-6989586621683975474"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975475"><a href="#local-6989586621683975475"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2285"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683975477"><a href="#local-6989586621683975477"><span class="hs-identifier">star_is_type</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#StarIsTypeBit"><span class="hs-identifier hs-var">StarIsTypeBit</span></a><span>
</span><a name="line-2286"></a><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975478"><a href="#local-6989586621683975478"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683975476"><span class="hs-identifier hs-var">too_few</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="RdrName.html#starInfo"><span class="hs-identifier hs-var">starInfo</span></a><span> </span><a href="#local-6989586621683975477"><span class="hs-identifier hs-var">star_is_type</span></a><span> </span><a href="#local-6989586621683975475"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-2287"></a><span>     </span><span class="hs-special">;</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975474"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975478"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2288"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2289"></a><span>    </span><a name="local-6989586621683975476"><a href="#local-6989586621683975476"><span class="hs-identifier">too_few</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Operator applied to too few arguments:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975475"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-2290"></a><span>
</span><a name="line-2291"></a><span class="hs-identifier">failOpDocPrev</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974389"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2292"></a><a name="failOpDocPrev"><a href="RdrHsSyn.html#failOpDocPrev"><span class="hs-identifier">failOpDocPrev</span></a></a><span> </span><a name="local-6989586621683975479"><a href="#local-6989586621683975479"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975479"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975480"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2293"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2294"></a><span>    </span><a name="local-6989586621683975480"><a href="#local-6989586621683975480"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected documentation comment.&quot;</span><span>
</span><a name="line-2295"></a><span>
</span><a name="line-2296"></a><span class="hs-identifier">failOpStrictnessCompound</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974388"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2297"></a><a name="failOpStrictnessCompound"><a href="RdrHsSyn.html#failOpStrictnessCompound"><span class="hs-identifier">failOpStrictnessCompound</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975481"><a href="#local-6989586621683975481"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975482"><a href="#local-6989586621683975482"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683975483"><a href="#local-6989586621683975483"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975482"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975484"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2298"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2299"></a><span>    </span><a name="local-6989586621683975484"><a href="#local-6989586621683975484"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Strictness annotation applied to a compound type.&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2300"></a><span>          </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you mean to add parentheses?&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-2301"></a><span>          </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975481"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975483"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2302"></a><span>
</span><a name="line-2303"></a><span class="hs-identifier">failOpStrictnessPosition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="DataCon.html#SrcStrictness"><span class="hs-identifier hs-type">SrcStrictness</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974387"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2304"></a><a name="failOpStrictnessPosition"><a href="RdrHsSyn.html#failOpStrictnessPosition"><span class="hs-identifier">failOpStrictnessPosition</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683975485"><a href="#local-6989586621683975485"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975485"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683975486"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-2305"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2306"></a><span>    </span><a name="local-6989586621683975486"><a href="#local-6989586621683975486"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Strictness annotation cannot appear in this position.&quot;</span><span>
</span><a name="line-2307"></a><span>
</span><a name="line-2308"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2309"></a><span class="hs-comment">-- Misc utils</span><span>
</span><a name="line-2310"></a><span>
</span><a name="line-2311"></a><span class="hs-identifier">parseErrorSDoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621683974386"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2312"></a><a name="parseErrorSDoc"><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier">parseErrorSDoc</span></a></a><span> </span><a name="local-6989586621683975487"><a href="#local-6989586621683975487"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621683975488"><a href="#local-6989586621683975488"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lexer.html#failSpanMsgP"><span class="hs-identifier hs-var">failSpanMsgP</span></a><span> </span><a href="#local-6989586621683975487"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621683975488"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2313"></a><span>
</span><a name="line-2314"></a><span class="hs-comment">-- | Hint about bang patterns, assuming @BangPatterns@ is off.</span><span>
</span><a name="line-2315"></a><span class="hs-identifier">hintBangPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2316"></a><a name="hintBangPat"><a href="RdrHsSyn.html#hintBangPat"><span class="hs-identifier">hintBangPat</span></a></a><span> </span><a name="local-6989586621683975489"><a href="#local-6989586621683975489"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621683975490"><a href="#local-6989586621683975490"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2317"></a><span>    </span><a name="local-6989586621683975491"><a href="#local-6989586621683975491"><span class="hs-identifier">bang_on</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Lexer.html#getBit"><span class="hs-identifier hs-var">getBit</span></a><span> </span><a href="Lexer.html#BangPatBit"><span class="hs-identifier hs-var">BangPatBit</span></a><span>
</span><a name="line-2318"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621683975491"><span class="hs-identifier hs-var">bang_on</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-2319"></a><span>      </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975489"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-2320"></a><span>        </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal bang-pattern (use BangPatterns):&quot;</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975490"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2321"></a><span>
</span><a name="line-2322"></a><span class="hs-keyword">data</span><span> </span><a name="SumOrTuple"><a href="RdrHsSyn.html#SumOrTuple"><span class="hs-identifier">SumOrTuple</span></a></a><span>
</span><a name="line-2323"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Sum"><a href="RdrHsSyn.html#Sum"><span class="hs-identifier">Sum</span></a></a><span> </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2324"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tuple"><a href="RdrHsSyn.html#Tuple"><span class="hs-identifier">Tuple</span></a></a><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsTupArg"><span class="hs-identifier hs-type">LHsTupArg</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-2325"></a><span>
</span><a name="line-2326"></a><span class="hs-identifier">mkSumOrTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrHsSyn.html#SumOrTuple"><span class="hs-identifier hs-type">SumOrTuple</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lexer.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2327"></a><span>
</span><a name="line-2328"></a><span class="hs-comment">-- Tuple</span><span>
</span><a name="line-2329"></a><a name="mkSumOrTuple"><a href="RdrHsSyn.html#mkSumOrTuple"><span class="hs-identifier">mkSumOrTuple</span></a></a><span> </span><a name="local-6989586621683975492"><a href="#local-6989586621683975492"><span class="hs-identifier">boxity</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a><span> </span><a name="local-6989586621683975493"><a href="#local-6989586621683975493"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975493"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621683975492"><span class="hs-identifier hs-var">boxity</span></a><span class="hs-special">)</span><span>
</span><a name="line-2330"></a><span>
</span><a name="line-2331"></a><span class="hs-comment">-- Sum</span><span>
</span><a name="line-2332"></a><span class="hs-identifier">mkSumOrTuple</span><span> </span><a href="BasicTypes.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><a name="local-6989586621683975494"><a href="#local-6989586621683975494"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621683975495"><a href="#local-6989586621683975495"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621683975496"><a href="#local-6989586621683975496"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2333"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitSum"><span class="hs-identifier hs-var">ExplicitSum</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975494"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621683975495"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621683975496"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2334"></a><span class="hs-identifier">mkSumOrTuple</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span> </span><a name="local-6989586621683975497"><a href="#local-6989586621683975497"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><a name="local-6989586621683975498"><a href="#local-6989586621683975498"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621683975499"><a href="#local-6989586621683975499"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683975500"><a href="#local-6989586621683975500"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2335"></a><span>    </span><a href="RdrHsSyn.html#parseErrorSDoc"><span class="hs-identifier hs-var">parseErrorSDoc</span></a><span> </span><a href="#local-6989586621683975497"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Boxed sums not supported:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-2336"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621683975501"><span class="hs-identifier hs-var">ppr_boxed_sum</span></a><span> </span><a href="#local-6989586621683975498"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621683975499"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621683975500"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2337"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2338"></a><span>    </span><span class="hs-identifier">ppr_boxed_sum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2339"></a><span>    </span><a name="local-6989586621683975501"><a href="#local-6989586621683975501"><span class="hs-identifier">ppr_boxed_sum</span></a></a><span> </span><a name="local-6989586621683975503"><a href="#local-6989586621683975503"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621683975504"><a href="#local-6989586621683975504"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621683975505"><a href="#local-6989586621683975505"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2340"></a><span>      </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683975502"><span class="hs-identifier hs-var">ppr_bars</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975503"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683975505"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683975502"><span class="hs-identifier hs-var">ppr_bars</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683975504"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621683975503"><span class="hs-identifier hs-var">alt</span></a><span class="hs-special">)</span><span>
</span><a name="line-2341"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-2342"></a><span>
</span><a name="line-2343"></a><span>    </span><a name="local-6989586621683975502"><a href="#local-6989586621683975502"><span class="hs-identifier">ppr_bars</span></a></a><span> </span><a name="local-6989586621683975506"><a href="#local-6989586621683975506"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621683975506"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#char"><span class="hs-identifier hs-var">Outputable.char</span></a><span> </span><span class="hs-char">'|'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2344"></a><span>
</span><a name="line-2345"></a><span class="hs-identifier">mkLHsOpTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-2346"></a><a name="mkLHsOpTy"><a href="RdrHsSyn.html#mkLHsOpTy"><span class="hs-identifier">mkLHsOpTy</span></a></a><span> </span><a name="local-6989586621683975507"><a href="#local-6989586621683975507"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683975508"><a href="#local-6989586621683975508"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621683975509"><a href="#local-6989586621683975509"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2347"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975510"><a href="#local-6989586621683975510"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975507"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span class="hs-special">`</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975508"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">`</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span class="hs-special">`</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975509"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2348"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975510"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsOpTy"><span class="hs-identifier hs-var">mkHsOpTy</span></a><span> </span><a href="#local-6989586621683975507"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621683975508"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621683975509"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-2349"></a><span>
</span><a name="line-2350"></a><span class="hs-identifier">mkLHsDocTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDoc.html#LHsDocString"><span class="hs-identifier hs-type">LHsDocString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-2351"></a><a name="mkLHsDocTy"><a href="RdrHsSyn.html#mkLHsDocTy"><span class="hs-identifier">mkLHsDocTy</span></a></a><span> </span><a name="local-6989586621683975511"><a href="#local-6989586621683975511"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621683975512"><a href="#local-6989586621683975512"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2352"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683975513"><a href="#local-6989586621683975513"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975511"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">`</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span class="hs-special">`</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683975512"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2353"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683975513"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683975511"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621683975512"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2354"></a><span>
</span><a name="line-2355"></a><span class="hs-identifier">mkLHsDocTyMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HsDoc.html#LHsDocString"><span class="hs-identifier hs-type">LHsDocString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-2356"></a><a name="mkLHsDocTyMaybe"><a href="RdrHsSyn.html#mkLHsDocTyMaybe"><span class="hs-identifier">mkLHsDocTyMaybe</span></a></a><span> </span><a name="local-6989586621683975514"><a href="#local-6989586621683975514"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621683975514"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="RdrHsSyn.html#mkLHsDocTy"><span class="hs-identifier hs-var">mkLHsDocTy</span></a><span> </span><a href="#local-6989586621683975514"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-2357"></a><span>
</span><a name="line-2358"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2359"></a><span class="hs-comment">-- Token symbols</span><span>
</span><a name="line-2360"></a><span>
</span><a name="line-2361"></a><span class="hs-identifier">starSym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-2362"></a><a name="starSym"><a href="RdrHsSyn.html#starSym"><span class="hs-identifier">starSym</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#9733;&quot;</span><span>
</span><a name="line-2363"></a><span class="hs-identifier">starSym</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;*&quot;</span><span>
</span><a name="line-2364"></a><span>
</span><a name="line-2365"></a><span class="hs-identifier">forallSym</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-2366"></a><a name="forallSym"><a href="RdrHsSyn.html#forallSym"><span class="hs-identifier">forallSym</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#8704;&quot;</span><span>
</span><a name="line-2367"></a><span class="hs-identifier">forallSym</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;forall&quot;</span><span>
</span><a name="line-2368"></a></pre></body></html>