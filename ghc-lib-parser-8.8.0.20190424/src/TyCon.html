<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


The @TyCon@ datatype
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleInstances #-}</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TyCon</span><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>        </span><span class="hs-comment">-- * Main TyCon data types</span><span>
</span><a name="line-13"></a><span>        </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#visibleDataCons"><span class="hs-identifier hs-var">visibleDataCons</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isNoParent"><span class="hs-identifier hs-var">isNoParent</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier hs-type">RuntimeRepInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>        </span><span class="hs-comment">-- * TyConBinder</span><span>
</span><a name="line-20"></a><span>        </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#TyConTyCoBinder"><span class="hs-identifier hs-type">TyConTyCoBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>        </span><a href="TyCon.html#mkNamedTyConBinder"><span class="hs-identifier hs-var">mkNamedTyConBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#mkNamedTyConBinders"><span class="hs-identifier hs-var">mkNamedTyConBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="TyCon.html#mkRequiredTyConBinder"><span class="hs-identifier hs-var">mkRequiredTyConBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="TyCon.html#mkAnonTyConBinder"><span class="hs-identifier hs-var">mkAnonTyConBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#mkAnonTyConBinders"><span class="hs-identifier hs-var">mkAnonTyConBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>        </span><a href="TyCon.html#tyConBinderArgFlag"><span class="hs-identifier hs-var">tyConBinderArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConBndrVisArgFlag"><span class="hs-identifier hs-var">tyConBndrVisArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isNamedTyConBinder"><span class="hs-identifier hs-var">isNamedTyConBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="TyCon.html#isVisibleTyConBinder"><span class="hs-identifier hs-var">isVisibleTyConBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isInvisibleTyConBinder"><span class="hs-identifier hs-var">isInvisibleTyConBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>        </span><span class="hs-comment">-- ** Field labels</span><span>
</span><a name="line-28"></a><span>        </span><a href="TyCon.html#tyConFieldLabels"><span class="hs-identifier hs-var">tyConFieldLabels</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#lookupTyConFieldLabel"><span class="hs-identifier hs-var">lookupTyConFieldLabel</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>        </span><span class="hs-comment">-- ** Constructing TyCons</span><span>
</span><a name="line-31"></a><span>        </span><a href="TyCon.html#mkAlgTyCon"><span class="hs-identifier hs-var">mkAlgTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="TyCon.html#mkClassTyCon"><span class="hs-identifier hs-var">mkClassTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="TyCon.html#mkFunTyCon"><span class="hs-identifier hs-var">mkFunTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="TyCon.html#mkPrimTyCon"><span class="hs-identifier hs-var">mkPrimTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="TyCon.html#mkKindTyCon"><span class="hs-identifier hs-var">mkKindTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="TyCon.html#mkLiftedPrimTyCon"><span class="hs-identifier hs-var">mkLiftedPrimTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="TyCon.html#mkTupleTyCon"><span class="hs-identifier hs-var">mkTupleTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="TyCon.html#mkSumTyCon"><span class="hs-identifier hs-var">mkSumTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="TyCon.html#mkDataTyConRhs"><span class="hs-identifier hs-var">mkDataTyConRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><a href="TyCon.html#mkSynonymTyCon"><span class="hs-identifier hs-var">mkSynonymTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><a href="TyCon.html#mkFamilyTyCon"><span class="hs-identifier hs-var">mkFamilyTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="TyCon.html#mkPromotedDataCon"><span class="hs-identifier hs-var">mkPromotedDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="TyCon.html#mkTcTyCon"><span class="hs-identifier hs-var">mkTcTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-comment">-- ** Predicates on TyCons</span><span>
</span><a name="line-46"></a><span>        </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isVanillaAlgTyCon"><span class="hs-identifier hs-var">isVanillaAlgTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>        </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isFamInstTyCon"><span class="hs-identifier hs-var">isFamInstTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="TyCon.html#isFunTyCon"><span class="hs-identifier hs-var">isFunTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>        </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isBoxedTupleTyCon"><span class="hs-identifier hs-var">isBoxedTupleTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>        </span><a href="TyCon.html#isUnboxedSumTyCon"><span class="hs-identifier hs-var">isUnboxedSumTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isPromotedTupleTyCon"><span class="hs-identifier hs-var">isPromotedTupleTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>        </span><a href="TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>        </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>        </span><a href="TyCon.html#isPromotedDataCon"><span class="hs-identifier hs-var">isPromotedDataCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isPromotedDataCon_maybe"><span class="hs-identifier hs-var">isPromotedDataCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>        </span><a href="TyCon.html#isKindTyCon"><span class="hs-identifier hs-var">isKindTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isLiftedTypeKindTyConName"><span class="hs-identifier hs-var">isLiftedTypeKindTyConName</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>        </span><a href="TyCon.html#isTauTyCon"><span class="hs-identifier hs-var">isTauTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><a href="TyCon.html#isDataTyCon"><span class="hs-identifier hs-var">isDataTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isProductTyCon"><span class="hs-identifier hs-var">isProductTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isDataProductTyCon_maybe"><span class="hs-identifier hs-var">isDataProductTyCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="TyCon.html#isDataSumTyCon_maybe"><span class="hs-identifier hs-var">isDataSumTyCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="TyCon.html#isEnumerationTyCon"><span class="hs-identifier hs-var">isEnumerationTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isAbstractTyCon"><span class="hs-identifier hs-var">isAbstractTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isOpenFamilyTyCon"><span class="hs-identifier hs-var">isOpenFamilyTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>        </span><a href="TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>        </span><a href="TyCon.html#isOpenTypeFamilyTyCon"><span class="hs-identifier hs-var">isOpenTypeFamilyTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isClosedSynFamilyTyConWithAxiom_maybe"><span class="hs-identifier hs-var">isClosedSynFamilyTyConWithAxiom_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>        </span><a href="TyCon.html#tyConInjectivityInfo"><span class="hs-identifier hs-var">tyConInjectivityInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>        </span><a href="TyCon.html#isBuiltInSynFamTyCon_maybe"><span class="hs-identifier hs-var">isBuiltInSynFamTyCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>        </span><a href="TyCon.html#isUnliftedTyCon"><span class="hs-identifier hs-var">isUnliftedTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>        </span><a href="TyCon.html#isGadtSyntaxTyCon"><span class="hs-identifier hs-var">isGadtSyntaxTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-var">isInjectiveTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isGenerativeTyCon"><span class="hs-identifier hs-var">isGenerativeTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isGenInjAlgRhs"><span class="hs-identifier hs-var">isGenInjAlgRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="TyCon.html#isTyConAssoc"><span class="hs-identifier hs-var">isTyConAssoc</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConAssoc_maybe"><span class="hs-identifier hs-var">tyConAssoc_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConFlavourAssoc_maybe"><span class="hs-identifier hs-var">tyConFlavourAssoc_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>        </span><a href="TyCon.html#isImplicitTyCon"><span class="hs-identifier hs-var">isImplicitTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>        </span><a href="TyCon.html#isTyConWithSrcDataCons"><span class="hs-identifier hs-var">isTyConWithSrcDataCons</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>        </span><a href="TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isTcLevPoly"><span class="hs-identifier hs-var">isTcLevPoly</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>        </span><span class="hs-comment">-- ** Extracting information out of TyCons</span><span>
</span><a name="line-75"></a><span>        </span><a href="TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><a href="TyCon.html#tyConSkolem"><span class="hs-identifier hs-var">tyConSkolem</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>        </span><a href="TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>        </span><a href="TyCon.html#tyConUnique"><span class="hs-identifier hs-var">tyConUnique</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>        </span><a href="TyCon.html#tyConTyVars"><span class="hs-identifier hs-var">tyConTyVars</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConVisibleTyVars"><span class="hs-identifier hs-var">tyConVisibleTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>        </span><a href="TyCon.html#tyConCType"><span class="hs-identifier hs-var">tyConCType</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConCType_maybe"><span class="hs-identifier hs-var">tyConCType_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>        </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConDataCons_maybe"><span class="hs-identifier hs-var">tyConDataCons_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>        </span><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleDataCon_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConSingleDataCon"><span class="hs-identifier hs-var">tyConSingleDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>        </span><a href="TyCon.html#tyConSingleAlgDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleAlgDataCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>        </span><a href="TyCon.html#tyConFamilySize"><span class="hs-identifier hs-var">tyConFamilySize</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>        </span><a href="TyCon.html#tyConStupidTheta"><span class="hs-identifier hs-var">tyConStupidTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>        </span><a href="TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>        </span><a href="TyCon.html#tyConRoles"><span class="hs-identifier hs-var">tyConRoles</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>        </span><a href="TyCon.html#tyConFlavour"><span class="hs-identifier hs-var">tyConFlavour</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>        </span><a href="TyCon.html#tyConTuple_maybe"><span class="hs-identifier hs-var">tyConTuple_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier hs-var">tyConClass_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConATs"><span class="hs-identifier hs-var">tyConATs</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>        </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConFamInstSig_maybe"><span class="hs-identifier hs-var">tyConFamInstSig_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConFamilyCoercion_maybe"><span class="hs-identifier hs-var">tyConFamilyCoercion_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>        </span><a href="TyCon.html#tyConFamilyResVar_maybe"><span class="hs-identifier hs-var">tyConFamilyResVar_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>        </span><a href="TyCon.html#synTyConDefn_maybe"><span class="hs-identifier hs-var">synTyConDefn_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#synTyConRhs_maybe"><span class="hs-identifier hs-var">synTyConRhs_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>        </span><a href="TyCon.html#famTyConFlav_maybe"><span class="hs-identifier hs-var">famTyConFlav_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#famTcResVar"><span class="hs-identifier hs-var">famTcResVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>        </span><a href="TyCon.html#algTyConRhs"><span class="hs-identifier hs-var">algTyConRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>        </span><a href="TyCon.html#newTyConRhs"><span class="hs-identifier hs-var">newTyConRhs</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#newTyConEtadArity"><span class="hs-identifier hs-var">newTyConEtadArity</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#newTyConEtadRhs"><span class="hs-identifier hs-var">newTyConEtadRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>        </span><a href="TyCon.html#unwrapNewTyCon_maybe"><span class="hs-identifier hs-var">unwrapNewTyCon_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#unwrapNewTyConEtad_maybe"><span class="hs-identifier hs-var">unwrapNewTyConEtad_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>        </span><a href="TyCon.html#newTyConDataCon_maybe"><span class="hs-identifier hs-var">newTyConDataCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>        </span><a href="TyCon.html#algTcFields"><span class="hs-identifier hs-var">algTcFields</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>        </span><a href="TyCon.html#tyConRuntimeRepInfo"><span class="hs-identifier hs-var">tyConRuntimeRepInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>        </span><a href="TyCon.html#tyConBinders"><span class="hs-identifier hs-var">tyConBinders</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConResKind"><span class="hs-identifier hs-var">tyConResKind</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConTyVarBinders"><span class="hs-identifier hs-var">tyConTyVarBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>        </span><a href="TyCon.html#tcTyConScopedTyVars"><span class="hs-identifier hs-var">tcTyConScopedTyVars</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tcTyConUserTyVars"><span class="hs-identifier hs-var">tcTyConUserTyVars</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tcTyConIsPoly"><span class="hs-identifier hs-var">tcTyConIsPoly</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>        </span><a href="TyCon.html#mkTyConTagMap"><span class="hs-identifier hs-var">mkTyConTagMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>        </span><span class="hs-comment">-- ** Manipulating TyCons</span><span>
</span><a name="line-105"></a><span>        </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-106"></a><span>        </span><a href="TyCon.html#makeRecoveryTyCon"><span class="hs-identifier hs-var">makeRecoveryTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>        </span><a href="TyCon.html#newTyConCo"><span class="hs-identifier hs-var">newTyConCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#newTyConCo_maybe"><span class="hs-identifier hs-var">newTyConCo_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-108"></a><span>        </span><a href="TyCon.html#pprPromotionQuote"><span class="hs-identifier hs-var">pprPromotionQuote</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>        </span><span class="hs-comment">-- ** Predicated on TyConFlavours</span><span>
</span><a name="line-111"></a><span>        </span><a href="TyCon.html#tcFlavourCanBeUnsaturated"><span class="hs-identifier hs-var">tcFlavourCanBeUnsaturated</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tcFlavourIsOpen"><span class="hs-identifier hs-var">tcFlavourIsOpen</span></a><span class="hs-special">,</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span>        </span><span class="hs-comment">-- * Runtime type representation</span><span>
</span><a name="line-114"></a><span>        </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#tyConRepName_maybe"><span class="hs-identifier hs-var">tyConRepName_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-115"></a><span>        </span><a href="TyCon.html#mkPrelTyConRepName"><span class="hs-identifier hs-var">mkPrelTyConRepName</span></a><span class="hs-special">,</span><span>
</span><a name="line-116"></a><span>        </span><a href="TyCon.html#tyConRepModOcc"><span class="hs-identifier hs-var">tyConRepModOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span>        </span><span class="hs-comment">-- * Primitive representations of Types</span><span>
</span><a name="line-119"></a><span>        </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCon.html#PrimElemRep"><span class="hs-identifier hs-type">PrimElemRep</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-120"></a><span>        </span><a href="TyCon.html#isVoidRep"><span class="hs-identifier hs-var">isVoidRep</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#isGcPtrRep"><span class="hs-identifier hs-var">isGcPtrRep</span></a><span class="hs-special">,</span><span>
</span><a name="line-121"></a><span>        </span><a href="TyCon.html#primRepSizeB"><span class="hs-identifier hs-var">primRepSizeB</span></a><span class="hs-special">,</span><span>
</span><a name="line-122"></a><span>        </span><a href="TyCon.html#primElemRepSizeB"><span class="hs-identifier hs-var">primElemRepSizeB</span></a><span class="hs-special">,</span><span>
</span><a name="line-123"></a><span>        </span><a href="TyCon.html#primRepIsFloat"><span class="hs-identifier hs-var">primRepIsFloat</span></a><span class="hs-special">,</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>        </span><span class="hs-comment">-- * Recursion breaking</span><span>
</span><a name="line-126"></a><span>        </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#initRecTc"><span class="hs-identifier hs-var">initRecTc</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#defaultRecTcMaxBound"><span class="hs-identifier hs-var">defaultRecTcMaxBound</span></a><span class="hs-special">,</span><span>
</span><a name="line-127"></a><span>        </span><a href="TyCon.html#setRecTcMaxBound"><span class="hs-identifier hs-var">setRecTcMaxBound</span></a><span class="hs-special">,</span><span> </span><a href="TyCon.html#checkRecTc"><span class="hs-identifier hs-var">checkRecTc</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#runtimeRepTyCon"><span class="hs-identifier hs-var">runtimeRepTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a><span>
</span><a name="line-137"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#vecCountTyCon"><span class="hs-identifier hs-var">vecCountTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#vecElemTyCon"><span class="hs-identifier hs-var">vecElemTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-138"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#mkFunKind"><span class="hs-identifier hs-var">mkFunKind</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#mkForAllKind"><span class="hs-identifier hs-var">mkForAllKind</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span>
</span><a name="line-140"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConFullSig"><span class="hs-identifier hs-var">dataConFullSig</span></a><span>
</span><a name="line-141"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="DataCon.html#isUnboxedSumCon"><span class="hs-identifier hs-var">isUnboxedSumCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-145"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-149"></a><span class="hs-keyword">import</span><span> </span><a href="ForeignCall.html"><span class="hs-identifier">ForeignCall</span></a><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-154"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-155"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-156"></a><span class="hs-keyword">import</span><span> </span><a href="FastStringEnv.html"><span class="hs-identifier">FastStringEnv</span></a><span>
</span><a name="line-157"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-158"></a><span class="hs-keyword">import</span><span> </span><a href="Constants.html"><span class="hs-identifier">Constants</span></a><span>
</span><a name="line-159"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-160"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span class="hs-special">(</span><span> </span><a href="Unique.html#tyConRepNameUnique"><span class="hs-identifier hs-var">tyConRepNameUnique</span></a><span class="hs-special">,</span><span> </span><a href="Unique.html#dataConTyRepNameUnique"><span class="hs-identifier hs-var">dataConTyRepNameUnique</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSet.html"><span class="hs-identifier">UniqSet</span></a><span>
</span><a name="line-162"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Data</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Data</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">{-
-----------------------------------------------
        Notes about type families
-----------------------------------------------

Note [Type synonym families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* Type synonym families, also known as &quot;type functions&quot;, map directly
  onto the type functions in FC:

        type family F a :: *
        type instance F Int = Bool
        ..etc...

* Reply &quot;yes&quot; to isTypeFamilyTyCon, and isFamilyTyCon

* From the user's point of view (F Int) and Bool are simply
  equivalent types.

* A Haskell 98 type synonym is a degenerate form of a type synonym
  family.

* Type functions can't appear in the LHS of a type function:
        type instance F (F Int) = ...   -- BAD!

* Translation of type family decl:
        type family F a :: *
  translates to
    a FamilyTyCon 'F', whose FamTyConFlav is OpenSynFamilyTyCon

        type family G a :: * where
          G Int = Bool
          G Bool = Char
          G a = ()
  translates to
    a FamilyTyCon 'G', whose FamTyConFlav is ClosedSynFamilyTyCon, with the
    appropriate CoAxiom representing the equations

We also support injective type families -- see Note [Injective type families]

Note [Data type families]
~~~~~~~~~~~~~~~~~~~~~~~~~
See also Note [Wrappers for data instance tycons] in MkId.hs

* Data type families are declared thus
        data family T a :: *
        data instance T Int = T1 | T2 Bool

  Here T is the &quot;family TyCon&quot;.

* Reply &quot;yes&quot; to isDataFamilyTyCon, and isFamilyTyCon

* The user does not see any &quot;equivalent types&quot; as he did with type
  synonym families.  He just sees constructors with types
        T1 :: T Int
        T2 :: Bool -&gt; T Int

* Here's the FC version of the above declarations:

        data T a
        data R:TInt = T1 | T2 Bool
        axiom ax_ti : T Int ~R R:TInt

  Note that this is a *representational* coercion
  The R:TInt is the &quot;representation TyCons&quot;.
  It has an AlgTyConFlav of
        DataFamInstTyCon T [Int] ax_ti

* The axiom ax_ti may be eta-reduced; see
  Note [Eta reduction for data families] in FamInstEnv

* Data family instances may have a different arity than the data family.
  See Note [Arity of data families] in FamInstEnv

* The data constructor T2 has a wrapper (which is what the
  source-level &quot;T2&quot; invokes):

        $WT2 :: Bool -&gt; T Int
        $WT2 b = T2 b `cast` sym ax_ti

* A data instance can declare a fully-fledged GADT:

        data instance T (a,b) where
          X1 :: T (Int,Bool)
          X2 :: a -&gt; b -&gt; T (a,b)

  Here's the FC version of the above declaration:

        data R:TPair a b where
          X1 :: R:TPair Int Bool
          X2 :: a -&gt; b -&gt; R:TPair a b
        axiom ax_pr :: T (a,b)  ~R  R:TPair a b

        $WX1 :: forall a b. a -&gt; b -&gt; T (a,b)
        $WX1 a b (x::a) (y::b) = X2 a b x y `cast` sym (ax_pr a b)

  The R:TPair are the &quot;representation TyCons&quot;.
  We have a bit of work to do, to unpick the result types of the
  data instance declaration for T (a,b), to get the result type in the
  representation; e.g.  T (a,b) --&gt; R:TPair a b

  The representation TyCon R:TList, has an AlgTyConFlav of

        DataFamInstTyCon T [(a,b)] ax_pr

* Notice that T is NOT translated to a FC type function; it just
  becomes a &quot;data type&quot; with no constructors, which can be coerced
  into R:TInt, R:TPair by the axioms.  These axioms
  axioms come into play when (and *only* when) you
        - use a data constructor
        - do pattern matching
  Rather like newtype, in fact

  As a result

  - T behaves just like a data type so far as decomposition is concerned

  - (T Int) is not implicitly converted to R:TInt during type inference.
    Indeed the latter type is unknown to the programmer.

  - There *is* an instance for (T Int) in the type-family instance
    environment, but it is only used for overlap checking

  - It's fine to have T in the LHS of a type function:
    type instance F (T a) = [a]

  It was this last point that confused me!  The big thing is that you
  should not think of a data family T as a *type function* at all, not
  even an injective one!  We can't allow even injective type functions
  on the LHS of a type function:
        type family injective G a :: *
        type instance F (G Int) = Bool
  is no good, even if G is injective, because consider
        type instance G Int = Bool
        type instance F Bool = Char

  So a data type family is not an injective type function. It's just a
  data type with some axioms that connect it to other data types.

* The tyConTyVars of the representation tycon are the tyvars that the
  user wrote in the patterns. This is important in TcDeriv, where we
  bring these tyvars into scope before type-checking the deriving
  clause. This fact is arranged for in TcInstDecls.tcDataFamInstDecl.

Note [Associated families and their parent class]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*Associated* families are just like *non-associated* families, except
that they have a famTcParent field of (Just cls_tc), which identifies the
parent class.

However there is an important sharing relationship between
  * the tyConTyVars of the parent Class
  * the tyConTyVars of the associated TyCon

   class C a b where
     data T p a
     type F a q b

Here the 'a' and 'b' are shared with the 'Class'; that is, they have
the same Unique.

This is important. In an instance declaration we expect
  * all the shared variables to be instantiated the same way
  * the non-shared variables of the associated type should not
    be instantiated at all

  instance C [x] (Tree y) where
     data T p [x] = T1 x | T2 p
     type F [x] q (Tree y) = (x,y,q)

Note [TyCon Role signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Every tycon has a role signature, assigning a role to each of the tyConTyVars
(or of equal length to the tyConArity, if there are no tyConTyVars). An
example demonstrates these best: say we have a tycon T, with parameters a at
nominal, b at representational, and c at phantom. Then, to prove
representational equality between T a1 b1 c1 and T a2 b2 c2, we need to have
nominal equality between a1 and a2, representational equality between b1 and
b2, and nothing in particular (i.e., phantom equality) between c1 and c2. This
might happen, say, with the following declaration:

  data T a b c where
    MkT :: b -&gt; T Int b c

Data and class tycons have their roles inferred (see inferRoles in TcTyDecls),
as do vanilla synonym tycons. Family tycons have all parameters at role N,
though it is conceivable that we could relax this restriction. (-&gt;)'s and
tuples' parameters are at role R. Each primitive tycon declares its roles;
it's worth noting that (~#)'s parameters are at role N. Promoted data
constructors' type arguments are at role R. All kind arguments are at role
N.

Note [Unboxed tuple RuntimeRep vars]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The contents of an unboxed tuple may have any representation. Accordingly,
the kind of the unboxed tuple constructor is runtime-representation
polymorphic. For example,

   (#,#) :: forall (q :: RuntimeRep) (r :: RuntimeRep). TYPE q -&gt; TYPE r -&gt; #

These extra tyvars (v and w) cause some delicate processing around tuples,
where we used to be able to assume that the tycon arity and the
datacon arity were the same.

Note [Injective type families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We allow injectivity annotations for type families (both open and closed):

  type family F (a :: k) (b :: k) = r | r -&gt; a
  type family G a b = res | res -&gt; a b where ...

Injectivity information is stored in the `famTcInj` field of `FamilyTyCon`.
`famTcInj` maybe stores a list of Bools, where each entry corresponds to a
single element of `tyConTyVars` (both lists should have identical length). If no
injectivity annotation was provided `famTcInj` is Nothing. From this follows an
invariant that if `famTcInj` is a Just then at least one element in the list
must be True.

See also:
 * [Injectivity annotation] in HsDecls
 * [Renaming injectivity annotation] in RnSource
 * [Verifying injectivity annotation] in FamInstEnv
 * [Type inference for type families with injectivity] in TcInteract

************************************************************************
*                                                                      *
                    TyConBinder, TyConTyCoBinder
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-keyword">type</span><span> </span><a name="TyConBinder"><a href="TyCon.html#TyConBinder"><span class="hs-identifier">TyConBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-comment">-- In the whole definition of @data TyCon@, only @PromotedDataCon@ will really</span><span>
</span><a name="line-400"></a><span class="hs-comment">-- contain CoVar.</span><span>
</span><a name="line-401"></a><span class="hs-keyword">type</span><span> </span><a name="TyConTyCoBinder"><a href="TyCon.html#TyConTyCoBinder"><span class="hs-identifier">TyConTyCoBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-keyword">data</span><span> </span><a name="TyConBndrVis"><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier">TyConBndrVis</span></a></a><span>
</span><a name="line-404"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NamedTCB"><a href="TyCon.html#NamedTCB"><span class="hs-identifier">NamedTCB</span></a></a><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span>
</span><a name="line-405"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AnonTCB"><a href="TyCon.html#AnonTCB"><span class="hs-identifier">AnonTCB</span></a></a><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-408"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719320"><a href="#local-6989586621681719320"><span class="hs-identifier">flag</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NamedTCB&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719320"><span class="hs-identifier hs-var">flag</span></a><span>
</span><a name="line-409"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;AnonTCB&quot;</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span class="hs-identifier">mkAnonTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span>
</span><a name="line-412"></a><a name="mkAnonTyConBinder"><a href="TyCon.html#mkAnonTyConBinder"><span class="hs-identifier">mkAnonTyConBinder</span></a></a><span> </span><a name="local-6989586621681719324"><a href="#local-6989586621681719324"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier hs-var">tv</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>                       </span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a href="#local-6989586621681719324"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-identifier">mkAnonTyConBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-416"></a><a name="mkAnonTyConBinders"><a href="TyCon.html#mkAnonTyConBinders"><span class="hs-identifier">mkAnonTyConBinders</span></a></a><span> </span><a name="local-6989586621681719325"><a href="#local-6989586621681719325"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="TyCon.html#mkAnonTyConBinder"><span class="hs-identifier hs-var">mkAnonTyConBinder</span></a><span> </span><a href="#local-6989586621681719325"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span class="hs-identifier">mkNamedTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- The odd argument order supports currying</span><span>
</span><a name="line-420"></a><a name="mkNamedTyConBinder"><a href="TyCon.html#mkNamedTyConBinder"><span class="hs-identifier">mkNamedTyConBinder</span></a></a><span> </span><a name="local-6989586621681719326"><a href="#local-6989586621681719326"><span class="hs-identifier">vis</span></a></a><span> </span><a name="local-6989586621681719327"><a href="#local-6989586621681719327"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier hs-var">tv</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>                            </span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a href="#local-6989586621681719327"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="#local-6989586621681719326"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span class="hs-identifier">mkNamedTyConBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- The odd argument order supports currying</span><span>
</span><a name="line-425"></a><a name="mkNamedTyConBinders"><a href="TyCon.html#mkNamedTyConBinders"><span class="hs-identifier">mkNamedTyConBinders</span></a></a><span> </span><a name="local-6989586621681719328"><a href="#local-6989586621681719328"><span class="hs-identifier">vis</span></a></a><span> </span><a name="local-6989586621681719329"><a href="#local-6989586621681719329"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#mkNamedTyConBinder"><span class="hs-identifier hs-var">mkNamedTyConBinder</span></a><span> </span><a href="#local-6989586621681719328"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719329"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-comment">-- | Make a Required TyConBinder. It chooses between NamedTCB and</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- AnonTCB based on whether the tv is mentioned in the dependent set</span><span>
</span><a name="line-429"></a><span class="hs-identifier">mkRequiredTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>  </span><span class="hs-comment">-- these are used dependently</span><span>
</span><a name="line-430"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-431"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span>
</span><a name="line-432"></a><a name="mkRequiredTyConBinder"><a href="TyCon.html#mkRequiredTyConBinder"><span class="hs-identifier">mkRequiredTyConBinder</span></a></a><span> </span><a name="local-6989586621681719330"><a href="#local-6989586621681719330"><span class="hs-identifier">dep_set</span></a></a><span> </span><a name="local-6989586621681719331"><a href="#local-6989586621681719331"><span class="hs-identifier">tv</span></a></a><span>
</span><a name="line-433"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681719331"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681719330"><span class="hs-identifier hs-var">dep_set</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkNamedTyConBinder"><span class="hs-identifier hs-var">mkNamedTyConBinder</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><a href="#local-6989586621681719331"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-434"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkAnonTyConBinder"><span class="hs-identifier hs-var">mkAnonTyConBinder</span></a><span> </span><a href="#local-6989586621681719331"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-identifier">tyConBinderArgFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span>
</span><a name="line-437"></a><a name="tyConBinderArgFlag"><a href="TyCon.html#tyConBinderArgFlag"><span class="hs-identifier">tyConBinderArgFlag</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719332"><a href="#local-6989586621681719332"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConBndrVisArgFlag"><span class="hs-identifier hs-var">tyConBndrVisArgFlag</span></a><span> </span><a href="#local-6989586621681719332"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-identifier">tyConBndrVisArgFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span>
</span><a name="line-440"></a><a name="tyConBndrVisArgFlag"><a href="TyCon.html#tyConBndrVisArgFlag"><span class="hs-identifier">tyConBndrVisArgFlag</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719333"><a href="#local-6989586621681719333"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719333"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-441"></a><span class="hs-identifier">tyConBndrVisArgFlag</span><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-identifier">isNamedTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-444"></a><span class="hs-comment">-- Identifies kind variables</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- E.g. data T k (a:k) = blah</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- Here 'k' is a NamedTCB, a variable used in the kind of other binders</span><span>
</span><a name="line-447"></a><a name="isNamedTyConBinder"><a href="TyCon.html#isNamedTyConBinder"><span class="hs-identifier">isNamedTyConBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-448"></a><span class="hs-identifier">isNamedTyConBinder</span><span> </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-identifier">isVisibleTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681719323"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- Works for IfaceTyConBinder too</span><span>
</span><a name="line-452"></a><a name="isVisibleTyConBinder"><a href="TyCon.html#isVisibleTyConBinder"><span class="hs-identifier">isVisibleTyConBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719334"><a href="#local-6989586621681719334"><span class="hs-identifier">tcb_vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isVisibleTcbVis"><span class="hs-identifier hs-var">isVisibleTcbVis</span></a><span> </span><a href="#local-6989586621681719334"><span class="hs-identifier hs-var">tcb_vis</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-identifier">isVisibleTcbVis</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-455"></a><a name="isVisibleTcbVis"><a href="TyCon.html#isVisibleTcbVis"><span class="hs-identifier">isVisibleTcbVis</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719335"><a href="#local-6989586621681719335"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier hs-var">isVisibleArgFlag</span></a><span> </span><a href="#local-6989586621681719335"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-456"></a><span class="hs-identifier">isVisibleTcbVis</span><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-identifier">isInvisibleTyConBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681719322"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- Works for IfaceTyConBinder too</span><span>
</span><a name="line-460"></a><a name="isInvisibleTyConBinder"><a href="TyCon.html#isInvisibleTyConBinder"><span class="hs-identifier">isInvisibleTyConBinder</span></a></a><span> </span><a name="local-6989586621681719336"><a href="#local-6989586621681719336"><span class="hs-identifier">tcb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isVisibleTyConBinder"><span class="hs-identifier hs-var">isVisibleTyConBinder</span></a><span> </span><a href="#local-6989586621681719336"><span class="hs-identifier hs-var">tcb</span></a><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-identifier">mkTyConKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-463"></a><a name="mkTyConKind"><a href="TyCon.html#mkTyConKind"><span class="hs-identifier">mkTyConKind</span></a></a><span> </span><a name="local-6989586621681719337"><a href="#local-6989586621681719337"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621681719338"><a href="#local-6989586621681719338"><span class="hs-identifier">res_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621681719339"><span class="hs-identifier hs-var">mk</span></a><span> </span><a href="#local-6989586621681719338"><span class="hs-identifier hs-var">res_kind</span></a><span> </span><a href="#local-6989586621681719337"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-464"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-465"></a><span>    </span><span class="hs-identifier">mk</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-466"></a><span>    </span><a name="local-6989586621681719339"><a href="#local-6989586621681719339"><span class="hs-identifier">mk</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719340"><a href="#local-6989586621681719340"><span class="hs-identifier">tv</span></a></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span class="hs-special">)</span><span>        </span><a name="local-6989586621681719341"><a href="#local-6989586621681719341"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkFunKind"><span class="hs-identifier hs-var">mkFunKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621681719340"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719341"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-467"></a><span>    </span><span class="hs-identifier">mk</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719342"><a href="#local-6989586621681719342"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719343"><a href="#local-6989586621681719343"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681719344"><a href="#local-6989586621681719344"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#mkForAllKind"><span class="hs-identifier hs-var">mkForAllKind</span></a><span> </span><a href="#local-6989586621681719342"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621681719343"><span class="hs-identifier hs-var">vis</span></a><span> </span><a href="#local-6989586621681719344"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-identifier">tyConTyVarBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- From the TyCon</span><span>
</span><a name="line-470"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Suitable for the foralls of a term function</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- See Note [Building TyVarBinders from TyConBinders]</span><span>
</span><a name="line-472"></a><a name="tyConTyVarBinders"><a href="TyCon.html#tyConTyVarBinders"><span class="hs-identifier">tyConTyVarBinders</span></a></a><span> </span><a name="local-6989586621681719345"><a href="#local-6989586621681719345"><span class="hs-identifier">tc_bndrs</span></a></a><span>
</span><a name="line-473"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621681719346"><span class="hs-identifier hs-var">mk_binder</span></a><span> </span><a href="#local-6989586621681719345"><span class="hs-identifier hs-var">tc_bndrs</span></a><span>
</span><a name="line-474"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-475"></a><span>   </span><a name="local-6989586621681719346"><a href="#local-6989586621681719346"><span class="hs-identifier">mk_binder</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719347"><a href="#local-6989586621681719347"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621681719348"><a href="#local-6989586621681719348"><span class="hs-identifier">tc_vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTyVarBinder"><span class="hs-identifier hs-var">mkTyVarBinder</span></a><span> </span><a href="#local-6989586621681719349"><span class="hs-identifier hs-var">vis</span></a><span> </span><a href="#local-6989586621681719347"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-476"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-477"></a><span>        </span><a name="local-6989586621681719349"><a href="#local-6989586621681719349"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719348"><span class="hs-identifier hs-var">tc_vis</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-478"></a><span>                </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span>
</span><a name="line-479"></a><span>                </span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span>
</span><a name="line-480"></a><span>                </span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719350"><a href="#local-6989586621681719350"><span class="hs-identifier">vis</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719350"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">-- Returns only tyvars, as covars are always inferred</span><span>
</span><a name="line-483"></a><span class="hs-identifier">tyConVisibleTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-484"></a><a name="tyConVisibleTyVars"><a href="TyCon.html#tyConVisibleTyVars"><span class="hs-identifier">tyConVisibleTyVars</span></a></a><span> </span><a name="local-6989586621681719351"><a href="#local-6989586621681719351"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-485"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621681719352"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719352"><a href="#local-6989586621681719352"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621681719353"><a href="#local-6989586621681719353"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">tyConBinders</span><span> </span><a href="#local-6989586621681719351"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-486"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isVisibleTcbVis"><span class="hs-identifier hs-var">isVisibleTcbVis</span></a><span> </span><a href="#local-6989586621681719353"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">{- Note [Building TyVarBinders from TyConBinders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We sometimes need to build the quantified type of a value from
the TyConBinders of a type or class.  For that we need not
TyConBinders but TyVarBinders (used in forall-type)  E.g:

 *  From   data T a = MkT (Maybe a)
    we are going to make a data constructor with type
           MkT :: forall a. Maybe a -&gt; T a
    See the TyCoVarBinders passed to buildDataCon

 * From    class C a where { op :: a -&gt; Maybe a }
   we are going to make a default method
           $dmop :: forall a. C a =&gt; a -&gt; Maybe a
   See the TyCoVarBinders passed to mkSigmaTy in mkDefaultMethodType

Both of these are user-callable.  (NB: default methods are not callable
directly by the user but rather via the code generated by 'deriving',
which uses visible type application; see mkDefMethBind.)

Since they are user-callable we must get their type-argument visibility
information right; and that info is in the TyConBinders.
Here is an example:

  data App a b = MkApp (a b) -- App :: forall {k}. (k-&gt;*) -&gt; k -&gt; *

The TyCon has

  tyConTyBinders = [ Named (Bndr (k :: *) Inferred), Anon (k-&gt;*), Anon k ]

The TyConBinders for App line up with App's kind, given above.

But the DataCon MkApp has the type
  MkApp :: forall {k} (a:k-&gt;*) (b:k). a b -&gt; App k a b

That is, its TyCoVarBinders should be

  dataConUnivTyVarBinders = [ Bndr (k:*)    Inferred
                            , Bndr (a:k-&gt;*) Specified
                            , Bndr (b:k)    Specified ]

So tyConTyVarBinders converts TyCon's TyConBinders into TyVarBinders:
  - variable names from the TyConBinders
  - but changing Anon/Required to Specified

The last part about Required-&gt;Specified comes from this:
  data T k (a:k) b = MkT (a b)
Here k is Required in T's kind, but we don't have Required binders in
the TyCoBinders for a term (see Note [No Required TyCoBinder in terms]
in TyCoRep), so we change it to Specified when making MkT's TyCoBinders
-}</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">{- Note [The binders/kind/arity fields of a TyCon]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All TyCons have this group of fields
  tyConBinders   :: [TyConBinder/TyConTyCoBinder]
  tyConResKind   :: Kind
  tyConTyVars    :: [TyVar]   -- Cached = binderVars tyConBinders
                              --   NB: Currently (Aug 2018), TyCons that own this
                              --   field really only contain TyVars. So it is
                              --   [TyVar] instead of [TyCoVar].
  tyConKind      :: Kind      -- Cached = mkTyConKind tyConBinders tyConResKind
  tyConArity     :: Arity     -- Cached = length tyConBinders

They fit together like so:

* tyConBinders gives the telescope of type/coercion variables on the LHS of the
  type declaration.  For example:

    type App a (b :: k) = a b

  tyConBinders = [ Bndr (k::*)   (NamedTCB Inferred)
                 , Bndr (a:k-&gt;*) AnonTCB
                 , Bndr (b:k)    AnonTCB ]

  Note that that are three binders here, including the
  kind variable k.

* See Note [VarBndrs, TyCoVarBinders, TyConBinders, and visibility] in TyCoRep
  for what the visibility flag means.

* Each TyConBinder tyConBinders has a TyVar (sometimes it is TyCoVar), and
  that TyVar may scope over some other part of the TyCon's definition. Eg
      type T a = a -&gt; a
  we have
      tyConBinders = [ Bndr (a:*) AnonTCB ]
      synTcRhs     = a -&gt; a
  So the 'a' scopes over the synTcRhs

* From the tyConBinders and tyConResKind we can get the tyConKind
  E.g for our App example:
      App :: forall k. (k-&gt;*) -&gt; k -&gt; *

  We get a 'forall' in the kind for each NamedTCB, and an arrow
  for each AnonTCB

  tyConKind is the full kind of the TyCon, not just the result kind

* For type families, tyConArity is the arguments this TyCon must be
  applied to, to be considered saturated.  Here we mean &quot;applied to in
  the actual Type&quot;, not surface syntax; i.e. including implicit kind
  variables.  So it's just (length tyConBinders)

* For an algebraic data type, or data instance, the tyConResKind is
  always (TYPE r); that is, the tyConBinders are enough to saturate
  the type constructor.  I'm not quite sure why we have this invariant,
  but it's enforced by etaExpandAlgTyCon
-}</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621681719315"><span class="hs-identifier hs-type">tv</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#VarBndr"><span class="hs-identifier hs-type">VarBndr</span></a><span> </span><a href="#local-6989586621681719315"><span class="hs-identifier hs-type">tv</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-599"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719316"><a href="#local-6989586621681719316"><span class="hs-identifier">v</span></a></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;anon&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719316"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-600"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719317"><a href="#local-6989586621681719317"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;req&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719317"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719318"><a href="#local-6989586621681719318"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;spec&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719318"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a><span> </span><a name="local-6989586621681719319"><a href="#local-6989586621681719319"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;inf&quot;</span><span>  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719319"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="TyCon.html#TyConBndrVis"><span class="hs-identifier hs-type">TyConBndrVis</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-605"></a><span>  </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621681719309"><a href="#local-6989586621681719309"><span class="hs-identifier">bh</span></a></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681719309"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-606"></a><span>  </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621681719310"><a href="#local-6989586621681719310"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621681719311"><a href="#local-6989586621681719311"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681719310"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621681719310"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621681719311"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span>  </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621681719312"><a href="#local-6989586621681719312"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681719313"><a href="#local-6989586621681719313"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-6989586621681719312"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-609"></a><span>              </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719313"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-610"></a><span>                  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span>
</span><a name="line-611"></a><span>                  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681719314"><a href="#local-6989586621681719314"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621681719312"><span class="hs-identifier hs-var">bh</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="#local-6989586621681719314"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
               The TyCon type
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-comment">-- | TyCons represent type constructors. Type constructors are introduced by</span><span>
</span><a name="line-623"></a><span class="hs-comment">-- things such as:</span><span>
</span><a name="line-624"></a><span class="hs-comment">--</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- 1) Data declarations: @data Foo = ...@ creates the @Foo@ type constructor of</span><span>
</span><a name="line-626"></a><span class="hs-comment">--    kind @*@</span><span>
</span><a name="line-627"></a><span class="hs-comment">--</span><span>
</span><a name="line-628"></a><span class="hs-comment">-- 2) Type synonyms: @type Foo = ...@ creates the @Foo@ type constructor</span><span>
</span><a name="line-629"></a><span class="hs-comment">--</span><span>
</span><a name="line-630"></a><span class="hs-comment">-- 3) Newtypes: @newtype Foo a = MkFoo ...@ creates the @Foo@ type constructor</span><span>
</span><a name="line-631"></a><span class="hs-comment">--    of kind @* -&gt; *@</span><span>
</span><a name="line-632"></a><span class="hs-comment">--</span><span>
</span><a name="line-633"></a><span class="hs-comment">-- 4) Class declarations: @class Foo where@ creates the @Foo@ type constructor</span><span>
</span><a name="line-634"></a><span class="hs-comment">--    of kind @*@</span><span>
</span><a name="line-635"></a><span class="hs-comment">--</span><span>
</span><a name="line-636"></a><span class="hs-comment">-- This data type also encodes a number of primitive, built in type constructors</span><span>
</span><a name="line-637"></a><span class="hs-comment">-- such as those for function and tuple types.</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-comment">-- If you edit this type, you may need to update the GHC formalism</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- See Note [GHC Formalism] in coreSyn/CoreLint.hs</span><span>
</span><a name="line-641"></a><span class="hs-keyword">data</span><span> </span><a name="TyCon"><a href="TyCon.html#TyCon"><span class="hs-identifier">TyCon</span></a></a><span>
</span><a name="line-642"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | The function type constructor, @(-&gt;)@</span><span>
</span><a name="line-643"></a><span>    </span><a name="FunTyCon"><a href="TyCon.html#FunTyCon"><span class="hs-identifier">FunTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-644"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ A Unique of this TyCon. Invariant:</span><span>
</span><a name="line-645"></a><span>                                 </span><span class="hs-comment">-- identical to Unique of Name stored in</span><span>
</span><a name="line-646"></a><span>                                 </span><span class="hs-comment">-- tyConName field.</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ Name of the constructor</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-651"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-652"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-653"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-654"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span>        </span><a name="tcRepName"><a href="TyCon.html#tcRepName"><span class="hs-identifier">tcRepName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-657"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span>  </span><span class="hs-comment">-- | Algebraic data types, from</span><span>
</span><a name="line-660"></a><span>  </span><span class="hs-comment">--     - @data@ declarations</span><span>
</span><a name="line-661"></a><span>  </span><span class="hs-comment">--     - @newtype@ declarations</span><span>
</span><a name="line-662"></a><span>  </span><span class="hs-comment">--     - data instance declarations</span><span>
</span><a name="line-663"></a><span>  </span><span class="hs-comment">--     - type instance declarations</span><span>
</span><a name="line-664"></a><span>  </span><span class="hs-comment">--     - the TyCon generated by a class declaration</span><span>
</span><a name="line-665"></a><span>  </span><span class="hs-comment">--     - boxed tuples</span><span>
</span><a name="line-666"></a><span>  </span><span class="hs-comment">--     - unboxed tuples</span><span>
</span><a name="line-667"></a><span>  </span><span class="hs-comment">--     - constraint tuples</span><span>
</span><a name="line-668"></a><span>  </span><span class="hs-comment">-- All these constructors are lifted and boxed except unboxed tuples</span><span>
</span><a name="line-669"></a><span>  </span><span class="hs-comment">-- which should have an 'UnboxedAlgTyCon' parent.</span><span>
</span><a name="line-670"></a><span>  </span><span class="hs-comment">-- Data/newtype/type /families/ are handled by 'FamilyTyCon'.</span><span>
</span><a name="line-671"></a><span>  </span><span class="hs-comment">-- See 'AlgTyConRhs' for more information.</span><span>
</span><a name="line-672"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AlgTyCon"><a href="TyCon.html#AlgTyCon"><span class="hs-identifier">AlgTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-673"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ A Unique of this TyCon. Invariant:</span><span>
</span><a name="line-674"></a><span>                                 </span><span class="hs-comment">-- identical to Unique of Name stored in</span><span>
</span><a name="line-675"></a><span>                                 </span><span class="hs-comment">-- tyConName field.</span><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Name of the constructor</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-680"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-681"></a><span>        </span><a name="tyConTyVars"><a href="TyCon.html#tyConTyVars"><span class="hs-identifier">tyConTyVars</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ TyVar binders</span><span>
</span><a name="line-682"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-683"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-684"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span>              </span><span class="hs-comment">-- The tyConTyVars scope over:</span><span>
</span><a name="line-687"></a><span>              </span><span class="hs-comment">--</span><span>
</span><a name="line-688"></a><span>              </span><span class="hs-comment">-- 1. The 'algTcStupidTheta'</span><span>
</span><a name="line-689"></a><span>              </span><span class="hs-comment">-- 2. The cached types in algTyConRhs.NewTyCon</span><span>
</span><a name="line-690"></a><span>              </span><span class="hs-comment">-- 3. The family instance types if present</span><span>
</span><a name="line-691"></a><span>              </span><span class="hs-comment">--</span><span>
</span><a name="line-692"></a><span>              </span><span class="hs-comment">-- Note that it does /not/ scope over the data</span><span>
</span><a name="line-693"></a><span>              </span><span class="hs-comment">-- constructors.</span><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span>        </span><a name="tcRoles"><a href="TyCon.html#tcRoles"><span class="hs-identifier">tcRoles</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ The role for each type variable</span><span>
</span><a name="line-696"></a><span>                                 </span><span class="hs-comment">-- This list has length = tyConArity</span><span>
</span><a name="line-697"></a><span>                                 </span><span class="hs-comment">-- See also Note [TyCon Role signatures]</span><span>
</span><a name="line-698"></a><span>
</span><a name="line-699"></a><span>        </span><a name="tyConCType"><a href="TyCon.html#tyConCType"><span class="hs-identifier">tyConCType</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span class="hs-special">,</span><span class="hs-comment">-- ^ The C type that should be used</span><span>
</span><a name="line-700"></a><span>                                    </span><span class="hs-comment">-- for this type when using the FFI</span><span>
</span><a name="line-701"></a><span>                                    </span><span class="hs-comment">-- and CAPI</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span>        </span><a name="algTcGadtSyntax"><a href="TyCon.html#algTcGadtSyntax"><span class="hs-identifier">algTcGadtSyntax</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Was the data type declared with GADT</span><span>
</span><a name="line-704"></a><span>                                    </span><span class="hs-comment">-- syntax?  If so, that doesn't mean it's a</span><span>
</span><a name="line-705"></a><span>                                    </span><span class="hs-comment">-- true GADT; only that the &quot;where&quot; form</span><span>
</span><a name="line-706"></a><span>                                    </span><span class="hs-comment">-- was used.  This field is used only to</span><span>
</span><a name="line-707"></a><span>                                    </span><span class="hs-comment">-- guide pretty-printing</span><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span>        </span><a name="algTcStupidTheta"><a href="TyCon.html#algTcStupidTheta"><span class="hs-identifier">algTcStupidTheta</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The \&quot;stupid theta\&quot; for the data</span><span>
</span><a name="line-710"></a><span>                                        </span><span class="hs-comment">-- type (always empty for GADTs).  A</span><span>
</span><a name="line-711"></a><span>                                        </span><span class="hs-comment">-- \&quot;stupid theta\&quot; is the context to</span><span>
</span><a name="line-712"></a><span>                                        </span><span class="hs-comment">-- the left of an algebraic type</span><span>
</span><a name="line-713"></a><span>                                        </span><span class="hs-comment">-- declaration, e.g. @Eq a@ in the</span><span>
</span><a name="line-714"></a><span>                                        </span><span class="hs-comment">-- declaration @data Eq a =&gt; T a ...@.</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span>        </span><a name="algTcRhs"><a href="TyCon.html#algTcRhs"><span class="hs-identifier">algTcRhs</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Contains information about the</span><span>
</span><a name="line-717"></a><span>                                    </span><span class="hs-comment">-- data constructors of the algebraic type</span><span>
</span><a name="line-718"></a><span>
</span><a name="line-719"></a><span>        </span><a name="algTcFields"><a href="TyCon.html#algTcFields"><span class="hs-identifier">algTcFields</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FieldLabel.html#FieldLabelEnv"><span class="hs-identifier hs-type">FieldLabelEnv</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Maps a label to information</span><span>
</span><a name="line-720"></a><span>                                      </span><span class="hs-comment">-- about the field</span><span>
</span><a name="line-721"></a><span>
</span><a name="line-722"></a><span>        </span><a name="algTcParent"><a href="TyCon.html#algTcParent"><span class="hs-identifier">algTcParent</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span> </span><span class="hs-comment">-- ^ Gives the class or family declaration</span><span>
</span><a name="line-723"></a><span>                                       </span><span class="hs-comment">-- 'TyCon' for derived 'TyCon's representing</span><span>
</span><a name="line-724"></a><span>                                       </span><span class="hs-comment">-- class or family instances, respectively.</span><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span>  </span><span class="hs-comment">-- | Represents type synonyms</span><span>
</span><a name="line-729"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SynonymTyCon"><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier">SynonymTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-730"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ A Unique of this TyCon. Invariant:</span><span>
</span><a name="line-731"></a><span>                                 </span><span class="hs-comment">-- identical to Unique of Name stored in</span><span>
</span><a name="line-732"></a><span>                                 </span><span class="hs-comment">-- tyConName field.</span><span>
</span><a name="line-733"></a><span>
</span><a name="line-734"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Name of the constructor</span><span>
</span><a name="line-735"></a><span>
</span><a name="line-736"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-737"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-738"></a><span>        </span><a name="tyConTyVars"><a href="TyCon.html#tyConTyVars"><span class="hs-identifier">tyConTyVars</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ TyVar binders</span><span>
</span><a name="line-739"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-740"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-741"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-742"></a><span>             </span><span class="hs-comment">-- tyConTyVars scope over: synTcRhs</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span>        </span><a name="tcRoles"><a href="TyCon.html#tcRoles"><span class="hs-identifier">tcRoles</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ The role for each type variable</span><span>
</span><a name="line-745"></a><span>                                 </span><span class="hs-comment">-- This list has length = tyConArity</span><span>
</span><a name="line-746"></a><span>                                 </span><span class="hs-comment">-- See also Note [TyCon Role signatures]</span><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span>        </span><a name="synTcRhs"><a href="TyCon.html#synTcRhs"><span class="hs-identifier">synTcRhs</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Contains information about the expansion</span><span>
</span><a name="line-749"></a><span>                                 </span><span class="hs-comment">-- of the synonym</span><span>
</span><a name="line-750"></a><span>
</span><a name="line-751"></a><span>        </span><a name="synIsTau"><a href="TyCon.html#synIsTau"><span class="hs-identifier">synIsTau</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- True &lt;=&gt; the RHS of this synonym does not</span><span>
</span><a name="line-752"></a><span>                                 </span><span class="hs-comment">--          have any foralls, after expanding any</span><span>
</span><a name="line-753"></a><span>                                 </span><span class="hs-comment">--          nested synonyms</span><span>
</span><a name="line-754"></a><span>        </span><a name="synIsFamFree"><a href="TyCon.html#synIsFamFree"><span class="hs-identifier">synIsFamFree</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- True &lt;=&gt; the RHS of this synonym does not mention</span><span>
</span><a name="line-755"></a><span>                                 </span><span class="hs-comment">--          any type synonym families (data families</span><span>
</span><a name="line-756"></a><span>                                 </span><span class="hs-comment">--          are fine), again after expanding any</span><span>
</span><a name="line-757"></a><span>                                 </span><span class="hs-comment">--          nested synonyms</span><span>
</span><a name="line-758"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span>  </span><span class="hs-comment">-- | Represents families (both type and data)</span><span>
</span><a name="line-761"></a><span>  </span><span class="hs-comment">-- Argument roles are all Nominal</span><span>
</span><a name="line-762"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FamilyTyCon"><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier">FamilyTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-763"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ A Unique of this TyCon. Invariant:</span><span>
</span><a name="line-764"></a><span>                                 </span><span class="hs-comment">-- identical to Unique of Name stored in</span><span>
</span><a name="line-765"></a><span>                                 </span><span class="hs-comment">-- tyConName field.</span><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Name of the constructor</span><span>
</span><a name="line-768"></a><span>
</span><a name="line-769"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-770"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-771"></a><span>        </span><a name="tyConTyVars"><a href="TyCon.html#tyConTyVars"><span class="hs-identifier">tyConTyVars</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ TyVar binders</span><span>
</span><a name="line-772"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-773"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-774"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-775"></a><span>            </span><span class="hs-comment">-- tyConTyVars connect an associated family TyCon</span><span>
</span><a name="line-776"></a><span>            </span><span class="hs-comment">-- with its parent class; see TcValidity.checkConsistentFamInst</span><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span>        </span><a name="famTcResVar"><a href="TyCon.html#famTcResVar"><span class="hs-identifier">famTcResVar</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Name of result type variable, used</span><span>
</span><a name="line-779"></a><span>                                      </span><span class="hs-comment">-- for pretty-printing with --show-iface</span><span>
</span><a name="line-780"></a><span>                                      </span><span class="hs-comment">-- and for reifying TyCon in Template</span><span>
</span><a name="line-781"></a><span>                                      </span><span class="hs-comment">-- Haskell</span><span>
</span><a name="line-782"></a><span>
</span><a name="line-783"></a><span>        </span><a name="famTcFlav"><a href="TyCon.html#famTcFlav"><span class="hs-identifier">famTcFlav</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Type family flavour: open, closed,</span><span>
</span><a name="line-784"></a><span>                                      </span><span class="hs-comment">-- abstract, built-in. See comments for</span><span>
</span><a name="line-785"></a><span>                                      </span><span class="hs-comment">-- FamTyConFlav</span><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span>        </span><a name="famTcParent"><a href="TyCon.html#famTcParent"><span class="hs-identifier">famTcParent</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- ^ For *associated* type/data families</span><span>
</span><a name="line-788"></a><span>                                      </span><span class="hs-comment">-- The class tycon in which the family is declared</span><span>
</span><a name="line-789"></a><span>                                      </span><span class="hs-comment">-- See Note [Associated families and their parent class]</span><span>
</span><a name="line-790"></a><span>
</span><a name="line-791"></a><span>        </span><a name="famTcInj"><a href="TyCon.html#famTcInj"><span class="hs-identifier">famTcInj</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a><span>   </span><span class="hs-comment">-- ^ is this a type family injective in</span><span>
</span><a name="line-792"></a><span>                                      </span><span class="hs-comment">-- its type variables? Nothing if no</span><span>
</span><a name="line-793"></a><span>                                      </span><span class="hs-comment">-- injectivity annotation was given</span><span>
</span><a name="line-794"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-795"></a><span>
</span><a name="line-796"></a><span>  </span><span class="hs-comment">-- | Primitive types; cannot be defined in Haskell. This includes</span><span>
</span><a name="line-797"></a><span>  </span><span class="hs-comment">-- the usual suspects (such as @Int#@) as well as foreign-imported</span><span>
</span><a name="line-798"></a><span>  </span><span class="hs-comment">-- types and kinds (@*@, @#@, and @?@)</span><span>
</span><a name="line-799"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PrimTyCon"><a href="TyCon.html#PrimTyCon"><span class="hs-identifier">PrimTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-800"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ A Unique of this TyCon. Invariant:</span><span>
</span><a name="line-801"></a><span>                                 </span><span class="hs-comment">-- identical to Unique of Name stored in</span><span>
</span><a name="line-802"></a><span>                                 </span><span class="hs-comment">-- tyConName field.</span><span>
</span><a name="line-803"></a><span>
</span><a name="line-804"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Name of the constructor</span><span>
</span><a name="line-805"></a><span>
</span><a name="line-806"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-807"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-808"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-809"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-810"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><span>        </span><a name="tcRoles"><a href="TyCon.html#tcRoles"><span class="hs-identifier">tcRoles</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The role for each type variable</span><span>
</span><a name="line-813"></a><span>                                 </span><span class="hs-comment">-- This list has length = tyConArity</span><span>
</span><a name="line-814"></a><span>                                 </span><span class="hs-comment">-- See also Note [TyCon Role signatures]</span><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span>        </span><a name="isUnlifted"><a href="TyCon.html#isUnlifted"><span class="hs-identifier">isUnlifted</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Most primitive tycons are unlifted (may</span><span>
</span><a name="line-817"></a><span>                                 </span><span class="hs-comment">-- not contain bottom) but other are lifted,</span><span>
</span><a name="line-818"></a><span>                                 </span><span class="hs-comment">-- e.g. @RealWorld@</span><span>
</span><a name="line-819"></a><span>                                 </span><span class="hs-comment">-- Only relevant if tyConKind = *</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span>        </span><a name="primRepName"><a href="TyCon.html#primRepName"><span class="hs-identifier">primRepName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>   </span><span class="hs-comment">-- Only relevant for kind TyCons</span><span>
</span><a name="line-822"></a><span>                                            </span><span class="hs-comment">-- i.e, *, #, ?</span><span>
</span><a name="line-823"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-824"></a><span>
</span><a name="line-825"></a><span>  </span><span class="hs-comment">-- | Represents promoted data constructor.</span><span>
</span><a name="line-826"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PromotedDataCon"><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier">PromotedDataCon</span></a></a><span> </span><span class="hs-special">{</span><span>          </span><span class="hs-comment">-- See Note [Promoted data constructors]</span><span>
</span><a name="line-827"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- ^ Same Unique as the data constructor</span><span>
</span><a name="line-828"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- ^ Same Name as the data constructor</span><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-831"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConTyCoBinder"><span class="hs-identifier hs-type">TyConTyCoBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-832"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-833"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-834"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-835"></a><span>
</span><a name="line-836"></a><span>        </span><a name="tcRoles"><a href="TyCon.html#tcRoles"><span class="hs-identifier">tcRoles</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Roles: N for kind vars, R for type vars</span><span>
</span><a name="line-837"></a><span>        </span><a name="dataCon"><a href="TyCon.html#dataCon"><span class="hs-identifier">dataCon</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ Corresponding data constructor</span><span>
</span><a name="line-838"></a><span>        </span><a name="tcRepName"><a href="TyCon.html#tcRepName"><span class="hs-identifier">tcRepName</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span class="hs-special">,</span><span>
</span><a name="line-839"></a><span>        </span><a name="promDcRepInfo"><a href="TyCon.html#promDcRepInfo"><span class="hs-identifier">promDcRepInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier hs-type">RuntimeRepInfo</span></a><span>  </span><span class="hs-comment">-- ^ See comments with 'RuntimeRepInfo'</span><span>
</span><a name="line-840"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-841"></a><span>
</span><a name="line-842"></a><span>  </span><span class="hs-comment">-- | These exist only during type-checking. See Note [How TcTyCons work]</span><span>
</span><a name="line-843"></a><span>  </span><span class="hs-comment">-- in TcTyClsDecls</span><span>
</span><a name="line-844"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TcTyCon"><a href="TyCon.html#TcTyCon"><span class="hs-identifier">TcTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-845"></a><span>        </span><a name="tyConUnique"><a href="TyCon.html#tyConUnique"><span class="hs-identifier">tyConUnique</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>
</span><a name="line-846"></a><span>        </span><a name="tyConName"><a href="TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>
</span><a name="line-847"></a><span>
</span><a name="line-848"></a><span>        </span><span class="hs-comment">-- See Note [The binders/kind/arity fields of a TyCon]</span><span>
</span><a name="line-849"></a><span>        </span><a name="tyConBinders"><a href="TyCon.html#tyConBinders"><span class="hs-identifier">tyConBinders</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Full binders</span><span>
</span><a name="line-850"></a><span>        </span><a name="tyConTyVars"><a href="TyCon.html#tyConTyVars"><span class="hs-identifier">tyConTyVars</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ TyVar binders</span><span>
</span><a name="line-851"></a><span>        </span><a name="tyConResKind"><a href="TyCon.html#tyConResKind"><span class="hs-identifier">tyConResKind</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-852"></a><span>        </span><a name="tyConKind"><a href="TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>             </span><span class="hs-comment">-- ^ Kind of this TyCon</span><span>
</span><a name="line-853"></a><span>        </span><a name="tyConArity"><a href="TyCon.html#tyConArity"><span class="hs-identifier">tyConArity</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- ^ Arity</span><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span>        </span><a name="tcTyConScopedTyVars"><a href="TyCon.html#tcTyConScopedTyVars"><span class="hs-identifier">tcTyConScopedTyVars</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-856"></a><span>                           </span><span class="hs-comment">-- ^ Scoped tyvars over the tycon's body</span><span>
</span><a name="line-857"></a><span>                           </span><span class="hs-comment">-- See Note [How TcTyCons work] in TcTyClsDecls</span><span>
</span><a name="line-858"></a><span>                           </span><span class="hs-comment">-- Order *does* matter: for TcTyCons with a CUSK,</span><span>
</span><a name="line-859"></a><span>                           </span><span class="hs-comment">-- it's the correct dependency order. For TcTyCons</span><span>
</span><a name="line-860"></a><span>                           </span><span class="hs-comment">-- without a CUSK, it's the original left-to-right</span><span>
</span><a name="line-861"></a><span>                           </span><span class="hs-comment">-- that the user wrote. Nec'y for getting Specified</span><span>
</span><a name="line-862"></a><span>                           </span><span class="hs-comment">-- variables in the right order.</span><span>
</span><a name="line-863"></a><span>        </span><a name="tcTyConUserTyVars"><a href="TyCon.html#tcTyConUserTyVars"><span class="hs-identifier">tcTyConUserTyVars</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Original, user-written tycon tyvars</span><span>
</span><a name="line-864"></a><span>        </span><a name="tcTyConIsPoly"><a href="TyCon.html#tcTyConIsPoly"><span class="hs-identifier">tcTyConIsPoly</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Is this TcTyCon already generalized?</span><span>
</span><a name="line-865"></a><span>
</span><a name="line-866"></a><span>        </span><a name="tcTyConFlavour"><a href="TyCon.html#tcTyConFlavour"><span class="hs-identifier">tcTyConFlavour</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span>
</span><a name="line-867"></a><span>                           </span><span class="hs-comment">-- ^ What sort of 'TyCon' this represents.</span><span>
</span><a name="line-868"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-869"></a><span>
</span><a name="line-870"></a><span class="hs-comment">-- | Represents right-hand-sides of 'TyCon's for algebraic types</span><span>
</span><a name="line-871"></a><span class="hs-keyword">data</span><span> </span><a name="AlgTyConRhs"><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier">AlgTyConRhs</span></a></a><span>
</span><a name="line-872"></a><span>
</span><a name="line-873"></a><span>    </span><span class="hs-comment">-- | Says that we know nothing about this data type, except that</span><span>
</span><a name="line-874"></a><span>    </span><span class="hs-comment">-- it's represented by a pointer.  Used when we export a data type</span><span>
</span><a name="line-875"></a><span>    </span><span class="hs-comment">-- abstractly into an .hi file.</span><span>
</span><a name="line-876"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="AbstractTyCon"><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier">AbstractTyCon</span></a></a><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span>    </span><span class="hs-comment">-- | Information about those 'TyCon's derived from a @data@</span><span>
</span><a name="line-879"></a><span>    </span><span class="hs-comment">-- declaration. This includes data types with no constructors at</span><span>
</span><a name="line-880"></a><span>    </span><span class="hs-comment">-- all.</span><span>
</span><a name="line-881"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DataTyCon"><a href="TyCon.html#DataTyCon"><span class="hs-identifier">DataTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-882"></a><span>        </span><a name="data_cons"><a href="TyCon.html#data_cons"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-883"></a><span>                          </span><span class="hs-comment">-- ^ The data type constructors; can be empty if the</span><span>
</span><a name="line-884"></a><span>                          </span><span class="hs-comment">--   user declares the type to have no constructors</span><span>
</span><a name="line-885"></a><span>                          </span><span class="hs-comment">--</span><span>
</span><a name="line-886"></a><span>                          </span><span class="hs-comment">-- INVARIANT: Kept in order of increasing 'DataCon'</span><span>
</span><a name="line-887"></a><span>                          </span><span class="hs-comment">-- tag (see the tag assignment in mkTyConTagMap)</span><span>
</span><a name="line-888"></a><span>        </span><a name="data_cons_size"><a href="TyCon.html#data_cons_size"><span class="hs-identifier">data_cons_size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-889"></a><span>                          </span><span class="hs-comment">-- ^ Cached value: length data_cons</span><span>
</span><a name="line-890"></a><span>        </span><a name="is_enum"><a href="TyCon.html#is_enum"><span class="hs-identifier">is_enum</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>   </span><span class="hs-comment">-- ^ Cached value: is this an enumeration type?</span><span>
</span><a name="line-891"></a><span>                          </span><span class="hs-comment">--   See Note [Enumeration types]</span><span>
</span><a name="line-892"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TupleTyCon"><a href="TyCon.html#TupleTyCon"><span class="hs-identifier">TupleTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>                   </span><span class="hs-comment">-- A boxed, unboxed, or constraint tuple</span><span>
</span><a name="line-895"></a><span>        </span><a name="data_con"><a href="TyCon.html#data_con"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- NB: it can be an *unboxed* tuple</span><span>
</span><a name="line-896"></a><span>        </span><a name="tup_sort"><a href="TyCon.html#tup_sort"><span class="hs-identifier">tup_sort</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a><span>      </span><span class="hs-comment">-- ^ Is this a boxed, unboxed or constraint</span><span>
</span><a name="line-897"></a><span>                                   </span><span class="hs-comment">-- tuple?</span><span>
</span><a name="line-898"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span>  </span><span class="hs-comment">-- | An unboxed sum type.</span><span>
</span><a name="line-901"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SumTyCon"><a href="TyCon.html#SumTyCon"><span class="hs-identifier">SumTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-902"></a><span>        </span><a name="data_cons"><a href="TyCon.html#data_cons"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-903"></a><span>        </span><a name="data_cons_size"><a href="TyCon.html#data_cons_size"><span class="hs-identifier">data_cons_size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>  </span><span class="hs-comment">-- ^ Cached value: length data_cons</span><span>
</span><a name="line-904"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-905"></a><span>
</span><a name="line-906"></a><span>  </span><span class="hs-comment">-- | Information about those 'TyCon's derived from a @newtype@ declaration</span><span>
</span><a name="line-907"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NewTyCon"><a href="TyCon.html#NewTyCon"><span class="hs-identifier">NewTyCon</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-908"></a><span>        </span><a name="data_con"><a href="TyCon.html#data_con"><span class="hs-identifier">data_con</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ The unique constructor for the @newtype@.</span><span>
</span><a name="line-909"></a><span>                                </span><span class="hs-comment">--   It has no existentials</span><span>
</span><a name="line-910"></a><span>
</span><a name="line-911"></a><span>        </span><a name="nt_rhs"><a href="TyCon.html#nt_rhs"><span class="hs-identifier">nt_rhs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- ^ Cached value: the argument type of the</span><span>
</span><a name="line-912"></a><span>                                </span><span class="hs-comment">-- constructor, which is just the representation</span><span>
</span><a name="line-913"></a><span>                                </span><span class="hs-comment">-- type of the 'TyCon' (remember that @newtype@s</span><span>
</span><a name="line-914"></a><span>                                </span><span class="hs-comment">-- do not exist at runtime so need a different</span><span>
</span><a name="line-915"></a><span>                                </span><span class="hs-comment">-- representation type).</span><span>
</span><a name="line-916"></a><span>                                </span><span class="hs-comment">--</span><span>
</span><a name="line-917"></a><span>                                </span><span class="hs-comment">-- The free 'TyVar's of this type are the</span><span>
</span><a name="line-918"></a><span>                                </span><span class="hs-comment">-- 'tyConTyVars' from the corresponding 'TyCon'</span><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>        </span><a name="nt_etad_rhs"><a href="TyCon.html#nt_etad_rhs"><span class="hs-identifier">nt_etad_rhs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-921"></a><span>                        </span><span class="hs-comment">-- ^ Same as the 'nt_rhs', but this time eta-reduced.</span><span>
</span><a name="line-922"></a><span>                        </span><span class="hs-comment">-- Hence the list of 'TyVar's in this field may be</span><span>
</span><a name="line-923"></a><span>                        </span><span class="hs-comment">-- shorter than the declared arity of the 'TyCon'.</span><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span>                        </span><span class="hs-comment">-- See Note [Newtype eta]</span><span>
</span><a name="line-926"></a><span>        </span><a name="nt_co"><a href="TyCon.html#nt_co"><span class="hs-identifier">nt_co</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span>
</span><a name="line-927"></a><span>                             </span><span class="hs-comment">-- The axiom coercion that creates the @newtype@</span><span>
</span><a name="line-928"></a><span>                             </span><span class="hs-comment">-- from the representation 'Type'.</span><span>
</span><a name="line-929"></a><span>
</span><a name="line-930"></a><span>                             </span><span class="hs-comment">-- See Note [Newtype coercions]</span><span>
</span><a name="line-931"></a><span>                             </span><span class="hs-comment">-- Invariant: arity = #tvs in nt_etad_rhs;</span><span>
</span><a name="line-932"></a><span>                             </span><span class="hs-comment">-- See Note [Newtype eta]</span><span>
</span><a name="line-933"></a><span>                             </span><span class="hs-comment">-- Watch out!  If any newtypes become transparent</span><span>
</span><a name="line-934"></a><span>                             </span><span class="hs-comment">-- again check Trac #1072.</span><span>
</span><a name="line-935"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-936"></a><span>
</span><a name="line-937"></a><span class="hs-identifier">mkSumTyConRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span>
</span><a name="line-938"></a><a name="mkSumTyConRhs"><a href="TyCon.html#mkSumTyConRhs"><span class="hs-identifier">mkSumTyConRhs</span></a></a><span> </span><a name="local-6989586621681719354"><a href="#local-6989586621681719354"><span class="hs-identifier">data_cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><a href="#local-6989586621681719354"><span class="hs-identifier hs-var">data_cons</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719354"><span class="hs-identifier hs-var">data_cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>
</span><a name="line-940"></a><span class="hs-identifier">mkDataTyConRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span>
</span><a name="line-941"></a><a name="mkDataTyConRhs"><a href="TyCon.html#mkDataTyConRhs"><span class="hs-identifier">mkDataTyConRhs</span></a></a><span> </span><a name="local-6989586621681719355"><a href="#local-6989586621681719355"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-942"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-943"></a><span>        </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719355"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span>
</span><a name="line-944"></a><span>        </span><span class="hs-identifier">data_cons_size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719355"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span>
</span><a name="line-945"></a><span>        </span><span class="hs-identifier">is_enum</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681719355"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="#local-6989586621681719356"><span class="hs-identifier hs-var">is_enum_con</span></a><span> </span><a href="#local-6989586621681719355"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-946"></a><span>                  </span><span class="hs-comment">-- See Note [Enumeration types] in TyCon</span><span>
</span><a name="line-947"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-948"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-949"></a><span>    </span><a name="local-6989586621681719356"><a href="#local-6989586621681719356"><span class="hs-identifier">is_enum_con</span></a></a><span> </span><a name="local-6989586621681719357"><a href="#local-6989586621681719357"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-950"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681719358"><a href="#local-6989586621681719358"><span class="hs-identifier">_univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719359"><a href="#local-6989586621681719359"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719360"><a href="#local-6989586621681719360"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719361"><a href="#local-6989586621681719361"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719362"><a href="#local-6989586621681719362"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719363"><a href="#local-6989586621681719363"><span class="hs-identifier">_res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DataCon.html#dataConFullSig"><span class="hs-identifier hs-var">dataConFullSig</span></a><span> </span><a href="#local-6989586621681719357"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-952"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681719359"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681719360"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681719361"><span class="hs-identifier hs-var">theta</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621681719362"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-953"></a><span>
</span><a name="line-954"></a><span class="hs-comment">-- | Some promoted datacons signify extra info relevant to GHC. For example,</span><span>
</span><a name="line-955"></a><span class="hs-comment">-- the @IntRep@ constructor of @RuntimeRep@ corresponds to the 'IntRep'</span><span>
</span><a name="line-956"></a><span class="hs-comment">-- constructor of 'PrimRep'. This data structure allows us to store this</span><span>
</span><a name="line-957"></a><span class="hs-comment">-- information right in the 'TyCon'. The other approach would be to look</span><span>
</span><a name="line-958"></a><span class="hs-comment">-- up things like @RuntimeRep@'s @PrimRep@ by known-key every time.</span><span>
</span><a name="line-959"></a><span class="hs-keyword">data</span><span> </span><a name="RuntimeRepInfo"><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier">RuntimeRepInfo</span></a></a><span>
</span><a name="line-960"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NoRRI"><a href="TyCon.html#NoRRI"><span class="hs-identifier">NoRRI</span></a></a><span>       </span><span class="hs-comment">-- ^ an ordinary promoted data con</span><span>
</span><a name="line-961"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RuntimeRep"><a href="TyCon.html#RuntimeRep"><span class="hs-identifier">RuntimeRep</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-962"></a><span>      </span><span class="hs-comment">-- ^ A constructor of @RuntimeRep@. The argument to the function should</span><span>
</span><a name="line-963"></a><span>      </span><span class="hs-comment">-- be the list of arguments to the promoted datacon.</span><span>
</span><a name="line-964"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VecCount"><a href="TyCon.html#VecCount"><span class="hs-identifier">VecCount</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>         </span><span class="hs-comment">-- ^ A constructor of @VecCount@</span><span>
</span><a name="line-965"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VecElem"><a href="TyCon.html#VecElem"><span class="hs-identifier">VecElem</span></a></a><span> </span><a href="TyCon.html#PrimElemRep"><span class="hs-identifier hs-type">PrimElemRep</span></a><span>  </span><span class="hs-comment">-- ^ A constructor of @VecElem@</span><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-comment">-- | Extract those 'DataCon's that we are able to learn about.  Note</span><span>
</span><a name="line-968"></a><span class="hs-comment">-- that visibility in this sense does not correspond to visibility in</span><span>
</span><a name="line-969"></a><span class="hs-comment">-- the context of any particular user program!</span><span>
</span><a name="line-970"></a><span class="hs-identifier">visibleDataCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-971"></a><a name="visibleDataCons"><a href="TyCon.html#visibleDataCons"><span class="hs-identifier">visibleDataCons</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier hs-var">AbstractTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-972"></a><span class="hs-identifier">visibleDataCons</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719364"><a href="#local-6989586621681719364"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719364"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-973"></a><span class="hs-identifier">visibleDataCons</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719365"><a href="#local-6989586621681719365"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681719365"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-974"></a><span class="hs-identifier">visibleDataCons</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719366"><a href="#local-6989586621681719366"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681719366"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-975"></a><span class="hs-identifier">visibleDataCons</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719367"><a href="#local-6989586621681719367"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719367"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-976"></a><span>
</span><a name="line-977"></a><span class="hs-comment">-- ^ Both type classes as well as family instances imply implicit</span><span>
</span><a name="line-978"></a><span class="hs-comment">-- type constructors.  These implicit type constructors refer to their parent</span><span>
</span><a name="line-979"></a><span class="hs-comment">-- structure (ie, the class or family from which they derive) using a type of</span><span>
</span><a name="line-980"></a><span class="hs-comment">-- the following form.</span><span>
</span><a name="line-981"></a><span class="hs-keyword">data</span><span> </span><a name="AlgTyConFlav"><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier">AlgTyConFlav</span></a></a><span>
</span><a name="line-982"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | An ordinary type constructor has no parent.</span><span>
</span><a name="line-983"></a><span>    </span><a name="VanillaAlgTyCon"><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier">VanillaAlgTyCon</span></a></a><span>
</span><a name="line-984"></a><span>       </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-985"></a><span>
</span><a name="line-986"></a><span>    </span><span class="hs-comment">-- | An unboxed type constructor. The TyConRepName is a Maybe since we</span><span>
</span><a name="line-987"></a><span>    </span><span class="hs-comment">-- currently don't allow unboxed sums to be Typeable since there are too</span><span>
</span><a name="line-988"></a><span>    </span><span class="hs-comment">-- many of them. See #13276.</span><span>
</span><a name="line-989"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnboxedAlgTyCon"><a href="TyCon.html#UnboxedAlgTyCon"><span class="hs-identifier">UnboxedAlgTyCon</span></a></a><span>
</span><a name="line-990"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span class="hs-special">)</span><span>
</span><a name="line-991"></a><span>
</span><a name="line-992"></a><span>  </span><span class="hs-comment">-- | Type constructors representing a class dictionary.</span><span>
</span><a name="line-993"></a><span>  </span><span class="hs-comment">-- See Note [ATyCon for classes] in TyCoRep</span><span>
</span><a name="line-994"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClassTyCon"><a href="TyCon.html#ClassTyCon"><span class="hs-identifier">ClassTyCon</span></a></a><span>
</span><a name="line-995"></a><span>        </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>           </span><span class="hs-comment">-- INVARIANT: the classTyCon of this Class is the</span><span>
</span><a name="line-996"></a><span>                        </span><span class="hs-comment">-- current tycon</span><span>
</span><a name="line-997"></a><span>        </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-998"></a><span>
</span><a name="line-999"></a><span>  </span><span class="hs-comment">-- | Type constructors representing an *instance* of a *data* family.</span><span>
</span><a name="line-1000"></a><span>  </span><span class="hs-comment">-- Parameters:</span><span>
</span><a name="line-1001"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-1002"></a><span>  </span><span class="hs-comment">--  1) The type family in question</span><span>
</span><a name="line-1003"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-1004"></a><span>  </span><span class="hs-comment">--  2) Instance types; free variables are the 'tyConTyVars'</span><span>
</span><a name="line-1005"></a><span>  </span><span class="hs-comment">--  of the current 'TyCon' (not the family one). INVARIANT:</span><span>
</span><a name="line-1006"></a><span>  </span><span class="hs-comment">--  the number of types matches the arity of the family 'TyCon'</span><span>
</span><a name="line-1007"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-1008"></a><span>  </span><span class="hs-comment">--  3) A 'CoTyCon' identifying the representation</span><span>
</span><a name="line-1009"></a><span>  </span><span class="hs-comment">--  type with the type instance family</span><span>
</span><a name="line-1010"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DataFamInstTyCon"><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier">DataFamInstTyCon</span></a></a><span>          </span><span class="hs-comment">-- See Note [Data type families]</span><span>
</span><a name="line-1011"></a><span>        </span><span class="hs-special">(</span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- The coercion axiom.</span><span>
</span><a name="line-1012"></a><span>               </span><span class="hs-comment">-- A *Representational* coercion,</span><span>
</span><a name="line-1013"></a><span>               </span><span class="hs-comment">-- of kind   T ty1 ty2   ~R   R:T a b c</span><span>
</span><a name="line-1014"></a><span>               </span><span class="hs-comment">-- where T is the family TyCon,</span><span>
</span><a name="line-1015"></a><span>               </span><span class="hs-comment">-- and R:T is the representation TyCon (ie this one)</span><span>
</span><a name="line-1016"></a><span>               </span><span class="hs-comment">-- and a,b,c are the tyConTyVars of this TyCon</span><span>
</span><a name="line-1017"></a><span>               </span><span class="hs-comment">--</span><span>
</span><a name="line-1018"></a><span>               </span><span class="hs-comment">-- BUT may be eta-reduced; see FamInstEnv</span><span>
</span><a name="line-1019"></a><span>               </span><span class="hs-comment">--     Note [Eta reduction for data families]</span><span>
</span><a name="line-1020"></a><span>
</span><a name="line-1021"></a><span>          </span><span class="hs-comment">-- Cached fields of the CoAxiom, but adjusted to</span><span>
</span><a name="line-1022"></a><span>          </span><span class="hs-comment">-- use the tyConTyVars of this TyCon</span><span>
</span><a name="line-1023"></a><span>        </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>   </span><span class="hs-comment">-- The family TyCon</span><span>
</span><a name="line-1024"></a><span>        </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Argument types (mentions the tyConTyVars of this TyCon)</span><span>
</span><a name="line-1025"></a><span>                </span><span class="hs-comment">-- No shorter in length than the tyConTyVars of the family TyCon</span><span>
</span><a name="line-1026"></a><span>                </span><span class="hs-comment">-- How could it be longer? See [Arity of data families] in FamInstEnv</span><span>
</span><a name="line-1027"></a><span>
</span><a name="line-1028"></a><span>        </span><span class="hs-comment">-- E.g.  data instance T [a] = ...</span><span>
</span><a name="line-1029"></a><span>        </span><span class="hs-comment">-- gives a representation tycon:</span><span>
</span><a name="line-1030"></a><span>        </span><span class="hs-comment">--      data R:TList a = ...</span><span>
</span><a name="line-1031"></a><span>        </span><span class="hs-comment">--      axiom co a :: T [a] ~ R:TList a</span><span>
</span><a name="line-1032"></a><span>        </span><span class="hs-comment">-- with R:TList's algTcParent = DataFamInstTyCon T [a] co</span><span>
</span><a name="line-1033"></a><span>
</span><a name="line-1034"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1035"></a><span>    </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier hs-var">VanillaAlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Vanilla ADT&quot;</span><span>
</span><a name="line-1036"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#UnboxedAlgTyCon"><span class="hs-identifier hs-var">UnboxedAlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unboxed ADT&quot;</span><span>
</span><a name="line-1037"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><a name="local-6989586621681719306"><a href="#local-6989586621681719306"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Class parent&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719306"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-1038"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719307"><a href="#local-6989586621681719307"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681719308"><a href="#local-6989586621681719308"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Family parent (family instance)&quot;</span><span>
</span><a name="line-1039"></a><span>                                      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719307"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span> </span><a href="#local-6989586621681719308"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1040"></a><span>
</span><a name="line-1041"></a><span class="hs-comment">-- | Checks the invariants of a 'AlgTyConFlav' given the appropriate type class</span><span>
</span><a name="line-1042"></a><span class="hs-comment">-- name, if any</span><span>
</span><a name="line-1043"></a><span class="hs-identifier">okParent</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1044"></a><a name="okParent"><a href="TyCon.html#okParent"><span class="hs-identifier">okParent</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier hs-var">VanillaAlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1045"></a><span class="hs-identifier">okParent</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCon.html#UnboxedAlgTyCon"><span class="hs-identifier hs-var">UnboxedAlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1046"></a><span class="hs-identifier">okParent</span><span> </span><a name="local-6989586621681719368"><a href="#local-6989586621681719368"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><a name="local-6989586621681719369"><a href="#local-6989586621681719369"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719368"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-6989586621681719369"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1047"></a><span class="hs-identifier">okParent</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719370"><a href="#local-6989586621681719370"><span class="hs-identifier">fam_tc</span></a></a><span> </span><a name="local-6989586621681719371"><a href="#local-6989586621681719371"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719371"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthAtLeast"><span class="hs-identifier hs-var">lengthAtLeast</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621681719370"><span class="hs-identifier hs-var">fam_tc</span></a><span>
</span><a name="line-1048"></a><span>
</span><a name="line-1049"></a><span class="hs-identifier">isNoParent</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1050"></a><a name="isNoParent"><a href="TyCon.html#isNoParent"><span class="hs-identifier">isNoParent</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier hs-var">VanillaAlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1051"></a><span class="hs-identifier">isNoParent</span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span class="hs-comment">--------------------</span><span>
</span><a name="line-1054"></a><span>
</span><a name="line-1055"></a><span class="hs-keyword">data</span><span> </span><a name="Injectivity"><a href="TyCon.html#Injectivity"><span class="hs-identifier">Injectivity</span></a></a><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="NotInjective"><a href="TyCon.html#NotInjective"><span class="hs-identifier">NotInjective</span></a></a><span>
</span><a name="line-1057"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Injective"><a href="TyCon.html#Injective"><span class="hs-identifier">Injective</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- 1-1 with tyConTyVars (incl kind vars)</span><span>
</span><a name="line-1058"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-comment">-- | Information pertaining to the expansion of a type synonym (@type@)</span><span>
</span><a name="line-1061"></a><span class="hs-keyword">data</span><span> </span><a name="FamTyConFlav"><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier">FamTyConFlav</span></a></a><span>
</span><a name="line-1062"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Represents an open type family without a fixed right hand</span><span>
</span><a name="line-1063"></a><span>    </span><span class="hs-comment">-- side.  Additional instances can appear at any time.</span><span>
</span><a name="line-1064"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1065"></a><span>    </span><span class="hs-comment">-- These are introduced by either a top level declaration:</span><span>
</span><a name="line-1066"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1067"></a><span>    </span><span class="hs-comment">-- &gt; data family T a :: *</span><span>
</span><a name="line-1068"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1069"></a><span>    </span><span class="hs-comment">-- Or an associated data type declaration, within a class declaration:</span><span>
</span><a name="line-1070"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-1071"></a><span>    </span><span class="hs-comment">-- &gt; class C a b where</span><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-comment">-- &gt;   data T b :: *</span><span>
</span><a name="line-1073"></a><span>     </span><a name="DataFamilyTyCon"><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier">DataFamilyTyCon</span></a></a><span>
</span><a name="line-1074"></a><span>       </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-1075"></a><span>
</span><a name="line-1076"></a><span>     </span><span class="hs-comment">-- | An open type synonym family  e.g. @type family F x y :: * -&gt; *@</span><span>
</span><a name="line-1077"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="OpenSynFamilyTyCon"><a href="TyCon.html#OpenSynFamilyTyCon"><span class="hs-identifier">OpenSynFamilyTyCon</span></a></a><span>
</span><a name="line-1078"></a><span>
</span><a name="line-1079"></a><span>   </span><span class="hs-comment">-- | A closed type synonym family  e.g.</span><span>
</span><a name="line-1080"></a><span>   </span><span class="hs-comment">-- @type family F x where { F Int = Bool }@</span><span>
</span><a name="line-1081"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="ClosedSynFamilyTyCon"><a href="TyCon.html#ClosedSynFamilyTyCon"><span class="hs-identifier">ClosedSynFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1082"></a><span>     </span><span class="hs-comment">-- See Note [Closed type families]</span><span>
</span><a name="line-1083"></a><span>
</span><a name="line-1084"></a><span>   </span><span class="hs-comment">-- | A closed type synonym family declared in an hs-boot file with</span><span>
</span><a name="line-1085"></a><span>   </span><span class="hs-comment">-- type family F a where ..</span><span>
</span><a name="line-1086"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="AbstractClosedSynFamilyTyCon"><a href="TyCon.html#AbstractClosedSynFamilyTyCon"><span class="hs-identifier">AbstractClosedSynFamilyTyCon</span></a></a><span>
</span><a name="line-1087"></a><span>
</span><a name="line-1088"></a><span>   </span><span class="hs-comment">-- | Built-in type family used by the TypeNats solver</span><span>
</span><a name="line-1089"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="BuiltInSynFamTyCon"><a href="TyCon.html#BuiltInSynFamTyCon"><span class="hs-identifier">BuiltInSynFamTyCon</span></a></a><span> </span><a href="CoAxiom.html#BuiltInSynFamily"><span class="hs-identifier hs-type">BuiltInSynFamily</span></a><span>
</span><a name="line-1090"></a><span>
</span><a name="line-1091"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1092"></a><span>    </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><a name="local-6989586621681719304"><a href="#local-6989586621681719304"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;data family&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719304"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1093"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="TyCon.html#OpenSynFamilyTyCon"><span class="hs-identifier hs-var">OpenSynFamilyTyCon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;open type family&quot;</span><span>
</span><a name="line-1094"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#ClosedSynFamilyTyCon"><span class="hs-identifier hs-var">ClosedSynFamilyTyCon</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;closed type family&quot;</span><span>
</span><a name="line-1095"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#ClosedSynFamilyTyCon"><span class="hs-identifier hs-var">ClosedSynFamilyTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681719305"><a href="#local-6989586621681719305"><span class="hs-identifier">coax</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;closed type family&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719305"><span class="hs-identifier hs-var">coax</span></a><span>
</span><a name="line-1096"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><a href="TyCon.html#AbstractClosedSynFamilyTyCon"><span class="hs-identifier hs-var">AbstractClosedSynFamilyTyCon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;abstract closed type family&quot;</span><span>
</span><a name="line-1097"></a><span>    </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#BuiltInSynFamTyCon"><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;built-in type family&quot;</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span class="hs-comment">{- Note [Closed type families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* In an open type family you can add new instances later.  This is the
  usual case.

* In a closed type family you can only put equations where the family
  is defined.

A non-empty closed type family has a single axiom with multiple
branches, stored in the 'ClosedSynFamilyTyCon' constructor.  A closed
type family with no equations does not have an axiom, because there is
nothing for the axiom to prove!


Note [Promoted data constructors]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All data constructors can be promoted to become a type constructor,
via the PromotedDataCon alternative in TyCon.

* The TyCon promoted from a DataCon has the *same* Name and Unique as
  the DataCon.  Eg. If the data constructor Data.Maybe.Just(unique 78,
  say) is promoted to a TyCon whose name is Data.Maybe.Just(unique 78)

* Small note: We promote the *user* type of the DataCon.  Eg
     data T = MkT {-# UNPACK #-} !(Bool, Bool)
  The promoted kind is
     MkT :: (Bool,Bool) -&gt; T
  *not*
     MkT :: Bool -&gt; Bool -&gt; T

Note [Enumeration types]
~~~~~~~~~~~~~~~~~~~~~~~~
We define datatypes with no constructors to *not* be
enumerations; this fixes trac #2578,  Otherwise we
end up generating an empty table for
  &lt;mod&gt;_&lt;type&gt;_closure_tbl
which is used by tagToEnum# to map Int# to constructors
in an enumeration. The empty table apparently upset
the linker.

Moreover, all the data constructor must be enumerations, meaning
they have type  (forall abc. T a b c).  GADTs are not enumerations.
For example consider
    data T a where
      T1 :: T Int
      T2 :: T Bool
      T3 :: T a
What would [T1 ..] be?  [T1,T3] :: T Int? Easiest thing is to exclude them.
See Trac #4528.

Note [Newtype coercions]
~~~~~~~~~~~~~~~~~~~~~~~~
The NewTyCon field nt_co is a CoAxiom which is used for coercing from
the representation type of the newtype, to the newtype itself. For
example,

   newtype T a = MkT (a -&gt; a)

the NewTyCon for T will contain nt_co = CoT where CoT t : T t ~ t -&gt; t.

In the case that the right hand side is a type application
ending with the same type variables as the left hand side, we
&quot;eta-contract&quot; the coercion.  So if we had

   newtype S a = MkT [a]

then we would generate the arity 0 axiom CoS : S ~ [].  The
primary reason we do this is to make newtype deriving cleaner.

In the paper we'd write
        axiom CoT : (forall t. T t) ~ (forall t. [t])
and then when we used CoT at a particular type, s, we'd say
        CoT @ s
which encodes as (TyConApp instCoercionTyCon [TyConApp CoT [], s])

Note [Newtype eta]
~~~~~~~~~~~~~~~~~~
Consider
        newtype Parser a = MkParser (IO a) deriving Monad
Are these two types equal (to Core)?
        Monad Parser
        Monad IO
which we need to make the derived instance for Monad Parser.

Well, yes.  But to see that easily we eta-reduce the RHS type of
Parser, in this case to ([], Froogle), so that even unsaturated applications
of Parser will work right.  This eta reduction is done when the type
constructor is built, and cached in NewTyCon.

Here's an example that I think showed up in practice
Source code:
        newtype T a = MkT [a]
        newtype Foo m = MkFoo (forall a. m a -&gt; Int)

        w1 :: Foo []
        w1 = ...

        w2 :: Foo T
        w2 = MkFoo (\(MkT x) -&gt; case w1 of MkFoo f -&gt; f x)

After desugaring, and discarding the data constructors for the newtypes,
we get:
        w2 = w1 `cast` Foo CoT
so the coercion tycon CoT must have
        kind:    T ~ []
 and    arity:   0

This eta-reduction is implemented in BuildTyCl.mkNewTyConRhs.


************************************************************************
*                                                                      *
                 TyConRepName
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-1214"></a><span>
</span><a name="line-1215"></a><span class="hs-keyword">type</span><span> </span><a name="TyConRepName"><a href="TyCon.html#TyConRepName"><span class="hs-identifier">TyConRepName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-comment">-- The Name of the top-level declaration</span><span>
</span><a name="line-1216"></a><span>                         </span><span class="hs-comment">--    $tcMaybe :: Data.Typeable.Internal.TyCon</span><span>
</span><a name="line-1217"></a><span>                         </span><span class="hs-comment">--    $tcMaybe = TyCon { tyConName = &quot;Maybe&quot;, ... }</span><span>
</span><a name="line-1218"></a><span>
</span><a name="line-1219"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-1220"></a><a name="tyConRepName_maybe"><a href="TyCon.html#tyConRepName_maybe"><span class="hs-identifier">tyConRepName_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span>   </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcRepName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719372"><a href="#local-6989586621681719372"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1221"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719372"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1222"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">primRepName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719373"><a href="#local-6989586621681719373"><span class="hs-identifier">mb_rep_nm</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1223"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719373"><span class="hs-identifier hs-var">mb_rep_nm</span></a><span>
</span><a name="line-1224"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719374"><a href="#local-6989586621681719374"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1225"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier hs-var">VanillaAlgTyCon</span></a><span> </span><a name="local-6989586621681719375"><a href="#local-6989586621681719375"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719374"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719375"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1226"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719376"><a href="#local-6989586621681719376"><span class="hs-identifier">rep_nm</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719374"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719376"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1227"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#UnboxedAlgTyCon"><span class="hs-identifier hs-var">UnboxedAlgTyCon</span></a><span> </span><a name="local-6989586621681719377"><a href="#local-6989586621681719377"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719374"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719377"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1228"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><a name="local-6989586621681719378"><a href="#local-6989586621681719378"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1229"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719378"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1230"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dataCon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719379"><a href="#local-6989586621681719379"><span class="hs-identifier">dc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcRepName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719380"><a href="#local-6989586621681719380"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1231"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="DataCon.html#isUnboxedSumCon"><span class="hs-identifier hs-var">isUnboxedSumCon</span></a><span> </span><a href="#local-6989586621681719379"><span class="hs-identifier hs-var">dc</span></a><span>   </span><span class="hs-comment">-- see #13276</span><span>
</span><a name="line-1232"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1233"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1234"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719380"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1235"></a><span class="hs-identifier">tyConRepName_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1236"></a><span>
</span><a name="line-1237"></a><span class="hs-comment">-- | Make a 'Name' for the 'Typeable' representation of the given wired-in type</span><span>
</span><a name="line-1238"></a><span class="hs-identifier">mkPrelTyConRepName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-1239"></a><span class="hs-comment">-- See Note [Grand plan for Typeable] in 'TcTypeable' in TcTypeable.</span><span>
</span><a name="line-1240"></a><a name="mkPrelTyConRepName"><a href="TyCon.html#mkPrelTyConRepName"><span class="hs-identifier">mkPrelTyConRepName</span></a></a><span> </span><a name="local-6989586621681719381"><a href="#local-6989586621681719381"><span class="hs-identifier">tc_name</span></a></a><span>  </span><span class="hs-comment">-- Prelude tc_name is always External,</span><span>
</span><a name="line-1241"></a><span>                            </span><span class="hs-comment">-- so nameModule will work</span><span>
</span><a name="line-1242"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span> </span><a href="#local-6989586621681719385"><span class="hs-identifier hs-var">rep_uniq</span></a><span> </span><a href="#local-6989586621681719386"><span class="hs-identifier hs-var">rep_mod</span></a><span> </span><a href="#local-6989586621681719387"><span class="hs-identifier hs-var">rep_occ</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span> </span><a href="#local-6989586621681719381"><span class="hs-identifier hs-var">tc_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1243"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1244"></a><span>    </span><a name="local-6989586621681719382"><a href="#local-6989586621681719382"><span class="hs-identifier">name_occ</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681719381"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-1245"></a><span>    </span><a name="local-6989586621681719383"><a href="#local-6989586621681719383"><span class="hs-identifier">name_mod</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span>  </span><a href="#local-6989586621681719381"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-1246"></a><span>    </span><a name="local-6989586621681719384"><a href="#local-6989586621681719384"><span class="hs-identifier">name_uniq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span>  </span><a href="#local-6989586621681719381"><span class="hs-identifier hs-var">tc_name</span></a><span>
</span><a name="line-1247"></a><span>    </span><a name="local-6989586621681719385"><a href="#local-6989586621681719385"><span class="hs-identifier">rep_uniq</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span> </span><a href="#local-6989586621681719382"><span class="hs-identifier hs-var">name_occ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#tyConRepNameUnique"><span class="hs-identifier hs-var">tyConRepNameUnique</span></a><span>   </span><a href="#local-6989586621681719384"><span class="hs-identifier hs-var">name_uniq</span></a><span>
</span><a name="line-1248"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#dataConTyRepNameUnique"><span class="hs-identifier hs-var">dataConTyRepNameUnique</span></a><span> </span><a href="#local-6989586621681719384"><span class="hs-identifier hs-var">name_uniq</span></a><span>
</span><a name="line-1249"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621681719386"><a href="#local-6989586621681719386"><span class="hs-identifier">rep_mod</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621681719387"><a href="#local-6989586621681719387"><span class="hs-identifier">rep_occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConRepModOcc"><span class="hs-identifier hs-var">tyConRepModOcc</span></a><span> </span><a href="#local-6989586621681719383"><span class="hs-identifier hs-var">name_mod</span></a><span> </span><a href="#local-6989586621681719382"><span class="hs-identifier hs-var">name_occ</span></a><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span class="hs-comment">-- | The name (and defining module) for the Typeable representation (TyCon) of a</span><span>
</span><a name="line-1252"></a><span class="hs-comment">-- type constructor.</span><span>
</span><a name="line-1253"></a><span class="hs-comment">--</span><span>
</span><a name="line-1254"></a><span class="hs-comment">-- See Note [Grand plan for Typeable] in 'TcTypeable' in TcTypeable.</span><span>
</span><a name="line-1255"></a><span class="hs-identifier">tyConRepModOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><a name="tyConRepModOcc"><a href="TyCon.html#tyConRepModOcc"><span class="hs-identifier">tyConRepModOcc</span></a></a><span> </span><a name="local-6989586621681719388"><a href="#local-6989586621681719388"><span class="hs-identifier">tc_module</span></a></a><span> </span><a name="local-6989586621681719389"><a href="#local-6989586621681719389"><span class="hs-identifier">tc_occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719390"><span class="hs-identifier hs-var">rep_module</span></a><span class="hs-special">,</span><span> </span><a href="OccName.html#mkTyConRepOcc"><span class="hs-identifier hs-var">mkTyConRepOcc</span></a><span> </span><a href="#local-6989586621681719389"><span class="hs-identifier hs-var">tc_occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-1257"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1258"></a><span>    </span><a name="local-6989586621681719390"><a href="#local-6989586621681719390"><span class="hs-identifier">rep_module</span></a></a><span>
</span><a name="line-1259"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681719388"><span class="hs-identifier hs-var">tc_module</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#gHC_PRIM"><span class="hs-identifier hs-var">gHC_PRIM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#gHC_TYPES"><span class="hs-identifier hs-var">gHC_TYPES</span></a><span>
</span><a name="line-1260"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719388"><span class="hs-identifier hs-var">tc_module</span></a><span>
</span><a name="line-1261"></a><span>
</span><a name="line-1262"></a><span>
</span><a name="line-1263"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 PrimRep
*                                                                      *
************************************************************************

Note [rep swamp]

GHC has a rich selection of types that represent &quot;primitive types&quot; of
one kind or another.  Each of them makes a different set of
distinctions, and mostly the differences are for good reasons,
although it's probably true that we could merge some of these.

Roughly in order of &quot;includes more information&quot;:

 - A Width (cmm/CmmType) is simply a binary value with the specified
   number of bits.  It may represent a signed or unsigned integer, a
   floating-point value, or an address.

    data Width = W8 | W16 | W32 | W64 | W80 | W128

 - Size, which is used in the native code generator, is Width +
   floating point information.

   data Size = II8 | II16 | II32 | II64 | FF32 | FF64 | FF80

   it is necessary because e.g. the instruction to move a 64-bit float
   on x86 (movsd) is different from the instruction to move a 64-bit
   integer (movq), so the mov instruction is parameterised by Size.

 - CmmType wraps Width with more information: GC ptr, float, or
   other value.

    data CmmType = CmmType CmmCat Width

    data CmmCat     -- &quot;Category&quot; (not exported)
       = GcPtrCat   -- GC pointer
       | BitsCat    -- Non-pointer
       | FloatCat   -- Float

   It is important to have GcPtr information in Cmm, since we generate
   info tables containing pointerhood for the GC from this.  As for
   why we have float (and not signed/unsigned) here, see Note [Signed
   vs unsigned].

 - ArgRep makes only the distinctions necessary for the call and
   return conventions of the STG machine.  It is essentially CmmType
   + void.

 - PrimRep makes a few more distinctions than ArgRep: it divides
   non-GC-pointers into signed/unsigned and addresses, information
   that is necessary for passing these values to foreign functions.

There's another tension here: whether the type encodes its size in
bytes, or whether its size depends on the machine word size.  Width
and CmmType have the size built-in, whereas ArgRep and PrimRep do not.

This means to turn an ArgRep/PrimRep into a CmmType requires DynFlags.

On the other hand, CmmType includes some &quot;nonsense&quot; values, such as
CmmType GcPtrCat W32 on a 64-bit machine.
-}</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span class="hs-comment">-- | A 'PrimRep' is an abstraction of a type.  It contains information that</span><span>
</span><a name="line-1327"></a><span class="hs-comment">-- the code generator needs in order to pass arguments, return results,</span><span>
</span><a name="line-1328"></a><span class="hs-comment">-- and store values of this type.</span><span>
</span><a name="line-1329"></a><span class="hs-keyword">data</span><span> </span><a name="PrimRep"><a href="TyCon.html#PrimRep"><span class="hs-identifier">PrimRep</span></a></a><span>
</span><a name="line-1330"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="VoidRep"><a href="TyCon.html#VoidRep"><span class="hs-identifier">VoidRep</span></a></a><span>
</span><a name="line-1331"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LiftedRep"><a href="TyCon.html#LiftedRep"><span class="hs-identifier">LiftedRep</span></a></a><span>
</span><a name="line-1332"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="UnliftedRep"><a href="TyCon.html#UnliftedRep"><span class="hs-identifier">UnliftedRep</span></a></a><span>   </span><span class="hs-comment">-- ^ Unlifted pointer</span><span>
</span><a name="line-1333"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int8Rep"><a href="TyCon.html#Int8Rep"><span class="hs-identifier">Int8Rep</span></a></a><span>       </span><span class="hs-comment">-- ^ Signed, 8-bit value</span><span>
</span><a name="line-1334"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int16Rep"><a href="TyCon.html#Int16Rep"><span class="hs-identifier">Int16Rep</span></a></a><span>      </span><span class="hs-comment">-- ^ Signed, 16-bit value</span><span>
</span><a name="line-1335"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="IntRep"><a href="TyCon.html#IntRep"><span class="hs-identifier">IntRep</span></a></a><span>        </span><span class="hs-comment">-- ^ Signed, word-sized value</span><span>
</span><a name="line-1336"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WordRep"><a href="TyCon.html#WordRep"><span class="hs-identifier">WordRep</span></a></a><span>       </span><span class="hs-comment">-- ^ Unsigned, word-sized value</span><span>
</span><a name="line-1337"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int64Rep"><a href="TyCon.html#Int64Rep"><span class="hs-identifier">Int64Rep</span></a></a><span>      </span><span class="hs-comment">-- ^ Signed, 64 bit value (with 32-bit words only)</span><span>
</span><a name="line-1338"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word8Rep"><a href="TyCon.html#Word8Rep"><span class="hs-identifier">Word8Rep</span></a></a><span>      </span><span class="hs-comment">-- ^ Unsigned, 8 bit value</span><span>
</span><a name="line-1339"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word16Rep"><a href="TyCon.html#Word16Rep"><span class="hs-identifier">Word16Rep</span></a></a><span>      </span><span class="hs-comment">-- ^ Unsigned, 16 bit value</span><span>
</span><a name="line-1340"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word64Rep"><a href="TyCon.html#Word64Rep"><span class="hs-identifier">Word64Rep</span></a></a><span>     </span><span class="hs-comment">-- ^ Unsigned, 64 bit value (with 32-bit words only)</span><span>
</span><a name="line-1341"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AddrRep"><a href="TyCon.html#AddrRep"><span class="hs-identifier">AddrRep</span></a></a><span>       </span><span class="hs-comment">-- ^ A pointer, but /not/ to a Haskell value (use '(Un)liftedRep')</span><span>
</span><a name="line-1342"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FloatRep"><a href="TyCon.html#FloatRep"><span class="hs-identifier">FloatRep</span></a></a><span>
</span><a name="line-1343"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DoubleRep"><a href="TyCon.html#DoubleRep"><span class="hs-identifier">DoubleRep</span></a></a><span>
</span><a name="line-1344"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="VecRep"><a href="TyCon.html#VecRep"><span class="hs-identifier">VecRep</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="TyCon.html#PrimElemRep"><span class="hs-identifier hs-type">PrimElemRep</span></a><span>  </span><span class="hs-comment">-- ^ A vector</span><span>
</span><a name="line-1345"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1346"></a><span>
</span><a name="line-1347"></a><span class="hs-keyword">data</span><span> </span><a name="PrimElemRep"><a href="TyCon.html#PrimElemRep"><span class="hs-identifier">PrimElemRep</span></a></a><span>
</span><a name="line-1348"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Int8ElemRep"><a href="TyCon.html#Int8ElemRep"><span class="hs-identifier">Int8ElemRep</span></a></a><span>
</span><a name="line-1349"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int16ElemRep"><a href="TyCon.html#Int16ElemRep"><span class="hs-identifier">Int16ElemRep</span></a></a><span>
</span><a name="line-1350"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int32ElemRep"><a href="TyCon.html#Int32ElemRep"><span class="hs-identifier">Int32ElemRep</span></a></a><span>
</span><a name="line-1351"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Int64ElemRep"><a href="TyCon.html#Int64ElemRep"><span class="hs-identifier">Int64ElemRep</span></a></a><span>
</span><a name="line-1352"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word8ElemRep"><a href="TyCon.html#Word8ElemRep"><span class="hs-identifier">Word8ElemRep</span></a></a><span>
</span><a name="line-1353"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word16ElemRep"><a href="TyCon.html#Word16ElemRep"><span class="hs-identifier">Word16ElemRep</span></a></a><span>
</span><a name="line-1354"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word32ElemRep"><a href="TyCon.html#Word32ElemRep"><span class="hs-identifier">Word32ElemRep</span></a></a><span>
</span><a name="line-1355"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Word64ElemRep"><a href="TyCon.html#Word64ElemRep"><span class="hs-identifier">Word64ElemRep</span></a></a><span>
</span><a name="line-1356"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FloatElemRep"><a href="TyCon.html#FloatElemRep"><span class="hs-identifier">FloatElemRep</span></a></a><span>
</span><a name="line-1357"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DoubleElemRep"><a href="TyCon.html#DoubleElemRep"><span class="hs-identifier">DoubleElemRep</span></a></a><span>
</span><a name="line-1358"></a><span>   </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1359"></a><span>
</span><a name="line-1360"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1361"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621681719303"><a href="#local-6989586621681719303"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621681719303"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1362"></a><span>
</span><a name="line-1363"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#PrimElemRep"><span class="hs-identifier hs-type">PrimElemRep</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1364"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621681719302"><a href="#local-6989586621681719302"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621681719302"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1365"></a><span>
</span><a name="line-1366"></a><span class="hs-identifier">isVoidRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1367"></a><a name="isVoidRep"><a href="TyCon.html#isVoidRep"><span class="hs-identifier">isVoidRep</span></a></a><span> </span><a href="TyCon.html#VoidRep"><span class="hs-identifier hs-var">VoidRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1368"></a><span class="hs-identifier">isVoidRep</span><span> </span><a name="local-6989586621681719391"><a href="#local-6989586621681719391"><span class="hs-identifier">_other</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><span class="hs-identifier">isGcPtrRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1371"></a><a name="isGcPtrRep"><a href="TyCon.html#isGcPtrRep"><span class="hs-identifier">isGcPtrRep</span></a></a><span> </span><a href="TyCon.html#LiftedRep"><span class="hs-identifier hs-var">LiftedRep</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1372"></a><span class="hs-identifier">isGcPtrRep</span><span> </span><a href="TyCon.html#UnliftedRep"><span class="hs-identifier hs-var">UnliftedRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1373"></a><span class="hs-identifier">isGcPtrRep</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1374"></a><span>
</span><a name="line-1375"></a><span class="hs-comment">-- | The size of a 'PrimRep' in bytes.</span><span>
</span><a name="line-1376"></a><span class="hs-comment">--</span><span>
</span><a name="line-1377"></a><span class="hs-comment">-- This applies also when used in a constructor, where we allow packing the</span><span>
</span><a name="line-1378"></a><span class="hs-comment">-- fields. For instance, in @data Foo = Foo Float# Float#@ the two fields will</span><span>
</span><a name="line-1379"></a><span class="hs-comment">-- take only 8 bytes, which for 64-bit arch will be equal to 1 word.</span><span>
</span><a name="line-1380"></a><span class="hs-comment">-- See also mkVirtHeapOffsetsWithPadding for details of how data fields are</span><span>
</span><a name="line-1381"></a><span class="hs-comment">-- layed out.</span><span>
</span><a name="line-1382"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1383"></a><a name="primRepSizeB"><a href="TyCon.html#primRepSizeB"><span class="hs-identifier">primRepSizeB</span></a></a><span> </span><a name="local-6989586621681719392"><a href="#local-6989586621681719392"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#IntRep"><span class="hs-identifier hs-var">IntRep</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-6989586621681719392"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1384"></a><span class="hs-identifier">primRepSizeB</span><span> </span><a name="local-6989586621681719393"><a href="#local-6989586621681719393"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#WordRep"><span class="hs-identifier hs-var">WordRep</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-6989586621681719393"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1385"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Int8Rep"><span class="hs-identifier hs-var">Int8Rep</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1386"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Int16Rep"><span class="hs-identifier hs-var">Int16Rep</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1387"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Int64Rep"><span class="hs-identifier hs-var">Int64Rep</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Constants.html#wORD64_SIZE"><span class="hs-identifier hs-var">wORD64_SIZE</span></a><span>
</span><a name="line-1388"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Word8Rep"><span class="hs-identifier hs-var">Word8Rep</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1389"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Word16Rep"><span class="hs-identifier hs-var">Word16Rep</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1390"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#Word64Rep"><span class="hs-identifier hs-var">Word64Rep</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Constants.html#wORD64_SIZE"><span class="hs-identifier hs-var">wORD64_SIZE</span></a><span>
</span><a name="line-1391"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#FloatRep"><span class="hs-identifier hs-var">FloatRep</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Constants.html#fLOAT_SIZE"><span class="hs-identifier hs-var">fLOAT_SIZE</span></a><span>
</span><a name="line-1392"></a><span class="hs-identifier">primRepSizeB</span><span> </span><a name="local-6989586621681719394"><a href="#local-6989586621681719394"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#DoubleRep"><span class="hs-identifier hs-var">DoubleRep</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#dOUBLE_SIZE"><span class="hs-identifier hs-var">dOUBLE_SIZE</span></a><span> </span><a href="#local-6989586621681719394"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1393"></a><span class="hs-identifier">primRepSizeB</span><span> </span><a name="local-6989586621681719395"><a href="#local-6989586621681719395"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#AddrRep"><span class="hs-identifier hs-var">AddrRep</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-6989586621681719395"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1394"></a><span class="hs-identifier">primRepSizeB</span><span> </span><a name="local-6989586621681719396"><a href="#local-6989586621681719396"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#LiftedRep"><span class="hs-identifier hs-var">LiftedRep</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-6989586621681719396"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1395"></a><span class="hs-identifier">primRepSizeB</span><span> </span><a name="local-6989586621681719397"><a href="#local-6989586621681719397"><span class="hs-identifier">dflags</span></a></a><span> </span><a href="TyCon.html#UnliftedRep"><span class="hs-identifier hs-var">UnliftedRep</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wORD_SIZE"><span class="hs-identifier hs-var">wORD_SIZE</span></a><span> </span><a href="#local-6989586621681719397"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1396"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><a href="TyCon.html#VoidRep"><span class="hs-identifier hs-var">VoidRep</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1397"></a><span class="hs-identifier">primRepSizeB</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="TyCon.html#VecRep"><span class="hs-identifier hs-var">VecRep</span></a><span> </span><a name="local-6989586621681719398"><a href="#local-6989586621681719398"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621681719399"><a href="#local-6989586621681719399"><span class="hs-identifier">rep</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719398"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="TyCon.html#primElemRepSizeB"><span class="hs-identifier hs-var">primElemRepSizeB</span></a><span> </span><a href="#local-6989586621681719399"><span class="hs-identifier hs-var">rep</span></a><span>
</span><a name="line-1398"></a><span>
</span><a name="line-1399"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimElemRep"><span class="hs-identifier hs-type">PrimElemRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1400"></a><a name="primElemRepSizeB"><a href="TyCon.html#primElemRepSizeB"><span class="hs-identifier">primElemRepSizeB</span></a></a><span> </span><a href="TyCon.html#Int8ElemRep"><span class="hs-identifier hs-var">Int8ElemRep</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1401"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Int16ElemRep"><span class="hs-identifier hs-var">Int16ElemRep</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1402"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Int32ElemRep"><span class="hs-identifier hs-var">Int32ElemRep</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-1403"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Int64ElemRep"><span class="hs-identifier hs-var">Int64ElemRep</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-1404"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Word8ElemRep"><span class="hs-identifier hs-var">Word8ElemRep</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1405"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Word16ElemRep"><span class="hs-identifier hs-var">Word16ElemRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1406"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Word32ElemRep"><span class="hs-identifier hs-var">Word32ElemRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-1407"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#Word64ElemRep"><span class="hs-identifier hs-var">Word64ElemRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-1408"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#FloatElemRep"><span class="hs-identifier hs-var">FloatElemRep</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-1409"></a><span class="hs-identifier">primElemRepSizeB</span><span> </span><a href="TyCon.html#DoubleElemRep"><span class="hs-identifier hs-var">DoubleElemRep</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-1410"></a><span>
</span><a name="line-1411"></a><span class="hs-comment">-- | Return if Rep stands for floating type,</span><span>
</span><a name="line-1412"></a><span class="hs-comment">-- returns Nothing for vector types.</span><span>
</span><a name="line-1413"></a><span class="hs-identifier">primRepIsFloat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1414"></a><a name="primRepIsFloat"><a href="TyCon.html#primRepIsFloat"><span class="hs-identifier">primRepIsFloat</span></a></a><span>  </span><a href="TyCon.html#FloatRep"><span class="hs-identifier hs-var">FloatRep</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1415"></a><span class="hs-identifier">primRepIsFloat</span><span>  </span><a href="TyCon.html#DoubleRep"><span class="hs-identifier hs-var">DoubleRep</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1416"></a><span class="hs-identifier">primRepIsFloat</span><span>  </span><span class="hs-special">(</span><a href="TyCon.html#VecRep"><span class="hs-identifier hs-var">VecRep</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">primRepIsFloat</span><span>  </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1418"></a><span>
</span><a name="line-1419"></a><span>
</span><a name="line-1420"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                             Field labels
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span class="hs-comment">-- | The labels for the fields of this particular 'TyCon'</span><span>
</span><a name="line-1429"></a><span class="hs-identifier">tyConFieldLabels</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-1430"></a><a name="tyConFieldLabels"><a href="TyCon.html#tyConFieldLabels"><span class="hs-identifier">tyConFieldLabels</span></a></a><span> </span><a name="local-6989586621681719400"><a href="#local-6989586621681719400"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#dFsEnvElts"><span class="hs-identifier hs-var">dFsEnvElts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TyCon.html#tyConFieldLabelEnv"><span class="hs-identifier hs-var">tyConFieldLabelEnv</span></a><span> </span><a href="#local-6989586621681719400"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1431"></a><span>
</span><a name="line-1432"></a><span class="hs-comment">-- | The labels for the fields of this particular 'TyCon'</span><span>
</span><a name="line-1433"></a><span class="hs-identifier">tyConFieldLabelEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FieldLabel.html#FieldLabelEnv"><span class="hs-identifier hs-type">FieldLabelEnv</span></a><span>
</span><a name="line-1434"></a><a name="tyConFieldLabelEnv"><a href="TyCon.html#tyConFieldLabelEnv"><span class="hs-identifier">tyConFieldLabelEnv</span></a></a><span> </span><a name="local-6989586621681719401"><a href="#local-6989586621681719401"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1435"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-6989586621681719401"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">algTcFields</span><span> </span><a href="#local-6989586621681719401"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1436"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#emptyDFsEnv"><span class="hs-identifier hs-var">emptyDFsEnv</span></a><span>
</span><a name="line-1437"></a><span>
</span><a name="line-1438"></a><span class="hs-comment">-- | Look up a field label belonging to this 'TyCon'</span><span>
</span><a name="line-1439"></a><span class="hs-identifier">lookupTyConFieldLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span>
</span><a name="line-1440"></a><a name="lookupTyConFieldLabel"><a href="TyCon.html#lookupTyConFieldLabel"><span class="hs-identifier">lookupTyConFieldLabel</span></a></a><span> </span><a name="local-6989586621681719402"><a href="#local-6989586621681719402"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-6989586621681719403"><a href="#local-6989586621681719403"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#lookupDFsEnv"><span class="hs-identifier hs-var">lookupDFsEnv</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConFieldLabelEnv"><span class="hs-identifier hs-var">tyConFieldLabelEnv</span></a><span> </span><a href="#local-6989586621681719403"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719402"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span class="hs-comment">-- | Make a map from strings to FieldLabels from all the data</span><span>
</span><a name="line-1443"></a><span class="hs-comment">-- constructors of this algebraic tycon</span><span>
</span><a name="line-1444"></a><span class="hs-identifier">fieldsOfAlgTcRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FieldLabel.html#FieldLabelEnv"><span class="hs-identifier hs-type">FieldLabelEnv</span></a><span>
</span><a name="line-1445"></a><a name="fieldsOfAlgTcRhs"><a href="TyCon.html#fieldsOfAlgTcRhs"><span class="hs-identifier">fieldsOfAlgTcRhs</span></a></a><span> </span><a name="local-6989586621681719404"><a href="#local-6989586621681719404"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#mkDFsEnv"><span class="hs-identifier hs-var">mkDFsEnv</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flLabel</span><span> </span><a href="#local-6989586621681719407"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719407"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span>
</span><a name="line-1446"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621681719407"><a href="#local-6989586621681719407"><span class="hs-identifier">fl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719405"><span class="hs-identifier hs-var">dataConsFields</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#visibleDataCons"><span class="hs-identifier hs-var">visibleDataCons</span></a><span> </span><a href="#local-6989586621681719404"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1447"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1448"></a><span>    </span><span class="hs-comment">-- Duplicates in this list will be removed by 'mkFsEnv'</span><span>
</span><a name="line-1449"></a><span>    </span><a name="local-6989586621681719405"><a href="#local-6989586621681719405"><span class="hs-identifier">dataConsFields</span></a></a><span> </span><a name="local-6989586621681719406"><a href="#local-6989586621681719406"><span class="hs-identifier">dcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="DataCon.html#dataConFieldLabels"><span class="hs-identifier hs-var">dataConFieldLabels</span></a><span> </span><a href="#local-6989586621681719406"><span class="hs-identifier hs-var">dcs</span></a><span>
</span><a name="line-1450"></a><span>
</span><a name="line-1451"></a><span>
</span><a name="line-1452"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{TyCon Construction}
*                                                                      *
************************************************************************

Note: the TyCon constructors all take a Kind as one argument, even though
they could, in principle, work out their Kind from their other arguments.
But to do so they need functions from Types, and that makes a nasty
module mutual-recursion.  And they aren't called from many places.
So we compromise, and move their Kind calculation to the call site.
-}</span><span>
</span><a name="line-1465"></a><span>
</span><a name="line-1466"></a><span class="hs-comment">-- | Given the name of the function type constructor and it's kind, create the</span><span>
</span><a name="line-1467"></a><span class="hs-comment">-- corresponding 'TyCon'. It is recommended to use 'TyCoRep.funTyCon' if you want</span><span>
</span><a name="line-1468"></a><span class="hs-comment">-- this functionality</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">mkFunTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1470"></a><a name="mkFunTyCon"><a href="TyCon.html#mkFunTyCon"><span class="hs-identifier">mkFunTyCon</span></a></a><span> </span><a name="local-6989586621681719408"><a href="#local-6989586621681719408"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719409"><a href="#local-6989586621681719409"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719410"><a href="#local-6989586621681719410"><span class="hs-identifier">rep_nm</span></a></a><span>
</span><a name="line-1471"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1472"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719408"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1473"></a><span>        </span><span class="hs-identifier">tyConName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719408"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1474"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719409"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1475"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1476"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719409"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1477"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719409"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1478"></a><span>        </span><span class="hs-identifier">tcRepName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719410"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1479"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-comment">-- | This is the making of an algebraic 'TyCon'. Notably, you have to</span><span>
</span><a name="line-1482"></a><span class="hs-comment">-- pass in the generic (in the -XGenerics sense) information about the</span><span>
</span><a name="line-1483"></a><span class="hs-comment">-- type constructor - you can get hold of it easily (see Generics</span><span>
</span><a name="line-1484"></a><span class="hs-comment">-- module)</span><span>
</span><a name="line-1485"></a><span class="hs-identifier">mkAlgTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1486"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Binders of the 'TyCon'</span><span>
</span><a name="line-1487"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>              </span><span class="hs-comment">-- ^ Result kind</span><span>
</span><a name="line-1488"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span>            </span><span class="hs-comment">-- ^ The roles for each TyVar</span><span>
</span><a name="line-1489"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span>       </span><span class="hs-comment">-- ^ The C type this type corresponds to</span><span>
</span><a name="line-1490"></a><span>                                </span><span class="hs-comment">--   when using the CAPI FFI</span><span>
</span><a name="line-1491"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ Stupid theta: see 'algTcStupidTheta'</span><span>
</span><a name="line-1492"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span>       </span><span class="hs-comment">-- ^ Information about data constructors</span><span>
</span><a name="line-1493"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span>      </span><span class="hs-comment">-- ^ What flavour is it?</span><span>
</span><a name="line-1494"></a><span>                                </span><span class="hs-comment">-- (e.g. vanilla, type family)</span><span>
</span><a name="line-1495"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>              </span><span class="hs-comment">-- ^ Was the 'TyCon' declared with GADT syntax?</span><span>
</span><a name="line-1496"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1497"></a><a name="mkAlgTyCon"><a href="TyCon.html#mkAlgTyCon"><span class="hs-identifier">mkAlgTyCon</span></a></a><span> </span><a name="local-6989586621681719411"><a href="#local-6989586621681719411"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719412"><a href="#local-6989586621681719412"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719413"><a href="#local-6989586621681719413"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719414"><a href="#local-6989586621681719414"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719415"><a href="#local-6989586621681719415"><span class="hs-identifier">cType</span></a></a><span> </span><a name="local-6989586621681719416"><a href="#local-6989586621681719416"><span class="hs-identifier">stupid</span></a></a><span> </span><a name="local-6989586621681719417"><a href="#local-6989586621681719417"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621681719418"><a href="#local-6989586621681719418"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621681719419"><a href="#local-6989586621681719419"><span class="hs-identifier">gadt_syn</span></a></a><span>
</span><a name="line-1498"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1499"></a><span>        </span><span class="hs-identifier">tyConName</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719411"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1500"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719411"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1501"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719412"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1502"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719413"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1503"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719412"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719413"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1504"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719412"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1505"></a><span>        </span><span class="hs-identifier">tyConTyVars</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span> </span><a href="#local-6989586621681719412"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1506"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719414"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1507"></a><span>        </span><span class="hs-identifier">tyConCType</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719415"><span class="hs-identifier hs-var">cType</span></a><span class="hs-special">,</span><span>
</span><a name="line-1508"></a><span>        </span><span class="hs-identifier">algTcStupidTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719416"><span class="hs-identifier hs-var">stupid</span></a><span class="hs-special">,</span><span>
</span><a name="line-1509"></a><span>        </span><span class="hs-identifier">algTcRhs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719417"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1510"></a><span>        </span><span class="hs-identifier">algTcFields</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#fieldsOfAlgTcRhs"><span class="hs-identifier hs-var">fieldsOfAlgTcRhs</span></a><span> </span><a href="#local-6989586621681719417"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1511"></a><span>        </span><span class="hs-identifier">algTcParent</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">okParent</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="TyCon.html#okParent"><span class="hs-identifier hs-var">parent</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719411"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621681719418"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-special">)</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">parent</span></a><span class="hs-special">,</span><span>
</span><a name="line-1512"></a><span>        </span><span class="hs-identifier">algTcGadtSyntax</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719419"><span class="hs-identifier hs-var">gadt_syn</span></a><span>
</span><a name="line-1513"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1514"></a><span>
</span><a name="line-1515"></a><span class="hs-comment">-- | Simpler specialization of 'mkAlgTyCon' for classes</span><span>
</span><a name="line-1516"></a><span class="hs-identifier">mkClassTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1517"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>
</span><a name="line-1518"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1519"></a><a name="mkClassTyCon"><a href="TyCon.html#mkClassTyCon"><span class="hs-identifier">mkClassTyCon</span></a></a><span> </span><a name="local-6989586621681719420"><a href="#local-6989586621681719420"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719421"><a href="#local-6989586621681719421"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719422"><a href="#local-6989586621681719422"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719423"><a href="#local-6989586621681719423"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621681719424"><a href="#local-6989586621681719424"><span class="hs-identifier">clas</span></a></a><span> </span><a name="local-6989586621681719425"><a href="#local-6989586621681719425"><span class="hs-identifier">tc_rep_name</span></a></a><span>
</span><a name="line-1520"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkAlgTyCon"><span class="hs-identifier hs-var">mkAlgTyCon</span></a><span> </span><a href="#local-6989586621681719420"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681719421"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="TysWiredIn.html#constraintKind"><span class="hs-identifier hs-var">constraintKind</span></a><span> </span><a href="#local-6989586621681719422"><span class="hs-identifier hs-var">roles</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621681719423"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1521"></a><span>               </span><span class="hs-special">(</span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><a href="#local-6989586621681719424"><span class="hs-identifier hs-var">clas</span></a><span> </span><a href="#local-6989586621681719425"><span class="hs-identifier hs-var">tc_rep_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1522"></a><span>               </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1523"></a><span>
</span><a name="line-1524"></a><span class="hs-identifier">mkTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1525"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1526"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>    </span><span class="hs-comment">-- ^ Result kind of the 'TyCon'</span><span>
</span><a name="line-1527"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>   </span><span class="hs-comment">-- ^ Arity of the tuple 'TyCon'</span><span>
</span><a name="line-1528"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1529"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a><span>    </span><span class="hs-comment">-- ^ Whether the tuple is boxed or unboxed</span><span>
</span><a name="line-1530"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span>
</span><a name="line-1531"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1532"></a><a name="mkTupleTyCon"><a href="TyCon.html#mkTupleTyCon"><span class="hs-identifier">mkTupleTyCon</span></a></a><span> </span><a name="local-6989586621681719426"><a href="#local-6989586621681719426"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719427"><a href="#local-6989586621681719427"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719428"><a href="#local-6989586621681719428"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719429"><a href="#local-6989586621681719429"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621681719430"><a href="#local-6989586621681719430"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621681719431"><a href="#local-6989586621681719431"><span class="hs-identifier">sort</span></a></a><span> </span><a name="local-6989586621681719432"><a href="#local-6989586621681719432"><span class="hs-identifier">parent</span></a></a><span>
</span><a name="line-1533"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1534"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719426"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1535"></a><span>        </span><span class="hs-identifier">tyConName</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719426"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1536"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719427"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1537"></a><span>        </span><span class="hs-identifier">tyConTyVars</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span> </span><a href="#local-6989586621681719427"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1538"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719428"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1539"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719427"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719428"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1540"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719429"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">,</span><span>
</span><a name="line-1541"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621681719429"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">,</span><span>
</span><a name="line-1542"></a><span>        </span><span class="hs-identifier">tyConCType</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>
</span><a name="line-1543"></a><span>        </span><span class="hs-identifier">algTcGadtSyntax</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-1544"></a><span>        </span><span class="hs-identifier">algTcStupidTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1545"></a><span>        </span><span class="hs-identifier">algTcRhs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719430"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span>
</span><a name="line-1546"></a><span>                                        </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719431"><span class="hs-identifier hs-var">sort</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><a name="line-1547"></a><span>        </span><span class="hs-identifier">algTcFields</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#emptyDFsEnv"><span class="hs-identifier hs-var">emptyDFsEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-1548"></a><span>        </span><span class="hs-identifier">algTcParent</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719432"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-1549"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1550"></a><span>
</span><a name="line-1551"></a><span class="hs-identifier">mkSumTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1552"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1553"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>    </span><span class="hs-comment">-- ^ Kind of the resulting 'TyCon'</span><span>
</span><a name="line-1554"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>   </span><span class="hs-comment">-- ^ Arity of the sum</span><span>
</span><a name="line-1555"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ 'TyVar's scoped over: see 'tyConTyVars'</span><span>
</span><a name="line-1556"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-1557"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConFlav"><span class="hs-identifier hs-type">AlgTyConFlav</span></a><span>
</span><a name="line-1558"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1559"></a><a name="mkSumTyCon"><a href="TyCon.html#mkSumTyCon"><span class="hs-identifier">mkSumTyCon</span></a></a><span> </span><a name="local-6989586621681719433"><a href="#local-6989586621681719433"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719434"><a href="#local-6989586621681719434"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719435"><a href="#local-6989586621681719435"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719436"><a href="#local-6989586621681719436"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621681719437"><a href="#local-6989586621681719437"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-6989586621681719438"><a href="#local-6989586621681719438"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621681719439"><a href="#local-6989586621681719439"><span class="hs-identifier">parent</span></a></a><span>
</span><a name="line-1560"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1561"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719433"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1562"></a><span>        </span><span class="hs-identifier">tyConName</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719433"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1563"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719434"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1564"></a><span>        </span><span class="hs-identifier">tyConTyVars</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719437"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">,</span><span>
</span><a name="line-1565"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719435"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1566"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719434"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719435"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1567"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719436"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">,</span><span>
</span><a name="line-1568"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621681719436"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">,</span><span>
</span><a name="line-1569"></a><span>        </span><span class="hs-identifier">tyConCType</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>
</span><a name="line-1570"></a><span>        </span><span class="hs-identifier">algTcGadtSyntax</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-1571"></a><span>        </span><span class="hs-identifier">algTcStupidTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1572"></a><span>        </span><span class="hs-identifier">algTcRhs</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkSumTyConRhs"><span class="hs-identifier hs-var">mkSumTyConRhs</span></a><span> </span><a href="#local-6989586621681719438"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span>
</span><a name="line-1573"></a><span>        </span><span class="hs-identifier">algTcFields</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#emptyDFsEnv"><span class="hs-identifier hs-var">emptyDFsEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-1574"></a><span>        </span><span class="hs-identifier">algTcParent</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719439"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-1575"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1576"></a><span>
</span><a name="line-1577"></a><span class="hs-comment">-- | Makes a tycon suitable for use during type-checking. It stores</span><span>
</span><a name="line-1578"></a><span class="hs-comment">-- a variety of details about the definition of the TyCon, but no</span><span>
</span><a name="line-1579"></a><span class="hs-comment">-- right-hand side. It lives only during the type-checking of a</span><span>
</span><a name="line-1580"></a><span class="hs-comment">-- mutually-recursive group of tycons; it is then zonked to a proper</span><span>
</span><a name="line-1581"></a><span class="hs-comment">-- TyCon in zonkTcTyCon.</span><span>
</span><a name="line-1582"></a><span class="hs-comment">-- See also Note [Kind checking recursive type and class declarations]</span><span>
</span><a name="line-1583"></a><span class="hs-comment">-- in TcTyClsDecls.</span><span>
</span><a name="line-1584"></a><span class="hs-identifier">mkTcTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1585"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>                </span><span class="hs-comment">-- ^ user-written tycon tyvars</span><span>
</span><a name="line-1586"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1587"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>                </span><span class="hs-comment">-- ^ /result/ kind only</span><span>
</span><a name="line-1588"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><a href="Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ Scoped type variables;</span><span>
</span><a name="line-1589"></a><span>                                 </span><span class="hs-comment">-- see Note [How TcTyCons work] in TcTyClsDecls</span><span>
</span><a name="line-1590"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                </span><span class="hs-comment">-- ^ Is this TcTyCon generalised already?</span><span>
</span><a name="line-1591"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span>        </span><span class="hs-comment">-- ^ What sort of 'TyCon' this represents</span><span>
</span><a name="line-1592"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1593"></a><a name="mkTcTyCon"><a href="TyCon.html#mkTcTyCon"><span class="hs-identifier">mkTcTyCon</span></a></a><span> </span><a name="local-6989586621681719440"><a href="#local-6989586621681719440"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719441"><a href="#local-6989586621681719441"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-6989586621681719442"><a href="#local-6989586621681719442"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719443"><a href="#local-6989586621681719443"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719444"><a href="#local-6989586621681719444"><span class="hs-identifier">scoped_tvs</span></a></a><span> </span><a name="local-6989586621681719445"><a href="#local-6989586621681719445"><span class="hs-identifier">poly</span></a></a><span> </span><a name="local-6989586621681719446"><a href="#local-6989586621681719446"><span class="hs-identifier">flav</span></a></a><span>
</span><a name="line-1594"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tyConUnique</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719440"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1595"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719440"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1596"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConTyVars</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span> </span><a href="#local-6989586621681719442"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1597"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConBinders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719442"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1598"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConResKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719443"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1599"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConKind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719442"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719443"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1600"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConArity</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719442"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1601"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcTyConScopedTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719444"><span class="hs-identifier hs-var">scoped_tvs</span></a><span>
</span><a name="line-1602"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcTyConIsPoly</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719445"><span class="hs-identifier hs-var">poly</span></a><span>
</span><a name="line-1603"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcTyConFlavour</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719446"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-1604"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcTyConUserTyVars</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719441"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span class="hs-comment">-- | Create an unlifted primitive 'TyCon', such as @Int#@.</span><span>
</span><a name="line-1607"></a><span class="hs-identifier">mkPrimTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1608"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>   </span><span class="hs-comment">-- ^ /result/ kind, never levity-polymorphic</span><span>
</span><a name="line-1609"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1610"></a><a name="mkPrimTyCon"><a href="TyCon.html#mkPrimTyCon"><span class="hs-identifier">mkPrimTyCon</span></a></a><span> </span><a name="local-6989586621681719447"><a href="#local-6989586621681719447"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719448"><a href="#local-6989586621681719448"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719449"><a href="#local-6989586621681719449"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719450"><a href="#local-6989586621681719450"><span class="hs-identifier">roles</span></a></a><span>
</span><a name="line-1611"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkPrimTyCon%27"><span class="hs-identifier hs-var">mkPrimTyCon'</span></a><span> </span><a href="#local-6989586621681719447"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681719448"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719449"><span class="hs-identifier hs-var">res_kind</span></a><span> </span><a href="#local-6989586621681719450"><span class="hs-identifier hs-var">roles</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TyCon.html#mkPrelTyConRepName"><span class="hs-identifier hs-var">mkPrelTyConRepName</span></a><span> </span><a href="#local-6989586621681719447"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1612"></a><span>
</span><a name="line-1613"></a><span class="hs-comment">-- | Kind constructors</span><span>
</span><a name="line-1614"></a><span class="hs-identifier">mkKindTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1615"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>  </span><span class="hs-comment">-- ^ /result/ kind</span><span>
</span><a name="line-1616"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1617"></a><a name="mkKindTyCon"><a href="TyCon.html#mkKindTyCon"><span class="hs-identifier">mkKindTyCon</span></a></a><span> </span><a name="local-6989586621681719451"><a href="#local-6989586621681719451"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719452"><a href="#local-6989586621681719452"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719453"><a href="#local-6989586621681719453"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719454"><a href="#local-6989586621681719454"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719455"><a href="#local-6989586621681719455"><span class="hs-identifier">rep_nm</span></a></a><span>
</span><a name="line-1618"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719456"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1619"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1620"></a><span>    </span><a name="local-6989586621681719456"><a href="#local-6989586621681719456"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkPrimTyCon%27"><span class="hs-identifier hs-var">mkPrimTyCon'</span></a><span> </span><a href="#local-6989586621681719451"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681719452"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719453"><span class="hs-identifier hs-var">res_kind</span></a><span> </span><a href="#local-6989586621681719454"><span class="hs-identifier hs-var">roles</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719455"><span class="hs-identifier hs-var">rep_nm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1621"></a><span>
</span><a name="line-1622"></a><span class="hs-comment">-- | Create a lifted primitive 'TyCon' such as @RealWorld@</span><span>
</span><a name="line-1623"></a><span class="hs-identifier">mkLiftedPrimTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1624"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>   </span><span class="hs-comment">-- ^ /result/ kind</span><span>
</span><a name="line-1625"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1626"></a><a name="mkLiftedPrimTyCon"><a href="TyCon.html#mkLiftedPrimTyCon"><span class="hs-identifier">mkLiftedPrimTyCon</span></a></a><span> </span><a name="local-6989586621681719457"><a href="#local-6989586621681719457"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719458"><a href="#local-6989586621681719458"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719459"><a href="#local-6989586621681719459"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719460"><a href="#local-6989586621681719460"><span class="hs-identifier">roles</span></a></a><span>
</span><a name="line-1627"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkPrimTyCon%27"><span class="hs-identifier hs-var">mkPrimTyCon'</span></a><span> </span><a href="#local-6989586621681719457"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621681719458"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719459"><span class="hs-identifier hs-var">res_kind</span></a><span> </span><a href="#local-6989586621681719460"><span class="hs-identifier hs-var">roles</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719461"><span class="hs-identifier hs-var">rep_nm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1628"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621681719461"><a href="#local-6989586621681719461"><span class="hs-identifier">rep_nm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkPrelTyConRepName"><span class="hs-identifier hs-var">mkPrelTyConRepName</span></a><span> </span><a href="#local-6989586621681719457"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">mkPrimTyCon'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1631"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>    </span><span class="hs-comment">-- ^ /result/ kind, never levity-polymorphic</span><span>
</span><a name="line-1632"></a><span>                        </span><span class="hs-comment">-- (If you need a levity-polymorphic PrimTyCon, change</span><span>
</span><a name="line-1633"></a><span>                        </span><span class="hs-comment">--  isTcLevPoly.)</span><span>
</span><a name="line-1634"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span>
</span><a name="line-1635"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1636"></a><a name="mkPrimTyCon%27"><a href="TyCon.html#mkPrimTyCon%27"><span class="hs-identifier">mkPrimTyCon'</span></a></a><span> </span><a name="local-6989586621681719462"><a href="#local-6989586621681719462"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719463"><a href="#local-6989586621681719463"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719464"><a href="#local-6989586621681719464"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719465"><a href="#local-6989586621681719465"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719466"><a href="#local-6989586621681719466"><span class="hs-identifier">is_unlifted</span></a></a><span> </span><a name="local-6989586621681719467"><a href="#local-6989586621681719467"><span class="hs-identifier">rep_nm</span></a></a><span>
</span><a name="line-1637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1638"></a><span>        </span><span class="hs-identifier">tyConName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719462"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1639"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719462"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1640"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719463"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1641"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719464"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1642"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719463"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719464"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1643"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719465"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1644"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719465"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1645"></a><span>        </span><span class="hs-identifier">isUnlifted</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719466"><span class="hs-identifier hs-var">is_unlifted</span></a><span class="hs-special">,</span><span>
</span><a name="line-1646"></a><span>        </span><span class="hs-identifier">primRepName</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719467"><span class="hs-identifier hs-var">rep_nm</span></a><span>
</span><a name="line-1647"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span class="hs-comment">-- | Create a type synonym 'TyCon'</span><span>
</span><a name="line-1650"></a><span class="hs-identifier">mkSynonymTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>   </span><span class="hs-comment">-- ^ /result/ kind</span><span>
</span><a name="line-1651"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1652"></a><a name="mkSynonymTyCon"><a href="TyCon.html#mkSynonymTyCon"><span class="hs-identifier">mkSynonymTyCon</span></a></a><span> </span><a name="local-6989586621681719468"><a href="#local-6989586621681719468"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719469"><a href="#local-6989586621681719469"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719470"><a href="#local-6989586621681719470"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719471"><a href="#local-6989586621681719471"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719472"><a href="#local-6989586621681719472"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621681719473"><a href="#local-6989586621681719473"><span class="hs-identifier">is_tau</span></a></a><span> </span><a name="local-6989586621681719474"><a href="#local-6989586621681719474"><span class="hs-identifier">is_fam_free</span></a></a><span>
</span><a name="line-1653"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1654"></a><span>        </span><span class="hs-identifier">tyConName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719468"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1655"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719468"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1656"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719469"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1657"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719470"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1658"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719469"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719470"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1659"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719469"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1660"></a><span>        </span><span class="hs-identifier">tyConTyVars</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span> </span><a href="#local-6989586621681719469"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1661"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719471"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1662"></a><span>        </span><span class="hs-identifier">synTcRhs</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719472"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-1663"></a><span>        </span><span class="hs-identifier">synIsTau</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719473"><span class="hs-identifier hs-var">is_tau</span></a><span class="hs-special">,</span><span>
</span><a name="line-1664"></a><span>        </span><span class="hs-identifier">synIsFamFree</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719474"><span class="hs-identifier hs-var">is_fam_free</span></a><span>
</span><a name="line-1665"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1666"></a><span>
</span><a name="line-1667"></a><span class="hs-comment">-- | Create a type family 'TyCon'</span><span>
</span><a name="line-1668"></a><span class="hs-identifier">mkFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>  </span><span class="hs-comment">-- ^ /result/ kind</span><span>
</span><a name="line-1669"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span>
</span><a name="line-1670"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1671"></a><a name="mkFamilyTyCon"><a href="TyCon.html#mkFamilyTyCon"><span class="hs-identifier">mkFamilyTyCon</span></a></a><span> </span><a name="local-6989586621681719475"><a href="#local-6989586621681719475"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719476"><a href="#local-6989586621681719476"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719477"><a href="#local-6989586621681719477"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719478"><a href="#local-6989586621681719478"><span class="hs-identifier">resVar</span></a></a><span> </span><a name="local-6989586621681719479"><a href="#local-6989586621681719479"><span class="hs-identifier">flav</span></a></a><span> </span><a name="local-6989586621681719480"><a href="#local-6989586621681719480"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621681719481"><a href="#local-6989586621681719481"><span class="hs-identifier">inj</span></a></a><span>
</span><a name="line-1672"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span>
</span><a name="line-1673"></a><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tyConUnique</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719475"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1674"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719475"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1675"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConBinders</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719476"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1676"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConResKind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719477"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1677"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConKind</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719476"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719477"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1678"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConArity</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719476"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1679"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConTyVars</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span> </span><a href="#local-6989586621681719476"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1680"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">famTcResVar</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719478"><span class="hs-identifier hs-var">resVar</span></a><span>
</span><a name="line-1681"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">famTcFlav</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719479"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-1682"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">famTcParent</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">classTyCon</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621681719480"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-1683"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">famTcInj</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719481"><span class="hs-identifier hs-var">inj</span></a><span>
</span><a name="line-1684"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-1685"></a><span>
</span><a name="line-1686"></a><span>
</span><a name="line-1687"></a><span class="hs-comment">-- | Create a promoted data constructor 'TyCon'</span><span>
</span><a name="line-1688"></a><span class="hs-comment">-- Somewhat dodgily, we give it the same Name</span><span>
</span><a name="line-1689"></a><span class="hs-comment">-- as the data constructor itself; when we pretty-print</span><span>
</span><a name="line-1690"></a><span class="hs-comment">-- the TyCon we add a quote; see the Outputable TyCon instance</span><span>
</span><a name="line-1691"></a><span class="hs-identifier">mkPromotedDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConRepName"><span class="hs-identifier hs-type">TyConRepName</span></a><span>
</span><a name="line-1692"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConTyCoBinder"><span class="hs-identifier hs-type">TyConTyCoBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span>
</span><a name="line-1693"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier hs-type">RuntimeRepInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1694"></a><a name="mkPromotedDataCon"><a href="TyCon.html#mkPromotedDataCon"><span class="hs-identifier">mkPromotedDataCon</span></a></a><span> </span><a name="local-6989586621681719482"><a href="#local-6989586621681719482"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621681719483"><a href="#local-6989586621681719483"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681719484"><a href="#local-6989586621681719484"><span class="hs-identifier">rep_name</span></a></a><span> </span><a name="local-6989586621681719485"><a href="#local-6989586621681719485"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621681719486"><a href="#local-6989586621681719486"><span class="hs-identifier">res_kind</span></a></a><span> </span><a name="local-6989586621681719487"><a href="#local-6989586621681719487"><span class="hs-identifier">roles</span></a></a><span> </span><a name="local-6989586621681719488"><a href="#local-6989586621681719488"><span class="hs-identifier">rep_info</span></a></a><span>
</span><a name="line-1695"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1696"></a><span>        </span><span class="hs-identifier">tyConUnique</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span> </span><a href="#local-6989586621681719483"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1697"></a><span>        </span><span class="hs-identifier">tyConName</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719483"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1698"></a><span>        </span><span class="hs-identifier">tyConArity</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621681719487"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1699"></a><span>        </span><span class="hs-identifier">tcRoles</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719487"><span class="hs-identifier hs-var">roles</span></a><span class="hs-special">,</span><span>
</span><a name="line-1700"></a><span>        </span><span class="hs-identifier">tyConBinders</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719485"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">,</span><span>
</span><a name="line-1701"></a><span>        </span><span class="hs-identifier">tyConResKind</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719486"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1702"></a><span>        </span><span class="hs-identifier">tyConKind</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTyConKind"><span class="hs-identifier hs-var">mkTyConKind</span></a><span> </span><a href="#local-6989586621681719485"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621681719486"><span class="hs-identifier hs-var">res_kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-1703"></a><span>        </span><span class="hs-identifier">dataCon</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719482"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span>
</span><a name="line-1704"></a><span>        </span><span class="hs-identifier">tcRepName</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719484"><span class="hs-identifier hs-var">rep_name</span></a><span class="hs-special">,</span><span>
</span><a name="line-1705"></a><span>        </span><span class="hs-identifier">promDcRepInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719488"><span class="hs-identifier hs-var">rep_info</span></a><span>
</span><a name="line-1706"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-1707"></a><span>
</span><a name="line-1708"></a><span class="hs-identifier">isFunTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1709"></a><a name="isFunTyCon"><a href="TyCon.html#isFunTyCon"><span class="hs-identifier">isFunTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1710"></a><span class="hs-identifier">isFunTyCon</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1711"></a><span>
</span><a name="line-1712"></a><span class="hs-comment">-- | Test if the 'TyCon' is algebraic but abstract (invisible data constructors)</span><span>
</span><a name="line-1713"></a><span class="hs-identifier">isAbstractTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1714"></a><a name="isAbstractTyCon"><a href="TyCon.html#isAbstractTyCon"><span class="hs-identifier">isAbstractTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier hs-var">AbstractTyCon</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1715"></a><span class="hs-identifier">isAbstractTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1716"></a><span>
</span><a name="line-1717"></a><span class="hs-comment">-- | Make a fake, recovery 'TyCon' from an existing one.</span><span>
</span><a name="line-1718"></a><span class="hs-comment">-- Used when recovering from errors</span><span>
</span><a name="line-1719"></a><span class="hs-identifier">makeRecoveryTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1720"></a><a name="makeRecoveryTyCon"><a href="TyCon.html#makeRecoveryTyCon"><span class="hs-identifier">makeRecoveryTyCon</span></a></a><span> </span><a name="local-6989586621681719489"><a href="#local-6989586621681719489"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1721"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#mkTcTyCon"><span class="hs-identifier hs-var">mkTcTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621681719489"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1722"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">tyConBinders</span><span> </span><a href="#local-6989586621681719489"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConResKind</span><span> </span><a href="#local-6989586621681719489"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1723"></a><span>              </span><span class="hs-special">[</span><span class="hs-comment">{- no scoped vars -}</span><span class="hs-special">]</span><span>
</span><a name="line-1724"></a><span>              </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1725"></a><span>              </span><span class="hs-special">(</span><a href="TyCon.html#tyConFlavour"><span class="hs-identifier hs-var">tyConFlavour</span></a><span> </span><a href="#local-6989586621681719489"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1726"></a><span>
</span><a name="line-1727"></a><span class="hs-comment">-- | Does this 'TyCon' represent something that cannot be defined in Haskell?</span><span>
</span><a name="line-1728"></a><span class="hs-identifier">isPrimTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1729"></a><a name="isPrimTyCon"><a href="TyCon.html#isPrimTyCon"><span class="hs-identifier">isPrimTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1730"></a><span class="hs-identifier">isPrimTyCon</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1731"></a><span>
</span><a name="line-1732"></a><span class="hs-comment">-- | Is this 'TyCon' unlifted (i.e. cannot contain bottom)? Note that this can</span><span>
</span><a name="line-1733"></a><span class="hs-comment">-- only be true for primitive and unboxed-tuple 'TyCon's</span><span>
</span><a name="line-1734"></a><span class="hs-identifier">isUnliftedTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1735"></a><a name="isUnliftedTyCon"><a href="TyCon.html#isUnliftedTyCon"><span class="hs-identifier">isUnliftedTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span>  </span><span class="hs-special">{</span><span class="hs-identifier">isUnlifted</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719490"><a href="#local-6989586621681719490"><span class="hs-identifier">is_unlifted</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1736"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719490"><span class="hs-identifier hs-var">is_unlifted</span></a><span>
</span><a name="line-1737"></a><span class="hs-identifier">isUnliftedTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719491"><a href="#local-6989586621681719491"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1738"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719492"><a href="#local-6989586621681719492"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719491"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1739"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#tupleSortBoxity"><span class="hs-identifier hs-var">tupleSortBoxity</span></a><span> </span><a href="#local-6989586621681719492"><span class="hs-identifier hs-var">sort</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1740"></a><span class="hs-identifier">isUnliftedTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719493"><a href="#local-6989586621681719493"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1741"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719493"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1742"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1743"></a><span class="hs-identifier">isUnliftedTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1744"></a><span>
</span><a name="line-1745"></a><span class="hs-comment">-- | Returns @True@ if the supplied 'TyCon' resulted from either a</span><span>
</span><a name="line-1746"></a><span class="hs-comment">-- @data@ or @newtype@ declaration</span><span>
</span><a name="line-1747"></a><span class="hs-identifier">isAlgTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1748"></a><a name="isAlgTyCon"><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier">isAlgTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1749"></a><span class="hs-identifier">isAlgTyCon</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span class="hs-comment">-- | Returns @True@ for vanilla AlgTyCons -- that is, those created</span><span>
</span><a name="line-1752"></a><span class="hs-comment">-- with a @data@ or @newtype@ declaration.</span><span>
</span><a name="line-1753"></a><span class="hs-identifier">isVanillaAlgTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1754"></a><a name="isVanillaAlgTyCon"><a href="TyCon.html#isVanillaAlgTyCon"><span class="hs-identifier">isVanillaAlgTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#VanillaAlgTyCon"><span class="hs-identifier hs-var">VanillaAlgTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1755"></a><span class="hs-identifier">isVanillaAlgTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1756"></a><span>
</span><a name="line-1757"></a><span class="hs-identifier">isDataTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1758"></a><span class="hs-comment">-- ^ Returns @True@ for data types that are /definitely/ represented by</span><span>
</span><a name="line-1759"></a><span class="hs-comment">-- heap-allocated constructors.  These are scrutinised by Core-level</span><span>
</span><a name="line-1760"></a><span class="hs-comment">-- @case@ expressions, and they get info tables allocated for them.</span><span>
</span><a name="line-1761"></a><span class="hs-comment">--</span><span>
</span><a name="line-1762"></a><span class="hs-comment">-- Generally, the function will be true for all @data@ types and false</span><span>
</span><a name="line-1763"></a><span class="hs-comment">-- for @newtype@s, unboxed tuples, unboxed sums and type family</span><span>
</span><a name="line-1764"></a><span class="hs-comment">-- 'TyCon's. But it is not guaranteed to return @True@ in all cases</span><span>
</span><a name="line-1765"></a><span class="hs-comment">-- that it could.</span><span>
</span><a name="line-1766"></a><span class="hs-comment">--</span><span>
</span><a name="line-1767"></a><span class="hs-comment">-- NB: for a data type family, only the /instance/ 'TyCon's</span><span>
</span><a name="line-1768"></a><span class="hs-comment">--     get an info table.  The family declaration 'TyCon' does not</span><span>
</span><a name="line-1769"></a><a name="isDataTyCon"><a href="TyCon.html#isDataTyCon"><span class="hs-identifier">isDataTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719494"><a href="#local-6989586621681719494"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1770"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719494"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1771"></a><span>        </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719495"><a href="#local-6989586621681719495"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1772"></a><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#tupleSortBoxity"><span class="hs-identifier hs-var">tupleSortBoxity</span></a><span> </span><a href="#local-6989586621681719495"><span class="hs-identifier hs-var">sort</span></a><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><span>        </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1774"></a><span>        </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1775"></a><span>        </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1776"></a><span>        </span><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier hs-var">AbstractTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>      </span><span class="hs-comment">-- We don't know, so return False</span><span>
</span><a name="line-1777"></a><span class="hs-identifier">isDataTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1778"></a><span>
</span><a name="line-1779"></a><span class="hs-comment">-- | 'isInjectiveTyCon' is true of 'TyCon's for which this property holds</span><span>
</span><a name="line-1780"></a><span class="hs-comment">-- (where X is the role passed in):</span><span>
</span><a name="line-1781"></a><span class="hs-comment">--   If (T a1 b1 c1) ~X (T a2 b2 c2), then (a1 ~X1 a2), (b1 ~X2 b2), and (c1 ~X3 c2)</span><span>
</span><a name="line-1782"></a><span class="hs-comment">-- (where X1, X2, and X3, are the roles given by tyConRolesX tc X)</span><span>
</span><a name="line-1783"></a><span class="hs-comment">-- See also Note [Decomposing equality] in TcCanonical</span><span>
</span><a name="line-1784"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1785"></a><a name="isInjectiveTyCon"><a href="TyCon.html#isInjectiveTyCon"><span class="hs-identifier">isInjectiveTyCon</span></a></a><span> </span><span class="hs-identifier">_</span><span>                             </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1786"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                 </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1787"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                 </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1788"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719496"><a href="#local-6989586621681719496"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span>
</span><a name="line-1789"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isGenInjAlgRhs"><span class="hs-identifier hs-var">isGenInjAlgRhs</span></a><span> </span><a href="#local-6989586621681719496"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-1790"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1791"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1792"></a><span>                                               </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1793"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcInj</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#Injective"><span class="hs-identifier hs-var">Injective</span></a><span> </span><a name="local-6989586621681719497"><a href="#local-6989586621681719497"><span class="hs-identifier">inj</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><a href="#local-6989586621681719497"><span class="hs-identifier hs-var">inj</span></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1795"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1796"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1797"></a><span class="hs-identifier">isInjectiveTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1798"></a><span>  </span><span class="hs-comment">-- Reply True for TcTyCon to minimise knock on type errors</span><span>
</span><a name="line-1799"></a><span>  </span><span class="hs-comment">-- See Note [How TcTyCons work] item (1) in TcTyClsDecls</span><span>
</span><a name="line-1800"></a><span>
</span><a name="line-1801"></a><span class="hs-comment">-- | 'isGenerativeTyCon' is true of 'TyCon's for which this property holds</span><span>
</span><a name="line-1802"></a><span class="hs-comment">-- (where X is the role passed in):</span><span>
</span><a name="line-1803"></a><span class="hs-comment">--   If (T tys ~X t), then (t's head ~X T).</span><span>
</span><a name="line-1804"></a><span class="hs-comment">-- See also Note [Decomposing equality] in TcCanonical</span><span>
</span><a name="line-1805"></a><span class="hs-identifier">isGenerativeTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1806"></a><a name="isGenerativeTyCon"><a href="TyCon.html#isGenerativeTyCon"><span class="hs-identifier">isGenerativeTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1807"></a><span class="hs-identifier">isGenerativeTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1808"></a><span>  </span><span class="hs-comment">-- in all other cases, injectivity implies generativity</span><span>
</span><a name="line-1809"></a><span class="hs-identifier">isGenerativeTyCon</span><span> </span><a name="local-6989586621681719498"><a href="#local-6989586621681719498"><span class="hs-identifier">tc</span></a></a><span>               </span><a name="local-6989586621681719499"><a href="#local-6989586621681719499"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-var">isInjectiveTyCon</span></a><span> </span><a href="#local-6989586621681719498"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621681719499"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1810"></a><span>
</span><a name="line-1811"></a><span class="hs-comment">-- | Is this an 'AlgTyConRhs' of a 'TyCon' that is generative and injective</span><span>
</span><a name="line-1812"></a><span class="hs-comment">-- with respect to representational equality?</span><span>
</span><a name="line-1813"></a><span class="hs-identifier">isGenInjAlgRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1814"></a><a name="isGenInjAlgRhs"><a href="TyCon.html#isGenInjAlgRhs"><span class="hs-identifier">isGenInjAlgRhs</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1815"></a><span class="hs-identifier">isGenInjAlgRhs</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1816"></a><span class="hs-identifier">isGenInjAlgRhs</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1817"></a><span class="hs-identifier">isGenInjAlgRhs</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier hs-var">AbstractTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1818"></a><span class="hs-identifier">isGenInjAlgRhs</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1819"></a><span>
</span><a name="line-1820"></a><span class="hs-comment">-- | Is this 'TyCon' that for a @newtype@</span><span>
</span><a name="line-1821"></a><span class="hs-identifier">isNewTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1822"></a><a name="isNewTyCon"><a href="TyCon.html#isNewTyCon"><span class="hs-identifier">isNewTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1823"></a><span class="hs-identifier">isNewTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1824"></a><span>
</span><a name="line-1825"></a><span class="hs-comment">-- | Take a 'TyCon' apart into the 'TyVar's it scopes over, the 'Type' it</span><span>
</span><a name="line-1826"></a><span class="hs-comment">-- expands into, and (possibly) a coercion from the representation type to the</span><span>
</span><a name="line-1827"></a><span class="hs-comment">-- @newtype@.</span><span>
</span><a name="line-1828"></a><span class="hs-comment">-- Returns @Nothing@ if this is not possible.</span><span>
</span><a name="line-1829"></a><span class="hs-identifier">unwrapNewTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>
</span><a name="line-1830"></a><a name="unwrapNewTyCon_maybe"><a href="TyCon.html#unwrapNewTyCon_maybe"><span class="hs-identifier">unwrapNewTyCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tyConTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719500"><a href="#local-6989586621681719500"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1831"></a><span>                                 </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719501"><a href="#local-6989586621681719501"><span class="hs-identifier">co</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1832"></a><span>                                                       </span><span class="hs-identifier">nt_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719502"><a href="#local-6989586621681719502"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1833"></a><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719500"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719502"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719501"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1834"></a><span class="hs-identifier">unwrapNewTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1835"></a><span>
</span><a name="line-1836"></a><span class="hs-identifier">unwrapNewTyConEtad_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>
</span><a name="line-1837"></a><a name="unwrapNewTyConEtad_maybe"><a href="TyCon.html#unwrapNewTyConEtad_maybe"><span class="hs-identifier">unwrapNewTyConEtad_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719503"><a href="#local-6989586621681719503"><span class="hs-identifier">co</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1838"></a><span>                                                           </span><span class="hs-identifier">nt_etad_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a name="local-6989586621681719504"><a href="#local-6989586621681719504"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><a name="local-6989586621681719505"><a href="#local-6989586621681719505"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1839"></a><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719504"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719505"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719503"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1840"></a><span class="hs-identifier">unwrapNewTyConEtad_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1841"></a><span>
</span><a name="line-1842"></a><span class="hs-identifier">isProductTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1843"></a><span class="hs-comment">-- True of datatypes or newtypes that have</span><span>
</span><a name="line-1844"></a><span class="hs-comment">--   one, non-existential, data constructor</span><span>
</span><a name="line-1845"></a><span class="hs-comment">-- See Note [Product types]</span><span>
</span><a name="line-1846"></a><a name="isProductTyCon"><a href="TyCon.html#isProductTyCon"><span class="hs-identifier">isProductTyCon</span></a></a><span> </span><a name="local-6989586621681719506"><a href="#local-6989586621681719506"><span class="hs-identifier">tc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1847"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><a href="#local-6989586621681719506"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1848"></a><span>      </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1849"></a><span>      </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681719507"><a href="#local-6989586621681719507"><span class="hs-identifier">data_con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1850"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a><span> </span><a href="#local-6989586621681719507"><span class="hs-identifier hs-var">data_con</span></a><span class="hs-special">)</span><span>
</span><a name="line-1851"></a><span>      </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1852"></a><span>      </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1853"></a><span class="hs-identifier">isProductTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1854"></a><span>
</span><a name="line-1855"></a><span class="hs-identifier">isDataProductTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-1856"></a><span class="hs-comment">-- True of datatypes (not newtypes) with</span><span>
</span><a name="line-1857"></a><span class="hs-comment">--   one, vanilla, data constructor</span><span>
</span><a name="line-1858"></a><span class="hs-comment">-- See Note [Product types]</span><span>
</span><a name="line-1859"></a><a name="isDataProductTyCon_maybe"><a href="TyCon.html#isDataProductTyCon_maybe"><span class="hs-identifier">isDataProductTyCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719508"><a href="#local-6989586621681719508"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1860"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719508"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1861"></a><span>       </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681719509"><a href="#local-6989586621681719509"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1862"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a><span> </span><a href="#local-6989586621681719509"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- non-existential</span><span>
</span><a name="line-1863"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719509"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1864"></a><span>       </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719510"><a href="#local-6989586621681719510"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1865"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719510"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1866"></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1867"></a><span class="hs-identifier">isDataProductTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1868"></a><span>
</span><a name="line-1869"></a><span class="hs-identifier">isDataSumTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-1870"></a><a name="isDataSumTyCon_maybe"><a href="TyCon.html#isDataSumTyCon_maybe"><span class="hs-identifier">isDataSumTyCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719511"><a href="#local-6989586621681719511"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1871"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719511"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1872"></a><span>      </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719512"><a href="#local-6989586621681719512"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1873"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681719512"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1874"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719512"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-comment">-- FIXME(osa): Why do we need this?</span><span>
</span><a name="line-1875"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719512"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1876"></a><span>      </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719513"><a href="#local-6989586621681719513"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1877"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="DataCon.html#dataConExTyCoVars"><span class="hs-identifier hs-var">dataConExTyCoVars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719513"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-comment">-- FIXME(osa): Why do we need this?</span><span>
</span><a name="line-1878"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719513"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1879"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1880"></a><span class="hs-identifier">isDataSumTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1881"></a><span>
</span><a name="line-1882"></a><span class="hs-comment">{- Note [Product types]
~~~~~~~~~~~~~~~~~~~~~~~
A product type is
 * A data type (not a newtype)
 * With one, boxed data constructor
 * That binds no existential type variables

The main point is that product types are amenable to unboxing for
  * Strict function calls; we can transform
        f (D a b) = e
    to
        fw a b = e
    via the worker/wrapper transformation.  (Question: couldn't this
    work for existentials too?)

  * CPR for function results; we can transform
        f x y = let ... in D a b
    to
        fw x y = let ... in (# a, b #)

Note that the data constructor /can/ have evidence arguments: equality
constraints, type classes etc.  So it can be GADT.  These evidence
arguments are simply value arguments, and should not get in the way.
-}</span><span>
</span><a name="line-1906"></a><span>
</span><a name="line-1907"></a><span>
</span><a name="line-1908"></a><span class="hs-comment">-- | Is this a 'TyCon' representing a regular H98 type synonym (@type@)?</span><span>
</span><a name="line-1909"></a><span class="hs-identifier">isTypeSynonymTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1910"></a><a name="isTypeSynonymTyCon"><a href="TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier">isTypeSynonymTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1911"></a><span class="hs-identifier">isTypeSynonymTyCon</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1912"></a><span>
</span><a name="line-1913"></a><span class="hs-identifier">isTauTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1914"></a><a name="isTauTyCon"><a href="TyCon.html#isTauTyCon"><span class="hs-identifier">isTauTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">synIsTau</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719514"><a href="#local-6989586621681719514"><span class="hs-identifier">is_tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719514"><span class="hs-identifier hs-var">is_tau</span></a><span>
</span><a name="line-1915"></a><span class="hs-identifier">isTauTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1916"></a><span>
</span><a name="line-1917"></a><span class="hs-identifier">isFamFreeTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1918"></a><a name="isFamFreeTyCon"><a href="TyCon.html#isFamFreeTyCon"><span class="hs-identifier">isFamFreeTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">synIsFamFree</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719515"><a href="#local-6989586621681719515"><span class="hs-identifier">fam_free</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719515"><span class="hs-identifier hs-var">fam_free</span></a><span>
</span><a name="line-1919"></a><span class="hs-identifier">isFamFreeTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719516"><a href="#local-6989586621681719516"><span class="hs-identifier">flav</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isDataFamFlav"><span class="hs-identifier hs-var">isDataFamFlav</span></a><span> </span><a href="#local-6989586621681719516"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-1920"></a><span class="hs-identifier">isFamFreeTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1921"></a><span>
</span><a name="line-1922"></a><span class="hs-comment">-- As for newtypes, it is in some contexts important to distinguish between</span><span>
</span><a name="line-1923"></a><span class="hs-comment">-- closed synonyms and synonym families, as synonym families have no unique</span><span>
</span><a name="line-1924"></a><span class="hs-comment">-- right hand side to which a synonym family application can expand.</span><span>
</span><a name="line-1925"></a><span class="hs-comment">--</span><span>
</span><a name="line-1926"></a><span>
</span><a name="line-1927"></a><span class="hs-comment">-- | True iff we can decompose (T a b c) into ((T a b) c)</span><span>
</span><a name="line-1928"></a><span class="hs-comment">--   I.e. is it injective and generative w.r.t nominal equality?</span><span>
</span><a name="line-1929"></a><span class="hs-comment">--   That is, if (T a b) ~N d e f, is it always the case that</span><span>
</span><a name="line-1930"></a><span class="hs-comment">--            (T ~N d), (a ~N e) and (b ~N f)?</span><span>
</span><a name="line-1931"></a><span class="hs-comment">-- Specifically NOT true of synonyms (open and otherwise)</span><span>
</span><a name="line-1932"></a><span class="hs-comment">--</span><span>
</span><a name="line-1933"></a><span class="hs-comment">-- It'd be unusual to call mightBeUnsaturatedTyCon on a regular H98</span><span>
</span><a name="line-1934"></a><span class="hs-comment">-- type synonym, because you should probably have expanded it first</span><span>
</span><a name="line-1935"></a><span class="hs-comment">-- But regardless, it's not decomposable</span><span>
</span><a name="line-1936"></a><span class="hs-identifier">mightBeUnsaturatedTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1937"></a><a name="mightBeUnsaturatedTyCon"><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier">mightBeUnsaturatedTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tcFlavourCanBeUnsaturated"><span class="hs-identifier hs-var">tcFlavourCanBeUnsaturated</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="TyCon.html#tyConFlavour"><span class="hs-identifier hs-var">tyConFlavour</span></a><span>
</span><a name="line-1938"></a><span>
</span><a name="line-1939"></a><span class="hs-comment">-- | Is this an algebraic 'TyCon' declared with the GADT syntax?</span><span>
</span><a name="line-1940"></a><span class="hs-identifier">isGadtSyntaxTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1941"></a><a name="isGadtSyntaxTyCon"><a href="TyCon.html#isGadtSyntaxTyCon"><span class="hs-identifier">isGadtSyntaxTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcGadtSyntax</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719517"><a href="#local-6989586621681719517"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719517"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1942"></a><span class="hs-identifier">isGadtSyntaxTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1943"></a><span>
</span><a name="line-1944"></a><span class="hs-comment">-- | Is this an algebraic 'TyCon' which is just an enumeration of values?</span><span>
</span><a name="line-1945"></a><span class="hs-identifier">isEnumerationTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1946"></a><span class="hs-comment">-- See Note [Enumeration types] in TyCon</span><span>
</span><a name="line-1947"></a><a name="isEnumerationTyCon"><a href="TyCon.html#isEnumerationTyCon"><span class="hs-identifier">isEnumerationTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719518"><a href="#local-6989586621681719518"><span class="hs-identifier">arity</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719519"><a href="#local-6989586621681719519"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1948"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719519"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1949"></a><span>       </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">is_enum</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719520"><a href="#local-6989586621681719520"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719520"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1950"></a><span>       </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719518"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1951"></a><span>       </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1952"></a><span class="hs-identifier">isEnumerationTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1953"></a><span>
</span><a name="line-1954"></a><span class="hs-comment">-- | Is this a 'TyCon', synonym or otherwise, that defines a family?</span><span>
</span><a name="line-1955"></a><span class="hs-identifier">isFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1956"></a><a name="isFamilyTyCon"><a href="TyCon.html#isFamilyTyCon"><span class="hs-identifier">isFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1957"></a><span class="hs-identifier">isFamilyTyCon</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1958"></a><span>
</span><a name="line-1959"></a><span class="hs-comment">-- | Is this a 'TyCon', synonym or otherwise, that defines a family with</span><span>
</span><a name="line-1960"></a><span class="hs-comment">-- instances?</span><span>
</span><a name="line-1961"></a><span class="hs-identifier">isOpenFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1962"></a><a name="isOpenFamilyTyCon"><a href="TyCon.html#isOpenFamilyTyCon"><span class="hs-identifier">isOpenFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719521"><a href="#local-6989586621681719521"><span class="hs-identifier">flav</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1963"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#OpenSynFamilyTyCon"><span class="hs-identifier hs-var">OpenSynFamilyTyCon</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719521"><span class="hs-identifier hs-var">flav</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1964"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719521"><span class="hs-identifier hs-var">flav</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1965"></a><span class="hs-identifier">isOpenFamilyTyCon</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1966"></a><span>
</span><a name="line-1967"></a><span class="hs-comment">-- | Is this a synonym 'TyCon' that can have may have further instances appear?</span><span>
</span><a name="line-1968"></a><span class="hs-identifier">isTypeFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1969"></a><a name="isTypeFamilyTyCon"><a href="TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier">isTypeFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719522"><a href="#local-6989586621681719522"><span class="hs-identifier">flav</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isDataFamFlav"><span class="hs-identifier hs-var">isDataFamFlav</span></a><span> </span><a href="#local-6989586621681719522"><span class="hs-identifier hs-var">flav</span></a><span class="hs-special">)</span><span>
</span><a name="line-1970"></a><span class="hs-identifier">isTypeFamilyTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1971"></a><span>
</span><a name="line-1972"></a><span class="hs-comment">-- | Is this a synonym 'TyCon' that can have may have further instances appear?</span><span>
</span><a name="line-1973"></a><span class="hs-identifier">isDataFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1974"></a><a name="isDataFamilyTyCon"><a href="TyCon.html#isDataFamilyTyCon"><span class="hs-identifier">isDataFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719523"><a href="#local-6989586621681719523"><span class="hs-identifier">flav</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isDataFamFlav"><span class="hs-identifier hs-var">isDataFamFlav</span></a><span> </span><a href="#local-6989586621681719523"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-1975"></a><span class="hs-identifier">isDataFamilyTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1976"></a><span>
</span><a name="line-1977"></a><span class="hs-comment">-- | Is this an open type family TyCon?</span><span>
</span><a name="line-1978"></a><span class="hs-identifier">isOpenTypeFamilyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1979"></a><a name="isOpenTypeFamilyTyCon"><a href="TyCon.html#isOpenTypeFamilyTyCon"><span class="hs-identifier">isOpenTypeFamilyTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#OpenSynFamilyTyCon"><span class="hs-identifier hs-var">OpenSynFamilyTyCon</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1980"></a><span class="hs-identifier">isOpenTypeFamilyTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1981"></a><span>
</span><a name="line-1982"></a><span class="hs-comment">-- | Is this a non-empty closed type family? Returns 'Nothing' for</span><span>
</span><a name="line-1983"></a><span class="hs-comment">-- abstract or empty closed families.</span><span>
</span><a name="line-1984"></a><span class="hs-identifier">isClosedSynFamilyTyConWithAxiom_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a><span class="hs-special">)</span><span>
</span><a name="line-1985"></a><a name="isClosedSynFamilyTyConWithAxiom_maybe"><a href="TyCon.html#isClosedSynFamilyTyConWithAxiom_maybe"><span class="hs-identifier">isClosedSynFamilyTyConWithAxiom_maybe</span></a></a><span>
</span><a name="line-1986"></a><span>  </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#ClosedSynFamilyTyCon"><span class="hs-identifier hs-var">ClosedSynFamilyTyCon</span></a><span> </span><a name="local-6989586621681719524"><a href="#local-6989586621681719524"><span class="hs-identifier">mb</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719524"><span class="hs-identifier hs-var">mb</span></a><span>
</span><a name="line-1987"></a><span class="hs-identifier">isClosedSynFamilyTyConWithAxiom_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1988"></a><span>
</span><a name="line-1989"></a><span class="hs-comment">-- | @'tyConInjectivityInfo' tc@ returns @'Injective' is@ is @tc@ is an</span><span>
</span><a name="line-1990"></a><span class="hs-comment">-- injective tycon (where @is@ states for which 'tyConBinders' @tc@ is</span><span>
</span><a name="line-1991"></a><span class="hs-comment">-- injective), or 'NotInjective' otherwise.</span><span>
</span><a name="line-1992"></a><span class="hs-identifier">tyConInjectivityInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a><span>
</span><a name="line-1993"></a><a name="tyConInjectivityInfo"><a href="TyCon.html#tyConInjectivityInfo"><span class="hs-identifier">tyConInjectivityInfo</span></a></a><span> </span><a name="local-6989586621681719525"><a href="#local-6989586621681719525"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-1994"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcInj</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719526"><a href="#local-6989586621681719526"><span class="hs-identifier">inj</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719525"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1995"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719526"><span class="hs-identifier hs-var">inj</span></a><span>
</span><a name="line-1996"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-var">isInjectiveTyCon</span></a><span> </span><a href="#local-6989586621681719525"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-1997"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#Injective"><span class="hs-identifier hs-var">Injective</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621681719525"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1998"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1999"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NotInjective"><span class="hs-identifier hs-var">NotInjective</span></a><span>
</span><a name="line-2000"></a><span>
</span><a name="line-2001"></a><span class="hs-identifier">isBuiltInSynFamTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CoAxiom.html#BuiltInSynFamily"><span class="hs-identifier hs-type">BuiltInSynFamily</span></a><span>
</span><a name="line-2002"></a><a name="isBuiltInSynFamTyCon_maybe"><a href="TyCon.html#isBuiltInSynFamTyCon_maybe"><span class="hs-identifier">isBuiltInSynFamTyCon_maybe</span></a></a><span>
</span><a name="line-2003"></a><span>  </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#BuiltInSynFamTyCon"><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span></a><span> </span><a name="local-6989586621681719527"><a href="#local-6989586621681719527"><span class="hs-identifier">ops</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719527"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-2004"></a><span class="hs-identifier">isBuiltInSynFamTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2005"></a><span>
</span><a name="line-2006"></a><span class="hs-identifier">isDataFamFlav</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2007"></a><a name="isDataFamFlav"><a href="TyCon.html#isDataFamFlav"><span class="hs-identifier">isDataFamFlav</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Data family</span><span>
</span><a name="line-2008"></a><span class="hs-identifier">isDataFamFlav</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-comment">-- Type synonym family</span><span>
</span><a name="line-2009"></a><span>
</span><a name="line-2010"></a><span class="hs-comment">-- | Is this TyCon for an associated type?</span><span>
</span><a name="line-2011"></a><span class="hs-identifier">isTyConAssoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2012"></a><a name="isTyConAssoc"><a href="TyCon.html#isTyConAssoc"><span class="hs-identifier">isTyConAssoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="TyCon.html#tyConAssoc_maybe"><span class="hs-identifier hs-var">tyConAssoc_maybe</span></a><span>
</span><a name="line-2013"></a><span>
</span><a name="line-2014"></a><span class="hs-comment">-- | Get the enclosing class TyCon (if there is one) for the given TyCon.</span><span>
</span><a name="line-2015"></a><span class="hs-identifier">tyConAssoc_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-2016"></a><a name="tyConAssoc_maybe"><a href="TyCon.html#tyConAssoc_maybe"><span class="hs-identifier">tyConAssoc_maybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConFlavourAssoc_maybe"><span class="hs-identifier hs-var">tyConFlavourAssoc_maybe</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="TyCon.html#tyConFlavour"><span class="hs-identifier hs-var">tyConFlavour</span></a><span>
</span><a name="line-2017"></a><span>
</span><a name="line-2018"></a><span class="hs-comment">-- | Get the enclosing class TyCon (if there is one) for the given TyConFlavour</span><span>
</span><a name="line-2019"></a><span class="hs-identifier">tyConFlavourAssoc_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-2020"></a><a name="tyConFlavourAssoc_maybe"><a href="TyCon.html#tyConFlavourAssoc_maybe"><span class="hs-identifier">tyConFlavourAssoc_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span> </span><a name="local-6989586621681719528"><a href="#local-6989586621681719528"><span class="hs-identifier">mb_parent</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719528"><span class="hs-identifier hs-var">mb_parent</span></a><span>
</span><a name="line-2021"></a><span class="hs-identifier">tyConFlavourAssoc_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span> </span><a name="local-6989586621681719529"><a href="#local-6989586621681719529"><span class="hs-identifier">mb_parent</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719529"><span class="hs-identifier hs-var">mb_parent</span></a><span>
</span><a name="line-2022"></a><span class="hs-identifier">tyConFlavourAssoc_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span class="hs-comment">-- The unit tycon didn't used to be classed as a tuple tycon</span><span>
</span><a name="line-2025"></a><span class="hs-comment">-- but I thought that was silly so I've undone it</span><span>
</span><a name="line-2026"></a><span class="hs-comment">-- If it can't be for some reason, it should be a AlgTyCon</span><span>
</span><a name="line-2027"></a><span class="hs-identifier">isTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2028"></a><span class="hs-comment">-- ^ Does this 'TyCon' represent a tuple?</span><span>
</span><a name="line-2029"></a><span class="hs-comment">--</span><span>
</span><a name="line-2030"></a><span class="hs-comment">-- NB: when compiling @Data.Tuple@, the tycons won't reply @True@ to</span><span>
</span><a name="line-2031"></a><span class="hs-comment">-- 'isTupleTyCon', because they are built as 'AlgTyCons'.  However they</span><span>
</span><a name="line-2032"></a><span class="hs-comment">-- get spat into the interface file as tuple tycons, so I don't think</span><span>
</span><a name="line-2033"></a><span class="hs-comment">-- it matters.</span><span>
</span><a name="line-2034"></a><a name="isTupleTyCon"><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier">isTupleTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2035"></a><span class="hs-identifier">isTupleTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2036"></a><span>
</span><a name="line-2037"></a><span class="hs-identifier">tyConTuple_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="BasicTypes.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a><span>
</span><a name="line-2038"></a><a name="tyConTuple_maybe"><a href="TyCon.html#tyConTuple_maybe"><span class="hs-identifier">tyConTuple_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719530"><a href="#local-6989586621681719530"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2039"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719531"><a href="#local-6989586621681719531"><span class="hs-identifier">sort</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719530"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719531"><span class="hs-identifier hs-var">sort</span></a><span>
</span><a name="line-2040"></a><span class="hs-identifier">tyConTuple_maybe</span><span> </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2041"></a><span>
</span><a name="line-2042"></a><span class="hs-comment">-- | Is this the 'TyCon' for an unboxed tuple?</span><span>
</span><a name="line-2043"></a><span class="hs-identifier">isUnboxedTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2044"></a><a name="isUnboxedTupleTyCon"><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier">isUnboxedTupleTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719532"><a href="#local-6989586621681719532"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2045"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719533"><a href="#local-6989586621681719533"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719532"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2046"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#tupleSortBoxity"><span class="hs-identifier hs-var">tupleSortBoxity</span></a><span> </span><a href="#local-6989586621681719533"><span class="hs-identifier hs-var">sort</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2047"></a><span class="hs-identifier">isUnboxedTupleTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2048"></a><span>
</span><a name="line-2049"></a><span class="hs-comment">-- | Is this the 'TyCon' for a boxed tuple?</span><span>
</span><a name="line-2050"></a><span class="hs-identifier">isBoxedTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2051"></a><a name="isBoxedTupleTyCon"><a href="TyCon.html#isBoxedTupleTyCon"><span class="hs-identifier">isBoxedTupleTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719534"><a href="#local-6989586621681719534"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2052"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719535"><a href="#local-6989586621681719535"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719534"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2053"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#tupleSortBoxity"><span class="hs-identifier hs-var">tupleSortBoxity</span></a><span> </span><a href="#local-6989586621681719535"><span class="hs-identifier hs-var">sort</span></a><span class="hs-special">)</span><span>
</span><a name="line-2054"></a><span class="hs-identifier">isBoxedTupleTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2055"></a><span>
</span><a name="line-2056"></a><span class="hs-comment">-- | Is this the 'TyCon' for an unboxed sum?</span><span>
</span><a name="line-2057"></a><span class="hs-identifier">isUnboxedSumTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2058"></a><a name="isUnboxedSumTyCon"><a href="TyCon.html#isUnboxedSumTyCon"><span class="hs-identifier">isUnboxedSumTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719536"><a href="#local-6989586621681719536"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2059"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719536"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2060"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2061"></a><span class="hs-identifier">isUnboxedSumTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2062"></a><span>
</span><a name="line-2063"></a><span class="hs-comment">-- | Is this the 'TyCon' for a /promoted/ tuple?</span><span>
</span><a name="line-2064"></a><span class="hs-identifier">isPromotedTupleTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2065"></a><a name="isPromotedTupleTyCon"><a href="TyCon.html#isPromotedTupleTyCon"><span class="hs-identifier">isPromotedTupleTyCon</span></a></a><span> </span><a name="local-6989586621681719537"><a href="#local-6989586621681719537"><span class="hs-identifier">tyCon</span></a></a><span>
</span><a name="line-2066"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681719538"><a href="#local-6989586621681719538"><span class="hs-identifier">dataCon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#isPromotedDataCon_maybe"><span class="hs-identifier hs-var">isPromotedDataCon_maybe</span></a><span> </span><a href="#local-6989586621681719537"><span class="hs-identifier hs-var">tyCon</span></a><span>
</span><a name="line-2067"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-6989586621681719538"><span class="hs-identifier hs-var">dataCon</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2068"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2069"></a><span>
</span><a name="line-2070"></a><span class="hs-comment">-- | Is this a PromotedDataCon?</span><span>
</span><a name="line-2071"></a><span class="hs-identifier">isPromotedDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2072"></a><a name="isPromotedDataCon"><a href="TyCon.html#isPromotedDataCon"><span class="hs-identifier">isPromotedDataCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2073"></a><span class="hs-identifier">isPromotedDataCon</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span class="hs-comment">-- | Retrieves the promoted DataCon if this is a PromotedDataCon;</span><span>
</span><a name="line-2076"></a><span class="hs-identifier">isPromotedDataCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2077"></a><a name="isPromotedDataCon_maybe"><a href="TyCon.html#isPromotedDataCon_maybe"><span class="hs-identifier">isPromotedDataCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dataCon</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719539"><a href="#local-6989586621681719539"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719539"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-2078"></a><span class="hs-identifier">isPromotedDataCon_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2079"></a><span>
</span><a name="line-2080"></a><span class="hs-comment">-- | Is this tycon really meant for use at the kind level? That is,</span><span>
</span><a name="line-2081"></a><span class="hs-comment">-- should it be permitted without -XDataKinds?</span><span>
</span><a name="line-2082"></a><span class="hs-identifier">isKindTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2083"></a><a name="isKindTyCon"><a href="TyCon.html#isKindTyCon"><span class="hs-identifier">isKindTyCon</span></a></a><span> </span><a name="local-6989586621681719540"><a href="#local-6989586621681719540"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719540"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#elementOfUniqSet"><span class="hs-identifier hs-var">elementOfUniqSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCon.html#kindTyConKeys"><span class="hs-identifier hs-var">kindTyConKeys</span></a><span>
</span><a name="line-2084"></a><span>
</span><a name="line-2085"></a><span class="hs-comment">-- | These TyCons should be allowed at the kind level, even without</span><span>
</span><a name="line-2086"></a><span class="hs-comment">-- -XDataKinds.</span><span>
</span><a name="line-2087"></a><span class="hs-identifier">kindTyConKeys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UniqSet.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-2088"></a><a name="kindTyConKeys"><a href="TyCon.html#kindTyConKeys"><span class="hs-identifier">kindTyConKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#unionManyUniqSets"><span class="hs-identifier hs-var">unionManyUniqSets</span></a><span>
</span><a name="line-2089"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="UniqSet.html#mkUniqSet"><span class="hs-identifier hs-var">mkUniqSet</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="PrelNames.html#liftedTypeKindTyConKey"><span class="hs-identifier hs-var">liftedTypeKindTyConKey</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#constraintKindTyConKey"><span class="hs-identifier hs-var">constraintKindTyConKey</span></a><span class="hs-special">,</span><span> </span><a href="PrelNames.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2090"></a><span>  </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="UniqSet.html#mkUniqSet"><span class="hs-identifier hs-var">mkUniqSet</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621681719541"><span class="hs-identifier hs-var">tycon_with_datacons</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><a href="TysWiredIn.html#runtimeRepTyCon"><span class="hs-identifier hs-var">runtimeRepTyCon</span></a><span>
</span><a name="line-2091"></a><span>                                          </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#vecCountTyCon"><span class="hs-identifier hs-var">vecCountTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#vecElemTyCon"><span class="hs-identifier hs-var">vecElemTyCon</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2092"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2093"></a><span>    </span><a name="local-6989586621681719541"><a href="#local-6989586621681719541"><span class="hs-identifier">tycon_with_datacons</span></a></a><span> </span><a name="local-6989586621681719542"><a href="#local-6989586621681719542"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719542"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-6989586621681719542"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2094"></a><span>
</span><a name="line-2095"></a><span class="hs-identifier">isLiftedTypeKindTyConName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2096"></a><a name="isLiftedTypeKindTyConName"><a href="TyCon.html#isLiftedTypeKindTyConName"><span class="hs-identifier">isLiftedTypeKindTyConName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#liftedTypeKindTyConKey"><span class="hs-identifier hs-var">liftedTypeKindTyConKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-2097"></a><span>
</span><a name="line-2098"></a><span class="hs-comment">-- | Identifies implicit tycons that, in particular, do not go into interface</span><span>
</span><a name="line-2099"></a><span class="hs-comment">-- files (because they are implicitly reconstructed when the interface is</span><span>
</span><a name="line-2100"></a><span class="hs-comment">-- read).</span><span>
</span><a name="line-2101"></a><span class="hs-comment">--</span><span>
</span><a name="line-2102"></a><span class="hs-comment">-- Note that:</span><span>
</span><a name="line-2103"></a><span class="hs-comment">--</span><span>
</span><a name="line-2104"></a><span class="hs-comment">-- * Associated families are implicit, as they are re-constructed from</span><span>
</span><a name="line-2105"></a><span class="hs-comment">--   the class declaration in which they reside, and</span><span>
</span><a name="line-2106"></a><span class="hs-comment">--</span><span>
</span><a name="line-2107"></a><span class="hs-comment">-- * Family instances are /not/ implicit as they represent the instance body</span><span>
</span><a name="line-2108"></a><span class="hs-comment">--   (similar to a @dfun@ does that for a class instance).</span><span>
</span><a name="line-2109"></a><span class="hs-comment">--</span><span>
</span><a name="line-2110"></a><span class="hs-comment">-- * Tuples are implicit iff they have a wired-in name</span><span>
</span><a name="line-2111"></a><span class="hs-comment">--   (namely: boxed and unboxed tupeles are wired-in and implicit,</span><span>
</span><a name="line-2112"></a><span class="hs-comment">--            but constraint tuples are not)</span><span>
</span><a name="line-2113"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2114"></a><a name="isImplicitTyCon"><a href="TyCon.html#isImplicitTyCon"><span class="hs-identifier">isImplicitTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2115"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2116"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2117"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719543"><a href="#local-6989586621681719543"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719544"><a href="#local-6989586621681719544"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2118"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719543"><span class="hs-identifier hs-var">rhs</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a><span> </span><a href="#local-6989586621681719544"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-2119"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719543"><span class="hs-identifier hs-var">rhs</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2120"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2121"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719545"><a href="#local-6989586621681719545"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621681719545"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2122"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2123"></a><span class="hs-identifier">isImplicitTyCon</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2124"></a><span>
</span><a name="line-2125"></a><span class="hs-identifier">tyConCType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="ForeignCall.html#CType"><span class="hs-identifier hs-type">CType</span></a><span>
</span><a name="line-2126"></a><a name="tyConCType_maybe"><a href="TyCon.html#tyConCType_maybe"><span class="hs-identifier">tyConCType_maybe</span></a></a><span> </span><a name="local-6989586621681719546"><a href="#local-6989586621681719546"><span class="hs-identifier">tc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConCType</span><span> </span><a href="#local-6989586621681719546"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2127"></a><span class="hs-identifier">tyConCType_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2128"></a><span>
</span><a name="line-2129"></a><span class="hs-comment">-- | Is this a TcTyCon? (That is, one only used during type-checking?)</span><span>
</span><a name="line-2130"></a><span class="hs-identifier">isTcTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2131"></a><a name="isTcTyCon"><a href="TyCon.html#isTcTyCon"><span class="hs-identifier">isTcTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2132"></a><span class="hs-identifier">isTcTyCon</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2133"></a><span>
</span><a name="line-2134"></a><span class="hs-comment">-- | Could this TyCon ever be levity-polymorphic when fully applied?</span><span>
</span><a name="line-2135"></a><span class="hs-comment">-- True is safe. False means we're sure. Does only a quick check</span><span>
</span><a name="line-2136"></a><span class="hs-comment">-- based on the TyCon's category.</span><span>
</span><a name="line-2137"></a><span class="hs-comment">-- Precondition: The fully-applied TyCon has kind (TYPE blah)</span><span>
</span><a name="line-2138"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2139"></a><a name="isTcLevPoly"><a href="TyCon.html#isTcLevPoly"><span class="hs-identifier">isTcLevPoly</span></a></a><span> </span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2140"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#UnboxedAlgTyCon"><span class="hs-identifier hs-var">UnboxedAlgTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2141"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2142"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2143"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2144"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2145"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2146"></a><span class="hs-identifier">isTcLevPoly</span><span> </span><a name="local-6989586621681719547"><a href="#local-6989586621681719547"><span class="hs-identifier">tc</span></a></a><span class="hs-glyph">@</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;isTcLevPoly datacon&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719547"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2147"></a><span>
</span><a name="line-2148"></a><span class="hs-comment">{-
-----------------------------------------------
--      Expand type-constructor applications
-----------------------------------------------
-}</span><span>
</span><a name="line-2153"></a><span>
</span><a name="line-2154"></a><span class="hs-identifier">expandSynTyCon_maybe</span><span>
</span><a name="line-2155"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-2156"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681719321"><span class="hs-identifier hs-type">tyco</span></a><span class="hs-special">]</span><span>                 </span><span class="hs-comment">-- ^ Arguments to 'TyCon'</span><span>
</span><a name="line-2157"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><a href="#local-6989586621681719321"><span class="hs-identifier hs-type">tyco</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-2158"></a><span>                  </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span>
</span><a name="line-2159"></a><span>                  </span><span class="hs-special">[</span><a href="#local-6989586621681719321"><span class="hs-identifier hs-type">tyco</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- ^ Returns a 'TyVar' substitution, the body</span><span>
</span><a name="line-2160"></a><span>                                  </span><span class="hs-comment">-- type of the synonym (not yet substituted)</span><span>
</span><a name="line-2161"></a><span>                                  </span><span class="hs-comment">-- and any arguments remaining from the</span><span>
</span><a name="line-2162"></a><span>                                  </span><span class="hs-comment">-- application</span><span>
</span><a name="line-2163"></a><span>
</span><a name="line-2164"></a><span class="hs-comment">-- ^ Expand a type synonym application, if any</span><span>
</span><a name="line-2165"></a><a name="expandSynTyCon_maybe"><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier">expandSynTyCon_maybe</span></a></a><span> </span><a name="local-6989586621681719548"><a href="#local-6989586621681719548"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621681719549"><a href="#local-6989586621681719549"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-2166"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tyConTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719550"><a href="#local-6989586621681719550"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">synTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719551"><a href="#local-6989586621681719551"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719552"><a href="#local-6989586621681719552"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719548"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2167"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719549"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#listLengthCmp"><span class="hs-identifier hs-var">listLengthCmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681719552"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2168"></a><span>        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719550"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">zip</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681719549"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719551"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621681719552"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621681719549"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-2169"></a><span>        </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719550"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">zip</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681719549"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719551"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2170"></a><span>        </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2171"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-2172"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2173"></a><span>
</span><a name="line-2174"></a><span class="hs-comment">----------------</span><span>
</span><a name="line-2175"></a><span>
</span><a name="line-2176"></a><span class="hs-comment">-- | Check if the tycon actually refers to a proper `data` or `newtype`</span><span>
</span><a name="line-2177"></a><span class="hs-comment">--  with user defined constructors rather than one from a class or other</span><span>
</span><a name="line-2178"></a><span class="hs-comment">--  construction.</span><span>
</span><a name="line-2179"></a><span>
</span><a name="line-2180"></a><span class="hs-comment">-- NB: This is only used in TcRnExports.checkPatSynParent to determine if an</span><span>
</span><a name="line-2181"></a><span class="hs-comment">-- exported tycon can have a pattern synonym bundled with it, e.g.,</span><span>
</span><a name="line-2182"></a><span class="hs-comment">-- module Foo (TyCon(.., PatSyn)) where</span><span>
</span><a name="line-2183"></a><span class="hs-identifier">isTyConWithSrcDataCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2184"></a><a name="isTyConWithSrcDataCons"><a href="TyCon.html#isTyConWithSrcDataCons"><span class="hs-identifier">isTyConWithSrcDataCons</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719553"><a href="#local-6989586621681719553"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719554"><a href="#local-6989586621681719554"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2185"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719553"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2186"></a><span>    </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719555"><span class="hs-identifier hs-var">isSrcParent</span></a><span>
</span><a name="line-2187"></a><span>    </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719555"><span class="hs-identifier hs-var">isSrcParent</span></a><span>
</span><a name="line-2188"></a><span>    </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719555"><span class="hs-identifier hs-var">isSrcParent</span></a><span>
</span><a name="line-2189"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2190"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2191"></a><span>    </span><a name="local-6989586621681719555"><a href="#local-6989586621681719555"><span class="hs-identifier">isSrcParent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isNoParent"><span class="hs-identifier hs-var">isNoParent</span></a><span> </span><a href="#local-6989586621681719554"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2192"></a><span class="hs-identifier">isTyConWithSrcDataCons</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2193"></a><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- #14058</span><span>
</span><a name="line-2194"></a><span class="hs-identifier">isTyConWithSrcDataCons</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2195"></a><span>
</span><a name="line-2196"></a><span>
</span><a name="line-2197"></a><span class="hs-comment">-- | As 'tyConDataCons_maybe', but returns the empty list of constructors if no</span><span>
</span><a name="line-2198"></a><span class="hs-comment">-- constructors could be found</span><span>
</span><a name="line-2199"></a><span class="hs-identifier">tyConDataCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-2200"></a><span class="hs-comment">-- It's convenient for tyConDataCons to return the</span><span>
</span><a name="line-2201"></a><span class="hs-comment">-- empty list for type synonyms etc</span><span>
</span><a name="line-2202"></a><a name="tyConDataCons"><a href="TyCon.html#tyConDataCons"><span class="hs-identifier">tyConDataCons</span></a></a><span> </span><a name="local-6989586621681719556"><a href="#local-6989586621681719556"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConDataCons_maybe"><span class="hs-identifier hs-var">tyConDataCons_maybe</span></a><span> </span><a href="#local-6989586621681719556"><span class="hs-identifier hs-var">tycon</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2203"></a><span>
</span><a name="line-2204"></a><span class="hs-comment">-- | Determine the 'DataCon's originating from the given 'TyCon', if the 'TyCon'</span><span>
</span><a name="line-2205"></a><span class="hs-comment">-- is the sort that can have any constructors (note: this does not include</span><span>
</span><a name="line-2206"></a><span class="hs-comment">-- abstract algebraic types)</span><span>
</span><a name="line-2207"></a><span class="hs-identifier">tyConDataCons_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-2208"></a><a name="tyConDataCons_maybe"><a href="TyCon.html#tyConDataCons_maybe"><span class="hs-identifier">tyConDataCons_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719557"><a href="#local-6989586621681719557"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2209"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719557"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2210"></a><span>       </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719558"><a href="#local-6989586621681719558"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719558"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-2211"></a><span>       </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719559"><a href="#local-6989586621681719559"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681719559"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-2212"></a><span>       </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719560"><a href="#local-6989586621681719560"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621681719560"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-2213"></a><span>       </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719561"><a href="#local-6989586621681719561"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719561"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-2214"></a><span>       </span><span class="hs-identifier">_</span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2215"></a><span class="hs-identifier">tyConDataCons_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2216"></a><span>
</span><a name="line-2217"></a><span class="hs-comment">-- | If the given 'TyCon' has a /single/ data constructor, i.e. it is a @data@</span><span>
</span><a name="line-2218"></a><span class="hs-comment">-- type with one alternative, a tuple type or a @newtype@ then that constructor</span><span>
</span><a name="line-2219"></a><span class="hs-comment">-- is returned. If the 'TyCon' has more than one constructor, or represents a</span><span>
</span><a name="line-2220"></a><span class="hs-comment">-- primitive or function type constructor then @Nothing@ is returned. In any</span><span>
</span><a name="line-2221"></a><span class="hs-comment">-- other case, the function panics</span><span>
</span><a name="line-2222"></a><span class="hs-identifier">tyConSingleDataCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2223"></a><a name="tyConSingleDataCon_maybe"><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier">tyConSingleDataCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719562"><a href="#local-6989586621681719562"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2224"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719562"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2225"></a><span>      </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681719563"><a href="#local-6989586621681719563"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719563"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2226"></a><span>      </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719564"><a href="#local-6989586621681719564"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719564"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2227"></a><span>      </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719565"><a href="#local-6989586621681719565"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719565"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2228"></a><span>      </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2229"></a><span class="hs-identifier">tyConSingleDataCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2230"></a><span>
</span><a name="line-2231"></a><span class="hs-identifier">tyConSingleDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2232"></a><a name="tyConSingleDataCon"><a href="TyCon.html#tyConSingleDataCon"><span class="hs-identifier">tyConSingleDataCon</span></a></a><span> </span><a name="local-6989586621681719566"><a href="#local-6989586621681719566"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-2233"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConSingleDataCon_maybe"><span class="hs-identifier hs-var">tyConSingleDataCon_maybe</span></a><span> </span><a href="#local-6989586621681719566"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2234"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681719567"><a href="#local-6989586621681719567"><span class="hs-identifier">c</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719567"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2235"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConDataCon&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719566"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2236"></a><span>
</span><a name="line-2237"></a><span class="hs-identifier">tyConSingleAlgDataCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2238"></a><span class="hs-comment">-- Returns (Just con) for single-constructor</span><span>
</span><a name="line-2239"></a><span class="hs-comment">-- *algebraic* data types *not* newtypes</span><span>
</span><a name="line-2240"></a><a name="tyConSingleAlgDataCon_maybe"><a href="TyCon.html#tyConSingleAlgDataCon_maybe"><span class="hs-identifier">tyConSingleAlgDataCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719568"><a href="#local-6989586621681719568"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719568"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2242"></a><span>      </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621681719569"><a href="#local-6989586621681719569"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719569"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2243"></a><span>      </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719570"><a href="#local-6989586621681719570"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719570"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2244"></a><span>      </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2245"></a><span class="hs-identifier">tyConSingleAlgDataCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2246"></a><span>
</span><a name="line-2247"></a><span class="hs-comment">-- | Determine the number of value constructors a 'TyCon' has. Panics if the</span><span>
</span><a name="line-2248"></a><span class="hs-comment">-- 'TyCon' is not algebraic or a tuple</span><span>
</span><a name="line-2249"></a><span class="hs-identifier">tyConFamilySize</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2250"></a><a name="tyConFamilySize"><a href="TyCon.html#tyConFamilySize"><span class="hs-identifier">tyConFamilySize</span></a></a><span> </span><a name="local-6989586621681719571"><a href="#local-6989586621681719571"><span class="hs-identifier">tc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719572"><a href="#local-6989586621681719572"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2251"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719572"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2252"></a><span>      </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons_size</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719573"><a href="#local-6989586621681719573"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719573"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-2253"></a><span>      </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2254"></a><span>      </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2255"></a><span>      </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_cons_size</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719574"><a href="#local-6989586621681719574"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719574"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-2256"></a><span>      </span><span class="hs-identifier">_</span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConFamilySize 1&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719571"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2257"></a><span class="hs-identifier">tyConFamilySize</span><span> </span><a name="local-6989586621681719575"><a href="#local-6989586621681719575"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConFamilySize 2&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719575"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2258"></a><span>
</span><a name="line-2259"></a><span class="hs-comment">-- | Extract an 'AlgTyConRhs' with information about data constructors from an</span><span>
</span><a name="line-2260"></a><span class="hs-comment">-- algebraic or tuple 'TyCon'. Panics for any other sort of 'TyCon'</span><span>
</span><a name="line-2261"></a><span class="hs-identifier">algTyConRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AlgTyConRhs"><span class="hs-identifier hs-type">AlgTyConRhs</span></a><span>
</span><a name="line-2262"></a><a name="algTyConRhs"><a href="TyCon.html#algTyConRhs"><span class="hs-identifier">algTyConRhs</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719576"><a href="#local-6989586621681719576"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719576"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2263"></a><span class="hs-identifier">algTyConRhs</span><span> </span><a name="local-6989586621681719577"><a href="#local-6989586621681719577"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;algTyConRhs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719577"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-2264"></a><span>
</span><a name="line-2265"></a><span class="hs-comment">-- | Extract type variable naming the result of injective type family</span><span>
</span><a name="line-2266"></a><span class="hs-identifier">tyConFamilyResVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-2267"></a><a name="tyConFamilyResVar_maybe"><a href="TyCon.html#tyConFamilyResVar_maybe"><span class="hs-identifier">tyConFamilyResVar_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcResVar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719578"><a href="#local-6989586621681719578"><span class="hs-identifier">res</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719578"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-2268"></a><span class="hs-identifier">tyConFamilyResVar_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2269"></a><span>
</span><a name="line-2270"></a><span class="hs-comment">-- | Get the list of roles for the type parameters of a TyCon</span><span>
</span><a name="line-2271"></a><span class="hs-identifier">tyConRoles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">]</span><span>
</span><a name="line-2272"></a><span class="hs-comment">-- See also Note [TyCon Role signatures]</span><span>
</span><a name="line-2273"></a><a name="tyConRoles"><a href="TyCon.html#tyConRoles"><span class="hs-identifier">tyConRoles</span></a></a><span> </span><a name="local-6989586621681719579"><a href="#local-6989586621681719579"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-2274"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719579"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2275"></a><span>    </span><span class="hs-special">{</span><span> </span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">]</span><span>
</span><a name="line-2276"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719582"><a href="#local-6989586621681719582"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719582"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-2277"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719583"><a href="#local-6989586621681719583"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719583"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-2278"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719580"><span class="hs-identifier hs-var">const_role</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-2279"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719584"><a href="#local-6989586621681719584"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719584"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-2280"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcRoles</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719585"><a href="#local-6989586621681719585"><span class="hs-identifier">roles</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719585"><span class="hs-identifier hs-var">roles</span></a><span>
</span><a name="line-2281"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719580"><span class="hs-identifier hs-var">const_role</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-2282"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-2283"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2284"></a><span>    </span><a name="local-6989586621681719580"><a href="#local-6989586621681719580"><span class="hs-identifier">const_role</span></a></a><span> </span><a name="local-6989586621681719581"><a href="#local-6989586621681719581"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621681719579"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681719581"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-2285"></a><span>
</span><a name="line-2286"></a><span class="hs-comment">-- | Extract the bound type variables and type expansion of a type synonym</span><span>
</span><a name="line-2287"></a><span class="hs-comment">-- 'TyCon'. Panics if the 'TyCon' is not a synonym</span><span>
</span><a name="line-2288"></a><span class="hs-identifier">newTyConRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-2289"></a><a name="newTyConRhs"><a href="TyCon.html#newTyConRhs"><span class="hs-identifier">newTyConRhs</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">tyConTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719586"><a href="#local-6989586621681719586"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719587"><a href="#local-6989586621681719587"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2290"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719586"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719587"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2291"></a><span class="hs-identifier">newTyConRhs</span><span> </span><a name="local-6989586621681719588"><a href="#local-6989586621681719588"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;newTyConRhs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719588"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2292"></a><span>
</span><a name="line-2293"></a><span class="hs-comment">-- | The number of type parameters that need to be passed to a newtype to</span><span>
</span><a name="line-2294"></a><span class="hs-comment">-- resolve it. May be less than in the definition if it can be eta-contracted.</span><span>
</span><a name="line-2295"></a><span class="hs-identifier">newTyConEtadArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2296"></a><a name="newTyConEtadArity"><a href="TyCon.html#newTyConEtadArity"><span class="hs-identifier">newTyConEtadArity</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_etad_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719589"><a href="#local-6989586621681719589"><span class="hs-identifier">tvs_rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2297"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621681719589"><span class="hs-identifier hs-var">tvs_rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2298"></a><span class="hs-identifier">newTyConEtadArity</span><span> </span><a name="local-6989586621681719590"><a href="#local-6989586621681719590"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;newTyConEtadArity&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719590"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2299"></a><span>
</span><a name="line-2300"></a><span class="hs-comment">-- | Extract the bound type variables and type expansion of an eta-contracted</span><span>
</span><a name="line-2301"></a><span class="hs-comment">-- type synonym 'TyCon'.  Panics if the 'TyCon' is not a synonym</span><span>
</span><a name="line-2302"></a><span class="hs-identifier">newTyConEtadRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-2303"></a><a name="newTyConEtadRhs"><a href="TyCon.html#newTyConEtadRhs"><span class="hs-identifier">newTyConEtadRhs</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_etad_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719591"><a href="#local-6989586621681719591"><span class="hs-identifier">tvs_rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719591"><span class="hs-identifier hs-var">tvs_rhs</span></a><span>
</span><a name="line-2304"></a><span class="hs-identifier">newTyConEtadRhs</span><span> </span><a name="local-6989586621681719592"><a href="#local-6989586621681719592"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;newTyConEtadRhs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719592"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2305"></a><span>
</span><a name="line-2306"></a><span class="hs-comment">-- | Extracts the @newtype@ coercion from such a 'TyCon', which can be used to</span><span>
</span><a name="line-2307"></a><span class="hs-comment">-- construct something with the @newtype@s type from its representation type</span><span>
</span><a name="line-2308"></a><span class="hs-comment">-- (right hand side). If the supplied 'TyCon' is not a @newtype@, returns</span><span>
</span><a name="line-2309"></a><span class="hs-comment">-- @Nothing@</span><span>
</span><a name="line-2310"></a><span class="hs-identifier">newTyConCo_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>
</span><a name="line-2311"></a><a name="newTyConCo_maybe"><a href="TyCon.html#newTyConCo_maybe"><span class="hs-identifier">newTyConCo_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nt_co</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719593"><a href="#local-6989586621681719593"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719593"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2312"></a><span class="hs-identifier">newTyConCo_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2313"></a><span>
</span><a name="line-2314"></a><span class="hs-identifier">newTyConCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span>
</span><a name="line-2315"></a><a name="newTyConCo"><a href="TyCon.html#newTyConCo"><span class="hs-identifier">newTyConCo</span></a></a><span> </span><a name="local-6989586621681719594"><a href="#local-6989586621681719594"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#newTyConCo_maybe"><span class="hs-identifier hs-var">newTyConCo_maybe</span></a><span> </span><a href="#local-6989586621681719594"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2316"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681719595"><a href="#local-6989586621681719595"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681719595"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2317"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;newTyConCo&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719594"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2318"></a><span>
</span><a name="line-2319"></a><span class="hs-identifier">newTyConDataCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-2320"></a><a name="newTyConDataCon_maybe"><a href="TyCon.html#newTyConDataCon_maybe"><span class="hs-identifier">newTyConDataCon_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">data_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719596"><a href="#local-6989586621681719596"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719596"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-2321"></a><span class="hs-identifier">newTyConDataCon_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2322"></a><span>
</span><a name="line-2323"></a><span class="hs-comment">-- | Find the \&quot;stupid theta\&quot; of the 'TyCon'. A \&quot;stupid theta\&quot; is the context</span><span>
</span><a name="line-2324"></a><span class="hs-comment">-- to the left of an algebraic type declaration, e.g. @Eq a@ in the declaration</span><span>
</span><a name="line-2325"></a><span class="hs-comment">-- @data Eq a =&gt; T a ...@</span><span>
</span><a name="line-2326"></a><span class="hs-identifier">tyConStupidTheta</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">]</span><span>
</span><a name="line-2327"></a><a name="tyConStupidTheta"><a href="TyCon.html#tyConStupidTheta"><span class="hs-identifier">tyConStupidTheta</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcStupidTheta</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719597"><a href="#local-6989586621681719597"><span class="hs-identifier">stupid</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719597"><span class="hs-identifier hs-var">stupid</span></a><span>
</span><a name="line-2328"></a><span class="hs-identifier">tyConStupidTheta</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2329"></a><span class="hs-identifier">tyConStupidTheta</span><span> </span><a name="local-6989586621681719598"><a href="#local-6989586621681719598"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConStupidTheta&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681719598"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span>
</span><a name="line-2330"></a><span>
</span><a name="line-2331"></a><span class="hs-comment">-- | Extract the 'TyVar's bound by a vanilla type synonym</span><span>
</span><a name="line-2332"></a><span class="hs-comment">-- and the corresponding (unsubstituted) right hand side.</span><span>
</span><a name="line-2333"></a><span class="hs-identifier">synTyConDefn_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-2334"></a><a name="synTyConDefn_maybe"><a href="TyCon.html#synTyConDefn_maybe"><span class="hs-identifier">synTyConDefn_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">tyConTyVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719599"><a href="#local-6989586621681719599"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">synTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719600"><a href="#local-6989586621681719600"><span class="hs-identifier">ty</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2335"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719599"><span class="hs-identifier hs-var">tyvars</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719600"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2336"></a><span class="hs-identifier">synTyConDefn_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2337"></a><span>
</span><a name="line-2338"></a><span class="hs-comment">-- | Extract the information pertaining to the right hand side of a type synonym</span><span>
</span><a name="line-2339"></a><span class="hs-comment">-- (@type@) declaration.</span><span>
</span><a name="line-2340"></a><span class="hs-identifier">synTyConRhs_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-2341"></a><a name="synTyConRhs_maybe"><a href="TyCon.html#synTyConRhs_maybe"><span class="hs-identifier">synTyConRhs_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">synTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719601"><a href="#local-6989586621681719601"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719601"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-2342"></a><span class="hs-identifier">synTyConRhs_maybe</span><span> </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2343"></a><span>
</span><a name="line-2344"></a><span class="hs-comment">-- | Extract the flavour of a type family (with all the extra information that</span><span>
</span><a name="line-2345"></a><span class="hs-comment">-- it carries)</span><span>
</span><a name="line-2346"></a><span class="hs-identifier">famTyConFlav_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#FamTyConFlav"><span class="hs-identifier hs-type">FamTyConFlav</span></a><span>
</span><a name="line-2347"></a><a name="famTyConFlav_maybe"><a href="TyCon.html#famTyConFlav_maybe"><span class="hs-identifier">famTyConFlav_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719602"><a href="#local-6989586621681719602"><span class="hs-identifier">flav</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719602"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-2348"></a><span class="hs-identifier">famTyConFlav_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2349"></a><span>
</span><a name="line-2350"></a><span class="hs-comment">-- | Is this 'TyCon' that for a class instance?</span><span>
</span><a name="line-2351"></a><span class="hs-identifier">isClassTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2352"></a><a name="isClassTyCon"><a href="TyCon.html#isClassTyCon"><span class="hs-identifier">isClassTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2353"></a><span class="hs-identifier">isClassTyCon</span><span> </span><span class="hs-identifier">_</span><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2354"></a><span>
</span><a name="line-2355"></a><span class="hs-comment">-- | If this 'TyCon' is that for a class instance, return the class it is for.</span><span>
</span><a name="line-2356"></a><span class="hs-comment">-- Otherwise returns @Nothing@</span><span>
</span><a name="line-2357"></a><span class="hs-identifier">tyConClass_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span>
</span><a name="line-2358"></a><a name="tyConClass_maybe"><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier">tyConClass_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><a name="local-6989586621681719603"><a href="#local-6989586621681719603"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719603"><span class="hs-identifier hs-var">clas</span></a><span>
</span><a name="line-2359"></a><span class="hs-identifier">tyConClass_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2360"></a><span>
</span><a name="line-2361"></a><span class="hs-comment">-- | Return the associated types of the 'TyCon', if any</span><span>
</span><a name="line-2362"></a><span class="hs-identifier">tyConATs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-2363"></a><a name="tyConATs"><a href="TyCon.html#tyConATs"><span class="hs-identifier">tyConATs</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><a name="local-6989586621681719604"><a href="#local-6989586621681719604"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Class.html#classATs"><span class="hs-identifier hs-var">classATs</span></a><span> </span><a href="#local-6989586621681719604"><span class="hs-identifier hs-var">clas</span></a><span>
</span><a name="line-2364"></a><span class="hs-identifier">tyConATs</span><span> </span><span class="hs-identifier">_</span><span>                                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2365"></a><span>
</span><a name="line-2366"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-2367"></a><span class="hs-comment">-- | Is this 'TyCon' that for a data family instance?</span><span>
</span><a name="line-2368"></a><span class="hs-identifier">isFamInstTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2369"></a><a name="isFamInstTyCon"><a href="TyCon.html#isFamInstTyCon"><span class="hs-identifier">isFamInstTyCon</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2370"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2371"></a><span class="hs-identifier">isFamInstTyCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2372"></a><span>
</span><a name="line-2373"></a><span class="hs-identifier">tyConFamInstSig_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>
</span><a name="line-2374"></a><a name="tyConFamInstSig_maybe"><a href="TyCon.html#tyConFamInstSig_maybe"><span class="hs-identifier">tyConFamInstSig_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><a name="local-6989586621681719605"><a href="#local-6989586621681719605"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-6989586621681719606"><a href="#local-6989586621681719606"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681719607"><a href="#local-6989586621681719607"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2375"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719606"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719607"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719605"><span class="hs-identifier hs-var">ax</span></a><span class="hs-special">)</span><span>
</span><a name="line-2376"></a><span class="hs-identifier">tyConFamInstSig_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2377"></a><span>
</span><a name="line-2378"></a><span class="hs-comment">-- | If this 'TyCon' is that of a data family instance, return the family in question</span><span>
</span><a name="line-2379"></a><span class="hs-comment">-- and the instance types. Otherwise, return @Nothing@</span><span>
</span><a name="line-2380"></a><span class="hs-identifier">tyConFamInst_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2381"></a><a name="tyConFamInst_maybe"><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier">tyConFamInst_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681719608"><a href="#local-6989586621681719608"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621681719609"><a href="#local-6989586621681719609"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2382"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719608"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621681719609"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-2383"></a><span class="hs-identifier">tyConFamInst_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2384"></a><span>
</span><a name="line-2385"></a><span class="hs-comment">-- | If this 'TyCon' is that of a data family instance, return a 'TyCon' which</span><span>
</span><a name="line-2386"></a><span class="hs-comment">-- represents a coercion identifying the representation type with the type</span><span>
</span><a name="line-2387"></a><span class="hs-comment">-- instance family.  Otherwise, return @Nothing@</span><span>
</span><a name="line-2388"></a><span class="hs-identifier">tyConFamilyCoercion_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span class="hs-special">)</span><span>
</span><a name="line-2389"></a><a name="tyConFamilyCoercion_maybe"><a href="TyCon.html#tyConFamilyCoercion_maybe"><span class="hs-identifier">tyConFamilyCoercion_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#DataFamInstTyCon"><span class="hs-identifier hs-var">DataFamInstTyCon</span></a><span> </span><a name="local-6989586621681719610"><a href="#local-6989586621681719610"><span class="hs-identifier">ax</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2390"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681719610"><span class="hs-identifier hs-var">ax</span></a><span>
</span><a name="line-2391"></a><span class="hs-identifier">tyConFamilyCoercion_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2392"></a><span>
</span><a name="line-2393"></a><span class="hs-comment">-- | Extract any 'RuntimeRepInfo' from this TyCon</span><span>
</span><a name="line-2394"></a><span class="hs-identifier">tyConRuntimeRepInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#RuntimeRepInfo"><span class="hs-identifier hs-type">RuntimeRepInfo</span></a><span>
</span><a name="line-2395"></a><a name="tyConRuntimeRepInfo"><a href="TyCon.html#tyConRuntimeRepInfo"><span class="hs-identifier">tyConRuntimeRepInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">promDcRepInfo</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719611"><a href="#local-6989586621681719611"><span class="hs-identifier">rri</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719611"><span class="hs-identifier hs-var">rri</span></a><span>
</span><a name="line-2396"></a><span class="hs-identifier">tyConRuntimeRepInfo</span><span> </span><span class="hs-identifier">_</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#NoRRI"><span class="hs-identifier hs-var">NoRRI</span></a><span>
</span><a name="line-2397"></a><span>  </span><span class="hs-comment">-- could panic in that second case. But Douglas Adams told me not to.</span><span>
</span><a name="line-2398"></a><span>
</span><a name="line-2399"></a><span class="hs-comment">{-
Note [Constructor tag allocation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When typechecking we need to allocate constructor tags to constructors.
They are allocated based on the position in the data_cons field of TyCon,
with the first constructor getting fIRST_TAG.

We used to pay linear cost per constructor, with each constructor looking up
its relative index in the constructor list. That was quadratic and prohibitive
for large data types with more than 10k constructors.

The current strategy is to build a NameEnv with a mapping from costructor's
Name to ConTag and pass it down to buildDataCon for efficient lookup.

Relevant ticket: #14657
-}</span><span>
</span><a name="line-2415"></a><span>
</span><a name="line-2416"></a><span class="hs-identifier">mkTyConTagMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="BasicTypes.html#ConTag"><span class="hs-identifier hs-type">ConTag</span></a><span>
</span><a name="line-2417"></a><a name="mkTyConTagMap"><a href="TyCon.html#mkTyConTagMap"><span class="hs-identifier">mkTyConTagMap</span></a></a><span> </span><a name="local-6989586621681719612"><a href="#local-6989586621681719612"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2418"></a><span>  </span><a href="NameEnv.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-6989586621681719612"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">zip</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="BasicTypes.html#fIRST_TAG"><span class="hs-identifier hs-var">fIRST_TAG</span></a><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-2419"></a><span>  </span><span class="hs-comment">-- See Note [Constructor tag allocation]</span><span>
</span><a name="line-2420"></a><span>
</span><a name="line-2421"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[TyCon-instances]{Instance declarations for @TyCon@}
*                                                                      *
************************************************************************

@TyCon@s are compared by comparing their @Unique@s.
-}</span><span>
</span><a name="line-2430"></a><span>
</span><a name="line-2431"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2432"></a><span>    </span><a name="local-6989586621681719298"><a href="#local-6989586621681719298"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621681719299"><a href="#local-6989586621681719299"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719298"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719299"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2433"></a><span>    </span><a name="local-6989586621681719300"><a href="#local-6989586621681719300"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790494"><span class="hs-operator">/=</span></a><span> </span><a name="local-6989586621681719301"><a href="#local-6989586621681719301"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719300"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a><span> </span><a href="#local-6989586621681719301"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2434"></a><span>
</span><a name="line-2435"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2436"></a><span>    </span><a name="local-8214565720325051039"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><a name="local-6989586621681719297"><a href="#local-6989586621681719297"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConUnique</span><span> </span><a href="#local-6989586621681719297"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2437"></a><span>
</span><a name="line-2438"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2439"></a><span>  </span><span class="hs-comment">-- At the moment a promoted TyCon has the same Name as its</span><span>
</span><a name="line-2440"></a><span>  </span><span class="hs-comment">-- corresponding TyCon, so we add the quote to distinguish it here</span><span>
</span><a name="line-2441"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621681719294"><a href="#local-6989586621681719294"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#pprPromotionQuote"><span class="hs-identifier hs-var">pprPromotionQuote</span></a><span> </span><a href="#local-6989586621681719294"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621681719294"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621681719295"><span class="hs-identifier hs-var">pp_tc</span></a><span>
</span><a name="line-2442"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2443"></a><span>      </span><a name="local-6989586621681719295"><a href="#local-6989586621681719295"><span class="hs-identifier">pp_tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681719296"><a href="#local-6989586621681719296"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681719296"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Outputable.html#dumpStyle"><span class="hs-identifier hs-var">dumpStyle</span></a><span> </span><a href="#local-6989586621681719296"><span class="hs-identifier hs-var">sty</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a><span> </span><a href="#local-6989586621681719294"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-2444"></a><span>                                    </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[tc]&quot;</span><span>
</span><a name="line-2445"></a><span>                                    </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2446"></a><span>
</span><a name="line-2447"></a><span class="hs-comment">-- | Paints a picture of what a 'TyCon' represents, in broad strokes.</span><span>
</span><a name="line-2448"></a><span class="hs-comment">-- This is used towards more informative error messages.</span><span>
</span><a name="line-2449"></a><span class="hs-keyword">data</span><span> </span><a name="TyConFlavour"><a href="TyCon.html#TyConFlavour"><span class="hs-identifier">TyConFlavour</span></a></a><span>
</span><a name="line-2450"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ClassFlavour"><a href="TyCon.html#ClassFlavour"><span class="hs-identifier">ClassFlavour</span></a></a><span>
</span><a name="line-2451"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TupleFlavour"><a href="TyCon.html#TupleFlavour"><span class="hs-identifier">TupleFlavour</span></a></a><span> </span><a href="BasicTypes.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a><span>
</span><a name="line-2452"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SumFlavour"><a href="TyCon.html#SumFlavour"><span class="hs-identifier">SumFlavour</span></a></a><span>
</span><a name="line-2453"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DataTypeFlavour"><a href="TyCon.html#DataTypeFlavour"><span class="hs-identifier">DataTypeFlavour</span></a></a><span>
</span><a name="line-2454"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NewtypeFlavour"><a href="TyCon.html#NewtypeFlavour"><span class="hs-identifier">NewtypeFlavour</span></a></a><span>
</span><a name="line-2455"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AbstractTypeFlavour"><a href="TyCon.html#AbstractTypeFlavour"><span class="hs-identifier">AbstractTypeFlavour</span></a></a><span>
</span><a name="line-2456"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DataFamilyFlavour"><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier">DataFamilyFlavour</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Just tc &lt;=&gt; (tc == associated class)</span><span>
</span><a name="line-2457"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="OpenTypeFamilyFlavour"><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier">OpenTypeFamilyFlavour</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Just tc &lt;=&gt; (tc == associated class)</span><span>
</span><a name="line-2458"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClosedTypeFamilyFlavour"><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier">ClosedTypeFamilyFlavour</span></a></a><span>
</span><a name="line-2459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeSynonymFlavour"><a href="TyCon.html#TypeSynonymFlavour"><span class="hs-identifier">TypeSynonymFlavour</span></a></a><span>
</span><a name="line-2460"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BuiltInTypeFlavour"><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier">BuiltInTypeFlavour</span></a></a><span> </span><span class="hs-comment">-- ^ e.g., the @(-&gt;)@ 'TyCon'.</span><span>
</span><a name="line-2461"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PromotedDataConFlavour"><a href="TyCon.html#PromotedDataConFlavour"><span class="hs-identifier">PromotedDataConFlavour</span></a></a><span>
</span><a name="line-2462"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-2463"></a><span>
</span><a name="line-2464"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2465"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621681719292"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-2466"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2467"></a><span>      </span><a name="local-6989586621681719292"><a href="#local-6989586621681719292"><span class="hs-identifier">go</span></a></a><span> </span><a href="TyCon.html#ClassFlavour"><span class="hs-identifier hs-var">ClassFlavour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;class&quot;</span><span>
</span><a name="line-2468"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TupleFlavour"><span class="hs-identifier hs-var">TupleFlavour</span></a><span> </span><a name="local-6989586621681719293"><a href="#local-6989586621681719293"><span class="hs-identifier">boxed</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="BasicTypes.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span> </span><a href="#local-6989586621681719293"><span class="hs-identifier hs-var">boxed</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;tuple&quot;</span><span>
</span><a name="line-2469"></a><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;unboxed tuple&quot;</span><span>
</span><a name="line-2470"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#SumFlavour"><span class="hs-identifier hs-var">SumFlavour</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;unboxed sum&quot;</span><span>
</span><a name="line-2471"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#DataTypeFlavour"><span class="hs-identifier hs-var">DataTypeFlavour</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;data type&quot;</span><span>
</span><a name="line-2472"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#NewtypeFlavour"><span class="hs-identifier hs-var">NewtypeFlavour</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;newtype&quot;</span><span>
</span><a name="line-2473"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#AbstractTypeFlavour"><span class="hs-identifier hs-var">AbstractTypeFlavour</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;abstract type&quot;</span><span>
</span><a name="line-2474"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;associated data family&quot;</span><span>
</span><a name="line-2475"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;data family&quot;</span><span>
</span><a name="line-2476"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;associated type family&quot;</span><span>
</span><a name="line-2477"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;type family&quot;</span><span>
</span><a name="line-2478"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;type family&quot;</span><span>
</span><a name="line-2479"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#TypeSynonymFlavour"><span class="hs-identifier hs-var">TypeSynonymFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;type synonym&quot;</span><span>
</span><a name="line-2480"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier hs-var">BuiltInTypeFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;built-in type&quot;</span><span>
</span><a name="line-2481"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a href="TyCon.html#PromotedDataConFlavour"><span class="hs-identifier hs-var">PromotedDataConFlavour</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;promoted data constructor&quot;</span><span>
</span><a name="line-2482"></a><span>
</span><a name="line-2483"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span>
</span><a name="line-2484"></a><a name="tyConFlavour"><a href="TyCon.html#tyConFlavour"><span class="hs-identifier">tyConFlavour</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#AlgTyCon"><span class="hs-identifier hs-var">AlgTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">algTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719613"><a href="#local-6989586621681719613"><span class="hs-identifier">parent</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">algTcRhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719614"><a href="#local-6989586621681719614"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2485"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#ClassTyCon"><span class="hs-identifier hs-var">ClassTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681719613"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#ClassFlavour"><span class="hs-identifier hs-var">ClassFlavour</span></a><span>
</span><a name="line-2486"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719614"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2487"></a><span>                  </span><a href="TyCon.html#TupleTyCon"><span class="hs-identifier hs-var">TupleTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tup_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719615"><a href="#local-6989586621681719615"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2488"></a><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TupleFlavour"><span class="hs-identifier hs-var">TupleFlavour</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#tupleSortBoxity"><span class="hs-identifier hs-var">tupleSortBoxity</span></a><span> </span><a href="#local-6989586621681719615"><span class="hs-identifier hs-var">sort</span></a><span class="hs-special">)</span><span>
</span><a name="line-2489"></a><span>                  </span><a href="TyCon.html#SumTyCon"><span class="hs-identifier hs-var">SumTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#SumFlavour"><span class="hs-identifier hs-var">SumFlavour</span></a><span>
</span><a name="line-2490"></a><span>                  </span><a href="TyCon.html#DataTyCon"><span class="hs-identifier hs-var">DataTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#DataTypeFlavour"><span class="hs-identifier hs-var">DataTypeFlavour</span></a><span>
</span><a name="line-2491"></a><span>                  </span><a href="TyCon.html#NewTyCon"><span class="hs-identifier hs-var">NewTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#NewtypeFlavour"><span class="hs-identifier hs-var">NewtypeFlavour</span></a><span>
</span><a name="line-2492"></a><span>                  </span><a href="TyCon.html#AbstractTyCon"><span class="hs-identifier hs-var">AbstractTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#AbstractTypeFlavour"><span class="hs-identifier hs-var">AbstractTypeFlavour</span></a><span>
</span><a name="line-2493"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FamilyTyCon"><span class="hs-identifier hs-var">FamilyTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">famTcFlav</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719616"><a href="#local-6989586621681719616"><span class="hs-identifier">flav</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">famTcParent</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719617"><a href="#local-6989586621681719617"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2494"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719616"><span class="hs-identifier hs-var">flav</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2495"></a><span>      </span><a href="TyCon.html#DataFamilyTyCon"><span class="hs-identifier hs-var">DataFamilyTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span> </span><a href="#local-6989586621681719617"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2496"></a><span>      </span><a href="TyCon.html#OpenSynFamilyTyCon"><span class="hs-identifier hs-var">OpenSynFamilyTyCon</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span> </span><a href="#local-6989586621681719617"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-2497"></a><span>      </span><a href="TyCon.html#ClosedSynFamilyTyCon"><span class="hs-identifier hs-var">ClosedSynFamilyTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span>
</span><a name="line-2498"></a><span>      </span><a href="TyCon.html#AbstractClosedSynFamilyTyCon"><span class="hs-identifier hs-var">AbstractClosedSynFamilyTyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span>
</span><a name="line-2499"></a><span>      </span><a href="TyCon.html#BuiltInSynFamTyCon"><span class="hs-identifier hs-var">BuiltInSynFamTyCon</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span>
</span><a name="line-2500"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#SynonymTyCon"><span class="hs-identifier hs-var">SynonymTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#TypeSynonymFlavour"><span class="hs-identifier hs-var">TypeSynonymFlavour</span></a><span>
</span><a name="line-2501"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#FunTyCon"><span class="hs-identifier hs-var">FunTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier hs-var">BuiltInTypeFlavour</span></a><span>
</span><a name="line-2502"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PrimTyCon"><span class="hs-identifier hs-var">PrimTyCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier hs-var">BuiltInTypeFlavour</span></a><span>
</span><a name="line-2503"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#PromotedDataConFlavour"><span class="hs-identifier hs-var">PromotedDataConFlavour</span></a><span>
</span><a name="line-2504"></a><span class="hs-identifier">tyConFlavour</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TcTyCon"><span class="hs-identifier hs-var">TcTyCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcTyConFlavour</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681719618"><a href="#local-6989586621681719618"><span class="hs-identifier">flav</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681719618"><span class="hs-identifier hs-var">flav</span></a><span>
</span><a name="line-2505"></a><span>
</span><a name="line-2506"></a><span class="hs-comment">-- | Can this flavour of 'TyCon' appear unsaturated?</span><span>
</span><a name="line-2507"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2508"></a><a name="tcFlavourCanBeUnsaturated"><a href="TyCon.html#tcFlavourCanBeUnsaturated"><span class="hs-identifier">tcFlavourCanBeUnsaturated</span></a></a><span> </span><a href="TyCon.html#ClassFlavour"><span class="hs-identifier hs-var">ClassFlavour</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2509"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#DataTypeFlavour"><span class="hs-identifier hs-var">DataTypeFlavour</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2510"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#NewtypeFlavour"><span class="hs-identifier hs-var">NewtypeFlavour</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2511"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2512"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#TupleFlavour"><span class="hs-identifier hs-var">TupleFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2513"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#SumFlavour"><span class="hs-identifier hs-var">SumFlavour</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2514"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#AbstractTypeFlavour"><span class="hs-identifier hs-var">AbstractTypeFlavour</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2515"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier hs-var">BuiltInTypeFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2516"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#PromotedDataConFlavour"><span class="hs-identifier hs-var">PromotedDataConFlavour</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2517"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#TypeSynonymFlavour"><span class="hs-identifier hs-var">TypeSynonymFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2518"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2519"></a><span class="hs-identifier">tcFlavourCanBeUnsaturated</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2520"></a><span>
</span><a name="line-2521"></a><span class="hs-comment">-- | Is this flavour of 'TyCon' an open type family or a data family?</span><span>
</span><a name="line-2522"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyConFlavour"><span class="hs-identifier hs-type">TyConFlavour</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2523"></a><a name="tcFlavourIsOpen"><a href="TyCon.html#tcFlavourIsOpen"><span class="hs-identifier">tcFlavourIsOpen</span></a></a><span> </span><a href="TyCon.html#DataFamilyFlavour"><span class="hs-identifier hs-var">DataFamilyFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2524"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#OpenTypeFamilyFlavour"><span class="hs-identifier hs-var">OpenTypeFamilyFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2525"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#ClosedTypeFamilyFlavour"><span class="hs-identifier hs-var">ClosedTypeFamilyFlavour</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2526"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#ClassFlavour"><span class="hs-identifier hs-var">ClassFlavour</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2527"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#DataTypeFlavour"><span class="hs-identifier hs-var">DataTypeFlavour</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2528"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#NewtypeFlavour"><span class="hs-identifier hs-var">NewtypeFlavour</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2529"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#TupleFlavour"><span class="hs-identifier hs-var">TupleFlavour</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2530"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#SumFlavour"><span class="hs-identifier hs-var">SumFlavour</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2531"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#AbstractTypeFlavour"><span class="hs-identifier hs-var">AbstractTypeFlavour</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2532"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#BuiltInTypeFlavour"><span class="hs-identifier hs-var">BuiltInTypeFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2533"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#PromotedDataConFlavour"><span class="hs-identifier hs-var">PromotedDataConFlavour</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2534"></a><span class="hs-identifier">tcFlavourIsOpen</span><span> </span><a href="TyCon.html#TypeSynonymFlavour"><span class="hs-identifier hs-var">TypeSynonymFlavour</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2535"></a><span>
</span><a name="line-2536"></a><span class="hs-identifier">pprPromotionQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2537"></a><span class="hs-comment">-- Promoted data constructors already have a tick in their OccName</span><span>
</span><a name="line-2538"></a><a name="pprPromotionQuote"><a href="TyCon.html#pprPromotionQuote"><span class="hs-identifier">pprPromotionQuote</span></a></a><span> </span><a name="local-6989586621681719619"><a href="#local-6989586621681719619"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-2539"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719619"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2540"></a><span>      </span><a href="TyCon.html#PromotedDataCon"><span class="hs-identifier hs-var">PromotedDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\''</span><span> </span><span class="hs-comment">-- Always quote promoted DataCons in types</span><span>
</span><a name="line-2541"></a><span>      </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2542"></a><span>
</span><a name="line-2543"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2544"></a><span>    </span><a name="local-8214565720325933137"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span>
</span><a name="line-2545"></a><span>
</span><a name="line-2546"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2547"></a><span>    </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-2548"></a><span>    </span><a name="local-8214565720323786785"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;TyCon&quot;</span><span>
</span><a name="line-2549"></a><span>    </span><a name="local-8214565720323786786"><span class="hs-identifier">gunfold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-2550"></a><span>    </span><a name="local-8214565720323786784"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNoRepType</span><span> </span><span class="hs-string">&quot;TyCon&quot;</span><span>
</span><a name="line-2551"></a><span>
</span><a name="line-2552"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="TyCon.html#Injectivity"><span class="hs-identifier hs-type">Injectivity</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2553"></a><span>    </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621681719286"><a href="#local-6989586621681719286"><span class="hs-identifier">bh</span></a></a><span> </span><a href="TyCon.html#NotInjective"><span class="hs-identifier hs-var">NotInjective</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681719286"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2554"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621681719287"><a href="#local-6989586621681719287"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#Injective"><span class="hs-identifier hs-var">Injective</span></a><span> </span><a name="local-6989586621681719288"><a href="#local-6989586621681719288"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621681719287"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621681719287"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621681719288"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2555"></a><span>
</span><a name="line-2556"></a><span>    </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621681719289"><a href="#local-6989586621681719289"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681719290"><a href="#local-6989586621681719290"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-6989586621681719289"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-2557"></a><span>                </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681719290"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2558"></a><span>                    </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="TyCon.html#NotInjective"><span class="hs-identifier hs-var">NotInjective</span></a><span>
</span><a name="line-2559"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621681719291"><a href="#local-6989586621681719291"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621681719289"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-2560"></a><span>                            </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#Injective"><span class="hs-identifier hs-var">Injective</span></a><span> </span><a href="#local-6989586621681719291"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2561"></a><span>
</span><a name="line-2562"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
           Walking over recursive TyCons
*                                                                      *
************************************************************************

Note [Expanding newtypes and products]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When expanding a type to expose a data-type constructor, we need to be
careful about newtypes, lest we fall into an infinite loop. Here are
the key examples:

  newtype Id  x = MkId x
  newtype Fix f = MkFix (f (Fix f))
  newtype T     = MkT (T -&gt; T)

  Type           Expansion
 --------------------------
  T              T -&gt; T
  Fix Maybe      Maybe (Fix Maybe)
  Id (Id Int)    Int
  Fix Id         NO NO NO

Notice that
 * We can expand T, even though it's recursive.
 * We can expand Id (Id Int), even though the Id shows up
   twice at the outer level, because Id is non-recursive

So, when expanding, we keep track of when we've seen a recursive
newtype at outermost level; and bail out if we see it again.

We sometimes want to do the same for product types, so that the
strictness analyser doesn't unbox infinitely deeply.

More precisely, we keep a *count* of how many times we've seen it.
This is to account for
   data instance T (a,b) = MkT (T a) (T b)
Then (Trac #10482) if we have a type like
        T (Int,(Int,(Int,(Int,Int))))
we can still unbox deeply enough during strictness analysis.
We have to treat T as potentially recursive, but it's still
good to be able to unwrap multiple layers.

The function that manages all this is checkRecTc.
-}</span><span>
</span><a name="line-2608"></a><span>
</span><a name="line-2609"></a><span class="hs-keyword">data</span><span> </span><a name="RecTcChecker"><a href="TyCon.html#RecTcChecker"><span class="hs-identifier">RecTcChecker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RC"><a href="TyCon.html#RC"><span class="hs-identifier">RC</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">(</span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-2610"></a><span>  </span><span class="hs-comment">-- The upper bound, and the number of times</span><span>
</span><a name="line-2611"></a><span>  </span><span class="hs-comment">-- we have encountered each TyCon</span><span>
</span><a name="line-2612"></a><span>
</span><a name="line-2613"></a><span class="hs-comment">-- | Initialise a 'RecTcChecker' with 'defaultRecTcMaxBound'.</span><span>
</span><a name="line-2614"></a><span class="hs-identifier">initRecTc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span>
</span><a name="line-2615"></a><a name="initRecTc"><a href="TyCon.html#initRecTc"><span class="hs-identifier">initRecTc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="TyCon.html#defaultRecTcMaxBound"><span class="hs-identifier hs-var">defaultRecTcMaxBound</span></a><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2616"></a><span>
</span><a name="line-2617"></a><span class="hs-comment">-- | The default upper bound (100) for the number of times a 'RecTcChecker' is</span><span>
</span><a name="line-2618"></a><span class="hs-comment">-- allowed to encounter each 'TyCon'.</span><span>
</span><a name="line-2619"></a><span class="hs-identifier">defaultRecTcMaxBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2620"></a><a name="defaultRecTcMaxBound"><a href="TyCon.html#defaultRecTcMaxBound"><span class="hs-identifier">defaultRecTcMaxBound</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">100</span><span>
</span><a name="line-2621"></a><span class="hs-comment">-- Should we have a flag for this?</span><span>
</span><a name="line-2622"></a><span>
</span><a name="line-2623"></a><span class="hs-comment">-- | Change the upper bound for the number of times a 'RecTcChecker' is allowed</span><span>
</span><a name="line-2624"></a><span class="hs-comment">-- to encounter each 'TyCon'.</span><span>
</span><a name="line-2625"></a><span class="hs-identifier">setRecTcMaxBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span>
</span><a name="line-2626"></a><a name="setRecTcMaxBound"><a href="TyCon.html#setRecTcMaxBound"><span class="hs-identifier">setRecTcMaxBound</span></a></a><span> </span><a name="local-6989586621681719620"><a href="#local-6989586621681719620"><span class="hs-identifier">new_bound</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a name="local-6989586621681719621"><a href="#local-6989586621681719621"><span class="hs-identifier">_old_bound</span></a></a><span> </span><a name="local-6989586621681719622"><a href="#local-6989586621681719622"><span class="hs-identifier">rec_nts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="#local-6989586621681719620"><span class="hs-identifier hs-var">new_bound</span></a><span> </span><a href="#local-6989586621681719622"><span class="hs-identifier hs-var">rec_nts</span></a><span>
</span><a name="line-2627"></a><span>
</span><a name="line-2628"></a><span class="hs-identifier">checkRecTc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span>
</span><a name="line-2629"></a><span class="hs-comment">-- Nothing      =&gt; Recursion detected</span><span>
</span><a name="line-2630"></a><span class="hs-comment">-- Just rec_tcs =&gt; Keep going</span><span>
</span><a name="line-2631"></a><a name="checkRecTc"><a href="TyCon.html#checkRecTc"><span class="hs-identifier">checkRecTc</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a name="local-6989586621681719623"><a href="#local-6989586621681719623"><span class="hs-identifier">bound</span></a></a><span> </span><a name="local-6989586621681719624"><a href="#local-6989586621681719624"><span class="hs-identifier">rec_nts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621681719625"><a href="#local-6989586621681719625"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-2632"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="NameEnv.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a><span> </span><a href="#local-6989586621681719624"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-6989586621681719626"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2633"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681719627"><a href="#local-6989586621681719627"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621681719627"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621681719623"><span class="hs-identifier hs-var">bound</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2634"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="#local-6989586621681719623"><span class="hs-identifier hs-var">bound</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#extendNameEnv"><span class="hs-identifier hs-var">extendNameEnv</span></a><span> </span><a href="#local-6989586621681719624"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-6989586621681719626"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621681719627"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2635"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#RC"><span class="hs-identifier hs-var">RC</span></a><span> </span><a href="#local-6989586621681719623"><span class="hs-identifier hs-var">bound</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#extendNameEnv"><span class="hs-identifier hs-var">extendNameEnv</span></a><span> </span><a href="#local-6989586621681719624"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-6989586621681719626"><span class="hs-identifier hs-var">tc_name</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2636"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2637"></a><span>    </span><a name="local-6989586621681719626"><a href="#local-6989586621681719626"><span class="hs-identifier">tc_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621681719625"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2638"></a><span>
</span><a name="line-2639"></a><span class="hs-comment">-- | Returns whether or not this 'TyCon' is definite, or a hole</span><span>
</span><a name="line-2640"></a><span class="hs-comment">-- that may be filled in at some later point.  See Note [Skolem abstract data]</span><span>
</span><a name="line-2641"></a><span class="hs-identifier">tyConSkolem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2642"></a><a name="tyConSkolem"><a href="TyCon.html#tyConSkolem"><span class="hs-identifier">tyConSkolem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#isHoleName"><span class="hs-identifier hs-var">isHoleName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">tyConName</span><span>
</span><a name="line-2643"></a><span>
</span><a name="line-2644"></a><span class="hs-comment">-- Note [Skolem abstract data]</span><span>
</span><a name="line-2645"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-2646"></a><span class="hs-comment">-- Skolem abstract data arises from data declarations in an hsig file.</span><span>
</span><a name="line-2647"></a><span class="hs-comment">--</span><span>
</span><a name="line-2648"></a><span class="hs-comment">-- The best analogy is to interpret the types declared in signature files as</span><span>
</span><a name="line-2649"></a><span class="hs-comment">-- elaborating to universally quantified type variables; e.g.,</span><span>
</span><a name="line-2650"></a><span class="hs-comment">--</span><span>
</span><a name="line-2651"></a><span class="hs-comment">--    unit p where</span><span>
</span><a name="line-2652"></a><span class="hs-comment">--        signature H where</span><span>
</span><a name="line-2653"></a><span class="hs-comment">--            data T</span><span>
</span><a name="line-2654"></a><span class="hs-comment">--            data S</span><span>
</span><a name="line-2655"></a><span class="hs-comment">--        module M where</span><span>
</span><a name="line-2656"></a><span class="hs-comment">--            import H</span><span>
</span><a name="line-2657"></a><span class="hs-comment">--            f :: (T ~ S) =&gt; a -&gt; b</span><span>
</span><a name="line-2658"></a><span class="hs-comment">--            f x = x</span><span>
</span><a name="line-2659"></a><span class="hs-comment">--</span><span>
</span><a name="line-2660"></a><span class="hs-comment">-- elaborates as (with some fake structural types):</span><span>
</span><a name="line-2661"></a><span class="hs-comment">--</span><span>
</span><a name="line-2662"></a><span class="hs-comment">--    p :: forall t s. { f :: forall a b. t ~ s =&gt; a -&gt; b }</span><span>
</span><a name="line-2663"></a><span class="hs-comment">--    p = { f = \x -&gt; x } -- ill-typed</span><span>
</span><a name="line-2664"></a><span class="hs-comment">--</span><span>
</span><a name="line-2665"></a><span class="hs-comment">-- It is clear that inside p, t ~ s is not provable (and</span><span>
</span><a name="line-2666"></a><span class="hs-comment">-- if we tried to write a function to cast t to s, that</span><span>
</span><a name="line-2667"></a><span class="hs-comment">-- would not work), but if we call p @Int @Int, clearly Int ~ Int</span><span>
</span><a name="line-2668"></a><span class="hs-comment">-- is provable.  The skolem variables are all distinct from</span><span>
</span><a name="line-2669"></a><span class="hs-comment">-- one another, but we can't make assumptions like &quot;f is</span><span>
</span><a name="line-2670"></a><span class="hs-comment">-- inaccessible&quot;, because the skolem variables will get</span><span>
</span><a name="line-2671"></a><span class="hs-comment">-- instantiated eventually!</span><span>
</span><a name="line-2672"></a><span class="hs-comment">--</span><span>
</span><a name="line-2673"></a><span class="hs-comment">-- Skolem abstractness can apply to &quot;non-abstract&quot; data as well):</span><span>
</span><a name="line-2674"></a><span class="hs-comment">--</span><span>
</span><a name="line-2675"></a><span class="hs-comment">--    unit p where</span><span>
</span><a name="line-2676"></a><span class="hs-comment">--        signature H1 where</span><span>
</span><a name="line-2677"></a><span class="hs-comment">--            data T = MkT</span><span>
</span><a name="line-2678"></a><span class="hs-comment">--        signature H2 where</span><span>
</span><a name="line-2679"></a><span class="hs-comment">--            data T = MkT</span><span>
</span><a name="line-2680"></a><span class="hs-comment">--        module M where</span><span>
</span><a name="line-2681"></a><span class="hs-comment">--            import qualified H1</span><span>
</span><a name="line-2682"></a><span class="hs-comment">--            import qualified H2</span><span>
</span><a name="line-2683"></a><span class="hs-comment">--            f :: (H1.T ~ H2.T) =&gt; a -&gt; b</span><span>
</span><a name="line-2684"></a><span class="hs-comment">--            f x = x</span><span>
</span><a name="line-2685"></a><span class="hs-comment">--</span><span>
</span><a name="line-2686"></a><span class="hs-comment">-- This is why the test is on the original name of the TyCon,</span><span>
</span><a name="line-2687"></a><span class="hs-comment">-- not whether it is abstract or not.</span><span>
</span><a name="line-2688"></a></pre></body></html>