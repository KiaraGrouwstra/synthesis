<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

\section[Name]{@Name@: to transmit name info from renamer to typechecker}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- #name_types#</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- GHC uses several kinds of name internally:</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- * 'OccName.OccName': see &quot;OccName#name_types&quot;</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- * 'RdrName.RdrName': see &quot;RdrName#name_types&quot;</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- *  'Name.Name' is the type of names that have had their scoping and binding resolved. They</span><span>
</span><a name="line-22"></a><span class="hs-comment">--   have an 'OccName.OccName' but also a 'Unique.Unique' that disambiguates Names that have</span><span>
</span><a name="line-23"></a><span class="hs-comment">--   the same 'OccName.OccName' and indeed is used for all 'Name.Name' comparison. Names</span><span>
</span><a name="line-24"></a><span class="hs-comment">--   also contain information about where they originated from, see &quot;Name#name_sorts&quot;</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- * 'Id.Id': see &quot;Id#name_types&quot;</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- * 'Var.Var': see &quot;Var#name_types&quot;</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- #name_sorts#</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- Names are one of:</span><span>
</span><a name="line-32"></a><span class="hs-comment">--</span><span>
</span><a name="line-33"></a><span class="hs-comment">--  * External, if they name things declared in other modules. Some external</span><span>
</span><a name="line-34"></a><span class="hs-comment">--    Names are wired in, i.e. they name primitives defined in the compiler itself</span><span>
</span><a name="line-35"></a><span class="hs-comment">--</span><span>
</span><a name="line-36"></a><span class="hs-comment">--  * Internal, if they name things in the module being compiled. Some internal</span><span>
</span><a name="line-37"></a><span class="hs-comment">--    Names are system names, if they are names manufactured by the compiler</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-40"></a><span>        </span><span class="hs-comment">-- * The main types</span><span>
</span><a name="line-41"></a><span>        </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span>                                   </span><span class="hs-comment">-- Abstract</span><span>
</span><a name="line-42"></a><span>        </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-type">BuiltInSyntax</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span>        </span><span class="hs-comment">-- ** Creating 'Name's</span><span>
</span><a name="line-45"></a><span>        </span><a href="Name.html#mkSystemName"><span class="hs-identifier hs-var">mkSystemName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#mkSystemNameAt"><span class="hs-identifier hs-var">mkSystemNameAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#mkClonedInternalName"><span class="hs-identifier hs-var">mkClonedInternalName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#mkDerivedInternalName"><span class="hs-identifier hs-var">mkDerivedInternalName</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>        </span><a href="Name.html#mkSystemVarName"><span class="hs-identifier hs-var">mkSystemVarName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#mkSysTvName"><span class="hs-identifier hs-var">mkSysTvName</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>        </span><a href="Name.html#mkFCallName"><span class="hs-identifier hs-var">mkFCallName</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#mkWiredInName"><span class="hs-identifier hs-var">mkWiredInName</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>        </span><span class="hs-comment">-- ** Manipulating and deconstructing 'Name's</span><span>
</span><a name="line-52"></a><span>        </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#setNameUnique"><span class="hs-identifier hs-var">setNameUnique</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>        </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>        </span><a href="Name.html#setNameLoc"><span class="hs-identifier hs-var">setNameLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>        </span><a href="Name.html#tidyNameOcc"><span class="hs-identifier hs-var">tidyNameOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>        </span><a href="Name.html#localiseName"><span class="hs-identifier hs-var">localiseName</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#pprNameDefnLoc"><span class="hs-identifier hs-var">pprNameDefnLoc</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#pprDefinedAt"><span class="hs-identifier hs-var">pprDefinedAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>        </span><span class="hs-comment">-- ** Predicates on 'Name's</span><span>
</span><a name="line-61"></a><span>        </span><a href="Name.html#isSystemName"><span class="hs-identifier hs-var">isSystemName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isInternalName"><span class="hs-identifier hs-var">isInternalName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="Name.html#isTyVarName"><span class="hs-identifier hs-var">isTyVarName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isTyConName"><span class="hs-identifier hs-var">isTyConName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isDataConName"><span class="hs-identifier hs-var">isDataConName</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>        </span><a href="Name.html#isValName"><span class="hs-identifier hs-var">isValName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isVarName"><span class="hs-identifier hs-var">isVarName</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>        </span><a href="Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#isBuiltInSyntax"><span class="hs-identifier hs-var">isBuiltInSyntax</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>        </span><a href="Name.html#isHoleName"><span class="hs-identifier hs-var">isHoleName</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>        </span><a href="Name.html#wiredInNameTyThing_maybe"><span class="hs-identifier hs-var">wiredInNameTyThing_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>        </span><a href="Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameIsHomePackage"><span class="hs-identifier hs-var">nameIsHomePackage</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>        </span><a href="Name.html#nameIsHomePackageImport"><span class="hs-identifier hs-var">nameIsHomePackageImport</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#nameIsFromExternalPackage"><span class="hs-identifier hs-var">nameIsFromExternalPackage</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>        </span><a href="Name.html#stableNameCmp"><span class="hs-identifier hs-var">stableNameCmp</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>        </span><span class="hs-comment">-- * Class 'NamedThing' and overloaded friends</span><span>
</span><a name="line-72"></a><span>        </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>        </span><a href="Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#getOccString"><span class="hs-identifier hs-var">getOccString</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#getOccFS"><span class="hs-identifier hs-var">getOccFS</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>        </span><a href="Name.html#pprInfixName"><span class="hs-identifier hs-var">pprInfixName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#pprModulePrefix"><span class="hs-identifier hs-var">pprModulePrefix</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#pprNameUnqualified"><span class="hs-identifier hs-var">pprNameUnqualified</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><a href="Name.html#nameStableString"><span class="hs-identifier hs-var">nameStableString</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span>        </span><span class="hs-comment">-- Re-export the OccName stuff</span><span>
</span><a name="line-79"></a><span>        </span><span class="hs-keyword">module</span><span> </span><a href="OccName.html"><span class="hs-identifier">OccName</span></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><a href="OccName.html"><span class="hs-identifier">OccName</span></a><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><a href="Module.html"><span class="hs-identifier">Module</span></a><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Name-datatype]{The @Name@ datatype, and name construction}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">-- | A unique, unambiguous name for something, containing information about where</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- that thing originated.</span><span>
</span><a name="line-110"></a><span class="hs-keyword">data</span><span> </span><a name="Name"><a href="Name.html#Name"><span class="hs-identifier">Name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Name"><a href="Name.html#Name"><span class="hs-identifier">Name</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-111"></a><span>                </span><a name="n_sort"><a href="Name.html#n_sort"><span class="hs-identifier">n_sort</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NameSort"><span class="hs-identifier hs-type">NameSort</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- What sort of name it is</span><span>
</span><a name="line-112"></a><span>                </span><a name="n_occ"><a href="Name.html#n_occ"><span class="hs-identifier">n_occ</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Its occurrence name</span><span>
</span><a name="line-113"></a><span>                </span><a name="n_uniq"><a href="Name.html#n_uniq"><span class="hs-identifier">n_uniq</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>
</span><a name="line-114"></a><span>                </span><a name="n_loc"><a href="Name.html#n_loc"><span class="hs-identifier">n_loc</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>      </span><span class="hs-comment">-- Definition site</span><span>
</span><a name="line-115"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- NOTE: we make the n_loc field strict to eliminate some potential</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- (and real!) space leaks, due to the fact that we don't look at</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- the SrcLoc in a Name all that often.</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- See Note [About the NameSorts]</span><span>
</span><a name="line-122"></a><span class="hs-keyword">data</span><span> </span><a name="NameSort"><a href="Name.html#NameSort"><span class="hs-identifier">NameSort</span></a></a><span>
</span><a name="line-123"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="External"><a href="Name.html#External"><span class="hs-identifier">External</span></a></a><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WiredIn"><a href="Name.html#WiredIn"><span class="hs-identifier">WiredIn</span></a></a><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-type">BuiltInSyntax</span></a><span>
</span><a name="line-126"></a><span>        </span><span class="hs-comment">-- A variant of External, for wired-in things</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Internal"><a href="Name.html#Internal"><span class="hs-identifier">Internal</span></a></a><span>            </span><span class="hs-comment">-- A user-defined Id or TyVar</span><span>
</span><a name="line-129"></a><span>                        </span><span class="hs-comment">-- defined in the module being compiled</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="System"><a href="Name.html#System"><span class="hs-identifier">System</span></a></a><span>              </span><span class="hs-comment">-- A system-defined Id or TyVar.  Typically the</span><span>
</span><a name="line-132"></a><span>                        </span><span class="hs-comment">-- OccName is very uninformative (like 's')</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Name.html#NameSort"><span class="hs-identifier hs-type">NameSort</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-135"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;external&quot;</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;wired-in&quot;</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-identifier">ppr</span><span>  </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;internal&quot;</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-identifier">ppr</span><span>  </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;system&quot;</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><a name="local-8214565720323792605"><span class="hs-identifier">rnf</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621681158330"><span class="hs-identifier hs-var">n_sort</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Name.html#NameSort"><span class="hs-identifier hs-type">NameSort</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-8214565720323792605"><span class="hs-identifier">rnf</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158326"><a href="#local-6989586621681158326"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621681158326"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158327"><a href="#local-6989586621681158327"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621681158328"><a href="#local-6989586621681158328"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621681158329"><a href="#local-6989586621681158329"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621681158327"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158328"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158329"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-comment">-- XXX this is a *lie*, we're not going to rnf the TyThing, but</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-comment">-- since the TyThings for WiredIn Names are all static they can't</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-comment">-- be hiding space leaks or errors.</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-identifier">rnf</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-identifier">rnf</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | BuiltInSyntax is for things like @(:)@, @[]@ and tuples,</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- which have special syntactic forms.  They aren't in scope</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- as such.</span><span>
</span><a name="line-155"></a><span class="hs-keyword">data</span><span> </span><a name="BuiltInSyntax"><a href="Name.html#BuiltInSyntax"><span class="hs-identifier">BuiltInSyntax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BuiltInSyntax"><a href="Name.html#BuiltInSyntax"><span class="hs-identifier">BuiltInSyntax</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="UserSyntax"><a href="Name.html#UserSyntax"><span class="hs-identifier">UserSyntax</span></a></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">{-
Note [About the NameSorts]

1.  Initially, top-level Ids (including locally-defined ones) get External names,
    and all other local Ids get Internal names

2.  In any invocation of GHC, an External Name for &quot;M.x&quot; has one and only one
    unique.  This unique association is ensured via the Name Cache;
    see Note [The Name Cache] in IfaceEnv.

3.  Things with a External name are given C static labels, so they finally
    appear in the .o file's symbol table.  They appear in the symbol table
    in the form M.n.  If originally-local things have this property they
    must be made @External@ first.

4.  In the tidy-core phase, a External that is not visible to an importer
    is changed to Internal, and a Internal that is visible is changed to External

5.  A System Name differs in the following ways:
        a) has unique attached when printing dumps
        b) unifier eliminates sys tyvars in favour of user provs where possible

    Before anything gets printed in interface files or output code, it's
    fed through a 'tidy' processor, which zaps the OccNames to have
    unique names; and converts all sys-locals to user locals
    If any desugarer sys-locals have survived that far, they get changed to
    &quot;ds1&quot;, &quot;ds2&quot;, etc.

Built-in syntax =&gt; It's a syntactic form, not &quot;in scope&quot; (e.g. [])

Wired-in thing  =&gt; The thing (Id, TyCon) is fully known to the compiler,
                   not read from an interface file.
                   E.g. Bool, True, Int, Float, and many others

All built-in syntax is for wired-in things.
-}</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-keyword">instance</span><span> </span><a href="OccName.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-195"></a><span>  </span><a name="local-8214565720325908782"><a href="OccName.html#occName"><span class="hs-identifier">occName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-identifier">nameUnique</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span>
</span><a name="line-198"></a><span class="hs-identifier">nameOccName</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-199"></a><span class="hs-identifier">nameModule</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span>
</span><a name="line-200"></a><span class="hs-identifier">nameSrcLoc</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a><span>
</span><a name="line-201"></a><span class="hs-identifier">nameSrcSpan</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><a name="nameUnique"><a href="Name.html#nameUnique"><span class="hs-identifier">nameUnique</span></a></a><span>  </span><a name="local-6989586621681158340"><a href="#local-6989586621681158340"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><a href="#local-6989586621681158340"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-204"></a><a name="nameOccName"><a href="Name.html#nameOccName"><span class="hs-identifier">nameOccName</span></a></a><span> </span><a name="local-6989586621681158341"><a href="#local-6989586621681158341"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n_occ</span><span>  </span><a href="#local-6989586621681158341"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-205"></a><a name="nameSrcLoc"><a href="Name.html#nameSrcLoc"><span class="hs-identifier">nameSrcLoc</span></a></a><span>  </span><a name="local-6989586621681158342"><a href="#local-6989586621681158342"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#srcSpanStart"><span class="hs-identifier hs-var">srcSpanStart</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">n_loc</span><span> </span><a href="#local-6989586621681158342"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><a name="nameSrcSpan"><a href="Name.html#nameSrcSpan"><span class="hs-identifier">nameSrcSpan</span></a></a><span> </span><a name="local-6989586621681158343"><a href="#local-6989586621681158343"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n_loc</span><span>  </span><a href="#local-6989586621681158343"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="SrcLoc.html#SrcSpanLess"><span class="hs-identifier hs-type">SrcSpanLess</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-209"></a><span class="hs-keyword">instance</span><span> </span><a href="SrcLoc.html#HasSrcSpan"><span class="hs-identifier hs-type">HasSrcSpan</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>  </span><a name="local-8214565720324960780"><a href="SrcLoc.html#composeSrcSpan"><span class="hs-identifier">composeSrcSpan</span></a></a><span>   </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621681158323"><a href="#local-6989586621681158323"><span class="hs-identifier">sp</span></a></a><span>  </span><a name="local-6989586621681158324"><a href="#local-6989586621681158324"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158324"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158323"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">}</span><span>
</span><a name="line-211"></a><span>  </span><a name="local-8214565720324960781"><a href="SrcLoc.html#decomposeSrcSpan"><span class="hs-identifier">decomposeSrcSpan</span></a></a><span> </span><a name="local-6989586621681158325"><a href="#local-6989586621681158325"><span class="hs-identifier">n</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">n_loc</span><span> </span><a href="#local-6989586621681158325"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621681158325"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Predicates on names}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-identifier">isInternalName</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-223"></a><span class="hs-identifier">isExternalName</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-224"></a><span class="hs-identifier">isSystemName</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-225"></a><span class="hs-identifier">isWiredInName</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><a name="isWiredInName"><a href="Name.html#isWiredInName"><span class="hs-identifier">isWiredInName</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-228"></a><span class="hs-identifier">isWiredInName</span><span> </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-identifier">wiredInNameTyThing_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span>
</span><a name="line-231"></a><a name="wiredInNameTyThing_maybe"><a href="Name.html#wiredInNameTyThing_maybe"><span class="hs-identifier">wiredInNameTyThing_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681158344"><a href="#local-6989586621681158344"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681158344"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-232"></a><span class="hs-identifier">wiredInNameTyThing_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">isBuiltInSyntax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-235"></a><a name="isBuiltInSyntax"><a href="Name.html#isBuiltInSyntax"><span class="hs-identifier">isBuiltInSyntax</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-var">BuiltInSyntax</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-236"></a><span class="hs-identifier">isBuiltInSyntax</span><span> </span><span class="hs-identifier">_</span><span>                                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><a name="isExternalName"><a href="Name.html#isExternalName"><span class="hs-identifier">isExternalName</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-239"></a><span class="hs-identifier">isExternalName</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-240"></a><span class="hs-identifier">isExternalName</span><span> </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><a name="isInternalName"><a href="Name.html#isInternalName"><span class="hs-identifier">isInternalName</span></a></a><span> </span><a name="local-6989586621681158345"><a href="#local-6989586621681158345"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a><span> </span><a href="#local-6989586621681158345"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-identifier">isHoleName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-245"></a><a name="isHoleName"><a href="Name.html#isHoleName"><span class="hs-identifier">isHoleName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#isHoleModule"><span class="hs-identifier hs-var">isHoleModule</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><a name="nameModule"><a href="Name.html#nameModule"><span class="hs-identifier">nameModule</span></a></a><span> </span><a name="local-6989586621681158346"><a href="#local-6989586621681158346"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-248"></a><span>  </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-6989586621681158346"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span>
</span><a name="line-249"></a><span>  </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;nameModule&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">n_sort</span><span> </span><a href="#local-6989586621681158346"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158346"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">nameModule_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span>
</span><a name="line-252"></a><a name="nameModule_maybe"><a href="Name.html#nameModule_maybe"><span class="hs-identifier">nameModule_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158347"><a href="#local-6989586621681158347"><span class="hs-identifier">mod</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681158347"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-253"></a><span class="hs-identifier">nameModule_maybe</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158348"><a href="#local-6989586621681158348"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621681158348"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-254"></a><span class="hs-identifier">nameModule_maybe</span><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-identifier">nameIsLocalOrFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- ^ Returns True if the name is</span><span>
</span><a name="line-258"></a><span class="hs-comment">--   (a) Internal</span><span>
</span><a name="line-259"></a><span class="hs-comment">--   (b) External but from the specified module</span><span>
</span><a name="line-260"></a><span class="hs-comment">--   (c) External but from the 'interactive' package</span><span>
</span><a name="line-261"></a><span class="hs-comment">--</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- The key idea is that</span><span>
</span><a name="line-263"></a><span class="hs-comment">--    False means: the entity is defined in some other module</span><span>
</span><a name="line-264"></a><span class="hs-comment">--                 you can find the details (type, fixity, instances)</span><span>
</span><a name="line-265"></a><span class="hs-comment">--                     in some interface file</span><span>
</span><a name="line-266"></a><span class="hs-comment">--                 those details will be stored in the EPT or HPT</span><span>
</span><a name="line-267"></a><span class="hs-comment">--</span><span>
</span><a name="line-268"></a><span class="hs-comment">--    True means:  the entity is defined in this module or earlier in</span><span>
</span><a name="line-269"></a><span class="hs-comment">--                     the GHCi session</span><span>
</span><a name="line-270"></a><span class="hs-comment">--                 you can find details (type, fixity, instances) in the</span><span>
</span><a name="line-271"></a><span class="hs-comment">--                     TcGblEnv or TcLclEnv</span><span>
</span><a name="line-272"></a><span class="hs-comment">--</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- The isInteractiveModule part is because successive interactions of a GHCi session</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- each give rise to a fresh module (Ghci1, Ghci2, etc), but they all come</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- from the magic 'interactive' package; and all the details are kept in the</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- TcLclEnv, TcGblEnv, NOT in the HPT or EPT.</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- See Note [The interactive package] in HscTypes</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><a name="nameIsLocalOrFrom"><a href="Name.html#nameIsLocalOrFrom"><span class="hs-identifier">nameIsLocalOrFrom</span></a></a><span> </span><a name="local-6989586621681158349"><a href="#local-6989586621681158349"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621681158350"><a href="#local-6989586621681158350"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-280"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681158351"><a href="#local-6989586621681158351"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-6989586621681158350"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158349"><span class="hs-identifier hs-var">from</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621681158351"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Module.html#isInteractiveModule"><span class="hs-identifier hs-var">isInteractiveModule</span></a><span> </span><a href="#local-6989586621681158351"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-281"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">nameIsHomePackage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- True if the Name is defined in module of this package</span><span>
</span><a name="line-285"></a><a name="nameIsHomePackage"><a href="Name.html#nameIsHomePackage"><span class="hs-identifier">nameIsHomePackage</span></a></a><span> </span><a name="local-6989586621681158352"><a href="#local-6989586621681158352"><span class="hs-identifier">this_mod</span></a></a><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158354"><a href="#local-6989586621681158354"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><a href="#local-6989586621681158354"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-287"></a><span>              </span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158355"><a href="#local-6989586621681158355"><span class="hs-identifier">nm_mod</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158355"><span class="hs-identifier hs-var">nm_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621681158353"><span class="hs-identifier hs-var">this_pkg</span></a><span>
</span><a name="line-288"></a><span>              </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158356"><a href="#local-6989586621681158356"><span class="hs-identifier">nm_mod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158356"><span class="hs-identifier hs-var">nm_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621681158353"><span class="hs-identifier hs-var">this_pkg</span></a><span>
</span><a name="line-289"></a><span>              </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-290"></a><span>              </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-292"></a><span>    </span><a name="local-6989586621681158353"><a href="#local-6989586621681158353"><span class="hs-identifier">this_pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158352"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-identifier">nameIsHomePackageImport</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- True if the Name is defined in module of this package</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- /other than/ the this_mod</span><span>
</span><a name="line-297"></a><a name="nameIsHomePackageImport"><a href="Name.html#nameIsHomePackageImport"><span class="hs-identifier">nameIsHomePackageImport</span></a></a><span> </span><a name="local-6989586621681158357"><a href="#local-6989586621681158357"><span class="hs-identifier">this_mod</span></a></a><span>
</span><a name="line-298"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158359"><a href="#local-6989586621681158359"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-6989586621681158359"><span class="hs-identifier hs-var">nm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-299"></a><span>              </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-300"></a><span>              </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681158360"><a href="#local-6989586621681158360"><span class="hs-identifier">nm_mod</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681158360"><span class="hs-identifier hs-var">nm_mod</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621681158357"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-301"></a><span>                          </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158360"><span class="hs-identifier hs-var">nm_mod</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621681158358"><span class="hs-identifier hs-var">this_pkg</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-303"></a><span>    </span><a name="local-6989586621681158358"><a href="#local-6989586621681158358"><span class="hs-identifier">this_pkg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158357"><span class="hs-identifier hs-var">this_mod</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- | Returns True if the Name comes from some other package: neither this</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- package nor the interactive package.</span><span>
</span><a name="line-307"></a><span class="hs-identifier">nameIsFromExternalPackage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-308"></a><a name="nameIsFromExternalPackage"><a href="Name.html#nameIsFromExternalPackage"><span class="hs-identifier">nameIsFromExternalPackage</span></a></a><span> </span><a name="local-6989586621681158361"><a href="#local-6989586621681158361"><span class="hs-identifier">this_pkg</span></a></a><span> </span><a name="local-6989586621681158362"><a href="#local-6989586621681158362"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621681158363"><a href="#local-6989586621681158363"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-6989586621681158362"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-310"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158363"><span class="hs-identifier hs-var">mod</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621681158361"><span class="hs-identifier hs-var">this_pkg</span></a><span>    </span><span class="hs-comment">-- Not this package</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Module.html#isInteractiveModule"><span class="hs-identifier hs-var">isInteractiveModule</span></a><span> </span><a href="#local-6989586621681158363"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Not the 'interactive' package</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-identifier">isTyVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-317"></a><a name="isTyVarName"><a href="Name.html#isTyVarName"><span class="hs-identifier">isTyVarName</span></a></a><span> </span><a name="local-6989586621681158364"><a href="#local-6989586621681158364"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isTvOcc"><span class="hs-identifier hs-var">isTvOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681158364"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-identifier">isTyConName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-320"></a><a name="isTyConName"><a href="Name.html#isTyConName"><span class="hs-identifier">isTyConName</span></a></a><span> </span><a name="local-6989586621681158365"><a href="#local-6989586621681158365"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681158365"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-identifier">isDataConName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-323"></a><a name="isDataConName"><a href="Name.html#isDataConName"><span class="hs-identifier">isDataConName</span></a></a><span> </span><a name="local-6989586621681158366"><a href="#local-6989586621681158366"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681158366"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">isValName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-326"></a><a name="isValName"><a href="Name.html#isValName"><span class="hs-identifier">isValName</span></a></a><span> </span><a name="local-6989586621681158367"><a href="#local-6989586621681158367"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isValOcc"><span class="hs-identifier hs-var">isValOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681158367"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-identifier">isVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-329"></a><a name="isVarName"><a href="Name.html#isVarName"><span class="hs-identifier">isVarName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#isVarOcc"><span class="hs-identifier hs-var">isVarOcc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><a name="isSystemName"><a href="Name.html#isSystemName"><span class="hs-identifier">isSystemName</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-332"></a><span class="hs-identifier">isSystemName</span><span> </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Making names}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- | Create a name which is (for now at least) local to the current module and hence</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- does not need a 'Module' to disambiguate it from other 'Name's</span><span>
</span><a name="line-344"></a><span class="hs-identifier">mkInternalName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-345"></a><a name="mkInternalName"><a href="Name.html#mkInternalName"><span class="hs-identifier">mkInternalName</span></a></a><span> </span><a name="local-6989586621681158368"><a href="#local-6989586621681158368"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158369"><a href="#local-6989586621681158369"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621681158370"><a href="#local-6989586621681158370"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158368"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-346"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>
</span><a name="line-347"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158369"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-348"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158370"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-349"></a><span>        </span><span class="hs-comment">-- NB: You might worry that after lots of huffing and</span><span>
</span><a name="line-350"></a><span>        </span><span class="hs-comment">-- puffing we might end up with two local names with distinct</span><span>
</span><a name="line-351"></a><span>        </span><span class="hs-comment">-- uniques, but the same OccName.  Indeed we can, but that's ok</span><span>
</span><a name="line-352"></a><span>        </span><span class="hs-comment">--      * the insides of the compiler don't care: they use the Unique</span><span>
</span><a name="line-353"></a><span>        </span><span class="hs-comment">--      * when printing for -ddump-xxx you can switch on -dppr-debug to get the</span><span>
</span><a name="line-354"></a><span>        </span><span class="hs-comment">--        uniques if you get confused</span><span>
</span><a name="line-355"></a><span>        </span><span class="hs-comment">--      * for interface files we tidyCore first, which makes</span><span>
</span><a name="line-356"></a><span>        </span><span class="hs-comment">--        the OccNames distinct when they need to be</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-identifier">mkClonedInternalName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-359"></a><a name="mkClonedInternalName"><a href="Name.html#mkClonedInternalName"><span class="hs-identifier">mkClonedInternalName</span></a></a><span> </span><a name="local-6989586621681158371"><a href="#local-6989586621681158371"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158372"><a href="#local-6989586621681158372"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158373"><a href="#local-6989586621681158373"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158371"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>
</span><a name="line-361"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158372"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158373"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">mkDerivedInternalName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-364"></a><a name="mkDerivedInternalName"><a href="Name.html#mkDerivedInternalName"><span class="hs-identifier">mkDerivedInternalName</span></a></a><span> </span><a name="local-6989586621681158374"><a href="#local-6989586621681158374"><span class="hs-identifier">derive_occ</span></a></a><span> </span><a name="local-6989586621681158375"><a href="#local-6989586621681158375"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158376"><a href="#local-6989586621681158376"><span class="hs-identifier">occ</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158377"><a href="#local-6989586621681158377"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158375"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>
</span><a name="line-366"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158374"><span class="hs-identifier hs-var">derive_occ</span></a><span> </span><a href="#local-6989586621681158376"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158377"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- | Create a name which definitely originates in the given module</span><span>
</span><a name="line-369"></a><span class="hs-identifier">mkExternalName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-370"></a><span class="hs-comment">-- WATCH OUT! External Names should be in the Name Cache</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- (see Note [The Name Cache] in IfaceEnv), so don't just call mkExternalName</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- with some fresh unique without populating the Name Cache</span><span>
</span><a name="line-373"></a><a name="mkExternalName"><a href="Name.html#mkExternalName"><span class="hs-identifier">mkExternalName</span></a></a><span> </span><a name="local-6989586621681158378"><a href="#local-6989586621681158378"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158379"><a href="#local-6989586621681158379"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-6989586621681158380"><a href="#local-6989586621681158380"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621681158381"><a href="#local-6989586621681158381"><span class="hs-identifier">loc</span></a></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158378"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a href="#local-6989586621681158379"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">,</span><span>
</span><a name="line-375"></a><span>           </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158380"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158381"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | Create a name which is actually defined by the compiler itself</span><span>
</span><a name="line-378"></a><span class="hs-identifier">mkWiredInName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-type">BuiltInSyntax</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-379"></a><a name="mkWiredInName"><a href="Name.html#mkWiredInName"><span class="hs-identifier">mkWiredInName</span></a></a><span> </span><a name="local-6989586621681158382"><a href="#local-6989586621681158382"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-6989586621681158383"><a href="#local-6989586621681158383"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621681158384"><a href="#local-6989586621681158384"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158385"><a href="#local-6989586621681158385"><span class="hs-identifier">thing</span></a></a><span> </span><a name="local-6989586621681158386"><a href="#local-6989586621681158386"><span class="hs-identifier">built_in</span></a></a><span>
</span><a name="line-380"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158384"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span>
</span><a name="line-381"></a><span>           </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a href="#local-6989586621681158382"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158385"><span class="hs-identifier hs-var">thing</span></a><span> </span><a href="#local-6989586621681158386"><span class="hs-identifier hs-var">built_in</span></a><span class="hs-special">,</span><span>
</span><a name="line-382"></a><span>           </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158383"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#wiredInSrcSpan"><span class="hs-identifier hs-var">wiredInSrcSpan</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span class="hs-comment">-- | Create a name brought into being by the compiler</span><span>
</span><a name="line-385"></a><span class="hs-identifier">mkSystemName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-386"></a><a name="mkSystemName"><a href="Name.html#mkSystemName"><span class="hs-identifier">mkSystemName</span></a></a><span> </span><a name="local-6989586621681158387"><a href="#local-6989586621681158387"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158388"><a href="#local-6989586621681158388"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkSystemNameAt"><span class="hs-identifier hs-var">mkSystemNameAt</span></a><span> </span><a href="#local-6989586621681158387"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-6989586621681158388"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-identifier">mkSystemNameAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-389"></a><a name="mkSystemNameAt"><a href="Name.html#mkSystemNameAt"><span class="hs-identifier">mkSystemNameAt</span></a></a><span> </span><a name="local-6989586621681158389"><a href="#local-6989586621681158389"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158390"><a href="#local-6989586621681158390"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621681158391"><a href="#local-6989586621681158391"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158389"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>
</span><a name="line-390"></a><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158390"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158391"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-identifier">mkSystemVarName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-393"></a><a name="mkSystemVarName"><a href="Name.html#mkSystemVarName"><span class="hs-identifier">mkSystemVarName</span></a></a><span> </span><a name="local-6989586621681158392"><a href="#local-6989586621681158392"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158393"><a href="#local-6989586621681158393"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkSystemName"><span class="hs-identifier hs-var">mkSystemName</span></a><span> </span><a href="#local-6989586621681158392"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><a href="#local-6989586621681158393"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-identifier">mkSysTvName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-396"></a><a name="mkSysTvName"><a href="Name.html#mkSysTvName"><span class="hs-identifier">mkSysTvName</span></a></a><span> </span><a name="local-6989586621681158394"><a href="#local-6989586621681158394"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158395"><a href="#local-6989586621681158395"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkSystemName"><span class="hs-identifier hs-var">mkSystemName</span></a><span> </span><a href="#local-6989586621681158394"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkTyVarOccFS"><span class="hs-identifier hs-var">mkTyVarOccFS</span></a><span> </span><a href="#local-6989586621681158395"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-comment">-- | Make a name for a foreign call</span><span>
</span><a name="line-399"></a><span class="hs-identifier">mkFCallName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-400"></a><a name="mkFCallName"><a href="Name.html#mkFCallName"><span class="hs-identifier">mkFCallName</span></a></a><span> </span><a name="local-6989586621681158396"><a href="#local-6989586621681158396"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158397"><a href="#local-6989586621681158397"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-6989586621681158396"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOcc"><span class="hs-identifier hs-var">mkVarOcc</span></a><span> </span><a href="#local-6989586621681158397"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-401"></a><span>   </span><span class="hs-comment">-- The encoded string completely describes the ccall</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">-- When we renumber/rename things, we need to be</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- able to change a Name's Unique to match the cached</span><span>
</span><a name="line-405"></a><span class="hs-comment">-- one in the thing it's the name of.  If you know what I mean.</span><span>
</span><a name="line-406"></a><span class="hs-identifier">setNameUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-407"></a><a name="setNameUnique"><a href="Name.html#setNameUnique"><span class="hs-identifier">setNameUnique</span></a></a><span> </span><a name="local-6989586621681158398"><a href="#local-6989586621681158398"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681158399"><a href="#local-6989586621681158399"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158398"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158399"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">}</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-comment">-- This is used for hsigs: we want to use the name of the originally exported</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- entity, but edit the location to refer to the reexport site</span><span>
</span><a name="line-411"></a><span class="hs-identifier">setNameLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-412"></a><a name="setNameLoc"><a href="Name.html#setNameLoc"><span class="hs-identifier">setNameLoc</span></a></a><span> </span><a name="local-6989586621681158400"><a href="#local-6989586621681158400"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621681158401"><a href="#local-6989586621681158401"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158400"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_loc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158401"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">}</span><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-identifier">tidyNameOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-415"></a><span class="hs-comment">-- We set the OccName of a Name when tidying</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- In doing so, we change System --&gt; Internal, so that when we print</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- it we don't get the unique by default.  It's tidy now!</span><span>
</span><a name="line-418"></a><a name="tidyNameOcc"><a href="Name.html#tidyNameOcc"><span class="hs-identifier">tidyNameOcc</span></a></a><span> </span><a name="local-6989586621681158402"><a href="#local-6989586621681158402"><span class="hs-identifier">name</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621681158403"><a href="#local-6989586621681158403"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158402"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158403"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span class="hs-special">}</span><span>
</span><a name="line-419"></a><span class="hs-identifier">tidyNameOcc</span><span> </span><a name="local-6989586621681158404"><a href="#local-6989586621681158404"><span class="hs-identifier">name</span></a></a><span>                            </span><a name="local-6989586621681158405"><a href="#local-6989586621681158405"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158404"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158405"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- | Make the 'Name' into an internal name, regardless of what it was to begin with</span><span>
</span><a name="line-422"></a><span class="hs-identifier">localiseName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-423"></a><a name="localiseName"><a href="Name.html#localiseName"><span class="hs-identifier">localiseName</span></a></a><span> </span><a name="local-6989586621681158406"><a href="#local-6989586621681158406"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158406"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Hashing and comparison}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-identifier">cmpName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-434"></a><a name="cmpName"><a href="Name.html#cmpName"><span class="hs-identifier">cmpName</span></a></a><span> </span><a name="local-6989586621681158407"><a href="#local-6989586621681158407"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621681158408"><a href="#local-6989586621681158408"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><a href="#local-6989586621681158407"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><a href="#local-6989586621681158408"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-comment">-- | Compare Names lexicographically</span><span>
</span><a name="line-437"></a><span class="hs-comment">-- This only works for Names that originate in the source code or have been</span><span>
</span><a name="line-438"></a><span class="hs-comment">-- tidied.</span><span>
</span><a name="line-439"></a><span class="hs-identifier">stableNameCmp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-440"></a><a name="stableNameCmp"><a href="Name.html#stableNameCmp"><span class="hs-identifier">stableNameCmp</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158409"><a href="#local-6989586621681158409"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158410"><a href="#local-6989586621681158410"><span class="hs-identifier">occ1</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-441"></a><span>              </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158411"><a href="#local-6989586621681158411"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158412"><a href="#local-6989586621681158412"><span class="hs-identifier">occ2</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158409"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621681158413"><span class="hs-identifier hs-var">sort_cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158411"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Util.html#thenCmp"><span class="hs-identifier hs-var">thenCmp</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158410"><span class="hs-identifier hs-var">occ1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158412"><span class="hs-identifier hs-var">occ2</span></a><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>    </span><span class="hs-comment">-- The ordinary compare on OccNames is lexicographic</span><span>
</span><a name="line-444"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-comment">-- Later constructors are bigger</span><span>
</span><a name="line-446"></a><span>    </span><a name="local-6989586621681158413"><a href="#local-6989586621681158413"><span class="hs-identifier">sort_cmp</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158414"><a href="#local-6989586621681158414"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158415"><a href="#local-6989586621681158415"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158414"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">`</span><a href="Module.html#stableModuleCmp"><span class="hs-identifier hs-var">stableModuleCmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158415"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-447"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-448"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-449"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158416"><a href="#local-6989586621681158416"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158417"><a href="#local-6989586621681158417"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158416"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">`</span><a href="Module.html#stableModuleCmp"><span class="hs-identifier hs-var">stableModuleCmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158417"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-450"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>         </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-452"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>         </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-453"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>         </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-454"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>         </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-455"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>           </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-456"></a><span>    </span><span class="hs-identifier">sort_cmp</span><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>           </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Name-instances]{Instance declarations}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | The same comments as for `Name`'s `Ord` instance apply.</span><span>
</span><a name="line-467"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-468"></a><span>    </span><a name="local-6989586621681158319"><a href="#local-6989586621681158319"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621681158320"><a href="#local-6989586621681158320"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158319"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158320"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-469"></a><span>    </span><a name="local-6989586621681158321"><a href="#local-6989586621681158321"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790494"><span class="hs-operator">/=</span></a><span> </span><a name="local-6989586621681158322"><a href="#local-6989586621681158322"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158321"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158322"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">-- | __Caution__: This instance is implemented via `nonDetCmpUnique`, which</span><span>
</span><a name="line-472"></a><span class="hs-comment">-- means that the ordering is not stable across deserialization or rebuilds.</span><span>
</span><a name="line-473"></a><span class="hs-comment">--</span><span>
</span><a name="line-474"></a><span class="hs-comment">-- See `nonDetCmpUnique` for further information, and trac #15240 for a bug</span><span>
</span><a name="line-475"></a><span class="hs-comment">-- caused by improper use of this instance.</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-comment">-- For a deterministic lexicographic ordering, use `stableNameCmp`.</span><span>
</span><a name="line-478"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-479"></a><span>    </span><a name="local-6989586621681158309"><a href="#local-6989586621681158309"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790495"><span class="hs-operator">&lt;=</span></a><span> </span><a name="local-6989586621681158310"><a href="#local-6989586621681158310"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158309"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158310"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-480"></a><span>    </span><a name="local-6989586621681158311"><a href="#local-6989586621681158311"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790500"><span class="hs-operator">&lt;</span></a><span>  </span><a name="local-6989586621681158312"><a href="#local-6989586621681158312"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158311"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158312"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-481"></a><span>    </span><a name="local-6989586621681158313"><a href="#local-6989586621681158313"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541096"><span class="hs-operator">&gt;=</span></a><span> </span><a name="local-6989586621681158314"><a href="#local-6989586621681158314"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158313"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158314"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-482"></a><span>    </span><a name="local-6989586621681158315"><a href="#local-6989586621681158315"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790501"><span class="hs-operator">&gt;</span></a><span>  </span><a name="local-6989586621681158316"><a href="#local-6989586621681158316"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621681158315"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621681158316"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-483"></a><span>    </span><a name="local-8214565720323790496"><span class="hs-identifier">compare</span></a><span> </span><a name="local-6989586621681158317"><a href="#local-6989586621681158317"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621681158318"><a href="#local-6989586621681158318"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#cmpName"><span class="hs-identifier hs-var">cmpName</span></a><span> </span><a href="#local-6989586621681158317"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621681158318"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-486"></a><span>    </span><a name="local-8214565720325051039"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-489"></a><span>    </span><a name="local-8214565720325933137"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><a name="local-6989586621681158308"><a href="#local-6989586621681158308"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158308"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-492"></a><span>  </span><span class="hs-comment">-- don't traverse?</span><span>
</span><a name="line-493"></a><span>  </span><a name="local-8214565720323786785"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;Name&quot;</span><span>
</span><a name="line-494"></a><span>  </span><a name="local-8214565720323786786"><span class="hs-identifier">gunfold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-495"></a><span>  </span><a name="local-8214565720323786784"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNoRepType</span><span> </span><span class="hs-string">&quot;Name&quot;</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Binary}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">-- | Assumes that the 'Name' is a non-binding one. See</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- 'IfaceSyn.putIfaceTopBndr' and 'IfaceSyn.getIfaceTopBndr' for serializing</span><span>
</span><a name="line-507"></a><span class="hs-comment">-- binding 'Name's. See 'UserData' for the rationale for this distinction.</span><span>
</span><a name="line-508"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-509"></a><span>   </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621681158303"><a href="#local-6989586621681158303"><span class="hs-identifier">bh</span></a></a><span> </span><a name="local-6989586621681158304"><a href="#local-6989586621681158304"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-510"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="Binary.html#getUserData"><span class="hs-identifier hs-var">getUserData</span></a><span> </span><a href="#local-6989586621681158303"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-511"></a><span>        </span><a href="Binary.html#UserData"><span class="hs-identifier hs-var">UserData</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">ud_put_nonbinding_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158305"><a href="#local-6989586621681158305"><span class="hs-identifier">put_name</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681158305"><span class="hs-identifier hs-var">put_name</span></a><span> </span><a href="#local-6989586621681158303"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621681158304"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span>   </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621681158306"><a href="#local-6989586621681158306"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-514"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="Binary.html#getUserData"><span class="hs-identifier hs-var">getUserData</span></a><span> </span><a href="#local-6989586621681158306"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-515"></a><span>        </span><a href="Binary.html#UserData"><span class="hs-identifier hs-var">UserData</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ud_get_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158307"><a href="#local-6989586621681158307"><span class="hs-identifier">get_name</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621681158307"><span class="hs-identifier hs-var">get_name</span></a><span> </span><a href="#local-6989586621681158306"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Pretty printing}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-526"></a><span>    </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621681158302"><a href="#local-6989586621681158302"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprName"><span class="hs-identifier hs-var">pprName</span></a><span> </span><a href="#local-6989586621681158302"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-529"></a><span>    </span><a name="local-8214565720324887690"><a href="Outputable.html#pprBndr"><span class="hs-identifier">pprBndr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681158301"><a href="#local-6989586621681158301"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprName"><span class="hs-identifier hs-var">pprName</span></a><span> </span><a href="#local-6989586621681158301"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-530"></a><span>    </span><a name="local-8214565720324887692"><a href="Outputable.html#pprInfixOcc"><span class="hs-identifier">pprInfixOcc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprInfixName"><span class="hs-identifier hs-var">pprInfixName</span></a><span>
</span><a name="line-531"></a><span>    </span><a name="local-8214565720324887691"><a href="Outputable.html#pprPrefixOcc"><span class="hs-identifier">pprPrefixOcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">pprName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-534"></a><a name="pprName"><a href="Name.html#pprName"><span class="hs-identifier">pprName</span></a></a><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">n_sort</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158418"><a href="#local-6989586621681158418"><span class="hs-identifier">sort</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158419"><a href="#local-6989586621681158419"><span class="hs-identifier">uniq</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158420"><a href="#local-6989586621681158420"><span class="hs-identifier">occ</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-535"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621681158421"><a href="#local-6989586621681158421"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621681158418"><span class="hs-identifier hs-var">sort</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-537"></a><span>      </span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158422"><a href="#local-6989586621681158422"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621681158423"><a href="#local-6989586621681158423"><span class="hs-identifier">builtin</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#pprExternal"><span class="hs-identifier hs-var">pprExternal</span></a><span> </span><a href="#local-6989586621681158421"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158419"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-6989586621681158422"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158420"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><a href="#local-6989586621681158423"><span class="hs-identifier hs-var">builtin</span></a><span>
</span><a name="line-538"></a><span>      </span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158424"><a href="#local-6989586621681158424"><span class="hs-identifier">mod</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#pprExternal"><span class="hs-identifier hs-var">pprExternal</span></a><span> </span><a href="#local-6989586621681158421"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158419"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-6989586621681158424"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158420"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="Name.html#UserSyntax"><span class="hs-identifier hs-var">UserSyntax</span></a><span>
</span><a name="line-539"></a><span>      </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#pprSystem"><span class="hs-identifier hs-var">pprSystem</span></a><span> </span><a href="#local-6989586621681158421"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158419"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-6989586621681158420"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-540"></a><span>      </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#pprInternal"><span class="hs-identifier hs-var">pprInternal</span></a><span> </span><a href="#local-6989586621681158421"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158419"><span class="hs-identifier hs-var">uniq</span></a><span> </span><a href="#local-6989586621681158420"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-541"></a><span>
</span><a name="line-542"></a><span class="hs-comment">-- | Print the string of Name unqualifiedly directly.</span><span>
</span><a name="line-543"></a><span class="hs-identifier">pprNameUnqualified</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-544"></a><a name="pprNameUnqualified"><a href="Name.html#pprNameUnqualified"><span class="hs-identifier">pprNameUnqualified</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">n_occ</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621681158425"><a href="#local-6989586621681158425"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158425"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-identifier">pprExternal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-type">BuiltInSyntax</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-547"></a><a name="pprExternal"><a href="Name.html#pprExternal"><span class="hs-identifier">pprExternal</span></a></a><span> </span><a name="local-6989586621681158426"><a href="#local-6989586621681158426"><span class="hs-identifier">sty</span></a></a><span> </span><a name="local-6989586621681158427"><a href="#local-6989586621681158427"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158428"><a href="#local-6989586621681158428"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-6989586621681158429"><a href="#local-6989586621681158429"><span class="hs-identifier">occ</span></a></a><span> </span><a name="local-6989586621681158430"><a href="#local-6989586621681158430"><span class="hs-identifier">is_wired</span></a></a><span> </span><a name="local-6989586621681158431"><a href="#local-6989586621681158431"><span class="hs-identifier">is_builtin</span></a></a><span>
</span><a name="line-548"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a><span> </span><a href="#local-6989586621681158426"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'_'</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_z_occ_name"><span class="hs-identifier hs-var">ppr_z_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-549"></a><span>        </span><span class="hs-comment">-- In code style, always qualify</span><span>
</span><a name="line-550"></a><span>        </span><span class="hs-comment">-- ToDo: maybe we could print all wired-in things unqualified</span><span>
</span><a name="line-551"></a><span>        </span><span class="hs-comment">--       in code style, to reduce symbol table bloat?</span><span>
</span><a name="line-552"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681158426"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621681158432"><span class="hs-identifier hs-var">pp_mod</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-553"></a><span>                     </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621681158430"><span class="hs-identifier hs-var">is_wired</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(w)&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span>
</span><a name="line-554"></a><span>                                      </span><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier hs-var">pprNameSpaceBrief</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-555"></a><span>                                      </span><a href="Name.html#pprUnique"><span class="hs-identifier hs-var">pprUnique</span></a><span> </span><a href="#local-6989586621681158427"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-556"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#BuiltInSyntax"><span class="hs-identifier hs-var">BuiltInSyntax</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621681158431"><span class="hs-identifier hs-var">is_builtin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span>  </span><span class="hs-comment">-- Never qualify builtin syntax</span><span>
</span><a name="line-557"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span>
</span><a name="line-558"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Module.html#isHoleModule"><span class="hs-identifier hs-var">isHoleModule</span></a><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-559"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Outputable.html#qualName"><span class="hs-identifier hs-var">qualName</span></a><span> </span><a href="#local-6989586621681158426"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-560"></a><span>                    </span><a href="Outputable.html#NameUnqual"><span class="hs-identifier hs-var">NameUnqual</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-561"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="Name.html#pprModulePrefix"><span class="hs-identifier hs-var">pprModulePrefix</span></a><span> </span><a href="#local-6989586621681158426"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158429"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-564"></a><span>    </span><a name="local-6989586621681158432"><a href="#local-6989586621681158432"><span class="hs-identifier">pp_mod</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158433"><a href="#local-6989586621681158433"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-565"></a><span>             </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressModulePrefixes"><span class="hs-identifier hs-var">Opt_SuppressModulePrefixes</span></a><span> </span><a href="#local-6989586621681158433"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-566"></a><span>             </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-567"></a><span>             </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158428"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">pprInternal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-570"></a><a name="pprInternal"><a href="Name.html#pprInternal"><span class="hs-identifier">pprInternal</span></a></a><span> </span><a name="local-6989586621681158434"><a href="#local-6989586621681158434"><span class="hs-identifier">sty</span></a></a><span> </span><a name="local-6989586621681158435"><a href="#local-6989586621681158435"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158436"><a href="#local-6989586621681158436"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-571"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a><span> </span><a href="#local-6989586621681158434"><span class="hs-identifier hs-var">sty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var">pprUniqueAlways</span></a><span> </span><a href="#local-6989586621681158435"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-572"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681158434"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158436"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier hs-var">pprNameSpaceBrief</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-6989586621681158436"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-573"></a><span>                                                       </span><a href="Name.html#pprUnique"><span class="hs-identifier hs-var">pprUnique</span></a><span> </span><a href="#local-6989586621681158435"><span class="hs-identifier hs-var">uniq</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-574"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#dumpStyle"><span class="hs-identifier hs-var">dumpStyle</span></a><span> </span><a href="#local-6989586621681158434"><span class="hs-identifier hs-var">sty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158436"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_underscore_unique"><span class="hs-identifier hs-var">ppr_underscore_unique</span></a><span> </span><a href="#local-6989586621681158435"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-575"></a><span>                        </span><span class="hs-comment">-- For debug dumps, we're not necessarily dumping</span><span>
</span><a name="line-576"></a><span>                        </span><span class="hs-comment">-- tidied code, so we need to print the uniques.</span><span>
</span><a name="line-577"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158436"><span class="hs-identifier hs-var">occ</span></a><span>   </span><span class="hs-comment">-- User style</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-comment">-- Like Internal, except that we only omit the unique in Iface style</span><span>
</span><a name="line-580"></a><span class="hs-identifier">pprSystem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-581"></a><a name="pprSystem"><a href="Name.html#pprSystem"><span class="hs-identifier">pprSystem</span></a></a><span> </span><a name="local-6989586621681158437"><a href="#local-6989586621681158437"><span class="hs-identifier">sty</span></a></a><span> </span><a name="local-6989586621681158438"><a href="#local-6989586621681158438"><span class="hs-identifier">uniq</span></a></a><span> </span><a name="local-6989586621681158439"><a href="#local-6989586621681158439"><span class="hs-identifier">occ</span></a></a><span>
</span><a name="line-582"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a><span> </span><a href="#local-6989586621681158437"><span class="hs-identifier hs-var">sty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var">pprUniqueAlways</span></a><span> </span><a href="#local-6989586621681158438"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Outputable.html#debugStyle"><span class="hs-identifier hs-var">debugStyle</span></a><span> </span><a href="#local-6989586621681158437"><span class="hs-identifier hs-var">sty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158439"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_underscore_unique"><span class="hs-identifier hs-var">ppr_underscore_unique</span></a><span> </span><a href="#local-6989586621681158438"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-584"></a><span>                     </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#pprNameSpaceBrief"><span class="hs-identifier hs-var">pprNameSpaceBrief</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameSpace</span><span> </span><a href="#local-6989586621681158439"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#ppr_occ_name"><span class="hs-identifier hs-var">ppr_occ_name</span></a><span> </span><a href="#local-6989586621681158439"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Name.html#ppr_underscore_unique"><span class="hs-identifier hs-var">ppr_underscore_unique</span></a><span> </span><a href="#local-6989586621681158438"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-586"></a><span>                                </span><span class="hs-comment">-- If the tidy phase hasn't run, the OccName</span><span>
</span><a name="line-587"></a><span>                                </span><span class="hs-comment">-- is unlikely to be informative (like 's'),</span><span>
</span><a name="line-588"></a><span>                                </span><span class="hs-comment">-- so print the unique</span><span>
</span><a name="line-589"></a><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">pprModulePrefix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#PprStyle"><span class="hs-identifier hs-type">PprStyle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Module.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-592"></a><span class="hs-comment">-- Print the &quot;M.&quot; part of a name, based on whether it's in scope or not</span><span>
</span><a name="line-593"></a><span class="hs-comment">-- See Note [Printing original names] in HscTypes</span><span>
</span><a name="line-594"></a><a name="pprModulePrefix"><a href="Name.html#pprModulePrefix"><span class="hs-identifier">pprModulePrefix</span></a></a><span> </span><a name="local-6989586621681158440"><a href="#local-6989586621681158440"><span class="hs-identifier">sty</span></a></a><span> </span><a name="local-6989586621681158441"><a href="#local-6989586621681158441"><span class="hs-identifier">mod</span></a></a><span> </span><a name="local-6989586621681158442"><a href="#local-6989586621681158442"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158443"><a href="#local-6989586621681158443"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-595"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressModulePrefixes"><span class="hs-identifier hs-var">Opt_SuppressModulePrefixes</span></a><span> </span><a href="#local-6989586621681158443"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-596"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-597"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-598"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Outputable.html#qualName"><span class="hs-identifier hs-var">qualName</span></a><span> </span><a href="#local-6989586621681158440"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621681158441"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621681158442"><span class="hs-identifier hs-var">occ</span></a><span> </span><span class="hs-keyword">of</span><span>              </span><span class="hs-comment">-- See Outputable.QualifyName:</span><span>
</span><a name="line-599"></a><span>      </span><a href="Outputable.html#NameQual"><span class="hs-identifier hs-var">NameQual</span></a><span> </span><a name="local-6989586621681158444"><a href="#local-6989586621681158444"><span class="hs-identifier">modname</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158444"><span class="hs-identifier hs-var">modname</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>       </span><span class="hs-comment">-- Name is in scope</span><span>
</span><a name="line-600"></a><span>      </span><a href="Outputable.html#NameNotInScope1"><span class="hs-identifier hs-var">NameNotInScope1</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158441"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>           </span><span class="hs-comment">-- Not in scope</span><span>
</span><a name="line-601"></a><span>      </span><a href="Outputable.html#NameNotInScope2"><span class="hs-identifier hs-var">NameNotInScope2</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleUnitId</span><span> </span><a href="#local-6989586621681158441"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span>     </span><span class="hs-comment">-- Module not in</span><span>
</span><a name="line-602"></a><span>                          </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleName</span><span> </span><a href="#local-6989586621681158441"><span class="hs-identifier hs-var">mod</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>          </span><span class="hs-comment">-- scope either</span><span>
</span><a name="line-603"></a><span>      </span><a href="Outputable.html#NameUnqual"><span class="hs-identifier hs-var">NameUnqual</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>                   </span><span class="hs-comment">-- In scope unqualified</span><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-identifier">pprUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-606"></a><span class="hs-comment">-- Print a unique unless we are suppressing them</span><span>
</span><a name="line-607"></a><a name="pprUnique"><a href="Name.html#pprUnique"><span class="hs-identifier">pprUnique</span></a></a><span> </span><a name="local-6989586621681158445"><a href="#local-6989586621681158445"><span class="hs-identifier">uniq</span></a></a><span>
</span><a name="line-608"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158446"><a href="#local-6989586621681158446"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-609"></a><span>    </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressUniques"><span class="hs-identifier hs-var">Opt_SuppressUniques</span></a><span> </span><a href="#local-6989586621681158446"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-610"></a><span>    </span><a href="Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var">pprUniqueAlways</span></a><span> </span><a href="#local-6989586621681158445"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">ppr_underscore_unique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-613"></a><span class="hs-comment">-- Print an underscore separating the name from its unique</span><span>
</span><a name="line-614"></a><span class="hs-comment">-- But suppress it if we aren't printing the uniques anyway</span><span>
</span><a name="line-615"></a><a name="ppr_underscore_unique"><a href="Name.html#ppr_underscore_unique"><span class="hs-identifier">ppr_underscore_unique</span></a></a><span> </span><a name="local-6989586621681158447"><a href="#local-6989586621681158447"><span class="hs-identifier">uniq</span></a></a><span>
</span><a name="line-616"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621681158448"><a href="#local-6989586621681158448"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-617"></a><span>    </span><a href="Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_SuppressUniques"><span class="hs-identifier hs-var">Opt_SuppressUniques</span></a><span> </span><a href="#local-6989586621681158448"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-618"></a><span>    </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'_'</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var">pprUniqueAlways</span></a><span> </span><a href="#local-6989586621681158447"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-identifier">ppr_occ_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-621"></a><a name="ppr_occ_name"><a href="Name.html#ppr_occ_name"><span class="hs-identifier">ppr_occ_name</span></a></a><span> </span><a name="local-6989586621681158449"><a href="#local-6989586621681158449"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-6989586621681158449"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span>        </span><span class="hs-comment">-- Don't use pprOccName; instead, just print the string of the OccName;</span><span>
</span><a name="line-623"></a><span>        </span><span class="hs-comment">-- we print the namespace in the debug stuff above</span><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-comment">-- In code style, we Z-encode the strings.  The results of Z-encoding each FastString are</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- cached behind the scenes in the FastString implementation.</span><span>
</span><a name="line-627"></a><span class="hs-identifier">ppr_z_occ_name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-628"></a><a name="ppr_z_occ_name"><a href="Name.html#ppr_z_occ_name"><span class="hs-identifier">ppr_z_occ_name</span></a></a><span> </span><a name="local-6989586621681158450"><a href="#local-6989586621681158450"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ztext"><span class="hs-identifier hs-var">ztext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#zEncodeFS"><span class="hs-identifier hs-var">zEncodeFS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><a href="#local-6989586621681158450"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-comment">-- Prints (if mod information is available) &quot;Defined at &lt;loc&gt;&quot; or</span><span>
</span><a name="line-631"></a><span class="hs-comment">--  &quot;Defined in &lt;mod&gt;&quot; information for a Name.</span><span>
</span><a name="line-632"></a><span class="hs-identifier">pprDefinedAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-633"></a><a name="pprDefinedAt"><a href="Name.html#pprDefinedAt"><span class="hs-identifier">pprDefinedAt</span></a></a><span> </span><a name="local-6989586621681158451"><a href="#local-6989586621681158451"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Defined&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Name.html#pprNameDefnLoc"><span class="hs-identifier hs-var">pprNameDefnLoc</span></a><span> </span><a href="#local-6989586621681158451"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-identifier">pprNameDefnLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- Prints &quot;at &lt;loc&gt;&quot; or</span><span>
</span><a name="line-637"></a><span class="hs-comment">--     or &quot;in &lt;mod&gt;&quot; depending on what info is available</span><span>
</span><a name="line-638"></a><a name="pprNameDefnLoc"><a href="Name.html#pprNameDefnLoc"><span class="hs-identifier">pprNameDefnLoc</span></a></a><span> </span><a name="local-6989586621681158452"><a href="#local-6989586621681158452"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-639"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span> </span><a href="#local-6989586621681158452"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-640"></a><span>         </span><span class="hs-comment">-- nameSrcLoc rather than nameSrcSpan</span><span>
</span><a name="line-641"></a><span>         </span><span class="hs-comment">-- It seems less cluttered to show a location</span><span>
</span><a name="line-642"></a><span>         </span><span class="hs-comment">-- rather than a span for the definition point</span><span>
</span><a name="line-643"></a><span>       </span><a href="SrcLoc.html#RealSrcLoc"><span class="hs-identifier hs-var">RealSrcLoc</span></a><span> </span><a name="local-6989586621681158453"><a href="#local-6989586621681158453"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158453"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-644"></a><span>       </span><a href="SrcLoc.html#UnhelpfulLoc"><span class="hs-identifier hs-var">UnhelpfulLoc</span></a><span> </span><a name="local-6989586621681158454"><a href="#local-6989586621681158454"><span class="hs-identifier">s</span></a></a><span>
</span><a name="line-645"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isInternalName"><span class="hs-identifier hs-var">isInternalName</span></a><span> </span><a href="#local-6989586621681158452"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Name.html#isSystemName"><span class="hs-identifier hs-var">isSystemName</span></a><span> </span><a href="#local-6989586621681158452"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-646"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;at&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-6989586621681158454"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-647"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-648"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a><span> </span><a href="#local-6989586621681158452"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- | Get a string representation of a 'Name' that's unique and stable</span><span>
</span><a name="line-652"></a><span class="hs-comment">-- across recompilations. Used for deterministic generation of binds for</span><span>
</span><a name="line-653"></a><span class="hs-comment">-- derived instances.</span><span>
</span><a name="line-654"></a><span class="hs-comment">-- eg. &quot;$aeson_70dylHtv1FFGeai1IoxcQr$Data.Aeson.Types.Internal$String&quot;</span><span>
</span><a name="line-655"></a><span class="hs-identifier">nameStableString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-656"></a><a name="nameStableString"><a href="Name.html#nameStableString"><span class="hs-identifier">nameStableString</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-var">Name</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-657"></a><span>  </span><a href="Name.html#nameSortStableString"><span class="hs-identifier hs-var">nameSortStableString</span></a><span> </span><a href="#local-6989586621681158455"><span class="hs-identifier hs-var">n_sort</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;$&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span> </span><a href="#local-6989586621681158456"><span class="hs-identifier hs-var">n_occ</span></a><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-identifier">nameSortStableString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NameSort"><span class="hs-identifier hs-type">NameSort</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-660"></a><a name="nameSortStableString"><a href="Name.html#nameSortStableString"><span class="hs-identifier">nameSortStableString</span></a></a><span> </span><a href="Name.html#System"><span class="hs-identifier hs-var">System</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$_sys&quot;</span><span>
</span><a name="line-661"></a><span class="hs-identifier">nameSortStableString</span><span> </span><a href="Name.html#Internal"><span class="hs-identifier hs-var">Internal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;$_in&quot;</span><span>
</span><a name="line-662"></a><span class="hs-identifier">nameSortStableString</span><span> </span><span class="hs-special">(</span><a href="Name.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><a name="local-6989586621681158459"><a href="#local-6989586621681158459"><span class="hs-identifier">mod</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#moduleStableString"><span class="hs-identifier hs-var">moduleStableString</span></a><span> </span><a href="#local-6989586621681158459"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-663"></a><span class="hs-identifier">nameSortStableString</span><span> </span><span class="hs-special">(</span><a href="Name.html#WiredIn"><span class="hs-identifier hs-var">WiredIn</span></a><span> </span><a name="local-6989586621681158460"><a href="#local-6989586621681158460"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Module.html#moduleStableString"><span class="hs-identifier hs-var">moduleStableString</span></a><span> </span><a href="#local-6989586621681158460"><span class="hs-identifier hs-var">mod</span></a><span>
</span><a name="line-664"></a><span>
</span><a name="line-665"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Overloaded functions related to Names}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span class="hs-comment">-- | A class allowing convenient access to the 'Name' of various datatypes</span><span>
</span><a name="line-674"></a><span class="hs-keyword">class</span><span> </span><a name="NamedThing"><a href="Name.html#NamedThing"><span class="hs-identifier">NamedThing</span></a></a><span> </span><a name="local-6989586621681158298"><a href="#local-6989586621681158298"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-675"></a><span>    </span><a name="getOccName"><a href="Name.html#getOccName"><span class="hs-identifier">getOccName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621681158298"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span>
</span><a name="line-676"></a><span>    </span><a name="getName"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621681158298"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span>    </span><a name="local-8214565720325933136"><a href="Name.html#getOccName"><span class="hs-identifier">getOccName</span></a></a><span> </span><a name="local-6989586621681158299"><a href="#local-6989586621681158299"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621681158299"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Default method</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-keyword">instance</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158300"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621681158300"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-681"></a><span>    </span><a name="local-8214565720325933137"><a href="Name.html#getName"><span class="hs-identifier">getName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">getSrcLoc</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a><span>
</span><a name="line-684"></a><span class="hs-identifier">getSrcSpan</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158338"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158338"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-685"></a><span class="hs-identifier">getOccString</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158337"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158337"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-686"></a><span class="hs-identifier">getOccFS</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158336"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158336"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><a name="getSrcLoc"><a href="Name.html#getSrcLoc"><span class="hs-identifier">getSrcLoc</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a><span>           </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span>
</span><a name="line-689"></a><a name="getSrcSpan"><a href="Name.html#getSrcSpan"><span class="hs-identifier">getSrcSpan</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a><span>          </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span>
</span><a name="line-690"></a><a name="getOccString"><a href="Name.html#getOccString"><span class="hs-identifier">getOccString</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#occNameString"><span class="hs-identifier hs-var">occNameString</span></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span>
</span><a name="line-691"></a><a name="getOccFS"><a href="Name.html#getOccFS"><span class="hs-identifier">getOccFS</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">occNameFS</span><span>            </span><span class="hs-operator hs-var">.</span><span> </span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span>
</span><a name="line-692"></a><span>
</span><a name="line-693"></a><span class="hs-identifier">pprInfixName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621681158335"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158335"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158335"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-694"></a><span class="hs-comment">-- See Outputable.pprPrefixVar, pprInfixVar;</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- add parens or back-quotes as appropriate</span><span>
</span><a name="line-696"></a><a name="pprInfixName"><a href="Name.html#pprInfixName"><span class="hs-identifier">pprInfixName</span></a></a><span>  </span><a name="local-6989586621681158461"><a href="#local-6989586621681158461"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprInfixVar"><span class="hs-identifier hs-var">pprInfixVar</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-6989586621681158461"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158461"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-identifier">pprPrefixName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#NamedThing"><span class="hs-identifier hs-type">NamedThing</span></a><span> </span><a href="#local-6989586621681158334"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621681158334"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-699"></a><a name="pprPrefixName"><a href="Name.html#pprPrefixName"><span class="hs-identifier">pprPrefixName</span></a></a><span> </span><a name="local-6989586621681158462"><a href="#local-6989586621681158462"><span class="hs-identifier">thing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPrefixVar"><span class="hs-identifier hs-var">pprPrefixVar</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-6989586621681158463"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621681158463"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-701"></a><span>   </span><a name="local-6989586621681158463"><a href="#local-6989586621681158463"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621681158462"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-702"></a></pre></body></html>