<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcEvidence</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-comment">-- HsWrapper</span><span>
</span><a name="line-8"></a><span>  </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">(</span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpTyApps"><span class="hs-identifier hs-var">mkWpTyApps</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpEvApps"><span class="hs-identifier hs-var">mkWpEvApps</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpEvVarApps"><span class="hs-identifier hs-var">mkWpEvVarApps</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>  </span><a href="TcEvidence.html#mkWpLams"><span class="hs-identifier hs-var">mkWpLams</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier hs-var">mkWpCastN</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpCastR"><span class="hs-identifier hs-var">mkWpCastR</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#collectHsWrapBinders"><span class="hs-identifier hs-var">collectHsWrapBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>  </span><a href="TcEvidence.html#mkWpFun"><span class="hs-identifier hs-var">mkWpFun</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpFuns"><span class="hs-identifier hs-var">mkWpFuns</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#pprHsWrapper"><span class="hs-identifier hs-var">pprHsWrapper</span></a><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-comment">-- Evidence bindings</span><span>
</span><a name="line-14"></a><span>  </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>  </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#emptyEvBindMap"><span class="hs-identifier hs-var">emptyEvBindMap</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#extendEvBinds"><span class="hs-identifier hs-var">extendEvBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>  </span><a href="TcEvidence.html#lookupEvBind"><span class="hs-identifier hs-var">lookupEvBind</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evBindMapBinds"><span class="hs-identifier hs-var">evBindMapBinds</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#foldEvBindMap"><span class="hs-identifier hs-var">foldEvBindMap</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#filterEvBindMap"><span class="hs-identifier hs-var">filterEvBindMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>  </span><a href="TcEvidence.html#isEmptyEvBindMap"><span class="hs-identifier hs-var">isEmptyEvBindMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>  </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#emptyTcEvBinds"><span class="hs-identifier hs-var">emptyTcEvBinds</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#isEmptyTcEvBinds"><span class="hs-identifier hs-var">isEmptyTcEvBinds</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkGivenEvBind"><span class="hs-identifier hs-var">mkGivenEvBind</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWantedEvBind"><span class="hs-identifier hs-var">mkWantedEvBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>  </span><a href="TcEvidence.html#evBindVar"><span class="hs-identifier hs-var">evBindVar</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#isCoEvBindsVar"><span class="hs-identifier hs-var">isCoEvBindsVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-comment">-- EvTerm (already a CoreExpr)</span><span>
</span><a name="line-22"></a><span>  </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>  </span><a href="TcEvidence.html#evId"><span class="hs-identifier hs-var">evId</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evCoercion"><span class="hs-identifier hs-var">evCoercion</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evCast"><span class="hs-identifier hs-var">evCast</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evDFunApp"><span class="hs-identifier hs-var">evDFunApp</span></a><span class="hs-special">,</span><span>  </span><a href="TcEvidence.html#evDataConApp"><span class="hs-identifier hs-var">evDataConApp</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evSelector"><span class="hs-identifier hs-var">evSelector</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="TcEvidence.html#mkEvCast"><span class="hs-identifier hs-var">mkEvCast</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier hs-var">evVarsOfTerm</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkEvScSelectors"><span class="hs-identifier hs-var">mkEvScSelectors</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evTypeable"><span class="hs-identifier hs-var">evTypeable</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#findNeededEvVars"><span class="hs-identifier hs-var">findNeededEvVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>  </span><a href="TcEvidence.html#evTermCoercion"><span class="hs-identifier hs-var">evTermCoercion</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#evTermCoercion_maybe"><span class="hs-identifier hs-var">evTermCoercion_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-type">EvCallStack</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- TcCoercion</span><span>
</span><a name="line-31"></a><span>  </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcCoercionP"><span class="hs-identifier hs-type">TcCoercionP</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#LeftOrRight"><span class="hs-identifier hs-type">LeftOrRight</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#pickLR"><span class="hs-identifier hs-var">pickLR</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="TcEvidence.html#mkTcReflCo"><span class="hs-identifier hs-var">mkTcReflCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcNomReflCo"><span class="hs-identifier hs-var">mkTcNomReflCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcRepReflCo"><span class="hs-identifier hs-var">mkTcRepReflCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><a href="TcEvidence.html#mkTcTyConAppCo"><span class="hs-identifier hs-var">mkTcTyConAppCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcAppCo"><span class="hs-identifier hs-var">mkTcAppCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcFunCo"><span class="hs-identifier hs-var">mkTcFunCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><a href="TcEvidence.html#mkTcAxInstCo"><span class="hs-identifier hs-var">mkTcAxInstCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkTcUnbranchedAxInstCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcForAllCo"><span class="hs-identifier hs-var">mkTcForAllCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcForAllCos"><span class="hs-identifier hs-var">mkTcForAllCos</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>  </span><a href="TcEvidence.html#mkTcSymCo"><span class="hs-identifier hs-var">mkTcSymCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcTransCo"><span class="hs-identifier hs-var">mkTcTransCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcNthCo"><span class="hs-identifier hs-var">mkTcNthCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcLRCo"><span class="hs-identifier hs-var">mkTcLRCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcSubCo"><span class="hs-identifier hs-var">mkTcSubCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#maybeTcSubCo"><span class="hs-identifier hs-var">maybeTcSubCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="TcEvidence.html#tcDowngradeRole"><span class="hs-identifier hs-var">tcDowngradeRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>  </span><a href="TcEvidence.html#mkTcAxiomRuleCo"><span class="hs-identifier hs-var">mkTcAxiomRuleCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcGReflRightCo"><span class="hs-identifier hs-var">mkTcGReflRightCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcGReflLeftCo"><span class="hs-identifier hs-var">mkTcGReflLeftCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkTcPhantomCo"><span class="hs-identifier hs-var">mkTcPhantomCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>  </span><a href="TcEvidence.html#mkTcCoherenceLeftCo"><span class="hs-identifier hs-var">mkTcCoherenceLeftCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="TcEvidence.html#mkTcCoherenceRightCo"><span class="hs-identifier hs-var">mkTcCoherenceRightCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><a href="TcEvidence.html#mkTcKindCo"><span class="hs-identifier hs-var">mkTcKindCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>  </span><a href="TcEvidence.html#tcCoercionKind"><span class="hs-identifier hs-var">tcCoercionKind</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#coVarsOfTcCo"><span class="hs-identifier hs-var">coVarsOfTcCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>  </span><a href="TcEvidence.html#mkTcCoVarCo"><span class="hs-identifier hs-var">mkTcCoVarCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#isTcReflexiveCo"><span class="hs-identifier hs-var">isTcReflexiveCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-identifier hs-var">tcCoercionRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>  </span><a href="TcEvidence.html#unwrapIP"><span class="hs-identifier hs-var">unwrapIP</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wrapIP"><span class="hs-identifier hs-var">wrapIP</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="PprCore.html"><span class="hs-identifier">PprCore</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Instance OutputableBndr TyVar</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span class="hs-special">(</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">,</span><span> </span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span class="hs-special">(</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span class="hs-special">,</span><span> </span><a href="DynFlags.html#GeneralFlag"><span class="hs-identifier hs-type">GeneralFlag</span></a><span class="hs-special">(</span><a href="DynFlags.html#Opt_PrintTypecheckerElaboration"><span class="hs-identifier hs-var">Opt_PrintTypecheckerElaboration</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Class.html#classSCSelId"><span class="hs-identifier hs-var">classSCSelId</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Id.html#isEvVar"><span class="hs-identifier hs-var">isEvVar</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="CoreFVs.html"><span class="hs-identifier">CoreFVs</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="CoreFVs.html#exprSomeFreeVars"><span class="hs-identifier hs-var">exprSomeFreeVars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Data</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Data</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSet.html"><span class="hs-identifier">UniqSet</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">{-
Note [TcCoercions]
~~~~~~~~~~~~~~~~~~
| TcCoercions are a hack used by the typechecker. Normally,
Coercions have free variables of type (a ~# b): we call these
CoVars. However, the type checker passes around equality evidence
(boxed up) at type (a ~ b).

An TcCoercion is simply a Coercion whose free variables have may be either
boxed or unboxed. After we are done with typechecking the desugarer finds the
boxed free variables, unboxes them, and creates a resulting real Coercion with
kosher free variables.

-}</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">type</span><span> </span><a name="TcCoercion"><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier">TcCoercion</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-97"></a><span class="hs-keyword">type</span><span> </span><a name="TcCoercionN"><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier">TcCoercionN</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionN"><span class="hs-identifier hs-type">CoercionN</span></a><span>    </span><span class="hs-comment">-- A Nominal          coercion ~N</span><span>
</span><a name="line-98"></a><span class="hs-keyword">type</span><span> </span><a name="TcCoercionR"><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier">TcCoercionR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionR"><span class="hs-identifier hs-type">CoercionR</span></a><span>    </span><span class="hs-comment">-- A Representational coercion ~R</span><span>
</span><a name="line-99"></a><span class="hs-keyword">type</span><span> </span><a name="TcCoercionP"><a href="TcEvidence.html#TcCoercionP"><span class="hs-identifier">TcCoercionP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionP"><span class="hs-identifier hs-type">CoercionP</span></a><span>    </span><span class="hs-comment">-- a phantom coercion</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">mkTcReflCo</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-102"></a><span class="hs-identifier">mkTcSymCo</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-103"></a><span class="hs-identifier">mkTcTransCo</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-104"></a><span class="hs-identifier">mkTcNomReflCo</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>
</span><a name="line-105"></a><span class="hs-identifier">mkTcRepReflCo</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>
</span><a name="line-106"></a><span class="hs-identifier">mkTcTyConAppCo</span><span>         </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-107"></a><span class="hs-identifier">mkTcAppCo</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-108"></a><span class="hs-identifier">mkTcFunCo</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-109"></a><span class="hs-identifier">mkTcAxInstCo</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="#local-6989586621683013037"><span class="hs-identifier hs-type">br</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#BranchIndex"><span class="hs-identifier hs-type">BranchIndex</span></a><span>
</span><a name="line-110"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-111"></a><span class="hs-identifier">mkTcUnbranchedAxInstCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="CoAxiom.html#Unbranched"><span class="hs-identifier hs-type">Unbranched</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">mkTcForAllCo</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-114"></a><span class="hs-identifier">mkTcForAllCos</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-115"></a><span class="hs-identifier">mkTcNthCo</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-116"></a><span class="hs-identifier">mkTcLRCo</span><span>               </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#LeftOrRight"><span class="hs-identifier hs-type">LeftOrRight</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-117"></a><span class="hs-identifier">mkTcSubCo</span><span>              </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>
</span><a name="line-118"></a><span class="hs-identifier">maybeTcSubCo</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-119"></a><span class="hs-identifier">tcDowngradeRole</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-120"></a><span class="hs-identifier">mkTcAxiomRuleCo</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#CoAxiomRule"><span class="hs-identifier hs-type">CoAxiomRule</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">mkTcGReflRightCo</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-122"></a><span class="hs-identifier">mkTcGReflLeftCo</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-123"></a><span class="hs-identifier">mkTcCoherenceLeftCo</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>
</span><a name="line-124"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-125"></a><span class="hs-identifier">mkTcCoherenceRightCo</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>
</span><a name="line-126"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-127"></a><span class="hs-identifier">mkTcPhantomCo</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionP"><span class="hs-identifier hs-type">TcCoercionP</span></a><span>
</span><a name="line-128"></a><span class="hs-identifier">mkTcKindCo</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>
</span><a name="line-129"></a><span class="hs-identifier">mkTcCoVarCo</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">tcCoercionKind</span><span>         </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-132"></a><span class="hs-identifier">tcCoercionRole</span><span>         </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-133"></a><span class="hs-identifier">coVarsOfTcCo</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcTyCoVarSet"><span class="hs-identifier hs-type">TcTyCoVarSet</span></a><span>
</span><a name="line-134"></a><span class="hs-identifier">isTcReflCo</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | This version does a slow check, calculating the related types and seeing</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- if they are equal.</span><span>
</span><a name="line-138"></a><span class="hs-identifier">isTcReflexiveCo</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><a name="mkTcReflCo"><a href="TcEvidence.html#mkTcReflCo"><span class="hs-identifier">mkTcReflCo</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span>
</span><a name="line-141"></a><a name="mkTcSymCo"><a href="TcEvidence.html#mkTcSymCo"><span class="hs-identifier">mkTcSymCo</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span>
</span><a name="line-142"></a><a name="mkTcTransCo"><a href="TcEvidence.html#mkTcTransCo"><span class="hs-identifier">mkTcTransCo</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span>
</span><a name="line-143"></a><a name="mkTcNomReflCo"><a href="TcEvidence.html#mkTcNomReflCo"><span class="hs-identifier">mkTcNomReflCo</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkNomReflCo"><span class="hs-identifier hs-var">mkNomReflCo</span></a><span>
</span><a name="line-144"></a><a name="mkTcRepReflCo"><a href="TcEvidence.html#mkTcRepReflCo"><span class="hs-identifier">mkTcRepReflCo</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkRepReflCo"><span class="hs-identifier hs-var">mkRepReflCo</span></a><span>
</span><a name="line-145"></a><a name="mkTcTyConAppCo"><a href="TcEvidence.html#mkTcTyConAppCo"><span class="hs-identifier">mkTcTyConAppCo</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a><span>
</span><a name="line-146"></a><a name="mkTcAppCo"><a href="TcEvidence.html#mkTcAppCo"><span class="hs-identifier">mkTcAppCo</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a><span>
</span><a name="line-147"></a><a name="mkTcFunCo"><a href="TcEvidence.html#mkTcFunCo"><span class="hs-identifier">mkTcFunCo</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a><span>
</span><a name="line-148"></a><a name="mkTcAxInstCo"><a href="TcEvidence.html#mkTcAxInstCo"><span class="hs-identifier">mkTcAxInstCo</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAxInstCo"><span class="hs-identifier hs-var">mkAxInstCo</span></a><span>
</span><a name="line-149"></a><a name="mkTcUnbranchedAxInstCo"><a href="TcEvidence.html#mkTcUnbranchedAxInstCo"><span class="hs-identifier">mkTcUnbranchedAxInstCo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkUnbranchedAxInstCo</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span>
</span><a name="line-150"></a><a name="mkTcForAllCo"><a href="TcEvidence.html#mkTcForAllCo"><span class="hs-identifier">mkTcForAllCo</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a><span>
</span><a name="line-151"></a><a name="mkTcForAllCos"><a href="TcEvidence.html#mkTcForAllCos"><span class="hs-identifier">mkTcForAllCos</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkForAllCos"><span class="hs-identifier hs-var">mkForAllCos</span></a><span>
</span><a name="line-152"></a><a name="mkTcNthCo"><a href="TcEvidence.html#mkTcNthCo"><span class="hs-identifier">mkTcNthCo</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a><span>
</span><a name="line-153"></a><a name="mkTcLRCo"><a href="TcEvidence.html#mkTcLRCo"><span class="hs-identifier">mkTcLRCo</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a><span>
</span><a name="line-154"></a><a name="mkTcSubCo"><a href="TcEvidence.html#mkTcSubCo"><span class="hs-identifier">mkTcSubCo</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a><span>
</span><a name="line-155"></a><a name="maybeTcSubCo"><a href="TcEvidence.html#maybeTcSubCo"><span class="hs-identifier">maybeTcSubCo</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#maybeSubCo"><span class="hs-identifier hs-var">maybeSubCo</span></a><span>
</span><a name="line-156"></a><a name="tcDowngradeRole"><a href="TcEvidence.html#tcDowngradeRole"><span class="hs-identifier">tcDowngradeRole</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#downgradeRole"><span class="hs-identifier hs-var">downgradeRole</span></a><span>
</span><a name="line-157"></a><a name="mkTcAxiomRuleCo"><a href="TcEvidence.html#mkTcAxiomRuleCo"><span class="hs-identifier">mkTcAxiomRuleCo</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAxiomRuleCo"><span class="hs-identifier hs-var">mkAxiomRuleCo</span></a><span>
</span><a name="line-158"></a><a name="mkTcGReflRightCo"><a href="TcEvidence.html#mkTcGReflRightCo"><span class="hs-identifier">mkTcGReflRightCo</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkGReflRightCo"><span class="hs-identifier hs-var">mkGReflRightCo</span></a><span>
</span><a name="line-159"></a><a name="mkTcGReflLeftCo"><a href="TcEvidence.html#mkTcGReflLeftCo"><span class="hs-identifier">mkTcGReflLeftCo</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkGReflLeftCo"><span class="hs-identifier hs-var">mkGReflLeftCo</span></a><span>
</span><a name="line-160"></a><a name="mkTcCoherenceLeftCo"><a href="TcEvidence.html#mkTcCoherenceLeftCo"><span class="hs-identifier">mkTcCoherenceLeftCo</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoherenceLeftCo"><span class="hs-identifier hs-var">mkCoherenceLeftCo</span></a><span>
</span><a name="line-161"></a><a name="mkTcCoherenceRightCo"><a href="TcEvidence.html#mkTcCoherenceRightCo"><span class="hs-identifier">mkTcCoherenceRightCo</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoherenceRightCo"><span class="hs-identifier hs-var">mkCoherenceRightCo</span></a><span>
</span><a name="line-162"></a><a name="mkTcPhantomCo"><a href="TcEvidence.html#mkTcPhantomCo"><span class="hs-identifier">mkTcPhantomCo</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkPhantomCo"><span class="hs-identifier hs-var">mkPhantomCo</span></a><span>
</span><a name="line-163"></a><a name="mkTcKindCo"><a href="TcEvidence.html#mkTcKindCo"><span class="hs-identifier">mkTcKindCo</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a><span>
</span><a name="line-164"></a><a name="mkTcCoVarCo"><a href="TcEvidence.html#mkTcCoVarCo"><span class="hs-identifier">mkTcCoVarCo</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><a name="tcCoercionKind"><a href="TcEvidence.html#tcCoercionKind"><span class="hs-identifier">tcCoercionKind</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a><span>
</span><a name="line-167"></a><a name="tcCoercionRole"><a href="TcEvidence.html#tcCoercionRole"><span class="hs-identifier">tcCoercionRole</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionRole"><span class="hs-identifier hs-var">coercionRole</span></a><span>
</span><a name="line-168"></a><a name="coVarsOfTcCo"><a href="TcEvidence.html#coVarsOfTcCo"><span class="hs-identifier">coVarsOfTcCo</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#coVarsOfCo"><span class="hs-identifier hs-var">coVarsOfCo</span></a><span>
</span><a name="line-169"></a><a name="isTcReflCo"><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier">isTcReflCo</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#isReflCo"><span class="hs-identifier hs-var">isReflCo</span></a><span>
</span><a name="line-170"></a><a name="isTcReflexiveCo"><a href="TcEvidence.html#isTcReflexiveCo"><span class="hs-identifier">isTcReflexiveCo</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                  HsWrapper
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-keyword">data</span><span> </span><a name="HsWrapper"><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier">HsWrapper</span></a></a><span>
</span><a name="line-181"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="WpHole"><a href="TcEvidence.html#WpHole"><span class="hs-identifier">WpHole</span></a></a><span>                      </span><span class="hs-comment">-- The identity coercion</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpCompose"><a href="TcEvidence.html#WpCompose"><span class="hs-identifier">WpCompose</span></a></a><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-184"></a><span>       </span><span class="hs-comment">-- (wrap1 `WpCompose` wrap2)[e] = wrap1[ wrap2[ e ]]</span><span>
</span><a name="line-185"></a><span>       </span><span class="hs-comment">--</span><span>
</span><a name="line-186"></a><span>       </span><span class="hs-comment">-- Hence  (\a. []) `WpCompose` (\b. []) = (\a b. [])</span><span>
</span><a name="line-187"></a><span>       </span><span class="hs-comment">-- But    ([] a)   `WpCompose` ([] b)   = ([] b a)</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpFun"><a href="TcEvidence.html#WpFun"><span class="hs-identifier">WpFun</span></a></a><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-190"></a><span>       </span><span class="hs-comment">-- (WpFun wrap1 wrap2 t1)[e] = \(x:t1). wrap2[ e wrap1[x] ]</span><span>
</span><a name="line-191"></a><span>       </span><span class="hs-comment">-- So note that if  wrap1 :: exp_arg &lt;= act_arg</span><span>
</span><a name="line-192"></a><span>       </span><span class="hs-comment">--                  wrap2 :: act_res &lt;= exp_res</span><span>
</span><a name="line-193"></a><span>       </span><span class="hs-comment">--           then   WpFun wrap1 wrap2 : (act_arg -&gt; arg_res) &lt;= (exp_arg -&gt; exp_res)</span><span>
</span><a name="line-194"></a><span>       </span><span class="hs-comment">-- This isn't the same as for mkFunCo, but it has to be this way</span><span>
</span><a name="line-195"></a><span>       </span><span class="hs-comment">-- because we can't use 'sym' to flip around these HsWrappers</span><span>
</span><a name="line-196"></a><span>       </span><span class="hs-comment">-- The TcType is the &quot;from&quot; type of the first wrapper</span><span>
</span><a name="line-197"></a><span>       </span><span class="hs-comment">-- The SDoc explains the circumstances under which we have created this</span><span>
</span><a name="line-198"></a><span>       </span><span class="hs-comment">-- WpFun, in case we run afoul of levity polymorphism restrictions in</span><span>
</span><a name="line-199"></a><span>       </span><span class="hs-comment">-- the desugarer. See Note [Levity polymorphism checking] in DsMonad</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpCast"><a href="TcEvidence.html#WpCast"><span class="hs-identifier">WpCast</span></a></a><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>        </span><span class="hs-comment">-- A cast:  [] `cast` co</span><span>
</span><a name="line-202"></a><span>                              </span><span class="hs-comment">-- Guaranteed not the identity coercion</span><span>
</span><a name="line-203"></a><span>                              </span><span class="hs-comment">-- At role Representational</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span>        </span><span class="hs-comment">-- Evidence abstraction and application</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-comment">-- (both dictionaries and coercions)</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpEvLam"><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier">WpEvLam</span></a></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>               </span><span class="hs-comment">-- \d. []       the 'd' is an evidence variable</span><span>
</span><a name="line-208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpEvApp"><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier">WpEvApp</span></a></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>              </span><span class="hs-comment">-- [] d         the 'd' is evidence for a constraint</span><span>
</span><a name="line-209"></a><span>        </span><span class="hs-comment">-- Kind and Type abstraction and application</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpTyLam"><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier">WpTyLam</span></a></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>       </span><span class="hs-comment">-- \a. []  the 'a' is a type/kind variable (not coercion var)</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpTyApp"><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier">WpTyApp</span></a></a><span> </span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span>  </span><span class="hs-comment">-- [] t    the 't' is a type (not coercion)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WpLet"><a href="TcEvidence.html#WpLet"><span class="hs-identifier">WpLet</span></a></a><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span>             </span><span class="hs-comment">-- Non-empty (or possibly non-empty) evidence bindings,</span><span>
</span><a name="line-215"></a><span>                                </span><span class="hs-comment">-- so that the identity coercion is always exactly WpHole</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- Cannot derive Data instance because SDoc is not Data (it stores a function).</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- So we do it manually:</span><span>
</span><a name="line-219"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>  </span><a name="local-8214565720323786787"><span class="hs-identifier">gfoldl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683013003"><a href="#local-6989586621683013003"><span class="hs-identifier">z</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013003"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013004"><a href="#local-6989586621683013004"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013005"><a href="#local-6989586621683013005"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a name="local-6989586621683013006"><a href="#local-6989586621683013006"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621683013007"><a href="#local-6989586621683013007"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013005"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013004"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013006"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013004"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013007"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-222"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013008"><a href="#local-6989586621683013008"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013009"><a href="#local-6989586621683013009"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a name="local-6989586621683013010"><a href="#local-6989586621683013010"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621683013011"><a href="#local-6989586621683013011"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621683013012"><a href="#local-6989586621683013012"><span class="hs-identifier">a3</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013009"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#wpFunEmpty"><span class="hs-identifier hs-var">wpFunEmpty</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013008"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013010"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013008"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013011"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013008"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013012"><span class="hs-identifier hs-var">a3</span></a><span>
</span><a name="line-223"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013013"><a href="#local-6989586621683013013"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013014"><a href="#local-6989586621683013014"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013015"><a href="#local-6989586621683013015"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013014"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013013"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013015"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-224"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013016"><a href="#local-6989586621683013016"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013017"><a href="#local-6989586621683013017"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a name="local-6989586621683013018"><a href="#local-6989586621683013018"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013017"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013016"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013018"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-225"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013019"><a href="#local-6989586621683013019"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013020"><a href="#local-6989586621683013020"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a name="local-6989586621683013021"><a href="#local-6989586621683013021"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013020"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013019"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013021"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-226"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013022"><a href="#local-6989586621683013022"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013023"><a href="#local-6989586621683013023"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a name="local-6989586621683013024"><a href="#local-6989586621683013024"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013023"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013022"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013024"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-227"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013025"><a href="#local-6989586621683013025"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013026"><a href="#local-6989586621683013026"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a name="local-6989586621683013027"><a href="#local-6989586621683013027"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013026"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013025"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013027"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-228"></a><span>  </span><span class="hs-identifier">gfoldl</span><span> </span><a name="local-6989586621683013028"><a href="#local-6989586621683013028"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013029"><a href="#local-6989586621683013029"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a name="local-6989586621683013030"><a href="#local-6989586621683013030"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013029"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621683013028"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013030"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span>  </span><a name="local-8214565720323786786"><span class="hs-identifier">gunfold</span></a><span> </span><a name="local-6989586621683013031"><a href="#local-6989586621683013031"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013032"><a href="#local-6989586621683013032"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621683013033"><a href="#local-6989586621683013033"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Data.constrIndex</span><span> </span><a href="#local-6989586621683013033"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-231"></a><span>                    </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-232"></a><span>                    </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>                    </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#wpFunEmpty"><span class="hs-identifier hs-var">wpFunEmpty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>                    </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>                    </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>                    </span><span class="hs-number">6</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>                    </span><span class="hs-number">7</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>                    </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013031"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013032"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span>  </span><a name="local-8214565720323786785"><span class="hs-identifier">toConstr</span></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpHole_constr"><span class="hs-identifier hs-var">wpHole_constr</span></a><span>
</span><a name="line-242"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpCompose_constr"><span class="hs-identifier hs-var">wpCompose_constr</span></a><span>
</span><a name="line-243"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpFun_constr"><span class="hs-identifier hs-var">wpFun_constr</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpCast_constr"><span class="hs-identifier hs-var">wpCast_constr</span></a><span>
</span><a name="line-245"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpEvLam_constr"><span class="hs-identifier hs-var">wpEvLam_constr</span></a><span>
</span><a name="line-246"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpEvApp_constr"><span class="hs-identifier hs-var">wpEvApp_constr</span></a><span>
</span><a name="line-247"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpTyLam_constr"><span class="hs-identifier hs-var">wpTyLam_constr</span></a><span>
</span><a name="line-248"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpTyApp_constr"><span class="hs-identifier hs-var">wpTyApp_constr</span></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#wpLet_constr"><span class="hs-identifier hs-var">wpLet_constr</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span>  </span><a name="local-8214565720323786784"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#hsWrapper_dataType"><span class="hs-identifier hs-var">hsWrapper_dataType</span></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-identifier">hsWrapper_dataType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data.DataType</span><span>
</span><a name="line-254"></a><a name="hsWrapper_dataType"><a href="TcEvidence.html#hsWrapper_dataType"><span class="hs-identifier">hsWrapper_dataType</span></a></a><span>
</span><a name="line-255"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Data.mkDataType</span><span> </span><span class="hs-string">&quot;HsWrapper&quot;</span><span>
</span><a name="line-256"></a><span>      </span><span class="hs-special">[</span><span> </span><a href="TcEvidence.html#wpHole_constr"><span class="hs-identifier hs-var">wpHole_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpCompose_constr"><span class="hs-identifier hs-var">wpCompose_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpFun_constr"><span class="hs-identifier hs-var">wpFun_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpCast_constr"><span class="hs-identifier hs-var">wpCast_constr</span></a><span>
</span><a name="line-257"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpEvLam_constr"><span class="hs-identifier hs-var">wpEvLam_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpEvApp_constr"><span class="hs-identifier hs-var">wpEvApp_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpTyLam_constr"><span class="hs-identifier hs-var">wpTyLam_constr</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpTyApp_constr"><span class="hs-identifier hs-var">wpTyApp_constr</span></a><span>
</span><a name="line-258"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#wpLet_constr"><span class="hs-identifier hs-var">wpLet_constr</span></a><span class="hs-special">]</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-identifier">wpHole_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpCompose_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpFun_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpCast_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpEvLam_constr</span><span class="hs-special">,</span><span>
</span><a name="line-261"></a><span>  </span><span class="hs-identifier">wpEvApp_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpTyLam_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpTyApp_constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wpLet_constr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data.Constr</span><span>
</span><a name="line-262"></a><a name="wpHole_constr"><a href="TcEvidence.html#wpHole_constr"><span class="hs-identifier">wpHole_constr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpHole&quot;</span><span>
</span><a name="line-263"></a><a name="wpCompose_constr"><a href="TcEvidence.html#wpCompose_constr"><span class="hs-identifier">wpCompose_constr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpCompose&quot;</span><span>
</span><a name="line-264"></a><a name="wpFun_constr"><a href="TcEvidence.html#wpFun_constr"><span class="hs-identifier">wpFun_constr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpFun&quot;</span><span>
</span><a name="line-265"></a><a name="wpCast_constr"><a href="TcEvidence.html#wpCast_constr"><span class="hs-identifier">wpCast_constr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpCast&quot;</span><span>
</span><a name="line-266"></a><a name="wpEvLam_constr"><a href="TcEvidence.html#wpEvLam_constr"><span class="hs-identifier">wpEvLam_constr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpEvLam&quot;</span><span>
</span><a name="line-267"></a><a name="wpEvApp_constr"><a href="TcEvidence.html#wpEvApp_constr"><span class="hs-identifier">wpEvApp_constr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpEvApp&quot;</span><span>
</span><a name="line-268"></a><a name="wpTyLam_constr"><a href="TcEvidence.html#wpTyLam_constr"><span class="hs-identifier">wpTyLam_constr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpTyLam&quot;</span><span>
</span><a name="line-269"></a><a name="wpTyApp_constr"><a href="TcEvidence.html#wpTyApp_constr"><span class="hs-identifier">wpTyApp_constr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpTyApp&quot;</span><span>
</span><a name="line-270"></a><a name="wpLet_constr"><a href="TcEvidence.html#wpLet_constr"><span class="hs-identifier">wpLet_constr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier hs-var">mkHsWrapperConstr</span></a><span> </span><span class="hs-string">&quot;WpLet&quot;</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-identifier">mkHsWrapperConstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Data.Constr</span><span>
</span><a name="line-273"></a><a name="mkHsWrapperConstr"><a href="TcEvidence.html#mkHsWrapperConstr"><span class="hs-identifier">mkHsWrapperConstr</span></a></a><span> </span><a name="local-6989586621683013038"><a href="#local-6989586621683013038"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Data.mkConstr</span><span> </span><a href="TcEvidence.html#hsWrapper_dataType"><span class="hs-identifier hs-var">hsWrapper_dataType</span></a><span> </span><a href="#local-6989586621683013038"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Data.Prefix</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">wpFunEmpty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-276"></a><a name="wpFunEmpty"><a href="TcEvidence.html#wpFunEmpty"><span class="hs-identifier">wpFunEmpty</span></a></a><span> </span><a name="local-6989586621683013039"><a href="#local-6989586621683013039"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621683013040"><a href="#local-6989586621683013040"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-6989586621683013041"><a href="#local-6989586621683013041"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a href="#local-6989586621683013039"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621683013040"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="#local-6989586621683013041"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-279"></a><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span> </span><a name="%3C.%3E"><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator">&lt;.&gt;</span></a></a><span> </span><a name="local-6989586621683013042"><a href="#local-6989586621683013042"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013042"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-280"></a><a name="local-6989586621683013043"><a href="#local-6989586621683013043"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-operator">&lt;.&gt;</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013043"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-281"></a><a name="local-6989586621683013044"><a href="#local-6989586621683013044"><span class="hs-identifier">c1</span></a></a><span> </span><span class="hs-operator">&lt;.&gt;</span><span> </span><a name="local-6989586621683013045"><a href="#local-6989586621683013045"><span class="hs-identifier">c2</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013044"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-special">`</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013045"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">mkWpFun</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-284"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>    </span><span class="hs-comment">-- the &quot;from&quot; type of the first wrapper</span><span>
</span><a name="line-285"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>    </span><span class="hs-comment">-- either type of the second wrapper (used only when the</span><span>
</span><a name="line-286"></a><span>                     </span><span class="hs-comment">-- second wrapper is the identity)</span><span>
</span><a name="line-287"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>      </span><span class="hs-comment">-- what caused you to want a WpFun? Something like &quot;When converting ...&quot;</span><span>
</span><a name="line-288"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-289"></a><a name="mkWpFun"><a href="TcEvidence.html#mkWpFun"><span class="hs-identifier">mkWpFun</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>       </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-290"></a><span class="hs-identifier">mkWpFun</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>       </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013046"><a href="#local-6989586621683013046"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683013047"><a href="#local-6989586621683013047"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcFunCo"><span class="hs-identifier hs-var">mkTcFunCo</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcRepReflCo"><span class="hs-identifier hs-var">mkTcRepReflCo</span></a><span> </span><a href="#local-6989586621683013047"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013046"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span class="hs-identifier">mkWpFun</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013048"><a href="#local-6989586621683013048"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>       </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621683013049"><a href="#local-6989586621683013049"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcFunCo"><span class="hs-identifier hs-var">mkTcFunCo</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcSymCo"><span class="hs-identifier hs-var">mkTcSymCo</span></a><span> </span><a href="#local-6989586621683013048"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcRepReflCo"><span class="hs-identifier hs-var">mkTcRepReflCo</span></a><span> </span><a href="#local-6989586621683013049"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span class="hs-identifier">mkWpFun</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013050"><a href="#local-6989586621683013050"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013051"><a href="#local-6989586621683013051"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcFunCo"><span class="hs-identifier hs-var">mkTcFunCo</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcSymCo"><span class="hs-identifier hs-var">mkTcSymCo</span></a><span> </span><a href="#local-6989586621683013050"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013051"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span class="hs-identifier">mkWpFun</span><span> </span><a name="local-6989586621683013052"><a href="#local-6989586621683013052"><span class="hs-identifier">co1</span></a></a><span>          </span><a name="local-6989586621683013053"><a href="#local-6989586621683013053"><span class="hs-identifier">co2</span></a></a><span>          </span><a name="local-6989586621683013054"><a href="#local-6989586621683013054"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621683013055"><a href="#local-6989586621683013055"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a href="#local-6989586621683013052"><span class="hs-identifier hs-var">co1</span></a><span> </span><a href="#local-6989586621683013053"><span class="hs-identifier hs-var">co2</span></a><span> </span><a href="#local-6989586621683013054"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621683013055"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-comment">-- | @mkWpFuns [(ty1, wrap1), (ty2, wrap2)] ty_res wrap_res@,</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- where @wrap1 :: ty1 &quot;-&gt;&quot; ty1'@ and @wrap2 :: ty2 &quot;-&gt;&quot; ty2'@,</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- @wrap3 :: ty3 &quot;-&gt;&quot; ty3'@ and @ty_res@ is /either/ @ty3@ or @ty3'@,</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- gives a wrapper @(ty1' -&gt; ty2' -&gt; ty3) &quot;-&gt;&quot; (ty1 -&gt; ty2 -&gt; ty3')@.</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- Notice that the result wrapper goes the other way round to all</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- the others. This is a result of sub-typing contravariance.</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- The SDoc is a description of what you were doing when you called mkWpFuns.</span><span>
</span><a name="line-302"></a><span class="hs-identifier">mkWpFuns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-303"></a><a name="mkWpFuns"><a href="TcEvidence.html#mkWpFuns"><span class="hs-identifier">mkWpFuns</span></a></a><span> </span><a name="local-6989586621683013056"><a href="#local-6989586621683013056"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621683013057"><a href="#local-6989586621683013057"><span class="hs-identifier">res_ty</span></a></a><span> </span><a name="local-6989586621683013058"><a href="#local-6989586621683013058"><span class="hs-identifier">res_wrap</span></a></a><span> </span><a name="local-6989586621683013059"><a href="#local-6989586621683013059"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621683013060"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013056"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621683013057"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><a href="#local-6989586621683013058"><span class="hs-identifier hs-var">res_wrap</span></a><span>
</span><a name="line-304"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-305"></a><span>    </span><a name="local-6989586621683013060"><a href="#local-6989586621683013060"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621683013061"><a href="#local-6989586621683013061"><span class="hs-identifier">res_ty</span></a></a><span> </span><a name="local-6989586621683013062"><a href="#local-6989586621683013062"><span class="hs-identifier">res_wrap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013061"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013062"><span class="hs-identifier hs-var">res_wrap</span></a><span class="hs-special">)</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621683013063"><a href="#local-6989586621683013063"><span class="hs-identifier">arg_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683013064"><a href="#local-6989586621683013064"><span class="hs-identifier">arg_wrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621683013065"><a href="#local-6989586621683013065"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683013066"><a href="#local-6989586621683013066"><span class="hs-identifier">res_ty</span></a></a><span> </span><a name="local-6989586621683013067"><a href="#local-6989586621683013067"><span class="hs-identifier">res_wrap</span></a></a><span>
</span><a name="line-307"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683013068"><a href="#local-6989586621683013068"><span class="hs-identifier">tail_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683013069"><a href="#local-6989586621683013069"><span class="hs-identifier">tail_wrap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013060"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013065"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621683013066"><span class="hs-identifier hs-var">res_ty</span></a><span> </span><a href="#local-6989586621683013067"><span class="hs-identifier hs-var">res_wrap</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-308"></a><span>        </span><span class="hs-special">(</span><a href="#local-6989586621683013063"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013068"><span class="hs-identifier hs-var">tail_ty</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#mkWpFun"><span class="hs-identifier hs-var">mkWpFun</span></a><span> </span><a href="#local-6989586621683013064"><span class="hs-identifier hs-var">arg_wrap</span></a><span> </span><a href="#local-6989586621683013069"><span class="hs-identifier hs-var">tail_wrap</span></a><span> </span><a href="#local-6989586621683013063"><span class="hs-identifier hs-var">arg_ty</span></a><span> </span><a href="#local-6989586621683013068"><span class="hs-identifier hs-var">tail_ty</span></a><span> </span><a href="#local-6989586621683013059"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-identifier">mkWpCastR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-311"></a><a name="mkWpCastR"><a href="TcEvidence.html#mkWpCastR"><span class="hs-identifier">mkWpCastR</span></a></a><span> </span><a name="local-6989586621683013070"><a href="#local-6989586621683013070"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-312"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span> </span><a href="#local-6989586621683013070"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-313"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span class="hs-identifier">tcCoercionRole</span><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">Representational</span><span class="hs-special">,</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span>                    </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a href="#local-6989586621683013070"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-identifier">mkWpCastN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-317"></a><a name="mkWpCastN"><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier">mkWpCastN</span></a></a><span> </span><a name="local-6989586621683013071"><a href="#local-6989586621683013071"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span> </span><a href="#local-6989586621683013071"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span class="hs-identifier">tcCoercionRole</span><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">Nominal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>                    </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkTcSubCo"><span class="hs-identifier hs-var">mkTcSubCo</span></a><span> </span><a href="#local-6989586621683013071"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>    </span><span class="hs-comment">-- The mkTcSubCo converts Nominal to Representational</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-identifier">mkWpTyApps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-324"></a><a name="mkWpTyApps"><a href="TcEvidence.html#mkWpTyApps"><span class="hs-identifier">mkWpTyApps</span></a></a><span> </span><a name="local-6989586621683013072"><a href="#local-6989586621683013072"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mk_co_app_fn"><span class="hs-identifier hs-var">mk_co_app_fn</span></a><span> </span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a href="#local-6989586621683013072"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">mkWpEvApps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-327"></a><a name="mkWpEvApps"><a href="TcEvidence.html#mkWpEvApps"><span class="hs-identifier">mkWpEvApps</span></a></a><span> </span><a name="local-6989586621683013073"><a href="#local-6989586621683013073"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mk_co_app_fn"><span class="hs-identifier hs-var">mk_co_app_fn</span></a><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a href="#local-6989586621683013073"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">mkWpEvVarApps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-330"></a><a name="mkWpEvVarApps"><a href="TcEvidence.html#mkWpEvVarApps"><span class="hs-identifier">mkWpEvVarApps</span></a></a><span> </span><a name="local-6989586621683013074"><a href="#local-6989586621683013074"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mk_co_app_fn"><span class="hs-identifier hs-var">mk_co_app_fn</span></a><span> </span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="TcEvidence.html#evId"><span class="hs-identifier hs-var">evId</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013074"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-identifier">mkWpTyLams</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-333"></a><a name="mkWpTyLams"><a href="TcEvidence.html#mkWpTyLams"><span class="hs-identifier">mkWpTyLams</span></a></a><span> </span><a name="local-6989586621683013075"><a href="#local-6989586621683013075"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mk_co_lam_fn"><span class="hs-identifier hs-var">mk_co_lam_fn</span></a><span> </span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a href="#local-6989586621683013075"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-identifier">mkWpLams</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-336"></a><a name="mkWpLams"><a href="TcEvidence.html#mkWpLams"><span class="hs-identifier">mkWpLams</span></a></a><span> </span><a name="local-6989586621683013076"><a href="#local-6989586621683013076"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mk_co_lam_fn"><span class="hs-identifier hs-var">mk_co_lam_fn</span></a><span> </span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a href="#local-6989586621683013076"><span class="hs-identifier hs-var">ids</span></a><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-identifier">mkWpLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- This no-op is a quite a common case</span><span>
</span><a name="line-340"></a><a name="mkWpLet"><a href="TcEvidence.html#mkWpLet"><span class="hs-identifier">mkWpLet</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a name="local-6989586621683013077"><a href="#local-6989586621683013077"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-6989586621683013077"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-341"></a><span class="hs-identifier">mkWpLet</span><span> </span><a name="local-6989586621683013078"><a href="#local-6989586621683013078"><span class="hs-identifier">ev_binds</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a href="#local-6989586621683013078"><span class="hs-identifier hs-var">ev_binds</span></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-identifier">mk_co_lam_fn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013036"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013036"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-344"></a><a name="mk_co_lam_fn"><a href="TcEvidence.html#mk_co_lam_fn"><span class="hs-identifier">mk_co_lam_fn</span></a></a><span> </span><a name="local-6989586621683013079"><a href="#local-6989586621683013079"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683013081"><a href="#local-6989586621683013081"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683013082"><a href="#local-6989586621683013082"><span class="hs-identifier">wrap</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013079"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621683013081"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621683013082"><span class="hs-identifier hs-var">wrap</span></a><span class="hs-special">)</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-identifier">mk_co_app_fn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013035"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013035"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-347"></a><span class="hs-comment">-- For applications, the *first* argument must</span><span>
</span><a name="line-348"></a><span class="hs-comment">-- come *last* in the composition sequence</span><span>
</span><a name="line-349"></a><a name="mk_co_app_fn"><a href="TcEvidence.html#mk_co_app_fn"><span class="hs-identifier">mk_co_app_fn</span></a></a><span> </span><a name="local-6989586621683013083"><a href="#local-6989586621683013083"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683013085"><a href="#local-6989586621683013085"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621683013086"><a href="#local-6989586621683013086"><span class="hs-identifier">wrap</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013086"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621683013083"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621683013085"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">idHsWrapper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span>
</span><a name="line-352"></a><a name="idHsWrapper"><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier">idHsWrapper</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-identifier">isIdHsWrapper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-355"></a><a name="isIdHsWrapper"><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier">isIdHsWrapper</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-356"></a><span class="hs-identifier">isIdHsWrapper</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-identifier">collectHsWrapBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- Collect the outer lambda binders of a HsWrapper,</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- stopping as soon as you get to a non-lambda binder</span><span>
</span><a name="line-361"></a><a name="collectHsWrapBinders"><a href="TcEvidence.html#collectHsWrapBinders"><span class="hs-identifier">collectHsWrapBinders</span></a></a><span> </span><a name="local-6989586621683013087"><a href="#local-6989586621683013087"><span class="hs-identifier">wrap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013088"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013087"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-362"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-363"></a><span>    </span><span class="hs-comment">-- go w ws = collectHsWrapBinders (w &lt;.&gt; w1 &lt;.&gt; ... &lt;.&gt; wn)</span><span>
</span><a name="line-364"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>    </span><a name="local-6989586621683013088"><a href="#local-6989586621683013088"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a name="local-6989586621683013091"><a href="#local-6989586621683013091"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>       </span><a name="local-6989586621683013092"><a href="#local-6989586621683013092"><span class="hs-identifier">wraps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013090"><span class="hs-identifier hs-var">add_lam</span></a><span> </span><a href="#local-6989586621683013091"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013089"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621683013092"><span class="hs-identifier hs-var">wraps</span></a><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a name="local-6989586621683013093"><a href="#local-6989586621683013093"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>       </span><a name="local-6989586621683013094"><a href="#local-6989586621683013094"><span class="hs-identifier">wraps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013090"><span class="hs-identifier hs-var">add_lam</span></a><span> </span><a href="#local-6989586621683013093"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013089"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621683013094"><span class="hs-identifier hs-var">wraps</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a name="local-6989586621683013095"><a href="#local-6989586621683013095"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621683013096"><a href="#local-6989586621683013096"><span class="hs-identifier">w2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621683013097"><a href="#local-6989586621683013097"><span class="hs-identifier">wraps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013088"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013095"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013096"><span class="hs-identifier hs-var">w2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683013097"><span class="hs-identifier hs-var">wraps</span></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683013098"><a href="#local-6989586621683013098"><span class="hs-identifier">wrap</span></a></a><span>              </span><a name="local-6989586621683013099"><a href="#local-6989586621683013099"><span class="hs-identifier">wraps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013098"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-6989586621683013099"><span class="hs-identifier hs-var">wraps</span></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span>    </span><a name="local-6989586621683013089"><a href="#local-6989586621683013089"><span class="hs-identifier">gos</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683013100"><a href="#local-6989586621683013100"><span class="hs-identifier">w</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621683013101"><a href="#local-6989586621683013101"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013088"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013100"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621683013101"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span>    </span><a name="local-6989586621683013090"><a href="#local-6989586621683013090"><span class="hs-identifier">add_lam</span></a></a><span> </span><a name="local-6989586621683013102"><a href="#local-6989586621683013102"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683013103"><a href="#local-6989586621683013103"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><a name="local-6989586621683013104"><a href="#local-6989586621683013104"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013102"><span class="hs-identifier hs-var">v</span></a><span class="hs-glyph">:</span><a href="#local-6989586621683013103"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013104"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                  Evidence bindings
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-keyword">data</span><span> </span><a name="TcEvBinds"><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier">TcEvBinds</span></a></a><span>
</span><a name="line-384"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TcEvBinds"><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier">TcEvBinds</span></a></a><span>           </span><span class="hs-comment">-- Mutable evidence bindings</span><span>
</span><a name="line-385"></a><span>       </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span>       </span><span class="hs-comment">-- Mutable because they are updated &quot;later&quot;</span><span>
</span><a name="line-386"></a><span>                        </span><span class="hs-comment">--    when an implication constraint is solved</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvBinds"><a href="TcEvidence.html#EvBinds"><span class="hs-identifier">EvBinds</span></a></a><span>             </span><span class="hs-comment">-- Immutable after zonking</span><span>
</span><a name="line-389"></a><span>       </span><span class="hs-special">(</span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-keyword">data</span><span> </span><a name="EvBindsVar"><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier">EvBindsVar</span></a></a><span>
</span><a name="line-392"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvBindsVar"><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier">EvBindsVar</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-393"></a><span>      </span><a name="ebv_uniq"><a href="TcEvidence.html#ebv_uniq"><span class="hs-identifier">ebv_uniq</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>
</span><a name="line-394"></a><span>         </span><span class="hs-comment">-- The Unique is for debug printing only</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span>      </span><a name="ebv_binds"><a href="TcEvidence.html#ebv_binds"><span class="hs-identifier">ebv_binds</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-397"></a><span>      </span><span class="hs-comment">-- The main payload: the value-level evidence bindings</span><span>
</span><a name="line-398"></a><span>      </span><span class="hs-comment">--     (dictionaries etc)</span><span>
</span><a name="line-399"></a><span>      </span><span class="hs-comment">-- Some Given, some Wanted</span><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span>      </span><a name="ebv_tcvs"><a href="TcEvidence.html#ebv_tcvs"><span class="hs-identifier">ebv_tcvs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VarSet.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a><span>
</span><a name="line-402"></a><span>      </span><span class="hs-comment">-- The free Given coercion vars needed by Wanted coercions that</span><span>
</span><a name="line-403"></a><span>      </span><span class="hs-comment">-- are solved by filling in their HoleDest in-place. Since they</span><span>
</span><a name="line-404"></a><span>      </span><span class="hs-comment">-- don't appear in ebv_binds, we keep track of their free</span><span>
</span><a name="line-405"></a><span>      </span><span class="hs-comment">-- variables so that we can report unused given constraints</span><span>
</span><a name="line-406"></a><span>      </span><span class="hs-comment">-- See Note [Tracking redundant constraints] in TcSimplify</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CoEvBindsVar"><a href="TcEvidence.html#CoEvBindsVar"><span class="hs-identifier">CoEvBindsVar</span></a></a><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- See Note [Coercion evidence only]</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span>      </span><span class="hs-comment">-- See above for comments on ebv_uniq, ebv_tcvs</span><span>
</span><a name="line-412"></a><span>      </span><a name="ebv_uniq"><a href="TcEvidence.html#ebv_uniq"><span class="hs-identifier">ebv_uniq</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span>
</span><a name="line-413"></a><span>      </span><a name="ebv_tcvs"><a href="TcEvidence.html#ebv_tcvs"><span class="hs-identifier">ebv_tcvs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VarSet.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a><span>
</span><a name="line-414"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-417"></a><span>  </span><span class="hs-comment">-- Placeholder; we can't travers into TcEvBinds</span><span>
</span><a name="line-418"></a><span>  </span><a name="local-8214565720323786785"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#abstractConstr"><span class="hs-identifier hs-var">abstractConstr</span></a><span> </span><span class="hs-string">&quot;TcEvBinds&quot;</span><span>
</span><a name="line-419"></a><span>  </span><a name="local-8214565720323786786"><span class="hs-identifier">gunfold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-420"></a><span>  </span><a name="local-8214565720323786784"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Data.mkNoRepType</span><span> </span><span class="hs-string">&quot;TcEvBinds&quot;</span><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">{- Note [Coercion evidence only]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Class constraints etc give rise to /term/ bindings for evidence, and
we have nowhere to put term bindings in /types/.  So in some places we
use CoEvBindsVar (see newCoTcEvBinds) to signal that no term-level
evidence bindings are allowed.  Notebly ():

  - Places in types where we are solving kind constraints (all of which
    are equalities); see solveEqualities, solveLocalEqualities,
    checkTvConstraints

  - When unifying forall-types
-}</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-identifier">isCoEvBindsVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-437"></a><a name="isCoEvBindsVar"><a href="TcEvidence.html#isCoEvBindsVar"><span class="hs-identifier">isCoEvBindsVar</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#CoEvBindsVar"><span class="hs-identifier hs-var">CoEvBindsVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-438"></a><span class="hs-identifier">isCoEvBindsVar</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-var">EvBindsVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-441"></a><span class="hs-keyword">newtype</span><span> </span><a name="EvBindMap"><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier">EvBindMap</span></a></a><span>
</span><a name="line-442"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvBindMap"><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier">EvBindMap</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-443"></a><span>       </span><a name="ev_bind_varenv"><a href="TcEvidence.html#ev_bind_varenv"><span class="hs-identifier">ev_bind_varenv</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#DVarEnv"><span class="hs-identifier hs-type">DVarEnv</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-444"></a><span>    </span><span class="hs-special">}</span><span>       </span><span class="hs-comment">-- Map from evidence variables to evidence terms</span><span>
</span><a name="line-445"></a><span>            </span><span class="hs-comment">-- We use @DVarEnv@ here to get deterministic ordering when we</span><span>
</span><a name="line-446"></a><span>            </span><span class="hs-comment">-- turn it into a Bag.</span><span>
</span><a name="line-447"></a><span>            </span><span class="hs-comment">-- If we don't do that, when we generate let bindings for</span><span>
</span><a name="line-448"></a><span>            </span><span class="hs-comment">-- dictionaries in dsTcEvBinds they will be generated in random</span><span>
</span><a name="line-449"></a><span>            </span><span class="hs-comment">-- order.</span><span>
</span><a name="line-450"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-451"></a><span>            </span><span class="hs-comment">-- For example:</span><span>
</span><a name="line-452"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-453"></a><span>            </span><span class="hs-comment">-- let $dEq = GHC.Classes.$fEqInt in</span><span>
</span><a name="line-454"></a><span>            </span><span class="hs-comment">-- let $$dNum = GHC.Num.$fNumInt in ...</span><span>
</span><a name="line-455"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-456"></a><span>            </span><span class="hs-comment">-- vs</span><span>
</span><a name="line-457"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-458"></a><span>            </span><span class="hs-comment">-- let $dNum = GHC.Num.$fNumInt in</span><span>
</span><a name="line-459"></a><span>            </span><span class="hs-comment">-- let $dEq = GHC.Classes.$fEqInt in ...</span><span>
</span><a name="line-460"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-461"></a><span>            </span><span class="hs-comment">-- See Note [Deterministic UniqFM] in UniqDFM for explanation why</span><span>
</span><a name="line-462"></a><span>            </span><span class="hs-comment">-- @UniqFM@ can lead to nondeterministic order.</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-identifier">emptyEvBindMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span>
</span><a name="line-465"></a><a name="emptyEvBindMap"><a href="TcEvidence.html#emptyEvBindMap"><span class="hs-identifier">emptyEvBindMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ev_bind_varenv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#emptyDVarEnv"><span class="hs-identifier hs-var">emptyDVarEnv</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-identifier">extendEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span>
</span><a name="line-468"></a><a name="extendEvBinds"><a href="TcEvidence.html#extendEvBinds"><span class="hs-identifier">extendEvBinds</span></a></a><span> </span><a name="local-6989586621683013105"><a href="#local-6989586621683013105"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621683013106"><a href="#local-6989586621683013106"><span class="hs-identifier">ev_bind</span></a></a><span>
</span><a name="line-469"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ev_bind_varenv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#extendDVarEnv"><span class="hs-identifier hs-var">extendDVarEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ev_bind_varenv</span><span> </span><a href="#local-6989586621683013105"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-470"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-identifier">eb_lhs</span><span> </span><a href="#local-6989586621683013106"><span class="hs-identifier hs-var">ev_bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>                                               </span><a href="#local-6989586621683013106"><span class="hs-identifier hs-var">ev_bind</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span class="hs-identifier">isEmptyEvBindMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-474"></a><a name="isEmptyEvBindMap"><a href="TcEvidence.html#isEmptyEvBindMap"><span class="hs-identifier">isEmptyEvBindMap</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><a name="local-6989586621683013107"><a href="#local-6989586621683013107"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#isEmptyDVarEnv"><span class="hs-identifier hs-var">isEmptyDVarEnv</span></a><span> </span><a href="#local-6989586621683013107"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span class="hs-identifier">lookupEvBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-477"></a><a name="lookupEvBind"><a href="TcEvidence.html#lookupEvBind"><span class="hs-identifier">lookupEvBind</span></a></a><span> </span><a name="local-6989586621683013108"><a href="#local-6989586621683013108"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#lookupDVarEnv"><span class="hs-identifier hs-var">lookupDVarEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ev_bind_varenv</span><span> </span><a href="#local-6989586621683013108"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-identifier">evBindMapBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-480"></a><a name="evBindMapBinds"><a href="TcEvidence.html#evBindMapBinds"><span class="hs-identifier">evBindMapBinds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#foldEvBindMap"><span class="hs-identifier hs-var">foldEvBindMap</span></a><span> </span><a href="Bag.html#consBag"><span class="hs-identifier hs-var">consBag</span></a><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-identifier">foldEvBindMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013034"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013034"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013034"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-483"></a><a name="foldEvBindMap"><a href="TcEvidence.html#foldEvBindMap"><span class="hs-identifier">foldEvBindMap</span></a></a><span> </span><a name="local-6989586621683013109"><a href="#local-6989586621683013109"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621683013110"><a href="#local-6989586621683013110"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621683013111"><a href="#local-6989586621683013111"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#foldDVarEnv"><span class="hs-identifier hs-var">foldDVarEnv</span></a><span> </span><a href="#local-6989586621683013109"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621683013110"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ev_bind_varenv</span><span> </span><a href="#local-6989586621683013111"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-identifier">filterEvBindMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span>
</span><a name="line-486"></a><a name="filterEvBindMap"><a href="TcEvidence.html#filterEvBindMap"><span class="hs-identifier">filterEvBindMap</span></a></a><span> </span><a name="local-6989586621683013112"><a href="#local-6989586621683013112"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ev_bind_varenv</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683013113"><a href="#local-6989586621683013113"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ev_bind_varenv</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#filterDVarEnv"><span class="hs-identifier hs-var">filterDVarEnv</span></a><span> </span><a href="#local-6989586621683013112"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621683013113"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-490"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-var">EvBindMap</span></a><span> </span><a name="local-6989586621683013002"><a href="#local-6989586621683013002"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013002"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">-----------------</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- All evidence is bound by EvBinds; no side effects</span><span>
</span><a name="line-494"></a><span class="hs-keyword">data</span><span> </span><a name="EvBind"><a href="TcEvidence.html#EvBind"><span class="hs-identifier">EvBind</span></a></a><span>
</span><a name="line-495"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvBind"><a href="TcEvidence.html#EvBind"><span class="hs-identifier">EvBind</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="eb_lhs"><a href="TcEvidence.html#eb_lhs"><span class="hs-identifier">eb_lhs</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-496"></a><span>           </span><span class="hs-special">,</span><span> </span><a name="eb_rhs"><a href="TcEvidence.html#eb_rhs"><span class="hs-identifier">eb_rhs</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-497"></a><span>           </span><span class="hs-special">,</span><span> </span><a name="eb_is_given"><a href="TcEvidence.html#eb_is_given"><span class="hs-identifier">eb_is_given</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- True &lt;=&gt; given</span><span>
</span><a name="line-498"></a><span>                 </span><span class="hs-comment">-- See Note [Tracking redundant constraints] in TcSimplify</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-identifier">evBindVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-502"></a><a name="evBindVar"><a href="TcEvidence.html#evBindVar"><span class="hs-identifier">evBindVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">eb_lhs</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span class="hs-identifier">mkWantedEvBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-505"></a><a name="mkWantedEvBind"><a href="TcEvidence.html#mkWantedEvBind"><span class="hs-identifier">mkWantedEvBind</span></a></a><span> </span><a name="local-6989586621683013114"><a href="#local-6989586621683013114"><span class="hs-identifier">ev</span></a></a><span> </span><a name="local-6989586621683013115"><a href="#local-6989586621683013115"><span class="hs-identifier">tm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_is_given</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013114"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013115"><span class="hs-identifier hs-var">tm</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-comment">-- EvTypeable are never given, so we can work with EvExpr here instead of EvTerm</span><span>
</span><a name="line-508"></a><span class="hs-identifier">mkGivenEvBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span>
</span><a name="line-509"></a><a name="mkGivenEvBind"><a href="TcEvidence.html#mkGivenEvBind"><span class="hs-identifier">mkGivenEvBind</span></a></a><span> </span><a name="local-6989586621683013116"><a href="#local-6989586621683013116"><span class="hs-identifier">ev</span></a></a><span> </span><a name="local-6989586621683013117"><a href="#local-6989586621683013117"><span class="hs-identifier">tm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_is_given</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013116"><span class="hs-identifier hs-var">ev</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013117"><span class="hs-identifier hs-var">tm</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span>
</span><a name="line-512"></a><span class="hs-comment">-- An EvTerm is, conceptually, a CoreExpr that implements the constraint.</span><span>
</span><a name="line-513"></a><span class="hs-comment">-- Unfortunately, we cannot just do</span><span>
</span><a name="line-514"></a><span class="hs-comment">--   type EvTerm  = CoreExpr</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- Because of staging problems issues around EvTypeable</span><span>
</span><a name="line-516"></a><span class="hs-keyword">data</span><span> </span><a name="EvTerm"><a href="TcEvidence.html#EvTerm"><span class="hs-identifier">EvTerm</span></a></a><span>
</span><a name="line-517"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvExpr"><a href="TcEvidence.html#EvExpr"><span class="hs-identifier">EvExpr</span></a></a><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvTypeable"><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier">EvTypeable</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span>   </span><span class="hs-comment">-- Dictionary for (Typeable ty)</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvFun"><a href="TcEvidence.html#EvFun"><span class="hs-identifier">EvFun</span></a></a><span>     </span><span class="hs-comment">-- /\as \ds. let binds in v</span><span>
</span><a name="line-522"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="et_tvs"><a href="TcEvidence.html#et_tvs"><span class="hs-identifier">et_tvs</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-523"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="et_given"><a href="TcEvidence.html#et_given"><span class="hs-identifier">et_given</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-524"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="et_binds"><a href="TcEvidence.html#et_binds"><span class="hs-identifier">et_binds</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-comment">-- This field is why we need an EvFun</span><span>
</span><a name="line-525"></a><span>                              </span><span class="hs-comment">-- constructor, and can't just use EvExpr</span><span>
</span><a name="line-526"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="et_body"><a href="TcEvidence.html#et_body"><span class="hs-identifier">et_body</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-keyword">type</span><span> </span><a name="EvExpr"><a href="TcEvidence.html#EvExpr"><span class="hs-identifier">EvExpr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span class="hs-comment">-- An EvTerm is (usually) constructed by any of the constructors here</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- and those more complicates ones who were moved to module TcEvTerm</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-comment">-- | Any sort of evidence Id, including coercions</span><span>
</span><a name="line-536"></a><span class="hs-identifier">evId</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="Var.html#EvId"><span class="hs-identifier hs-type">EvId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span>
</span><a name="line-537"></a><a name="evId"><a href="TcEvidence.html#evId"><span class="hs-identifier">evId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-comment">-- coercion bindings</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- See Note [Coercion evidence terms]</span><span>
</span><a name="line-541"></a><span class="hs-identifier">evCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-542"></a><a name="evCoercion"><a href="TcEvidence.html#evCoercion"><span class="hs-identifier">evCoercion</span></a></a><span> </span><a name="local-6989586621683013118"><a href="#local-6989586621683013118"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a href="#local-6989586621683013118"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- | d |&gt; co</span><span>
</span><a name="line-545"></a><span class="hs-identifier">evCast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-546"></a><a name="evCast"><a href="TcEvidence.html#evCast"><span class="hs-identifier">evCast</span></a></a><span> </span><a name="local-6989586621683013119"><a href="#local-6989586621683013119"><span class="hs-identifier">et</span></a></a><span> </span><a name="local-6989586621683013120"><a href="#local-6989586621683013120"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Coercion.html#isReflCo"><span class="hs-identifier hs-var">isReflCo</span></a><span> </span><a href="#local-6989586621683013120"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><a href="#local-6989586621683013119"><span class="hs-identifier hs-var">et</span></a><span>
</span><a name="line-547"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a href="#local-6989586621683013119"><span class="hs-identifier hs-var">et</span></a><span> </span><a href="#local-6989586621683013120"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-comment">-- Dictionary instance application</span><span>
</span><a name="line-550"></a><span class="hs-identifier">evDFunApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#DFunId"><span class="hs-identifier hs-type">DFunId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-551"></a><a name="evDFunApp"><a href="TcEvidence.html#evDFunApp"><span class="hs-identifier">evDFunApp</span></a></a><span> </span><a name="local-6989586621683013121"><a href="#local-6989586621683013121"><span class="hs-identifier">df</span></a></a><span> </span><a name="local-6989586621683013122"><a href="#local-6989586621683013122"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621683013123"><a href="#local-6989586621683013123"><span class="hs-identifier">ets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621683013121"><span class="hs-identifier hs-var">df</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkTyApps"><span class="hs-identifier hs-var">mkTyApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013122"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013123"><span class="hs-identifier hs-var">ets</span></a><span>
</span><a name="line-552"></a><span>
</span><a name="line-553"></a><span class="hs-identifier">evDataConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-554"></a><a name="evDataConApp"><a href="TcEvidence.html#evDataConApp"><span class="hs-identifier">evDataConApp</span></a></a><span> </span><a name="local-6989586621683013124"><a href="#local-6989586621683013124"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621683013125"><a href="#local-6989586621683013125"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621683013126"><a href="#local-6989586621683013126"><span class="hs-identifier">ets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#evDFunApp"><span class="hs-identifier hs-var">evDFunApp</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a><span> </span><a href="#local-6989586621683013124"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013125"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621683013126"><span class="hs-identifier hs-var">ets</span></a><span>
</span><a name="line-555"></a><span>
</span><a name="line-556"></a><span class="hs-comment">-- Selector id plus the types at which it</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- should be instantiated, used for HasField</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- dictionaries; see Note [HasField instances]</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- in TcInterface</span><span>
</span><a name="line-560"></a><span class="hs-identifier">evSelector</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span>
</span><a name="line-561"></a><a name="evSelector"><a href="TcEvidence.html#evSelector"><span class="hs-identifier">evSelector</span></a></a><span> </span><a name="local-6989586621683013127"><a href="#local-6989586621683013127"><span class="hs-identifier">sel_id</span></a></a><span> </span><a name="local-6989586621683013128"><a href="#local-6989586621683013128"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621683013129"><a href="#local-6989586621683013129"><span class="hs-identifier">tms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621683013127"><span class="hs-identifier hs-var">sel_id</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkTyApps"><span class="hs-identifier hs-var">mkTyApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013128"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013129"><span class="hs-identifier hs-var">tms</span></a><span>
</span><a name="line-562"></a><span>
</span><a name="line-563"></a><span class="hs-comment">-- Dictionary for (Typeable ty)</span><span>
</span><a name="line-564"></a><span class="hs-identifier">evTypeable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-565"></a><a name="evTypeable"><a href="TcEvidence.html#evTypeable"><span class="hs-identifier">evTypeable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-comment">-- | Instructions on how to make a 'Typeable' dictionary.</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- See Note [Typeable evidence terms]</span><span>
</span><a name="line-569"></a><span class="hs-keyword">data</span><span> </span><a name="EvTypeable"><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier">EvTypeable</span></a></a><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvTypeableTyCon"><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier">EvTypeableTyCon</span></a></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">]</span><span>
</span><a name="line-571"></a><span>    </span><span class="hs-comment">-- ^ Dictionary for @Typeable T@ where @T@ is a type constructor with all of</span><span>
</span><a name="line-572"></a><span>    </span><span class="hs-comment">-- its kind variables saturated. The @[EvTerm]@ is @Typeable@ evidence for</span><span>
</span><a name="line-573"></a><span>    </span><span class="hs-comment">-- the applied kinds..</span><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvTypeableTyApp"><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier">EvTypeableTyApp</span></a></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-576"></a><span>    </span><span class="hs-comment">-- ^ Dictionary for @Typeable (s t)@,</span><span>
</span><a name="line-577"></a><span>    </span><span class="hs-comment">-- given a dictionaries for @s@ and @t@.</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvTypeableTrFun"><a href="TcEvidence.html#EvTypeableTrFun"><span class="hs-identifier">EvTypeableTrFun</span></a></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-580"></a><span>    </span><span class="hs-comment">-- ^ Dictionary for @Typeable (s -&gt; t)@,</span><span>
</span><a name="line-581"></a><span>    </span><span class="hs-comment">-- given a dictionaries for @s@ and @t@.</span><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvTypeableTyLit"><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier">EvTypeableTyLit</span></a></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-584"></a><span>    </span><span class="hs-comment">-- ^ Dictionary for a type literal,</span><span>
</span><a name="line-585"></a><span>    </span><span class="hs-comment">-- e.g. @Typeable &quot;foo&quot;@ or @Typeable 3@</span><span>
</span><a name="line-586"></a><span>    </span><span class="hs-comment">-- The 'EvTerm' is evidence of, e.g., @KnownNat 3@</span><span>
</span><a name="line-587"></a><span>    </span><span class="hs-comment">-- (see Trac #10348)</span><span>
</span><a name="line-588"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span>
</span><a name="line-589"></a><span>
</span><a name="line-590"></a><span class="hs-comment">-- | Evidence for @CallStack@ implicit parameters.</span><span>
</span><a name="line-591"></a><span class="hs-keyword">data</span><span> </span><a name="EvCallStack"><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier">EvCallStack</span></a></a><span>
</span><a name="line-592"></a><span>  </span><span class="hs-comment">-- See Note [Overview of implicit CallStacks]</span><span>
</span><a name="line-593"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="EvCsEmpty"><a href="TcEvidence.html#EvCsEmpty"><span class="hs-identifier">EvCsEmpty</span></a></a><span>
</span><a name="line-594"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EvCsPushCall"><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier">EvCsPushCall</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span>
</span><a name="line-595"></a><span>    </span><span class="hs-comment">-- ^ @EvCsPushCall name loc stk@ represents a call to @name@, occurring at</span><span>
</span><a name="line-596"></a><span>    </span><span class="hs-comment">-- @loc@, in a calling context @stk@.</span><span>
</span><a name="line-597"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Data.Data</span><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span class="hs-comment">{-
Note [Typeable evidence terms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The EvTypeable data type looks isomorphic to Type, but the EvTerms
inside can be EvIds.  Eg
    f :: forall a. Typeable a =&gt; a -&gt; TypeRep
    f x = typeRep (undefined :: Proxy [a])
Here for the (Typeable [a]) dictionary passed to typeRep we make
evidence
    dl :: Typeable [a] = EvTypeable [a]
                            (EvTypeableTyApp (EvTypeableTyCon []) (EvId d))
where
    d :: Typable a
is the lambda-bound dictionary passed into f.

Note [Coercion evidence terms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A &quot;coercion evidence term&quot; takes one of these forms
   co_tm ::= EvId v           where v :: t1 ~# t2
           | EvCoercion co
           | EvCast co_tm co

We do quite often need to get a TcCoercion from an EvTerm; see
'evTermCoercion'.

INVARIANT: The evidence for any constraint with type (t1 ~# t2) is
a coercion evidence term.  Consider for example
    [G] d :: F Int a
If we have
    ax7 a :: F Int a ~ (a ~ Bool)
then we do NOT generate the constraint
    [G] (d |&gt; ax7 a) :: a ~ Bool
because that does not satisfy the invariant (d is not a coercion variable).
Instead we make a binding
    g1 :: a~Bool = g |&gt; ax7 a
and the constraint
    [G] g1 :: a~Bool
See Trac [7238] and Note [Bind new Givens immediately] in TcRnTypes

Note [EvBinds/EvTerm]
~~~~~~~~~~~~~~~~~~~~~
How evidence is created and updated. Bindings for dictionaries,
and coercions and implicit parameters are carried around in TcEvBinds
which during constraint generation and simplification is always of the
form (TcEvBinds ref). After constraint simplification is finished it
will be transformed to t an (EvBinds ev_bag).

Evidence for coercions *SHOULD* be filled in using the TcEvBinds
However, all EvVars that correspond to *wanted* coercion terms in
an EvBind must be mutable variables so that they can be readily
inlined (by zonking) after constraint simplification is finished.

Conclusion: a new wanted coercion variable should be made mutable.
[Notice though that evidence variables that bind coercion terms
 from super classes will be &quot;given&quot; and hence rigid]


Note [Overview of implicit CallStacks]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(See https://ghc.haskell.org/trac/ghc/wiki/ExplicitCallStack/ImplicitLocations)

The goal of CallStack evidence terms is to reify locations
in the program source as runtime values, without any support
from the RTS. We accomplish this by assigning a special meaning
to constraints of type GHC.Stack.Types.HasCallStack, an alias

  type HasCallStack = (?callStack :: CallStack)

Implicit parameters of type GHC.Stack.Types.CallStack (the name is not
important) are solved in three steps:

1. Occurrences of CallStack IPs are solved directly from the given IP,
   just like a regular IP. For example, the occurrence of `?stk` in

     error :: (?stk :: CallStack) =&gt; String -&gt; a
     error s = raise (ErrorCall (s ++ prettyCallStack ?stk))

   will be solved for the `?stk` in `error`s context as before.

2. In a function call, instead of simply passing the given IP, we first
   append the current call-site to it. For example, consider a
   call to the callstack-aware `error` above.

     undefined :: (?stk :: CallStack) =&gt; a
     undefined = error &quot;undefined!&quot;

   Here we want to take the given `?stk` and append the current
   call-site, before passing it to `error`. In essence, we want to
   rewrite `error &quot;undefined!&quot;` to

     let ?stk = pushCallStack &lt;error's location&gt; ?stk
     in error &quot;undefined!&quot;

   We achieve this effect by emitting a NEW wanted

     [W] d :: IP &quot;stk&quot; CallStack

   from which we build the evidence term

     EvCsPushCall &quot;error&quot; &lt;error's location&gt; (EvId d)

   that we use to solve the call to `error`. The new wanted `d` will
   then be solved per rule (1), ie as a regular IP.

   (see TcInteract.interactDict)

3. We default any insoluble CallStacks to the empty CallStack. Suppose
   `undefined` did not request a CallStack, ie

     undefinedNoStk :: a
     undefinedNoStk = error &quot;undefined!&quot;

   Under the usual IP rules, the new wanted from rule (2) would be
   insoluble as there's no given IP from which to solve it, so we
   would get an &quot;unbound implicit parameter&quot; error.

   We don't ever want to emit an insoluble CallStack IP, so we add a
   defaulting pass to default any remaining wanted CallStacks to the
   empty CallStack with the evidence term

     EvCsEmpty

   (see TcSimplify.simpl_top and TcSimplify.defaultCallStacks)

This provides a lightweight mechanism for building up call-stacks
explicitly, but is notably limited by the fact that the stack will
stop at the first function whose type does not include a CallStack IP.
For example, using the above definition of `undefined`:

  head :: [a] -&gt; a
  head []    = undefined
  head (x:_) = x

  g = head []

the resulting CallStack will include the call to `undefined` in `head`
and the call to `error` in `undefined`, but *not* the call to `head`
in `g`, because `head` did not explicitly request a CallStack.


Important Details:
- GHC should NEVER report an insoluble CallStack constraint.

- GHC should NEVER infer a CallStack constraint unless one was requested
  with a partial type signature (See TcType.pickQuantifiablePreds).

- A CallStack (defined in GHC.Stack.Types) is a [(String, SrcLoc)],
  where the String is the name of the binder that is used at the
  SrcLoc. SrcLoc is also defined in GHC.Stack.Types and contains the
  package/module/file name, as well as the full source-span. Both
  CallStack and SrcLoc are kept abstract so only GHC can construct new
  values.

- We will automatically solve any wanted CallStack regardless of the
  name of the IP, i.e.

    f = show (?stk :: CallStack)
    g = show (?loc :: CallStack)

  are both valid. However, we will only push new SrcLocs onto existing
  CallStacks when the IP names match, e.g. in

    head :: (?loc :: CallStack) =&gt; [a] -&gt; a
    head [] = error (show (?stk :: CallStack))

  the printed CallStack will NOT include head's call-site. This reflects the
  standard scoping rules of implicit-parameters.

- An EvCallStack term desugars to a CoreExpr of type `IP &quot;some str&quot; CallStack`.
  The desugarer will need to unwrap the IP newtype before pushing a new
  call-site onto a given stack (See DsBinds.dsEvCallStack)

- When we emit a new wanted CallStack from rule (2) we set its origin to
  `IPOccOrigin ip_name` instead of the original `OccurrenceOf func`
  (see TcInteract.interactDict).

  This is a bit shady, but is how we ensure that the new wanted is
  solved like a regular IP.

-}</span><span>
</span><a name="line-779"></a><span>
</span><a name="line-780"></a><span class="hs-identifier">mkEvCast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span>
</span><a name="line-781"></a><a name="mkEvCast"><a href="TcEvidence.html#mkEvCast"><span class="hs-identifier">mkEvCast</span></a></a><span> </span><a name="local-6989586621683013130"><a href="#local-6989586621683013130"><span class="hs-identifier">ev</span></a></a><span> </span><a name="local-6989586621683013131"><a href="#local-6989586621683013131"><span class="hs-identifier">lco</span></a></a><span>
</span><a name="line-782"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tcCoercionRole</span><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-identifier hs-var">lco</span></a><span> </span><a href="TcEvidence.html#tcCoercionRole"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-identifier">Representational</span><span>
</span><a name="line-783"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">vcat</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;Coercion of wrong role passed to mkEvCast:&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ev</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">lco</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>    </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span> </span><a href="#local-6989586621683013131"><span class="hs-identifier hs-var">lco</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><a href="#local-6989586621683013130"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-785"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#evCast"><span class="hs-identifier hs-var">evCast</span></a><span> </span><a href="#local-6989586621683013130"><span class="hs-identifier hs-var">ev</span></a><span> </span><a href="#local-6989586621683013131"><span class="hs-identifier hs-var">lco</span></a><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span class="hs-identifier">mkEvScSelectors</span><span>         </span><span class="hs-comment">-- Assume   class (..., D ty, ...) =&gt; C a b</span><span>
</span><a name="line-789"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- C ty1 ty2</span><span>
</span><a name="line-790"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="TcType.html#TcPredType"><span class="hs-identifier hs-type">TcPredType</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- D ty[ty1/a,ty2/b]</span><span>
</span><a name="line-791"></a><span>       </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- :: C ty1 ty2 -&gt; D ty[ty1/a,ty2/b]</span><span>
</span><a name="line-792"></a><span>     </span><span class="hs-special">]</span><span>
</span><a name="line-793"></a><a name="mkEvScSelectors"><a href="TcEvidence.html#mkEvScSelectors"><span class="hs-identifier">mkEvScSelectors</span></a></a><span> </span><a name="local-6989586621683013132"><a href="#local-6989586621683013132"><span class="hs-identifier">cls</span></a></a><span> </span><a name="local-6989586621683013133"><a href="#local-6989586621683013133"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-794"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621683013134"><span class="hs-identifier hs-var">mk_pr</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#immSuperClasses"><span class="hs-identifier hs-var">immSuperClasses</span></a><span> </span><a href="#local-6989586621683013132"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-6989586621683013133"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-795"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-796"></a><span>    </span><a name="local-6989586621683013134"><a href="#local-6989586621683013134"><span class="hs-identifier">mk_pr</span></a></a><span> </span><a name="local-6989586621683013135"><a href="#local-6989586621683013135"><span class="hs-identifier">pred</span></a></a><span> </span><a name="local-6989586621683013136"><a href="#local-6989586621683013136"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013135"><span class="hs-identifier hs-var">pred</span></a><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621683013137"><span class="hs-identifier hs-var">sc_sel_id</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkTyApps"><span class="hs-identifier hs-var">mkTyApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013133"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-798"></a><span>        </span><a name="local-6989586621683013137"><a href="#local-6989586621683013137"><span class="hs-identifier">sc_sel_id</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Class.html#classSCSelId"><span class="hs-identifier hs-var">classSCSelId</span></a><span> </span><a href="#local-6989586621683013132"><span class="hs-identifier hs-var">cls</span></a><span> </span><a href="#local-6989586621683013136"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-comment">-- Zero-indexed</span><span>
</span><a name="line-799"></a><span>
</span><a name="line-800"></a><span class="hs-identifier">emptyTcEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span>
</span><a name="line-801"></a><a name="emptyTcEvBinds"><a href="TcEvidence.html#emptyTcEvBinds"><span class="hs-identifier">emptyTcEvBinds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">isEmptyTcEvBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-804"></a><a name="isEmptyTcEvBinds"><a href="TcEvidence.html#isEmptyTcEvBinds"><span class="hs-identifier">isEmptyTcEvBinds</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a name="local-6989586621683013138"><a href="#local-6989586621683013138"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-6989586621683013138"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-805"></a><span class="hs-identifier">isEmptyTcEvBinds</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-var">TcEvBinds</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;isEmptyTcEvBinds&quot;</span><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span class="hs-identifier">evTermCoercion_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-808"></a><span class="hs-comment">-- Applied only to EvTerms of type (s~t)</span><span>
</span><a name="line-809"></a><span class="hs-comment">-- See Note [Coercion evidence terms]</span><span>
</span><a name="line-810"></a><a name="evTermCoercion_maybe"><a href="TcEvidence.html#evTermCoercion_maybe"><span class="hs-identifier">evTermCoercion_maybe</span></a></a><span> </span><a name="local-6989586621683013139"><a href="#local-6989586621683013139"><span class="hs-identifier">ev_term</span></a></a><span>
</span><a name="line-811"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><a name="local-6989586621683013146"><a href="#local-6989586621683013146"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683013139"><span class="hs-identifier hs-var">ev_term</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013140"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013146"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-812"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-813"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-814"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-type">EvExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-815"></a><span>    </span><a name="local-6989586621683013140"><a href="#local-6989586621683013140"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621683013141"><a href="#local-6989586621683013141"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a><span> </span><a href="#local-6989586621683013141"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-816"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Coercion"><span class="hs-identifier hs-var">Coercion</span></a><span> </span><a name="local-6989586621683013142"><a href="#local-6989586621683013142"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621683013142"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-817"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Cast"><span class="hs-identifier hs-var">Cast</span></a><span> </span><a name="local-6989586621683013143"><a href="#local-6989586621683013143"><span class="hs-identifier">tm</span></a></a><span> </span><a name="local-6989586621683013144"><a href="#local-6989586621683013144"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621683013145"><a href="#local-6989586621683013145"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683013140"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683013143"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-818"></a><span>                          </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Coercion.html#mkCoCast"><span class="hs-identifier hs-var">mkCoCast</span></a><span> </span><a href="#local-6989586621683013145"><span class="hs-identifier hs-var">co'</span></a><span> </span><a href="#local-6989586621683013144"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-819"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span class="hs-identifier">evTermCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#TcCoercion"><span class="hs-identifier hs-type">TcCoercion</span></a><span>
</span><a name="line-822"></a><a name="evTermCoercion"><a href="TcEvidence.html#evTermCoercion"><span class="hs-identifier">evTermCoercion</span></a></a><span> </span><a name="local-6989586621683013147"><a href="#local-6989586621683013147"><span class="hs-identifier">tm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TcEvidence.html#evTermCoercion_maybe"><span class="hs-identifier hs-var">evTermCoercion_maybe</span></a><span> </span><a href="#local-6989586621683013147"><span class="hs-identifier hs-var">tm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-823"></a><span>                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683013148"><a href="#local-6989586621683013148"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013148"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-824"></a><span>                      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;evTermCoercion&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013147"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
                  Free variables
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-832"></a><span>
</span><a name="line-833"></a><span class="hs-identifier">findNeededEvVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvBindMap"><span class="hs-identifier hs-type">EvBindMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-834"></a><span class="hs-comment">-- Find all the Given evidence needed by seeds,</span><span>
</span><a name="line-835"></a><span class="hs-comment">-- looking transitively through binds</span><span>
</span><a name="line-836"></a><a name="findNeededEvVars"><a href="TcEvidence.html#findNeededEvVars"><span class="hs-identifier">findNeededEvVars</span></a></a><span> </span><a name="local-6989586621683013149"><a href="#local-6989586621683013149"><span class="hs-identifier">ev_binds</span></a></a><span> </span><a name="local-6989586621683013150"><a href="#local-6989586621683013150"><span class="hs-identifier">seeds</span></a></a><span>
</span><a name="line-837"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#transCloVarSet"><span class="hs-identifier hs-var">transCloVarSet</span></a><span> </span><a href="#local-6989586621683013151"><span class="hs-identifier hs-var">also_needs</span></a><span> </span><a href="#local-6989586621683013150"><span class="hs-identifier hs-var">seeds</span></a><span>
</span><a name="line-838"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-839"></a><span>   </span><span class="hs-identifier">also_needs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-840"></a><span>   </span><a name="local-6989586621683013151"><a href="#local-6989586621683013151"><span class="hs-identifier">also_needs</span></a></a><span> </span><a name="local-6989586621683013153"><a href="#local-6989586621683013153"><span class="hs-identifier">needs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#nonDetFoldUniqSet"><span class="hs-identifier hs-var">nonDetFoldUniqSet</span></a><span> </span><a href="#local-6989586621683013152"><span class="hs-identifier hs-var">add</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><a href="#local-6989586621683013153"><span class="hs-identifier hs-var">needs</span></a><span>
</span><a name="line-841"></a><span>     </span><span class="hs-comment">-- It's OK to use nonDetFoldUFM here because we immediately</span><span>
</span><a name="line-842"></a><span>     </span><span class="hs-comment">-- forget about the ordering by creating a set</span><span>
</span><a name="line-843"></a><span>
</span><a name="line-844"></a><span>   </span><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-845"></a><span>   </span><a name="local-6989586621683013152"><a href="#local-6989586621683013152"><span class="hs-identifier">add</span></a></a><span> </span><a name="local-6989586621683013154"><a href="#local-6989586621683013154"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621683013155"><a href="#local-6989586621683013155"><span class="hs-identifier">needs</span></a></a><span>
</span><a name="line-846"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621683013156"><a href="#local-6989586621683013156"><span class="hs-identifier">ev_bind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEvidence.html#lookupEvBind"><span class="hs-identifier hs-var">lookupEvBind</span></a><span> </span><a href="#local-6989586621683013149"><span class="hs-identifier hs-var">ev_binds</span></a><span> </span><a href="#local-6989586621683013154"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-847"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_is_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683013157"><a href="#local-6989586621683013157"><span class="hs-identifier">is_given</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683013158"><a href="#local-6989586621683013158"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683013156"><span class="hs-identifier hs-var">ev_bind</span></a><span>
</span><a name="line-848"></a><span>     </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013157"><span class="hs-identifier hs-var">is_given</span></a><span>
</span><a name="line-849"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier hs-var">evVarsOfTerm</span></a><span> </span><a href="#local-6989586621683013158"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683013155"><span class="hs-identifier hs-var">needs</span></a><span>
</span><a name="line-850"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-851"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013155"><span class="hs-identifier hs-var">needs</span></a><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-identifier">evVarsOfTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-854"></a><a name="evVarsOfTerm"><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier">evVarsOfTerm</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><a name="local-6989586621683013159"><a href="#local-6989586621683013159"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="CoreFVs.html#exprSomeFreeVars"><span class="hs-identifier hs-var">exprSomeFreeVars</span></a><span> </span><a href="Id.html#isEvVar"><span class="hs-identifier hs-var">isEvVar</span></a><span> </span><a href="#local-6989586621683013159"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-855"></a><span class="hs-identifier">evVarsOfTerm</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683013160"><a href="#local-6989586621683013160"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#evVarsOfTypeable"><span class="hs-identifier hs-var">evVarsOfTypeable</span></a><span> </span><a href="#local-6989586621683013160"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-856"></a><span class="hs-identifier">evVarsOfTerm</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvFun"><span class="hs-identifier hs-var">EvFun</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><span class="hs-comment">-- See Note [Free vars of EvFun]</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span class="hs-identifier">evVarsOfTerms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-859"></a><a name="evVarsOfTerms"><a href="TcEvidence.html#evVarsOfTerms"><span class="hs-identifier">evVarsOfTerms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#mapUnionVarSet"><span class="hs-identifier hs-var">mapUnionVarSet</span></a><span> </span><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier hs-var">evVarsOfTerm</span></a><span>
</span><a name="line-860"></a><span>
</span><a name="line-861"></a><span class="hs-identifier">evVarsOfTypeable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span>
</span><a name="line-862"></a><a name="evVarsOfTypeable"><a href="TcEvidence.html#evVarsOfTypeable"><span class="hs-identifier">evVarsOfTypeable</span></a></a><span> </span><a name="local-6989586621683013161"><a href="#local-6989586621683013161"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-863"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683013161"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-864"></a><span>    </span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683013162"><a href="#local-6989586621683013162"><span class="hs-identifier">e</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VarSet.html#mapUnionVarSet"><span class="hs-identifier hs-var">mapUnionVarSet</span></a><span> </span><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier hs-var">evVarsOfTerm</span></a><span> </span><a href="#local-6989586621683013162"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-865"></a><span>    </span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a name="local-6989586621683013163"><a href="#local-6989586621683013163"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683013164"><a href="#local-6989586621683013164"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#evVarsOfTerms"><span class="hs-identifier hs-var">evVarsOfTerms</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013163"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><a href="#local-6989586621683013164"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>    </span><a href="TcEvidence.html#EvTypeableTrFun"><span class="hs-identifier hs-var">EvTypeableTrFun</span></a><span> </span><a name="local-6989586621683013165"><a href="#local-6989586621683013165"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683013166"><a href="#local-6989586621683013166"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#evVarsOfTerms"><span class="hs-identifier hs-var">evVarsOfTerms</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013165"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><a href="#local-6989586621683013166"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">]</span><span>
</span><a name="line-867"></a><span>    </span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a name="local-6989586621683013167"><a href="#local-6989586621683013167"><span class="hs-identifier">e</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#evVarsOfTerm"><span class="hs-identifier hs-var">evVarsOfTerm</span></a><span> </span><a href="#local-6989586621683013167"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span>
</span><a name="line-870"></a><span class="hs-comment">{- Note [Free vars of EvFun]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Finding the free vars of an EvFun is made tricky by the fact the
bindings et_binds may be a mutable variable.  Fortunately, we
can just squeeze by.  Here's how.

* evVarsOfTerm is used only by TcSimplify.neededEvVars.
* Each EvBindsVar in an et_binds field of an EvFun is /also/ in the
  ic_binds field of an Implication
* So we can track usage via the processing for that implication,
  (see Note [Tracking redundant constraints] in TcSimplify).
  We can ignore usage from the EvFun altogether.

************************************************************************
*                                                                      *
                  Pretty printing
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-889"></a><span>
</span><a name="line-890"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-891"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621683013001"><a href="#local-6989586621683013001"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#pprHsWrapper"><span class="hs-identifier hs-var">pprHsWrapper</span></a><span> </span><a href="#local-6989586621683013001"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#no_parens"><span class="hs-identifier hs-var">no_parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;&lt;&gt;&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>
</span><a name="line-893"></a><span class="hs-identifier">pprHsWrapper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-894"></a><span class="hs-comment">-- With -fprint-typechecker-elaboration, print the wrapper</span><span>
</span><a name="line-895"></a><span class="hs-comment">--   otherwise just print what's inside</span><span>
</span><a name="line-896"></a><span class="hs-comment">-- The pp_thing_inside function takes Bool to say whether</span><span>
</span><a name="line-897"></a><span class="hs-comment">--    it's in a position that needs parens for a non-atomic thing</span><span>
</span><a name="line-898"></a><a name="pprHsWrapper"><a href="TcEvidence.html#pprHsWrapper"><span class="hs-identifier">pprHsWrapper</span></a></a><span> </span><a name="local-6989586621683013168"><a href="#local-6989586621683013168"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621683013169"><a href="#local-6989586621683013169"><span class="hs-identifier">pp_thing_inside</span></a></a><span>
</span><a name="line-899"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sdocWithDynFlags"><span class="hs-identifier hs-var">sdocWithDynFlags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621683013191"><a href="#local-6989586621683013191"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-900"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a><span> </span><a href="DynFlags.html#Opt_PrintTypecheckerElaboration"><span class="hs-identifier hs-var">Opt_PrintTypecheckerElaboration</span></a><span> </span><a href="#local-6989586621683013191"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-901"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621683013170"><span class="hs-identifier hs-var">help</span></a><span> </span><a href="#local-6989586621683013169"><span class="hs-identifier hs-var">pp_thing_inside</span></a><span> </span><a href="#local-6989586621683013168"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-902"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621683013169"><span class="hs-identifier hs-var">pp_thing_inside</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-903"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-904"></a><span>    </span><span class="hs-identifier">help</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-905"></a><span>    </span><span class="hs-comment">-- True  &lt;=&gt; appears in function application position</span><span>
</span><a name="line-906"></a><span>    </span><span class="hs-comment">-- False &lt;=&gt; appears as body of let or lambda</span><span>
</span><a name="line-907"></a><span>    </span><a name="local-6989586621683013170"><a href="#local-6989586621683013170"><span class="hs-identifier">help</span></a></a><span> </span><a name="local-6989586621683013171"><a href="#local-6989586621683013171"><span class="hs-identifier">it</span></a></a><span> </span><a href="TcEvidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013171"><span class="hs-identifier hs-var">it</span></a><span>
</span><a name="line-908"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013172"><a href="#local-6989586621683013172"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCompose"><span class="hs-identifier hs-var">WpCompose</span></a><span> </span><a name="local-6989586621683013173"><a href="#local-6989586621683013173"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621683013174"><a href="#local-6989586621683013174"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013170"><span class="hs-identifier hs-var">help</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683013170"><span class="hs-identifier hs-var">help</span></a><span> </span><a href="#local-6989586621683013172"><span class="hs-identifier hs-var">it</span></a><span> </span><a href="#local-6989586621683013174"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013173"><span class="hs-identifier hs-var">f1</span></a><span>
</span><a name="line-909"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013175"><a href="#local-6989586621683013175"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a><span> </span><a name="local-6989586621683013176"><a href="#local-6989586621683013176"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621683013177"><a href="#local-6989586621683013177"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-6989586621683013178"><a href="#local-6989586621683013178"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#add_parens"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;\\(x&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013178"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;).&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-910"></a><span>                                              </span><a href="#local-6989586621683013170"><span class="hs-identifier hs-var">help</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683013175"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621683013170"><span class="hs-identifier hs-var">help</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013176"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683013177"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-911"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013179"><a href="#local-6989586621683013179"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621683013180"><a href="#local-6989586621683013180"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#add_parens"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013179"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;|&gt;&quot;</span><span>
</span><a name="line-912"></a><span>                                              </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendCo"><span class="hs-identifier hs-var">pprParendCo</span></a><span> </span><a href="#local-6989586621683013180"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-913"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013181"><a href="#local-6989586621683013181"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvApp"><span class="hs-identifier hs-var">WpEvApp</span></a><span> </span><a name="local-6989586621683013182"><a href="#local-6989586621683013182"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#no_parens"><span class="hs-identifier hs-var">no_parens</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013181"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013182"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-914"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013183"><a href="#local-6989586621683013183"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a><span> </span><a name="local-6989586621683013184"><a href="#local-6989586621683013184"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#no_parens"><span class="hs-identifier hs-var">no_parens</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683013183"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span> </span><a href="#local-6989586621683013184"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013185"><a href="#local-6989586621683013185"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpEvLam"><span class="hs-identifier hs-var">WpEvLam</span></a><span> </span><a name="local-6989586621683013186"><a href="#local-6989586621683013186"><span class="hs-identifier">id</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#add_parens"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;\\&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="TcEvidence.html#pprLamBndr"><span class="hs-identifier hs-var">pprLamBndr</span></a><span> </span><a href="#local-6989586621683013186"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013185"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span>
</span><a name="line-916"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013187"><a href="#local-6989586621683013187"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpTyLam"><span class="hs-identifier hs-var">WpTyLam</span></a><span> </span><a name="local-6989586621683013188"><a href="#local-6989586621683013188"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#add_parens"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;/\\&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="TcEvidence.html#pprLamBndr"><span class="hs-identifier hs-var">pprLamBndr</span></a><span> </span><a href="#local-6989586621683013188"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013187"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span>
</span><a name="line-917"></a><span>    </span><span class="hs-identifier">help</span><span> </span><a name="local-6989586621683013189"><a href="#local-6989586621683013189"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#WpLet"><span class="hs-identifier hs-var">WpLet</span></a><span> </span><a name="local-6989586621683013190"><a href="#local-6989586621683013190"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#add_parens"><span class="hs-identifier hs-var">add_parens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;let&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013190"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683013189"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-identifier">pprLamBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-920"></a><a name="pprLamBndr"><a href="TcEvidence.html#pprLamBndr"><span class="hs-identifier">pprLamBndr</span></a></a><span> </span><a name="local-6989586621683013192"><a href="#local-6989586621683013192"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a><span> </span><a href="Outputable.html#LambdaBind"><span class="hs-identifier hs-var">LambdaBind</span></a><span> </span><a href="#local-6989586621683013192"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-921"></a><span>
</span><a name="line-922"></a><span class="hs-identifier">add_parens</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">no_parens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-923"></a><a name="add_parens"><a href="TcEvidence.html#add_parens"><span class="hs-identifier">add_parens</span></a></a><span> </span><a name="local-6989586621683013193"><a href="#local-6989586621683013193"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><a href="#local-6989586621683013193"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-924"></a><span class="hs-identifier">add_parens</span><span> </span><a name="local-6989586621683013194"><a href="#local-6989586621683013194"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013194"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-925"></a><a name="no_parens"><a href="TcEvidence.html#no_parens"><span class="hs-identifier">no_parens</span></a></a><span> </span><a name="local-6989586621683013195"><a href="#local-6989586621683013195"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683013195"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-928"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-var">TcEvBinds</span></a><span> </span><a name="local-6989586621683012999"><a href="#local-6989586621683012999"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012999"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-929"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBinds"><span class="hs-identifier hs-var">EvBinds</span></a><span> </span><a name="local-6989586621683013000"><a href="#local-6989586621683013000"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;EvBinds&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="#local-6989586621683013000"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-930"></a><span>
</span><a name="line-931"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-932"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-var">EvBindsVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ebv_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012997"><a href="#local-6989586621683012997"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-933"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;EvBindsVar&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#angleBrackets"><span class="hs-identifier hs-var">angleBrackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012997"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span>
</span><a name="line-934"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#CoEvBindsVar"><span class="hs-identifier hs-var">CoEvBindsVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ebv_uniq</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012998"><a href="#local-6989586621683012998"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;CoEvBindsVar&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#angleBrackets"><span class="hs-identifier hs-var">angleBrackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012998"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>
</span><a name="line-937"></a><span class="hs-keyword">instance</span><span> </span><a href="Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a><span> </span><a href="TcEvidence.html#EvBindsVar"><span class="hs-identifier hs-type">EvBindsVar</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-938"></a><span>  </span><a name="local-8214565720325051039"><a href="Unique.html#getUnique"><span class="hs-identifier">getUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ebv_uniq</span><span>
</span><a name="line-939"></a><span>
</span><a name="line-940"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-type">EvBind</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-941"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvBind"><span class="hs-identifier hs-var">EvBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">eb_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012993"><a href="#local-6989586621683012993"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012994"><a href="#local-6989586621683012994"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">eb_is_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012995"><a href="#local-6989586621683012995"><span class="hs-identifier">is_given</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621683012996"><span class="hs-identifier hs-var">pp_gw</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012993"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-943"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012994"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-944"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-945"></a><span>       </span><a name="local-6989586621683012996"><a href="#local-6989586621683012996"><span class="hs-identifier">pp_gw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683012995"><span class="hs-identifier hs-var">is_given</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'G'</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'W'</span><span class="hs-special">)</span><span>
</span><a name="line-946"></a><span>   </span><span class="hs-comment">-- We cheat a bit and pretend EqVars are CoVars for the purposes of pretty printing</span><span>
</span><a name="line-947"></a><span>
</span><a name="line-948"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-949"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvExpr"><span class="hs-identifier hs-var">EvExpr</span></a><span> </span><a name="local-6989586621683012986"><a href="#local-6989586621683012986"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012986"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-950"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-var">EvTypeable</span></a><span> </span><a name="local-6989586621683012987"><a href="#local-6989586621683012987"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621683012988"><a href="#local-6989586621683012988"><span class="hs-identifier">ev</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012988"><span class="hs-identifier hs-var">ev</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Typeable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012987"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-951"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvFun"><span class="hs-identifier hs-var">EvFun</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">et_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012989"><a href="#local-6989586621683012989"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">et_given</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012990"><a href="#local-6989586621683012990"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">et_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012991"><a href="#local-6989586621683012991"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">et_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683012992"><a href="#local-6989586621683012992"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;\\&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="TcEvidence.html#pprLamBndr"><span class="hs-identifier hs-var">pprLamBndr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683012989"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683012990"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#arrow"><span class="hs-identifier hs-var">arrow</span></a><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>           </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012991"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012992"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Not very pretty</span><span>
</span><a name="line-954"></a><span>
</span><a name="line-955"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvCallStack"><span class="hs-identifier hs-type">EvCallStack</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-956"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="TcEvidence.html#EvCsEmpty"><span class="hs-identifier hs-var">EvCsEmpty</span></a><span>
</span><a name="line-957"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;[]&quot;</span><span>
</span><a name="line-958"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvCsPushCall"><span class="hs-identifier hs-var">EvCsPushCall</span></a><span> </span><a name="local-6989586621683012983"><a href="#local-6989586621683012983"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621683012984"><a href="#local-6989586621683012984"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683012985"><a href="#local-6989586621683012985"><span class="hs-identifier">tm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683012983"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><a href="#local-6989586621683012984"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012985"><span class="hs-identifier hs-var">tm</span></a><span>
</span><a name="line-960"></a><span>
</span><a name="line-961"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="TcEvidence.html#EvTypeable"><span class="hs-identifier hs-type">EvTypeable</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-962"></a><span>  </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyCon"><span class="hs-identifier hs-var">EvTypeableTyCon</span></a><span> </span><a name="local-6989586621683012977"><a href="#local-6989586621683012977"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TyCon&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012977"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-963"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyApp"><span class="hs-identifier hs-var">EvTypeableTyApp</span></a><span> </span><a name="local-6989586621683012978"><a href="#local-6989586621683012978"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683012979"><a href="#local-6989586621683012979"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012978"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012979"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-964"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTrFun"><span class="hs-identifier hs-var">EvTypeableTrFun</span></a><span> </span><a name="local-6989586621683012980"><a href="#local-6989586621683012980"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683012981"><a href="#local-6989586621683012981"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012980"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#arrow"><span class="hs-identifier hs-var">arrow</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012981"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-965"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#EvTypeableTyLit"><span class="hs-identifier hs-var">EvTypeableTyLit</span></a><span> </span><a name="local-6989586621683012982"><a href="#local-6989586621683012982"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;TyLit&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683012982"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><a name="line-969"></a><span class="hs-comment">-- Helper functions for dealing with IP newtype-dictionaries</span><span>
</span><a name="line-970"></a><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-comment">-- | Create a 'Coercion' that unwraps an implicit-parameter or</span><span>
</span><a name="line-973"></a><span class="hs-comment">-- overloaded-label dictionary to expose the underlying value. We</span><span>
</span><a name="line-974"></a><span class="hs-comment">-- expect the 'Type' to have the form `IP sym ty` or `IsLabel sym ty`,</span><span>
</span><a name="line-975"></a><span class="hs-comment">-- and return a 'Coercion' `co :: IP sym ty ~ ty` or</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- `co :: IsLabel sym ty ~ Proxy# sym -&gt; ty`.  See also</span><span>
</span><a name="line-977"></a><span class="hs-comment">-- Note [Type-checking overloaded labels] in TcExpr.</span><span>
</span><a name="line-978"></a><span class="hs-identifier">unwrapIP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionR"><span class="hs-identifier hs-type">CoercionR</span></a><span>
</span><a name="line-979"></a><a name="unwrapIP"><a href="TcEvidence.html#unwrapIP"><span class="hs-identifier">unwrapIP</span></a></a><span> </span><a name="local-6989586621683013196"><a href="#local-6989586621683013196"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-980"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#unwrapNewTyCon_maybe"><span class="hs-identifier hs-var">unwrapNewTyCon_maybe</span></a><span> </span><a href="#local-6989586621683013197"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-981"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621683013199"><a href="#local-6989586621683013199"><span class="hs-identifier">ax</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Coercion.html#mkUnbranchedAxInstCo"><span class="hs-identifier hs-var">mkUnbranchedAxInstCo</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><a href="#local-6989586621683013199"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-6989586621683013198"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-982"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;unwrapIP&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-983"></a><span>                       </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The dictionary for&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683013197"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-984"></a><span>                         </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not a newtype!&quot;</span><span>
</span><a name="line-985"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-986"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621683013197"><a href="#local-6989586621683013197"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683013198"><a href="#local-6989586621683013198"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitTyConApp"><span class="hs-identifier hs-var">splitTyConApp</span></a><span> </span><a href="#local-6989586621683013196"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-987"></a><span>
</span><a name="line-988"></a><span class="hs-comment">-- | Create a 'Coercion' that wraps a value in an implicit-parameter</span><span>
</span><a name="line-989"></a><span class="hs-comment">-- dictionary. See 'unwrapIP'.</span><span>
</span><a name="line-990"></a><span class="hs-identifier">wrapIP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionR"><span class="hs-identifier hs-type">CoercionR</span></a><span>
</span><a name="line-991"></a><a name="wrapIP"><a href="TcEvidence.html#wrapIP"><span class="hs-identifier">wrapIP</span></a></a><span> </span><a name="local-6989586621683013200"><a href="#local-6989586621683013200"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#unwrapIP"><span class="hs-identifier hs-var">unwrapIP</span></a><span> </span><a href="#local-6989586621683013200"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-992"></a></pre></body></html>