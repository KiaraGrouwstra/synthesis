<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow, 1992-2006


Here we collect a variety of helper functions that construct or
analyse HsSyn.  All these functions deal with generic HsSyn; functions
which deal with the instantiated versions are located elsewhere:

   Parameterised by          Module
   ----------------          -------------
   GhcPs/RdrName             parser/RdrHsSyn
   GhcRn/Name                rename/RnHsSyn
   GhcTc/Id                  typecheck/TcHsSyn
-}</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-17"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-18"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-19"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-20"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HsUtils</span><span class="hs-special">(</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-comment">-- Terms</span><span>
</span><a name="line-24"></a><span>  </span><a href="HsUtils.html#mkHsPar"><span class="hs-identifier hs-var">mkHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsApp"><span class="hs-identifier hs-var">mkHsApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsAppType"><span class="hs-identifier hs-var">mkHsAppType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsAppTypes"><span class="hs-identifier hs-var">mkHsAppTypes</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsCaseAlt"><span class="hs-identifier hs-var">mkHsCaseAlt</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier hs-var">unguardedGRHSs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>  </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkPrefixFunRhs"><span class="hs-identifier hs-var">mkPrefixFunRhs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsLam"><span class="hs-identifier hs-var">mkHsLam</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsIf"><span class="hs-identifier hs-var">mkHsIf</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapCoR"><span class="hs-identifier hs-var">mkHsWrapCoR</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsWrapCo"><span class="hs-identifier hs-var">mkLHsWrapCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier hs-var">mkHsDictLet</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsLams"><span class="hs-identifier hs-var">mkHsLams</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>  </span><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier hs-var">mkHsOpApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsComp"><span class="hs-identifier hs-var">mkHsComp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapPat"><span class="hs-identifier hs-var">mkHsWrapPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsWrapPatCo"><span class="hs-identifier hs-var">mkHsWrapPatCo</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>  </span><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier hs-var">mkLHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier hs-var">mkHsCmdWrap</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsCmdWrap"><span class="hs-identifier hs-var">mkLHsCmdWrap</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>  </span><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier hs-var">nlHsTyApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyApps"><span class="hs-identifier hs-var">nlHsTyApps</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsDataCon"><span class="hs-identifier hs-var">nlHsDataCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="HsUtils.html#nlHsLit"><span class="hs-identifier hs-var">nlHsLit</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsSyntaxApps"><span class="hs-identifier hs-var">nlHsSyntaxApps</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier hs-var">nlHsIntLit</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier hs-var">nlHsVarApps</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><a href="HsUtils.html#nlHsDo"><span class="hs-identifier hs-var">nlHsDo</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier hs-var">nlHsOpApp</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsLam"><span class="hs-identifier hs-var">nlHsLam</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsPar"><span class="hs-identifier hs-var">nlHsPar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsIf"><span class="hs-identifier hs-var">nlHsIf</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsCase"><span class="hs-identifier hs-var">nlHsCase</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlList"><span class="hs-identifier hs-var">nlList</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>  </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier hs-var">mkLHsVarTuple</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#missingTupArg"><span class="hs-identifier hs-var">missingTupArg</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="HsUtils.html#typeToLHsType"><span class="hs-identifier hs-var">typeToLHsType</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-comment">-- * Constructing general big tuples</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-comment">-- $big_tuples</span><span>
</span><a name="line-41"></a><span>  </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-comment">-- Bindings</span><span>
</span><a name="line-44"></a><span>  </span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkVarBind"><span class="hs-identifier hs-var">mkVarBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier hs-var">mkHsVarBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTopFunBind"><span class="hs-identifier hs-var">mkTopFunBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="HsUtils.html#mkPatSynBind"><span class="hs-identifier hs-var">mkPatSynBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>  </span><a href="HsUtils.html#isInfixFunBind"><span class="hs-identifier hs-var">isInfixFunBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-comment">-- Literals</span><span>
</span><a name="line-49"></a><span>  </span><a href="HsUtils.html#mkHsIntegral"><span class="hs-identifier hs-var">mkHsIntegral</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsFractional"><span class="hs-identifier hs-var">mkHsFractional</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsIsString"><span class="hs-identifier hs-var">mkHsIsString</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsString"><span class="hs-identifier hs-var">mkHsString</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsStringPrimLit"><span class="hs-identifier hs-var">mkHsStringPrimLit</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">-- Patterns</span><span>
</span><a name="line-52"></a><span>  </span><a href="HsUtils.html#mkNPat"><span class="hs-identifier hs-var">mkNPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkNPlusKPat"><span class="hs-identifier hs-var">mkNPlusKPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlLitPat"><span class="hs-identifier hs-var">nlLitPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier hs-var">nlConVarPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConVarPatName"><span class="hs-identifier hs-var">nlConVarPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>  </span><a href="HsUtils.html#nlConPatName"><span class="hs-identifier hs-var">nlConPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlInfixConPat"><span class="hs-identifier hs-var">nlInfixConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier hs-var">nlNullaryConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier hs-var">nlWildConPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="HsUtils.html#nlWildPatName"><span class="hs-identifier hs-var">nlWildPatName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier hs-var">nlTuplePat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkParPat"><span class="hs-identifier hs-var">mkParPat</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlParPat"><span class="hs-identifier hs-var">nlParPat</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>  </span><a href="HsUtils.html#mkBigLHsVarTup"><span class="hs-identifier hs-var">mkBigLHsVarTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier hs-var">mkBigLHsTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsVarPatTup"><span class="hs-identifier hs-var">mkBigLHsVarPatTup</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier hs-var">mkBigLHsPatTup</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">-- Types</span><span>
</span><a name="line-58"></a><span>  </span><a href="HsTypes.html#mkHsAppTy"><span class="hs-identifier hs-var">mkHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsTypes.html#mkHsAppKindTy"><span class="hs-identifier hs-var">mkHsAppKindTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#userHsTyVarBndrs"><span class="hs-identifier hs-var">userHsTyVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#userHsLTyVarBndrs"><span class="hs-identifier hs-var">userHsLTyVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>  </span><a href="HsUtils.html#mkLHsSigType"><span class="hs-identifier hs-var">mkLHsSigType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier hs-var">mkLHsSigWcType</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkClassOpSigs"><span class="hs-identifier hs-var">mkClassOpSigs</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSigEnv"><span class="hs-identifier hs-var">mkHsSigEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>  </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier hs-var">nlHsFunTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsParTy"><span class="hs-identifier hs-var">nlHsParTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier hs-var">nlHsTyConApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-comment">-- Stmts</span><span>
</span><a name="line-63"></a><span>  </span><a href="HsUtils.html#mkTransformStmt"><span class="hs-identifier hs-var">mkTransformStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTransformByStmt"><span class="hs-identifier hs-var">mkTransformByStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBodyStmt"><span class="hs-identifier hs-var">mkBodyStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier hs-var">mkBindStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkTcBindStmt"><span class="hs-identifier hs-var">mkTcBindStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>  </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>  </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkGroupUsingStmt"><span class="hs-identifier hs-var">mkGroupUsingStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkGroupByUsingStmt"><span class="hs-identifier hs-var">mkGroupByUsingStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>  </span><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier hs-var">emptyRecStmt</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#emptyRecStmtName"><span class="hs-identifier hs-var">emptyRecStmtName</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#emptyRecStmtId"><span class="hs-identifier hs-var">emptyRecStmtId</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkRecStmt"><span class="hs-identifier hs-var">mkRecStmt</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>  </span><a href="HsUtils.html#unitRecStmtTc"><span class="hs-identifier hs-var">unitRecStmtTc</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-comment">-- Template Haskell</span><span>
</span><a name="line-70"></a><span>  </span><a href="HsUtils.html#mkHsSpliceTy"><span class="hs-identifier hs-var">mkHsSpliceTy</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSpliceE"><span class="hs-identifier hs-var">mkHsSpliceE</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkHsSpliceTE"><span class="hs-identifier hs-var">mkHsSpliceTE</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier hs-var">mkUntypedSplice</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>  </span><a href="HsUtils.html#mkHsQuasiQuote"><span class="hs-identifier hs-var">mkHsQuasiQuote</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#unqualQuasiQuote"><span class="hs-identifier hs-var">unqualQuasiQuote</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-comment">-- Collecting binders</span><span>
</span><a name="line-74"></a><span>  </span><a href="HsUtils.html#isUnliftedHsBind"><span class="hs-identifier hs-var">isUnliftedHsBind</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#isBangedHsBind"><span class="hs-identifier hs-var">isBangedHsBind</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>  </span><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier hs-var">collectLocalBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier hs-var">collectHsValBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsBindListBinders"><span class="hs-identifier hs-var">collectHsBindListBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>  </span><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier hs-var">collectHsIdBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>  </span><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier hs-var">collectHsBindBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectMethodBinders"><span class="hs-identifier hs-var">collectMethodBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>  </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier hs-var">collectPatsBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>  </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectStmtsBinders"><span class="hs-identifier hs-var">collectStmtsBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>  </span><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier hs-var">collectLStmtBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>  </span><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier hs-var">hsLTyClDeclBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier hs-var">hsTyClForeignBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>  </span><a href="HsUtils.html#hsPatSynSelectors"><span class="hs-identifier hs-var">hsPatSynSelectors</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#getPatSynBinds"><span class="hs-identifier hs-var">getPatSynBinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>  </span><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier hs-var">hsForeignDeclsBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsGroupBinders"><span class="hs-identifier hs-var">hsGroupBinders</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-comment">-- Collecting implicit binders</span><span>
</span><a name="line-88"></a><span>  </span><a href="HsUtils.html#lStmtsImplicits"><span class="hs-identifier hs-var">lStmtsImplicits</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier hs-var">hsValBindsImplicits</span></a><span class="hs-special">,</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="HsDecls.html"><span class="hs-identifier">HsDecls</span></a><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><a href="HsBinds.html"><span class="hs-identifier">HsBinds</span></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="HsExpr.html"><span class="hs-identifier">HsExpr</span></a><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><a href="HsPat.html"><span class="hs-identifier">HsPat</span></a><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="HsTypes.html"><span class="hs-identifier">HsTypes</span></a><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><a href="HsLit.html"><span class="hs-identifier">HsLit</span></a><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><a href="PlaceHolder.html"><span class="hs-identifier">PlaceHolder</span></a><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><a href="HsExtension.html"><span class="hs-identifier">HsExtension</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-105"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-107"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>   </span><span class="hs-special">(</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-123"></a><span class="hs-keyword">import</span><span> </span><a href="Constants.html"><span class="hs-identifier">Constants</span></a><span>
</span><a name="line-124"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either</span><span>
</span><a name="line-127"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Function</span><span>
</span><a name="line-128"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Some useful helpers for constructing syntax
*                                                                      *
************************************************************************

These functions attempt to construct a not-completely-useless SrcSpan
from their components, compared with the nl* functions below which
just attach noSrcSpan to everything.
-}</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-identifier">mkHsPar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271548"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271548"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><a name="mkHsPar"><a href="HsUtils.html#mkHsPar"><span class="hs-identifier">mkHsPar</span></a></a><span> </span><a name="local-6989586621683271549"><a href="#local-6989586621683271549"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271549"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271549"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">mkSimpleMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#NameOrRdrName"><span class="hs-identifier hs-type">NameOrRdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271546"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271546"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271547"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271546"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271546"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271547"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271546"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><a name="mkSimpleMatch"><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier">mkSimpleMatch</span></a></a><span> </span><a name="local-6989586621683271550"><a href="#local-6989586621683271550"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621683271551"><a href="#local-6989586621683271551"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621683271552"><a href="#local-6989586621683271552"><span class="hs-identifier">rhs</span></a></a><span>
</span><a name="line-149"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271553"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-150"></a><span>    </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271550"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271551"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-151"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier hs-var">unguardedGRHSs</span></a><span> </span><a href="#local-6989586621683271552"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-153"></a><span>    </span><a name="local-6989586621683271553"><a href="#local-6989586621683271553"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621683271551"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-154"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271552"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-155"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621683271554"><a href="#local-6989586621683271554"><span class="hs-identifier">pat</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271554"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271552"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-identifier">unguardedGRHSs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271544"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271545"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271545"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271544"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271545"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><a name="unguardedGRHSs"><a href="HsUtils.html#unguardedGRHSs"><span class="hs-identifier">unguardedGRHSs</span></a></a><span> </span><a name="local-6989586621683271555"><a href="#local-6989586621683271555"><span class="hs-identifier">rhs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271556"><a href="#local-6989586621683271556"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span> </span><a href="#local-6989586621683271556"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271555"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-identifier">unguardedRHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271542"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271543"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271543"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271542"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271543"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><a name="unguardedRHS"><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier">unguardedRHS</span></a></a><span> </span><a name="local-6989586621683271557"><a href="#local-6989586621683271557"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271558"><a href="#local-6989586621683271558"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271557"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683271558"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-identifier">mkMatchGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">XMG</span><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271541"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-type">NoExt</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="BasicTypes.html#Origin"><span class="hs-identifier hs-type">Origin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271541"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271541"><span class="hs-identifier hs-type">body</span></a><span> </span><a href="#local-6989586621683271540"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><a name="mkMatchGroup"><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier">mkMatchGroup</span></a></a><span> </span><a name="local-6989586621683271559"><a href="#local-6989586621683271559"><span class="hs-identifier">origin</span></a></a><span> </span><a name="local-6989586621683271560"><a href="#local-6989586621683271560"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-170"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier hs-var">mkLocatedList</span></a><span> </span><a href="#local-6989586621683271560"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-171"></a><span>                                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271559"><span class="hs-identifier hs-var">origin</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">mkLocatedList</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683271539"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683271539"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-174"></a><a name="mkLocatedList"><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier">mkLocatedList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-175"></a><span class="hs-identifier">mkLocatedList</span><span> </span><a name="local-6989586621683271561"><a href="#local-6989586621683271561"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621683271561"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621683271561"><span class="hs-identifier hs-var">ms</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271561"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-identifier">mkHsApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271538"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271538"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271538"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><a name="mkHsApp"><a href="HsUtils.html#mkHsApp"><span class="hs-identifier">mkHsApp</span></a></a><span> </span><a name="local-6989586621683271562"><a href="#local-6989586621683271562"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683271563"><a href="#local-6989586621683271563"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621683271562"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621683271563"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271562"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621683271563"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-identifier">mkHsAppType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NoGhcTc</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271537"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271537"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271537"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><a name="mkHsAppType"><a href="HsUtils.html#mkHsAppType"><span class="hs-identifier">mkHsAppType</span></a></a><span> </span><a name="local-6989586621683271564"><a href="#local-6989586621683271564"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621683271565"><a href="#local-6989586621683271565"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#addCLoc"><span class="hs-identifier hs-var">addCLoc</span></a><span> </span><a href="#local-6989586621683271564"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621683271566"><span class="hs-identifier hs-var">t_body</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsAppType"><span class="hs-identifier hs-var">HsAppType</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271564"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621683271567"><span class="hs-identifier hs-var">paren_wct</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-184"></a><span>    </span><a name="local-6989586621683271566"><a href="#local-6989586621683271566"><span class="hs-identifier">t_body</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><a href="#local-6989586621683271565"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621683271567"><a href="#local-6989586621683271567"><span class="hs-identifier">paren_wct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271565"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#parenthesizeHsType"><span class="hs-identifier hs-var">parenthesizeHsType</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span> </span><a href="#local-6989586621683271566"><span class="hs-identifier hs-var">t_body</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-identifier">mkHsAppTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-188"></a><a name="mkHsAppTypes"><a href="HsUtils.html#mkHsAppTypes"><span class="hs-identifier">mkHsAppTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#mkHsAppType"><span class="hs-identifier hs-var">mkHsAppType</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-identifier">mkHsLam</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">XMG</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271536"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271536"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-type">NoExt</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271536"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271536"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271536"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><a name="mkHsLam"><a href="HsUtils.html#mkHsLam"><span class="hs-identifier">mkHsLam</span></a></a><span> </span><a name="local-6989586621683271568"><a href="#local-6989586621683271568"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621683271569"><a href="#local-6989586621683271569"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsPar"><span class="hs-identifier hs-var">mkHsPar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271569"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271570"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-194"></a><span>    </span><a name="local-6989586621683271570"><a href="#local-6989586621683271570"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span>
</span><a name="line-195"></a><span>                           </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><a href="HsExpr.html#LambdaExpr"><span class="hs-identifier hs-var">LambdaExpr</span></a><span> </span><a href="#local-6989586621683271571"><span class="hs-identifier hs-var">pats'</span></a><span> </span><a href="#local-6989586621683271569"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">]</span><span>
</span><a name="line-196"></a><span>    </span><a name="local-6989586621683271571"><a href="#local-6989586621683271571"><span class="hs-identifier">pats'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#parenthesizePat"><span class="hs-identifier hs-var">parenthesizePat</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271568"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-identifier">mkHsLams</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span>
</span><a name="line-199"></a><a name="mkHsLams"><a href="HsUtils.html#mkHsLams"><span class="hs-identifier">mkHsLams</span></a></a><span> </span><a name="local-6989586621683271572"><a href="#local-6989586621683271572"><span class="hs-identifier">tyvars</span></a></a><span> </span><a name="local-6989586621683271573"><a href="#local-6989586621683271573"><span class="hs-identifier">dicts</span></a></a><span> </span><a name="local-6989586621683271574"><a href="#local-6989586621683271574"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a><span> </span><a href="#local-6989586621683271572"><span class="hs-identifier hs-var">tyvars</span></a><span>
</span><a name="line-200"></a><span>                                       </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="TcEvidence.html#mkWpLams"><span class="hs-identifier hs-var">mkWpLams</span></a><span> </span><a href="#local-6989586621683271573"><span class="hs-identifier hs-var">dicts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271574"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- |A simple case alternative with a single pattern, no binds, no guards;</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- pre-typechecking</span><span>
</span><a name="line-204"></a><span class="hs-identifier">mkHsCaseAlt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271534"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271535"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271534"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271534"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271535"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271534"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><a name="mkHsCaseAlt"><a href="HsUtils.html#mkHsCaseAlt"><span class="hs-identifier">mkHsCaseAlt</span></a></a><span> </span><a name="local-6989586621683271575"><a href="#local-6989586621683271575"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683271576"><a href="#local-6989586621683271576"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><a href="HsExpr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271575"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621683271576"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-identifier">nlHsTyApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271533"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271533"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="nlHsTyApp"><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier">nlHsTyApp</span></a></a><span> </span><a name="local-6989586621683271577"><a href="#local-6989586621683271577"><span class="hs-identifier">fun_id</span></a></a><span> </span><a name="local-6989586621683271578"><a href="#local-6989586621683271578"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpTyApps"><span class="hs-identifier hs-var">mkWpTyApps</span></a><span> </span><a href="#local-6989586621683271578"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271577"><span class="hs-identifier hs-var">fun_id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-identifier">nlHsTyApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271532"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271532"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-214"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271532"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><a name="nlHsTyApps"><a href="HsUtils.html#nlHsTyApps"><span class="hs-identifier">nlHsTyApps</span></a></a><span> </span><a name="local-6989586621683271579"><a href="#local-6989586621683271579"><span class="hs-identifier">fun_id</span></a></a><span> </span><a name="local-6989586621683271580"><a href="#local-6989586621683271580"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621683271581"><a href="#local-6989586621683271581"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyApp"><span class="hs-identifier hs-var">nlHsTyApp</span></a><span> </span><a href="#local-6989586621683271579"><span class="hs-identifier hs-var">fun_id</span></a><span> </span><a href="#local-6989586621683271580"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271581"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">--------- Adding parens ---------</span><span>
</span><a name="line-218"></a><span class="hs-identifier">mkLHsPar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271531"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271531"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- Wrap in parens if (hsExprNeedsParens appPrec) says it needs them</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- So   'f x'  becomes '(f x)', but '3' stays as '3'</span><span>
</span><a name="line-221"></a><a name="mkLHsPar"><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier">mkLHsPar</span></a></a><span> </span><a name="local-6989586621683271582"><a href="#local-6989586621683271582"><span class="hs-identifier">le</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271583"><a href="#local-6989586621683271583"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271584"><a href="#local-6989586621683271584"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#hsExprNeedsParens"><span class="hs-identifier hs-var">hsExprNeedsParens</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span> </span><a href="#local-6989586621683271584"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271583"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271582"><span class="hs-identifier hs-var">le</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271582"><span class="hs-identifier hs-var">le</span></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-identifier">mkParPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271530"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271530"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><a name="mkParPat"><a href="HsUtils.html#mkParPat"><span class="hs-identifier">mkParPat</span></a></a><span> </span><a name="local-6989586621683271585"><a href="#local-6989586621683271585"><span class="hs-identifier">lp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271586"><a href="#local-6989586621683271586"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271587"><a href="#local-6989586621683271587"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsPat.html#patNeedsParens"><span class="hs-identifier hs-var">patNeedsParens</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span> </span><a href="#local-6989586621683271587"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271586"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271585"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271585"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-identifier">nlParPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271529"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271529"><span class="hs-identifier hs-type">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="nlParPat"><a href="HsUtils.html#nlParPat"><span class="hs-identifier">nlParPat</span></a></a><span> </span><a name="local-6989586621683271588"><a href="#local-6989586621683271588"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271588"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-------------------------------</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- These are the bits of syntax that contain rebindable names</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- See RnEnv.lookupSyntaxName</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-identifier">mkHsIntegral</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#IntegralLit"><span class="hs-identifier hs-type">IntegralLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-238"></a><span class="hs-identifier">mkHsFractional</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#FractionalLit"><span class="hs-identifier hs-type">FractionalLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-239"></a><span class="hs-identifier">mkHsIsString</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#SourceText"><span class="hs-identifier hs-type">SourceText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-240"></a><span class="hs-identifier">mkHsDo</span><span>         </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-241"></a><span class="hs-identifier">mkHsComp</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-242"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-identifier">mkNPat</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-246"></a><span class="hs-identifier">mkNPlusKPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-identifier">mkLastStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271526"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271527"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271528"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271527"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271526"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271527"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span class="hs-identifier">mkBodyStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271524"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271525"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271524"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span class="hs-identifier">mkBindStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">XBindStmt</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271521"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271522"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>                         </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271523"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271522"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-type">NoExt</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271521"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271523"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271522"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271521"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271522"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271523"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271522"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span class="hs-identifier">mkTcBindStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271520"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271520"><span class="hs-identifier hs-type">bodyR</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">emptyRecStmt</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271518"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="#local-6989586621683271519"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-260"></a><span class="hs-identifier">emptyRecStmtName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><a href="#local-6989586621683271517"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-261"></a><span class="hs-identifier">emptyRecStmtId</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><a href="#local-6989586621683271516"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-262"></a><span class="hs-identifier">mkRecStmt</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271514"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="#local-6989586621683271515"><span class="hs-identifier hs-type">bodyR</span></a><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271514"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="#local-6989586621683271515"><span class="hs-identifier hs-type">bodyR</span></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><a name="mkHsIntegral"><a href="HsUtils.html#mkHsIntegral"><span class="hs-identifier">mkHsIntegral</span></a></a><span>     </span><a name="local-6989586621683271589"><a href="#local-6989586621683271589"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span>       </span><a href="#local-6989586621683271589"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-267"></a><a name="mkHsFractional"><a href="HsUtils.html#mkHsFractional"><span class="hs-identifier">mkHsFractional</span></a></a><span>   </span><a name="local-6989586621683271590"><a href="#local-6989586621683271590"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsFractional"><span class="hs-identifier hs-var">HsFractional</span></a><span>     </span><a href="#local-6989586621683271590"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-268"></a><a name="mkHsIsString"><a href="HsUtils.html#mkHsIsString"><span class="hs-identifier">mkHsIsString</span></a></a><span> </span><a name="local-6989586621683271591"><a href="#local-6989586621683271591"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621683271592"><a href="#local-6989586621683271592"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span>   </span><a href="#local-6989586621683271591"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621683271592"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><a name="mkHsDo"><a href="HsUtils.html#mkHsDo"><span class="hs-identifier">mkHsDo</span></a></a><span> </span><a name="local-6989586621683271593"><a href="#local-6989586621683271593"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621683271594"><a href="#local-6989586621683271594"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271593"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLocatedList"><span class="hs-identifier hs-var">mkLocatedList</span></a><span> </span><a href="#local-6989586621683271594"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><a name="mkHsComp"><a href="HsUtils.html#mkHsComp"><span class="hs-identifier">mkHsComp</span></a></a><span> </span><a name="local-6989586621683271595"><a href="#local-6989586621683271595"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621683271596"><a href="#local-6989586621683271596"><span class="hs-identifier">stmts</span></a></a><span> </span><a name="local-6989586621683271597"><a href="#local-6989586621683271597"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span> </span><a href="#local-6989586621683271595"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271596"><span class="hs-identifier hs-var">stmts</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271598"><span class="hs-identifier hs-var">last_stmt</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-273"></a><span>    </span><a name="local-6989586621683271598"><a href="#local-6989586621683271598"><span class="hs-identifier">last_stmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271597"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a><span> </span><a href="#local-6989586621683271597"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-identifier">mkHsIf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271513"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271513"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271513"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271513"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><a name="mkHsIf"><a href="HsUtils.html#mkHsIf"><span class="hs-identifier">mkHsIf</span></a></a><span> </span><a name="local-6989586621683271599"><a href="#local-6989586621683271599"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621683271600"><a href="#local-6989586621683271600"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621683271601"><a href="#local-6989586621683271601"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271599"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621683271600"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621683271601"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><a name="mkNPat"><a href="HsUtils.html#mkNPat"><span class="hs-identifier">mkNPat</span></a></a><span> </span><a name="local-6989586621683271602"><a href="#local-6989586621683271602"><span class="hs-identifier">lit</span></a></a><span> </span><a name="local-6989586621683271603"><a href="#local-6989586621683271603"><span class="hs-identifier">neg</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271602"><span class="hs-identifier hs-var">lit</span></a><span> </span><a href="#local-6989586621683271603"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-280"></a><a name="mkNPlusKPat"><a href="HsUtils.html#mkNPlusKPat"><span class="hs-identifier">mkNPlusKPat</span></a></a><span> </span><a name="local-6989586621683271604"><a href="#local-6989586621683271604"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621683271605"><a href="#local-6989586621683271605"><span class="hs-identifier">lit</span></a></a><span>
</span><a name="line-281"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271604"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621683271605"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271605"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">)</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-identifier">mkTransformStmt</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-284"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span class="hs-identifier">mkTransformByStmt</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-286"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span class="hs-identifier">mkGroupUsingStmt</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-288"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span class="hs-identifier">mkGroupByUsingStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-290"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-291"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-identifier">emptyTransStmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><a name="emptyTransStmt"><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier">emptyTransStmt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-295"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;emptyTransStmt: form&quot;</span><span>
</span><a name="line-296"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-297"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span>
</span><a name="line-298"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_bind</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-299"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noExpr"><span class="hs-identifier hs-var">noExpr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-300"></a><a name="mkTransformStmt"><a href="HsUtils.html#mkTransformStmt"><span class="hs-identifier">mkTransformStmt</span></a></a><span>    </span><a name="local-6989586621683271606"><a href="#local-6989586621683271606"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621683271607"><a href="#local-6989586621683271607"><span class="hs-identifier">u</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#ThenForm"><span class="hs-identifier hs-var">ThenForm</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271606"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271607"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-301"></a><a name="mkTransformByStmt"><a href="HsUtils.html#mkTransformByStmt"><span class="hs-identifier">mkTransformByStmt</span></a></a><span>  </span><a name="local-6989586621683271608"><a href="#local-6989586621683271608"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621683271609"><a href="#local-6989586621683271609"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621683271610"><a href="#local-6989586621683271610"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#ThenForm"><span class="hs-identifier hs-var">ThenForm</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271608"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271609"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621683271610"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-302"></a><a name="mkGroupUsingStmt"><a href="HsUtils.html#mkGroupUsingStmt"><span class="hs-identifier">mkGroupUsingStmt</span></a></a><span>   </span><a name="local-6989586621683271611"><a href="#local-6989586621683271611"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621683271612"><a href="#local-6989586621683271612"><span class="hs-identifier">u</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GroupForm"><span class="hs-identifier hs-var">GroupForm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271611"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271612"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-303"></a><a name="mkGroupByUsingStmt"><a href="HsUtils.html#mkGroupByUsingStmt"><span class="hs-identifier">mkGroupByUsingStmt</span></a></a><span> </span><a name="local-6989586621683271613"><a href="#local-6989586621683271613"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621683271614"><a href="#local-6989586621683271614"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621683271615"><a href="#local-6989586621683271615"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyTransStmt"><span class="hs-identifier hs-var">emptyTransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_form</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GroupForm"><span class="hs-identifier hs-var">GroupForm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271613"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_using</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271615"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">trS_by</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621683271614"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><a name="mkLastStmt"><a href="HsUtils.html#mkLastStmt"><span class="hs-identifier">mkLastStmt</span></a></a><span> </span><a name="local-6989586621683271616"><a href="#local-6989586621683271616"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271616"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-306"></a><a name="mkBodyStmt"><a href="HsUtils.html#mkBodyStmt"><span class="hs-identifier">mkBodyStmt</span></a></a><span> </span><a name="local-6989586621683271617"><a href="#local-6989586621683271617"><span class="hs-identifier">body</span></a></a><span>
</span><a name="line-307"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271617"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-308"></a><a name="mkBindStmt"><a href="HsUtils.html#mkBindStmt"><span class="hs-identifier">mkBindStmt</span></a></a><span> </span><a name="local-6989586621683271618"><a href="#local-6989586621683271618"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683271619"><a href="#local-6989586621683271619"><span class="hs-identifier">body</span></a></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271618"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271619"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-310"></a><a name="mkTcBindStmt"><a href="HsUtils.html#mkTcBindStmt"><span class="hs-identifier">mkTcBindStmt</span></a></a><span> </span><a name="local-6989586621683271620"><a href="#local-6989586621683271620"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683271621"><a href="#local-6989586621683271621"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span> </span><a href="#local-6989586621683271620"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271621"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-311"></a><span>  </span><span class="hs-comment">-- don't use placeHolderTypeTc above, because that panics during zonking</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">emptyRecStmt'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621683271510"><a href="#local-6989586621683271510"><span class="hs-identifier">idL</span></a></a><span> </span><a name="local-6989586621683271511"><a href="#local-6989586621683271511"><span class="hs-identifier">idR</span></a></a><span> </span><a name="local-6989586621683271512"><a href="#local-6989586621683271512"><span class="hs-identifier">body</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-314"></a><span>                 </span><a href="HsExtension.html#XRecStmt"><span class="hs-identifier hs-type">XRecStmt</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271510"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271511"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271512"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-315"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271510"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271511"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271512"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-316"></a><a name="emptyRecStmt%27"><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier">emptyRecStmt'</span></a></a><span> </span><a name="local-6989586621683271622"><a href="#local-6989586621683271622"><span class="hs-identifier">tyVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-317"></a><span>   </span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span>
</span><a name="line-318"></a><span>     </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-319"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_ids</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-320"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-321"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_mfix_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-322"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_bind_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#noSyntaxExpr"><span class="hs-identifier hs-var">noSyntaxExpr</span></a><span>
</span><a name="line-323"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271622"><span class="hs-identifier hs-var">tyVal</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">unitRecStmtTc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#RecStmtTc"><span class="hs-identifier hs-type">RecStmtTc</span></a><span>
</span><a name="line-326"></a><a name="unitRecStmtTc"><a href="HsUtils.html#unitRecStmtTc"><span class="hs-identifier">unitRecStmtTc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#RecStmtTc"><span class="hs-identifier hs-var">RecStmtTc</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_bind_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span>
</span><a name="line-327"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_later_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-328"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_rec_rets</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-329"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recS_ret_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#unitTy"><span class="hs-identifier hs-var">unitTy</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><a name="emptyRecStmt"><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier">emptyRecStmt</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-332"></a><a name="emptyRecStmtName"><a href="HsUtils.html#emptyRecStmtName"><span class="hs-identifier">emptyRecStmtName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-333"></a><a name="emptyRecStmtId"><a href="HsUtils.html#emptyRecStmtId"><span class="hs-identifier">emptyRecStmtId</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt%27"><span class="hs-identifier hs-var">emptyRecStmt'</span></a><span> </span><a href="HsUtils.html#unitRecStmtTc"><span class="hs-identifier hs-var">unitRecStmtTc</span></a><span>
</span><a name="line-334"></a><span>                                        </span><span class="hs-comment">-- a panic might trigger during zonking</span><span>
</span><a name="line-335"></a><a name="mkRecStmt"><a href="HsUtils.html#mkRecStmt"><span class="hs-identifier">mkRecStmt</span></a></a><span> </span><a name="local-6989586621683271623"><a href="#local-6989586621683271623"><span class="hs-identifier">stmts</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#emptyRecStmt"><span class="hs-identifier hs-var">emptyRecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271623"><span class="hs-identifier hs-var">stmts</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">-------------------------------</span><span>
</span><a name="line-338"></a><span class="hs-comment">--- A useful function for building @OpApps@.  The operator is always a</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- variable, and we don't know the fixity yet.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">mkHsOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-341"></a><a name="mkHsOpApp"><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier">mkHsOpApp</span></a></a><span> </span><a name="local-6989586621683271624"><a href="#local-6989586621683271624"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683271625"><a href="#local-6989586621683271625"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621683271626"><a href="#local-6989586621683271626"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271624"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271625"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271626"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-identifier">unqualSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-344"></a><a name="unqualSplice"><a href="HsUtils.html#unqualSplice"><span class="hs-identifier">unqualSplice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;splice&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-identifier">mkUntypedSplice</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsSplice"><span class="hs-identifier hs-type">HsSplice</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-347"></a><a name="mkUntypedSplice"><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier">mkUntypedSplice</span></a></a><span> </span><a name="local-6989586621683271627"><a href="#local-6989586621683271627"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621683271628"><a href="#local-6989586621683271628"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsUntypedSplice"><span class="hs-identifier hs-var">HsUntypedSplice</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271627"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621683271628"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">mkHsSpliceE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-350"></a><a name="mkHsSpliceE"><a href="HsUtils.html#mkHsSpliceE"><span class="hs-identifier">mkHsSpliceE</span></a></a><span> </span><a name="local-6989586621683271629"><a href="#local-6989586621683271629"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621683271630"><a href="#local-6989586621683271630"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkUntypedSplice"><span class="hs-identifier hs-var">mkUntypedSplice</span></a><span> </span><a href="#local-6989586621683271629"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="#local-6989586621683271630"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-identifier">mkHsSpliceTE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-353"></a><a name="mkHsSpliceTE"><a href="HsUtils.html#mkHsSpliceTE"><span class="hs-identifier">mkHsSpliceTE</span></a></a><span> </span><a name="local-6989586621683271631"><a href="#local-6989586621683271631"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621683271632"><a href="#local-6989586621683271632"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-354"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsSpliceE"><span class="hs-identifier hs-var">HsSpliceE</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsTypedSplice"><span class="hs-identifier hs-var">HsTypedSplice</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271631"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621683271632"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-identifier">mkHsSpliceTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SpliceDecoration"><span class="hs-identifier hs-type">SpliceDecoration</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-357"></a><a name="mkHsSpliceTy"><a href="HsUtils.html#mkHsSpliceTy"><span class="hs-identifier">mkHsSpliceTy</span></a></a><span> </span><a name="local-6989586621683271633"><a href="#local-6989586621683271633"><span class="hs-identifier">hasParen</span></a></a><span> </span><a name="local-6989586621683271634"><a href="#local-6989586621683271634"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-358"></a><span>                      </span><span class="hs-special">(</span><a href="HsExpr.html#HsUntypedSplice"><span class="hs-identifier hs-var">HsUntypedSplice</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271633"><span class="hs-identifier hs-var">hasParen</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621683271634"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">mkHsQuasiQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsSplice"><span class="hs-identifier hs-type">HsSplice</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-361"></a><a name="mkHsQuasiQuote"><a href="HsUtils.html#mkHsQuasiQuote"><span class="hs-identifier">mkHsQuasiQuote</span></a></a><span> </span><a name="local-6989586621683271635"><a href="#local-6989586621683271635"><span class="hs-identifier">quoter</span></a></a><span> </span><a name="local-6989586621683271636"><a href="#local-6989586621683271636"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-6989586621683271637"><a href="#local-6989586621683271637"><span class="hs-identifier">quote</span></a></a><span>
</span><a name="line-362"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsQuasiQuote"><span class="hs-identifier hs-var">HsQuasiQuote</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="HsUtils.html#unqualSplice"><span class="hs-identifier hs-var">unqualSplice</span></a><span> </span><a href="#local-6989586621683271635"><span class="hs-identifier hs-var">quoter</span></a><span> </span><a href="#local-6989586621683271636"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621683271637"><span class="hs-identifier hs-var">quote</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-identifier">unqualQuasiQuote</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-365"></a><a name="unqualQuasiQuote"><a href="HsUtils.html#unqualQuasiQuote"><span class="hs-identifier">unqualQuasiQuote</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RdrName.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;quasiquote&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>                </span><span class="hs-comment">-- A name (uniquified later) to</span><span>
</span><a name="line-367"></a><span>                </span><span class="hs-comment">-- identify the quasi-quote</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span class="hs-identifier">mkHsString</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271509"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><a name="mkHsString"><a href="HsUtils.html#mkHsString"><span class="hs-identifier">mkHsString</span></a></a><span> </span><a name="local-6989586621683271638"><a href="#local-6989586621683271638"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-6989586621683271638"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-identifier">mkHsStringPrimLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271508"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><a name="mkHsStringPrimLit"><a href="HsUtils.html#mkHsStringPrimLit"><span class="hs-identifier">mkHsStringPrimLit</span></a></a><span> </span><a name="local-6989586621683271639"><a href="#local-6989586621683271639"><span class="hs-identifier">fs</span></a></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsLit.html#HsStringPrim"><span class="hs-identifier hs-var">HsStringPrim</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fastStringToByteString"><span class="hs-identifier hs-var">fastStringToByteString</span></a><span> </span><a href="#local-6989586621683271639"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-377"></a><span class="hs-identifier">userHsLTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271507"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-378"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271507"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- Caller sets location</span><span>
</span><a name="line-380"></a><a name="userHsLTyVarBndrs"><a href="HsUtils.html#userHsLTyVarBndrs"><span class="hs-identifier">userHsLTyVarBndrs</span></a></a><span> </span><a name="local-6989586621683271640"><a href="#local-6989586621683271640"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271641"><a href="#local-6989586621683271641"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271640"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271642"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621683271642"><a href="#local-6989586621683271642"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271641"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-identifier">userHsTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271506"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271506"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- Caller sets location</span><span>
</span><a name="line-384"></a><a name="userHsTyVarBndrs"><a href="HsUtils.html#userHsTyVarBndrs"><span class="hs-identifier">userHsTyVarBndrs</span></a></a><span> </span><a name="local-6989586621683271643"><a href="#local-6989586621683271643"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271644"><a href="#local-6989586621683271644"><span class="hs-identifier">bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271643"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271643"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271645"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621683271645"><a href="#local-6989586621683271645"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271644"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Constructing syntax with no location info
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-identifier">nlHsVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271505"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271505"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><a name="nlHsVar"><a href="HsUtils.html#nlHsVar"><span class="hs-identifier">nlHsVar</span></a></a><span> </span><a name="local-6989586621683271646"><a href="#local-6989586621683271646"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271646"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-comment">-- NB: Only for LHsExpr **Id**</span><span>
</span><a name="line-400"></a><span class="hs-identifier">nlHsDataCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span>
</span><a name="line-401"></a><a name="nlHsDataCon"><a href="HsUtils.html#nlHsDataCon"><span class="hs-identifier">nlHsDataCon</span></a></a><span> </span><a name="local-6989586621683271647"><a href="#local-6989586621683271647"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsConLikeOut"><span class="hs-identifier hs-var">HsConLikeOut</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="#local-6989586621683271647"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-identifier">nlHsLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271504"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271504"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><a name="nlHsLit"><a href="HsUtils.html#nlHsLit"><span class="hs-identifier">nlHsLit</span></a></a><span> </span><a name="local-6989586621683271648"><a href="#local-6989586621683271648"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271648"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span class="hs-identifier">nlHsIntLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271503"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><a name="nlHsIntLit"><a href="HsUtils.html#nlHsIntLit"><span class="hs-identifier">nlHsIntLit</span></a></a><span> </span><a name="local-6989586621683271649"><a href="#local-6989586621683271649"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#mkIntegralLit"><span class="hs-identifier hs-var">mkIntegralLit</span></a><span> </span><a href="#local-6989586621683271649"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-identifier">nlVarPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271502"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271502"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><a name="nlVarPat"><a href="HsUtils.html#nlVarPat"><span class="hs-identifier">nlVarPat</span></a></a><span> </span><a name="local-6989586621683271650"><a href="#local-6989586621683271650"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271650"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-identifier">nlLitPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-413"></a><a name="nlLitPat"><a href="HsUtils.html#nlLitPat"><span class="hs-identifier">nlLitPat</span></a></a><span> </span><a name="local-6989586621683271651"><a href="#local-6989586621683271651"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271651"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-identifier">nlHsApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271501"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271501"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271501"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><a name="nlHsApp"><a href="HsUtils.html#nlHsApp"><span class="hs-identifier">nlHsApp</span></a></a><span> </span><a name="local-6989586621683271652"><a href="#local-6989586621683271652"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683271653"><a href="#local-6989586621683271653"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271652"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsPar"><span class="hs-identifier hs-var">mkLHsPar</span></a><span> </span><a href="#local-6989586621683271653"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>
</span><a name="line-418"></a><span class="hs-identifier">nlHsSyntaxApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271500"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271500"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-419"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271500"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><a name="nlHsSyntaxApps"><a href="HsUtils.html#nlHsSyntaxApps"><span class="hs-identifier">nlHsSyntaxApps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-var">SyntaxExpr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">syn_expr</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271654"><a href="#local-6989586621683271654"><span class="hs-identifier">fun</span></a></a><span>
</span><a name="line-421"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_arg_wraps</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271655"><a href="#local-6989586621683271655"><span class="hs-identifier">arg_wraps</span></a></a><span>
</span><a name="line-422"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">syn_res_wrap</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271656"><a href="#local-6989586621683271656"><span class="hs-identifier">res_wrap</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271657"><a href="#local-6989586621683271657"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-423"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271655"><span class="hs-identifier hs-var">arg_wraps</span></a><span>   </span><span class="hs-comment">-- in the noSyntaxExpr case</span><span>
</span><a name="line-424"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isIdHsWrapper</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">res_wrap</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>    </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271654"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271657"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-428"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><a href="#local-6989586621683271656"><span class="hs-identifier hs-var">res_wrap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271654"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Util.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a><span> </span><span class="hs-string">&quot;nlHsSyntaxApps&quot;</span><span>
</span><a name="line-429"></a><span>                                                     </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><a href="#local-6989586621683271655"><span class="hs-identifier hs-var">arg_wraps</span></a><span> </span><a href="#local-6989586621683271657"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-identifier">nlHsApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271499"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271499"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271499"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><a name="nlHsApps"><a href="HsUtils.html#nlHsApps"><span class="hs-identifier">nlHsApps</span></a></a><span> </span><a name="local-6989586621683271658"><a href="#local-6989586621683271658"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683271659"><a href="#local-6989586621683271659"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621683271658"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271659"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-identifier">nlHsVarApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271498"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271498"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271498"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><a name="nlHsVarApps"><a href="HsUtils.html#nlHsVarApps"><span class="hs-identifier">nlHsVarApps</span></a></a><span> </span><a name="local-6989586621683271660"><a href="#local-6989586621683271660"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683271661"><a href="#local-6989586621683271661"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="#local-6989586621683271662"><span class="hs-identifier hs-var">mk</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271660"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271661"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>                 </span><span class="hs-keyword">where</span><span>
</span><a name="line-438"></a><span>                   </span><a name="local-6989586621683271662"><a href="#local-6989586621683271662"><span class="hs-identifier">mk</span></a></a><span> </span><a name="local-6989586621683271663"><a href="#local-6989586621683271663"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683271664"><a href="#local-6989586621683271664"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271663"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271664"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-identifier">nlConVarPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-441"></a><a name="nlConVarPat"><a href="HsUtils.html#nlConVarPat"><span class="hs-identifier">nlConVarPat</span></a></a><span> </span><a name="local-6989586621683271665"><a href="#local-6989586621683271665"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683271666"><a href="#local-6989586621683271666"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConPat"><span class="hs-identifier hs-var">nlConPat</span></a><span> </span><a href="#local-6989586621683271665"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621683271666"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-identifier">nlConVarPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-444"></a><a name="nlConVarPatName"><a href="HsUtils.html#nlConVarPatName"><span class="hs-identifier">nlConVarPatName</span></a></a><span> </span><a name="local-6989586621683271667"><a href="#local-6989586621683271667"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683271668"><a href="#local-6989586621683271668"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlConPatName"><span class="hs-identifier hs-var">nlConPatName</span></a><span> </span><a href="#local-6989586621683271667"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621683271668"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-identifier">nlInfixConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-447"></a><a name="nlInfixConPat"><a href="HsUtils.html#nlInfixConPat"><span class="hs-identifier">nlInfixConPat</span></a></a><span> </span><a name="local-6989586621683271669"><a href="#local-6989586621683271669"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683271670"><a href="#local-6989586621683271670"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683271671"><a href="#local-6989586621683271671"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271669"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>                              </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#parenthesizePat"><span class="hs-identifier hs-var">parenthesizePat</span></a><span> </span><a href="BasicTypes.html#opPrec"><span class="hs-identifier hs-var">opPrec</span></a><span> </span><a href="#local-6989586621683271670"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-449"></a><span>                                        </span><span class="hs-special">(</span><a href="HsPat.html#parenthesizePat"><span class="hs-identifier hs-var">parenthesizePat</span></a><span> </span><a href="BasicTypes.html#opPrec"><span class="hs-identifier hs-var">opPrec</span></a><span> </span><a href="#local-6989586621683271671"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-identifier">nlConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-452"></a><a name="nlConPat"><a href="HsUtils.html#nlConPat"><span class="hs-identifier">nlConPat</span></a></a><span> </span><a name="local-6989586621683271672"><a href="#local-6989586621683271672"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683271673"><a href="#local-6989586621683271673"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-453"></a><span>  </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271672"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#parenthesizePat"><span class="hs-identifier hs-var">parenthesizePat</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271673"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-identifier">nlConPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-456"></a><a name="nlConPatName"><a href="HsUtils.html#nlConPatName"><span class="hs-identifier">nlConPatName</span></a></a><span> </span><a name="local-6989586621683271674"><a href="#local-6989586621683271674"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621683271675"><a href="#local-6989586621683271675"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-457"></a><span>  </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271674"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#parenthesizePat"><span class="hs-identifier hs-var">parenthesizePat</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271675"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-identifier">nlNullaryConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271497"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271497"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-460"></a><a name="nlNullaryConPat"><a href="HsUtils.html#nlNullaryConPat"><span class="hs-identifier">nlNullaryConPat</span></a></a><span> </span><a name="local-6989586621683271676"><a href="#local-6989586621683271676"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271676"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-identifier">nlWildConPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-463"></a><a name="nlWildConPat"><a href="HsUtils.html#nlWildConPat"><span class="hs-identifier">nlWildConPat</span></a></a><span> </span><a name="local-6989586621683271677"><a href="#local-6989586621683271677"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621683271677"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>                         </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#nOfThem"><span class="hs-identifier hs-var">nOfThem</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConSourceArity"><span class="hs-identifier hs-var">dataConSourceArity</span></a><span> </span><a href="#local-6989586621683271677"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>                                             </span><a href="HsUtils.html#nlWildPat"><span class="hs-identifier hs-var">nlWildPat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-identifier">nlWildPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-468"></a><a name="nlWildPat"><a href="HsUtils.html#nlWildPat"><span class="hs-identifier">nlWildPat</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Pre-typechecking</span><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-identifier">nlWildPatName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-471"></a><a name="nlWildPatName"><a href="HsUtils.html#nlWildPatName"><span class="hs-identifier">nlWildPatName</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Pre-typechecking</span><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span class="hs-identifier">nlHsDo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsStmtContext"><span class="hs-identifier hs-type">HsStmtContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmt"><span class="hs-identifier hs-type">LStmt</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-474"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-475"></a><a name="nlHsDo"><a href="HsUtils.html#nlHsDo"><span class="hs-identifier">nlHsDo</span></a></a><span> </span><a name="local-6989586621683271678"><a href="#local-6989586621683271678"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621683271679"><a href="#local-6989586621683271679"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsDo"><span class="hs-identifier hs-var">mkHsDo</span></a><span> </span><a href="#local-6989586621683271678"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621683271679"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-identifier">nlHsOpApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-478"></a><a name="nlHsOpApp"><a href="HsUtils.html#nlHsOpApp"><span class="hs-identifier">nlHsOpApp</span></a></a><span> </span><a name="local-6989586621683271680"><a href="#local-6989586621683271680"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621683271681"><a href="#local-6989586621683271681"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621683271682"><a href="#local-6989586621683271682"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsOpApp"><span class="hs-identifier hs-var">mkHsOpApp</span></a><span> </span><a href="#local-6989586621683271680"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621683271681"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621683271682"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-identifier">nlHsLam</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-481"></a><span class="hs-identifier">nlHsPar</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271496"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271496"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span class="hs-identifier">nlHsIf</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271495"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271495"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271495"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271495"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span class="hs-identifier">nlHsCase</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-485"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-486"></a><span class="hs-identifier">nlList</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><a name="nlHsLam"><a href="HsUtils.html#nlHsLam"><span class="hs-identifier">nlHsLam</span></a></a><span> </span><a name="local-6989586621683271683"><a href="#local-6989586621683271683"><span class="hs-identifier">match</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271683"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-489"></a><a name="nlHsPar"><a href="HsUtils.html#nlHsPar"><span class="hs-identifier">nlHsPar</span></a></a><span> </span><a name="local-6989586621683271684"><a href="#local-6989586621683271684"><span class="hs-identifier">e</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271684"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-comment">-- Note [Rebindable nlHsIf]</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- nlHsIf should generate if-expressions which are NOT subject to</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- RebindableSyntax, so the first field of HsIf is Nothing. (#12080)</span><span>
</span><a name="line-494"></a><a name="nlHsIf"><a href="HsUtils.html#nlHsIf"><span class="hs-identifier">nlHsIf</span></a></a><span> </span><a name="local-6989586621683271685"><a href="#local-6989586621683271685"><span class="hs-identifier">cond</span></a></a><span> </span><a name="local-6989586621683271686"><a href="#local-6989586621683271686"><span class="hs-identifier">true</span></a></a><span> </span><a name="local-6989586621683271687"><a href="#local-6989586621683271687"><span class="hs-identifier">false</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsIf"><span class="hs-identifier hs-var">HsIf</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621683271685"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621683271686"><span class="hs-identifier hs-var">true</span></a><span> </span><a href="#local-6989586621683271687"><span class="hs-identifier hs-var">false</span></a><span class="hs-special">)</span><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><a name="nlHsCase"><a href="HsUtils.html#nlHsCase"><span class="hs-identifier">nlHsCase</span></a></a><span> </span><a name="local-6989586621683271688"><a href="#local-6989586621683271688"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621683271689"><a href="#local-6989586621683271689"><span class="hs-identifier">matches</span></a></a><span>
</span><a name="line-497"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271688"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><a href="#local-6989586621683271689"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-498"></a><a name="nlList"><a href="HsUtils.html#nlList"><span class="hs-identifier">nlList</span></a></a><span> </span><a name="local-6989586621683271690"><a href="#local-6989586621683271690"><span class="hs-identifier">exprs</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621683271690"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span class="hs-identifier">nlHsAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271494"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271494"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271494"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span class="hs-identifier">nlHsTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271493"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271493"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span class="hs-identifier">nlHsFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271492"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271492"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271492"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span class="hs-identifier">nlHsParTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271491"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271491"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><a name="nlHsAppTy"><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier">nlHsAppTy</span></a></a><span> </span><a name="local-6989586621683271691"><a href="#local-6989586621683271691"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621683271692"><a href="#local-6989586621683271692"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271691"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#parenthesizeHsType"><span class="hs-identifier hs-var">parenthesizeHsType</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span> </span><a href="#local-6989586621683271692"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-506"></a><a name="nlHsTyVar"><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier">nlHsTyVar</span></a></a><span> </span><a name="local-6989586621683271693"><a href="#local-6989586621683271693"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="BasicTypes.html#NotPromoted"><span class="hs-identifier hs-var">NotPromoted</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621683271693"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-507"></a><a name="nlHsFunTy"><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier">nlHsFunTy</span></a></a><span> </span><a name="local-6989586621683271694"><a href="#local-6989586621683271694"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621683271695"><a href="#local-6989586621683271695"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#parenthesizeHsType"><span class="hs-identifier hs-var">parenthesizeHsType</span></a><span> </span><a href="BasicTypes.html#funPrec"><span class="hs-identifier hs-var">funPrec</span></a><span> </span><a href="#local-6989586621683271694"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271695"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-508"></a><a name="nlHsParTy"><a href="HsUtils.html#nlHsParTy"><span class="hs-identifier">nlHsParTy</span></a></a><span> </span><a name="local-6989586621683271696"><a href="#local-6989586621683271696"><span class="hs-identifier">t</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271696"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">nlHsTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271490"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271490"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271490"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-511"></a><a name="nlHsTyConApp"><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier">nlHsTyConApp</span></a></a><span> </span><a name="local-6989586621683271697"><a href="#local-6989586621683271697"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621683271698"><a href="#local-6989586621683271698"><span class="hs-identifier">tys</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><a href="#local-6989586621683271697"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271698"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-comment">{-
Tuples.  All these functions are *pre-typechecker* because they lack
types on the tuple.
-}</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-identifier">mkLHsTupleExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span class="hs-comment">-- Makes a pre-typechecker boxed tuple, deals with 1 case</span><span>
</span><a name="line-520"></a><a name="mkLHsTupleExpr"><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier">mkLHsTupleExpr</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621683271699"><a href="#local-6989586621683271699"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271699"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-521"></a><span class="hs-identifier">mkLHsTupleExpr</span><span> </span><a name="local-6989586621683271700"><a href="#local-6989586621683271700"><span class="hs-identifier">es</span></a></a><span>
</span><a name="line-522"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271700"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-identifier">mkLHsVarTuple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271488"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271488"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><a name="mkLHsVarTuple"><a href="HsUtils.html#mkLHsVarTuple"><span class="hs-identifier">mkLHsVarTuple</span></a></a><span> </span><a name="local-6989586621683271701"><a href="#local-6989586621683271701"><span class="hs-identifier">ids</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621683271701"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-identifier">nlTuplePat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Boxity"><span class="hs-identifier hs-type">Boxity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-528"></a><a name="nlTuplePat"><a href="HsUtils.html#nlTuplePat"><span class="hs-identifier">nlTuplePat</span></a></a><span> </span><a name="local-6989586621683271702"><a href="#local-6989586621683271702"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621683271703"><a href="#local-6989586621683271703"><span class="hs-identifier">box</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271702"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621683271703"><span class="hs-identifier hs-var">box</span></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-identifier">missingTupArg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsTupArg"><span class="hs-identifier hs-type">HsTupArg</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-531"></a><a name="missingTupArg"><a href="HsUtils.html#missingTupArg"><span class="hs-identifier">missingTupArg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#Missing"><span class="hs-identifier hs-var">Missing</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-534"></a><a name="mkLHsPatTup"><a href="HsUtils.html#mkLHsPatTup"><span class="hs-identifier">mkLHsPatTup</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span>
</span><a name="line-535"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><span class="hs-special">[</span><a name="local-6989586621683271704"><a href="#local-6989586621683271704"><span class="hs-identifier">lpat</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271704"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-536"></a><span class="hs-identifier">mkLHsPatTup</span><span> </span><a name="local-6989586621683271705"><a href="#local-6989586621683271705"><span class="hs-identifier">lpats</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621683271705"><span class="hs-identifier hs-var">lpats</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271705"><span class="hs-identifier hs-var">lpats</span></a><span> </span><a href="BasicTypes.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-comment">-- The Big equivalents for the source tuple expressions</span><span>
</span><a name="line-539"></a><span class="hs-identifier">mkBigLHsVarTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271487"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271487"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-540"></a><a name="mkBigLHsVarTup"><a href="HsUtils.html#mkBigLHsVarTup"><span class="hs-identifier">mkBigLHsVarTup</span></a></a><span> </span><a name="local-6989586621683271706"><a href="#local-6989586621683271706"><span class="hs-identifier">ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier hs-var">mkBigLHsTup</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-6989586621683271706"><span class="hs-identifier hs-var">ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-541"></a><span>
</span><a name="line-542"></a><span class="hs-identifier">mkBigLHsTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271486"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271486"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><a name="mkBigLHsTup"><a href="HsUtils.html#mkBigLHsTup"><span class="hs-identifier">mkBigLHsTup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="HsUtils.html#mkLHsTupleExpr"><span class="hs-identifier hs-var">mkLHsTupleExpr</span></a><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span class="hs-comment">-- The Big equivalents for the source tuple patterns</span><span>
</span><a name="line-546"></a><span class="hs-identifier">mkBigLHsVarPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-547"></a><a name="mkBigLHsVarPatTup"><a href="HsUtils.html#mkBigLHsVarPatTup"><span class="hs-identifier">mkBigLHsVarPatTup</span></a></a><span> </span><a name="local-6989586621683271707"><a href="#local-6989586621683271707"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier hs-var">mkBigLHsPatTup</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><a href="#local-6989586621683271707"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-identifier">mkBigLHsPatTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-550"></a><a name="mkBigLHsPatTup"><a href="HsUtils.html#mkBigLHsPatTup"><span class="hs-identifier">mkBigLHsPatTup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkChunkified"><span class="hs-identifier hs-var">mkChunkified</span></a><span> </span><a href="HsUtils.html#mkLHsPatTup"><span class="hs-identifier hs-var">mkLHsPatTup</span></a><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">-- $big_tuples</span><span>
</span><a name="line-553"></a><span class="hs-comment">-- #big_tuples#</span><span>
</span><a name="line-554"></a><span class="hs-comment">--</span><span>
</span><a name="line-555"></a><span class="hs-comment">-- GHCs built in tuples can only go up to 'mAX_TUPLE_SIZE' in arity, but</span><span>
</span><a name="line-556"></a><span class="hs-comment">-- we might concievably want to build such a massive tuple as part of the</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- output of a desugaring stage (notably that for list comprehensions).</span><span>
</span><a name="line-558"></a><span class="hs-comment">--</span><span>
</span><a name="line-559"></a><span class="hs-comment">-- We call tuples above this size \&quot;big tuples\&quot;, and emulate them by</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- creating and pattern matching on &gt;nested&lt; tuples that are expressible</span><span>
</span><a name="line-561"></a><span class="hs-comment">-- by GHC.</span><span>
</span><a name="line-562"></a><span class="hs-comment">--</span><span>
</span><a name="line-563"></a><span class="hs-comment">-- Nesting policy: it's better to have a 2-tuple of 10-tuples (3 objects)</span><span>
</span><a name="line-564"></a><span class="hs-comment">-- than a 10-tuple of 2-tuples (11 objects), so we want the leaves of any</span><span>
</span><a name="line-565"></a><span class="hs-comment">-- construction to be big.</span><span>
</span><a name="line-566"></a><span class="hs-comment">--</span><span>
</span><a name="line-567"></a><span class="hs-comment">-- If you just use the 'mkBigCoreTup', 'mkBigCoreVarTupTy', 'mkTupleSelector'</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- and 'mkTupleCase' functions to do all your work with tuples you should be</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- fine, and not have to worry about the arity limitation at all.</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">-- | Lifts a \&quot;small\&quot; constructor into a \&quot;big\&quot; constructor by recursive decompositon</span><span>
</span><a name="line-572"></a><span class="hs-identifier">mkChunkified</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621683271485"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683271485"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^ \&quot;Small\&quot; constructor function, of maximum input arity 'mAX_TUPLE_SIZE'</span><span>
</span><a name="line-573"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271485"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ Possible \&quot;big\&quot; list of things to construct from</span><span>
</span><a name="line-574"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683271485"><span class="hs-identifier hs-type">a</span></a><span>               </span><span class="hs-comment">-- ^ Constructed thing made possible by recursive decomposition</span><span>
</span><a name="line-575"></a><a name="mkChunkified"><a href="HsUtils.html#mkChunkified"><span class="hs-identifier">mkChunkified</span></a></a><span> </span><a name="local-6989586621683271708"><a href="#local-6989586621683271708"><span class="hs-identifier">small_tuple</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271710"><span class="hs-identifier hs-var">mk_big_tuple</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-577"></a><span>        </span><span class="hs-comment">-- Each sub-list is short enough to fit in a tuple</span><span>
</span><a name="line-578"></a><span>    </span><a name="local-6989586621683271710"><a href="#local-6989586621683271710"><span class="hs-identifier">mk_big_tuple</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">as</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271708"><span class="hs-identifier hs-var">small_tuple</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-identifier">mk_big_tuple</span><span> </span><a name="local-6989586621683271712"><a href="#local-6989586621683271712"><span class="hs-identifier">as_s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271710"><span class="hs-identifier hs-var">mk_big_tuple</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#chunkify"><span class="hs-identifier hs-var">chunkify</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271708"><span class="hs-identifier hs-var">small_tuple</span></a><span> </span><a href="#local-6989586621683271712"><span class="hs-identifier hs-var">as_s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-identifier">chunkify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621683271484"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-582"></a><span class="hs-comment">-- ^ Split a list into lists that are small enough to have a corresponding</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- tuple arity. The sub-lists of the result all have length &lt;= 'mAX_TUPLE_SIZE'</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- But there may be more than 'mAX_TUPLE_SIZE' sub-lists</span><span>
</span><a name="line-585"></a><a name="chunkify"><a href="HsUtils.html#chunkify"><span class="hs-identifier">chunkify</span></a></a><span> </span><a name="local-6989586621683271713"><a href="#local-6989586621683271713"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-586"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683271714"><span class="hs-identifier hs-var">n_xs</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271713"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-587"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271715"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621683271713"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-588"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-589"></a><span>    </span><a name="local-6989586621683271714"><a href="#local-6989586621683271714"><span class="hs-identifier">n_xs</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621683271713"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-590"></a><span>    </span><a name="local-6989586621683271715"><a href="#local-6989586621683271715"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-591"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621683271716"><a href="#local-6989586621683271716"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><a href="#local-6989586621683271716"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271715"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><a href="Constants.html#mAX_TUPLE_SIZE"><span class="hs-identifier hs-var">mAX_TUPLE_SIZE</span></a><span> </span><a href="#local-6989586621683271716"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        LHsSigType and LHsSigWcType
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-identifier">mkLHsSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-601"></a><a name="mkLHsSigType"><a href="HsUtils.html#mkLHsSigType"><span class="hs-identifier">mkLHsSigType</span></a></a><span> </span><a name="local-6989586621683271717"><a href="#local-6989586621683271717"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span> </span><a href="#local-6989586621683271717"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-identifier">mkLHsSigWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-604"></a><a name="mkLHsSigWcType"><a href="HsUtils.html#mkLHsSigWcType"><span class="hs-identifier">mkLHsSigWcType</span></a></a><span> </span><a name="local-6989586621683271718"><a href="#local-6989586621683271718"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#mkHsWildCardBndrs"><span class="hs-identifier hs-var">mkHsWildCardBndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#mkHsImplicitBndrs"><span class="hs-identifier hs-var">mkHsImplicitBndrs</span></a><span> </span><a href="#local-6989586621683271718"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-identifier">mkHsSigEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621683271483"><a href="#local-6989586621683271483"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-607"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span>
</span><a name="line-608"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="#local-6989586621683271483"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-609"></a><a name="mkHsSigEnv"><a href="HsUtils.html#mkHsSigEnv"><span class="hs-identifier">mkHsSigEnv</span></a></a><span> </span><a name="local-6989586621683271719"><a href="#local-6989586621683271719"><span class="hs-identifier">get_info</span></a></a><span> </span><a name="local-6989586621683271720"><a href="#local-6989586621683271720"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-610"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a><span>          </span><span class="hs-special">(</span><a href="#local-6989586621683271724"><span class="hs-identifier hs-var">mk_pairs</span></a><span> </span><a href="#local-6989586621683271722"><span class="hs-identifier hs-var">ordinary_sigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>   </span><span class="hs-special">`</span><a href="NameEnv.html#extendNameEnvList"><span class="hs-identifier hs-var">extendNameEnvList</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271724"><span class="hs-identifier hs-var">mk_pairs</span></a><span> </span><a href="#local-6989586621683271721"><span class="hs-identifier hs-var">gen_dm_sigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span>   </span><span class="hs-comment">-- The subtlety is this: in a class decl with a</span><span>
</span><a name="line-613"></a><span>   </span><span class="hs-comment">-- default-method signature as well as a method signature</span><span>
</span><a name="line-614"></a><span>   </span><span class="hs-comment">-- we want the latter to win (Trac #12533)</span><span>
</span><a name="line-615"></a><span>   </span><span class="hs-comment">--    class C x where</span><span>
</span><a name="line-616"></a><span>   </span><span class="hs-comment">--       op :: forall a . x a -&gt; x a</span><span>
</span><a name="line-617"></a><span>   </span><span class="hs-comment">--       default op :: forall b . x b -&gt; x b</span><span>
</span><a name="line-618"></a><span>   </span><span class="hs-comment">--       op x = ...(e :: b -&gt; b)...</span><span>
</span><a name="line-619"></a><span>   </span><span class="hs-comment">-- The scoped type variables of the 'default op', namely 'b',</span><span>
</span><a name="line-620"></a><span>   </span><span class="hs-comment">-- scope over the code for op.   The 'forall a' does not!</span><span>
</span><a name="line-621"></a><span>   </span><span class="hs-comment">-- This applies both in the renamer and typechecker, both</span><span>
</span><a name="line-622"></a><span>   </span><span class="hs-comment">-- of which use this function</span><span>
</span><a name="line-623"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-624"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621683271721"><a href="#local-6989586621683271721"><span class="hs-identifier">gen_dm_sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271722"><a href="#local-6989586621683271722"><span class="hs-identifier">ordinary_sigs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partition</span><span> </span><a href="#local-6989586621683271723"><span class="hs-identifier hs-var">is_gen_dm_sig</span></a><span> </span><a href="#local-6989586621683271720"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-625"></a><span>    </span><a name="local-6989586621683271723"><a href="#local-6989586621683271723"><span class="hs-identifier">is_gen_dm_sig</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-626"></a><span>    </span><span class="hs-identifier">is_gen_dm_sig</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span>    </span><span class="hs-identifier">mk_pairs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271483"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-629"></a><span>    </span><a name="local-6989586621683271724"><a href="#local-6989586621683271724"><span class="hs-identifier">mk_pairs</span></a></a><span> </span><a name="local-6989586621683271725"><a href="#local-6989586621683271725"><span class="hs-identifier">sigs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271728"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><a href="#local-6989586621683271727"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683271726"><a href="#local-6989586621683271726"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><a name="local-6989586621683271727"><a href="#local-6989586621683271727"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271719"><span class="hs-identifier hs-var">get_info</span></a><span> </span><a href="#local-6989586621683271725"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-630"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271728"><a href="#local-6989586621683271728"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271726"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-identifier">mkClassOpSigs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-633"></a><span class="hs-comment">-- Convert TypeSig to ClassOpSig</span><span>
</span><a name="line-634"></a><span class="hs-comment">-- The former is what is parsed, but the latter is</span><span>
</span><a name="line-635"></a><span class="hs-comment">-- what we need in class/instance declarations</span><span>
</span><a name="line-636"></a><a name="mkClassOpSigs"><a href="HsUtils.html#mkClassOpSigs"><span class="hs-identifier">mkClassOpSigs</span></a></a><span> </span><a name="local-6989586621683271729"><a href="#local-6989586621683271729"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-637"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271730"><span class="hs-identifier hs-var">fiddle</span></a><span> </span><a href="#local-6989586621683271729"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-638"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-639"></a><span>    </span><a name="local-6989586621683271730"><a href="#local-6989586621683271730"><span class="hs-identifier">fiddle</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271731"><a href="#local-6989586621683271731"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271732"><a href="#local-6989586621683271732"><span class="hs-identifier">nms</span></a></a><span> </span><a name="local-6989586621683271733"><a href="#local-6989586621683271733"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271731"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683271732"><span class="hs-identifier hs-var">nms</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#dropWildCards"><span class="hs-identifier hs-var">dropWildCards</span></a><span> </span><a href="#local-6989586621683271733"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-641"></a><span>    </span><span class="hs-identifier">fiddle</span><span> </span><a name="local-6989586621683271734"><a href="#local-6989586621683271734"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271734"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-identifier">typeToLHsType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-644"></a><span class="hs-comment">-- ^ Converting a Type to an HsType RdrName</span><span>
</span><a name="line-645"></a><span class="hs-comment">-- This is needed to implement GeneralizedNewtypeDeriving.</span><span>
</span><a name="line-646"></a><span class="hs-comment">--</span><span>
</span><a name="line-647"></a><span class="hs-comment">-- Note that we use 'getRdrName' extensively, which</span><span>
</span><a name="line-648"></a><span class="hs-comment">-- generates Exact RdrNames rather than strings.</span><span>
</span><a name="line-649"></a><a name="typeToLHsType"><a href="HsUtils.html#typeToLHsType"><span class="hs-identifier">typeToLHsType</span></a></a><span> </span><a name="local-6989586621683271735"><a href="#local-6989586621683271735"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-650"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271735"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-651"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-652"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-653"></a><span>    </span><a name="local-6989586621683271736"><a href="#local-6989586621683271736"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621683271738"><a href="#local-6989586621683271738"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621683271739"><a href="#local-6989586621683271739"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-654"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-6989586621683271739"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-655"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683271740"><a href="#local-6989586621683271740"><span class="hs-identifier">theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271741"><a href="#local-6989586621683271741"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitPhiTy"><span class="hs-identifier hs-var">tcSplitPhiTy</span></a><span> </span><a href="#local-6989586621683271738"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-656"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271740"><span class="hs-identifier hs-var">theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xqual</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-658"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271741"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621683271742"><a href="#local-6989586621683271742"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621683271743"><a href="#local-6989586621683271743"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsFunTy"><span class="hs-identifier hs-var">nlHsFunTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271742"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271743"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683271744"><a href="#local-6989586621683271744"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-661"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683271745"><a href="#local-6989586621683271745"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271746"><a href="#local-6989586621683271746"><span class="hs-identifier">tau</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcType.html#tcSplitForAllTys"><span class="hs-identifier hs-var">tcSplitForAllTys</span></a><span> </span><a href="#local-6989586621683271744"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-662"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271737"><span class="hs-identifier hs-var">go_tv</span></a><span> </span><a href="#local-6989586621683271745"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-663"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_xforall</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-664"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271746"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-665"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621683271747"><a href="#local-6989586621683271747"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsTyVar"><span class="hs-identifier hs-var">nlHsTyVar</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621683271747"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621683271748"><a href="#local-6989586621683271748"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621683271749"><a href="#local-6989586621683271749"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsAppTy"><span class="hs-identifier hs-var">nlHsAppTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271748"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271749"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-6989586621683271750"><a href="#local-6989586621683271750"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-var">NoExt</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsNumTy"><span class="hs-identifier hs-var">HsNumTy</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621683271750"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-6989586621683271751"><a href="#local-6989586621683271751"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-var">NoExt</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsStrTy"><span class="hs-identifier hs-var">HsStrTy</span></a><span> </span><a href="BasicTypes.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a><span> </span><a href="#local-6989586621683271751"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683271752"><a href="#local-6989586621683271752"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621683271753"><a href="#local-6989586621683271753"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621683271754"><a href="#local-6989586621683271754"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-672"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="TyCon.html#isInvisibleTyConBinder"><span class="hs-identifier hs-var">isInvisibleTyConBinder</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConBinders</span><span> </span><a href="#local-6989586621683271753"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-673"></a><span>        </span><span class="hs-comment">-- We must produce an explicit kind signature here to make certain</span><span>
</span><a name="line-674"></a><span>        </span><span class="hs-comment">-- programs kind-check. See Note [Kind signatures in typeToLHsType].</span><span>
</span><a name="line-675"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsParTy"><span class="hs-identifier hs-var">nlHsParTy</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a href="HsExtension.html#NoExt"><span class="hs-identifier hs-var">NoExt</span></a><span> </span><a href="#local-6989586621683271755"><span class="hs-identifier hs-var">lhs_ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621683271752"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271755"><span class="hs-identifier hs-var">lhs_ty</span></a><span>
</span><a name="line-677"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-678"></a><span>        </span><a name="local-6989586621683271755"><a href="#local-6989586621683271755"><span class="hs-identifier">lhs_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsTyConApp"><span class="hs-identifier hs-var">nlHsTyConApp</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621683271753"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271756"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span>        </span><a name="local-6989586621683271756"><a href="#local-6989586621683271756"><span class="hs-identifier">args'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span> </span><a href="#local-6989586621683271753"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621683271754"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-680"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621683271757"><a href="#local-6989586621683271757"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271757"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-681"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621683271758"><a href="#local-6989586621683271758"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;toLHsSigWcType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621683271758"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span>         </span><span class="hs-comment">-- Source-language types have _invisible_ kind arguments,</span><span>
</span><a name="line-684"></a><span>         </span><span class="hs-comment">-- so we must remove them here (Trac #8563)</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span>    </span><span class="hs-identifier">go_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-687"></a><span>    </span><a name="local-6989586621683271737"><a href="#local-6989586621683271737"><span class="hs-identifier">go_tv</span></a></a><span> </span><a name="local-6989586621683271759"><a href="#local-6989586621683271759"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#getRdrName"><span class="hs-identifier hs-var">getRdrName</span></a><span> </span><a href="#local-6989586621683271759"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>                                   </span><span class="hs-special">(</span><a href="#local-6989586621683271736"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621683271759"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">{-
Note [Kind signatures in typeToLHsType]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There are types that typeToLHsType can produce which require explicit kind
signatures in order to kind-check. Here is an example from Trac #14579:

  newtype Wat (x :: Proxy (a :: Type)) = MkWat (Maybe a) deriving Eq
  newtype Glurp a = MkGlurp (Wat ('Proxy :: Proxy a)) deriving Eq

The derived Eq instance for Glurp (without any kind signatures) would be:

  instance Eq a =&gt; Eq (Glurp a) where
    (==) = coerce @(Wat 'Proxy -&gt; Wat 'Proxy -&gt; Bool)
                  @(Glurp a    -&gt; Glurp a    -&gt; Bool)
                  (==) :: Glurp a -&gt; Glurp a -&gt; Bool

(Where the visible type applications use types produced by typeToLHsType.)

The type 'Proxy has an underspecified kind, so we must ensure that
typeToLHsType ascribes it with its kind: ('Proxy :: Proxy a).

We must be careful not to produce too many kind signatures, or else
typeToLHsType can produce noisy types like
('Proxy :: Proxy (a :: (Type :: Type))). In pursuit of this goal, we adopt the
following criterion for choosing when to annotate types with kinds:

* If there is a tycon application with any invisible arguments, annotate
  the tycon application with its kind.

Why is this the right criterion? The problem we encountered earlier was the
result of an invisible argument (the `a` in ('Proxy :: Proxy a)) being
underspecified, so producing a kind signature for 'Proxy will catch this.
If there are no invisible arguments, then there is nothing to do, so we can
avoid polluting the result type with redundant noise.

What about a more complicated tycon, such as this?

  T :: forall {j} (a :: j). a -&gt; Type

Unlike in the previous 'Proxy example, annotating an application of `T` to an
argument (e.g., annotating T ty to obtain (T ty :: Type)) will not fix
its invisible argument `j`. But because we apply this strategy recursively,
`j` will be fixed because the kind of `ty` will be fixed! That is to say,
something to the effect of (T (ty :: j) :: Type) will be produced.

This strategy certainly isn't foolproof, as tycons that contain type families
in their kind might break down. But we'd likely need visible kind application
to make those work.
-}</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
    --------- HsWrappers: type args, dict args, casts ---------
*                                                                      *
********************************************************************* -}</span><span>
</span><a name="line-745"></a><span>
</span><a name="line-746"></a><span class="hs-identifier">mkLHsWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271482"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271482"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-747"></a><a name="mkLHsWrap"><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier">mkLHsWrap</span></a></a><span> </span><a name="local-6989586621683271760"><a href="#local-6989586621683271760"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271761"><a href="#local-6989586621683271761"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271762"><a href="#local-6989586621683271762"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271761"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><a href="#local-6989586621683271760"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621683271762"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-comment">-- Avoid (HsWrap co (HsWrap co' _)).</span><span>
</span><a name="line-750"></a><span class="hs-comment">-- See Note [Detecting forced eta expansion] in DsExpr</span><span>
</span><a name="line-751"></a><span class="hs-identifier">mkHsWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271481"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271481"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-752"></a><a name="mkHsWrap"><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier">mkHsWrap</span></a></a><span> </span><a name="local-6989586621683271763"><a href="#local-6989586621683271763"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621683271764"><a href="#local-6989586621683271764"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621683271763"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271764"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-753"></a><span class="hs-identifier">mkHsWrap</span><span> </span><a name="local-6989586621683271765"><a href="#local-6989586621683271765"><span class="hs-identifier">co_fn</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271766"><a href="#local-6989586621683271766"><span class="hs-identifier">co_fn'</span></a></a><span> </span><a name="local-6989586621683271767"><a href="#local-6989586621683271767"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271765"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621683271766"><span class="hs-identifier hs-var">co_fn'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271767"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-754"></a><span class="hs-identifier">mkHsWrap</span><span> </span><a name="local-6989586621683271768"><a href="#local-6989586621683271768"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621683271769"><a href="#local-6989586621683271769"><span class="hs-identifier">e</span></a></a><span>                       </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsWrap"><span class="hs-identifier hs-var">HsWrap</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271768"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621683271769"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-identifier">mkHsWrapCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span>   </span><span class="hs-comment">-- A Nominal coercion  a ~N b</span><span>
</span><a name="line-757"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271480"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271480"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-758"></a><a name="mkHsWrapCo"><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier">mkHsWrapCo</span></a></a><span> </span><a name="local-6989586621683271770"><a href="#local-6989586621683271770"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621683271771"><a href="#local-6989586621683271771"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier hs-var">mkWpCastN</span></a><span> </span><a href="#local-6989586621683271770"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271771"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span class="hs-identifier">mkHsWrapCoR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionR"><span class="hs-identifier hs-type">TcCoercionR</span></a><span>   </span><span class="hs-comment">-- A Representational coercion  a ~R b</span><span>
</span><a name="line-761"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271479"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271479"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-762"></a><a name="mkHsWrapCoR"><a href="HsUtils.html#mkHsWrapCoR"><span class="hs-identifier">mkHsWrapCoR</span></a></a><span> </span><a name="local-6989586621683271772"><a href="#local-6989586621683271772"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621683271773"><a href="#local-6989586621683271773"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastR"><span class="hs-identifier hs-var">mkWpCastR</span></a><span> </span><a href="#local-6989586621683271772"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271773"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span class="hs-identifier">mkLHsWrapCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271478"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271478"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-765"></a><a name="mkLHsWrapCo"><a href="HsUtils.html#mkLHsWrapCo"><span class="hs-identifier">mkLHsWrapCo</span></a></a><span> </span><a name="local-6989586621683271774"><a href="#local-6989586621683271774"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271775"><a href="#local-6989586621683271775"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271776"><a href="#local-6989586621683271776"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271775"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a><span> </span><a href="#local-6989586621683271774"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-6989586621683271776"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span class="hs-identifier">mkHsCmdWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271477"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271477"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><a name="mkHsCmdWrap"><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier">mkHsCmdWrap</span></a></a><span> </span><a name="local-6989586621683271777"><a href="#local-6989586621683271777"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621683271778"><a href="#local-6989586621683271778"><span class="hs-identifier">cmd</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621683271777"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271778"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-769"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsCmdWrap"><span class="hs-identifier hs-var">HsCmdWrap</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271777"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621683271778"><span class="hs-identifier hs-var">cmd</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span class="hs-identifier">mkLHsCmdWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271476"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmd"><span class="hs-identifier hs-type">LHsCmd</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271476"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-772"></a><a name="mkLHsCmdWrap"><a href="HsUtils.html#mkLHsCmdWrap"><span class="hs-identifier">mkLHsCmdWrap</span></a></a><span> </span><a name="local-6989586621683271779"><a href="#local-6989586621683271779"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271780"><a href="#local-6989586621683271780"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271781"><a href="#local-6989586621683271781"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271780"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsCmdWrap"><span class="hs-identifier hs-var">mkHsCmdWrap</span></a><span> </span><a href="#local-6989586621683271779"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621683271781"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-identifier">mkHsWrapPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271475"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271475"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-775"></a><a name="mkHsWrapPat"><a href="HsUtils.html#mkHsWrapPat"><span class="hs-identifier">mkHsWrapPat</span></a></a><span> </span><a name="local-6989586621683271782"><a href="#local-6989586621683271782"><span class="hs-identifier">co_fn</span></a></a><span> </span><a name="local-6989586621683271783"><a href="#local-6989586621683271783"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621683271784"><a href="#local-6989586621683271784"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621683271782"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271783"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-776"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271782"><span class="hs-identifier hs-var">co_fn</span></a><span> </span><a href="#local-6989586621683271783"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621683271784"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span class="hs-identifier">mkHsWrapPatCo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcCoercionN"><span class="hs-identifier hs-type">TcCoercionN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271474"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271474"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-779"></a><a name="mkHsWrapPatCo"><a href="HsUtils.html#mkHsWrapPatCo"><span class="hs-identifier">mkHsWrapPatCo</span></a></a><span> </span><a name="local-6989586621683271785"><a href="#local-6989586621683271785"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621683271786"><a href="#local-6989586621683271786"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683271787"><a href="#local-6989586621683271787"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isTcReflCo"><span class="hs-identifier hs-var">isTcReflCo</span></a><span> </span><a href="#local-6989586621683271785"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271786"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-780"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpCastN"><span class="hs-identifier hs-var">mkWpCastN</span></a><span> </span><a href="#local-6989586621683271785"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271786"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271787"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span class="hs-identifier">mkHsDictLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span>
</span><a name="line-783"></a><a name="mkHsDictLet"><a href="HsUtils.html#mkHsDictLet"><span class="hs-identifier">mkHsDictLet</span></a></a><span> </span><a name="local-6989586621683271788"><a href="#local-6989586621683271788"><span class="hs-identifier">ev_binds</span></a></a><span> </span><a name="local-6989586621683271789"><a href="#local-6989586621683271789"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a><span> </span><a href="#local-6989586621683271788"><span class="hs-identifier hs-var">ev_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271789"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-784"></a><span>
</span><a name="line-785"></a><span class="hs-comment">{-
l
************************************************************************
*                                                                      *
                Bindings; with a location at the top
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-793"></a><span>
</span><a name="line-794"></a><span class="hs-identifier">mkFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-795"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-796"></a><span class="hs-comment">-- Not infix, with place holders for coercion and free vars</span><span>
</span><a name="line-797"></a><a name="mkFunBind"><a href="HsUtils.html#mkFunBind"><span class="hs-identifier">mkFunBind</span></a></a><span> </span><a name="local-6989586621683271790"><a href="#local-6989586621683271790"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621683271791"><a href="#local-6989586621683271791"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271790"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-798"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><a href="#local-6989586621683271791"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-799"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-800"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-801"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-802"></a><span>
</span><a name="line-803"></a><span class="hs-identifier">mkTopFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Origin"><span class="hs-identifier hs-type">Origin</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-804"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-805"></a><span class="hs-comment">-- In Name-land, with empty bind_fvs</span><span>
</span><a name="line-806"></a><a name="mkTopFunBind"><a href="HsUtils.html#mkTopFunBind"><span class="hs-identifier">mkTopFunBind</span></a></a><span> </span><a name="local-6989586621683271792"><a href="#local-6989586621683271792"><span class="hs-identifier">origin</span></a></a><span> </span><a name="local-6989586621683271793"><a href="#local-6989586621683271793"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621683271794"><a href="#local-6989586621683271794"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271793"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-807"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroup"><span class="hs-identifier hs-var">mkMatchGroup</span></a><span> </span><a href="#local-6989586621683271792"><span class="hs-identifier hs-var">origin</span></a><span> </span><a href="#local-6989586621683271794"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-808"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-809"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_ext</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><span class="hs-comment">-- NB: closed</span><span>
</span><a name="line-810"></a><span>                                                              </span><span class="hs-comment">--     binding</span><span>
</span><a name="line-811"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span class="hs-identifier">mkHsVarBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-814"></a><a name="mkHsVarBind"><a href="HsUtils.html#mkHsVarBind"><span class="hs-identifier">mkHsVarBind</span></a></a><span> </span><a name="local-6989586621683271795"><a href="#local-6989586621683271795"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271796"><a href="#local-6989586621683271796"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621683271797"><a href="#local-6989586621683271797"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier hs-var">mk_easy_FunBind</span></a><span> </span><a href="#local-6989586621683271795"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271796"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683271797"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span class="hs-identifier">mkVarBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271473"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271473"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271473"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-817"></a><a name="mkVarBind"><a href="HsUtils.html#mkVarBind"><span class="hs-identifier">mkVarBind</span></a></a><span> </span><a name="local-6989586621683271798"><a href="#local-6989586621683271798"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621683271799"><a href="#local-6989586621683271799"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271799"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-818"></a><span>                    </span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span class="hs-special">,</span><span>
</span><a name="line-819"></a><span>                              </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271798"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271799"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">var_inline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span class="hs-identifier">mkPatSynBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">)</span><span>
</span><a name="line-822"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-823"></a><a name="mkPatSynBind"><a href="HsUtils.html#mkPatSynBind"><span class="hs-identifier">mkPatSynBind</span></a></a><span> </span><a name="local-6989586621683271800"><a href="#local-6989586621683271800"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621683271801"><a href="#local-6989586621683271801"><span class="hs-identifier">details</span></a></a><span> </span><a name="local-6989586621683271802"><a href="#local-6989586621683271802"><span class="hs-identifier">lpat</span></a></a><span> </span><a name="local-6989586621683271803"><a href="#local-6989586621683271803"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271804"><span class="hs-identifier hs-var">psb</span></a><span>
</span><a name="line-824"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-825"></a><span>    </span><a name="local-6989586621683271804"><a href="#local-6989586621683271804"><span class="hs-identifier">psb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_ext</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-826"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271800"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-827"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271801"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-828"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271802"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-829"></a><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271803"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-comment">-- |If any of the matches in the 'FunBind' are infix, the 'FunBind' is</span><span>
</span><a name="line-832"></a><span class="hs-comment">-- considered infix.</span><span>
</span><a name="line-833"></a><span class="hs-identifier">isInfixFunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621683271471"><span class="hs-identifier hs-type">id1</span></a><span> </span><a href="#local-6989586621683271472"><span class="hs-identifier hs-type">id2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-834"></a><a name="isInfixFunBind"><a href="HsUtils.html#isInfixFunBind"><span class="hs-identifier">isInfixFunBind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271805"><a href="#local-6989586621683271805"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-835"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#isInfixMatch"><span class="hs-identifier hs-var">isInfixMatch</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271805"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span class="hs-identifier">isInfixFunBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-837"></a><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-comment">------------</span><span>
</span><a name="line-840"></a><span class="hs-identifier">mk_easy_FunBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-841"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-842"></a><a name="mk_easy_FunBind"><a href="HsUtils.html#mk_easy_FunBind"><span class="hs-identifier">mk_easy_FunBind</span></a></a><span> </span><a name="local-6989586621683271806"><a href="#local-6989586621683271806"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621683271807"><a href="#local-6989586621683271807"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621683271808"><a href="#local-6989586621683271808"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621683271809"><a href="#local-6989586621683271809"><span class="hs-identifier">expr</span></a></a><span>
</span><a name="line-843"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271806"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsUtils.html#mkFunBind"><span class="hs-identifier hs-var">mkFunBind</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271806"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271807"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span>
</span><a name="line-844"></a><span>              </span><span class="hs-special">[</span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkPrefixFunRhs"><span class="hs-identifier hs-var">mkPrefixFunRhs</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271806"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271807"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271808"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621683271809"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-845"></a><span>                       </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span class="hs-comment">-- | Make a prefix, non-strict function 'HsMatchContext'</span><span>
</span><a name="line-848"></a><span class="hs-identifier">mkPrefixFunRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621683271470"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="#local-6989586621683271470"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-849"></a><a name="mkPrefixFunRhs"><a href="HsUtils.html#mkPrefixFunRhs"><span class="hs-identifier">mkPrefixFunRhs</span></a></a><span> </span><a name="local-6989586621683271810"><a href="#local-6989586621683271810"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mc_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271810"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-850"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a><span>
</span><a name="line-851"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mc_strictness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#NoSrcStrict"><span class="hs-identifier hs-var">NoSrcStrict</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-comment">------------</span><span>
</span><a name="line-854"></a><span class="hs-identifier">mkMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><span class="hs-special">(</span><a href="PlaceHolder.html#NameOrRdrName"><span class="hs-identifier hs-type">NameOrRdrName</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-855"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271469"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-858"></a><a name="mkMatch"><a href="HsUtils.html#mkMatch"><span class="hs-identifier">mkMatch</span></a></a><span> </span><a name="local-6989586621683271811"><a href="#local-6989586621683271811"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621683271812"><a href="#local-6989586621683271812"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621683271813"><a href="#local-6989586621683271813"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621683271814"><a href="#local-6989586621683271814"><span class="hs-identifier">lbinds</span></a></a><span>
</span><a name="line-859"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ext</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span>
</span><a name="line-860"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_ctxt</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271811"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-861"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271815"><span class="hs-identifier hs-var">paren</span></a><span> </span><a href="#local-6989586621683271812"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-862"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#unguardedRHS"><span class="hs-identifier hs-var">unguardedRHS</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="#local-6989586621683271813"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271814"><span class="hs-identifier hs-var">lbinds</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-863"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-864"></a><span>    </span><a name="local-6989586621683271815"><a href="#local-6989586621683271815"><span class="hs-identifier">paren</span></a></a><span> </span><a name="local-6989586621683271816"><a href="#local-6989586621683271816"><span class="hs-identifier">lp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271817"><a href="#local-6989586621683271817"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621683271818"><a href="#local-6989586621683271818"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="HsPat.html#patNeedsParens"><span class="hs-identifier hs-var">patNeedsParens</span></a><span> </span><a href="BasicTypes.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a><span> </span><a href="#local-6989586621683271818"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271817"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a href="HsExtension.html#noExt"><span class="hs-identifier hs-var">noExt</span></a><span> </span><a href="#local-6989586621683271816"><span class="hs-identifier hs-var">lp</span></a><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271816"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Collecting binders
*                                                                      *
************************************************************************

Get all the binders in some HsBindGroups, IN THE ORDER OF APPEARANCE. eg.

...
where
  (x, y) = ...
  f i j  = ...
  [a, b] = ...

it should return [x, y, f, a, b] (remember, order important).

Note [Collect binders only after renaming]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
These functions should only be used on HsSyn *after* the renamer,
to return a [Name] or [Id].  Before renaming the record punning
and wild-card mechanism makes it hard to know what is bound.
So these functions should not be applied to (HsSyn RdrName)

Note [Unlifted id check in isUnliftedHsBind]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The function isUnliftedHsBind is used to complain if we make a top-level
binding for a variable of unlifted type.

Such a binding is illegal if the top-level binding would be unlifted;
but also if the local letrec generated by desugaring AbsBinds would be.
E.g.
      f :: Num a =&gt; (# a, a #)
      g :: Num a =&gt; a -&gt; a
      f = ...g...
      g = ...g...

The top-level bindings for f,g are not unlifted (because of the Num a =&gt;),
but the local, recursive, monomorphic bindings are:

      t = /\a \(d:Num a).
         letrec fm :: (# a, a #) = ...g...
                gm :: a -&gt; a = ...f...
         in (fm, gm)

Here the binding for 'fm' is illegal.  So generally we check the abe_mono types.

BUT we have a special case when abs_sig is true;
  see HsBinds Note [The abs_sig field of AbsBinds]
-}</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-comment">----------------- Bindings --------------------------</span><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span class="hs-comment">-- | Should we treat this as an unlifted bind? This will be true for any</span><span>
</span><a name="line-922"></a><span class="hs-comment">-- bind that binds an unlifted variable, but we must be careful around</span><span>
</span><a name="line-923"></a><span class="hs-comment">-- AbsBinds. See Note [Unlifted id check in isUnliftedHsBind]. For usage</span><span>
</span><a name="line-924"></a><span class="hs-comment">-- information, see Note [Strict binds check] is DsBinds.</span><span>
</span><a name="line-925"></a><span class="hs-identifier">isUnliftedHsBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- works only over typechecked binds</span><span>
</span><a name="line-926"></a><a name="isUnliftedHsBind"><a href="HsUtils.html#isUnliftedHsBind"><span class="hs-identifier">isUnliftedHsBind</span></a></a><span> </span><a name="local-6989586621683271819"><a href="#local-6989586621683271819"><span class="hs-identifier">bind</span></a></a><span>
</span><a name="line-927"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271822"><a href="#local-6989586621683271822"><span class="hs-identifier">exports</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">abs_sig</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271823"><a href="#local-6989586621683271823"><span class="hs-identifier">has_sig</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271819"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-928"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683271823"><span class="hs-identifier hs-var">has_sig</span></a><span>
</span><a name="line-929"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271820"><span class="hs-identifier hs-var">is_unlifted_id</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">abe_poly</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271822"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-930"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271820"><span class="hs-identifier hs-var">is_unlifted_id</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">abe_mono</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271822"><span class="hs-identifier hs-var">exports</span></a><span>
</span><a name="line-931"></a><span>    </span><span class="hs-comment">-- If has_sig is True we wil never generate a binding for abe_mono,</span><span>
</span><a name="line-932"></a><span>    </span><span class="hs-comment">-- so we don't need to worry about it being unlifted. The abe_poly</span><span>
</span><a name="line-933"></a><span>    </span><span class="hs-comment">-- binding might not be: e.g. forall a. Num a =&gt; (# a, a #)</span><span>
</span><a name="line-934"></a><span>
</span><a name="line-935"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-936"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="#local-6989586621683271820"><span class="hs-identifier hs-var">is_unlifted_id</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier hs-var">collectHsBindBinders</span></a><span> </span><a href="#local-6989586621683271819"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-937"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-938"></a><span>    </span><a name="local-6989586621683271820"><a href="#local-6989586621683271820"><span class="hs-identifier">is_unlifted_id</span></a></a><span> </span><a name="local-6989586621683271821"><a href="#local-6989586621683271821"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621683271821"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>
</span><a name="line-940"></a><span class="hs-comment">-- | Is a binding a strict variable or pattern bind (e.g. @!x = ...@)?</span><span>
</span><a name="line-941"></a><span class="hs-identifier">isBangedHsBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-942"></a><a name="isBangedHsBind"><a href="HsUtils.html#isBangedHsBind"><span class="hs-identifier">isBangedHsBind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_binds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271824"><a href="#local-6989586621683271824"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#anyBag"><span class="hs-identifier hs-var">anyBag</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#isBangedHsBind"><span class="hs-identifier hs-var">isBangedHsBind</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271824"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-944"></a><span class="hs-identifier">isBangedHsBind</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271825"><a href="#local-6989586621683271825"><span class="hs-identifier">matches</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271826"><a href="#local-6989586621683271826"><span class="hs-identifier">match</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><a href="#local-6989586621683271825"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-946"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span class="hs-special">{</span><span class="hs-identifier">mc_strictness</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataCon.html#SrcStrict"><span class="hs-identifier hs-var">SrcStrict</span></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><a href="#local-6989586621683271826"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-947"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-948"></a><span class="hs-identifier">isBangedHsBind</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271827"><a href="#local-6989586621683271827"><span class="hs-identifier">pat</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsPat.html#isBangedLPat"><span class="hs-identifier hs-var">isBangedLPat</span></a><span> </span><a href="#local-6989586621683271827"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-950"></a><span class="hs-identifier">isBangedHsBind</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-951"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-952"></a><span>
</span><a name="line-953"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsLocalBindsLR"><span class="hs-identifier hs-type">HsLocalBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271467"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271468"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271467"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-955"></a><a name="collectLocalBinders"><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier">collectLocalBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271828"><a href="#local-6989586621683271828"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier hs-var">collectHsIdBinders</span></a><span> </span><a href="#local-6989586621683271828"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-956"></a><span>                                         </span><span class="hs-comment">-- No pattern synonyms here</span><span>
</span><a name="line-957"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-958"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-959"></a><span class="hs-identifier">collectLocalBinders</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XHsLocalBindsLR"><span class="hs-identifier hs-var">XHsLocalBindsLR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-960"></a><span>
</span><a name="line-961"></a><span class="hs-identifier">collectHsIdBinders</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">collectHsValBinders</span><span>
</span><a name="line-962"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271465"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271466"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271465"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-963"></a><span class="hs-comment">-- Collect Id binders only, or Ids + pattern synonyms, respectively</span><span>
</span><a name="line-964"></a><a name="collectHsIdBinders"><a href="HsUtils.html#collectHsIdBinders"><span class="hs-identifier">collectHsIdBinders</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier hs-var">collect_hs_val_binders</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-965"></a><a name="collectHsValBinders"><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier">collectHsValBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier hs-var">collect_hs_val_binders</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-identifier">collectHsBindBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271463"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621683271463"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#HasSrcSpan"><span class="hs-identifier hs-type">HasSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271463"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-968"></a><span>                        </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621683271463"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621683271464"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271463"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-969"></a><span class="hs-comment">-- Collect both Ids and pattern-synonym binders</span><span>
</span><a name="line-970"></a><a name="collectHsBindBinders"><a href="HsUtils.html#collectHsBindBinders"><span class="hs-identifier">collectHsBindBinders</span></a></a><span> </span><a name="local-6989586621683271829"><a href="#local-6989586621683271829"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683271829"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-identifier">collectHsBindsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271461"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271462"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271461"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-973"></a><a name="collectHsBindsBinders"><a href="HsUtils.html#collectHsBindsBinders"><span class="hs-identifier">collectHsBindsBinders</span></a></a><span> </span><a name="local-6989586621683271830"><a href="#local-6989586621683271830"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621683271830"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-974"></a><span>
</span><a name="line-975"></a><span class="hs-identifier">collectHsBindListBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#LHsBindLR"><span class="hs-identifier hs-type">LHsBindLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271459"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271460"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271459"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- Same as collectHsBindsBinders, but works over a list of bindings</span><span>
</span><a name="line-977"></a><a name="collectHsBindListBinders"><a href="HsUtils.html#collectHsBindListBinders"><span class="hs-identifier">collectHsBindListBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-identifier">collect_hs_val_binders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271457"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271458"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271457"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-981"></a><a name="collect_hs_val_binders"><a href="HsUtils.html#collect_hs_val_binders"><span class="hs-identifier">collect_hs_val_binders</span></a></a><span> </span><a name="local-6989586621683271831"><a href="#local-6989586621683271831"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271832"><a href="#local-6989586621683271832"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span> </span><a href="#local-6989586621683271831"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621683271832"><span class="hs-identifier hs-var">binds</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-982"></a><span class="hs-identifier">collect_hs_val_binders</span><span> </span><a name="local-6989586621683271833"><a href="#local-6989586621683271833"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XValBindsLR"><span class="hs-identifier hs-var">XValBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#NValBinds"><span class="hs-identifier hs-var">NValBinds</span></a><span> </span><a name="local-6989586621683271834"><a href="#local-6989586621683271834"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-983"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_out_binds"><span class="hs-identifier hs-var">collect_out_binds</span></a><span> </span><a href="#local-6989586621683271833"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621683271834"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-984"></a><span>
</span><a name="line-985"></a><span class="hs-identifier">collect_out_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271456"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-986"></a><span>                     </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271456"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-987"></a><a name="collect_out_binds"><a href="HsUtils.html#collect_out_binds"><span class="hs-identifier">collect_out_binds</span></a></a><span> </span><a name="local-6989586621683271835"><a href="#local-6989586621683271835"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_binds"><span class="hs-identifier hs-var">collect_binds</span></a><span> </span><a href="#local-6989586621683271835"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-988"></a><span>
</span><a name="line-989"></a><span class="hs-identifier">collect_binds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271454"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271455"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-990"></a><span>                 </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271454"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271454"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-991"></a><span class="hs-comment">-- Collect Ids, or Ids + pattern synonyms, depending on boolean flag</span><span>
</span><a name="line-992"></a><a name="collect_binds"><a href="HsUtils.html#collect_binds"><span class="hs-identifier">collect_binds</span></a></a><span> </span><a name="local-6989586621683271836"><a href="#local-6989586621683271836"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621683271837"><a href="#local-6989586621683271837"><span class="hs-identifier">binds</span></a></a><span> </span><a name="local-6989586621683271838"><a href="#local-6989586621683271838"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collect_bind"><span class="hs-identifier hs-var">collect_bind</span></a><span> </span><a href="#local-6989586621683271836"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271838"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621683271837"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-993"></a><span>
</span><a name="line-994"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#HasSrcSpan"><span class="hs-identifier hs-type">HasSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-995"></a><span>                </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsBindLR"><span class="hs-identifier hs-type">HsBindLR</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621683271453"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271452"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-996"></a><a name="collect_bind"><a href="HsUtils.html#collect_bind"><span class="hs-identifier">collect_bind</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271839"><a href="#local-6989586621683271839"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><a name="local-6989586621683271840"><a href="#local-6989586621683271840"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271839"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621683271840"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-997"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271841"><a href="#local-6989586621683271841"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621683271842"><a href="#local-6989586621683271842"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271841"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271842"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-998"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#VarBind"><span class="hs-identifier hs-var">VarBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">var_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271843"><a href="#local-6989586621683271843"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><a name="local-6989586621683271844"><a href="#local-6989586621683271844"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271843"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271844"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-999"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#AbsBinds"><span class="hs-identifier hs-var">AbsBinds</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">abs_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271845"><a href="#local-6989586621683271845"><span class="hs-identifier">dbinds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271846"><a href="#local-6989586621683271846"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">abe_poly</span><span> </span><a href="#local-6989586621683271845"><span class="hs-identifier hs-var">dbinds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271846"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1000"></a><span>        </span><span class="hs-comment">-- I don't think we want the binders from the abe_binds</span><span>
</span><a name="line-1001"></a><span>
</span><a name="line-1002"></a><span>        </span><span class="hs-comment">-- binding (hence see AbsBinds) is in zonking in TcHsSyn</span><span>
</span><a name="line-1003"></a><span class="hs-identifier">collect_bind</span><span> </span><a name="local-6989586621683271847"><a href="#local-6989586621683271847"><span class="hs-identifier">omitPatSyn</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271848"><a href="#local-6989586621683271848"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271849"><a href="#local-6989586621683271849"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1004"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621683271847"><span class="hs-identifier hs-var">omitPatSyn</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271849"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1005"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271848"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271849"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1006"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XPatSynBind"><span class="hs-identifier hs-var">XPatSynBind</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271850"><a href="#local-6989586621683271850"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271850"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1007"></a><span class="hs-identifier">collect_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XHsBindsLR"><span class="hs-identifier hs-var">XHsBindsLR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271851"><a href="#local-6989586621683271851"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271851"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-identifier">collectMethodBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="#local-6989586621683271450"><span class="hs-identifier hs-type">idL</span></a><span> </span><a href="#local-6989586621683271451"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271450"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1010"></a><span class="hs-comment">-- Used exclusively for the bindings of an instance decl which are all FunBinds</span><span>
</span><a name="line-1011"></a><a name="collectMethodBinders"><a href="HsUtils.html#collectMethodBinders"><span class="hs-identifier">collectMethodBinders</span></a></a><span> </span><a name="local-6989586621683271852"><a href="#local-6989586621683271852"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271853"><span class="hs-identifier hs-var">get</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683271852"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1012"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1013"></a><span>    </span><a name="local-6989586621683271853"><a href="#local-6989586621683271853"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271854"><a href="#local-6989586621683271854"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621683271855"><a href="#local-6989586621683271855"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271854"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271855"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1014"></a><span>    </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">_</span><span>                        </span><a name="local-6989586621683271856"><a href="#local-6989586621683271856"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271856"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1015"></a><span>       </span><span class="hs-comment">-- Someone else complains about non-FunBinds</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span class="hs-comment">----------------- Statements --------------------------</span><span>
</span><a name="line-1018"></a><span class="hs-identifier">collectLStmtsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271447"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271448"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271449"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">]</span><span>
</span><a name="line-1019"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271447"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1020"></a><a name="collectLStmtsBinders"><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier">collectLStmtsBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier hs-var">collectLStmtBinders</span></a><span>
</span><a name="line-1021"></a><span>
</span><a name="line-1022"></a><span class="hs-identifier">collectStmtsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271444"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271445"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271446"><span class="hs-identifier hs-type">body</span></a><span class="hs-special">]</span><span>
</span><a name="line-1023"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271444"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1024"></a><a name="collectStmtsBinders"><a href="HsUtils.html#collectStmtsBinders"><span class="hs-identifier">collectStmtsBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span>
</span><a name="line-1025"></a><span>
</span><a name="line-1026"></a><span class="hs-identifier">collectLStmtBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271441"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271442"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271443"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-1027"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271441"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1028"></a><a name="collectLStmtBinders"><a href="HsUtils.html#collectLStmtBinders"><span class="hs-identifier">collectLStmtBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier hs-var">collectStmtBinders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-1029"></a><span>
</span><a name="line-1030"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271438"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271439"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271440"><span class="hs-identifier hs-type">body</span></a><span>
</span><a name="line-1031"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271438"><span class="hs-identifier hs-type">idL</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1032"></a><span>  </span><span class="hs-comment">-- Id Binders for a Stmt... [but what about pattern-sig type vars]?</span><span>
</span><a name="line-1033"></a><a name="collectStmtBinders"><a href="HsUtils.html#collectStmtBinders"><span class="hs-identifier">collectStmtBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271857"><a href="#local-6989586621683271857"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span> </span><a href="#local-6989586621683271857"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1034"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621683271858"><a href="#local-6989586621683271858"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLocalBinders"><span class="hs-identifier hs-var">collectLocalBinders</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271858"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1035"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1036"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1037"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271859"><a href="#local-6989586621683271859"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span>
</span><a name="line-1038"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271861"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271860"><a href="#local-6989586621683271860"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271859"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271861"><a href="#local-6989586621683271861"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271860"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-1039"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271862"><a href="#local-6989586621683271862"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span> </span><a href="#local-6989586621683271862"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1040"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271863"><a href="#local-6989586621683271863"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectLStmtsBinders"><span class="hs-identifier hs-var">collectLStmtsBinders</span></a><span> </span><a href="#local-6989586621683271863"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1041"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271864"><a href="#local-6989586621683271864"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621683271865"><span class="hs-identifier hs-var">collectArgBinders</span></a><span> </span><a href="#local-6989586621683271864"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1042"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1043"></a><span>  </span><a name="local-6989586621683271865"><a href="#local-6989586621683271865"><span class="hs-identifier">collectArgBinders</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271866"><a href="#local-6989586621683271866"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span> </span><a href="#local-6989586621683271866"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1044"></a><span>  </span><span class="hs-identifier">collectArgBinders</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271867"><a href="#local-6989586621683271867"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier hs-var">collectPatBinders</span></a><span> </span><a href="#local-6989586621683271867"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1045"></a><span>  </span><span class="hs-identifier">collectArgBinders</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1046"></a><span class="hs-identifier">collectStmtBinders</span><span> </span><a href="HsExpr.html#XStmtLR"><span class="hs-identifier hs-var">XStmtLR</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;collectStmtBinders&quot;</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span>
</span><a name="line-1049"></a><span class="hs-comment">----------------- Patterns --------------------------</span><span>
</span><a name="line-1050"></a><span class="hs-identifier">collectPatBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271437"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271437"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1051"></a><a name="collectPatBinders"><a href="HsUtils.html#collectPatBinders"><span class="hs-identifier">collectPatBinders</span></a></a><span> </span><a name="local-6989586621683271868"><a href="#local-6989586621683271868"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271868"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span class="hs-identifier">collectPatsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271436"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271436"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1054"></a><a name="collectPatsBinders"><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier">collectPatsBinders</span></a></a><span> </span><a name="local-6989586621683271869"><a href="#local-6989586621683271869"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621683271869"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-1057"></a><span class="hs-identifier">collect_lpat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanLess</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#HasSrcSpan"><span class="hs-identifier hs-type">HasSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-1058"></a><span>                 </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271435"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-1059"></a><a name="collect_lpat"><a href="HsUtils.html#collect_lpat"><span class="hs-identifier">collect_lpat</span></a></a><span> </span><a name="local-6989586621683271870"><a href="#local-6989586621683271870"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621683271871"><a href="#local-6989586621683271871"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1060"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271872"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271870"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1062"></a><span>    </span><a name="local-6989586621683271872"><a href="#local-6989586621683271872"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271873"><a href="#local-6989586621683271873"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271873"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1063"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1064"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271874"><a href="#local-6989586621683271874"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271874"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1065"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271875"><a href="#local-6989586621683271875"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271875"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1066"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271876"><a href="#local-6989586621683271876"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621683271877"><a href="#local-6989586621683271877"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271876"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271877"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1067"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271878"><a href="#local-6989586621683271878"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271878"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1068"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271879"><a href="#local-6989586621683271879"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271879"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271880"><a href="#local-6989586621683271880"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621683271880"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1071"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271881"><a href="#local-6989586621683271881"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621683271881"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271882"><a href="#local-6989586621683271882"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271882"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271883"><a href="#local-6989586621683271883"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsConPatArgs"><span class="hs-identifier hs-var">hsConPatArgs</span></a><span> </span><a href="#local-6989586621683271883"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1075"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_args</span><span class="hs-glyph">=</span><a name="local-6989586621683271884"><a href="#local-6989586621683271884"><span class="hs-identifier">ps</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsConPatArgs"><span class="hs-identifier hs-var">hsConPatArgs</span></a><span> </span><a href="#local-6989586621683271884"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>        </span><span class="hs-comment">-- See Note [Dictionary binders in ConPatOut]</span><span>
</span><a name="line-1077"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1078"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1079"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271885"><a href="#local-6989586621683271885"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271885"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPat"><span class="hs-identifier hs-var">SigPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271886"><a href="#local-6989586621683271886"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#collect_lpat"><span class="hs-identifier hs-var">collect_lpat</span></a><span> </span><a href="#local-6989586621683271886"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1082"></a><span>
</span><a name="line-1083"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliced"><span class="hs-identifier hs-var">HsSpliced</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSplicedPat"><span class="hs-identifier hs-var">HsSplicedPat</span></a><span> </span><a name="local-6989586621683271887"><a href="#local-6989586621683271887"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1084"></a><span>                                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271872"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271887"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1085"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1086"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271888"><a href="#local-6989586621683271888"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271872"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271888"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1087"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#XPat"><span class="hs-identifier hs-var">XPat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271871"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1088"></a><span>
</span><a name="line-1089"></a><span class="hs-comment">{-
Note [Dictionary binders in ConPatOut] See also same Note in DsArrows
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Do *not* gather (a) dictionary and (b) dictionary bindings as binders
of a ConPatOut pattern.  For most calls it doesn't matter, because
it's pre-typechecker and there are no ConPatOuts.  But it does matter
more in the desugarer; for example, DsUtils.mkSelectorBinds uses
collectPatBinders.  In a lazy pattern, for example f ~(C x y) = ...,
we want to generate bindings for x,y but not for dictionaries bound by
C.  (The type checker ensures they would not be used.)

Desugaring of arrow case expressions needs these bindings (see DsArrows
and arrowcase1), but SPJ (Jan 2007) says it's safer for it to use its
own pat-binder-collector:

Here's the problem.  Consider

data T a where
   C :: Num a =&gt; a -&gt; Int -&gt; T a

f ~(C (n+1) m) = (n,m)

Here, the pattern (C (n+1)) binds a hidden dictionary (d::Num a),
and *also* uses that dictionary to match the (n+1) pattern.  Yet, the
variables bound by the lazy pattern are n,m, *not* the dictionary d.
So in mkSelectorBinds in DsUtils, we want just m,n as the variables bound.
-}</span><span>
</span><a name="line-1116"></a><span>
</span><a name="line-1117"></a><span class="hs-identifier">hsGroupBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1118"></a><a name="hsGroupBinders"><a href="HsUtils.html#hsGroupBinders"><span class="hs-identifier">hsGroupBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsGroup"><span class="hs-identifier hs-var">HsGroup</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hs_valds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271889"><a href="#local-6989586621683271889"><span class="hs-identifier">val_decls</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hs_tyclds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271890"><a href="#local-6989586621683271890"><span class="hs-identifier">tycl_decls</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-1119"></a><span>                          </span><span class="hs-identifier">hs_fords</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271891"><a href="#local-6989586621683271891"><span class="hs-identifier">foreign_decls</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="HsUtils.html#collectHsValBinders"><span class="hs-identifier hs-var">collectHsValBinders</span></a><span> </span><a href="#local-6989586621683271889"><span class="hs-identifier hs-var">val_decls</span></a><span>
</span><a name="line-1121"></a><span>  </span><span class="hs-operator hs-var">++</span><span> </span><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier hs-var">hsTyClForeignBinders</span></a><span> </span><a href="#local-6989586621683271890"><span class="hs-identifier hs-var">tycl_decls</span></a><span> </span><a href="#local-6989586621683271891"><span class="hs-identifier hs-var">foreign_decls</span></a><span>
</span><a name="line-1122"></a><span class="hs-identifier">hsGroupBinders</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XHsGroup"><span class="hs-identifier hs-var">XHsGroup</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsGroupBinders&quot;</span><span>
</span><a name="line-1123"></a><span>
</span><a name="line-1124"></a><span class="hs-identifier">hsTyClForeignBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span>
</span><a name="line-1125"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span>
</span><a name="line-1126"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1127"></a><span class="hs-comment">-- We need to look at instance declarations too,</span><span>
</span><a name="line-1128"></a><span class="hs-comment">-- because their associated types may bind data constructors</span><span>
</span><a name="line-1129"></a><a name="hsTyClForeignBinders"><a href="HsUtils.html#hsTyClForeignBinders"><span class="hs-identifier">hsTyClForeignBinders</span></a></a><span> </span><a name="local-6989586621683271892"><a href="#local-6989586621683271892"><span class="hs-identifier">tycl_decls</span></a></a><span> </span><a name="local-6989586621683271893"><a href="#local-6989586621683271893"><span class="hs-identifier">foreign_decls</span></a></a><span>
</span><a name="line-1130"></a><span>  </span><span class="hs-glyph">=</span><span>    </span><span class="hs-identifier hs-var">map</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier hs-var">hsForeignDeclsBinders</span></a><span> </span><a href="#local-6989586621683271893"><span class="hs-identifier hs-var">foreign_decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1131"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271894"><span class="hs-identifier hs-var">getSelectorNames</span></a><span>
</span><a name="line-1132"></a><span>         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldMap</span><span> </span><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier hs-var">hsLTyClDeclBinders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">group_tyclds</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271892"><span class="hs-identifier hs-var">tycl_decls</span></a><span>
</span><a name="line-1133"></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span>
</span><a name="line-1134"></a><span>         </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldMap</span><span> </span><a href="HsUtils.html#hsLInstDeclBinders"><span class="hs-identifier hs-var">hsLInstDeclBinders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">group_instds</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271892"><span class="hs-identifier hs-var">tycl_decls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1136"></a><span>    </span><span class="hs-identifier">getSelectorNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1137"></a><span>    </span><a name="local-6989586621683271894"><a href="#local-6989586621683271894"><span class="hs-identifier">getSelectorNames</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683271895"><a href="#local-6989586621683271895"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271896"><a href="#local-6989586621683271896"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271895"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">extFieldOcc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271896"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1138"></a><span>
</span><a name="line-1139"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1140"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyClDecl"><span class="hs-identifier hs-type">TyClDecl</span></a><span> </span><a href="#local-6989586621683271434"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span>
</span><a name="line-1141"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271434"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271434"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1142"></a><span class="hs-comment">-- ^ Returns all the /binding/ names of the decl.  The first one is</span><span>
</span><a name="line-1143"></a><span class="hs-comment">-- guaranteed to be the name of the decl. The first component</span><span>
</span><a name="line-1144"></a><span class="hs-comment">-- represents all binding names except record fields; the second</span><span>
</span><a name="line-1145"></a><span class="hs-comment">-- represents field occurrences. For record fields mentioned in</span><span>
</span><a name="line-1146"></a><span class="hs-comment">-- multiple constructors, the SrcLoc will be from the first occurrence.</span><span>
</span><a name="line-1147"></a><span class="hs-comment">--</span><span>
</span><a name="line-1148"></a><span class="hs-comment">-- Each returned (Located name) has a SrcSpan for the /whole/ declaration.</span><span>
</span><a name="line-1149"></a><span class="hs-comment">-- See Note [SrcSpan for binders]</span><span>
</span><a name="line-1150"></a><span>
</span><a name="line-1151"></a><a name="hsLTyClDeclBinders"><a href="HsUtils.html#hsLTyClDeclBinders"><span class="hs-identifier">hsLTyClDeclBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271897"><a href="#local-6989586621683271897"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamDecl"><span class="hs-identifier hs-var">FamDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#FamilyDecl"><span class="hs-identifier hs-var">FamilyDecl</span></a><span>
</span><a name="line-1152"></a><span>                                            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271898"><a href="#local-6989586621683271898"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1153"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271897"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271898"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1154"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamDecl"><span class="hs-identifier hs-var">FamDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdFam</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#XFamilyDecl"><span class="hs-identifier hs-var">XFamilyDecl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1155"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLTyClDeclBinders&quot;</span><span>
</span><a name="line-1156"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271899"><a href="#local-6989586621683271899"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#SynDecl"><span class="hs-identifier hs-var">SynDecl</span></a><span>
</span><a name="line-1157"></a><span>                               </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271900"><a href="#local-6989586621683271900"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1158"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271899"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271900"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1159"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271901"><a href="#local-6989586621683271901"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClassDecl"><span class="hs-identifier hs-var">ClassDecl</span></a><span>
</span><a name="line-1160"></a><span>                               </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271902"><a href="#local-6989586621683271902"><span class="hs-identifier">cls_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdSigs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271903"><a href="#local-6989586621683271903"><span class="hs-identifier">sigs</span></a></a><span>
</span><a name="line-1162"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdATs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271904"><a href="#local-6989586621683271904"><span class="hs-identifier">ats</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1163"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271901"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271902"><span class="hs-identifier hs-var">cls_name</span></a><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-1164"></a><span>     </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271905"><span class="hs-identifier hs-var">fam_loc</span></a><span> </span><a href="#local-6989586621683271906"><span class="hs-identifier hs-var">fam_name</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271905"><a href="#local-6989586621683271905"><span class="hs-identifier">fam_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#FamilyDecl"><span class="hs-identifier hs-var">FamilyDecl</span></a><span>
</span><a name="line-1165"></a><span>                                        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271906"><a href="#local-6989586621683271906"><span class="hs-identifier">fam_name</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271904"><span class="hs-identifier hs-var">ats</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1166"></a><span>     </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-1167"></a><span>     </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271907"><span class="hs-identifier hs-var">mem_loc</span></a><span> </span><a href="#local-6989586621683271909"><span class="hs-identifier hs-var">mem_name</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271907"><a href="#local-6989586621683271907"><span class="hs-identifier">mem_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ClassOpSig"><span class="hs-identifier hs-var">ClassOpSig</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621683271908"><a href="#local-6989586621683271908"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271903"><span class="hs-identifier hs-var">sigs</span></a><span>
</span><a name="line-1168"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271909"><a href="#local-6989586621683271909"><span class="hs-identifier">mem_name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271908"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1169"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1170"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271910"><a href="#local-6989586621683271910"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataDecl"><span class="hs-identifier hs-var">DataDecl</span></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271911"><a href="#local-6989586621683271911"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1171"></a><span>                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcdDataDefn</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271912"><a href="#local-6989586621683271912"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683271913"><a href="#local-6989586621683271913"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271914"><a href="#local-6989586621683271914"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271910"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621683271911"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621683271913"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271914"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier hs-var">hsDataDefnBinders</span></a><span> </span><a href="#local-6989586621683271912"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1173"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XTyClDecl"><span class="hs-identifier hs-var">XTyClDecl</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLTyClDeclBinders&quot;</span><span>
</span><a name="line-1174"></a><span class="hs-identifier">hsLTyClDeclBinders</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLTyClDeclBinders: Impossible Match&quot;</span><span>
</span><a name="line-1175"></a><span>                             </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1176"></a><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1179"></a><span class="hs-identifier">hsForeignDeclsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LForeignDecl"><span class="hs-identifier hs-type">LForeignDecl</span></a><span> </span><a href="#local-6989586621683271433"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271433"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1180"></a><span class="hs-comment">-- See Note [SrcSpan for binders]</span><span>
</span><a name="line-1181"></a><a name="hsForeignDeclsBinders"><a href="HsUtils.html#hsForeignDeclsBinders"><span class="hs-identifier">hsForeignDeclsBinders</span></a></a><span> </span><a name="local-6989586621683271915"><a href="#local-6989586621683271915"><span class="hs-identifier">foreign_decls</span></a></a><span>
</span><a name="line-1182"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271916"><span class="hs-identifier hs-var">decl_loc</span></a><span> </span><a href="#local-6989586621683271917"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1183"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621683271916"><a href="#local-6989586621683271916"><span class="hs-identifier">decl_loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fd_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271917"><a href="#local-6989586621683271917"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1184"></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271915"><span class="hs-identifier hs-var">foreign_decls</span></a><span class="hs-special">]</span><span>
</span><a name="line-1185"></a><span>
</span><a name="line-1186"></a><span>
</span><a name="line-1187"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1188"></a><span class="hs-identifier">hsPatSynSelectors</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271432"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271432"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1189"></a><span class="hs-comment">-- Collects record pattern-synonym selectors only; the pattern synonym</span><span>
</span><a name="line-1190"></a><span class="hs-comment">-- names are collected by collectHsValBinders.</span><span>
</span><a name="line-1191"></a><a name="hsPatSynSelectors"><a href="HsUtils.html#hsPatSynSelectors"><span class="hs-identifier">hsPatSynSelectors</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsPatSynSelectors&quot;</span><span>
</span><a name="line-1192"></a><span class="hs-identifier">hsPatSynSelectors</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XValBindsLR"><span class="hs-identifier hs-var">XValBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#NValBinds"><span class="hs-identifier hs-var">NValBinds</span></a><span> </span><a name="local-6989586621683271918"><a href="#local-6989586621683271918"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1193"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldrBag"><span class="hs-identifier hs-var">foldrBag</span></a><span> </span><a href="HsUtils.html#addPatSynSelector"><span class="hs-identifier hs-var">addPatSynSelector</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Bag.html#unionManyBags"><span class="hs-identifier hs-var">unionManyBags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621683271918"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1194"></a><span>
</span><a name="line-1195"></a><span class="hs-identifier">addPatSynSelector</span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a><span> </span><a href="#local-6989586621683271431"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271431"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271431"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-1196"></a><a name="addPatSynSelector"><a href="HsUtils.html#addPatSynSelector"><span class="hs-identifier">addPatSynSelector</span></a></a><span> </span><a name="local-6989586621683271919"><a href="#local-6989586621683271919"><span class="hs-identifier">bind</span></a></a><span> </span><a name="local-6989586621683271920"><a href="#local-6989586621683271920"><span class="hs-identifier">sels</span></a></a><span>
</span><a name="line-1197"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271919"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-1198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">recordPatSynSelectorId</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271920"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271920"><span class="hs-identifier hs-var">sels</span></a><span>
</span><a name="line-1200"></a><span>
</span><a name="line-1201"></a><span class="hs-identifier">getPatSynBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="BasicTypes.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="#local-6989586621683271430"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="#local-6989586621683271430"><span class="hs-identifier hs-type">id</span></a><span> </span><a href="#local-6989586621683271430"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-1202"></a><a name="getPatSynBinds"><a href="HsUtils.html#getPatSynBinds"><span class="hs-identifier">getPatSynBinds</span></a></a><span> </span><a name="local-6989586621683271922"><a href="#local-6989586621683271922"><span class="hs-identifier">binds</span></a></a><span>
</span><a name="line-1203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621683271924"><span class="hs-identifier hs-var">psb</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621683271923"><a href="#local-6989586621683271923"><span class="hs-identifier">lbinds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271922"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1204"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-var">PatSynBind</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271924"><a href="#local-6989586621683271924"><span class="hs-identifier">psb</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="#local-6989586621683271923"><span class="hs-identifier hs-var">lbinds</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1205"></a><span>
</span><a name="line-1206"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1207"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271429"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271429"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271429"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1209"></a><a name="hsLInstDeclBinders"><a href="HsUtils.html#hsLInstDeclBinders"><span class="hs-identifier">hsLInstDeclBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClsInstD"><span class="hs-identifier hs-var">ClsInstD</span></a><span>
</span><a name="line-1210"></a><span>                             </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#ClsInstDecl"><span class="hs-identifier hs-var">ClsInstDecl</span></a><span>
</span><a name="line-1211"></a><span>                                          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">cid_datafam_insts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271925"><a href="#local-6989586621683271925"><span class="hs-identifier">dfis</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271925"><span class="hs-identifier hs-var">dfis</span></a><span>
</span><a name="line-1213"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstD"><span class="hs-identifier hs-var">DataFamInstD</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_inst</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271926"><a href="#local-6989586621683271926"><span class="hs-identifier">fi</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1214"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a><span> </span><a href="#local-6989586621683271926"><span class="hs-identifier hs-var">fi</span></a><span>
</span><a name="line-1215"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#TyFamInstD"><span class="hs-identifier hs-var">TyFamInstD</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-1216"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ClsInstD"><span class="hs-identifier hs-var">ClsInstD</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XClsInstDecl"><span class="hs-identifier hs-var">XClsInstDecl</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1217"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLInstDeclBinders&quot;</span><span>
</span><a name="line-1218"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#dL"><span class="hs-identifier hs-var">dL</span></a><span class="hs-glyph">-&gt;</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XInstDecl"><span class="hs-identifier hs-var">XInstDecl</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1219"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLInstDeclBinders&quot;</span><span>
</span><a name="line-1220"></a><span class="hs-identifier">hsLInstDeclBinders</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsLInstDeclBinders: Impossible Match&quot;</span><span>
</span><a name="line-1221"></a><span>                             </span><span class="hs-comment">-- due to #15884</span><span>
</span><a name="line-1222"></a><span>
</span><a name="line-1223"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1224"></a><span class="hs-comment">-- the SrcLoc returned are for the whole declarations, not just the names</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">hsDataFamInstBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a><span> </span><a href="#local-6989586621683271428"><span class="hs-identifier hs-type">pass</span></a><span>
</span><a name="line-1226"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271428"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271428"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1227"></a><a name="hsDataFamInstBinders"><a href="HsUtils.html#hsDataFamInstBinders"><span class="hs-identifier">hsDataFamInstBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-var">DataFamInstDecl</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1228"></a><span>                       </span><a href="HsDecls.html#FamEqn"><span class="hs-identifier hs-var">FamEqn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">feqn_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271927"><a href="#local-6989586621683271927"><span class="hs-identifier">defn</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1229"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier hs-var">hsDataDefnBinders</span></a><span> </span><a href="#local-6989586621683271927"><span class="hs-identifier hs-var">defn</span></a><span>
</span><a name="line-1230"></a><span>  </span><span class="hs-comment">-- There can't be repeated symbols because only data instances have binders</span><span>
</span><a name="line-1231"></a><span class="hs-identifier">hsDataFamInstBinders</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-var">DataFamInstDecl</span></a><span>
</span><a name="line-1232"></a><span>                                    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dfid_eqn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsDecls.html#XFamEqn"><span class="hs-identifier hs-var">XFamEqn</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1233"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsDataFamInstBinders&quot;</span><span>
</span><a name="line-1234"></a><span class="hs-identifier">hsDataFamInstBinders</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#DataFamInstDecl"><span class="hs-identifier hs-var">DataFamInstDecl</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#XHsImplicitBndrs"><span class="hs-identifier hs-var">XHsImplicitBndrs</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsDataFamInstBinders&quot;</span><span>
</span><a name="line-1236"></a><span>
</span><a name="line-1237"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1238"></a><span class="hs-comment">-- the SrcLoc returned are for the whole declarations, not just the names</span><span>
</span><a name="line-1239"></a><span class="hs-identifier">hsDataDefnBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a><span> </span><a href="#local-6989586621683271427"><span class="hs-identifier hs-type">pass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271427"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271427"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1240"></a><a name="hsDataDefnBinders"><a href="HsUtils.html#hsDataDefnBinders"><span class="hs-identifier">hsDataDefnBinders</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-var">HsDataDefn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271928"><a href="#local-6989586621683271928"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1241"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsConDeclsBinders"><span class="hs-identifier hs-var">hsConDeclsBinders</span></a><span> </span><a href="#local-6989586621683271928"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1242"></a><span>  </span><span class="hs-comment">-- See Note [Binders in family instances]</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">hsDataDefnBinders</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#XHsDataDefn"><span class="hs-identifier hs-var">XHsDataDefn</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsDataDefnBinders&quot;</span><span>
</span><a name="line-1244"></a><span>
</span><a name="line-1245"></a><span class="hs-comment">-------------------</span><span>
</span><a name="line-1246"></a><span class="hs-keyword">type</span><span> </span><a name="Seen"><a href="HsUtils.html#Seen"><span class="hs-identifier">Seen</span></a></a><span> </span><a name="local-6989586621683271421"><a href="#local-6989586621683271421"><span class="hs-identifier">pass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271421"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271421"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span>
</span><a name="line-1247"></a><span>                 </span><span class="hs-comment">-- Filters out ones that have already been seen</span><span>
</span><a name="line-1248"></a><span>
</span><a name="line-1249"></a><span class="hs-identifier">hsConDeclsBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="#local-6989586621683271426"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271426"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271426"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><span>   </span><span class="hs-comment">-- See hsLTyClDeclBinders for what this does</span><span>
</span><a name="line-1251"></a><span>   </span><span class="hs-comment">-- The function is boringly complicated because of the records</span><span>
</span><a name="line-1252"></a><span>   </span><span class="hs-comment">-- And since we only have equality, we have to be a little careful</span><span>
</span><a name="line-1253"></a><a name="hsConDeclsBinders"><a href="HsUtils.html#hsConDeclsBinders"><span class="hs-identifier">hsConDeclsBinders</span></a></a><span> </span><a name="local-6989586621683271929"><a href="#local-6989586621683271929"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-1254"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271930"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621683271929"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1255"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1256"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsUtils.html#Seen"><span class="hs-identifier hs-type">Seen</span></a><span> </span><a href="#local-6989586621683271932"><span class="hs-identifier hs-type">pass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsDecls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a><span> </span><a href="#local-6989586621683271932"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span>
</span><a name="line-1257"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a><span> </span><a href="#local-6989586621683271932"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271932"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1258"></a><span>    </span><a name="local-6989586621683271930"><a href="#local-6989586621683271930"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1259"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621683271934"><a href="#local-6989586621683271934"><span class="hs-identifier">remSeen</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621683271935"><a href="#local-6989586621683271935"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621683271936"><a href="#local-6989586621683271936"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>      </span><span class="hs-comment">-- Don't re-mangle the location of field names, because we don't</span><span>
</span><a name="line-1261"></a><span>      </span><span class="hs-comment">-- have a record of the full location of the field declaration anyway</span><span>
</span><a name="line-1262"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683271937"><a href="#local-6989586621683271937"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621683271935"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1263"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271935"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1264"></a><span>           </span><span class="hs-comment">-- remove only the first occurrence of any seen field in order to</span><span>
</span><a name="line-1265"></a><span>           </span><span class="hs-comment">-- avoid circumventing detection of duplicate fields (#9156)</span><span>
</span><a name="line-1266"></a><span>           </span><a href="HsDecls.html#ConDeclGADT"><span class="hs-identifier hs-var">ConDeclGADT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_names</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271938"><a href="#local-6989586621683271938"><span class="hs-identifier">names</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271939"><a href="#local-6989586621683271939"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1267"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271937"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271938"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271942"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271941"><span class="hs-identifier hs-var">flds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271943"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1269"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621683271940"><a href="#local-6989586621683271940"><span class="hs-identifier">remSeen'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271941"><a href="#local-6989586621683271941"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271931"><span class="hs-identifier hs-var">get_flds</span></a><span> </span><a href="#local-6989586621683271934"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><a href="#local-6989586621683271939"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1270"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621683271942"><a href="#local-6989586621683271942"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271943"><a href="#local-6989586621683271943"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271930"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271940"><span class="hs-identifier hs-var">remSeen'</span></a><span> </span><a href="#local-6989586621683271936"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1271"></a><span>
</span><a name="line-1272"></a><span>           </span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271944"><a href="#local-6989586621683271944"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271945"><a href="#local-6989586621683271945"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1273"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="SrcLoc.html#cL"><span class="hs-identifier hs-var">cL</span></a><span> </span><a href="#local-6989586621683271937"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271944"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271948"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271947"><span class="hs-identifier hs-var">flds</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621683271949"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1274"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1275"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621683271946"><a href="#local-6989586621683271946"><span class="hs-identifier">remSeen'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271947"><a href="#local-6989586621683271947"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271931"><span class="hs-identifier hs-var">get_flds</span></a><span> </span><a href="#local-6989586621683271934"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><a href="#local-6989586621683271945"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1276"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621683271948"><a href="#local-6989586621683271948"><span class="hs-identifier">ns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683271949"><a href="#local-6989586621683271949"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271930"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621683271946"><span class="hs-identifier hs-var">remSeen'</span></a><span> </span><a href="#local-6989586621683271936"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1277"></a><span>
</span><a name="line-1278"></a><span>           </span><a href="HsDecls.html#XConDecl"><span class="hs-identifier hs-var">XConDecl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;hsConDeclsBinders&quot;</span><span>
</span><a name="line-1279"></a><span>
</span><a name="line-1280"></a><span>    </span><span class="hs-identifier">get_flds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsUtils.html#Seen"><span class="hs-identifier hs-type">Seen</span></a><span> </span><a href="#local-6989586621683271933"><span class="hs-identifier hs-type">pass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsDecls.html#HsConDeclDetails"><span class="hs-identifier hs-type">HsConDeclDetails</span></a><span> </span><a href="#local-6989586621683271933"><span class="hs-identifier hs-type">pass</span></a><span>
</span><a name="line-1281"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#Seen"><span class="hs-identifier hs-type">Seen</span></a><span> </span><a href="#local-6989586621683271933"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a><span> </span><a href="#local-6989586621683271933"><span class="hs-identifier hs-type">pass</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>    </span><a name="local-6989586621683271931"><a href="#local-6989586621683271931"><span class="hs-identifier">get_flds</span></a></a><span> </span><a name="local-6989586621683271950"><a href="#local-6989586621683271950"><span class="hs-identifier">remSeen</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-6989586621683271951"><a href="#local-6989586621683271951"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271953"><span class="hs-identifier hs-var">remSeen'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621683271952"><span class="hs-identifier hs-var">fld_names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1284"></a><span>       </span><span class="hs-keyword">where</span><span>
</span><a name="line-1285"></a><span>          </span><a name="local-6989586621683271952"><a href="#local-6989586621683271952"><span class="hs-identifier">fld_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271950"><span class="hs-identifier hs-var">remSeen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_names</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271951"><span class="hs-identifier hs-var">flds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1286"></a><span>          </span><a name="local-6989586621683271953"><a href="#local-6989586621683271953"><span class="hs-identifier">remSeen'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271950"><span class="hs-identifier hs-var">remSeen</span></a><span>
</span><a name="line-1287"></a><span>                               </span><span class="hs-special">[</span><span class="hs-identifier hs-var">deleteBy</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">rdrNameFieldOcc</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271954"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1288"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621683271954"><a href="#local-6989586621683271954"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271952"><span class="hs-identifier hs-var">fld_names</span></a><span class="hs-special">]</span><span>
</span><a name="line-1289"></a><span>    </span><span class="hs-identifier">get_flds</span><span> </span><a name="local-6989586621683271955"><a href="#local-6989586621683271955"><span class="hs-identifier">remSeen</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1290"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271955"><span class="hs-identifier hs-var">remSeen</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1291"></a><span>
</span><a name="line-1292"></a><span class="hs-comment">{-

Note [SrcSpan for binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~
When extracting the (Located RdrNme) for a binder, at least for the
main name (the TyCon of a type declaration etc), we want to give it
the @SrcSpan@ of the whole /declaration/, not just the name itself
(which is how it appears in the syntax tree).  This SrcSpan (for the
entire declaration) is used as the SrcSpan for the Name that is
finally produced, and hence for error messages.  (See Trac #8607.)

Note [Binders in family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a type or data family instance declaration, the type
constructor is an *occurrence* not a binding site
    type instance T Int = Int -&gt; Int   -- No binders
    data instance S Bool = S1 | S2     -- Binders are S1,S2


************************************************************************
*                                                                      *
        Collecting binders the user did not write
*                                                                      *
************************************************************************

The job of this family of functions is to run through binding sites and find the set of all Names
that were defined &quot;implicitly&quot;, without being explicitly written by the user.

The main purpose is to find names introduced by record wildcards so that we can avoid
warning the user when they don't use those names (#4404)
-}</span><span>
</span><a name="line-1323"></a><span>
</span><a name="line-1324"></a><span class="hs-identifier">lStmtsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271424"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271425"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271424"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1325"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1326"></a><a name="lStmtsImplicits"><a href="HsUtils.html#lStmtsImplicits"><span class="hs-identifier">lStmtsImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271956"><span class="hs-identifier hs-var">hs_lstmts</span></a><span>
</span><a name="line-1327"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1328"></a><span>    </span><span class="hs-identifier">hs_lstmts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LStmtLR"><span class="hs-identifier hs-type">LStmtLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271959"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271960"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271959"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1329"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1330"></a><span>    </span><a name="local-6989586621683271956"><a href="#local-6989586621683271956"><span class="hs-identifier">hs_lstmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683271963"><a href="#local-6989586621683271963"><span class="hs-identifier">stmt</span></a></a><span> </span><a name="local-6989586621683271964"><a href="#local-6989586621683271964"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271957"><span class="hs-identifier hs-var">hs_stmt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271963"><span class="hs-identifier hs-var">stmt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621683271964"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1331"></a><span>
</span><a name="line-1332"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#StmtLR"><span class="hs-identifier hs-type">StmtLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271961"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271962"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271961"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1333"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1334"></a><span>    </span><a name="local-6989586621683271957"><a href="#local-6989586621683271957"><span class="hs-identifier">hs_stmt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271965"><a href="#local-6989586621683271965"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621683271965"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1335"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271966"><a href="#local-6989586621683271966"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#unionNameSets"><span class="hs-identifier hs-var">unionNameSets</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621683271967"><span class="hs-identifier hs-var">do_arg</span></a><span> </span><a href="#local-6989586621683271966"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1336"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621683271967"><a href="#local-6989586621683271967"><span class="hs-identifier">do_arg</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgOne"><span class="hs-identifier hs-var">ApplicativeArgOne</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271968"><a href="#local-6989586621683271968"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621683271968"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1337"></a><span>            </span><span class="hs-identifier">do_arg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#ApplicativeArgMany"><span class="hs-identifier hs-var">ApplicativeArgMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271969"><a href="#local-6989586621683271969"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271956"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621683271969"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1338"></a><span>            </span><span class="hs-identifier">do_arg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#XApplicativeArg"><span class="hs-identifier hs-var">XApplicativeArg</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;lStmtsImplicits&quot;</span><span>
</span><a name="line-1339"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271970"><a href="#local-6989586621683271970"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271958"><span class="hs-identifier hs-var">hs_local_binds</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271970"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1340"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1341"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1342"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271971"><a href="#local-6989586621683271971"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271956"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621683271973"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="HsExpr.html#ParStmtBlock"><span class="hs-identifier hs-var">ParStmtBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271972"><a href="#local-6989586621683271972"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271971"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1343"></a><span>                                                </span><span class="hs-special">,</span><span> </span><a name="local-6989586621683271973"><a href="#local-6989586621683271973"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621683271972"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">]</span><span>
</span><a name="line-1344"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">trS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271974"><a href="#local-6989586621683271974"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271956"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621683271974"><span class="hs-identifier hs-var">stmts</span></a><span>
</span><a name="line-1345"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recS_stmts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271975"><a href="#local-6989586621683271975"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271956"><span class="hs-identifier hs-var">hs_lstmts</span></a><span> </span><a href="#local-6989586621683271975"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-1346"></a><span>    </span><span class="hs-identifier">hs_stmt</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#XStmtLR"><span class="hs-identifier hs-var">XStmtLR</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;lStmtsImplicits&quot;</span><span>
</span><a name="line-1347"></a><span>
</span><a name="line-1348"></a><span>    </span><a name="local-6989586621683271958"><a href="#local-6989586621683271958"><span class="hs-identifier">hs_local_binds</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsValBinds"><span class="hs-identifier hs-var">HsValBinds</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271976"><a href="#local-6989586621683271976"><span class="hs-identifier">val_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier hs-var">hsValBindsImplicits</span></a><span> </span><a href="#local-6989586621683271976"><span class="hs-identifier hs-var">val_binds</span></a><span>
</span><a name="line-1349"></a><span>    </span><span class="hs-identifier">hs_local_binds</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#HsIPBinds"><span class="hs-identifier hs-var">HsIPBinds</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1350"></a><span>    </span><span class="hs-identifier">hs_local_binds</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1351"></a><span>    </span><span class="hs-identifier">hs_local_binds</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XHsLocalBindsLR"><span class="hs-identifier hs-var">XHsLocalBindsLR</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1352"></a><span>
</span><a name="line-1353"></a><span class="hs-identifier">hsValBindsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsValBindsLR"><span class="hs-identifier hs-type">HsValBindsLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-special">(</span><a href="HsExtension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a><span> </span><a href="#local-6989586621683271423"><span class="hs-identifier hs-type">idR</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1354"></a><a name="hsValBindsImplicits"><a href="HsUtils.html#hsValBindsImplicits"><span class="hs-identifier">hsValBindsImplicits</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#XValBindsLR"><span class="hs-identifier hs-var">XValBindsLR</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#NValBinds"><span class="hs-identifier hs-var">NValBinds</span></a><span> </span><a name="local-6989586621683271977"><a href="#local-6989586621683271977"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1355"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier hs-var">lhsBindsImplicits</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span> </span><a href="#local-6989586621683271977"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1356"></a><span class="hs-identifier">hsValBindsImplicits</span><span> </span><span class="hs-special">(</span><a href="HsBinds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271978"><a href="#local-6989586621683271978"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1357"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier hs-var">lhsBindsImplicits</span></a><span> </span><a href="#local-6989586621683271978"><span class="hs-identifier hs-var">binds</span></a><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span class="hs-identifier">lhsBindsImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#LHsBindsLR"><span class="hs-identifier hs-type">LHsBindsLR</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><a href="#local-6989586621683271422"><span class="hs-identifier hs-type">idR</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1360"></a><a name="lhsBindsImplicits"><a href="HsUtils.html#lhsBindsImplicits"><span class="hs-identifier">lhsBindsImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#foldBag"><span class="hs-identifier hs-var">foldBag</span></a><span> </span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621683271979"><span class="hs-identifier hs-var">lhs_bind</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1361"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1362"></a><span>    </span><a name="local-6989586621683271979"><a href="#local-6989586621683271979"><span class="hs-identifier">lhs_bind</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#PatBind"><span class="hs-identifier hs-var">PatBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_lhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621683271980"><a href="#local-6989586621683271980"><span class="hs-identifier">lpat</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier hs-var">lPatImplicits</span></a><span> </span><a href="#local-6989586621683271980"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-1363"></a><span>    </span><span class="hs-identifier">lhs_bind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span class="hs-identifier">lPatImplicits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>
</span><a name="line-1366"></a><a name="lPatImplicits"><a href="HsUtils.html#lPatImplicits"><span class="hs-identifier">lPatImplicits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span>
</span><a name="line-1367"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1368"></a><span>    </span><a name="local-6989586621683271981"><a href="#local-6989586621683271981"><span class="hs-identifier">hs_lpat</span></a></a><span> </span><a name="local-6989586621683271985"><a href="#local-6989586621683271985"><span class="hs-identifier">lpat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271983"><span class="hs-identifier hs-var">hs_pat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683271985"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><span>    </span><a name="local-6989586621683271982"><a href="#local-6989586621683271982"><span class="hs-identifier">hs_lpats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621683271986"><a href="#local-6989586621683271986"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621683271987"><a href="#local-6989586621683271987"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271986"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683271987"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><span>    </span><a name="local-6989586621683271983"><a href="#local-6989586621683271983"><span class="hs-identifier">hs_pat</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271988"><a href="#local-6989586621683271988"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271988"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1373"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271989"><a href="#local-6989586621683271989"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271989"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1374"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271990"><a href="#local-6989586621683271990"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271990"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1375"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271991"><a href="#local-6989586621683271991"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271991"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1376"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271992"><a href="#local-6989586621683271992"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271992"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1377"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271993"><a href="#local-6989586621683271993"><span class="hs-identifier">pats</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271982"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621683271993"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1378"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271994"><a href="#local-6989586621683271994"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271982"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621683271994"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-1379"></a><span>
</span><a name="line-1380"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPat"><span class="hs-identifier hs-var">SigPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271995"><a href="#local-6989586621683271995"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683271995"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1381"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271996"><a href="#local-6989586621683271996"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271983"><span class="hs-identifier hs-var">hs_pat</span></a><span> </span><a href="#local-6989586621683271996"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1382"></a><span>
</span><a name="line-1383"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621683271997"><a href="#local-6989586621683271997"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271984"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621683271997"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1384"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pat_args</span><span class="hs-glyph">=</span><a name="local-6989586621683271998"><a href="#local-6989586621683271998"><span class="hs-identifier">ps</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271984"><span class="hs-identifier hs-var">details</span></a><span> </span><a href="#local-6989586621683271998"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span>    </span><span class="hs-identifier">hs_pat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-1387"></a><span>
</span><a name="line-1388"></a><span>    </span><a name="local-6989586621683271984"><a href="#local-6989586621683271984"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-6989586621683271999"><a href="#local-6989586621683271999"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271982"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621683271999"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1389"></a><span>    </span><span class="hs-identifier">details</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-6989586621683272000"><a href="#local-6989586621683272000"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271982"><span class="hs-identifier hs-var">hs_lpats</span></a><span> </span><a href="#local-6989586621683272001"><span class="hs-identifier hs-var">explicit</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#collectPatsBinders"><span class="hs-identifier hs-var">collectPatsBinders</span></a><span> </span><a href="#local-6989586621683272002"><span class="hs-identifier hs-var">implicit</span></a><span class="hs-special">)</span><span>
</span><a name="line-1390"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683272001"><a href="#local-6989586621683272001"><span class="hs-identifier">explicit</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683272002"><a href="#local-6989586621683272002"><span class="hs-identifier">implicit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partitionEithers</span><span> </span><span class="hs-special">[</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621683272006"><span class="hs-identifier hs-var">pat_explicit</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621683272005"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621683272005"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-1391"></a><span>                                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621683272003"><a href="#local-6989586621683272003"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621683272004"><a href="#local-6989586621683272004"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">zip</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><a href="#local-6989586621683272000"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-1392"></a><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621683272005"><a href="#local-6989586621683272005"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span>
</span><a name="line-1393"></a><span>                                                                     </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621683272004"><span class="hs-identifier hs-var">fld</span></a><span class="hs-special">)</span><span>
</span><a name="line-1394"></a><span>                                                          </span><a name="local-6989586621683272006"><a href="#local-6989586621683272006"><span class="hs-identifier">pat_explicit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621683272003"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&lt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rec_dotdot</span><span> </span><a href="#local-6989586621683272000"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1395"></a><span>    </span><span class="hs-identifier">details</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621683272007"><a href="#local-6989586621683272007"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621683272008"><a href="#local-6989586621683272008"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683272007"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#unionNameSet"><span class="hs-identifier hs-var">unionNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621683271981"><span class="hs-identifier hs-var">hs_lpat</span></a><span> </span><a href="#local-6989586621683272008"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1396"></a></pre></body></html>