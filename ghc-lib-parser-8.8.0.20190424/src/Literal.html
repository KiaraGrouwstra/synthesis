<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1998

\section[Literal]{@Literal@: literals}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable, ScopedTypeVariables #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Literal</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>        </span><span class="hs-comment">-- * Main data type</span><span>
</span><a name="line-13"></a><span>          </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- Exported to ParseIface</span><span>
</span><a name="line-14"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>        </span><span class="hs-comment">-- ** Creating Literals</span><span>
</span><a name="line-17"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitIntWrapC"><span class="hs-identifier hs-var">mkLitIntWrapC</span></a><span>
</span><a name="line-18"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitWordWrapC"><span class="hs-identifier hs-var">mkLitWordWrapC</span></a><span>
</span><a name="line-19"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitInt64"><span class="hs-identifier hs-var">mkLitInt64</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitInt64Wrap"><span class="hs-identifier hs-var">mkLitInt64Wrap</span></a><span>
</span><a name="line-20"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitWord64"><span class="hs-identifier hs-var">mkLitWord64</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitWord64Wrap"><span class="hs-identifier hs-var">mkLitWord64Wrap</span></a><span>
</span><a name="line-21"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitFloat"><span class="hs-identifier hs-var">mkLitFloat</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a><span>
</span><a name="line-22"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitChar"><span class="hs-identifier hs-var">mkLitChar</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitString"><span class="hs-identifier hs-var">mkLitString</span></a><span>
</span><a name="line-23"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitInteger"><span class="hs-identifier hs-var">mkLitInteger</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitNatural"><span class="hs-identifier hs-var">mkLitNatural</span></a><span>
</span><a name="line-24"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitNumber"><span class="hs-identifier hs-var">mkLitNumber</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- ** Operations on Literals</span><span>
</span><a name="line-27"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a><span>
</span><a name="line-28"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#absentLiteralOf"><span class="hs-identifier hs-var">absentLiteralOf</span></a><span>
</span><a name="line-29"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#pprLiteral"><span class="hs-identifier hs-var">pprLiteral</span></a><span>
</span><a name="line-30"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#litNumIsSigned"><span class="hs-identifier hs-var">litNumIsSigned</span></a><span>
</span><a name="line-31"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#litNumCheckRange"><span class="hs-identifier hs-var">litNumCheckRange</span></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>        </span><span class="hs-comment">-- ** Predicates on Literals and their contents</span><span>
</span><a name="line-34"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#litIsDupable"><span class="hs-identifier hs-var">litIsDupable</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#litIsTrivial"><span class="hs-identifier hs-var">litIsTrivial</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#litIsLifted"><span class="hs-identifier hs-var">litIsLifted</span></a><span>
</span><a name="line-35"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#inWordRange"><span class="hs-identifier hs-var">inWordRange</span></a><span class="hs-special">,</span><span> </span><a href="DynFlags.html#tARGET_MAX_INT"><span class="hs-identifier hs-var">tARGET_MAX_INT</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#inCharRange"><span class="hs-identifier hs-var">inCharRange</span></a><span>
</span><a name="line-36"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#isZeroLit"><span class="hs-identifier hs-var">isZeroLit</span></a><span>
</span><a name="line-37"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#litFitsInChar"><span class="hs-identifier hs-var">litFitsInChar</span></a><span>
</span><a name="line-38"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#litValue"><span class="hs-identifier hs-var">litValue</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#isLitValue"><span class="hs-identifier hs-var">isLitValue</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#isLitValue_maybe"><span class="hs-identifier hs-var">isLitValue_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#mapLitValue"><span class="hs-identifier hs-var">mapLitValue</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>        </span><span class="hs-comment">-- ** Coercions</span><span>
</span><a name="line-41"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#word2IntLit"><span class="hs-identifier hs-var">word2IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#int2WordLit"><span class="hs-identifier hs-var">int2WordLit</span></a><span>
</span><a name="line-42"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span>
</span><a name="line-43"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow8IntLit"><span class="hs-identifier hs-var">narrow8IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow16IntLit"><span class="hs-identifier hs-var">narrow16IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow32IntLit"><span class="hs-identifier hs-var">narrow32IntLit</span></a><span>
</span><a name="line-44"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow8WordLit"><span class="hs-identifier hs-var">narrow8WordLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow16WordLit"><span class="hs-identifier hs-var">narrow16WordLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#narrow32WordLit"><span class="hs-identifier hs-var">narrow32WordLit</span></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#char2IntLit"><span class="hs-identifier hs-var">char2IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#int2CharLit"><span class="hs-identifier hs-var">int2CharLit</span></a><span>
</span><a name="line-46"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#float2IntLit"><span class="hs-identifier hs-var">float2IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#int2FloatLit"><span class="hs-identifier hs-var">int2FloatLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#double2IntLit"><span class="hs-identifier hs-var">double2IntLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#int2DoubleLit"><span class="hs-identifier hs-var">int2DoubleLit</span></a><span>
</span><a name="line-47"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Literal.html#nullAddrLit"><span class="hs-identifier hs-var">nullAddrLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#rubbishLit"><span class="hs-identifier hs-var">rubbishLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#float2DoubleLit"><span class="hs-identifier hs-var">float2DoubleLit</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#double2FloatLit"><span class="hs-identifier hs-var">double2FloatLit</span></a><span>
</span><a name="line-48"></a><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;
</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Binary.html"><span class="hs-identifier">Binary</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Constants.html"><span class="hs-identifier">Constants</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Platform.html"><span class="hs-identifier">Platform</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="UniqFM.html"><span class="hs-identifier">UniqFM</span></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Int</span><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Proxy</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fromRat</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Literals}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | So-called 'Literal's are one of:</span><span>
</span><a name="line-86"></a><span class="hs-comment">--</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- * An unboxed numeric literal or floating-point literal which is presumed</span><span>
</span><a name="line-88"></a><span class="hs-comment">--   to be surrounded by appropriate constructors (@Int#@, etc.), so that</span><span>
</span><a name="line-89"></a><span class="hs-comment">--   the overall thing makes sense.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">--   We maintain the invariant that the 'Integer' in the 'LitNumber'</span><span>
</span><a name="line-92"></a><span class="hs-comment">--   constructor is actually in the (possibly target-dependent) range.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--   The mkLit{Int,Word}*Wrap smart constructors ensure this by applying</span><span>
</span><a name="line-94"></a><span class="hs-comment">--   the target machine's wrapping semantics. Use these in situations</span><span>
</span><a name="line-95"></a><span class="hs-comment">--   where you know the wrapping semantics are correct.</span><span>
</span><a name="line-96"></a><span class="hs-comment">--</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- * The literal derived from the label mentioned in a \&quot;foreign label\&quot;</span><span>
</span><a name="line-98"></a><span class="hs-comment">--   declaration ('LitLabel')</span><span>
</span><a name="line-99"></a><span class="hs-comment">--</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- * A 'LitRubbish' to be used in place of values of 'UnliftedRep'</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   (i.e. 'MutVar#') when the the value is never used.</span><span>
</span><a name="line-102"></a><span class="hs-comment">--</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- * A character</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- * A string</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- * The NULL pointer</span><span>
</span><a name="line-106"></a><span class="hs-comment">--</span><span>
</span><a name="line-107"></a><span class="hs-keyword">data</span><span> </span><a name="Literal"><a href="Literal.html#Literal"><span class="hs-identifier">Literal</span></a></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LitChar"><a href="Literal.html#LitChar"><span class="hs-identifier">LitChar</span></a></a><span>    </span><span class="hs-identifier hs-type">Char</span><span>             </span><span class="hs-comment">-- ^ @Char#@ - at least 31 bits. Create with</span><span>
</span><a name="line-109"></a><span>                                </span><span class="hs-comment">-- 'mkLitChar'</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumber"><a href="Literal.html#LitNumber"><span class="hs-identifier">LitNumber</span></a></a><span> </span><span class="hs-glyph">!</span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Integer</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-112"></a><span>                                </span><span class="hs-comment">-- ^ Any numeric literal that can be</span><span>
</span><a name="line-113"></a><span>                                </span><span class="hs-comment">-- internally represented with an Integer</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitString"><a href="Literal.html#LitString"><span class="hs-identifier">LitString</span></a></a><span>  </span><span class="hs-identifier hs-type">ByteString</span><span>       </span><span class="hs-comment">-- ^ A string-literal: stored and emitted</span><span>
</span><a name="line-116"></a><span>                                </span><span class="hs-comment">-- UTF-8 encoded, we'll arrange to decode it</span><span>
</span><a name="line-117"></a><span>                                </span><span class="hs-comment">-- at runtime.  Also emitted with a @\'\\0\'@</span><span>
</span><a name="line-118"></a><span>                                </span><span class="hs-comment">-- terminator. Create with 'mkLitString'</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNullAddr"><a href="Literal.html#LitNullAddr"><span class="hs-identifier">LitNullAddr</span></a></a><span>                 </span><span class="hs-comment">-- ^ The @NULL@ pointer, the only pointer value</span><span>
</span><a name="line-121"></a><span>                                </span><span class="hs-comment">-- that can be represented as a Literal. Create</span><span>
</span><a name="line-122"></a><span>                                </span><span class="hs-comment">-- with 'nullAddrLit'</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitRubbish"><a href="Literal.html#LitRubbish"><span class="hs-identifier">LitRubbish</span></a></a><span>                  </span><span class="hs-comment">-- ^ A nonsense value, used when an unlifted</span><span>
</span><a name="line-125"></a><span>                                </span><span class="hs-comment">-- binding is absent and has type</span><span>
</span><a name="line-126"></a><span>                                </span><span class="hs-comment">-- @forall (a :: 'TYPE' 'UnliftedRep'). a@.</span><span>
</span><a name="line-127"></a><span>                                </span><span class="hs-comment">-- May be lowered by code-gen to any possible</span><span>
</span><a name="line-128"></a><span>                                </span><span class="hs-comment">-- value. Also see Note [Rubbish literals]</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitFloat"><a href="Literal.html#LitFloat"><span class="hs-identifier">LitFloat</span></a></a><span>   </span><span class="hs-identifier hs-type">Rational</span><span>         </span><span class="hs-comment">-- ^ @Float#@. Create with 'mkLitFloat'</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitDouble"><a href="Literal.html#LitDouble"><span class="hs-identifier">LitDouble</span></a></a><span>  </span><span class="hs-identifier hs-type">Rational</span><span>         </span><span class="hs-comment">-- ^ @Double#@. Create with 'mkLitDouble'</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitLabel"><a href="Literal.html#LitLabel"><span class="hs-identifier">LitLabel</span></a></a><span>   </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="BasicTypes.html#FunctionOrData"><span class="hs-identifier hs-type">FunctionOrData</span></a><span>
</span><a name="line-134"></a><span>                                </span><span class="hs-comment">-- ^ A label literal. Parameters:</span><span>
</span><a name="line-135"></a><span>                                </span><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span>                                </span><span class="hs-comment">-- 1) The name of the symbol mentioned in the</span><span>
</span><a name="line-137"></a><span>                                </span><span class="hs-comment">--    declaration</span><span>
</span><a name="line-138"></a><span>                                </span><span class="hs-comment">--</span><span>
</span><a name="line-139"></a><span>                                </span><span class="hs-comment">-- 2) The size (in bytes) of the arguments</span><span>
</span><a name="line-140"></a><span>                                </span><span class="hs-comment">--    the label expects. Only applicable with</span><span>
</span><a name="line-141"></a><span>                                </span><span class="hs-comment">--    @stdcall@ labels. @Just x@ =&gt; @\&lt;x\&gt;@ will</span><span>
</span><a name="line-142"></a><span>                                </span><span class="hs-comment">--    be appended to label name when emitting</span><span>
</span><a name="line-143"></a><span>                                </span><span class="hs-comment">--    assembly.</span><span>
</span><a name="line-144"></a><span>                                </span><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span>                                </span><span class="hs-comment">-- 3) Flag indicating whether the symbol</span><span>
</span><a name="line-146"></a><span>                                </span><span class="hs-comment">--    references a function or a data</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Data</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Numeric literal type</span><span>
</span><a name="line-150"></a><span class="hs-keyword">data</span><span> </span><a name="LitNumType"><a href="Literal.html#LitNumType"><span class="hs-identifier">LitNumType</span></a></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="LitNumInteger"><a href="Literal.html#LitNumInteger"><span class="hs-identifier">LitNumInteger</span></a></a><span> </span><span class="hs-comment">-- ^ @Integer@ (see Note [Integer literals])</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumNatural"><a href="Literal.html#LitNumNatural"><span class="hs-identifier">LitNumNatural</span></a></a><span> </span><span class="hs-comment">-- ^ @Natural@ (see Note [Natural literals])</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumInt"><a href="Literal.html#LitNumInt"><span class="hs-identifier">LitNumInt</span></a></a><span>     </span><span class="hs-comment">-- ^ @Int#@ - according to target machine</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumInt64"><a href="Literal.html#LitNumInt64"><span class="hs-identifier">LitNumInt64</span></a></a><span>   </span><span class="hs-comment">-- ^ @Int64#@ - exactly 64 bits</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumWord"><a href="Literal.html#LitNumWord"><span class="hs-identifier">LitNumWord</span></a></a><span>    </span><span class="hs-comment">-- ^ @Word#@ - according to target machine</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LitNumWord64"><a href="Literal.html#LitNumWord64"><span class="hs-identifier">LitNumWord64</span></a></a><span>  </span><span class="hs-comment">-- ^ @Word64#@ - exactly 64 bits</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | Indicate if a numeric literal type supports negative numbers</span><span>
</span><a name="line-160"></a><span class="hs-identifier">litNumIsSigned</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-161"></a><a name="litNumIsSigned"><a href="Literal.html#litNumIsSigned"><span class="hs-identifier">litNumIsSigned</span></a></a><span> </span><a name="local-6989586621682021923"><a href="#local-6989586621682021923"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682021923"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-162"></a><span>  </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-163"></a><span>  </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-164"></a><span>  </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-165"></a><span>  </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-166"></a><span>  </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-167"></a><span>  </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">{-
Note [Integer literals]
~~~~~~~~~~~~~~~~~~~~~~~
An Integer literal is represented using, well, an Integer, to make it
easier to write RULEs for them. They also contain the Integer type, so
that e.g. literalType can return the right Type for them.

They only get converted into real Core,
    mkInteger [c1, c2, .., cn]
during the CorePrep phase, although TidyPgm looks ahead at what the
core will be, so that it can see whether it involves CAFs.

When we initally build an Integer literal, notably when
deserialising it from an interface file (see the Binary instance
below), we don't have convenient access to the mkInteger Id.  So we
just use an error thunk, and fill in the real Id when we do tcIfaceLit
in TcIface.

Note [Natural literals]
~~~~~~~~~~~~~~~~~~~~~~~
Similar to Integer literals.

-}</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-194"></a><span>   </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621682021918"><a href="#local-6989586621682021918"><span class="hs-identifier">bh</span></a></a><span> </span><a name="local-6989586621682021919"><a href="#local-6989586621682021919"><span class="hs-identifier">numTyp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021918"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621682021919"><span class="hs-identifier hs-var">numTyp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>   </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621682021920"><a href="#local-6989586621682021920"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-196"></a><span>      </span><a name="local-6989586621682021921"><a href="#local-6989586621682021921"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-6989586621682021920"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-197"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021921"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-keyword">instance</span><span> </span><a href="Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>    </span><a name="local-8214565720325095592"><a href="Binary.html#put_"><span class="hs-identifier">put_</span></a></a><span> </span><a name="local-6989586621682021889"><a href="#local-6989586621682021889"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><a name="local-6989586621682021890"><a href="#local-6989586621682021890"><span class="hs-identifier">aa</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021889"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021889"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021890"><span class="hs-identifier hs-var">aa</span></a><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021891"><a href="#local-6989586621682021891"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><a name="local-6989586621682021892"><a href="#local-6989586621682021892"><span class="hs-identifier">ab</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021891"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021891"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021892"><span class="hs-identifier hs-var">ab</span></a><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021893"><a href="#local-6989586621682021893"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021893"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021894"><a href="#local-6989586621682021894"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><a name="local-6989586621682021895"><a href="#local-6989586621682021895"><span class="hs-identifier">ah</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021894"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">3</span><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021894"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021895"><span class="hs-identifier hs-var">ah</span></a><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021896"><a href="#local-6989586621682021896"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a name="local-6989586621682021897"><a href="#local-6989586621682021897"><span class="hs-identifier">ai</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021896"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">4</span><span class="hs-special">;</span><span> </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021896"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021897"><span class="hs-identifier hs-var">ai</span></a><span>
</span><a name="line-205"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021898"><a href="#local-6989586621682021898"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span> </span><a name="local-6989586621682021899"><a href="#local-6989586621682021899"><span class="hs-identifier">aj</span></a></a><span> </span><a name="local-6989586621682021900"><a href="#local-6989586621682021900"><span class="hs-identifier">mb</span></a></a><span> </span><a name="local-6989586621682021901"><a href="#local-6989586621682021901"><span class="hs-identifier">fod</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021898"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">5</span><span>
</span><a name="line-207"></a><span>             </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021898"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021899"><span class="hs-identifier hs-var">aj</span></a><span>
</span><a name="line-208"></a><span>             </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021898"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021900"><span class="hs-identifier hs-var">mb</span></a><span>
</span><a name="line-209"></a><span>             </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021898"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021901"><span class="hs-identifier hs-var">fod</span></a><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021902"><a href="#local-6989586621682021902"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682021903"><a href="#local-6989586621682021903"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021904"><a href="#local-6989586621682021904"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021902"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">6</span><span>
</span><a name="line-212"></a><span>             </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021902"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021903"><span class="hs-identifier hs-var">nt</span></a><span>
</span><a name="line-213"></a><span>             </span><a href="Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a><span> </span><a href="#local-6989586621682021902"><span class="hs-identifier hs-var">bh</span></a><span> </span><a href="#local-6989586621682021904"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-identifier">put_</span><span> </span><a name="local-6989586621682021905"><a href="#local-6989586621682021905"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a><span> </span><a href="#local-6989586621682021905"><span class="hs-identifier hs-var">bh</span></a><span> </span><span class="hs-number">7</span><span>
</span><a name="line-215"></a><span>    </span><a name="local-8214565720325095594"><a href="Binary.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621682021906"><a href="#local-6989586621682021906"><span class="hs-identifier">bh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-216"></a><span>            </span><a name="local-6989586621682021907"><a href="#local-6989586621682021907"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-217"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682021907"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>              </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-219"></a><span>                    </span><a name="local-6989586621682021908"><a href="#local-6989586621682021908"><span class="hs-identifier">aa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-220"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><a href="#local-6989586621682021908"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>              </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-222"></a><span>                    </span><a name="local-6989586621682021909"><a href="#local-6989586621682021909"><span class="hs-identifier">ab</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-223"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><a href="#local-6989586621682021909"><span class="hs-identifier hs-var">ab</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>              </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-225"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>              </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-227"></a><span>                    </span><a name="local-6989586621682021910"><a href="#local-6989586621682021910"><span class="hs-identifier">ah</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-228"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><a href="#local-6989586621682021910"><span class="hs-identifier hs-var">ah</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>              </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-230"></a><span>                    </span><a name="local-6989586621682021911"><a href="#local-6989586621682021911"><span class="hs-identifier">ai</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-231"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a href="#local-6989586621682021911"><span class="hs-identifier hs-var">ai</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>              </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-233"></a><span>                    </span><a name="local-6989586621682021912"><a href="#local-6989586621682021912"><span class="hs-identifier">aj</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-234"></a><span>                    </span><a name="local-6989586621682021913"><a href="#local-6989586621682021913"><span class="hs-identifier">mb</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-235"></a><span>                    </span><a name="local-6989586621682021914"><a href="#local-6989586621682021914"><span class="hs-identifier">fod</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-236"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span> </span><a href="#local-6989586621682021912"><span class="hs-identifier hs-var">aj</span></a><span> </span><a href="#local-6989586621682021913"><span class="hs-identifier hs-var">mb</span></a><span> </span><a href="#local-6989586621682021914"><span class="hs-identifier hs-var">fod</span></a><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>              </span><span class="hs-number">6</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-238"></a><span>                    </span><a name="local-6989586621682021915"><a href="#local-6989586621682021915"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-239"></a><span>                    </span><a name="local-6989586621682021916"><a href="#local-6989586621682021916"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Binary.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621682021906"><span class="hs-identifier hs-var">bh</span></a><span>
</span><a name="line-240"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621682021917"><a href="#local-6989586621682021917"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682021915"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-241"></a><span>                            </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>
</span><a name="line-242"></a><span>                            </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysPrim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a><span>
</span><a name="line-243"></a><span>                            </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>
</span><a name="line-244"></a><span>                            </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysPrim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a><span>
</span><a name="line-245"></a><span>                            </span><span class="hs-comment">-- See Note [Integer literals]</span><span>
</span><a name="line-246"></a><span>                            </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-247"></a><span>                              </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;Evaluated the place holder for mkInteger&quot;</span><span>
</span><a name="line-248"></a><span>                            </span><span class="hs-comment">-- and Note [Natural literals]</span><span>
</span><a name="line-249"></a><span>                            </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-250"></a><span>                              </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;Evaluated the place holder for mkNatural&quot;</span><span>
</span><a name="line-251"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021915"><span class="hs-identifier hs-var">nt</span></a><span> </span><a href="#local-6989586621682021916"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621682021917"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-253"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-256"></a><span>    </span><a name="local-8214565720324887700"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621682021887"><a href="#local-6989586621682021887"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#pprLiteral"><span class="hs-identifier hs-var">pprLiteral</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621682021888"><a href="#local-6989586621682021888"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621682021888"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021887"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-259"></a><span>    </span><a name="local-6989586621682021883"><a href="#local-6989586621682021883"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621682021884"><a href="#local-6989586621682021884"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021883"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021884"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-260"></a><span>    </span><a name="local-6989586621682021885"><a href="#local-6989586621682021885"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790494"><span class="hs-operator">/=</span></a><span> </span><a name="local-6989586621682021886"><a href="#local-6989586621682021886"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021885"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021886"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- | Needed for the @Ord@ instance of 'AltCon', which in turn is needed in</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- 'TrieMap.CoreMap'.</span><span>
</span><a name="line-264"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-265"></a><span>    </span><a name="local-6989586621682021873"><a href="#local-6989586621682021873"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790495"><span class="hs-operator">&lt;=</span></a><span> </span><a name="local-6989586621682021874"><a href="#local-6989586621682021874"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021873"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021874"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-266"></a><span>    </span><a name="local-6989586621682021875"><a href="#local-6989586621682021875"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790500"><span class="hs-operator">&lt;</span></a><span>  </span><a name="local-6989586621682021876"><a href="#local-6989586621682021876"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021875"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021876"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-267"></a><span>    </span><a name="local-6989586621682021877"><a href="#local-6989586621682021877"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541096"><span class="hs-operator">&gt;=</span></a><span> </span><a name="local-6989586621682021878"><a href="#local-6989586621682021878"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021877"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021878"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span>  </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-268"></a><span>    </span><a name="local-6989586621682021879"><a href="#local-6989586621682021879"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323790501"><span class="hs-operator">&gt;</span></a><span>  </span><a name="local-6989586621682021880"><a href="#local-6989586621682021880"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021879"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682021880"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-269"></a><span>    </span><a name="local-8214565720323790496"><span class="hs-identifier">compare</span></a><span> </span><a name="local-6989586621682021881"><a href="#local-6989586621682021881"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621682021882"><a href="#local-6989586621682021882"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#cmpLit"><span class="hs-identifier hs-var">cmpLit</span></a><span> </span><a href="#local-6989586621682021881"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621682021882"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">{-
        Construction
        ~~~~~~~~~~~~
-}</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">{- Note [Word/Int underflow/overflow]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
According to the Haskell Report 2010 (Sections 18.1 and 23.1 about signed and
unsigned integral types): &quot;All arithmetic is performed modulo 2^n, where n is
the number of bits in the type.&quot;

GHC stores Word# and Int# constant values as Integer. Core optimizations such
as constant folding must ensure that the Integer value remains in the valid
target Word/Int range (see #13172). The following functions are used to
ensure this.

Note that we *don't* warn the user about overflow. It's not done at runtime
either, and compilation of completely harmless things like
   ((124076834 :: Word32) + (2147483647 :: Word32))
doesn't yield a warning. Instead we simply squash the value into the *target*
Int/Word range.
-}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-comment">-- | Wrap a literal number according to its type</span><span>
</span><a name="line-295"></a><span class="hs-identifier">wrapLitNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-296"></a><a name="wrapLitNumber"><a href="Literal.html#wrapLitNumber"><span class="hs-identifier">wrapLitNumber</span></a></a><span> </span><a name="local-6989586621682021924"><a href="#local-6989586621682021924"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021925"><a href="#local-6989586621682021925"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682021926"><a href="#local-6989586621682021926"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021927"><a href="#local-6989586621682021927"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621682021928"><a href="#local-6989586621682021928"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-297"></a><span>  </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformWordSize</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a><span> </span><a href="#local-6989586621682021924"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-298"></a><span>    </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-299"></a><span>    </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-300"></a><span>    </span><a name="local-6989586621682021929"><a href="#local-6989586621682021929"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;wrapLitNumber: Unknown platformWordSize: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621682021929"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>  </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">platformWordSize</span><span> </span><span class="hs-special">(</span><a href="DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a><span> </span><a href="#local-6989586621682021924"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-302"></a><span>    </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word32</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-303"></a><span>    </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-304"></a><span>    </span><a name="local-6989586621682021930"><a href="#local-6989586621682021930"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;wrapLitNumber: Unknown platformWordSize: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621682021930"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>  </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-306"></a><span>  </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021926"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621682021927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021928"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-307"></a><span>  </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621682021925"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-308"></a><span>  </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621682021925"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-309"></a><span class="hs-identifier">wrapLitNumber</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021931"><a href="#local-6989586621682021931"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021931"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- | Create a numeric 'Literal' of the given type</span><span>
</span><a name="line-312"></a><span class="hs-identifier">mkLitNumberWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-313"></a><a name="mkLitNumberWrap"><a href="Literal.html#mkLitNumberWrap"><span class="hs-identifier">mkLitNumberWrap</span></a></a><span> </span><a name="local-6989586621682021932"><a href="#local-6989586621682021932"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021933"><a href="#local-6989586621682021933"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021934"><a href="#local-6989586621682021934"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621682021935"><a href="#local-6989586621682021935"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021932"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021933"><span class="hs-identifier hs-var">nt</span></a><span> </span><a href="#local-6989586621682021934"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621682021935"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">-- | Check that a given number is in the range of a numeric literal</span><span>
</span><a name="line-316"></a><span class="hs-identifier">litNumCheckRange</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-317"></a><a name="litNumCheckRange"><a href="Literal.html#litNumCheckRange"><span class="hs-identifier">litNumCheckRange</span></a></a><span> </span><a name="local-6989586621682021936"><a href="#local-6989586621682021936"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021937"><a href="#local-6989586621682021937"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021938"><a href="#local-6989586621682021938"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682021937"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-318"></a><span>     </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span> </span><a href="#local-6989586621682021936"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021938"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-319"></a><span>     </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inWordRange"><span class="hs-identifier hs-var">inWordRange</span></a><span> </span><a href="#local-6989586621682021936"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021938"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-320"></a><span>     </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inInt64Range"><span class="hs-identifier hs-var">inInt64Range</span></a><span> </span><a href="#local-6989586621682021938"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-321"></a><span>     </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inWord64Range"><span class="hs-identifier hs-var">inWord64Range</span></a><span> </span><a href="#local-6989586621682021938"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-322"></a><span>     </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621682021938"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-323"></a><span>     </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Create a numeric 'Literal' of the given type</span><span>
</span><a name="line-326"></a><span class="hs-identifier">mkLitNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-327"></a><a name="mkLitNumber"><a href="Literal.html#mkLitNumber"><span class="hs-identifier">mkLitNumber</span></a></a><span> </span><a name="local-6989586621682021939"><a href="#local-6989586621682021939"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021940"><a href="#local-6989586621682021940"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021941"><a href="#local-6989586621682021941"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621682021942"><a href="#local-6989586621682021942"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-328"></a><span>  </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span class="hs-identifier">litNumCheckRange</span><span> </span><a href="Literal.html#litNumCheckRange"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="Literal.html#litNumCheckRange"><span class="hs-identifier hs-var">nt</span></a><span> </span><a href="Literal.html#litNumCheckRange"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">integer</span><span> </span><a href="#local-6989586621682021940"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021940"><span class="hs-identifier hs-var">nt</span></a><span> </span><a href="#local-6989586621682021941"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621682021942"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int#@</span><span>
</span><a name="line-332"></a><span class="hs-identifier">mkLitInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-333"></a><a name="mkLitInt"><a href="Literal.html#mkLitInt"><span class="hs-identifier">mkLitInt</span></a></a><span> </span><a name="local-6989586621682021943"><a href="#local-6989586621682021943"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021944"><a href="#local-6989586621682021944"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">inIntRange</span><span> </span><span class="hs-identifier">dflags</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">integer</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>                       </span><span class="hs-special">(</span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><a href="#local-6989586621682021944"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int#@.</span><span>
</span><a name="line-337"></a><span class="hs-comment">--   If the argument is out of the (target-dependent) range, it is wrapped.</span><span>
</span><a name="line-338"></a><span class="hs-comment">--   See Note [Word/Int underflow/overflow]</span><span>
</span><a name="line-339"></a><span class="hs-identifier">mkLitIntWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-340"></a><a name="mkLitIntWrap"><a href="Literal.html#mkLitIntWrap"><span class="hs-identifier">mkLitIntWrap</span></a></a><span> </span><a name="local-6989586621682021945"><a href="#local-6989586621682021945"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021946"><a href="#local-6989586621682021946"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021945"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><a href="#local-6989586621682021946"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int#@ without checking its range.</span><span>
</span><a name="line-343"></a><span class="hs-identifier">mkLitIntUnchecked</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-344"></a><a name="mkLitIntUnchecked"><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier">mkLitIntUnchecked</span></a></a><span> </span><a name="local-6989586621682021947"><a href="#local-6989586621682021947"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span> </span><a href="#local-6989586621682021947"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="TysPrim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int#@, as well as a 'Bool'ean flag indicating</span><span>
</span><a name="line-347"></a><span class="hs-comment">--   overflow. That is, if the argument is out of the (target-dependent) range</span><span>
</span><a name="line-348"></a><span class="hs-comment">--   the argument is wrapped and the overflow flag will be set.</span><span>
</span><a name="line-349"></a><span class="hs-comment">--   See Note [Word/Int underflow/overflow]</span><span>
</span><a name="line-350"></a><span class="hs-identifier">mkLitIntWrapC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-351"></a><a name="mkLitIntWrapC"><a href="Literal.html#mkLitIntWrapC"><span class="hs-identifier">mkLitIntWrapC</span></a></a><span> </span><a name="local-6989586621682021948"><a href="#local-6989586621682021948"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021949"><a href="#local-6989586621682021949"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021950"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621682021949"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621682021951"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-353"></a><span>    </span><a name="local-6989586621682021950"><a href="#local-6989586621682021950"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021951"><a href="#local-6989586621682021951"><span class="hs-identifier">i'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a><span> </span><a href="#local-6989586621682021948"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021949"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word#@</span><span>
</span><a name="line-356"></a><span class="hs-identifier">mkLitWord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-357"></a><a name="mkLitWord"><a href="Literal.html#mkLitWord"><span class="hs-identifier">mkLitWord</span></a></a><span> </span><a name="local-6989586621682021952"><a href="#local-6989586621682021952"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021953"><a href="#local-6989586621682021953"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">inWordRange</span><span> </span><span class="hs-identifier">dflags</span><span> </span><a href="Literal.html#inWordRange"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">integer</span><span> </span><a href="#local-6989586621682021952"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>                        </span><span class="hs-special">(</span><a href="Literal.html#mkLitWordUnchecked"><span class="hs-identifier hs-var">mkLitWordUnchecked</span></a><span> </span><a href="#local-6989586621682021953"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word#@.</span><span>
</span><a name="line-361"></a><span class="hs-comment">--   If the argument is out of the (target-dependent) range, it is wrapped.</span><span>
</span><a name="line-362"></a><span class="hs-comment">--   See Note [Word/Int underflow/overflow]</span><span>
</span><a name="line-363"></a><span class="hs-identifier">mkLitWordWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-364"></a><a name="mkLitWordWrap"><a href="Literal.html#mkLitWordWrap"><span class="hs-identifier">mkLitWordWrap</span></a></a><span> </span><a name="local-6989586621682021954"><a href="#local-6989586621682021954"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021955"><a href="#local-6989586621682021955"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021954"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Literal.html#mkLitWordUnchecked"><span class="hs-identifier hs-var">mkLitWordUnchecked</span></a><span> </span><a href="#local-6989586621682021955"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word#@ without checking its range.</span><span>
</span><a name="line-367"></a><span class="hs-identifier">mkLitWordUnchecked</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-368"></a><a name="mkLitWordUnchecked"><a href="Literal.html#mkLitWordUnchecked"><span class="hs-identifier">mkLitWordUnchecked</span></a></a><span> </span><a name="local-6989586621682021956"><a href="#local-6989586621682021956"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span> </span><a href="#local-6989586621682021956"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="TysPrim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word#@, as well as a 'Bool'ean flag indicating</span><span>
</span><a name="line-371"></a><span class="hs-comment">--   carry. That is, if the argument is out of the (target-dependent) range</span><span>
</span><a name="line-372"></a><span class="hs-comment">--   the argument is wrapped and the carry flag will be set.</span><span>
</span><a name="line-373"></a><span class="hs-comment">--   See Note [Word/Int underflow/overflow]</span><span>
</span><a name="line-374"></a><span class="hs-identifier">mkLitWordWrapC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><a name="mkLitWordWrapC"><a href="Literal.html#mkLitWordWrapC"><span class="hs-identifier">mkLitWordWrapC</span></a></a><span> </span><a name="local-6989586621682021957"><a href="#local-6989586621682021957"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021958"><a href="#local-6989586621682021958"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021959"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621682021958"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621682021960"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-377"></a><span>    </span><a name="local-6989586621682021959"><a href="#local-6989586621682021959"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021960"><a href="#local-6989586621682021960"><span class="hs-identifier">i'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a><span> </span><a href="#local-6989586621682021957"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021958"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int64#@</span><span>
</span><a name="line-380"></a><span class="hs-identifier">mkLitInt64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-381"></a><a name="mkLitInt64"><a href="Literal.html#mkLitInt64"><span class="hs-identifier">mkLitInt64</span></a></a><span>  </span><a name="local-6989586621682021961"><a href="#local-6989586621682021961"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">inInt64Range</span><span> </span><a href="Literal.html#inInt64Range"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#inInt64Range"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="Literal.html#inInt64Range"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkLitInt64Unchecked</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int64#@.</span><span>
</span><a name="line-384"></a><span class="hs-comment">--   If the argument is out of the range, it is wrapped.</span><span>
</span><a name="line-385"></a><span class="hs-identifier">mkLitInt64Wrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-386"></a><a name="mkLitInt64Wrap"><a href="Literal.html#mkLitInt64Wrap"><span class="hs-identifier">mkLitInt64Wrap</span></a></a><span> </span><a name="local-6989586621682021962"><a href="#local-6989586621682021962"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021963"><a href="#local-6989586621682021963"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021962"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Literal.html#mkLitInt64Unchecked"><span class="hs-identifier hs-var">mkLitInt64Unchecked</span></a><span> </span><a href="#local-6989586621682021963"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Int64#@ without checking its range.</span><span>
</span><a name="line-389"></a><span class="hs-identifier">mkLitInt64Unchecked</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-390"></a><a name="mkLitInt64Unchecked"><a href="Literal.html#mkLitInt64Unchecked"><span class="hs-identifier">mkLitInt64Unchecked</span></a></a><span> </span><a name="local-6989586621682021964"><a href="#local-6989586621682021964"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span> </span><a href="#local-6989586621682021964"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="TysPrim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word64#@</span><span>
</span><a name="line-393"></a><span class="hs-identifier">mkLitWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-394"></a><a name="mkLitWord64"><a href="Literal.html#mkLitWord64"><span class="hs-identifier">mkLitWord64</span></a></a><span> </span><a name="local-6989586621682021965"><a href="#local-6989586621682021965"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">inWord64Range</span><span> </span><a href="Literal.html#inWord64Range"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Literal.html#inWord64Range"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="Literal.html#inWord64Range"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkLitWord64Unchecked</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word64#@.</span><span>
</span><a name="line-397"></a><span class="hs-comment">--   If the argument is out of the range, it is wrapped.</span><span>
</span><a name="line-398"></a><span class="hs-identifier">mkLitWord64Wrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-399"></a><a name="mkLitWord64Wrap"><a href="Literal.html#mkLitWord64Wrap"><span class="hs-identifier">mkLitWord64Wrap</span></a></a><span> </span><a name="local-6989586621682021966"><a href="#local-6989586621682021966"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021967"><a href="#local-6989586621682021967"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021966"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Literal.html#mkLitWord64Unchecked"><span class="hs-identifier hs-var">mkLitWord64Unchecked</span></a><span> </span><a href="#local-6989586621682021967"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Word64#@ without checking its range.</span><span>
</span><a name="line-402"></a><span class="hs-identifier">mkLitWord64Unchecked</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-403"></a><a name="mkLitWord64Unchecked"><a href="Literal.html#mkLitWord64Unchecked"><span class="hs-identifier">mkLitWord64Unchecked</span></a></a><span> </span><a name="local-6989586621682021968"><a href="#local-6989586621682021968"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span> </span><a href="#local-6989586621682021968"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="TysPrim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Float#@</span><span>
</span><a name="line-406"></a><span class="hs-identifier">mkLitFloat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-407"></a><a name="mkLitFloat"><a href="Literal.html#mkLitFloat"><span class="hs-identifier">mkLitFloat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Double#@</span><span>
</span><a name="line-410"></a><span class="hs-identifier">mkLitDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-411"></a><a name="mkLitDouble"><a href="Literal.html#mkLitDouble"><span class="hs-identifier">mkLitDouble</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Char#@</span><span>
</span><a name="line-414"></a><span class="hs-identifier">mkLitChar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-415"></a><a name="mkLitChar"><a href="Literal.html#mkLitChar"><span class="hs-identifier">mkLitChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-comment">-- | Creates a 'Literal' of type @Addr#@, which is appropriate for passing to</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- e.g. some of the \&quot;error\&quot; functions in GHC.Err such as @GHC.Err.runtimeError@</span><span>
</span><a name="line-419"></a><span class="hs-identifier">mkLitString</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- stored UTF-8 encoded</span><span>
</span><a name="line-421"></a><a name="mkLitString"><a href="Literal.html#mkLitString"><span class="hs-identifier">mkLitString</span></a></a><span> </span><a name="local-6989586621682021969"><a href="#local-6989586621682021969"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fastStringToByteString"><span class="hs-identifier hs-var">fastStringToByteString</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a><span> </span><a href="#local-6989586621682021969"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span class="hs-identifier">mkLitInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-424"></a><a name="mkLitInteger"><a href="Literal.html#mkLitInteger"><span class="hs-identifier">mkLitInteger</span></a></a><span> </span><a name="local-6989586621682021970"><a href="#local-6989586621682021970"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621682021971"><a href="#local-6989586621682021971"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><a href="#local-6989586621682021970"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621682021971"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-identifier">mkLitNatural</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-427"></a><a name="mkLitNatural"><a href="Literal.html#mkLitNatural"><span class="hs-identifier">mkLitNatural</span></a></a><span> </span><a name="local-6989586621682021972"><a href="#local-6989586621682021972"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621682021973"><a href="#local-6989586621682021973"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">inNaturalRange</span><span> </span><a href="Literal.html#inNaturalRange"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span>  </span><a href="Literal.html#inNaturalRange"><span class="hs-identifier hs-var">integer</span></a><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>                    </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><a href="#local-6989586621682021972"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621682021973"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-identifier">inIntRange</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inWordRange</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-431"></a><a name="inIntRange"><a href="Literal.html#inIntRange"><span class="hs-identifier">inIntRange</span></a></a><span>  </span><a name="local-6989586621682021974"><a href="#local-6989586621682021974"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021975"><a href="#local-6989586621682021975"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021975"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="DynFlags.html#tARGET_MIN_INT"><span class="hs-identifier hs-var">tARGET_MIN_INT</span></a><span> </span><a href="#local-6989586621682021974"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621682021975"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="DynFlags.html#tARGET_MAX_INT"><span class="hs-identifier hs-var">tARGET_MAX_INT</span></a><span> </span><a href="#local-6989586621682021974"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-432"></a><a name="inWordRange"><a href="Literal.html#inWordRange"><span class="hs-identifier">inWordRange</span></a></a><span> </span><a name="local-6989586621682021976"><a href="#local-6989586621682021976"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021977"><a href="#local-6989586621682021977"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021977"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>                     </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621682021977"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="DynFlags.html#tARGET_MAX_WORD"><span class="hs-identifier hs-var">tARGET_MAX_WORD</span></a><span> </span><a href="#local-6989586621682021976"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-identifier">inNaturalRange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-435"></a><a name="inNaturalRange"><a href="Literal.html#inNaturalRange"><span class="hs-identifier">inNaturalRange</span></a></a><span> </span><a name="local-6989586621682021978"><a href="#local-6989586621682021978"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021978"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-identifier">inInt64Range</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">inWord64Range</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-438"></a><a name="inInt64Range"><a href="Literal.html#inInt64Range"><span class="hs-identifier">inInt64Range</span></a></a><span> </span><a name="local-6989586621682021979"><a href="#local-6989586621682021979"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021979"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-439"></a><span>                  </span><a href="#local-6989586621682021979"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span>
</span><a name="line-440"></a><a name="inWord64Range"><a href="Literal.html#inWord64Range"><span class="hs-identifier">inWord64Range</span></a></a><span> </span><a name="local-6989586621682021980"><a href="#local-6989586621682021980"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682021980"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-441"></a><span>                  </span><a href="#local-6989586621682021980"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-identifier">inCharRange</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-444"></a><a name="inCharRange"><a href="Literal.html#inCharRange"><span class="hs-identifier">inCharRange</span></a></a><span> </span><a name="local-6989586621682021981"><a href="#local-6989586621682021981"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621682021981"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-char">'\0'</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621682021981"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">chr</span><span> </span><a href="Constants.html#tARGET_MAX_CHAR"><span class="hs-identifier hs-var">tARGET_MAX_CHAR</span></a><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- | Tests whether the literal represents a zero of whatever type it is</span><span>
</span><a name="line-447"></a><span class="hs-identifier">isZeroLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-448"></a><a name="isZeroLit"><a href="Literal.html#isZeroLit"><span class="hs-identifier">isZeroLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-449"></a><span class="hs-identifier">isZeroLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>  </span><span class="hs-number">0</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-450"></a><span class="hs-identifier">isZeroLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-451"></a><span class="hs-identifier">isZeroLit</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | Returns the 'Integer' contained in the 'Literal', for when that makes</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- sense, i.e. for 'Char', 'Int', 'Word', 'LitInteger' and 'LitNatural'.</span><span>
</span><a name="line-455"></a><span class="hs-identifier">litValue</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-456"></a><a name="litValue"><a href="Literal.html#litValue"><span class="hs-identifier">litValue</span></a></a><span> </span><a name="local-6989586621682021982"><a href="#local-6989586621682021982"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Literal.html#isLitValue_maybe"><span class="hs-identifier hs-var">isLitValue_maybe</span></a><span> </span><a href="#local-6989586621682021982"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-457"></a><span>   </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621682021983"><a href="#local-6989586621682021983"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621682021983"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-458"></a><span>   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;litValue&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682021982"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-comment">-- | Returns the 'Integer' contained in the 'Literal', for when that makes</span><span>
</span><a name="line-461"></a><span class="hs-comment">-- sense, i.e. for 'Char' and numbers.</span><span>
</span><a name="line-462"></a><span class="hs-identifier">isLitValue_maybe</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-463"></a><a name="isLitValue_maybe"><a href="Literal.html#isLitValue_maybe"><span class="hs-identifier">isLitValue_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>   </span><a name="local-6989586621682021984"><a href="#local-6989586621682021984"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621682021984"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-464"></a><span class="hs-identifier">isLitValue_maybe</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021985"><a href="#local-6989586621682021985"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621682021985"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-465"></a><span class="hs-identifier">isLitValue_maybe</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-comment">-- | Apply a function to the 'Integer' contained in the 'Literal', for when that</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- makes sense, e.g. for 'Char' and numbers.</span><span>
</span><a name="line-469"></a><span class="hs-comment">-- For fixed-size integral literals, the result will be wrapped in accordance</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- with the semantics of the target type.</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- See Note [Word/Int underflow/overflow]</span><span>
</span><a name="line-472"></a><span class="hs-identifier">mapLitValue</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-473"></a><a name="mapLitValue"><a href="Literal.html#mapLitValue"><span class="hs-identifier">mapLitValue</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><a name="local-6989586621682021986"><a href="#local-6989586621682021986"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>   </span><a name="local-6989586621682021987"><a href="#local-6989586621682021987"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitChar"><span class="hs-identifier hs-var">mkLitChar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021988"><span class="hs-identifier hs-var">fchar</span></a><span> </span><a href="#local-6989586621682021987"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621682021988"><a href="#local-6989586621682021988"><span class="hs-identifier">fchar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">chr</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621682021986"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ord</span><span>
</span><a name="line-475"></a><span class="hs-identifier">mapLitValue</span><span> </span><a name="local-6989586621682021989"><a href="#local-6989586621682021989"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621682021990"><a href="#local-6989586621682021990"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682021991"><a href="#local-6989586621682021991"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682021992"><a href="#local-6989586621682021992"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621682021993"><a href="#local-6989586621682021993"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#wrapLitNumber"><span class="hs-identifier hs-var">wrapLitNumber</span></a><span> </span><a href="#local-6989586621682021989"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-476"></a><span>                                                        </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682021991"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021990"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621682021992"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621682021993"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span class="hs-identifier">mapLitValue</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021994"><a href="#local-6989586621682021994"><span class="hs-identifier">l</span></a></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;mapLitValue&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682021994"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-comment">-- | Indicate if the `Literal` contains an 'Integer' value, e.g. 'Char',</span><span>
</span><a name="line-480"></a><span class="hs-comment">-- 'Int', 'Word', 'LitInteger' and 'LitNatural'.</span><span>
</span><a name="line-481"></a><span class="hs-identifier">isLitValue</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-482"></a><a name="isLitValue"><a href="Literal.html#isLitValue"><span class="hs-identifier">isLitValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Literal.html#isLitValue_maybe"><span class="hs-identifier hs-var">isLitValue_maybe</span></a><span>
</span><a name="line-483"></a><span>
</span><a name="line-484"></a><span class="hs-comment">{-
        Coercions
        ~~~~~~~~~
-}</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-identifier">narrow8IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">narrow16IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">narrow32IntLit</span><span class="hs-special">,</span><span>
</span><a name="line-490"></a><span>  </span><span class="hs-identifier">narrow8WordLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">narrow16WordLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">narrow32WordLit</span><span class="hs-special">,</span><span>
</span><a name="line-491"></a><span>  </span><span class="hs-identifier">char2IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int2CharLit</span><span class="hs-special">,</span><span>
</span><a name="line-492"></a><span>  </span><span class="hs-identifier">float2IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int2FloatLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">double2IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int2DoubleLit</span><span class="hs-special">,</span><span>
</span><a name="line-493"></a><span>  </span><span class="hs-identifier">float2DoubleLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">double2FloatLit</span><span>
</span><a name="line-494"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-identifier">word2IntLit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int2WordLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-497"></a><a name="word2IntLit"><a href="Literal.html#word2IntLit"><span class="hs-identifier">word2IntLit</span></a></a><span> </span><a name="local-6989586621682021995"><a href="#local-6989586621682021995"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span> </span><a name="local-6989586621682021996"><a href="#local-6989586621682021996"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>  </span><span class="hs-comment">-- Map Word range [max_int+1, max_word]</span><span>
</span><a name="line-499"></a><span>  </span><span class="hs-comment">-- to Int range   [min_int  , -1]</span><span>
</span><a name="line-500"></a><span>  </span><span class="hs-comment">-- Range [0,max_int] has the same representation with both Int and Word</span><span>
</span><a name="line-501"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621682021996"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="DynFlags.html#tARGET_MAX_INT"><span class="hs-identifier hs-var">tARGET_MAX_INT</span></a><span> </span><a href="#local-6989586621682021995"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a><span> </span><a href="#local-6989586621682021995"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621682021996"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="DynFlags.html#tARGET_MAX_WORD"><span class="hs-identifier hs-var">tARGET_MAX_WORD</span></a><span> </span><a href="#local-6989586621682021995"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a><span> </span><a href="#local-6989586621682021995"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021996"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-503"></a><span class="hs-identifier">word2IntLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682021997"><a href="#local-6989586621682021997"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;word2IntLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682021997"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><a name="int2WordLit"><a href="Literal.html#int2WordLit"><span class="hs-identifier">int2WordLit</span></a></a><span> </span><a name="local-6989586621682021998"><a href="#local-6989586621682021998"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span> </span><a name="local-6989586621682021999"><a href="#local-6989586621682021999"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>  </span><span class="hs-comment">-- Map Int range [min_int  , -1]</span><span>
</span><a name="line-507"></a><span>  </span><span class="hs-comment">-- to Word range [max_int+1, max_word]</span><span>
</span><a name="line-508"></a><span>  </span><span class="hs-comment">-- Range [0,max_int] has the same representation with both Int and Word</span><span>
</span><a name="line-509"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621682021999"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a><span> </span><a href="#local-6989586621682021998"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="DynFlags.html#tARGET_MAX_WORD"><span class="hs-identifier hs-var">tARGET_MAX_WORD</span></a><span> </span><a href="#local-6989586621682021998"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621682021999"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a><span> </span><a href="#local-6989586621682021998"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682021999"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-511"></a><span class="hs-identifier">int2WordLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022000"><a href="#local-6989586621682022000"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;int2WordLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022000"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-comment">-- | Narrow a literal number (unchecked result range)</span><span>
</span><a name="line-514"></a><span class="hs-identifier">narrowLit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621682021922"><a href="#local-6989586621682021922"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621682021922"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621682021922"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-515"></a><a name="narrowLit"><a href="Literal.html#narrowLit"><span class="hs-identifier">narrowLit</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022001"><a href="#local-6989586621682022001"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682022002"><a href="#local-6989586621682022002"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621682022003"><a href="#local-6989586621682022003"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a href="#local-6989586621682022001"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621682022002"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621682021922"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621682022003"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-516"></a><span class="hs-identifier">narrowLit</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022004"><a href="#local-6989586621682022004"><span class="hs-identifier">l</span></a></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;narrowLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022004"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><a name="narrow8IntLit"><a href="Literal.html#narrow8IntLit"><span class="hs-identifier">narrow8IntLit</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Int8</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><a name="narrow16IntLit"><a href="Literal.html#narrow16IntLit"><span class="hs-identifier">narrow16IntLit</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Int16</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><a name="narrow32IntLit"><a href="Literal.html#narrow32IntLit"><span class="hs-identifier">narrow32IntLit</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">)</span><span>
</span><a name="line-521"></a><a name="narrow8WordLit"><a href="Literal.html#narrow8WordLit"><span class="hs-identifier">narrow8WordLit</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Word8</span><span class="hs-special">)</span><span>
</span><a name="line-522"></a><a name="narrow16WordLit"><a href="Literal.html#narrow16WordLit"><span class="hs-identifier">narrow16WordLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Word16</span><span class="hs-special">)</span><span>
</span><a name="line-523"></a><a name="narrow32WordLit"><a href="Literal.html#narrow32WordLit"><span class="hs-identifier">narrow32WordLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#narrowLit"><span class="hs-identifier hs-var">narrowLit</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-identifier hs-type">Word32</span><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><a name="char2IntLit"><a href="Literal.html#char2IntLit"><span class="hs-identifier">char2IntLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><a name="local-6989586621682022005"><a href="#local-6989586621682022005"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621682022005"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span class="hs-identifier">char2IntLit</span><span> </span><a name="local-6989586621682022006"><a href="#local-6989586621682022006"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;char2IntLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022006"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-527"></a><a name="int2CharLit"><a href="Literal.html#int2CharLit"><span class="hs-identifier">int2CharLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022007"><a href="#local-6989586621682022007"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">chr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621682022007"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span class="hs-identifier">int2CharLit</span><span> </span><a name="local-6989586621682022008"><a href="#local-6989586621682022008"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;int2CharLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022008"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><a name="float2IntLit"><a href="Literal.html#float2IntLit"><span class="hs-identifier">float2IntLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><a name="local-6989586621682022009"><a href="#local-6989586621682022009"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">truncate</span><span> </span><a href="#local-6989586621682022009"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span class="hs-identifier">float2IntLit</span><span> </span><a name="local-6989586621682022010"><a href="#local-6989586621682022010"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;float2IntLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022010"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><a name="int2FloatLit"><a href="Literal.html#int2FloatLit"><span class="hs-identifier">int2FloatLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022011"><a href="#local-6989586621682022011"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621682022011"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span class="hs-identifier">int2FloatLit</span><span> </span><a name="local-6989586621682022012"><a href="#local-6989586621682022012"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;int2FloatLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022012"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><a name="double2IntLit"><a href="Literal.html#double2IntLit"><span class="hs-identifier">double2IntLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a name="local-6989586621682022013"><a href="#local-6989586621682022013"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">truncate</span><span> </span><a href="#local-6989586621682022013"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-536"></a><span class="hs-identifier">double2IntLit</span><span> </span><a name="local-6989586621682022014"><a href="#local-6989586621682022014"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;double2IntLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022014"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><a name="int2DoubleLit"><a href="Literal.html#int2DoubleLit"><span class="hs-identifier">int2DoubleLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022015"><a href="#local-6989586621682022015"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621682022015"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-538"></a><span class="hs-identifier">int2DoubleLit</span><span> </span><a name="local-6989586621682022016"><a href="#local-6989586621682022016"><span class="hs-identifier">l</span></a></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;int2DoubleLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022016"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><a name="float2DoubleLit"><a href="Literal.html#float2DoubleLit"><span class="hs-identifier">float2DoubleLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>  </span><a name="local-6989586621682022017"><a href="#local-6989586621682022017"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a href="#local-6989586621682022017"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-541"></a><span class="hs-identifier">float2DoubleLit</span><span> </span><a name="local-6989586621682022018"><a href="#local-6989586621682022018"><span class="hs-identifier">l</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;float2DoubleLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022018"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-542"></a><a name="double2FloatLit"><a href="Literal.html#double2FloatLit"><span class="hs-identifier">double2FloatLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a name="local-6989586621682022019"><a href="#local-6989586621682022019"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>  </span><a href="#local-6989586621682022019"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-543"></a><span class="hs-identifier">double2FloatLit</span><span> </span><a name="local-6989586621682022020"><a href="#local-6989586621682022020"><span class="hs-identifier">l</span></a></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;double2FloatLit&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022020"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span class="hs-identifier">nullAddrLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-546"></a><a name="nullAddrLit"><a href="Literal.html#nullAddrLit"><span class="hs-identifier">nullAddrLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">-- | A nonsense literal of type @forall (a :: 'TYPE' 'UnliftedRep'). a@.</span><span>
</span><a name="line-549"></a><span class="hs-identifier">rubbishLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-550"></a><a name="rubbishLit"><a href="Literal.html#rubbishLit"><span class="hs-identifier">rubbishLit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">{-
        Predicates
        ~~~~~~~~~~
-}</span><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- | True if there is absolutely no penalty to duplicating the literal.</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- False principally of strings.</span><span>
</span><a name="line-559"></a><span class="hs-comment">--</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- &quot;Why?&quot;, you say? I'm glad you asked. Well, for one duplicating strings would</span><span>
</span><a name="line-561"></a><span class="hs-comment">-- blow up code sizes. Not only this, it's also unsafe.</span><span>
</span><a name="line-562"></a><span class="hs-comment">--</span><span>
</span><a name="line-563"></a><span class="hs-comment">-- Consider a program that wants to traverse a string. One way it might do this</span><span>
</span><a name="line-564"></a><span class="hs-comment">-- is to first compute the Addr# pointing to the end of the string, and then,</span><span>
</span><a name="line-565"></a><span class="hs-comment">-- starting from the beginning, bump a pointer using eqAddr# to determine the</span><span>
</span><a name="line-566"></a><span class="hs-comment">-- end. For instance,</span><span>
</span><a name="line-567"></a><span class="hs-comment">--</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- -- Given pointers to the start and end of a string, count how many zeros</span><span>
</span><a name="line-570"></a><span class="hs-comment">-- -- the string contains.</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- countZeros :: Addr# -&gt; Addr# -&gt; -&gt; Int</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- countZeros start end = go start 0</span><span>
</span><a name="line-573"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-574"></a><span class="hs-comment">--     go off n</span><span>
</span><a name="line-575"></a><span class="hs-comment">--       | off `addrEq#` end = n</span><span>
</span><a name="line-576"></a><span class="hs-comment">--       | otherwise         = go (off `plusAddr#` 1) n'</span><span>
</span><a name="line-577"></a><span class="hs-comment">--       where n' | isTrue# (indexInt8OffAddr# off 0# ==# 0#) = n + 1</span><span>
</span><a name="line-578"></a><span class="hs-comment">--                | otherwise                                 = n</span><span>
</span><a name="line-579"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-580"></a><span class="hs-comment">--</span><span>
</span><a name="line-581"></a><span class="hs-comment">-- Consider what happens if we considered strings to be trivial (and therefore</span><span>
</span><a name="line-582"></a><span class="hs-comment">-- duplicable) and emitted a call like @countZeros &quot;hello&quot;# (&quot;hello&quot;#</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- `plusAddr`# 5)@. The beginning and end pointers do not belong to the same</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- string, meaning that an iteration like the above would blow up terribly.</span><span>
</span><a name="line-585"></a><span class="hs-comment">-- This is what happened in #12757.</span><span>
</span><a name="line-586"></a><span class="hs-comment">--</span><span>
</span><a name="line-587"></a><span class="hs-comment">-- Ultimately the solution here is to make primitive strings a bit more</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- structured, ensuring that the compiler can't inline in ways that will break</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- user code. One approach to this is described in #8472.</span><span>
</span><a name="line-590"></a><span class="hs-identifier">litIsTrivial</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-591"></a><span class="hs-comment">--      c.f. CoreUtils.exprIsTrivial</span><span>
</span><a name="line-592"></a><a name="litIsTrivial"><a href="Literal.html#litIsTrivial"><span class="hs-identifier">litIsTrivial</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-593"></a><span class="hs-identifier">litIsTrivial</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022021"><a href="#local-6989586621682022021"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682022021"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-594"></a><span>  </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-595"></a><span>  </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-596"></a><span>  </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-597"></a><span>  </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-598"></a><span>  </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-599"></a><span>  </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-600"></a><span class="hs-identifier">litIsTrivial</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span class="hs-comment">-- | True if code space does not go bad if we duplicate this literal</span><span>
</span><a name="line-603"></a><span class="hs-identifier">litIsDupable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-604"></a><span class="hs-comment">--      c.f. CoreUtils.exprIsDupable</span><span>
</span><a name="line-605"></a><a name="litIsDupable"><a href="Literal.html#litIsDupable"><span class="hs-identifier">litIsDupable</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-606"></a><span class="hs-identifier">litIsDupable</span><span> </span><a name="local-6989586621682022022"><a href="#local-6989586621682022022"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022023"><a href="#local-6989586621682022023"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682022024"><a href="#local-6989586621682022024"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682022023"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-607"></a><span>  </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span> </span><a href="#local-6989586621682022022"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682022024"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-608"></a><span>  </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#inIntRange"><span class="hs-identifier hs-var">inIntRange</span></a><span> </span><a href="#local-6989586621682022022"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621682022024"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-609"></a><span>  </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-610"></a><span>  </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-611"></a><span>  </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-612"></a><span>  </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-613"></a><span class="hs-identifier">litIsDupable</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-identifier">litFitsInChar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-616"></a><a name="litFitsInChar"><a href="Literal.html#litFitsInChar"><span class="hs-identifier">litFitsInChar</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022025"><a href="#local-6989586621682022025"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022025"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-identifier hs-var">minBound</span><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span>                               </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621682022025"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span class="hs-identifier">litFitsInChar</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-identifier">litIsLifted</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-621"></a><a name="litIsLifted"><a href="Literal.html#litIsLifted"><span class="hs-identifier">litIsLifted</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022026"><a href="#local-6989586621682022026"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682022026"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-622"></a><span>  </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-623"></a><span>  </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-624"></a><span>  </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-625"></a><span>  </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-626"></a><span>  </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-627"></a><span>  </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-628"></a><span class="hs-identifier">litIsLifted</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-comment">{-
        Types
        ~~~~~
-}</span><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span class="hs-comment">-- | Find the Haskell 'Type' the literal occupies</span><span>
</span><a name="line-636"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-637"></a><a name="literalType"><a href="Literal.html#literalType"><span class="hs-identifier">literalType</span></a></a><span> </span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>
</span><a name="line-638"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#charPrimTy"><span class="hs-identifier hs-var">charPrimTy</span></a><span>
</span><a name="line-639"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>
</span><a name="line-640"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#floatPrimTy"><span class="hs-identifier hs-var">floatPrimTy</span></a><span>
</span><a name="line-641"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#doublePrimTy"><span class="hs-identifier hs-var">doublePrimTy</span></a><span>
</span><a name="line-642"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a><span>
</span><a name="line-643"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621682022027"><a href="#local-6989586621682022027"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022027"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-644"></a><span class="hs-identifier">literalType</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkForAllTy"><span class="hs-identifier hs-var">mkForAllTy</span></a><span> </span><a href="#local-6989586621682022028"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621682022028"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-646"></a><span>    </span><a name="local-6989586621682022028"><a href="#local-6989586621682022028"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#alphaTyVarUnliftedRep"><span class="hs-identifier hs-var">alphaTyVarUnliftedRep</span></a><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-identifier">absentLiteralOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-649"></a><span class="hs-comment">-- Return a literal of the appropriate primitive</span><span>
</span><a name="line-650"></a><span class="hs-comment">-- TyCon, to use as a placeholder when it doesn't matter</span><span>
</span><a name="line-651"></a><span class="hs-comment">-- Rubbish literals are handled in WwLib, because</span><span>
</span><a name="line-652"></a><span class="hs-comment">--  1. Looking at the TyCon is not enough, we need the actual type</span><span>
</span><a name="line-653"></a><span class="hs-comment">--  2. This would need to return a type application to a literal</span><span>
</span><a name="line-654"></a><a name="absentLiteralOf"><a href="Literal.html#absentLiteralOf"><span class="hs-identifier">absentLiteralOf</span></a></a><span> </span><a name="local-6989586621682022029"><a href="#local-6989586621682022029"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#lookupUFM"><span class="hs-identifier hs-var">lookupUFM</span></a><span> </span><a href="Literal.html#absent_lits"><span class="hs-identifier hs-var">absent_lits</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621682022029"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span class="hs-identifier">absent_lits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="UniqFM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span>
</span><a name="line-657"></a><a name="absent_lits"><a href="Literal.html#absent_lits"><span class="hs-identifier">absent_lits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqFM.html#listToUFM"><span class="hs-identifier hs-var">listToUFM</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#addrPrimTyConKey"><span class="hs-identifier hs-var">addrPrimTyConKey</span></a><span class="hs-special">,</span><span>    </span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#charPrimTyConKey"><span class="hs-identifier hs-var">charPrimTyConKey</span></a><span class="hs-special">,</span><span>    </span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><span class="hs-char">'x'</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#intPrimTyConKey"><span class="hs-identifier hs-var">intPrimTyConKey</span></a><span class="hs-special">,</span><span>     </span><a href="Literal.html#mkLitIntUnchecked"><span class="hs-identifier hs-var">mkLitIntUnchecked</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#int64PrimTyConKey"><span class="hs-identifier hs-var">int64PrimTyConKey</span></a><span class="hs-special">,</span><span>   </span><a href="Literal.html#mkLitInt64Unchecked"><span class="hs-identifier hs-var">mkLitInt64Unchecked</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-661"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#wordPrimTyConKey"><span class="hs-identifier hs-var">wordPrimTyConKey</span></a><span class="hs-special">,</span><span>    </span><a href="Literal.html#mkLitWordUnchecked"><span class="hs-identifier hs-var">mkLitWordUnchecked</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#word64PrimTyConKey"><span class="hs-identifier hs-var">word64PrimTyConKey</span></a><span class="hs-special">,</span><span>  </span><a href="Literal.html#mkLitWord64Unchecked"><span class="hs-identifier hs-var">mkLitWord64Unchecked</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#floatPrimTyConKey"><span class="hs-identifier hs-var">floatPrimTyConKey</span></a><span class="hs-special">,</span><span>   </span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PrelNames.html#doublePrimTyConKey"><span class="hs-identifier hs-var">doublePrimTyConKey</span></a><span class="hs-special">,</span><span>  </span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-665"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span class="hs-comment">{-
        Comparison
        ~~~~~~~~~~
-}</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-673"></a><a name="cmpLit"><a href="Literal.html#cmpLit"><span class="hs-identifier">cmpLit</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>      </span><a name="local-6989586621682022030"><a href="#local-6989586621682022030"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>       </span><a name="local-6989586621682022031"><a href="#local-6989586621682022031"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022030"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022031"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-674"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span>    </span><a name="local-6989586621682022032"><a href="#local-6989586621682022032"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span>     </span><a name="local-6989586621682022033"><a href="#local-6989586621682022033"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022032"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022033"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-675"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-676"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>     </span><a name="local-6989586621682022034"><a href="#local-6989586621682022034"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>      </span><a name="local-6989586621682022035"><a href="#local-6989586621682022035"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022034"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022035"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-677"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span>    </span><a name="local-6989586621682022036"><a href="#local-6989586621682022036"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span>     </span><a name="local-6989586621682022037"><a href="#local-6989586621682022037"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022036"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022037"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-678"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span>     </span><a name="local-6989586621682022038"><a href="#local-6989586621682022038"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span>      </span><a name="local-6989586621682022039"><a href="#local-6989586621682022039"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022038"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022039"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-679"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022040"><a href="#local-6989586621682022040"><span class="hs-identifier">nt1</span></a></a><span> </span><a name="local-6989586621682022041"><a href="#local-6989586621682022041"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022042"><a href="#local-6989586621682022042"><span class="hs-identifier">nt2</span></a></a><span>  </span><a name="local-6989586621682022043"><a href="#local-6989586621682022043"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621682022040"><span class="hs-identifier hs-var">nt1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621682022042"><span class="hs-identifier hs-var">nt2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022041"><span class="hs-identifier hs-var">a</span></a><span>   </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022043"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-681"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022040"><span class="hs-identifier hs-var">nt1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621682022042"><span class="hs-identifier hs-var">nt2</span></a><span>
</span><a name="line-682"></a><span class="hs-identifier">cmpLit</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-683"></a><span class="hs-identifier">cmpLit</span><span> </span><a name="local-6989586621682022044"><a href="#local-6989586621682022044"><span class="hs-identifier">lit1</span></a></a><span> </span><a name="local-6989586621682022045"><a href="#local-6989586621682022045"><span class="hs-identifier">lit2</span></a></a><span>
</span><a name="line-684"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Literal.html#litTag"><span class="hs-identifier hs-var">litTag</span></a><span> </span><a href="#local-6989586621682022044"><span class="hs-identifier hs-var">lit1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="Literal.html#litTag"><span class="hs-identifier hs-var">litTag</span></a><span> </span><a href="#local-6989586621682022045"><span class="hs-identifier hs-var">lit2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-685"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-688"></a><a name="litTag"><a href="Literal.html#litTag"><span class="hs-identifier">litTag</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span>      </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-689"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span>    </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-690"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-691"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span>     </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-692"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span>    </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-693"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-694"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span>  </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span>
</span><a name="line-695"></a><span class="hs-identifier">litTag</span><span> </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-comment">{-
        Printing
        ~~~~~~~~
* See Note [Printing of literals in Core]
-}</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-704"></a><a name="pprLiteral"><a href="Literal.html#pprLiteral"><span class="hs-identifier">pprLiteral</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a><span> </span><a name="local-6989586621682022046"><a href="#local-6989586621682022046"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPrimChar"><span class="hs-identifier hs-var">pprPrimChar</span></a><span> </span><a href="#local-6989586621682022046"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-705"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a><span> </span><a name="local-6989586621682022047"><a href="#local-6989586621682022047"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprHsBytes"><span class="hs-identifier hs-var">pprHsBytes</span></a><span> </span><a href="#local-6989586621682022047"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-706"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;__NULL&quot;</span><span>
</span><a name="line-707"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a><span> </span><a name="local-6989586621682022048"><a href="#local-6989586621682022048"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#float"><span class="hs-identifier hs-var">float</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromRat</span><span> </span><a href="#local-6989586621682022048"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#primFloatSuffix"><span class="hs-identifier hs-var">primFloatSuffix</span></a><span>
</span><a name="line-708"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a><span> </span><a name="local-6989586621682022049"><a href="#local-6989586621682022049"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#double"><span class="hs-identifier hs-var">double</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromRat</span><span> </span><a href="#local-6989586621682022049"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#primDoubleSuffix"><span class="hs-identifier hs-var">primDoubleSuffix</span></a><span>
</span><a name="line-709"></a><span class="hs-identifier">pprLiteral</span><span> </span><a name="local-6989586621682022050"><a href="#local-6989586621682022050"><span class="hs-identifier">add_par</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitNumber"><span class="hs-identifier hs-var">LitNumber</span></a><span> </span><a name="local-6989586621682022051"><a href="#local-6989586621682022051"><span class="hs-identifier">nt</span></a></a><span> </span><a name="local-6989586621682022052"><a href="#local-6989586621682022052"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682022051"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-711"></a><span>       </span><a href="Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#pprIntegerVal"><span class="hs-identifier hs-var">pprIntegerVal</span></a><span> </span><a href="#local-6989586621682022050"><span class="hs-identifier hs-var">add_par</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-712"></a><span>       </span><a href="Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Literal.html#pprIntegerVal"><span class="hs-identifier hs-var">pprIntegerVal</span></a><span> </span><a href="#local-6989586621682022050"><span class="hs-identifier hs-var">add_par</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-713"></a><span>       </span><a href="Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPrimInt"><span class="hs-identifier hs-var">pprPrimInt</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-714"></a><span>       </span><a href="Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPrimInt64"><span class="hs-identifier hs-var">pprPrimInt64</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-715"></a><span>       </span><a href="Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPrimWord"><span class="hs-identifier hs-var">pprPrimWord</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-716"></a><span>       </span><a href="Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPrimWord64"><span class="hs-identifier hs-var">pprPrimWord64</span></a><span> </span><a href="#local-6989586621682022052"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-717"></a><span class="hs-identifier">pprLiteral</span><span> </span><a name="local-6989586621682022053"><a href="#local-6989586621682022053"><span class="hs-identifier">add_par</span></a></a><span> </span><span class="hs-special">(</span><a href="Literal.html#LitLabel"><span class="hs-identifier hs-var">LitLabel</span></a><span> </span><a name="local-6989586621682022054"><a href="#local-6989586621682022054"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621682022055"><a href="#local-6989586621682022055"><span class="hs-identifier">mb</span></a></a><span> </span><a name="local-6989586621682022056"><a href="#local-6989586621682022056"><span class="hs-identifier">fod</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-718"></a><span>    </span><a href="#local-6989586621682022053"><span class="hs-identifier hs-var">add_par</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;__label&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621682022057"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621682022056"><span class="hs-identifier hs-var">fod</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621682022057"><a href="#local-6989586621682022057"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621682022055"><span class="hs-identifier hs-var">mb</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-720"></a><span>              </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprHsString"><span class="hs-identifier hs-var">pprHsString</span></a><span> </span><a href="#local-6989586621682022054"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-721"></a><span>              </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621682022058"><a href="#local-6989586621682022058"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#doubleQuotes"><span class="hs-identifier hs-var">doubleQuotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-6989586621682022054"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-char">'@'</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621682022058"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span class="hs-identifier">pprLiteral</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="Literal.html#LitRubbish"><span class="hs-identifier hs-var">LitRubbish</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;__RUBBISH&quot;</span><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span class="hs-identifier">pprIntegerVal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-725"></a><span class="hs-comment">-- See Note [Printing of literals in Core].</span><span>
</span><a name="line-726"></a><a name="pprIntegerVal"><a href="Literal.html#pprIntegerVal"><span class="hs-identifier">pprIntegerVal</span></a></a><span> </span><a name="local-6989586621682022059"><a href="#local-6989586621682022059"><span class="hs-identifier">add_par</span></a></a><span> </span><a name="local-6989586621682022060"><a href="#local-6989586621682022060"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621682022060"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621682022059"><span class="hs-identifier hs-var">add_par</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="#local-6989586621682022060"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="#local-6989586621682022060"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-728"></a><span>
</span><a name="line-729"></a><span class="hs-comment">{-
Note [Printing of literals in Core]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The function `add_par` is used to wrap parenthesis around negative integers
(`LitInteger`) and labels (`LitLabel`), if they occur in a context requiring
an atomic thing (for example function application).

Although not all Core literals would be valid Haskell, we are trying to stay
as close as possible to Haskell syntax in the printing of Core, to make it
easier for a Haskell user to read Core.

To that end:
  * We do print parenthesis around negative `LitInteger`, because we print
  `LitInteger` using plain number literals (no prefix or suffix), and plain
  number literals in Haskell require parenthesis in contexts like function
  application (i.e. `1 - -1` is not valid Haskell).

  * We don't print parenthesis around other (negative) literals, because they
  aren't needed in GHC/Haskell either (i.e. `1# -# -1#` is accepted by GHC's
  parser).

Literal         Output             Output if context requires
                                   an atom (if different)
-------         -------            ----------------------
LitChar         'a'#
LitString       &quot;aaa&quot;#
LitNullAddr     &quot;__NULL&quot;
LitInt          -1#
LitInt64        -1L#
LitWord          1##
LitWord64        1L##
LitFloat        -1.0#
LitDouble       -1.0##
LitInteger      -1                 (-1)
LitLabel        &quot;__label&quot; ...      (&quot;__label&quot; ...)
LitRubbish      &quot;__RUBBISH&quot;

Note [Rubbish literals]
~~~~~~~~~~~~~~~~~~~~~~~
During worker/wrapper after demand analysis, where an argument
is unused (absent) we do the following w/w split (supposing that
y is absent):

  f x y z = e
===&gt;
  f x y z = $wf x z
  $wf x z = let y = &lt;absent value&gt;
            in e

Usually the binding for y is ultimately optimised away, and
even if not it should never be evaluated -- but that's the
way the w/w split starts off.

What is &lt;absent value&gt;?
* For lifted values &lt;absent value&gt; can be a call to 'error'.
* For primitive types like Int# or Word# we can use any random
  value of that type.
* But what about /unlifted/ but /boxed/ types like MutVar# or
  Array#?   We need a literal value of that type.

That is 'LitRubbish'.  Since we need a rubbish literal for
many boxed, unlifted types, we say that LitRubbish has type
  LitRubbish :: forall (a :: TYPE UnliftedRep). a

So we might see a w/w split like
  $wf x z = let y :: Array# Int = LitRubbish @(Array# Int)
            in e

Recall that (TYPE UnliftedRep) is the kind of boxed, unlifted
heap pointers.

Here are the moving parts:

* We define LitRubbish as a constructor in Literal.Literal

* It is given its polymoprhic type by Literal.literalType

* WwLib.mk_absent_let introduces a LitRubbish for absent
  arguments of boxed, unlifted type.

* In CoreToSTG we convert (RubishLit @t) to just ().  STG is
  untyped, so it doesn't matter that it points to a lifted
  value. The important thing is that it is a heap pointer,
  which the garbage collector can follow if it encounters it.

  We considered maintaining LitRubbish in STG, and lowering
  it in the code genreators, but it seems simpler to do it
  once and for all in CoreToSTG.

  In ByteCodeAsm we just lower it as a 0 literal, because
  it's all boxed and lifted to the host GC anyway.
-}</span><span>
</span><a name="line-821"></a></pre></body></html>