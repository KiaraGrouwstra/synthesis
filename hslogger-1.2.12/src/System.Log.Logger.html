<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
   Module     : System.Log.Logger
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt; 
   Stability  : provisional
   Portability: portable

Haskell Logging Framework, Primary Interface

Written by John Goerzen, jgoerzen\@complete.org

Welcome to the error and information logging system for Haskell.

This system is patterned after Python\'s @logging@ module,
&lt;http://www.python.org/doc/current/lib/module-logging.html&gt; and some of
the documentation here was based on documentation there.

To log a message, you perform operations on 'Logger's.  Each 'Logger' has a
name, and they are arranged hierarchically.  Periods serve as separators.
Therefore, a 'Logger' named \&quot;foo\&quot; is the parent of loggers \&quot;foo.printing\&quot;,
\&quot;foo.html\&quot;, and \&quot;foo.io\&quot;.  These names can be anything you want.  They're
used to indicate the area of an application or library in which a logged
message originates.  Later you will see how you can use this concept to 
fine-tune logging behaviors based on specific application areas.

You can also tune logging behaviors based upon how important a message is.
Each message you log will have an importance associated with it.  The different
importance levels are given by the 'Priority' type.  I've also provided
some convenient functions that correspond to these importance levels:
'debugM' through 'emergencyM' log messages with the specified importance.

Now, an importance level (or 'Priority') 
is associated not just with a particular message but also
with a 'Logger'.  If the 'Priority' of a given log message is lower than
the 'Priority' configured in the 'Logger', that message is ignored.  This
way, you can globally control how verbose your logging output is.

Now, let's follow what happens under the hood when you log a message.  We'll
assume for the moment that you are logging something with a high enough
'Priority' that it passes the test in your 'Logger'.  In your code, you'll
call 'logM' or something like 'debugM' to log the message.  Your 'Logger'
decides to accept the message.  What next?

Well, we also have a notion of /handlers/ ('LogHandler's, to be precise).
A 'LogHandler' is a thing that takes a message and sends it somewhere.
That \&quot;somewhere\&quot; may be your screen (via standard error), your system's
logging infrastructure (via syslog), a file, or other things.  Each
'Logger' can have zero or more 'LogHandler's associated with it.  When your
'Logger' has a message to log, it passes it to every 'LogHandler' it knows
of to process.  What's more, it is also passed to /all handlers of all
ancestors of the Logger/, regardless of whether those 'Logger's would
normally have passed on the message.

Each 'Logger' can /optionally/ store a 'Priority'.  If a given Logger does
not have a Priority, and you log a message to that logger, the system will
use the priority of the parent of the destination logger to find out whether
to log the message.  If the parent has no priority associated with it,
the system continues walking up the tree to figure out a priority until
it hits the root logger.  In this way, you can easily adjust the priority
of an entire subtree of loggers.  When a new logger is created, it has no
priority by default.  The exception is the root logger, which has a WARNING
priority by default.

To give you one extra little knob to turn, 'LogHandler's can also have
importance levels ('Priority') associated with them in the same way
that 'Logger's do.  They act just like the 'Priority' value in the
'Logger's -- as a filter.  It's useful, for instance, to make sure that
under no circumstances will a mere 'DEBUG' message show up in your syslog.

There are three built-in handlers given in two built-in modules:
&quot;System.Log.Handler.Simple&quot; and &quot;System.Log.Handler.Syslog&quot;.

There is a special logger known as the /root logger/ that sits at the top
of the logger hierarchy.  It is always present, and handlers attached
there will be called for every message.  You can use 'getRootLogger' to get
it or 'rootLoggerName' to work with it by name.

The formatting of log messages may be customized by setting a 'LogFormatter'
on the desired 'LogHandler'.  There are a number of simple formatters defined 
in &quot;System.Log.Formatter&quot;, which may be used directly, or extend to create
your own formatter.

Here's an example to illustrate some of these concepts:

&gt; import System.Log.Logger
&gt; import System.Log.Handler.Syslog
&gt; import System.Log.Handler.Simple
&gt; import System.Log.Handler (setFormatter)
&gt; import System.Log.Formatter
&gt; 
&gt; -- By default, all messages of level WARNING and above are sent to stderr.
&gt; -- Everything else is ignored.
&gt; 
&gt; -- &quot;MyApp.Component&quot; is an arbitrary string; you can tune
&gt; -- logging behavior based on it later.
&gt; main = do
&gt;        debugM &quot;MyApp.Component&quot;  &quot;This is a debug message -- never to be seen&quot;
&gt;        warningM &quot;MyApp.Component2&quot; &quot;Something Bad is about to happen.&quot;
&gt; 
&gt;        -- Copy everything to syslog from here on out.
&gt;        s &lt;- openlog &quot;SyslogStuff&quot; [PID] USER DEBUG
&gt;        updateGlobalLogger rootLoggerName (addHandler s)
&gt;       
&gt;        errorM &quot;MyApp.Component&quot; &quot;This is going to stderr and syslog.&quot;
&gt;
&gt;        -- Now we'd like to see everything from BuggyComponent
&gt;        -- at DEBUG or higher go to syslog and stderr.
&gt;        -- Also, we'd like to still ignore things less than
&gt;        -- WARNING in other areas.
&gt;        -- 
&gt;        -- So, we adjust the Logger for MyApp.BuggyComponent.
&gt;
&gt;        updateGlobalLogger &quot;MyApp.BuggyComponent&quot;
&gt;                           (setLevel DEBUG)
&gt;
&gt;        -- This message will go to syslog and stderr
&gt;        debugM &quot;MyApp.BuggyComponent&quot; &quot;This buggy component is buggy&quot;
&gt; 
&gt;        -- This message will go to syslog and stderr too.
&gt;        warningM &quot;MyApp.BuggyComponent&quot; &quot;Still Buggy&quot;
&gt; 
&gt;        -- This message goes nowhere.
&gt;        debugM &quot;MyApp.WorkingComponent&quot; &quot;Hello&quot;
&gt;
&gt;        -- Now we decide we'd also like to log everything from BuggyComponent at DEBUG
&gt;        -- or higher to a file for later diagnostics.  We'd also like to customize the
&gt;        -- format of the log message, so we use a 'simpleLogFormatter'
&gt;
&gt;        h &lt;- fileHandler &quot;debug.log&quot; DEBUG &gt;&gt;= \lh -&gt; return $
&gt;                 setFormatter lh (simpleLogFormatter &quot;[$time : $loggername : $prio] $msg&quot;)
&gt;        updateGlobalLogger &quot;MyApp.BuggyComponent&quot; (addHandler h)
&gt;       
&gt;        -- This message will go to syslog and stderr, 
&gt;        -- and to the file &quot;debug.log&quot; with a format like :
&gt;        -- [2010-05-23 16:47:28 : MyApp.BuggyComponent : DEBUG] Some useful diagnostics...
&gt;        debugM &quot;MyApp.BuggyComponent&quot; &quot;Some useful diagnostics...&quot;
&gt;
&gt;
-}</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Log.Logger</span><span class="hs-special">(</span><span>
</span><a name="line-144"></a><span>                               </span><span class="hs-comment">-- * Basic Types</span><span>
</span><a name="line-145"></a><span>                               </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span class="hs-special">,</span><span>
</span><a name="line-146"></a><span>                               </span><span class="hs-comment">-- ** Re-Exported from System.Log</span><span>
</span><a name="line-147"></a><span>                               </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-148"></a><span>                               </span><span class="hs-comment">-- * Logging Messages</span><span>
</span><a name="line-149"></a><span>                               </span><span class="hs-comment">-- ** Basic</span><span>
</span><a name="line-150"></a><span>                               </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span class="hs-special">,</span><span>
</span><a name="line-151"></a><span>                               </span><span class="hs-comment">-- ** Utility Functions</span><span>
</span><a name="line-152"></a><span>                               </span><span class="hs-comment">-- These functions are wrappers for 'logM' to</span><span>
</span><a name="line-153"></a><span>                               </span><span class="hs-comment">-- make your job easier.</span><span>
</span><a name="line-154"></a><span>                               </span><a href="System.Log.Logger.html#debugM"><span class="hs-identifier hs-var">debugM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#infoM"><span class="hs-identifier hs-var">infoM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#noticeM"><span class="hs-identifier hs-var">noticeM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#warningM"><span class="hs-identifier hs-var">warningM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#errorM"><span class="hs-identifier hs-var">errorM</span></a><span class="hs-special">,</span><span>
</span><a name="line-155"></a><span>                               </span><a href="System.Log.Logger.html#criticalM"><span class="hs-identifier hs-var">criticalM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#alertM"><span class="hs-identifier hs-var">alertM</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#emergencyM"><span class="hs-identifier hs-var">emergencyM</span></a><span class="hs-special">,</span><span>
</span><a name="line-156"></a><span>                               </span><a href="System.Log.Logger.html#removeAllHandlers"><span class="hs-identifier hs-var">removeAllHandlers</span></a><span class="hs-special">,</span><span>
</span><a name="line-157"></a><span>                               </span><a href="System.Log.Logger.html#traplogging"><span class="hs-identifier hs-var">traplogging</span></a><span class="hs-special">,</span><span>
</span><a name="line-158"></a><span>                               </span><span class="hs-comment">-- ** Logging to a particular Logger by object</span><span>
</span><a name="line-159"></a><span>                               </span><a href="System.Log.Logger.html#logL"><span class="hs-identifier hs-var">logL</span></a><span class="hs-special">,</span><span>
</span><a name="line-160"></a><span>                               </span><span class="hs-comment">-- * Logger Manipulation</span><span>
</span><a name="line-161"></a><span class="hs-comment">{- | These functions help you work with loggers.  There are some
special things to be aware of.

First of all, whenever you first access a given logger by name, it
magically springs to life.  It has a default 'Priority' of Nothing
and an empty handler list -- which means that it will inherit whatever its
parents do.
-}</span><span>
</span><a name="line-169"></a><span>                               </span><span class="hs-comment">-- ** Finding \/ Creating Loggers</span><span>
</span><a name="line-170"></a><span>                               </span><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#getRootLogger"><span class="hs-identifier hs-var">getRootLogger</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#rootLoggerName"><span class="hs-identifier hs-var">rootLoggerName</span></a><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>                               </span><span class="hs-comment">-- ** Modifying Loggers</span><span>
</span><a name="line-172"></a><span class="hs-comment">{- | Keep in mind that \&quot;modification\&quot; here is modification in the Haskell
sense.  We do not actually cause mutation in a specific 'Logger'.  Rather,
we return you a new 'Logger' object with the change applied.

Also, please note that these functions will not have an effect on the
global 'Logger' hierarchy.  You may use your new 'Logger's locally,
but other functions won't see the changes.  To make a change global,
you'll need to use 'updateGlobalLogger' or 'saveGlobalLogger'.
-}</span><span>
</span><a name="line-181"></a><span>                               </span><a href="System.Log.Logger.html#addHandler"><span class="hs-identifier hs-var">addHandler</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#removeHandler"><span class="hs-identifier hs-var">removeHandler</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#setHandlers"><span class="hs-identifier hs-var">setHandlers</span></a><span class="hs-special">,</span><span>
</span><a name="line-182"></a><span>                               </span><a href="System.Log.Logger.html#getLevel"><span class="hs-identifier hs-var">getLevel</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#setLevel"><span class="hs-identifier hs-var">setLevel</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Logger.html#clearLevel"><span class="hs-identifier hs-var">clearLevel</span></a><span class="hs-special">,</span><span>
</span><a name="line-183"></a><span>                               </span><span class="hs-comment">-- ** Saving Your Changes</span><span>
</span><a name="line-184"></a><span class="hs-comment">{- | These functions commit changes you've made to loggers to the global
logger hierarchy. -}</span><span>
</span><a name="line-186"></a><span>                               </span><a href="System.Log.Logger.html#saveGlobalLogger"><span class="hs-identifier hs-var">saveGlobalLogger</span></a><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>                               </span><a href="System.Log.Logger.html#updateGlobalLogger"><span class="hs-identifier hs-var">updateGlobalLogger</span></a><span>
</span><a name="line-188"></a><span>                               </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span class="hs-keyword">import</span><span> </span><a href="System.Log.html"><span class="hs-identifier">System.Log</span></a><span>
</span><a name="line-190"></a><span class="hs-keyword">import</span><span> </span><a href="System.Log.Handler.html"><span class="hs-identifier">System.Log.Handler</span></a><span class="hs-special">(</span><a href="System.Log.Handler.html#LogHandler"><span class="hs-identifier hs-type">LogHandler</span></a><span class="hs-special">,</span><span> </span><a href="System.Log.Handler.html#close"><span class="hs-identifier hs-var">close</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span class="hs-keyword">import</span><span> </span><a href="System.Log.Formatter.html"><span class="hs-identifier">System.Log.Formatter</span></a><span class="hs-special">(</span><a href="System.Log.Formatter.html#LogFormatter"><span class="hs-identifier hs-type">LogFormatter</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="System.Log.Handler.html"><span class="hs-identifier">System.Log.Handler</span></a><span class="hs-special">(</span><a href="System.Log.Handler.html#handle"><span class="hs-identifier hs-var">handle</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span class="hs-keyword">import</span><span> </span><a href="System.Log.Handler.Simple.html"><span class="hs-identifier">System.Log.Handler.Simple</span></a><span>
</span><a name="line-194"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-195"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span>
</span><a name="line-196"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Concurrent.MVar</span><span>
</span><a name="line-197"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-199"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-200"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Exception</span><span>
</span><a name="line-201"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Error</span><span>
</span><a name="line-202"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- Basic logger types</span><span>
</span><a name="line-204"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-205"></a><span class="hs-keyword">data</span><span> </span><a name="HandlerT"><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier">HandlerT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679059790"><a href="#local-6989586621679059790"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="System.Log.Handler.html#LogHandler"><span class="hs-identifier hs-type">LogHandler</span></a><span> </span><a href="#local-6989586621679059790"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="HandlerT"><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier">HandlerT</span></a></a><span> </span><a href="#local-6989586621679059790"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">data</span><span> </span><a name="Logger"><a href="System.Log.Logger.html#Logger"><span class="hs-identifier">Logger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Logger"><a href="System.Log.Logger.html#Logger"><span class="hs-identifier">Logger</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="level"><a href="System.Log.Logger.html#level"><span class="hs-identifier">level</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span class="hs-special">,</span><span>
</span><a name="line-208"></a><span>                       </span><a name="handlers"><a href="System.Log.Logger.html#handlers"><span class="hs-identifier">handlers</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-type">HandlerT</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-209"></a><span>                       </span><a name="name"><a href="System.Log.Logger.html#name"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">}</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-keyword">type</span><span> </span><a name="LogTree"><a href="System.Log.Logger.html#LogTree"><span class="hs-identifier">LogTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map.Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">{- | This is the base class for the various log handlers.  They should
all adhere to this class. -}</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- Utilities</span><span>
</span><a name="line-219"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- | The name of the root logger, which is always defined and present</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- on the system.</span><span>
</span><a name="line-223"></a><span class="hs-identifier">rootLoggerName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-224"></a><a name="rootLoggerName"><a href="System.Log.Logger.html#rootLoggerName"><span class="hs-identifier">rootLoggerName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- Logger Tree Storage</span><span>
</span><a name="line-228"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | The log tree.  Initialize it with a default root logger </span><span>
</span><a name="line-231"></a><span class="hs-comment">-- and (FIXME) a logger for MissingH itself.</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">logTree</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-identifier">logTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="System.Log.Logger.html#LogTree"><span class="hs-identifier hs-type">LogTree</span></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- note: only kick up tree if handled locally</span><span>
</span><a name="line-237"></a><a name="logTree"><a href="System.Log.Logger.html#logTree"><span class="hs-identifier">logTree</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-239"></a><span>                      </span><a name="local-6989586621679059816"><a href="#local-6989586621679059816"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Log.Handler.Simple.html#streamHandler"><span class="hs-identifier hs-var">streamHandler</span></a><span> </span><span class="hs-identifier hs-var">stderr</span><span> </span><a href="System.Log.html#DEBUG"><span class="hs-identifier hs-var">DEBUG</span></a><span>
</span><a name="line-240"></a><span>                      </span><span class="hs-identifier hs-var">newMVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.singleton</span><span> </span><a href="System.Log.Logger.html#rootLoggerName"><span class="hs-identifier hs-var">rootLoggerName</span></a><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-var">Logger</span></a><span>
</span><a name="line-241"></a><span>                                                   </span><span class="hs-special">{</span><span class="hs-identifier">level</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="System.Log.html#WARNING"><span class="hs-identifier hs-var">WARNING</span></a><span class="hs-special">,</span><span>
</span><a name="line-242"></a><span>                                                    </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-243"></a><span>                                                    </span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-var">HandlerT</span></a><span> </span><a href="#local-6989586621679059816"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">{- | Given a name, return all components of it, starting from the root.
Example return value: 

&gt;[&quot;&quot;, &quot;MissingH&quot;, &quot;System.Cmd.Utils&quot;, &quot;System.Cmd.Utils.pOpen&quot;]

-}</span><span>
</span><a name="line-251"></a><span class="hs-identifier">componentsOfName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-252"></a><a name="componentsOfName"><a href="System.Log.Logger.html#componentsOfName"><span class="hs-identifier">componentsOfName</span></a></a><span> </span><a name="local-6989586621679059817"><a href="#local-6989586621679059817"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-253"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059818"><a href="#local-6989586621679059818"><span class="hs-identifier">joinComp</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-254"></a><span>        </span><span class="hs-identifier">joinComp</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059819"><a href="#local-6989586621679059819"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679059820"><a href="#local-6989586621679059820"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059819"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">joinComp</span></a><span> </span><a href="#local-6989586621679059820"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679059819"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-255"></a><span>        </span><span class="hs-identifier">joinComp</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059821"><a href="#local-6989586621679059821"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679059822"><a href="#local-6989586621679059822"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059823"><a href="#local-6989586621679059823"><span class="hs-identifier">accum</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-256"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059824"><a href="#local-6989586621679059824"><span class="hs-identifier">newlevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059823"><span class="hs-identifier hs-var">accum</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679059821"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-257"></a><span>                </span><a href="#local-6989586621679059824"><span class="hs-identifier hs-var">newlevel</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">joinComp</span></a><span> </span><a href="#local-6989586621679059822"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679059824"><span class="hs-identifier hs-var">newlevel</span></a><span>
</span><a name="line-258"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-259"></a><span>        </span><a href="System.Log.Logger.html#rootLoggerName"><span class="hs-identifier hs-var">rootLoggerName</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">joinComp</span></a><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#split"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><a href="#local-6989586621679059817"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- Logging With Location</span><span>
</span><a name="line-263"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">{- | Log a message using the given logger at a given priority. -}</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-identifier">logM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                           </span><span class="hs-comment">-- ^ Name of the logger to use</span><span>
</span><a name="line-268"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span>                         </span><span class="hs-comment">-- ^ Priority of this message</span><span>
</span><a name="line-269"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                           </span><span class="hs-comment">-- ^ The log text itself</span><span>
</span><a name="line-270"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><a name="logM"><a href="System.Log.Logger.html#logM"><span class="hs-identifier">logM</span></a></a><span> </span><a name="local-6989586621679059825"><a href="#local-6989586621679059825"><span class="hs-identifier">logname</span></a></a><span> </span><a name="local-6989586621679059826"><a href="#local-6989586621679059826"><span class="hs-identifier">pri</span></a></a><span> </span><a name="local-6989586621679059827"><a href="#local-6989586621679059827"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-273"></a><span>                       </span><a name="local-6989586621679059828"><a href="#local-6989586621679059828"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a><span> </span><a href="#local-6989586621679059825"><span class="hs-identifier hs-var">logname</span></a><span>
</span><a name="line-274"></a><span>                       </span><a href="System.Log.Logger.html#logL"><span class="hs-identifier hs-var">logL</span></a><span> </span><a href="#local-6989586621679059828"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679059826"><span class="hs-identifier hs-var">pri</span></a><span> </span><a href="#local-6989586621679059827"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- Utility functions</span><span>
</span><a name="line-278"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">{- | Log a message at 'DEBUG' priority -}</span><span>
</span><a name="line-281"></a><span class="hs-identifier">debugM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-282"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-283"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-284"></a><a name="debugM"><a href="System.Log.Logger.html#debugM"><span class="hs-identifier">debugM</span></a></a><span> </span><a name="local-6989586621679059829"><a href="#local-6989586621679059829"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059829"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#DEBUG"><span class="hs-identifier hs-var">DEBUG</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">{- | Log a message at 'INFO' priority -}</span><span>
</span><a name="line-287"></a><span class="hs-identifier">infoM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-288"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-289"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><a name="infoM"><a href="System.Log.Logger.html#infoM"><span class="hs-identifier">infoM</span></a></a><span> </span><a name="local-6989586621679059830"><a href="#local-6989586621679059830"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059830"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#INFO"><span class="hs-identifier hs-var">INFO</span></a><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-comment">{- | Log a message at 'NOTICE' priority -}</span><span>
</span><a name="line-293"></a><span class="hs-identifier">noticeM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-294"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-295"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-296"></a><a name="noticeM"><a href="System.Log.Logger.html#noticeM"><span class="hs-identifier">noticeM</span></a></a><span> </span><a name="local-6989586621679059831"><a href="#local-6989586621679059831"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059831"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#NOTICE"><span class="hs-identifier hs-var">NOTICE</span></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">{- | Log a message at 'WARNING' priority -}</span><span>
</span><a name="line-299"></a><span class="hs-identifier">warningM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-300"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-301"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-302"></a><a name="warningM"><a href="System.Log.Logger.html#warningM"><span class="hs-identifier">warningM</span></a></a><span> </span><a name="local-6989586621679059832"><a href="#local-6989586621679059832"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059832"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#WARNING"><span class="hs-identifier hs-var">WARNING</span></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-comment">{- | Log a message at 'ERROR' priority -}</span><span>
</span><a name="line-305"></a><span class="hs-identifier">errorM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-306"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-307"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><a name="errorM"><a href="System.Log.Logger.html#errorM"><span class="hs-identifier">errorM</span></a></a><span> </span><a name="local-6989586621679059833"><a href="#local-6989586621679059833"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059833"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#ERROR"><span class="hs-identifier hs-var">ERROR</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">{- | Log a message at 'CRITICAL' priority -}</span><span>
</span><a name="line-311"></a><span class="hs-identifier">criticalM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-312"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-313"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-314"></a><a name="criticalM"><a href="System.Log.Logger.html#criticalM"><span class="hs-identifier">criticalM</span></a></a><span> </span><a name="local-6989586621679059834"><a href="#local-6989586621679059834"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059834"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#CRITICAL"><span class="hs-identifier hs-var">CRITICAL</span></a><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-comment">{- | Log a message at 'ALERT' priority -}</span><span>
</span><a name="line-317"></a><span class="hs-identifier">alertM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-318"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-319"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-320"></a><a name="alertM"><a href="System.Log.Logger.html#alertM"><span class="hs-identifier">alertM</span></a></a><span> </span><a name="local-6989586621679059835"><a href="#local-6989586621679059835"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059835"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#ALERT"><span class="hs-identifier hs-var">ALERT</span></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">{- | Log a message at 'EMERGENCY' priority -}</span><span>
</span><a name="line-323"></a><span class="hs-identifier">emergencyM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-324"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                         </span><span class="hs-comment">-- ^ Log message</span><span>
</span><a name="line-325"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><a name="emergencyM"><a href="System.Log.Logger.html#emergencyM"><span class="hs-identifier">emergencyM</span></a></a><span> </span><a name="local-6989586621679059836"><a href="#local-6989586621679059836"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059836"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="System.Log.html#EMERGENCY"><span class="hs-identifier hs-var">EMERGENCY</span></a><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- Public Logger Interaction Support</span><span>
</span><a name="line-330"></a><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-comment">-- | Returns the logger for the given name.  If no logger with that name</span><span>
</span><a name="line-333"></a><span class="hs-comment">-- exists, creates new loggers and any necessary parent loggers, with</span><span>
</span><a name="line-334"></a><span class="hs-comment">-- no connected handlers.</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-identifier">getLogger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-337"></a><a name="getLogger"><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier">getLogger</span></a></a><span> </span><a name="local-6989586621679059837"><a href="#local-6989586621679059837"><span class="hs-identifier">lname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifyMVar</span><span> </span><a href="System.Log.Logger.html#logTree"><span class="hs-identifier hs-var">logTree</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679059844"><a href="#local-6989586621679059844"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679059837"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">lt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-339"></a><span>         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679059845"><a href="#local-6989586621679059845"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- A logger exists; return it and leave tree</span><span>
</span><a name="line-340"></a><span>         </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-341"></a><span>                    </span><span class="hs-comment">-- Add logger(s).  Then call myself to retrieve it.</span><span>
</span><a name="line-342"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059846"><a href="#local-6989586621679059846"><span class="hs-identifier">newlt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">createLoggers</span></a><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#componentsOfName"><span class="hs-identifier hs-var">componentsOfName</span></a><span> </span><a href="#local-6989586621679059837"><span class="hs-identifier hs-var">lname</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-343"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059847"><a href="#local-6989586621679059847"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679059837"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">newlt</span></a><span>
</span><a name="line-344"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">newlt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">createLoggers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#LogTree"><span class="hs-identifier hs-type">LogTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#LogTree"><span class="hs-identifier hs-type">LogTree</span></a><span>
</span><a name="line-346"></a><span>          </span><a name="local-6989586621679059838"><a href="#local-6989586621679059838"><span class="hs-identifier">createLoggers</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679059840"><a href="#local-6989586621679059840"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059840"><span class="hs-identifier hs-var">lt</span></a><span> </span><span class="hs-comment">-- No names to add; return tree unmodified</span><span>
</span><a name="line-347"></a><span>          </span><span class="hs-identifier">createLoggers</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059841"><a href="#local-6989586621679059841"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679059842"><a href="#local-6989586621679059842"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059843"><a href="#local-6989586621679059843"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Add logger to tree</span><span>
</span><a name="line-348"></a><span>              </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">Map.member</span><span> </span><a href="#local-6989586621679059841"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-349"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">createLoggers</span></a><span> </span><a href="#local-6989586621679059842"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-350"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">createLoggers</span></a><span> </span><a href="#local-6989586621679059842"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-351"></a><span>                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679059841"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059839"><span class="hs-identifier hs-var">defaultLogger</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span class="hs-glyph">=</span><a href="#local-6989586621679059841"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>          </span><a name="local-6989586621679059839"><a href="#local-6989586621679059839"><span class="hs-identifier">defaultLogger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-var">Logger</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-- | Returns the root logger.</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-identifier">getRootLogger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-357"></a><a name="getRootLogger"><a href="System.Log.Logger.html#getRootLogger"><span class="hs-identifier">getRootLogger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a><span> </span><a href="System.Log.Logger.html#rootLoggerName"><span class="hs-identifier hs-var">rootLoggerName</span></a><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | Log a message, assuming the current logger's level permits it.</span><span>
</span><a name="line-360"></a><span class="hs-identifier">logL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-361"></a><a name="logL"><a href="System.Log.Logger.html#logL"><span class="hs-identifier">logL</span></a></a><span> </span><a name="local-6989586621679059848"><a href="#local-6989586621679059848"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679059849"><a href="#local-6989586621679059849"><span class="hs-identifier">pri</span></a></a><span> </span><a name="local-6989586621679059850"><a href="#local-6989586621679059850"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#handle"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059849"><span class="hs-identifier hs-var">pri</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059850"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-- | Handle a log request.</span><span>
</span><a name="line-364"></a><span class="hs-identifier">handle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.html#LogRecord"><span class="hs-identifier hs-type">LogRecord</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-365"></a><a name="handle"><a href="System.Log.Logger.html#handle"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679059851"><a href="#local-6989586621679059851"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679059852"><a href="#local-6989586621679059852"><span class="hs-identifier">pri</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679059853"><a href="#local-6989586621679059853"><span class="hs-identifier">msg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">parentLoggers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span class="hs-special">]</span><span>
</span><a name="line-367"></a><span>        </span><a name="local-6989586621679059854"><a href="#local-6989586621679059854"><span class="hs-identifier">parentLoggers</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-368"></a><span>        </span><span class="hs-identifier">parentLoggers</span><span> </span><a name="local-6989586621679059857"><a href="#local-6989586621679059857"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-369"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059858"><a href="#local-6989586621679059858"><span class="hs-identifier">pname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Log.Logger.html#componentsOfName"><span class="hs-identifier hs-var">componentsOfName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-370"></a><span>                </span><span class="hs-keyword">in</span><span>
</span><a name="line-371"></a><span>                </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679059859"><a href="#local-6989586621679059859"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a><span> </span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">pname</span></a><span>
</span><a name="line-372"></a><span>                   </span><a name="local-6989586621679059860"><a href="#local-6989586621679059860"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">parentLoggers</span></a><span> </span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">pname</span></a><span>
</span><a name="line-373"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059859"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>        </span><span class="hs-identifier">parentHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-type">HandlerT</span></a><span class="hs-special">]</span><span>
</span><a name="line-375"></a><span>        </span><a name="local-6989586621679059855"><a href="#local-6989586621679059855"><span class="hs-identifier">parentHandlers</span></a></a><span> </span><a name="local-6989586621679059861"><a href="#local-6989586621679059861"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">parentLoggers</span></a><span> </span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-identifier">handlers</span><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span>        </span><span class="hs-comment">-- Get the priority we should use.  Find the first logger in the tree,</span><span>
</span><a name="line-378"></a><span>        </span><span class="hs-comment">-- starting here, with a set priority.  If even root doesn't have one,</span><span>
</span><a name="line-379"></a><span>        </span><span class="hs-comment">-- assume DEBUG.</span><span>
</span><a name="line-380"></a><span>        </span><span class="hs-identifier">getLoggerPriority</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span>
</span><a name="line-381"></a><span>        </span><a name="local-6989586621679059856"><a href="#local-6989586621679059856"><span class="hs-identifier">getLoggerPriority</span></a></a><span> </span><a name="local-6989586621679059862"><a href="#local-6989586621679059862"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-382"></a><span>            </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679059863"><a href="#local-6989586621679059863"><span class="hs-identifier">pl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">parentLoggers</span></a><span> </span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-383"></a><span>               </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">level</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">pl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-384"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="System.Log.html#DEBUG"><span class="hs-identifier hs-var">DEBUG</span></a><span>
</span><a name="line-385"></a><span>                 </span><span class="hs-special">(</span><a name="local-6989586621679059864"><a href="#local-6989586621679059864"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-386"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679059865"><a href="#local-6989586621679059865"><span class="hs-identifier">lp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">getLoggerPriority</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>           </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">pri</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">lp</span></a><span>
</span><a name="line-389"></a><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-390"></a><span>                </span><a name="local-6989586621679059866"><a href="#local-6989586621679059866"><span class="hs-identifier">ph</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">parentHandlers</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>                </span><span class="hs-identifier hs-var">sequence_</span><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#handlerActions"><span class="hs-identifier hs-var">handlerActions</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">ph</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">handlers</span><span> </span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">pri</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059853"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>                                          </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- | Call a handler given a HandlerT.</span><span>
</span><a name="line-396"></a><span class="hs-identifier">callHandler</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.html#LogRecord"><span class="hs-identifier hs-type">LogRecord</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-type">HandlerT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-397"></a><a name="callHandler"><a href="System.Log.Logger.html#callHandler"><span class="hs-identifier">callHandler</span></a></a><span> </span><a name="local-6989586621679059867"><a href="#local-6989586621679059867"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621679059868"><a href="#local-6989586621679059868"><span class="hs-identifier">loggername</span></a></a><span> </span><a name="local-6989586621679059869"><a href="#local-6989586621679059869"><span class="hs-identifier">ht</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">ht</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-399"></a><span>            </span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-var">HandlerT</span></a><span> </span><a name="local-6989586621679059870"><a href="#local-6989586621679059870"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Handler.html#handle"><span class="hs-identifier hs-var">System.Log.Handler.handle</span></a><span> </span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679059867"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-6989586621679059868"><span class="hs-identifier hs-var">loggername</span></a><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-comment">-- | Generate IO actions for the handlers.</span><span>
</span><a name="line-402"></a><span class="hs-identifier">handlerActions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-type">HandlerT</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.html#LogRecord"><span class="hs-identifier hs-type">LogRecord</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-403"></a><a name="handlerActions"><a href="System.Log.Logger.html#handlerActions"><span class="hs-identifier">handlerActions</span></a></a><span> </span><a name="local-6989586621679059871"><a href="#local-6989586621679059871"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679059872"><a href="#local-6989586621679059872"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621679059873"><a href="#local-6989586621679059873"><span class="hs-identifier">loggername</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#callHandler"><span class="hs-identifier hs-var">callHandler</span></a><span> </span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">loggername</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059871"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- | Add handler to 'Logger'.  Returns a new 'Logger'.</span><span>
</span><a name="line-406"></a><span class="hs-identifier">addHandler</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Handler.html#LogHandler"><span class="hs-identifier hs-type">LogHandler</span></a><span> </span><a href="#local-6989586621679059796"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679059796"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-407"></a><a name="addHandler"><a href="System.Log.Logger.html#addHandler"><span class="hs-identifier">addHandler</span></a></a><span> </span><a name="local-6989586621679059874"><a href="#local-6989586621679059874"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679059875"><a href="#local-6989586621679059875"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">{</span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-var">HandlerT</span></a><span> </span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">handlers</span><span> </span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-comment">-- | Remove a handler from the 'Logger'.  Handlers are removed in the reverse</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- order they were added, so the following property holds for any 'LogHandler'</span><span>
</span><a name="line-411"></a><span class="hs-comment">-- @h@:</span><span>
</span><a name="line-412"></a><span class="hs-comment">--</span><span>
</span><a name="line-413"></a><span class="hs-comment">-- &gt; removeHandler . addHandler h = id</span><span>
</span><a name="line-414"></a><span class="hs-comment">--</span><span>
</span><a name="line-415"></a><span class="hs-comment">-- If no handlers are associated with the 'Logger', it is returned unchanged.</span><span>
</span><a name="line-416"></a><span class="hs-comment">--</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- The root logger's default handler that writes every message to stderr can</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- be removed by using this function before any handlers have been added</span><span>
</span><a name="line-419"></a><span class="hs-comment">-- to the root logger:</span><span>
</span><a name="line-420"></a><span class="hs-comment">--</span><span>
</span><a name="line-421"></a><span class="hs-comment">-- &gt; updateGlobalLogger rootLoggerName removeHandler</span><span>
</span><a name="line-422"></a><span class="hs-identifier">removeHandler</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-423"></a><a name="removeHandler"><a href="System.Log.Logger.html#removeHandler"><span class="hs-identifier">removeHandler</span></a></a><span> </span><a name="local-6989586621679059876"><a href="#local-6989586621679059876"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-424"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var">hs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-425"></a><span>               </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">{</span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">}</span><span>
</span><a name="line-426"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-427"></a><span>    </span><a name="local-6989586621679059877"><a href="#local-6989586621679059877"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">handlers</span><span> </span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span class="hs-comment">-- | Set the 'Logger'\'s list of handlers to the list supplied.</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- All existing handlers are removed first.</span><span>
</span><a name="line-431"></a><span class="hs-identifier">setHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Handler.html#LogHandler"><span class="hs-identifier hs-type">LogHandler</span></a><span> </span><a href="#local-6989586621679059795"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059795"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-432"></a><a name="setHandlers"><a href="System.Log.Logger.html#setHandlers"><span class="hs-identifier">setHandlers</span></a></a><span> </span><a name="local-6989586621679059878"><a href="#local-6989586621679059878"><span class="hs-identifier">hl</span></a></a><span> </span><a name="local-6989586621679059879"><a href="#local-6989586621679059879"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-433"></a><span>    </span><a href="#local-6989586621679059879"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">{</span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679059880"><a href="#local-6989586621679059880"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-var">HandlerT</span></a><span> </span><a href="#local-6989586621679059880"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059878"><span class="hs-identifier hs-var">hl</span></a><span class="hs-special">}</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-comment">-- | Returns the &quot;level&quot; of the logger.  Items beneath this</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- level will be ignored.</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-identifier">getLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span>
</span><a name="line-439"></a><a name="getLevel"><a href="System.Log.Logger.html#getLevel"><span class="hs-identifier">getLevel</span></a></a><span> </span><a name="local-6989586621679059881"><a href="#local-6989586621679059881"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">level</span><span> </span><a href="#local-6989586621679059881"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-comment">-- | Sets the &quot;level&quot; of the 'Logger'.  Returns a new</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- 'Logger' object with the new level.</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-identifier">setLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-445"></a><a name="setLevel"><a href="System.Log.Logger.html#setLevel"><span class="hs-identifier">setLevel</span></a></a><span> </span><a name="local-6989586621679059882"><a href="#local-6989586621679059882"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679059883"><a href="#local-6989586621679059883"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059883"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">{</span><span class="hs-identifier">level</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">}</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-comment">-- | Clears the &quot;level&quot; of the 'Logger'.  It will now inherit the level of</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- | its parent.</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-identifier">clearLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span>
</span><a name="line-451"></a><a name="clearLevel"><a href="System.Log.Logger.html#clearLevel"><span class="hs-identifier">clearLevel</span></a></a><span> </span><a name="local-6989586621679059884"><a href="#local-6989586621679059884"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">level</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">}</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | Updates the global record for the given logger to take into</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- account any changes you may have made.</span><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span class="hs-identifier">saveGlobalLogger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-457"></a><a name="saveGlobalLogger"><a href="System.Log.Logger.html#saveGlobalLogger"><span class="hs-identifier">saveGlobalLogger</span></a></a><span> </span><a name="local-6989586621679059885"><a href="#local-6989586621679059885"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="System.Log.Logger.html#logTree"><span class="hs-identifier hs-var">logTree</span></a><span>
</span><a name="line-458"></a><span>                     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679059886"><a href="#local-6989586621679059886"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679059885"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059885"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679059886"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-comment">{- | Helps you make changes on the given logger.  Takes a function
that makes changes and writes those changes back to the global
database.  Here's an example from above (\&quot;s\&quot; is a 'LogHandler'):

&gt; updateGlobalLogger &quot;MyApp.BuggyComponent&quot;
&gt;                    (setLevel DEBUG . setHandlers [s])
-}</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-identifier">updateGlobalLogger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>            </span><span class="hs-comment">-- ^ Logger name</span><span>
</span><a name="line-469"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function to call</span><span>
</span><a name="line-470"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-471"></a><a name="updateGlobalLogger"><a href="System.Log.Logger.html#updateGlobalLogger"><span class="hs-identifier">updateGlobalLogger</span></a></a><span> </span><a name="local-6989586621679059887"><a href="#local-6989586621679059887"><span class="hs-identifier">ln</span></a></a><span> </span><a name="local-6989586621679059888"><a href="#local-6989586621679059888"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-472"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679059889"><a href="#local-6989586621679059889"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Log.Logger.html#getLogger"><span class="hs-identifier hs-var">getLogger</span></a><span> </span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">ln</span></a><span>
</span><a name="line-473"></a><span>       </span><a href="System.Log.Logger.html#saveGlobalLogger"><span class="hs-identifier hs-var">saveGlobalLogger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679059889"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- | Allow graceful shutdown. Release all opened files/handlers/etc.</span><span>
</span><a name="line-476"></a><span class="hs-identifier">removeAllHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="removeAllHandlers"><a href="System.Log.Logger.html#removeAllHandlers"><span class="hs-identifier">removeAllHandlers</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="System.Log.Logger.html#logTree"><span class="hs-identifier hs-var">logTree</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679059890"><a href="#local-6989586621679059890"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-479"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059891"><a href="#local-6989586621679059891"><span class="hs-identifier">allHandlers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679059892"><a href="#local-6989586621679059892"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679059893"><a href="#local-6989586621679059893"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059893"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">handlers</span><span> </span><a href="#local-6989586621679059892"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-480"></a><span>        </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="System.Log.Logger.html#HandlerT"><span class="hs-identifier hs-var">HandlerT</span></a><span> </span><a name="local-6989586621679059894"><a href="#local-6989586621679059894"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.Handler.html#close"><span class="hs-identifier hs-var">close</span></a><span> </span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">allHandlers</span></a><span>
</span><a name="line-481"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679059895"><a href="#local-6989586621679059895"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">lt</span></a><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">{- | Traps exceptions that may occur, logging them, then passing them on.

Takes a logger name, priority, leading description text (you can set it to
@\&quot;\&quot;@ if you don't want any), and action to run.
-}</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-identifier">traplogging</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                   </span><span class="hs-comment">-- Logger name</span><span>
</span><a name="line-490"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a><span>                 </span><span class="hs-comment">-- Logging priority</span><span>
</span><a name="line-491"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                   </span><span class="hs-comment">-- Descriptive text to prepend to logged messages</span><span>
</span><a name="line-492"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679059794"><span class="hs-identifier hs-type">a</span></a><span>                     </span><span class="hs-comment">-- Action to run</span><span>
</span><a name="line-493"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679059794"><span class="hs-identifier hs-type">a</span></a><span>                     </span><span class="hs-comment">-- Return value</span><span>
</span><a name="line-494"></a><a name="traplogging"><a href="System.Log.Logger.html#traplogging"><span class="hs-identifier">traplogging</span></a></a><span> </span><a name="local-6989586621679059896"><a href="#local-6989586621679059896"><span class="hs-identifier">logger</span></a></a><span> </span><a name="local-6989586621679059897"><a href="#local-6989586621679059897"><span class="hs-identifier">priority</span></a></a><span> </span><a name="local-6989586621679059898"><a href="#local-6989586621679059898"><span class="hs-identifier">desc</span></a></a><span> </span><a name="local-6989586621679059899"><a href="#local-6989586621679059899"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-495"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679059900"><a href="#local-6989586621679059900"><span class="hs-identifier">realdesc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">desc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-496"></a><span>                             </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-497"></a><span>                             </span><a name="local-6989586621679059903"><a href="#local-6989586621679059903"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059903"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;: &quot;</span><span>
</span><a name="line-498"></a><span>        </span><span class="hs-identifier">handler</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Control.Exception.SomeException</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679059902"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-499"></a><span>        </span><a name="local-6989586621679059901"><a href="#local-6989586621679059901"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679059904"><a href="#local-6989586621679059904"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-500"></a><span>                    </span><a href="System.Log.Logger.html#logM"><span class="hs-identifier hs-var">logM</span></a><span> </span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">logger</span></a><span> </span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">priority</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059900"><span class="hs-identifier hs-var">realdesc</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span>                    </span><span class="hs-identifier hs-var">Control.Exception.throw</span><span> </span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">e</span></a><span>             </span><span class="hs-comment">-- Re-raise it</span><span>
</span><a name="line-502"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-503"></a><span>        </span><span class="hs-identifier hs-var">Control.Exception.catch</span><span> </span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">action</span></a><span> </span><a href="#local-6989586621679059901"><span class="hs-identifier hs-var">handler</span></a><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">{- This function pulled in from MissingH to avoid a dep on it -}</span><span>
</span><a name="line-506"></a><span class="hs-identifier">split</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679059793"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679059793"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-507"></a><a name="split"><a href="System.Log.Logger.html#split"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-508"></a><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679060027"><a href="#local-6989586621679060027"><span class="hs-identifier">delim</span></a></a><span> </span><a name="local-6989586621679060028"><a href="#local-6989586621679060028"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-509"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060029"><a href="#local-6989586621679060029"><span class="hs-identifier">firstline</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060030"><a href="#local-6989586621679060030"><span class="hs-identifier">remainder</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#breakList"><span class="hs-identifier hs-var">breakList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isPrefixOf</span><span> </span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">delim</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060028"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-510"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-511"></a><span>        </span><a href="#local-6989586621679060029"><span class="hs-identifier hs-var">firstline</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060030"><span class="hs-identifier hs-var">remainder</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-512"></a><span>                                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-513"></a><span>                                   </span><a name="local-6989586621679060031"><a href="#local-6989586621679060031"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679060031"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">delim</span></a><span>
</span><a name="line-514"></a><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-515"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><a href="System.Log.Logger.html#split"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">delim</span></a><span>
</span><a name="line-516"></a><span>                                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">delim</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060031"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-comment">-- This function also pulled from MissingH</span><span>
</span><a name="line-519"></a><span class="hs-identifier">breakList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679059792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679059792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059792"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><a name="breakList"><a href="System.Log.Logger.html#breakList"><span class="hs-identifier">breakList</span></a></a><span> </span><a name="local-6989586621679060032"><a href="#local-6989586621679060032"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#spanList"><span class="hs-identifier hs-var">spanList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679060032"><span class="hs-identifier hs-var">func</span></a><span class="hs-special">)</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-comment">-- This function also pulled from MissingH</span><span>
</span><a name="line-523"></a><span class="hs-identifier">spanList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679059791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679059791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679059791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><a name="spanList"><a href="System.Log.Logger.html#spanList"><span class="hs-identifier">spanList</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span class="hs-identifier">spanList</span><span> </span><a name="local-6989586621679060033"><a href="#local-6989586621679060033"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679060034"><a href="#local-6989586621679060034"><span class="hs-identifier">list</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679060035"><a href="#local-6989586621679060035"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060036"><a href="#local-6989586621679060036"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-527"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-528"></a><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679060037"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><a href="#local-6989586621679060038"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060037"><a href="#local-6989586621679060037"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><a name="local-6989586621679060038"><a href="#local-6989586621679060038"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Log.Logger.html#spanList"><span class="hs-identifier hs-var">spanList</span></a><span> </span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679060036"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a></pre></body></html>